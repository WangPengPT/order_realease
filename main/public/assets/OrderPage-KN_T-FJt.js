import{s as F}from"./index-ClAD0OgU.js";import{s as U}from"./index-CfViWcjL.js";import{s as L}from"./index-wMsZJ9hS.js";import{s as P,a as A}from"./index-C0V2WE_9.js";import{s as j,a as q}from"./index-Ldlq2xt3.js";import{s as E}from"./index-DFSdb5ZT.js";import{n as o,h as d,c as v,a as s,d as a,w as i,l as H,F as b,o as h,y as K,x as G,t as c,z as J,A as Q,C as W}from"./index-DRnEsGfR.js";import"./index-BfAQIhyQ.js";import"./index-Be13fh17.js";import"./index-BEzmyd5f.js";import"./index-DEiEZr0p.js";import"./index-BprDgx_e.js";import"./index-5TSuW2ny.js";const X={class:"card",style:{display:"flex","flex-direction":"column",height:"75%"}},Y={class:"flex flex-wrap gap-2 items-center justify-between"},Z=["onClick"],ee={style:{"list-style-type":"none","padding-left":"0"}},te={class:"flex flex-wrap p-2 items-center gap-4"},le={style:{"max-width":"200px"}},we={__name:"OrderPage",setup(se){const _=o.orders,p=d(!1),n=d(null),m=d(!1),r=d(null),y=d([{label:"已完成",value:"completed"},{label:"已浏览",value:"readed"},{label:"新订单",value:"new"}]),f=d({global:{value:null,matchMode:W.CONTAINS}}),x=e=>({completed:"已完成",readed:"已浏览",new:"新订单"})[e]||e,C=e=>({completed:"status-completed",readed:"status-readed",new:"status-new"})[e]||"";function N(e){n.value=e,p.value=!1,r.value=e.status,m.value=!0}function S(){r.value!==null&&(n.value.status!==r.value&&(n.value.status==="new"&&o.newOrderCount.value>0&&(o.newOrderCount.value-=1),r.value==="new"&&(o.newOrderCount.value+=1),n.value.status=r.value,o.updateOrderStatus(n.value)),m.value=!1)}const D=e=>new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});function M(e){e.data?(n.value=e.data,p.value=!0,e.data.isNew=!1,e.data.status=="new"&&(e.data.status="readed",o.updateOrderStatus(e.data),o.decrementOrderCount())):console.error("Row data is missing in the event",e)}function k(e){return o.getDishNameById(e.dishid)}function O(e){return e.dishid?e.dishid:e.name}function V(e){return o.getDishNote(e)}return(e,t)=>{const $=q,I=E,B=j,u=A,R=P,T=L,w=U,z=F;return h(),v(b,null,[s("div",X,[a(R,{value:H(_),tableStyle:"min-width: 50rem",dataKey:"id",paginator:"",rows:5,rowsPerPageOptions:[5,10,20,50],stripedRows:"",filters:f.value,scrollable:"",scrollHeight:"flex",onRowClick:M,selectionMode:"single"},{header:i(()=>[s("div",Y,[t[5]||(t[5]=s("h4",{class:"m-0 font-bold text-2xl text-left flex-grow-1"},"所有订单",-1)),a(B,null,{default:i(()=>[a($,null,{default:i(()=>t[4]||(t[4]=[s("i",{class:"pi pi-search"},null,-1)])),_:1,__:[4]}),a(I,{modelValue:f.value.global.value,"onUpdate:modelValue":t[0]||(t[0]=l=>f.value.global.value=l),placeholder:"查找.."},null,8,["modelValue"])]),_:1})])]),empty:i(()=>t[6]||(t[6]=[s("div",{class:"text-center py-5"},[s("i",{class:"pi pi-search",style:{"font-size":"3rem",color:"#ccc"}}),s("p",{class:"mt-3 text-gray-500"},"未找到匹配的订单")],-1)])),default:i(()=>[a(u,{field:"status",header:"状态",sortable:"",style:{width:"10%"}},{body:i(({data:l})=>[s("span",{class:G(["status-badge",C(l.status)]),onClick:K(g=>N(l),["stop"])},c(x(l.status)),11,Z)]),_:1}),a(u,{field:"id",header:"订单号",sortable:"",style:{width:"10%"}}),a(u,{field:"table",header:"桌号",sortable:"",style:{width:"10%"}}),a(u,{field:"time",header:"时间",sortable:"",style:{width:"20%"}},{body:i(({data:l})=>[J(c(D(l.timestamp)),1)]),_:1}),a(u,{field:"name",header:"名字",style:{width:"15%"}}),a(u,{field:"note",header:"备注",style:{width:"35%"},class:"multiline-cell"})]),_:1},8,["value","filters"])]),s("div",null,[a(w,{visible:p.value,"onUpdate:visible":t[1]||(t[1]=l=>p.value=l),header:"详细信息",modal:!0,dismissableMask:!0},{default:i(()=>[s("ul",ee,[(h(!0),v(b,null,Q(n.value.items,(l,g)=>(h(),v("li",{key:g},[s("div",te,[s("label",null,c(O(l)),1),s("label",null,c(k(l)),1),s("label",null,"x "+c(l.quantity),1),s("label",le,c(V(l.notes)),1)]),a(T)]))),128))])]),_:1},8,["visible"])]),s("div",null,[a(w,{visible:m.value,"onUpdate:visible":t[3]||(t[3]=l=>m.value=l),header:"订单状态",modal:!0,dismissableMask:!0},{default:i(()=>[a(z,{modelValue:r.value,"onUpdate:modelValue":t[2]||(t[2]=l=>r.value=l),options:y.value,optionLabel:"label",optionValue:"value",onClick:S},null,8,["modelValue","options"])]),_:1},8,["visible"])])],64)}}};export{we as default};
