import{s as J}from"./index-CfViWcjL.js";import{c as K,s as X,a as q}from"./index-C0V2WE_9.js";import{s as ee,a as le,b as te,c as ae}from"./index-i5rv_67c.js";import{s as re}from"./index-BQtV4vbe.js";import{s as oe}from"./index-ClAD0OgU.js";import{b as ne}from"./index-BfAQIhyQ.js";import{h as c,n as b,c as y,d as n,a as p,w as s,e as P,j as se,o as i,l as ie,F as k,A as D,f as _,z as N,t as A}from"./index-DRnEsGfR.js";import"./index-BEzmyd5f.js";import"./index-DEiEZr0p.js";import"./index-Ldlq2xt3.js";import"./index-DFSdb5ZT.js";import"./index-Be13fh17.js";import"./index-BprDgx_e.js";import"./index-5TSuW2ny.js";const ue={class:"flex flex-column w-full",style:{position:"fixed",top:"0",left:"0"}},de={class:"flex flex-wrap justify-content-center align-items-center gap-1 ml-2"},ve={class:"card flex flex-column",style:{height:"calc(100vh - 200px)"}},ce={key:0,style:{padding:"0.5rem"}},fe=2025,Ne={__name:"OrderQuantity",setup(pe){const S=se(),a=c(b.menuData.value.filter(l=>l.category));R();const z=c([{id:0,label:"隐藏销售量为0的菜品"},{id:1,label:"展示销售量为0的菜品"}]),g=c(),C=new Date,m=C.getFullYear(),h=C.getMonth()+1,Q=C.getDate(),T=c([{id:0,value:0,label:"总评分"}]);F();function F(){for(let l=fe;l<=m;l++)T.value.push({id:l,value:l,label:l})}const x=c([]);U();function U(){const l=["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"];x.value.push({id:0,value:"yearTotal",label:"当年总销售量"});for(let e=0;e<l.length;e++)x.value.push({id:e+1,value:l[e],label:e+1+" - "+l[e].toUpperCase()})}const I=[Array.from({length:28},(l,e)=>({id:e+1,label:e+1})),Array.from({length:29},(l,e)=>({id:e+1,label:e+1})),Array.from({length:30},(l,e)=>({id:e+1,label:e+1})),Array.from({length:31},(l,e)=>({id:e+1,label:e+1}))],V=c([]);Y(m,h);function Y(l,e){if(e<1||e>12)return 0;const t=[3,l&&(l%4===0&&l%100!==0||l%400===0)?1:0,3,2,3,2,3,3,2,3,2,3];V.value=I[t[e-1]]}async function R(){try{await b.refreshMenu(),a.value=b.menuData.value.filter(l=>l.category)}catch(l){console.error("获取销售量失败:",l),toast.add({severity:"error",summary:"错误",detail:"获取销售量失败",life:3e3})}}function w(l,e,o){u.value!==e&&Y(l,e),d.value=l,u.value=e,o=o|0,a.value=[],E(a,l,e,o,()=>{H()}),a.value=a.value.filter(t=>t.category)}function E(l,e,o,t,O){e==0||e==m&&o==0||e==m&&o==h&&t==0||e==m&&o==h&&t==Q?l.value=b.menuData.value:(o===0&&(t=0),b.getOrderQuantityWithDate(l,e,o,t,()=>{O()})),O()}function H(){const l=d.value,e=u.value,o=v.value.id;if(g.value)if(g.value.id){if(!l){a.value=a.value.filter(t=>!t.orders);return}if(!e){a.value=a.value.filter(t=>!t.yearlyOrders);return}if(!o){a.value=a.value.filter(t=>!t.monthlyOrders);return}a.value=a.value.filter(t=>!t.dailyOrders)}else{if(!l){a.value=a.value.filter(t=>t.orders);return}if(!e){a.value=a.value.filter(t=>t.yearlyOrders);return}if(!o){a.value=a.value.filter(t=>t.monthlyOrders);return}a.value=a.value.filter(t=>t.dailyOrders)}}const d=c(m),u=c(h),v=c(V.value.find(l=>l.id===Q));return(l,e)=>{const o=ne,t=oe,O=re,B=te,L=le,j=ae,M=ee,W=K,$=q,Z=X,G=J;return i(),y("div",ue,[n(O,{class:"bg-primary text-white p-2"},{start:s(()=>[n(o,{icon:"pi pi-arrow-left",class:"p-button-text text-white",label:"主页",onClick:e[0]||(e[0]=r=>ie(S).push("/"))}),p("div",de,[n(t,{modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=r=>g.value=r),options:z.value,optionLabel:"label",unselectable:!1,onChange:e[2]||(e[2]=r=>w(d.value,u.value,v.value.id))},null,8,["modelValue","options"])])]),_:1}),p("div",null,[n(M,{value:d.value},{default:s(()=>[n(L,null,{default:s(()=>[(i(!0),y(k,null,D(T.value,r=>(i(),_(B,{key:r.id,value:r.id,onClick:f=>w(r.id,u.value,v.value.id)},{default:s(()=>[N(A(r.label),1)]),_:2},1032,["value","onClick"]))),128))]),_:1}),(i(!0),y(k,null,D(T.value,r=>(i(),_(j,{key:r.id,value:r.id},{default:s(()=>[d.value!==0?(i(),_(M,{key:0,value:u.value,scrollable:""},{default:s(()=>[n(L,null,{default:s(()=>[(i(!0),y(k,null,D(x.value,f=>(i(),_(B,{key:f.id,value:f.id,onClick:me=>w(r.id,f.id,v.value.id)},{default:s(()=>[N(A(f.label),1)]),_:2},1032,["value","onClick"]))),128))]),_:2},1024),(i(!0),y(k,null,D(x.value,f=>(i(),_(j,{key:f.id,value:f.id},null,8,["value"]))),128))]),_:2},1032,["value"])):P("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),p("div",ve,[d.value&&u.value?(i(),y("div",ce,[n(W,{modelValue:v.value,"onUpdate:modelValue":e[3]||(e[3]=r=>v.value=r),options:V.value,optionLabel:"label",placeholder:"选择日期",onChange:e[4]||(e[4]=r=>w(d.value,u.value,v.value.id))},null,8,["modelValue","options"]),e[5]||(e[5]=p("label",null," 日",-1))])):P("",!0),n(Z,{value:a.value,stripedRows:"",scrollable:"",scrollHeight:"flex",paginator:"",rows:10,rowsPerPageOptions:[5,10,20,50],tableStyle:"min-width: 50rem"},{empty:s(()=>e[6]||(e[6]=[p("div",{class:"text-center py-5"},[p("i",{class:"pi pi-search",style:{"font-size":"3rem",color:"#ccc"}}),p("p",{class:"mt-3 text-gray-500"},"未找到销售量")],-1)])),default:s(()=>[n($,{field:"id",header:"ID",sortable:""}),n($,{field:"category",header:"类型",sortable:""}),n($,{field:"name",header:"菜名"}),n($,{field:"orderQuantity",header:(d.value===0?"":u.value===0?"当年":v.value.id===0?"当月":"当日")+"销售量"},{body:s(({data:r})=>[N(A((d.value===0?r.orders:u.value===0?r.yearlyOrders:v.value.id===0?r.monthlyOrders:r.dailyOrders)|0),1)]),_:1},8,["header"])]),_:1},8,["value"])])]),n(G)])}}};export{Ne as default};
