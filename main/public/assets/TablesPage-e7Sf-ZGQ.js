import{s as X}from"./index-ClVmIslX.js";import{s as le}from"./index-G8gWUG9P.js";import{b as Q}from"./index-C56aUkVD.js";import{q as I,s as J,f as q,o as T,w as f,a as r,d as o,h,n as C,c as O,e as x,F as H,E as se,t as $,l as N,A as K,z as oe,u as te,x as Y,i as ne,H as ie,C as z,J as ee}from"./index-D-RkkGsY.js";import{s as re}from"./index-BSQ46CDi.js";import{s as ae}from"./index-DqdUDV3X.js";import{s as ue}from"./index-B8ZUGiRB.js";import{s as de}from"./index-BCEMFhBt.js";import{s as ce}from"./index-BE1mZxWs.js";import{s as pe}from"./index-Ekiya4UA.js";import{Q as me,C as W}from"./browser-r20zGpaY.js";import{_ as be}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{s as ve}from"./index-R6vz7YKb.js";import{a as fe,s as ge}from"./index-DXg39W4a.js";import"./index-CunorRuX.js";import"./index-2RIdNqwc.js";import"./index-iANNW2HI.js";import"./index--u8_rOZ8.js";import"./index-CtPqjCsY.js";import"./_commonjsHelpers-gnU0ypJ3.js";import"./index-BHmslPJb.js";import"./index-CFjgLPQE.js";import"./index-C8lYWL95.js";import"./index-DxL9AK21.js";import"./index-DwSfRZrK.js";const ye={class:"p-menuitem-content"},Te={__name:"TableMenuBar",props:{filterStatu:String},setup(E){const{t:m}=I(),a=J(()=>[{label:m("tablesPage.all"),value:"Todos",icon:"pi pi-circle-fill",severity:"contrast"},{label:m("tablesPage.available"),value:"Livre",icon:"pi pi-circle-fill",severity:"success"},{label:m("tablesPage.dining"),value:"Ocupado",icon:"pi pi-circle-fill",severity:"danger"},{label:m("tablesPage.reserved"),value:"Reservado",icon:"pi pi-circle-fill",severity:"info"},{label:m("tablesPage.paid"),value:"Pago",icon:"pi pi-circle-fill",severity:"help"}]);return(P,b)=>{const p=Q,v=re;return T(),q(v,{model:a.value,breakpoint:"355px",class:"border-0"},{item:f(({item:c})=>[r("div",ye,[o(p,{label:c.label,icon:c.icon,severity:c.severity,variant:"outlined",raised:"",onClick:w=>P.$emit("update:filterStatu",c.value)},null,8,["label","icon","severity","onClick"])])]),_:1},8,["model"])}}},he={class:"overflow-auto",style:{height:"calc(100vh - 250px)"}},Pe={class:"grid m-2"},$e={class:"flex justify-content-center align-items-center w-100"},_e={class:"relative"},we={class:"text-center text-2xl font-bold"},ke={key:0},Ce={class:"text-center"},xe={class:"text-center text-lg"},Se={class:"text-center text-lg font-bold"},Ne={key:1,class:"flex flex-wrap justify-content-center"},Oe={class:"font-bold text-xl"},Ee={class:"ont-bold"},Me={class:"flex flex-wrap justify-content-end mt-3"},De={__name:"TableGrid",props:{filteredTables:Array,editMode:Boolean},emits:["openTableDetail","removeTable","addNewTable"],setup(E,{emit:m}){const{t:a}=I(),P=h(!1),b=h(),p=h(!1),v=h({nif:void 0,note:void 0}),c=J(()=>[{label:a("tablesPage.available"),value:"Livre"},{label:a("tablesPage.dining"),value:"Ocupado"},{label:a("tablesPage.reserved"),value:"Reservado"},{label:a("tablesPage.paid"),value:"Pago"}]);function w(u){return c.value.find(n=>n.value===u)}function j(u){return Number(u.peopleType.children)+Number(u.peopleType.adults)}function s(u){return!u||!Array.isArray(u)?0:parseFloat(u.reduce((n,g)=>n+g.price*g.quantity,0).toFixed(2))}function A(u){const n=C.getCurrenPeoplePrice();return Number(u.peopleType.children)*n.children+Number(u.peopleType.adults)*n.adults}function F(u){return s(u.order)+A(u)}function U(u){const n="m-1 border-3 border-gray-500 ";let g="";switch(u){case"Livre":break;case"Ocupado":g="border-red-300 bg-red-100";break;case"Reservado":g="border-blue-300 bg-blue-100";break;case"Pago":g="border-purple-300 bg-purple-100";break;default:g="border-gray-500 bg-gray-100"}return n+g}function M(u,n){n=="pay"?(v.value=u.nif_note,p.value=!0):u["msg_"+n]=!1,C.socket.emit("click_msg",u.id,{cmd:n})}function R(){document.getElementById("tipsAudio").play()}return C.playSoundFun=R,(u,n)=>{const g=Q,B=ue,L=le,D=X,V=ae;return T(),O(H,null,[r("div",he,[r("div",Pe,[n[7]||(n[7]=r("audio",{id:"tipsAudio",src:"/sound/tips.mp3",preload:"auto"},null,-1)),E.editMode?(T(),q(B,{key:0,class:"m-1 border-3 border-gray-500 flex justify-content-center align-items-center",style:{"min-width":"150px","min-height":"150px","max-width":"175px","max-height":"175px"},onClick:n[0]||(n[0]=d=>P.value=!0)},{content:f(()=>[r("div",$e,[o(g,{text:"",icon:"pi pi-plus",severity:"contrast",size:"large"})])]),_:1})):x("",!0),(T(!0),O(H,null,se(E.filteredTables,d=>(T(),q(B,{class:oe(U(d.status)),style:{"min-width":"150px","min-height":"150px","max-width":"175px","max-height":"175px"},onClick:l=>E.editMode?"":u.$emit("openTableDetail",d.id)},{header:f(()=>[r("div",_e,[d.msg_pay?(T(),q(g,{key:0,onClick:K(l=>M(d,"pay"),["stop"]),icon:"pi pi-credit-card",rounded:"",raised:"",severity:"danger",class:"absolute",style:{top:"-13px",right:"5px","z-index":"10"}},null,8,["onClick"])):x("",!0),d.msg_call?(T(),q(g,{key:1,onClick:K(l=>M(d,"call"),["stop"]),icon:"pi pi-bell",rounded:"",raised:"",severity:"danger",class:"absolute",style:{top:"-13px",right:"60px","z-index":"10"}},null,8,["onClick"])):x("",!0)])]),content:f(()=>[r("p",we,$(N(a)("tablesPage.tableNum"))+": "+$(d.id),1),E.editMode?x("",!0):(T(),O("div",ke,[r("p",Ce,$(w(d.status).label),1),r("p",xe,$(j(d)+" "+N(a)("tablesPage.people")),1),r("p",Se,$(F(d))+"€",1)])),E.editMode?(T(),O("div",Ne,[o(g,{icon:"pi pi-trash",severity:"danger",outlined:"",raised:"",class:"m-2",onClick:K(l=>u.$emit("removeTable",d.id),["stop"])},null,8,["onClick"])])):x("",!0)]),_:2},1032,["class","onClick"]))),256))])]),o(D,{visible:p.value,"onUpdate:visible":n[1]||(n[1]=d=>p.value=d),modal:!0,dismissableMask:!0,header:u.$t("tablesPage.payInfo"),style:{"min-width":"300px","max-width":"450px"},onHide:n[2]||(n[2]=d=>v.value={nif:void 0,note:void 0})},{default:f(()=>{var d,l;return[r("label",Oe,"NIF:"+$((d=v.value)!=null&&d.nif?v.value.nif:N(a)("tablesPage.noNif")),1),o(L),r("label",Ee,$(N(a)("tablesPage.note"))+": "+$((l=v.value)!=null&&l.note?v.value.note:N(a)("tablesPage.noNote")),1)]}),_:1},8,["visible","header"]),o(D,{visible:P.value,"onUpdate:visible":n[5]||(n[5]=d=>P.value=d),modal:!0,dismissableMask:!0,header:u.$t("tablesPage.addTable"),onHide:n[6]||(n[6]=d=>b.value=void 0)},{default:f(()=>[o(V,{modelValue:b.value,"onUpdate:modelValue":n[3]||(n[3]=d=>b.value=d),inputId:"horizontal-buttons",showButtons:"",buttonLayout:"horizontal",prefix:`${N(a)("tablesPage.tableNum")}：${b.value<10?"0":""}`,step:1,min:1,max:9999,placeholder:u.$t("tablesPage.enterTable"),fluid:""},{incrementbuttonicon:f(()=>n[8]||(n[8]=[r("span",{class:"pi pi-plus"},null,-1)])),decrementbuttonicon:f(()=>n[9]||(n[9]=[r("span",{class:"pi pi-minus"},null,-1)])),_:1},8,["modelValue","prefix","placeholder"]),r("div",Me,[o(g,{label:u.$t("tablesPage.createTable"),onClick:n[4]||(n[4]=d=>{u.$emit("addNewTable",b.value),P.value=!1})},null,8,["label"])])]),_:1},8,["visible","header"])],64)}}},Ve={class:"flex flex-column justify-content-center align-items-center"},qe={for:"Total"},je={key:0,class:"flex flex-wrap justify-content-center align-items-center"},Ae={for:"Adult"},Be={key:1,class:"flex flex-wrap justify-content-center align-items-center"},Ue={for:"Children"},Fe={class:"flex flex-wrap justify-content-center align-items-center m-2"},Re={class:"flex flex-wrap justify-content-center align-items-center m-3 mb-5"},Le={class:"m-2"},ze={key:0,class:"flex flex-wrap justify-content-between align-items-center"},Je={key:1,class:"flex flex-wrap justify-content-between align-items-center"},He={class:"flex flex-column"},Qe={__name:"TableDetail",props:{selectedTable:Object,isEditTable:Boolean},emits:["tableEditConfirm","cleanTable","showTableOrders","onEdit"],setup(E,{emit:m}){const{t:a}=I();let P=!1;const b=te(),p=h(!1),v=h(!1),c=E,w=m;function j(){w("onEdit",c.selectedTable.id,l=>{s.value=JSON.parse(JSON.stringify(l)),p.value=!0})}const s=h(JSON.parse(JSON.stringify(c.selectedTable))),A=h([{label:a("tablesPage.available"),value:"Livre",severity:"success"},{label:a("tablesPage.dining"),value:"Ocupado",severity:"danger"},{label:a("tablesPage.reserved"),value:"Reservado",severity:"info"},{label:a("tablesPage.paid"),value:"Pago",severity:"help"}]);function F(){P||(v.value=!1,s.value=JSON.parse(JSON.stringify(c.selectedTable))),P=!1}const U=J(()=>Number(s.value.peopleType.children)+Number(s.value.peopleType.adults));function M(){s.value.status?(w("tableEditConfirm",s.value,l=>{(l==null?void 0:l.success)==!0?(b.add({severity:"success",summary:a("common.success"),detail:l.message,life:3e3}),p.value=!1):b.add({severity:"error",summary:a("common.error"),detail:l.message,life:3e3})}),v.value=!1,P=!0):b.add({severity:"error",summary:a("common.error"),detail:a("tablesPage.stateError"),life:3e3})}function R(){v.value=!0}function u(){p.value=!1,s.value=JSON.parse(JSON.stringify(c.selectedTable))}function n(){return A.value.find(l=>l.value===s.value.status)}function g(l,e){const t=Number(e);if(l==="Adult"){Number(s.value.peopleType.adults)+t<=0?s.value.peopleType.adults=0:s.value.peopleType.adults=Number(s.value.peopleType.adults)+t,s.value.people=Number(s.value.peopleType.adults)+Number(s.value.peopleType.children);return}if(l==="Children"){s.value.peopleType.children+t<=0?s.value.peopleType.children=0:s.value.peopleType.children=Number(s.value.peopleType.children)+t,s.value.people=Number(s.value.peopleType.adults)+Number(s.value.peopleType.children);return}}const B=Y(),L=()=>{B.require({message:a("tablesPage.clearMsg.1")+s.value.id+a("tablesPage.clearMsg.2"),header:a("tablesPage.confirmClear"),icon:"pi pi-info-circle",rejectLabel:a("common.cancel"),rejectProps:{label:a("common.cancel"),severity:"secondary",outlined:!0},acceptProps:{label:a("common.confirm"),severity:"danger"},accept:()=>{w("cleanTable",s.value.id,l=>{(l==null?void 0:l.success)===!1?b.add({severity:"error",summary:a("common.error"),detail:l.message,life:3e3}):(l==null?void 0:l.success)===!0&&b.add({severity:"success",summary:a("common.success"),detail:`${a("tablesPage.clearSucMsg.1")}${s.value.id}${a("tablesPage.clearSucMsg.2")}`,life:3e3})})},reject:()=>{b.add({severity:"error",summary:a("common.operation"),detail:`${a("tablesPage.clearCancelMsg.1")}${s.value.id}${a("tablesPage.clearCancelMsg.2")}`,life:3e3})}})},D=h(null);function V(){window.open(window.env.QR_ADDR+W.SimpleEncode(c.selectedTable.id),"_blank")}const d=async()=>{if(D.value)try{await me.toCanvas(D.value,window.env.QR_ADDR+W.SimpleEncode(c.selectedTable.id),{width:175,margin:2,color:{dark:"#000000",light:"#ffffff"}})}catch(l){console.error("生成二维码失败:",l)}};return ne(()=>{d()}),ie(()=>window.env.QR_ADDR+W.SimpleEncode(c.selectedTable.id),d),(l,e)=>{var Z,k;const t=pe,i=ce,y=Q,S=de,G=X;return T(),O(H,null,[r("div",Ve,[r("div",null,[o(i,{class:"m-2",variant:"on"},{default:f(()=>[o(t,{id:"Total",modelValue:U.value,"onUpdate:modelValue":e[0]||(e[0]=_=>U.value=_),autocomplete:"off",disabled:""},null,8,["modelValue"]),r("label",qe,$(N(a)("tablesPage.totalPeople")),1)]),_:1})]),p.value?(T(),O("div",je,[o(y,{icon:"pi pi-minus",rounded:"","aria-label":"Filter",size:"small",onClick:e[1]||(e[1]=_=>g("Adult",-1))}),o(i,{class:"m-2",variant:"on"},{default:f(()=>[o(t,{id:"Adult",modelValue:s.value.peopleType.adults,"onUpdate:modelValue":e[2]||(e[2]=_=>s.value.peopleType.adults=_),autocomplete:"off"},null,8,["modelValue"]),r("label",Ae,$(N(a)("tablesPage.adult")),1)]),_:1}),o(y,{icon:"pi pi-plus",rounded:"","aria-label":"Filter",size:"small",onClick:e[3]||(e[3]=_=>g("Adult",1))})])):x("",!0),p.value?(T(),O("div",Be,[o(y,{icon:"pi pi-minus",rounded:"","aria-label":"Filter",size:"small",onClick:e[4]||(e[4]=_=>g("Children",-1))}),o(i,{class:"m-2",variant:"on"},{default:f(()=>[o(t,{id:"Children",modelValue:s.value.peopleType.children,"onUpdate:modelValue":e[5]||(e[5]=_=>s.value.peopleType.children=_),autocomplete:"off"},null,8,["modelValue"]),r("label",Ue,$(N(a)("tablesPage.child")),1)]),_:1}),o(y,{icon:"pi pi-plus",rounded:"","aria-label":"Filter",size:"small",onClick:e[6]||(e[6]=_=>g("Children",1))})])):x("",!0)]),r("div",Fe,[p.value?x("",!0):(T(),q(y,{key:0,icon:"pi pi-circle-fill",variant:"outlined",label:(Z=n())==null?void 0:Z.label,severity:(k=n())==null?void 0:k.severity,onClick:R},null,8,["label","severity"])),p.value?(T(),q(S,{key:1,modelValue:s.value.status,"onUpdate:modelValue":e[7]||(e[7]=_=>s.value.status=_),options:A.value,optionLabel:"label",optionValue:"value",allowEmptySelection:!1,allowEmpty:"",invalid:s.value.status===null},null,8,["modelValue","options","invalid"])):x("",!0)]),r("div",Re,[r("canvas",{ref_key:"qrCanvas",ref:D,class:"p-1",style:{border:"2px solid #b0b0b0","border-radius":"10px"},onClick:V},null,512)]),r("div",Le,[p.value?x("",!0):(T(),O("div",ze,[o(y,{label:l.$t("tablesPage.orderDetails"),severity:"success",onClick:e[8]||(e[8]=()=>l.$emit("showTableOrders"))},null,8,["label"]),o(y,{label:l.$t("tablesPage.clear"),onClick:L,severity:"danger",class:"m-1"},null,8,["label"]),o(y,{label:l.$t("tablesPage.edit"),onClick:j,class:"m-1"},null,8,["label"])])),p.value?(T(),O("div",Je,[o(y,{label:l.$t("tablesPage.cancelEdit"),severity:"danger",raised:"",class:"m-2",onClick:u},null,8,["label"]),o(y,{label:l.$t("tablesPage.saveEdit"),severity:"success",raised:"",class:"m-2",onClick:M},null,8,["label"])])):x("",!0)]),o(G,{visible:v.value,"onUpdate:visible":e[10]||(e[10]=_=>v.value=_),modal:"",header:l.$t("tablesPage.editState"),closable:!0,dismissableMask:!0,onHide:F},{default:f(()=>[r("div",He,[o(S,{modelValue:s.value.status,"onUpdate:modelValue":e[9]||(e[9]=_=>s.value.status=_),options:A.value,optionLabel:"label",optionValue:"value",allowEmptySelection:!1,allowEmpty:"",invalid:s.value.status===null},null,8,["modelValue","options","invalid"]),o(y,{label:l.$t("common.confirm"),class:"mt-3",onClick:M},null,8,["label"])])]),_:1},8,["visible","header"])],64)}}},Ie=be(Qe,[["__scopeId","data-v-fd40c96d"]]),Ze={class:"flex flex-column"},Ge={key:0},Ke=["disabled","onClick"],We={class:"text-center py-5"},Xe={class:"text-gray-500"},Ye={class:"flex flex-wrap justify-content-end justify-content-between align-items-center mt-1"},el={class:"font-bold"},ll={__name:"TableOrderView",props:{selectedTable:Object},emits:["saveOrder","cancelOrderEdit","showToast"],setup(E,{emit:m}){var l;const{t:a}=I(),P=E,b=m,p=h((l=P.selectedTable.order)==null?void 0:l.sort((e,t)=>t.price-e.price).filter(e=>e.quantity!=0)),v=h(p.value.filter(e=>e.price!=0)),c=h([]),w=h(!1),j=h(!1),s=h();A();function A(){C.getPeoplePricesData(s,P.selectedTable.id)}const F=J(()=>{const e=U(),t=p.value.reduce((i,y)=>i+y.price*y.quantity,0);return(e+t).toFixed(2)});function U(){if(!s.value)return 0;let e=0;for(const t in s.value)e+=Number(s.value[t].totalPrice);return e}const M=J(()=>{for(const e in s.value)if(s.value[e].price==0)return!1;return!0});function R(e){let t=0;return e.forEach(i=>{t+=i.price*i.quantity}),t.toFixed(2)}function u(){w.value=!w.value,!w.value&&c.value.length>0&&d()}function n(e){if(c.value.find(t=>t.dishid===e.dishid))c.value.find(t=>t.dishid===e.dishid).quantity+=1;else{const t={...e,quantity:1};c.value.push(t)}e.quantity-=1}function g(){let e="| ";return c.value.forEach(t=>{const i=p.value.find(y=>y.dishid===t.dishid);i&&(e+=t.dishid+"-"+C.getDishName(t)+" "+(i.quantity+t.quantity)+" -> "+i.quantity+` | 
`)}),e}function B(e){b("cancelOrderEdit"),b("showToast","error",a("common.operation"),a("tablesPage.editCancelMsg")+`
`+e),c.value.forEach(t=>{p.value.find(i=>i.dishid===t.dishid).quantity+=t.quantity}),c.value=[]}function L(e){var t;b("saveOrder",c.value),b("showToast","info",a("common.operation"),a("tablesPage.ediSucMsg")+`
`+e),c.value=[],p.value=(t=P.selectedTable.order)==null?void 0:t.sort((i,y)=>y.price-i.price).filter(i=>i.quantity!=0)}const D=Y();function V(e){return Array.isArray(e)?e.map(ee):ee(e)}const d=()=>{let e=!1;const t=V(g());D.require({message:t,escape:!0,header:a("tablesPage.editOrder"),rejectLabel:a("common.cancel"),rejectProps:{label:a("common.cancel"),severity:"secondary",outlined:!0},acceptProps:{label:a("common.save"),severity:"danger"},accept:()=>{e=!0,L(t)},reject:()=>{e=!0,B(t)},onHide:()=>{e||B(t)}})};return(e,t)=>{const i=fe,y=ge,S=ae,G=ve,Z=Q;return T(),O(H,null,[r("div",null,[r("div",Ze,[M.value?(T(),q(y,{key:0,value:s.value},{default:f(()=>[o(i,{field:"peopleType",header:N(a)("tablesPage.peopleType")},{body:f(({data:k})=>[z($(N(a)("tablesPage."+(k.peopleType.toLowerCase().includes("adult")?"adult":"child"))),1)]),_:1},8,["header"]),o(i,{field:"price",header:N(a)("tablesPage.price")},null,8,["header"]),o(i,{field:"quantity",header:N(a)("tablesPage.quantity")},null,8,["header"]),o(i,{field:"totalPrice",header:N(a)("tablesPage.totalPrice")},null,8,["header"])]),_:1},8,["value"])):x("",!0)]),o(y,{value:j.value?v.value:p.value,scrollable:"",scrollHeight:"flex",style:{"max-height":"350px"}},{empty:f(()=>[r("div",We,[r("p",Xe,$(e.$t("tablesPage.noOrder")),1)])]),default:f(()=>[o(i,{field:"dishid",header:"ID"}),o(i,{header:e.$t("tablesPage.name")},{body:f(k=>[z($(N(C).getDishName(k.data)),1)]),default:f(()=>[t[2]||(t[2]=z(" > ",-1))]),_:1,__:[2]},8,["header"]),o(i,{field:"price",header:e.$t("tablesPage.price")},null,8,["header"]),o(i,{field:"quantity",header:e.$t("tablesPage.quantity")},{body:f(k=>[w.value?x("",!0):(T(),O("label",Ge,$(k.data.quantity),1)),w.value?(T(),q(S,{key:1,modelValue:k.data.quantity,"onUpdate:modelValue":_=>k.data.quantity=_,inputId:"minmax-buttons",mode:"decimal",showButtons:"",min:0,style:{width:"5rem"},fluid:"",inputStyle:{cursor:"not-allowed","background-color":"#f5f5f5"},readonly:""},{incrementbuttonicon:f(()=>t[3]||(t[3]=[r("span",{style:{display:"none"}},null,-1)])),decrementbuttonicon:f(()=>[r("span",{class:"p-inputnumber-button-icon",disabled:k.data.quantity<=0,onClick:_=>n(k.data)},t[4]||(t[4]=[r("i",{class:"pi pi-angle-down"},null,-1)]),8,Ke)]),_:2},1032,["modelValue","onUpdate:modelValue"])):x("",!0)]),_:1},8,["header"]),o(i,{header:e.$t("tablesPage.totalPrice")},{body:f(k=>[z($(R([k.data])),1)]),default:f(()=>[t[5]||(t[5]=z(" > ",-1))]),_:1,__:[5]},8,["header"])]),_:1},8,["value"])]),r("div",Ye,[r("label",el,$(e.$t("tablesPage.total")+": ")+" "+$(F.value),1),r("label",null,[o(G,{modelValue:j.value,"onUpdate:modelValue":t[0]||(t[0]=k=>j.value=k)},null,8,["modelValue"]),z(" "+$(e.$t("tablesPage.showNonZero")),1)]),o(Z,{label:w.value?e.$t("common.save"):e.$t("common.edit"),onClick:t[1]||(t[1]=k=>u())},null,8,["label"])])],64)}}},tl={class:"flex flex-wrap justify-content-between align-items-center m-1"},Sl={__name:"TablesPage",setup(E){const{t:m}=I(),a=Y(),P=h("Todos"),b=h(!1),p=h(!1),v=h({id:0}),c=h(!1),w=h({}),j=J(()=>P.value==="Todos"?C.tables.value:C.tables.value.filter(l=>l.status===P.value));function s(){b.value=!0}function A(){b.value==!0&&(b.value=!1)}function F(l){a.require({message:m("tablesPage.removeTableMsg.1")+l+m("tablesPage.removeTableMsg.2"),header:m("tablesPage.removeTableHeader"),icon:"pi pi-trash",rejectProps:{label:m("common.cancel"),severity:"secondary",outlined:!0},acceptProps:{label:m("common.confirm"),severity:"danger"},accept:()=>{const e=C.deleteTable(l);e!=null?V.add({severity:"error",summary:e.title,detail:e.message,life:3e3}):V.add({severity:"info",summary:m("common.success"),detail:m("tablesPage.removeSucMsg.1")+l+m("tablesPage.removeSucMsg.2"),life:3e3})},reject:()=>{}})}async function U(l){l<10&&(l="0"+l);const e=await C.addNewTable(l);e!==void 0?V.add({severity:"error",summary:e.title,detail:e.message,life:3e3}):V.add({severity:"info",summary:m("common.success"),detail:m("tablesPage.createSucMsg.1")+l+m("tablesPage.createSucMsg.2"),life:3e3})}function M(l){const e=C.tables.value.find(t=>t.id===l);v.value={...e,order:(e==null?void 0:e.order)||[]}}function R(l,e){const t=C.tables.value.find(i=>i.id===l);v.value={...t,order:(t==null?void 0:t.order)||[]},e(v.value)}function u(l){M(l),p.value=!0}function n(l,e){const t={id:l.id,status:l.status,peopleType:{adults:l.peopleType.adults,children:l.peopleType.children}},i=C.updateTable(t);M(l.id),e(i?{success:!1,message:m("tablesPage.updateFailMsg")}:{success:!0,message:m("tablesPage.updateSucMsg")})}function g(l,e){const t=C.tableClean(l);t?(console.log("cleanTable Error:",t),e({success:!1,message:m("tablesPage.updateFailMsg")})):(p.value=!1,e({success:!0,message:m("tablesPage.updateSucMsg")}))}function B(){const l=v.value.id;M(l),c.value=!0}function L(l){C.deleteOrders(v.value.id,l),w.value.order&&(C.deleteOrder(w.value),w.value={})}function D(){C.refreshTables()}const V=te();function d(l,e,t,i){V.add({severity:l||"",summary:e||"",detail:t||"",life:i||3e3})}return(l,e)=>{const t=Q,i=le,y=X;return T(),O(H,null,[r("div",tl,[o(Te,{filterStatu:P.value,"onUpdate:filterStatu":e[0]||(e[0]=S=>P.value=S)},null,8,["filterStatu"]),b.value?x("",!0):(T(),q(t,{key:0,icon:"pi pi-pencil",label:l.$t("tablesPage.editTables"),class:"mr-3",onClick:s},null,8,["label"])),b.value?(T(),q(t,{key:1,label:l.$t("tablesPage.closeEdit"),class:"mr-3",onClick:A},null,8,["label"])):x("",!0)]),o(i,{class:"m-0"}),o(De,{filteredTables:j.value,"onUpdate:filteredTables":e[1]||(e[1]=S=>j.value=S),editMode:b.value,"onUpdate:editMode":e[2]||(e[2]=S=>b.value=S),onOpenTableDetail:u,onRemoveTable:F,onAddNewTable:U},null,8,["filteredTables","editMode"]),o(y,{visible:p.value,"onUpdate:visible":e[3]||(e[3]=S=>p.value=S),header:l.$t("tablesPage.tableNum")+": "+v.value.id,modal:!0,dismissableMask:!0,style:{"min-width":"350px","max-width":"550px"}},{default:f(()=>[o(Ie,{selectedTable:v.value,onTableEditConfirm:n,onCleanTable:g,onShowTableOrders:B,onOnEdit:R},null,8,["selectedTable"])]),_:1},8,["visible","header"]),o(y,{visible:c.value,"onUpdate:visible":e[4]||(e[4]=S=>c.value=S),modal:!0,dismissableMask:!0,header:l.$t("tablesPage.orderDetails"),style:{"min-width":"350px","max-width":"550px"},onHide:e[5]||(e[5]=S=>D())},{default:f(()=>[o(ll,{selectedTable:v.value,onSaveOrder:L,onCancelOrderEdit:D,onShowToast:d},null,8,["selectedTable"])]),_:1},8,["visible","header"])],64)}}};export{Sl as default};
