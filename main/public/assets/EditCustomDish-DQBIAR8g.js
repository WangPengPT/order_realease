import{e as ie,a as de}from"./index-CscEyC6p.js";import{s as re}from"./index-DJyW-GwU.js";import{R as ue,b as q,s as pe,f as me}from"./index-uD2cSJxs.js";import{B as ce,b as fe,c as g,o as f,a as d,d as n,r as $,e as N,m as v,t as C,z as ge,w as s,f as H,g as he,y as ve,au as ye,T as z,u as be,q as we,aH as Ve,h as _,s as L,i as _e,aV as Pe,F as Y,E as $e,n as O,j as De,l as Se,C as Q,p as ke}from"./index-CgDZ4GJr.js";import{s as Te}from"./index-BOyY-Gzb.js";import{s as Ce,a as Ne}from"./index-BE3UxmbC.js";import{s as Ue}from"./index-Dj_Ws9bm.js";import{s as Be}from"./index-D00gK90F.js";import{s as Ee}from"./index-DdzNMLSm.js";import{s as Re}from"./index-Cg20W0sS.js";import{s as Ae}from"./index-DtF1Ubg3.js";import{M as D}from"./MsgBox-CkEAX6bb.js";import{_ as Ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-D1ss2oQe.js";import"./index-CQpaoM5g.js";import"./index-kh5DRU5c.js";import"./index-Dc1msgbp.js";import"./index-DaNol_5f.js";import"./index-KE-6xnJo.js";import"./index-DUJsCmOF.js";import"./index--0XIPXCF.js";var Le=`
    .p-panel {
        display: block;
        border: 1px solid dt('panel.border.color');
        border-radius: dt('panel.border.radius');
        background: dt('panel.background');
        color: dt('panel.color');
    }

    .p-panel-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: dt('panel.header.padding');
        background: dt('panel.header.background');
        color: dt('panel.header.color');
        border-style: solid;
        border-width: dt('panel.header.border.width');
        border-color: dt('panel.header.border.color');
        border-radius: dt('panel.header.border.radius');
    }

    .p-panel-toggleable .p-panel-header {
        padding: dt('panel.toggleable.header.padding');
    }

    .p-panel-title {
        line-height: 1;
        font-weight: dt('panel.title.font.weight');
    }

    .p-panel-content {
        padding: dt('panel.content.padding');
    }

    .p-panel-footer {
        padding: dt('panel.footer.padding');
    }
`,Oe={root:function(u){var U=u.props;return["p-panel p-component",{"p-panel-toggleable":U.toggleable}]},header:"p-panel-header",title:"p-panel-title",headerActions:"p-panel-header-actions",pcToggleButton:"p-panel-toggle-button",contentContainer:"p-panel-content-container",content:"p-panel-content",footer:"p-panel-footer"},ze=ce.extend({name:"panel",style:Le,classes:Oe}),Je={name:"BasePanel",extends:pe,props:{header:String,toggleable:Boolean,collapsed:Boolean,toggleButtonProps:{type:Object,default:function(){return{severity:"secondary",text:!0,rounded:!0}}}},style:ze,provide:function(){return{$pcPanel:this,$parentInstance:this}}},G={name:"Panel",extends:Je,inheritAttrs:!1,emits:["update:collapsed","toggle"],data:function(){return{d_collapsed:this.collapsed}},watch:{collapsed:function(u){this.d_collapsed=u}},methods:{toggle:function(u){this.d_collapsed=!this.d_collapsed,this.$emit("update:collapsed",this.d_collapsed),this.$emit("toggle",{originalEvent:u,value:this.d_collapsed})},onKeyDown:function(u){(u.code==="Enter"||u.code==="NumpadEnter"||u.code==="Space")&&(this.toggle(u),u.preventDefault())}},computed:{buttonAriaLabel:function(){return this.toggleButtonProps&&this.toggleButtonProps.ariaLabel?this.toggleButtonProps.ariaLabel:this.header},dataP:function(){return me({toggleable:this.toggleable})}},components:{PlusIcon:re,MinusIcon:ie,Button:q},directives:{ripple:ue}},Me=["data-p"],Ke=["data-p"],Fe=["id"],je=["id","aria-labelledby"];function We(o,u,U,m,b,y){var r=fe("Button");return f(),g("div",v({class:o.cx("root"),"data-p":y.dataP},o.ptmi("root")),[d("div",v({class:o.cx("header"),"data-p":y.dataP},o.ptm("header")),[$(o.$slots,"header",{id:o.$id+"_header",class:ge(o.cx("title"))},function(){return[o.header?(f(),g("span",v({key:0,id:o.$id+"_header",class:o.cx("title")},o.ptm("title")),C(o.header),17,Fe)):N("",!0)]}),d("div",v({class:o.cx("headerActions")},o.ptm("headerActions")),[$(o.$slots,"icons"),o.toggleable?$(o.$slots,"togglebutton",{key:0,collapsed:b.d_collapsed,toggleCallback:function(S){return y.toggle(S)},keydownCallback:function(S){return y.onKeyDown(S)}},function(){return[n(r,v({id:o.$id+"_header",class:o.cx("pcToggleButton"),"aria-label":y.buttonAriaLabel,"aria-controls":o.$id+"_content","aria-expanded":!b.d_collapsed,unstyled:o.unstyled,onClick:u[0]||(u[0]=function(h){return y.toggle(h)}),onKeydown:u[1]||(u[1]=function(h){return y.onKeyDown(h)})},o.toggleButtonProps,{pt:o.ptm("pcToggleButton")}),{icon:s(function(h){return[$(o.$slots,o.$slots.toggleicon?"toggleicon":"togglericon",{collapsed:b.d_collapsed},function(){return[(f(),H(he(b.d_collapsed?"PlusIcon":"MinusIcon"),v({class:h.class},o.ptm("pcToggleButton").icon),null,16,["class"]))]})]}),_:3},16,["id","class","aria-label","aria-controls","aria-expanded","unstyled","pt"])]}):N("",!0)],16)],16,Ke),n(z,v({name:"p-toggleable-content"},o.ptm("transition")),{default:s(function(){return[ve(d("div",v({id:o.$id+"_content",class:o.cx("contentContainer"),role:"region","aria-labelledby":o.$id+"_header"},o.ptm("contentContainer")),[d("div",v({class:o.cx("content")},o.ptm("content")),[$(o.$slots,"default")],16),o.$slots.footer?(f(),g("div",v({key:0,class:o.cx("footer")},o.ptm("footer")),[$(o.$slots,"footer")],16)):N("",!0)],16,je),[[ye,!b.d_collapsed]])]}),_:3},16)],16,Me)}G.render=We;const Ye={class:"flex flex-column w-full h-full"},Qe={class:"fixed top-0 left-0 right-0 z-1"},qe={class:"w-full h-full p-4"},He={class:"flex flex-row w-full h-full"},Ge={class:"w-full"},Xe={class:"relative w-full h-full"},Ze={class:"flex flex-column w-full"},xe={class:"flex items-center gap-2 w-full"},eo={key:0,class:"w-full"},oo={key:0},to={key:1},no={key:1},lo={class:"font-bold p-3"},ao={key:0},so={key:1},io={__name:"EditCustomDish",setup(o){const u=be(),U=De(),{t:m}=we(),b=Ve();D.toast=u;const y=b.params.dishId,r=_(void 0),h=_([]),S=L(()=>{var l;return((l=r.value)==null?void 0:l.name)||""}),B=_(void 0),I=L(()=>!r.value||!B.value?!1:JSON.stringify(r.value)!==JSON.stringify(B.value)),J=_([{label:m("common.delete"),icon:"pi pi-times"}]);function X(){U.push(ke.mainPath.editableCustomeDish.path)}function Z(){if(!I.value){D.show_info(m("notification.noChanges"));return}console.log("current dish",r.value),O.customDishApi.updateCustomDish(r.value,l=>{l.success?(D.show_success(m("notification.updateSuccess")),B.value=JSON.parse(JSON.stringify(r.value))):D.show_warn(m("notification.updateFailed"))})}function x(l=5e3,a=100){return new Promise((c,w)=>{const k=Date.now(),E=()=>{const T=O.customDishApi.customDishes.value;T&&T.length>0?c(T):Date.now()-k>l?w(new Error("customDishes 超时未加载")):setTimeout(E,a)};E()})}_e(async()=>{try{const a=(await x()).find(c=>String(c.id)===y);a&&(r.value=JSON.parse(JSON.stringify(a)),B.value=JSON.parse(JSON.stringify(a)),console.log("customDish.value dish:",r.value)),h.value=a.types.map(()=>!0)}catch(l){console.error(l)}});const M=_([]),K=_([]),ee=(l,a)=>{const{newData:c,index:w}=l;r.value&&(r.value.types[a].dishes[w]=c)},oe=(l,a)=>{const{newData:c,index:w}=l;r.value&&(r.value.types[a]=c)};function F(l){return`${l}€`}const j=_([{name:m("menuPage.open"),value:!0},{name:m("menuPage.close"),value:!1}]),te=(l,a)=>{h.value[a]=l.value};Pe((l,a,c)=>{if(I.value&&!confirm(m("notification.unsavedWarning")||"You have unsaved changes. Leave anyway?"))return c(!1);c()}),window.addEventListener("beforeunload",l=>{I.value&&(l.preventDefault(),l.returnValue="")});const ne=L(()=>[{name:m("menuPage.dineIn")+" & "+m("menuPage.takeAway"),code:"DINEIN&TAKEAWAY"},{name:m("menuPage.takeAway"),code:"TAKEAWAY"},{name:m("menuPage.dineIn"),code:"DINEIN"}]);function le(l,a){O.customDishApi.updateCustomDishSellType(a.id,l,c=>{c.success?D.show_success(m("notification.updateSuccess")):D.show_warn(m("notification.updateFailed"))})}return(l,a)=>{const c=Ae,w=q,k=Re,E=Ee,T=Be,p=Ne,P=Ue,R=de,W=Ce,ae=Te,se=G;return f(),g(Y,null,[n(c),d("div",Ye,[d("div",Qe,[n(T,null,{start:s(()=>[n(w,{icon:"pi pi-arrow-left",onClick:X})]),center:s(()=>[d("span",null,C(S.value),1)]),end:s(()=>[r.value?(f(),H(k,{key:0,modelValue:r.value.sellType,"onUpdate:modelValue":[a[0]||(a[0]=V=>r.value.sellType=V),a[1]||(a[1]=V=>le(V,r.value))],options:ne.value,optionLabel:"name",optionValue:"code",class:"pr-2"},null,8,["modelValue","options"])):N("",!0),n(E,{label:Se(m)("topBar.save"),model:J.value,onClick:Z},null,8,["label","model"])]),_:1})]),a[9]||(a[9]=d("div",{style:{"padding-top":"60px"}},null,-1)),d("div",qe,[d("div",He,[d("div",Ge,[d("div",Xe,[r.value?(f(!0),g(Y,{key:0},$e(r.value.types,(V,A)=>(f(),g("div",null,[d("div",Ze,[n(z,{name:"smooth-expand",mode:"out-in"},{default:s(()=>[n(se,{toggleable:"",class:"w-full",onToggle:e=>te(e,A),collapsed:!0},{header:s(()=>[d("div",xe,[n(z,{name:"slide-fade",mode:"out-in"},{default:s(()=>[h.value[A]?(f(),g("div",eo,[n(W,{value:[V],tableStyle:"min-width: 50rem",editMode:"row",class:"w-full",editingRows:K.value,"onUpdate:editingRows":a[2]||(a[2]=e=>K.value=e),onRowEditSave:e=>oe(e,A)},{default:s(()=>[n(p,{field:"id",header:"Id"}),n(p,{field:"typeName",header:l.$t("menuPage.name")},null,8,["header"]),n(p,{field:"enable",header:l.$t("menuPage.enableDisable")},{body:s(({data:e,field:t})=>[e[t]===!0?(f(),g("div",oo,a[4]||(a[4]=[d("i",{class:"pi pi-circle-fill",style:{color:"green","font-size":"1.5rem"}},null,-1)]))):(f(),g("div",to,a[5]||(a[5]=[d("i",{class:"pi pi-circle-fill",style:{color:"red","font-size":"1.5rem"}},null,-1)])))]),editor:s(({data:e,field:t})=>[n(k,{modelValue:e[t],"onUpdate:modelValue":i=>e[t]=i,options:j.value,optionLabel:"name",optionValue:"value"},null,8,["modelValue","onUpdate:modelValue","options"])]),_:1},8,["header"]),n(p,{field:"typeName_zh",header:l.$t("menuPage.nameCN")},{editor:s(({data:e,field:t})=>[n(P,{modelValue:e[t],"onUpdate:modelValue":i=>e[t]=i,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(p,{field:"typeName_pt",header:l.$t("menuPage.namePT")},{editor:s(({data:e,field:t})=>[n(P,{modelValue:e[t],"onUpdate:modelValue":i=>e[t]=i,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(p,{field:"typeName_en",header:l.$t("menuPage.nameEN")},{editor:s(({data:e,field:t})=>[n(P,{modelValue:e[t],"onUpdate:modelValue":i=>e[t]=i,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(p,{field:"minQuantity",header:l.$t("menuPage.min")},{editor:s(({data:e,field:t})=>[n(R,{modelValue:e[t],"onUpdate:modelValue":i=>e[t]=i,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(p,{field:"maxQuantity",header:l.$t("menuPage.max")},{editor:s(({data:e,field:t})=>[n(R,{modelValue:e[t],"onUpdate:modelValue":i=>e[t]=i,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(p,{rowEditor:!0,style:{width:"10%","min-width":"8rem"},bodyStyle:"text-align:center"})]),_:2},1032,["value","editingRows","onRowEditSave"])])):(f(),g("div",no,[d("span",lo,C(V.typeName),1)]))]),_:2},1024)])]),footer:s(()=>a[6]||(a[6]=[d("div",{class:"flex flex-wrap items-center justify-between gap-4"},null,-1)])),icons:s(()=>[n(ae,{ref_for:!0,ref:"menu",id:"config_menu",model:J.value,popup:""},null,8,["model"])]),default:s(()=>[d("div",null,[n(W,{value:V.dishes,editingRows:M.value,"onUpdate:editingRows":a[3]||(a[3]=e=>M.value=e),tableStyle:"min-width: 50rem",editMode:"row",onRowEditSave:e=>ee(e,A)},{default:s(()=>[n(p,{field:"dishid",header:"Id"}),n(p,{field:"name",header:l.$t("menuPage.name")},null,8,["header"]),n(p,{field:"name_zh",header:l.$t("menuPage.nameCN")},{editor:s(({data:e,field:t})=>[n(P,{modelValue:e[t],"onUpdate:modelValue":i=>e[t]=i,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(p,{field:"name_en",header:l.$t("menuPage.nameEN")},{editor:s(({data:e,field:t})=>[n(P,{modelValue:e[t],"onUpdate:modelValue":i=>e[t]=i,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(p,{field:"name_pt",header:l.$t("menuPage.namePT")},{editor:s(({data:e,field:t})=>[n(P,{modelValue:e[t],"onUpdate:modelValue":i=>e[t]=i,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(p,{field:"enable",header:l.$t("menuPage.enableDisable")},{body:s(({data:e,field:t})=>[e[t]===!0?(f(),g("div",ao,a[7]||(a[7]=[d("i",{class:"pi pi-circle-fill",style:{color:"green","font-size":"1.5rem"}},null,-1)]))):(f(),g("div",so,a[8]||(a[8]=[d("i",{class:"pi pi-circle-fill",style:{color:"red","font-size":"1.5rem"}},null,-1)])))]),editor:s(({data:e,field:t})=>[n(k,{modelValue:e[t],"onUpdate:modelValue":i=>e[t]=i,options:j.value,optionLabel:"name",optionValue:"value"},null,8,["modelValue","onUpdate:modelValue","options"])]),_:1},8,["header"]),n(p,{field:"price",header:l.$t("menuPage.price")},{body:s(({data:e,field:t})=>[Q(C(F(e[t])),1)]),editor:s(({data:e,field:t})=>[n(R,{modelValue:e[t],"onUpdate:modelValue":i=>e[t]=i,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(p,{field:"deliveryPrice",header:l.$t("menuPage.deliveryPrice")},{body:s(({data:e,field:t})=>[Q(C(F(e[t])),1)]),editor:s(({data:e,field:t})=>[n(R,{modelValue:e[t],"onUpdate:modelValue":i=>e[t]=i,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(p,{rowEditor:!0,bodyStyle:"text-align:center"})]),_:2},1032,["value","editingRows","onRowEditSave"])])]),_:2},1032,["onToggle"])]),_:2},1024)])]))),256)):N("",!0)])])])])])],64)}}},No=Ie(io,[["__scopeId","data-v-ccae70c9"]]);export{No as default};
