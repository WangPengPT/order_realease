import{g as ve,p as fe,u as K,r as d,P as ce,t as Z,Q as Ve,R as pe,f as a,m as ee,h as i,n as le,i as Q,F as ue,o as be,L as I,J as ye,E as s,H as R,S as b,M as B,I as y,D as M,N as O,O as F}from"./index-CElJKAcy.js";import{u as ke,c as ae,f as Ce,m as we,V as _,a as C,b as H,d as te}from"./VTextField-BahRdtO5.js";import{b as oe,m as ge,V as J,a as De}from"./VDialog-2qSnlFK8.js";import{v as Se,a as he,s as Ue,w as Ae,x as re,L as xe,y as Pe,V as p}from"./scopeId-hbGO-rt1.js";import{V as se,a as ne,b as N}from"./VSpacer-Im85g6TL.js";import{V as Ie}from"./VForm-9cra2PkH.js";import"./VList-LiTk8-Ju.js";const Re=fe({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...we(),...ge()},"VSwitch"),f=ve()({name:"VSwitch",inheritAttrs:!1,props:Re(),emits:{"update:focused":n=>!0,"update:modelValue":n=>!0,"update:indeterminate":n=>!0},setup(n,w){let{attrs:g,slots:u}=w;const m=K(n,"indeterminate"),v=K(n,"modelValue"),{loaderClasses:U}=Se(n),{isFocused:z,focus:c,blur:A}=ke(n),x=d(),V=d(),t=ce&&window.matchMedia("(forced-colors: active)").matches,T=Z(()=>typeof n.loading=="string"&&n.loading!==""?n.loading:n.color),q=Ve(),X=Z(()=>n.id||`switch-${q}`);function E(){m.value&&(m.value=!1)}function W(D){var S,h;D.stopPropagation(),D.preventDefault(),(h=(S=x.value)==null?void 0:S.input)==null||h.click()}return he(()=>{const[D,S]=pe(g),h=ae.filterProps(n),o=oe.filterProps(n);return a(ae,ee({ref:V,class:["v-switch",{"v-switch--flat":n.flat},{"v-switch--inset":n.inset},{"v-switch--indeterminate":m.value},U.value,n.class]},D,h,{modelValue:v.value,"onUpdate:modelValue":e=>v.value=e,id:X.value,focused:z.value,style:n.style}),{...u,default:e=>{let{id:l,messagesId:r,isDisabled:L,isReadonly:ie,isValid:j}=e;const $={model:v,isValid:j};return a(oe,ee({ref:x},o,{modelValue:v.value,"onUpdate:modelValue":[P=>v.value=P,E],id:l.value,"aria-describedby":r.value,type:"checkbox","aria-checked":m.value?"mixed":void 0,disabled:L.value,readonly:ie.value,onFocus:c,onBlur:A},S),{...u,default:P=>{let{backgroundColorClasses:G,backgroundColorStyles:k}=P;return i("div",{class:Q(["v-switch__track",t?void 0:G.value]),style:le(k.value),onClick:W},[u["track-true"]&&i("div",{key:"prepend",class:"v-switch__track-true"},[u["track-true"]($)]),u["track-false"]&&i("div",{key:"append",class:"v-switch__track-false"},[u["track-false"]($)])])},input:P=>{let{inputNode:G,icon:k,backgroundColorClasses:de,backgroundColorStyles:me}=P;return i(ue,null,[G,i("div",{class:Q(["v-switch__thumb",{"v-switch__thumb--filled":k||n.loading},n.inset||t?void 0:de.value]),style:le(n.inset?void 0:me.value)},[u.thumb?a(Ue,{defaults:{VIcon:{icon:k,size:"x-small"}}},{default:()=>[u.thumb({...$,icon:k})]}):a(Ae,null,{default:()=>[n.loading?a(xe,{name:"v-switch",active:!0,color:j.value===!1?void 0:T.value},{default:Y=>u.loader?u.loader(Y):a(Pe,{active:Y.isActive,color:Y.color,indeterminate:!0,size:"16",width:"2"},null)}):k&&a(re,{key:String(k),icon:k,size:"x-small"},null)]})])])}})}})}),Ce({},V)}}),_e={class:"text-no-wrap"},qe={__name:"server_manager",setup(n){const w=d(!1),g=d(!1),u=d(!1),m=d(null),v=d(null),U=d(""),z=[{align:"start",key:"online",title:"Statu"},{key:"id",sortable:!1,title:"id"},{key:"port",title:"Port"},{key:"qr_addr",title:"qr_addr"},{key:"takeaway_key",title:"takeaway_key"},{key:"url",title:"server url"},{key:"shopify_name",title:"shopify name"},{key:"actions",title:"Actions"}],c=d([]),A=d({});be(()=>{x()});function x(){I.getAllSever(o=>{console.log("serverAPI.getAllSever",o),o.result&&(console.log("ret: ",o.datas,o.states),c.value=o.datas,A.value=o.states)})}let V=d(!1);const t=d({});function T(o,e){V.value=!1,w.value=!0,t.value={...e.item},t.value.permissionsControl||(t.value.permissionsControl={}),t.value.customDishesControl||(t.value.customDishesControl={1:{enabled:!0,name:"Sushi Aleatória®"},2:{enabled:!0,name:"Poke Bowl"},3:{enabled:!0,name:"MY BOX"},4:{enabled:!0,name:"bibimbap"},5:{enabled:!0,name:"XIAOXIONG® RAMEN"},6:{enabled:!0,name:"Menu Almoço"}})}function q(){w.value=!1;let o=t.value;if(V.value)o.url&&(o.url=o.url.trim()),o.url==""&&(o.url=void 0),o.takeWay||(o.takeWay=!1),I.addServer(o,e=>{e.result==!0&&c.value.push(e.data)});else{const e=c.value.findIndex(l=>l.id===o.id);if(e!==-1){let l=c.value[e],r=!1;for(const L in o)if(o[L]!=l[e]){r=!0;break}o.takeWay||(o.takeWay=!1),r&&(I.setServer(o),c.value.splice(e,1,t.value))}}}function X(o,e){v.value=e.item,u.value=!0}function E(){if(!v.value||!v.value.id)return;const o=v.value.id;I.deleteServer(o,e=>{if(e&&e.result){const l=c.value.findIndex(r=>r.id===o);l!==-1&&c.value.splice(l,1)}else alert("Failed to delete server: "+((e==null?void 0:e.message)||"Unknown error"));u.value=!1})}function W(){w.value=!0,t.value={id:"",url:"",permissionsControl:{},customDishesControl:{1:{enabled:!0,name:"Sushi Aleatória®"},2:{enabled:!0,name:"Poke Bowl"},3:{enabled:!0,name:"MY BOX"},4:{enabled:!0,name:"bibimbap"},5:{enabled:!0,name:"XIAOXIONG® RAMEN"},6:{enabled:!0,name:"Menu Almoço"}}},V.value=!0}function D(o){if(A.value.statuOnline)return A.value.statuOnline[o.id]}function S(o,e){m.value=e.item,g.value=!0}async function h(){if(!m.value||!m.value.id){alert("Server ID not available");return}const o=m.value.id;console.log("Resetting password for server:",o),I.resetPassword(o,e=>{console.log("Reset password response:",e),e&&e.result?alert("Password reset successfully!"):alert("Password reset failed: "+((e==null?void 0:e.data)||"Unknown error")),g.value=!1})}return(o,e)=>(R(),ye(ue,null,[a(_,{title:"Server Manager",flat:""},{text:s(()=>[a(C,{modelValue:U.value,"onUpdate:modelValue":e[0]||(e[0]=l=>U.value=l),label:"Search","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":"","single-line":""},null,8,["modelValue"]),a(p,{class:"ma-2",onClick:W,color:"indigo-darken-3"},{default:s(()=>e[24]||(e[24]=[y("new server")])),_:1,__:[24]}),a(p,{class:"ma-2",onClick:x,color:"indigo-darken-3"},{default:s(()=>e[25]||(e[25]=[y("refresh")])),_:1,__:[25]})]),default:s(()=>[a(De,{headers:z,items:c.value,search:U.value,hover:""},{item:s(({item:l})=>[i("tr",_e,[i("td",{class:Q({"text-success":D(l),"text-error":!D(l)})},[a(re,{icon:"mdi-circle"})],2),i("td",null,b(l.id),1),i("td",null,b(l.port),1),i("td",null,b(l.qr_addr),1),i("td",null,b(l.takeaway_key),1),i("td",null,b(l.url),1),i("td",null,b(l.shopify_name),1),i("td",null,[a(p,{size:"small",icon:"mdi-pencil",onClick:B(r=>T(r,{item:l}),["stop"])},null,8,["onClick"]),a(p,{class:"ml-2",size:"small",icon:"mdi-trash-can-outline",onClick:B(r=>X(r,{item:l}),["stop"])},null,8,["onClick"]),a(p,{class:"ml-2",size:"small",icon:"mdi-lock-reset",onClick:B(r=>S(r,{item:l}),["stop"]),color:"warning"},null,8,["onClick"])])])]),_:1},8,["items","search"])]),_:1}),a(J,{modelValue:u.value,"onUpdate:modelValue":e[2]||(e[2]=l=>u.value=l),width:"400"},{default:s(()=>[a(_,{title:"Delete Server"},{default:s(()=>[a(H,null,{default:s(()=>{var l;return[y(" Are you sure you want to delete server "+b((l=v.value)==null?void 0:l.id)+"? This action cannot be undone. ",1)]}),_:1}),a(te,null,{default:s(()=>[a(se),a(p,{color:"grey",onClick:e[1]||(e[1]=l=>u.value=!1)},{default:s(()=>e[26]||(e[26]=[y("Cancel")])),_:1,__:[26]}),a(p,{color:"error",onClick:E},{default:s(()=>e[27]||(e[27]=[y("Delete")])),_:1,__:[27]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(J,{modelValue:g.value,"onUpdate:modelValue":e[4]||(e[4]=l=>g.value=l),width:"400"},{default:s(()=>[a(_,{title:"Reset Password"},{default:s(()=>[a(H,null,{default:s(()=>{var l,r;return[y(" Are you sure you want to reset the password for "+b((l=m.value)==null?void 0:l.id)+" ("+b((r=m.value)==null?void 0:r.url)+")? The password will be reset to the default administrator password. ",1)]}),_:1}),a(te,null,{default:s(()=>[a(se),a(p,{color:"grey",onClick:e[3]||(e[3]=l=>g.value=!1)},{default:s(()=>e[28]||(e[28]=[y("Cancel")])),_:1,__:[28]}),a(p,{color:"warning",onClick:h},{default:s(()=>e[29]||(e[29]=[y("Reset")])),_:1,__:[29]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(J,{modelValue:w.value,"onUpdate:modelValue":e[23]||(e[23]=l=>w.value=l),width:"500"},{default:s(()=>[a(_,{title:"edit user"},{default:s(()=>[a(H),a(Ie,{"fast-fail":"",onSubmit:B(q,["prevent"])},{default:s(()=>[F(V)?(R(),M(C,{key:0,class:"ma-3",modelValue:t.value.id,"onUpdate:modelValue":e[5]||(e[5]=l=>t.value.id=l),variant:"outlined",label:"name"},null,8,["modelValue"])):O("",!0),F(V)?O("",!0):(R(),M(C,{key:1,class:"ma-3",modelValue:t.value.id,"onUpdate:modelValue":e[6]||(e[6]=l=>t.value.id=l),variant:"outlined",label:"name",readonly:""},null,8,["modelValue"])),F(V)?(R(),M(C,{key:2,class:"ma-3",modelValue:t.value.url,"onUpdate:modelValue":e[7]||(e[7]=l=>t.value.url=l),variant:"outlined",label:"url"},null,8,["modelValue"])):O("",!0),F(V)?O("",!0):(R(),M(C,{key:3,class:"ma-3",modelValue:t.value.url,"onUpdate:modelValue":e[8]||(e[8]=l=>t.value.url=l),variant:"outlined",label:"url"},null,8,["modelValue"])),a(C,{class:"ma-3",modelValue:t.value.qr_addr,"onUpdate:modelValue":e[9]||(e[9]=l=>t.value.qr_addr=l),variant:"outlined",label:"qr_addr"},null,8,["modelValue"]),a(C,{class:"ma-3",modelValue:t.value.takeaway_key,"onUpdate:modelValue":e[10]||(e[10]=l=>t.value.takeaway_key=l),variant:"outlined",label:"takeaway_key"},null,8,["modelValue"]),a(C,{class:"ma-3",modelValue:t.value.shopify_name,"onUpdate:modelValue":e[11]||(e[11]=l=>t.value.shopify_name=l),variant:"outlined",label:"shopify_name"},null,8,["modelValue"]),a(ne,{class:"ma-3 pa-1 border-solid"},{default:s(()=>[a(N,null,{default:s(()=>[a(f,{class:"ml-2",modelValue:t.value.permissionsControl.order,"onUpdate:modelValue":e[12]||(e[12]=l=>t.value.permissionsControl.order=l),label:"Order",color:"primary","hide-details":"",inset:""},null,8,["modelValue"]),a(f,{class:"ml-2",modelValue:t.value.permissionsControl.delivery,"onUpdate:modelValue":e[13]||(e[13]=l=>t.value.permissionsControl.delivery=l),label:"Delivery",color:"primary","hide-details":"",inset:""},null,8,["modelValue"]),a(f,{class:"ml-2",modelValue:t.value.permissionsControl.fandays,"onUpdate:modelValue":e[14]||(e[14]=l=>t.value.permissionsControl.fandays=l),label:"Fandays",color:"primary","hide-details":"",inset:""},null,8,["modelValue"])]),_:1}),a(N,null,{default:s(()=>[a(f,{class:"ml-2",modelValue:t.value.permissionsControl.reserver,"onUpdate:modelValue":e[15]||(e[15]=l=>t.value.permissionsControl.reserver=l),label:"Reserver",color:"primary","hide-details":"",inset:""},null,8,["modelValue"]),a(f,{class:"ml-2",modelValue:t.value.permissionsControl.vip,"onUpdate:modelValue":e[16]||(e[16]=l=>t.value.permissionsControl.vip=l),label:"VIP",color:"primary","hide-details":"",inset:""},null,8,["modelValue"])]),_:1})]),_:1}),a(ne,{class:"ma-3 pa-1 border-solid"},{default:s(()=>[a(N,null,{default:s(()=>[a(f,{class:"ml-2",modelValue:t.value.customDishesControl[1].enabled,"onUpdate:modelValue":e[17]||(e[17]=l=>t.value.customDishesControl[1].enabled=l),label:t.value.customDishesControl[1].name,color:"primary","hide-details":"",inset:""},null,8,["modelValue","label"]),a(f,{class:"ml-2",modelValue:t.value.customDishesControl[2].enabled,"onUpdate:modelValue":e[18]||(e[18]=l=>t.value.customDishesControl[2].enabled=l),label:t.value.customDishesControl[2].name,color:"primary","hide-details":"",inset:""},null,8,["modelValue","label"]),a(f,{class:"ml-2",modelValue:t.value.customDishesControl[3].enabled,"onUpdate:modelValue":e[19]||(e[19]=l=>t.value.customDishesControl[3].enabled=l),label:t.value.customDishesControl[3].name,color:"primary","hide-details":"",inset:""},null,8,["modelValue","label"])]),_:1}),a(N,null,{default:s(()=>[a(f,{class:"ml-2",modelValue:t.value.customDishesControl[4].enabled,"onUpdate:modelValue":e[20]||(e[20]=l=>t.value.customDishesControl[4].enabled=l),label:t.value.customDishesControl[4].name,color:"primary","hide-details":"",inset:""},null,8,["modelValue","label"]),a(f,{class:"ml-2",modelValue:t.value.customDishesControl[5].enabled,"onUpdate:modelValue":e[21]||(e[21]=l=>t.value.customDishesControl[5].enabled=l),label:t.value.customDishesControl[5].name,color:"primary","hide-details":"",inset:""},null,8,["modelValue","label"]),a(f,{class:"ml-2",modelValue:t.value.customDishesControl[6].enabled,"onUpdate:modelValue":e[22]||(e[22]=l=>t.value.customDishesControl[6].enabled=l),label:t.value.customDishesControl[6].name,color:"primary","hide-details":"",inset:""},null,8,["modelValue","label"])]),_:1})]),_:1}),a(_,{class:"text-center"},{default:s(()=>[a(p,{width:"200",class:"mb-3",type:"submit",color:"indigo-darken-3"},{default:s(()=>e[30]||(e[30]=[y("Submit")])),_:1,__:[30]})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{qe as default};
