import{s as C}from"./index-Bs7PK4L7.js";import{s as j}from"./index-sRrGFFXH.js";import{b as P}from"./index-Cf1xqoVV.js";import{j as A,h as u,f as V,o as b,w as h,a as t,d as s,t as w,q as B,u as E,c as x,F as $,C as L,l as q,n as m}from"./index-BZk1WzeF.js";import{s as D}from"./index-h5zgMMD6.js";import{s as U}from"./index-FBGTgLf1.js";import{_ as F}from"./main-C8Q1gxG8.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-D_gKEM_d.js";import"./index-C2Ng2Nts.js";import"./index-C3SaQNDS.js";const N={class:"relative"},S={class:"absolute bottom-0 surface-800 left-0 w-full p-3 bg-black bg-opacity-50 text-white"},T={class:"text-xl font-semibold"},z={class:"text-sm"},M={class:"flex justify-content-end"},O={__name:"EditablePageCard",props:{page:Object},emits:[],setup(d,{emit:f}){const o=A(),l=d,n=f;function c(i){o.push(`/editablePages/${i}`)}function y(){n("deletePage",l.page.id)}function _(){n("applypage",l.page.id)}const g=u(),r=u([{label:"选项",items:[{label:"应用",icon:"pi pi-check-square",command:_},{label:"删除",icon:"pi pi-times",command:y}]}]),e=i=>{g.value.toggle(i)};return(i,p)=>{const v=P,a=U,k=D;return b(),V(k,{style:{width:"250px"},class:"relative"},{header:h(()=>[s(v,{type:"button",icon:"pi pi-ellipsis-v",class:"absolute top-2 right-0 z-5",onClick:e,"aria-haspopup":"true","aria-controls":"overlay_menu"}),s(a,{ref_key:"menu",ref:g,model:r.value,popup:!0},null,8,["model"]),t("div",N,[p[1]||(p[1]=t("img",{src:F,style:{width:"100%",height:"150px","object-fit":"cover"}},null,-1)),t("div",S,[t("div",T,w(d.page.name),1),t("div",z,w(d.page.description),1)])])]),footer:h(()=>[t("div",M,[s(v,{label:"修改",text:"",onClick:p[0]||(p[0]=X=>c(d.page.id))})])]),_:1})}}},R={class:"p-4"},W={class:"flex flex-wrap gap-4"},G={class:"flex justify-center"},H={class:"flex items-center gap-4 mb-4"},J={class:"flex items-center gap-4 mb-8"},K={class:"flex justify-end gap-2"},Q={__name:"EditablePages",setup(d){const f=B(),o=E(),l=u(""),n=u(""),c=u(!1);async function y(){if(!l.value.trim()){o.add({severity:"warn",summary:"确认",detail:"请填写名字",life:3e3});return}await m.pageApi.addPage(l.value,n.value),await m.pageApi.getPages(),c.value=!1,l.value="",n.value=""}function _(r){f.require({message:"你确定要删除这个页面吗？",header:"确认删除",icon:"pi pi-exclamation-triangle",acceptLabel:"删除",rejectLabel:"取消",acceptClass:"p-button-danger",accept:async()=>{try{await m.pageApi.deletePage(r),o.add({severity:"success",summary:"已删除",detail:"页面删除成功",life:3e3})}catch(e){o.add({severity:"error",summary:"删除失败",detail:e.message||"服务器错误",life:3e3})}},reject:()=>{o.add({severity:"info",summary:"已取消",detail:"操作已取消",life:3e3})}})}function g(r){f.require({message:"确定要应用这个页面吗？",header:"确认操作",icon:"pi pi-exclamation-triangle",acceptLabel:"确认",rejectLabel:"取消",accept:async()=>{try{await m.pageApi.applyWelcomePage(r),o.add({severity:"success",summary:"已应用",detail:"页面应用成功",life:3e3})}catch(e){o.add({severity:"error",summary:"应用失败",detail:e.message||"服务器错误",life:3e3})}},reject:()=>{console.log("取消应用")}})}return(r,e)=>{const i=P,p=j,v=C;return b(),x($,null,[t("div",R,[t("div",W,[(b(!0),x($,null,L(q(m).pageApi.pages.value,a=>(b(),x("div",{key:a.title},[s(O,{page:a,onDeletePage:_,onApplypage:g},null,8,["page"])]))),128)),t("div",G,[s(i,{style:{width:"200px",height:"200px"},icon:"pi pi-plus",onClick:e[0]||(e[0]=a=>c.value=!0)})])])]),s(v,{visible:c.value,"onUpdate:visible":e[4]||(e[4]=a=>c.value=a),modal:"",header:"创建新的页面",style:{width:"25rem"}},{default:h(()=>[t("div",H,[e[5]||(e[5]=t("label",{for:"name",class:"font-semibold w-24"},"名字",-1)),s(p,{id:"name",class:"flex-auto",modelValue:l.value,"onUpdate:modelValue":e[1]||(e[1]=a=>l.value=a),autocomplete:"off"},null,8,["modelValue"])]),t("div",J,[e[6]||(e[6]=t("label",{for:"description",class:"font-semibold w-24"},"介绍",-1)),s(p,{id:"description",class:"flex-auto",modelValue:n.value,"onUpdate:modelValue":e[2]||(e[2]=a=>n.value=a),autocomplete:"off"},null,8,["modelValue"])]),t("div",K,[s(i,{type:"button",label:"Cancel",severity:"secondary",onClick:e[3]||(e[3]=a=>r.visible=!1)}),s(i,{type:"button",label:"Save",onClick:y})])]),_:1},8,["visible"])],64)}}},pe=I(Q,[["__scopeId","data-v-3fe90e9b"]]);export{pe as default};
