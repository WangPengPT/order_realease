var de=Object.defineProperty;var re=(e,l,y)=>l in e?de(e,l,{enumerable:!0,configurable:!0,writable:!0,value:y}):e[l]=y;var Y=(e,l,y)=>re(e,typeof l!="symbol"?l+"":l,y);import{e as ue,a as pe}from"./index-CJLuoy_-.js";import{s as ce}from"./index-Bw8rQUUl.js";import{R as me,a as G,c as fe,f as he}from"./index-BN3ATREX.js";import{B as ge,r as ve,c as h,o as f,a as r,b as n,d as D,e as N,m as v,t as C,z as ye,w as i,f as H,g as we,y as be,aw as Ve,T as z,u as _e,q as Pe,aJ as $e,h as P,s as L,i as De,aW as Se,F as Q,E as ke,n as O,j as Te,l as Be,C as q,p as Ce}from"./index-CcMmj4Wt.js";import{s as Ne}from"./index-CAriO_vo.js";import{s as Ue,a as Ee}from"./index-CxZDt62I.js";import{s as Re}from"./index-4fDGpEbX.js";import{s as Ae}from"./index-DgRcwisv.js";import{s as Ie}from"./index-gL7emECd.js";import{s as Le}from"./index-BRz1YYqz.js";import{s as Oe}from"./index-BNfNtxbE.js";import{_ as ze}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-g0DagGf3.js";import"./index-BMT2v_5d.js";import"./index-CVh3s04Y.js";import"./index-Bh3esxIm.js";import"./index-TtpeQbAu.js";import"./index-o5GKXbXI.js";import"./index-D3vuo4E0.js";import"./index-CDBWWjlY.js";import"./index-Dcem2ch5.js";var Je=`
    .p-panel {
        display: block;
        border: 1px solid dt('panel.border.color');
        border-radius: dt('panel.border.radius');
        background: dt('panel.background');
        color: dt('panel.color');
    }

    .p-panel-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: dt('panel.header.padding');
        background: dt('panel.header.background');
        color: dt('panel.header.color');
        border-style: solid;
        border-width: dt('panel.header.border.width');
        border-color: dt('panel.header.border.color');
        border-radius: dt('panel.header.border.radius');
    }

    .p-panel-toggleable .p-panel-header {
        padding: dt('panel.toggleable.header.padding');
    }

    .p-panel-title {
        line-height: 1;
        font-weight: dt('panel.title.font.weight');
    }

    .p-panel-content {
        padding: dt('panel.content.padding');
    }

    .p-panel-footer {
        padding: dt('panel.footer.padding');
    }
`,Me={root:function(l){var y=l.props;return["p-panel p-component",{"p-panel-toggleable":y.toggleable}]},header:"p-panel-header",title:"p-panel-title",headerActions:"p-panel-header-actions",pcToggleButton:"p-panel-toggle-button",contentContainer:"p-panel-content-container",content:"p-panel-content",footer:"p-panel-footer"},Ke=ge.extend({name:"panel",style:Je,classes:Me}),Fe={name:"BasePanel",extends:fe,props:{header:String,toggleable:Boolean,collapsed:Boolean,toggleButtonProps:{type:Object,default:function(){return{severity:"secondary",text:!0,rounded:!0}}}},style:Ke,provide:function(){return{$pcPanel:this,$parentInstance:this}}},X={name:"Panel",extends:Fe,inheritAttrs:!1,emits:["update:collapsed","toggle"],data:function(){return{d_collapsed:this.collapsed}},watch:{collapsed:function(l){this.d_collapsed=l}},methods:{toggle:function(l){this.d_collapsed=!this.d_collapsed,this.$emit("update:collapsed",this.d_collapsed),this.$emit("toggle",{originalEvent:l,value:this.d_collapsed})},onKeyDown:function(l){(l.code==="Enter"||l.code==="NumpadEnter"||l.code==="Space")&&(this.toggle(l),l.preventDefault())}},computed:{buttonAriaLabel:function(){return this.toggleButtonProps&&this.toggleButtonProps.ariaLabel?this.toggleButtonProps.ariaLabel:this.header},dataP:function(){return he({toggleable:this.toggleable})}},components:{PlusIcon:ce,MinusIcon:ue,Button:G},directives:{ripple:me}},je=["data-p"],We=["data-p"],Ye=["id"],Qe=["id","aria-labelledby"];function qe(e,l,y,c,b,w){var u=ve("Button");return f(),h("div",v({class:e.cx("root"),"data-p":w.dataP},e.ptmi("root")),[r("div",v({class:e.cx("header"),"data-p":w.dataP},e.ptm("header")),[D(e.$slots,"header",{id:e.$id+"_header",class:ye(e.cx("title"))},function(){return[e.header?(f(),h("span",v({key:0,id:e.$id+"_header",class:e.cx("title")},e.ptm("title")),C(e.header),17,Ye)):N("",!0)]}),r("div",v({class:e.cx("headerActions")},e.ptm("headerActions")),[D(e.$slots,"icons"),e.toggleable?D(e.$slots,"togglebutton",{key:0,collapsed:b.d_collapsed,toggleCallback:function(k){return w.toggle(k)},keydownCallback:function(k){return w.onKeyDown(k)}},function(){return[n(u,v({id:e.$id+"_header",class:e.cx("pcToggleButton"),"aria-label":w.buttonAriaLabel,"aria-controls":e.$id+"_content","aria-expanded":!b.d_collapsed,unstyled:e.unstyled,onClick:l[0]||(l[0]=function(g){return w.toggle(g)}),onKeydown:l[1]||(l[1]=function(g){return w.onKeyDown(g)})},e.toggleButtonProps,{pt:e.ptm("pcToggleButton")}),{icon:i(function(g){return[D(e.$slots,e.$slots.toggleicon?"toggleicon":"togglericon",{collapsed:b.d_collapsed},function(){return[(f(),H(we(b.d_collapsed?"PlusIcon":"MinusIcon"),v({class:g.class},e.ptm("pcToggleButton").icon),null,16,["class"]))]})]}),_:3},16,["id","class","aria-label","aria-controls","aria-expanded","unstyled","pt"])]}):N("",!0)],16)],16,We),n(z,v({name:"p-toggleable-content"},e.ptm("transition")),{default:i(function(){return[be(r("div",v({id:e.$id+"_content",class:e.cx("contentContainer"),role:"region","aria-labelledby":e.$id+"_header"},e.ptm("contentContainer")),[r("div",v({class:e.cx("content")},e.ptm("content")),[D(e.$slots,"default")],16),e.$slots.footer?(f(),h("div",v({key:0,class:e.cx("footer")},e.ptm("footer")),[D(e.$slots,"footer")],16)):N("",!0)],16,Qe),[[Ve,!b.d_collapsed]])]}),_:3},16)],16,je)}X.render=qe;class Ge{constructor(){Y(this,"toast")}show(l){l.summary=l.summary,l.detail=l.detail,l.life=3e3,this.toast.add(l)}show_success(l){this.show({severity:"success",summary:"success",detail:l})}show_info(l){this.show({severity:"info",summary:"info",detail:l})}show_warn(l){this.show({severity:"warn",summary:"warn",detail:l})}show_error(l){this.show({severity:"error",summary:"error",detail:l})}}const S=new Ge,He={class:"flex flex-column w-full h-full"},Xe={class:"fixed top-0 left-0 right-0 z-1"},Ze={class:"w-full h-full p-4"},xe={class:"flex flex-row w-full h-full"},eo={class:"w-full"},oo={class:"relative w-full h-full"},to={class:"flex flex-column w-full"},no={class:"flex items-center gap-2 w-full"},lo={key:0,class:"w-full"},ao={key:0},so={key:1},io={key:1},ro={class:"font-bold p-3"},uo={key:0},po={key:1},co={__name:"EditCustomDish",setup(e){const l=_e(),y=Te(),{t:c}=Pe(),b=$e();S.toast=l;const w=b.params.dishId,u=P(void 0),g=P([]),k=L(()=>{var a;return((a=u.value)==null?void 0:a.name)||""}),U=P(void 0),I=L(()=>!u.value||!U.value?!1:JSON.stringify(u.value)!==JSON.stringify(U.value)),J=P([{label:c("common.delete"),icon:"pi pi-times"}]);function Z(){y.push(Ce.mainPath.editableCustomeDish.path)}function x(){if(!I.value){S.show_info(c("notification.noChanges"));return}console.log("current dish",u.value),O.customDishApi.updateCustomDish(u.value,a=>{a.success?(S.show_success(c("notification.updateSuccess")),U.value=JSON.parse(JSON.stringify(u.value))):S.show_warn(c("notification.updateFailed"))})}function ee(a=5e3,s=100){return new Promise((m,V)=>{const T=Date.now(),E=()=>{const B=O.customDishApi.customDishes.value;B&&B.length>0?m(B):Date.now()-T>a?V(new Error("customDishes 超时未加载")):setTimeout(E,s)};E()})}De(async()=>{try{const s=(await ee()).find(m=>String(m.id)===w);s&&(u.value=JSON.parse(JSON.stringify(s)),U.value=JSON.parse(JSON.stringify(s)),console.log("customDish.value dish:",u.value)),g.value=s.types.map(()=>!0)}catch(a){console.error(a)}});const M=P([]),K=P([]),oe=(a,s)=>{const{newData:m,index:V}=a;u.value&&(u.value.types[s].dishes[V]=m)},te=(a,s)=>{const{newData:m,index:V}=a;u.value&&(u.value.types[s]=m)};function F(a){return`${a}€`}const j=P([{name:c("menuPage.open"),value:!0},{name:c("menuPage.close"),value:!1}]),ne=(a,s)=>{g.value[s]=a.value};Se((a,s,m)=>{if(I.value&&!confirm(c("notification.unsavedWarning")||"You have unsaved changes. Leave anyway?"))return m(!1);m()}),window.addEventListener("beforeunload",a=>{I.value&&(a.preventDefault(),a.returnValue="")});const le=L(()=>[{name:c("menuPage.dineIn")+" & "+c("menuPage.takeAway"),code:"DINEIN&TAKEAWAY"},{name:c("menuPage.takeAway"),code:"TAKEAWAY"},{name:c("menuPage.dineIn"),code:"DINEIN"}]);function ae(a,s){O.customDishApi.updateCustomDishSellType(s.id,a,m=>{m.success?S.show_success(c("notification.updateSuccess")):S.show_warn(c("notification.updateFailed"))})}return(a,s)=>{const m=Oe,V=G,T=Le,E=Ie,B=Ae,p=Ee,$=Re,R=pe,W=Ue,se=Ne,ie=X;return f(),h(Q,null,[n(m),r("div",He,[r("div",Xe,[n(B,null,{start:i(()=>[n(V,{icon:"pi pi-arrow-left",onClick:Z})]),center:i(()=>[r("span",null,C(k.value),1)]),end:i(()=>[u.value?(f(),H(T,{key:0,modelValue:u.value.sellType,"onUpdate:modelValue":[s[0]||(s[0]=_=>u.value.sellType=_),s[1]||(s[1]=_=>ae(_,u.value))],options:le.value,optionLabel:"name",optionValue:"code",class:"pr-2"},null,8,["modelValue","options"])):N("",!0),n(E,{label:Be(c)("topBar.save"),model:J.value,onClick:x},null,8,["label","model"])]),_:1})]),s[9]||(s[9]=r("div",{style:{"padding-top":"60px"}},null,-1)),r("div",Ze,[r("div",xe,[r("div",eo,[r("div",oo,[u.value?(f(!0),h(Q,{key:0},ke(u.value.types,(_,A)=>(f(),h("div",null,[r("div",to,[n(z,{name:"smooth-expand",mode:"out-in"},{default:i(()=>[n(ie,{toggleable:"",class:"w-full",onToggle:o=>ne(o,A),collapsed:!0},{header:i(()=>[r("div",no,[n(z,{name:"slide-fade",mode:"out-in"},{default:i(()=>[g.value[A]?(f(),h("div",lo,[n(W,{value:[_],tableStyle:"min-width: 50rem",editMode:"row",class:"w-full",editingRows:K.value,"onUpdate:editingRows":s[2]||(s[2]=o=>K.value=o),onRowEditSave:o=>te(o,A)},{default:i(()=>[n(p,{field:"id",header:"Id"}),n(p,{field:"typeName",header:a.$t("menuPage.name")},null,8,["header"]),n(p,{field:"enable",header:a.$t("menuPage.enableDisable")},{body:i(({data:o,field:t})=>[o[t]===!0?(f(),h("div",ao,s[4]||(s[4]=[r("i",{class:"pi pi-circle-fill",style:{color:"green","font-size":"1.5rem"}},null,-1)]))):(f(),h("div",so,s[5]||(s[5]=[r("i",{class:"pi pi-circle-fill",style:{color:"red","font-size":"1.5rem"}},null,-1)])))]),editor:i(({data:o,field:t})=>[n(T,{modelValue:o[t],"onUpdate:modelValue":d=>o[t]=d,options:j.value,optionLabel:"name",optionValue:"value"},null,8,["modelValue","onUpdate:modelValue","options"])]),_:1},8,["header"]),n(p,{field:"typeName_zh",header:a.$t("menuPage.nameCN")},{editor:i(({data:o,field:t})=>[n($,{modelValue:o[t],"onUpdate:modelValue":d=>o[t]=d,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(p,{field:"typeName_pt",header:a.$t("menuPage.namePT")},{editor:i(({data:o,field:t})=>[n($,{modelValue:o[t],"onUpdate:modelValue":d=>o[t]=d,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(p,{field:"typeName_en",header:a.$t("menuPage.nameEN")},{editor:i(({data:o,field:t})=>[n($,{modelValue:o[t],"onUpdate:modelValue":d=>o[t]=d,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(p,{field:"minQuantity",header:a.$t("menuPage.min")},{editor:i(({data:o,field:t})=>[n(R,{modelValue:o[t],"onUpdate:modelValue":d=>o[t]=d,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(p,{field:"maxQuantity",header:a.$t("menuPage.max")},{editor:i(({data:o,field:t})=>[n(R,{modelValue:o[t],"onUpdate:modelValue":d=>o[t]=d,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(p,{rowEditor:!0,style:{width:"10%","min-width":"8rem"},bodyStyle:"text-align:center"})]),_:2},1032,["value","editingRows","onRowEditSave"])])):(f(),h("div",io,[r("span",ro,C(_.typeName),1)]))]),_:2},1024)])]),footer:i(()=>s[6]||(s[6]=[r("div",{class:"flex flex-wrap items-center justify-between gap-4"},null,-1)])),icons:i(()=>[n(se,{ref_for:!0,ref:"menu",id:"config_menu",model:J.value,popup:""},null,8,["model"])]),default:i(()=>[r("div",null,[n(W,{value:_.dishes,editingRows:M.value,"onUpdate:editingRows":s[3]||(s[3]=o=>M.value=o),tableStyle:"min-width: 50rem",editMode:"row",onRowEditSave:o=>oe(o,A)},{default:i(()=>[n(p,{field:"dishid",header:"Id"}),n(p,{field:"name",header:a.$t("menuPage.name")},null,8,["header"]),n(p,{field:"name_zh",header:a.$t("menuPage.nameCN")},{editor:i(({data:o,field:t})=>[n($,{modelValue:o[t],"onUpdate:modelValue":d=>o[t]=d,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(p,{field:"name_en",header:a.$t("menuPage.nameEN")},{editor:i(({data:o,field:t})=>[n($,{modelValue:o[t],"onUpdate:modelValue":d=>o[t]=d,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(p,{field:"name_pt",header:a.$t("menuPage.namePT")},{editor:i(({data:o,field:t})=>[n($,{modelValue:o[t],"onUpdate:modelValue":d=>o[t]=d,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(p,{field:"enable",header:a.$t("menuPage.enableDisable")},{body:i(({data:o,field:t})=>[o[t]===!0?(f(),h("div",uo,s[7]||(s[7]=[r("i",{class:"pi pi-circle-fill",style:{color:"green","font-size":"1.5rem"}},null,-1)]))):(f(),h("div",po,s[8]||(s[8]=[r("i",{class:"pi pi-circle-fill",style:{color:"red","font-size":"1.5rem"}},null,-1)])))]),editor:i(({data:o,field:t})=>[n(T,{modelValue:o[t],"onUpdate:modelValue":d=>o[t]=d,options:j.value,optionLabel:"name",optionValue:"value"},null,8,["modelValue","onUpdate:modelValue","options"])]),_:1},8,["header"]),n(p,{field:"price",header:a.$t("menuPage.price")},{body:i(({data:o,field:t})=>[q(C(F(o[t])),1)]),editor:i(({data:o,field:t})=>[n(R,{modelValue:o[t],"onUpdate:modelValue":d=>o[t]=d,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(p,{field:"deliveryPrice",header:a.$t("menuPage.deliveryPrice")},{body:i(({data:o,field:t})=>[q(C(F(o[t])),1)]),editor:i(({data:o,field:t})=>[n(R,{modelValue:o[t],"onUpdate:modelValue":d=>o[t]=d,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(p,{rowEditor:!0,bodyStyle:"text-align:center"})]),_:2},1032,["value","editingRows","onRowEditSave"])])]),_:2},1032,["onToggle"])]),_:2},1024)])]))),256)):N("",!0)])])])])])],64)}}},Ao=ze(co,[["__scopeId","data-v-ccae70c9"]]);export{Ao as default};
