import{s as G}from"./index-3-DK_pie.js";import{c as J,s as K,a as X}from"./index-CITC0Lwu.js";import{s as q,a as ee,b as le,c as te}from"./index-CmB8mRej.js";import{s as ae}from"./index-DGB5cMIN.js";import{s as oe}from"./index-C0zrqUuS.js";import{b as re}from"./index-2n8MH--o.js";import{h as p,n as g,c as y,d as n,a as m,w as i,e as S,j as ne,o as s,l as ie,F as D,A as C,f as h,z as N,t as Q}from"./index-DvKI5mfC.js";import"./index-mbPb8Jfz.js";import"./index-C7X-RA1h.js";import"./index-2Pn_01lS.js";import"./index-cz7GSNN6.js";import"./index-DG9oOX0m.js";import"./index-DSh5IxzP.js";import"./index-BCagfyzc.js";const se={class:"flex flex-column w-full",style:{position:"fixed",top:"0",left:"0"}},ue={class:"flex flex-wrap justify-content-center align-items-center gap-1 ml-2"},ve={class:"card flex flex-column",style:{height:"calc(100vh - 200px)"}},de={key:0,style:{padding:"0.5rem"}},ce=2025,Ve={__name:"OrderQuantity",setup(pe){const z=ne(),a=p(g.menuData.value.filter(l=>l.category));R();const F=p([{id:0,label:"隐藏销售量为0的菜品"},{id:1,label:"展示销售量为0的菜品"}]),w=p(),T=new Date,b=T.getFullYear(),x=T.getMonth()+1,Y=T.getDate(),V=p([{id:0,value:0,label:"总评分"}]);U();function U(){for(let l=ce;l<=b;l++)V.value.push({id:l,value:l,label:l})}const O=p([]);I();function I(){const l=["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"];O.value.push({id:0,value:"yearTotal",label:"当年总销售量"});for(let e=0;e<l.length;e++)O.value.push({id:e+1,value:l[e],label:e+1+" - "+l[e].toUpperCase()})}const _=p([]);B(b,x);function B(l,e){if(e<1||e>12)return 0;const t=[31,l&&(l%4===0&&l%100!==0||l%400===0)?29:28,31,30,31,30,31,31,30,31,30,31];_.value.length=0,_.value.push({id:0,label:"当月总销售量"});for(let c=1;c<=t[e-1];c++)_.value.push({id:c,label:c})}async function R(){try{await g.refreshMenu(),a.value=g.menuData.value.filter(l=>l.category)}catch(l){console.error("获取销售量失败:",l),toast.add({severity:"error",summary:"错误",detail:"获取销售量失败",life:3e3})}}function $(l,e,r){u.value!==e&&B(l,e),v.value=l,u.value=e,r=r|0,a.value=[],A(a,l,e,r,()=>{E()}),a.value=a.value.filter(t=>t.category)}function A(l,e,r,t,c){e==0||e==b&&r==0||e==b&&r==x&&t==0||e==b&&r==x&&t==Y?l.value=g.menuData.value:(r===0&&(t=0),g.getOrderQuantityWithDate(l,e,r,t,()=>{c()})),c()}function E(){const l=v.value,e=u.value,r=d.value.id;if(w.value)if(w.value.id){if(!l){a.value=a.value.filter(t=>!t.orders);return}if(!e){a.value=a.value.filter(t=>!t.yearlyOrders);return}if(!r){a.value=a.value.filter(t=>!t.monthlyOrders);return}a.value=a.value.filter(t=>!t.dailyOrders)}else{if(!l){a.value=a.value.filter(t=>t.orders);return}if(!e){a.value=a.value.filter(t=>t.yearlyOrders);return}if(!r){a.value=a.value.filter(t=>t.monthlyOrders);return}a.value=a.value.filter(t=>t.dailyOrders)}}const v=p(b),u=p(x),d=p(_.value.find(l=>l.id===Y));return(l,e)=>{const r=re,t=oe,c=ae,L=le,M=ee,j=te,P=q,H=J,k=X,W=K,Z=G;return s(),y("div",se,[n(c,{class:"bg-primary text-white p-2"},{start:i(()=>[n(r,{icon:"pi pi-arrow-left",class:"p-button-text text-white",label:"主页",onClick:e[0]||(e[0]=o=>ie(z).push("/"))}),m("div",ue,[n(t,{modelValue:w.value,"onUpdate:modelValue":e[1]||(e[1]=o=>w.value=o),options:F.value,optionLabel:"label",unselectable:!1,onChange:e[2]||(e[2]=o=>$(v.value,u.value,d.value.id))},null,8,["modelValue","options"])])]),_:1}),m("div",null,[n(P,{value:v.value},{default:i(()=>[n(M,null,{default:i(()=>[(s(!0),y(D,null,C(V.value,o=>(s(),h(L,{key:o.id,value:o.id,onClick:f=>$(o.id,u.value,d.value.id)},{default:i(()=>[N(Q(o.label),1)]),_:2},1032,["value","onClick"]))),128))]),_:1}),(s(!0),y(D,null,C(V.value,o=>(s(),h(j,{key:o.id,value:o.id},{default:i(()=>[v.value!==0?(s(),h(P,{key:0,value:u.value,scrollable:""},{default:i(()=>[n(M,null,{default:i(()=>[(s(!0),y(D,null,C(O.value,f=>(s(),h(L,{key:f.id,value:f.id,onClick:fe=>$(o.id,f.id,d.value.id)},{default:i(()=>[N(Q(f.label),1)]),_:2},1032,["value","onClick"]))),128))]),_:2},1024),(s(!0),y(D,null,C(O.value,f=>(s(),h(j,{key:f.id,value:f.id},null,8,["value"]))),128))]),_:2},1032,["value"])):S("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),m("div",ve,[v.value&&u.value?(s(),y("div",de,[n(H,{modelValue:d.value,"onUpdate:modelValue":e[3]||(e[3]=o=>d.value=o),options:_.value,optionLabel:"label",placeholder:"选择日期",onChange:e[4]||(e[4]=o=>$(v.value,u.value,d.value.id))},null,8,["modelValue","options"]),e[5]||(e[5]=m("label",null," 日",-1))])):S("",!0),n(W,{value:a.value,stripedRows:"",scrollable:"",scrollHeight:"flex",paginator:"",rows:10,rowsPerPageOptions:[5,10,20,50],tableStyle:"min-width: 50rem"},{empty:i(()=>e[6]||(e[6]=[m("div",{class:"text-center py-5"},[m("i",{class:"pi pi-search",style:{"font-size":"3rem",color:"#ccc"}}),m("p",{class:"mt-3 text-gray-500"},"未找到销售量")],-1)])),default:i(()=>[n(k,{field:"id",header:"ID",sortable:""}),n(k,{field:"category",header:"类型",sortable:""}),n(k,{field:"name",header:"菜名"}),n(k,{field:"orderQuantity",header:(v.value===0?"":u.value===0?"当年":d.value.id===0?"当月":"当日")+"销售量"},{body:i(({data:o})=>[N(Q((v.value===0?o.orders:u.value===0?o.yearlyOrders:d.value.id===0?o.monthlyOrders:o.dailyOrders)|0),1)]),_:1},8,["header"])]),_:1},8,["value"])])]),n(Z)])}}};export{Ve as default};
