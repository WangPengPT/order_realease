import{g as ve,p as fe,u as Z,r as d,P as ce,t as ee,Q as Ve,R as pe,f as a,m as le,h as r,n as ae,i as j,F as ie,o as be,L as U,J as ye,E as s,H as R,S as b,M as _,I as y,D as M,N as O,O as F}from"./index-rOOKnaDG.js";import{u as ke,c as te,f as Ce,m as we,V as B,a as C,b as J,d as oe}from"./VTextField-CZljh115.js";import{b as se,m as ge,V as Q,a as De}from"./VDialog-BrwWgmtd.js";import{v as Se,a as he,s as Ue,w as Ae,x as re,L as xe,y as Pe,V as f}from"./scopeId-BHy8Jw21.js";import{V as ne,a as ue,b as N}from"./VSpacer-CAfVbb7H.js";import{V as Ie}from"./VForm-B2QWnA5Z.js";import"./VList-vIQ43p_q.js";const Re=fe({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...we(),...ge()},"VSwitch"),c=ve()({name:"VSwitch",inheritAttrs:!1,props:Re(),emits:{"update:focused":n=>!0,"update:modelValue":n=>!0,"update:indeterminate":n=>!0},setup(n,w){let{attrs:g,slots:i}=w;const m=Z(n,"indeterminate"),v=Z(n,"modelValue"),{loaderClasses:A}=Se(n),{isFocused:z,focus:V,blur:x}=ke(n),P=d(),p=d(),t=ce&&window.matchMedia("(forced-colors: active)").matches,T=ee(()=>typeof n.loading=="string"&&n.loading!==""?n.loading:n.color),q=Ve(),X=ee(()=>n.id||`switch-${q}`);function E(){m.value&&(m.value=!1)}function W(D){var S,h;D.stopPropagation(),D.preventDefault(),(h=(S=P.value)==null?void 0:S.input)==null||h.click()}return he(()=>{const[D,S]=pe(g),h=te.filterProps(n),L=se.filterProps(n);return a(te,le({ref:p,class:["v-switch",{"v-switch--flat":n.flat},{"v-switch--inset":n.inset},{"v-switch--indeterminate":m.value},A.value,n.class]},D,h,{modelValue:v.value,"onUpdate:modelValue":o=>v.value=o,id:X.value,focused:z.value,style:n.style}),{...i,default:o=>{let{id:e,messagesId:l,isDisabled:u,isReadonly:$,isValid:K}=o;const G={model:v,isValid:K};return a(se,le({ref:P},L,{modelValue:v.value,"onUpdate:modelValue":[I=>v.value=I,E],id:e.value,"aria-describedby":l.value,type:"checkbox","aria-checked":m.value?"mixed":void 0,disabled:u.value,readonly:$.value,onFocus:V,onBlur:x},S),{...i,default:I=>{let{backgroundColorClasses:Y,backgroundColorStyles:k}=I;return r("div",{class:j(["v-switch__track",t?void 0:Y.value]),style:ae(k.value),onClick:W},[i["track-true"]&&r("div",{key:"prepend",class:"v-switch__track-true"},[i["track-true"](G)]),i["track-false"]&&r("div",{key:"append",class:"v-switch__track-false"},[i["track-false"](G)])])},input:I=>{let{inputNode:Y,icon:k,backgroundColorClasses:de,backgroundColorStyles:me}=I;return r(ie,null,[Y,r("div",{class:j(["v-switch__thumb",{"v-switch__thumb--filled":k||n.loading},n.inset||t?void 0:de.value]),style:ae(n.inset?void 0:me.value)},[i.thumb?a(Ue,{defaults:{VIcon:{icon:k,size:"x-small"}}},{default:()=>[i.thumb({...G,icon:k})]}):a(Ae,null,{default:()=>[n.loading?a(xe,{name:"v-switch",active:!0,color:K.value===!1?void 0:T.value},{default:H=>i.loader?i.loader(H):a(Pe,{active:H.isActive,color:H.color,indeterminate:!0,size:"16",width:"2"},null)}):k&&a(re,{key:String(k),icon:k,size:"x-small"},null)]})])])}})}})}),Ce({},p)}}),_e={class:"text-no-wrap"},qe={__name:"server_manager",setup(n){const w=d(!1),g=d(!1),i=d(!1),m=d(null),v=d(null),A=d(""),z=[{align:"start",key:"online",title:"Statu"},{key:"id",sortable:!1,title:"id"},{key:"port",title:"Port"},{key:"qr_addr",title:"qr_addr"},{key:"takeaway_key",title:"takeaway_key"},{key:"url",title:"server url"},{key:"shopify_name",title:"shopify name"},{key:"actions",title:"Actions"}],V=d([]),x=d({});be(()=>{P()});function P(){U.getAllSever(o=>{console.log("serverAPI.getAllSever",o),o.result&&(console.log("ret: ",o.datas,o.states),V.value=o.datas,x.value=o.states)})}let p=d(!1);const t=d({});function T(o,e){p.value=!1,w.value=!0,t.value={...e.item},t.value.permissionsControl||(t.value.permissionsControl={}),t.value.customDishesControl||(t.value.customDishesControl={1:{enabled:!0,name:"Sushi Aleatória®"},2:{enabled:!0,name:"Poke Bowl"},3:{enabled:!0,name:"MY BOX"},4:{enabled:!0,name:"bibimbap"},5:{enabled:!0,name:"XIAOXIONG® RAMEN"},6:{enabled:!0,name:"Menu Almoço"}})}function q(){w.value=!1;let o=t.value;if(p.value)o.url&&(o.url=o.url.trim()),o.url==""&&(o.url=void 0),o.takeWay||(o.takeWay=!1),U.addServer(o,e=>{e.result==!0&&V.value.push(e.data)});else{const e=V.value.findIndex(l=>l.id===o.id);if(e!==-1){let l=V.value[e],u=!1;for(const $ in o)if(o[$]!=l[e]){u=!0;break}o.takeWay||(o.takeWay=!1),u&&(U.setServer(o),V.value.splice(e,1,t.value))}}}function X(o,e){v.value=e.item,i.value=!0}function E(){if(!v.value||!v.value.id)return;const o=v.value.id;U.deleteServer(o,e=>{if(e&&e.result){const l=V.value.findIndex(u=>u.id===o);l!==-1&&V.value.splice(l,1)}else alert("Failed to delete server: "+((e==null?void 0:e.message)||"Unknown error"));i.value=!1})}function W(){w.value=!0,t.value={id:"",url:"",permissionsControl:{},customDishesControl:{1:{enabled:!0,name:"Sushi Aleatória®"},2:{enabled:!0,name:"Poke Bowl"},3:{enabled:!0,name:"MY BOX"},4:{enabled:!0,name:"bibimbap"},5:{enabled:!0,name:"XIAOXIONG® RAMEN"},6:{enabled:!0,name:"Menu Almoço"}}},p.value=!0}function D(o){if(x.value.statuOnline)return x.value.statuOnline[o.id]}function S(o,e){m.value=e.item,g.value=!0}function h(o,e){console.log("item.id",e.item.id);const l=e.item.id;U.manualUpdate(l)}async function L(){if(!m.value||!m.value.id){alert("Server ID not available");return}const o=m.value.id;console.log("Resetting password for server:",o),U.resetPassword(o,e=>{console.log("Reset password response:",e),e&&e.result?alert("Password reset successfully!"):alert("Password reset failed: "+((e==null?void 0:e.data)||"Unknown error")),g.value=!1})}return(o,e)=>(R(),ye(ie,null,[a(B,{title:"Server Manager",flat:""},{text:s(()=>[a(C,{modelValue:A.value,"onUpdate:modelValue":e[0]||(e[0]=l=>A.value=l),label:"Search","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":"","single-line":""},null,8,["modelValue"]),a(f,{class:"ma-2",onClick:W,color:"indigo-darken-3"},{default:s(()=>e[24]||(e[24]=[y("new server")])),_:1,__:[24]}),a(f,{class:"ma-2",onClick:P,color:"indigo-darken-3"},{default:s(()=>e[25]||(e[25]=[y("refresh")])),_:1,__:[25]})]),default:s(()=>[a(De,{headers:z,items:V.value,search:A.value,hover:""},{item:s(({item:l})=>[r("tr",_e,[r("td",{class:j({"text-success":D(l),"text-error":!D(l)})},[a(re,{icon:"mdi-circle"})],2),r("td",null,b(l.id),1),r("td",null,b(l.port),1),r("td",null,b(l.qr_addr),1),r("td",null,b(l.takeaway_key),1),r("td",null,b(l.url),1),r("td",null,b(l.shopify_name),1),r("td",null,[a(f,{size:"small",icon:"mdi-pencil",onClick:_(u=>T(u,{item:l}),["stop"])},null,8,["onClick"]),a(f,{class:"ml-2",size:"small",icon:"mdi-trash-can-outline",onClick:_(u=>X(u,{item:l}),["stop"])},null,8,["onClick"]),a(f,{class:"ml-2",size:"small",icon:"mdi-lock-reset",onClick:_(u=>S(u,{item:l}),["stop"]),color:"warning"},null,8,["onClick"]),a(f,{class:"ml-2",size:"small",icon:"mdi-arrow-up-thin-circle-outline",onClick:_(u=>h(u,{item:l}),["stop"]),color:"warning"},null,8,["onClick"])])])]),_:1},8,["items","search"])]),_:1}),a(Q,{modelValue:i.value,"onUpdate:modelValue":e[2]||(e[2]=l=>i.value=l),width:"400"},{default:s(()=>[a(B,{title:"Delete Server"},{default:s(()=>[a(J,null,{default:s(()=>{var l;return[y(" Are you sure you want to delete server "+b((l=v.value)==null?void 0:l.id)+"? This action cannot be undone. ",1)]}),_:1}),a(oe,null,{default:s(()=>[a(ne),a(f,{color:"grey",onClick:e[1]||(e[1]=l=>i.value=!1)},{default:s(()=>e[26]||(e[26]=[y("Cancel")])),_:1,__:[26]}),a(f,{color:"error",onClick:E},{default:s(()=>e[27]||(e[27]=[y("Delete")])),_:1,__:[27]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(Q,{modelValue:g.value,"onUpdate:modelValue":e[4]||(e[4]=l=>g.value=l),width:"400"},{default:s(()=>[a(B,{title:"Reset Password"},{default:s(()=>[a(J,null,{default:s(()=>{var l,u;return[y(" Are you sure you want to reset the password for "+b((l=m.value)==null?void 0:l.id)+" ("+b((u=m.value)==null?void 0:u.url)+")? The password will be reset to the default administrator password. ",1)]}),_:1}),a(oe,null,{default:s(()=>[a(ne),a(f,{color:"grey",onClick:e[3]||(e[3]=l=>g.value=!1)},{default:s(()=>e[28]||(e[28]=[y("Cancel")])),_:1,__:[28]}),a(f,{color:"warning",onClick:L},{default:s(()=>e[29]||(e[29]=[y("Reset")])),_:1,__:[29]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(Q,{modelValue:w.value,"onUpdate:modelValue":e[23]||(e[23]=l=>w.value=l),width:"500"},{default:s(()=>[a(B,{title:"edit user"},{default:s(()=>[a(J),a(Ie,{"fast-fail":"",onSubmit:_(q,["prevent"])},{default:s(()=>[F(p)?(R(),M(C,{key:0,class:"ma-3",modelValue:t.value.id,"onUpdate:modelValue":e[5]||(e[5]=l=>t.value.id=l),variant:"outlined",label:"name"},null,8,["modelValue"])):O("",!0),F(p)?O("",!0):(R(),M(C,{key:1,class:"ma-3",modelValue:t.value.id,"onUpdate:modelValue":e[6]||(e[6]=l=>t.value.id=l),variant:"outlined",label:"name",readonly:""},null,8,["modelValue"])),F(p)?(R(),M(C,{key:2,class:"ma-3",modelValue:t.value.url,"onUpdate:modelValue":e[7]||(e[7]=l=>t.value.url=l),variant:"outlined",label:"url"},null,8,["modelValue"])):O("",!0),F(p)?O("",!0):(R(),M(C,{key:3,class:"ma-3",modelValue:t.value.url,"onUpdate:modelValue":e[8]||(e[8]=l=>t.value.url=l),variant:"outlined",label:"url"},null,8,["modelValue"])),a(C,{class:"ma-3",modelValue:t.value.qr_addr,"onUpdate:modelValue":e[9]||(e[9]=l=>t.value.qr_addr=l),variant:"outlined",label:"qr_addr"},null,8,["modelValue"]),a(C,{class:"ma-3",modelValue:t.value.takeaway_key,"onUpdate:modelValue":e[10]||(e[10]=l=>t.value.takeaway_key=l),variant:"outlined",label:"takeaway_key"},null,8,["modelValue"]),a(C,{class:"ma-3",modelValue:t.value.shopify_name,"onUpdate:modelValue":e[11]||(e[11]=l=>t.value.shopify_name=l),variant:"outlined",label:"shopify_name"},null,8,["modelValue"]),a(ue,{class:"ma-3 pa-1 border-solid"},{default:s(()=>[a(N,null,{default:s(()=>[a(c,{class:"ml-2",modelValue:t.value.permissionsControl.order,"onUpdate:modelValue":e[12]||(e[12]=l=>t.value.permissionsControl.order=l),label:"Order",color:"primary","hide-details":"",inset:""},null,8,["modelValue"]),a(c,{class:"ml-2",modelValue:t.value.permissionsControl.delivery,"onUpdate:modelValue":e[13]||(e[13]=l=>t.value.permissionsControl.delivery=l),label:"Delivery",color:"primary","hide-details":"",inset:""},null,8,["modelValue"]),a(c,{class:"ml-2",modelValue:t.value.permissionsControl.fandays,"onUpdate:modelValue":e[14]||(e[14]=l=>t.value.permissionsControl.fandays=l),label:"Fandays",color:"primary","hide-details":"",inset:""},null,8,["modelValue"])]),_:1}),a(N,null,{default:s(()=>[a(c,{class:"ml-2",modelValue:t.value.permissionsControl.reserver,"onUpdate:modelValue":e[15]||(e[15]=l=>t.value.permissionsControl.reserver=l),label:"Reserver",color:"primary","hide-details":"",inset:""},null,8,["modelValue"]),a(c,{class:"ml-2",modelValue:t.value.permissionsControl.vip,"onUpdate:modelValue":e[16]||(e[16]=l=>t.value.permissionsControl.vip=l),label:"VIP",color:"primary","hide-details":"",inset:""},null,8,["modelValue"])]),_:1})]),_:1}),a(ue,{class:"ma-3 pa-1 border-solid"},{default:s(()=>[a(N,null,{default:s(()=>[a(c,{class:"ml-2",modelValue:t.value.customDishesControl[1].enabled,"onUpdate:modelValue":e[17]||(e[17]=l=>t.value.customDishesControl[1].enabled=l),label:t.value.customDishesControl[1].name,color:"primary","hide-details":"",inset:""},null,8,["modelValue","label"]),a(c,{class:"ml-2",modelValue:t.value.customDishesControl[2].enabled,"onUpdate:modelValue":e[18]||(e[18]=l=>t.value.customDishesControl[2].enabled=l),label:t.value.customDishesControl[2].name,color:"primary","hide-details":"",inset:""},null,8,["modelValue","label"]),a(c,{class:"ml-2",modelValue:t.value.customDishesControl[3].enabled,"onUpdate:modelValue":e[19]||(e[19]=l=>t.value.customDishesControl[3].enabled=l),label:t.value.customDishesControl[3].name,color:"primary","hide-details":"",inset:""},null,8,["modelValue","label"])]),_:1}),a(N,null,{default:s(()=>[a(c,{class:"ml-2",modelValue:t.value.customDishesControl[4].enabled,"onUpdate:modelValue":e[20]||(e[20]=l=>t.value.customDishesControl[4].enabled=l),label:t.value.customDishesControl[4].name,color:"primary","hide-details":"",inset:""},null,8,["modelValue","label"]),a(c,{class:"ml-2",modelValue:t.value.customDishesControl[5].enabled,"onUpdate:modelValue":e[21]||(e[21]=l=>t.value.customDishesControl[5].enabled=l),label:t.value.customDishesControl[5].name,color:"primary","hide-details":"",inset:""},null,8,["modelValue","label"]),a(c,{class:"ml-2",modelValue:t.value.customDishesControl[6].enabled,"onUpdate:modelValue":e[22]||(e[22]=l=>t.value.customDishesControl[6].enabled=l),label:t.value.customDishesControl[6].name,color:"primary","hide-details":"",inset:""},null,8,["modelValue","label"])]),_:1})]),_:1}),a(B,{class:"text-center"},{default:s(()=>[a(f,{width:"200",class:"mb-3",type:"submit",color:"indigo-darken-3"},{default:s(()=>e[30]||(e[30]=[y("Submit")])),_:1,__:[30]})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{qe as default};
