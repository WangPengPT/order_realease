import{s as U}from"./index-AnYWwi_M.js";import{b as $}from"./index-DWklaDIL.js";import{s as D}from"./index-C6BK8v4s.js";import{s as E}from"./index-9rXCVq2q.js";import{C as k,Q as P}from"./CodeMaker-IOgtdCDu.js";import{q as B,h as c,u as N,c as w,a as t,d as l,t as u,l as n,e as y,f as S,w as h,F as j,o as _}from"./index-DvgtXvQl.js";import"./index-CkatVjIO.js";import"./_commonjsHelpers-gnU0ypJ3.js";const F={class:"flex flex-wrap align-items-center"},L={class:"font-bold"},M={class:"flex flex-wrap justify-content-center w-full mt-2"},A={key:0,class:"flex flex-column align-items-center justify-content-center"},I={class:"font-bold"},O={key:1,class:"flex flex-column align-items-center justify-content-center gap-3"},G={class:"font-bold"},z={class:"flex flex-row gap-3"},H={for:"on_label"},J={for:"on_label"},K={for:"on_label"},ne={__name:"QCodePage",setup(W){const{t:o}=B(),p=c(!1),C=N(),g=c(0),b=c(""),x=c(0),r=c(""),f=c(null),V=c(!1);async function Q(){const a=document.createElement("canvas");for(let e=g.value;e<=x.value;e++){const v=e<10?`0${e}`:`${e}`,i="https://sushi.xiaoxiong.pt"+b.value+"/client.html?table="+k.SimpleEncode(v);console.log("生成二维码数据: ",i),await P.toCanvas(a,i,{width:300});const d=document.createElement("a");d.download=`${v}.png`,d.href=a.toDataURL("image/png"),d.click(),await new Promise(m=>setTimeout(m,300))}console.log("全部二维码下载完毕")}const T=()=>{if(r.value){let a=window.env.QR_ADDR+k.SimpleEncode(r.value);console.log("The qrcode data: ",a),P.toCanvas(f.value,a,{width:300},e=>{e?console.error(e):V.value=!0})}},R=()=>{if(f.value){const a=document.createElement("a");a.download=`座号-${r.value}-二维码.png`,a.href=f.value.toDataURL("image/png"),a.click()}};function q(){if(!r.value){C.add({severity:"error",summary:o("common.error"),detail:o("optionPages.emptyTableMsg"),life:3e3});return}T(),C.add({severity:"success",summary:o("common.success"),detail:o("optionPages.createQrMsg")+r.value,life:3e3})}return(a,e)=>{const v=E,i=D,d=$,m=U;return _(),w(j,null,[t("div",F,[l(v,{modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=s=>p.value=s),class:"m-4"},null,8,["modelValue"]),t("p",L,u(n(o)("optionPages.createQrOne")),1)]),t("div",M,[p.value?y("",!0):(_(),w("div",A,[t("h1",I,u(n(o)("optionPages.tableQr")),1),l(i,{type:"text",modelValue:r.value,"onUpdate:modelValue":e[1]||(e[1]=s=>r.value=s),placeholder:n(o)("optionPages.enterTable"),class:"m-3"},null,8,["modelValue","placeholder"]),l(d,{label:n(o)("optionPages.createQr"),onClick:q},null,8,["label"]),t("div",null,[t("canvas",{ref_key:"qrCanvas",ref:f},null,512)]),V.value?(_(),S(d,{key:0,label:n(o)("optionPages.downloadQr"),icon:"pi pi-download",onClick:R},null,8,["label"])):y("",!0)])),p.value?(_(),w("div",O,[t("h2",G,u(n(o)("optionPages.tableQrOne")),1),t("div",z,[l(m,{variant:"on"},{default:h(()=>[l(i,{type:"number",modelValue:g.value,"onUpdate:modelValue":e[2]||(e[2]=s=>g.value=s),style:{"max-width":"100px"}},null,8,["modelValue"]),t("label",H,u(n(o)("optionPages.startTable")),1)]),_:1}),l(m,{variant:"on"},{default:h(()=>[l(i,{type:"number",modelValue:x.value,"onUpdate:modelValue":e[3]||(e[3]=s=>x.value=s),style:{"max-width":"100px"}},null,8,["modelValue"]),t("label",J,u(n(o)("optionPages.endTable")),1)]),_:1})]),l(m,{variant:"on"},{default:h(()=>[l(i,{type:"text",modelValue:b.value,"onUpdate:modelValue":e[4]||(e[4]=s=>b.value=s)},null,8,["modelValue"]),t("label",K,u(n(o)("optionPages.enterAddress")),1)]),_:1}),l(d,{label:n(o)("optionPages.createDownloadQr"),onClick:Q},null,8,["label"])])):y("",!0)])],64)}}};export{ne as default};
