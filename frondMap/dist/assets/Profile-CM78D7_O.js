const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BFidtWYN.js","assets/index-CcT3CfTj.css"])))=>i.map(i=>d[i]);
import{l as Is,d as Ce,j as e,D as De,q as Fe,a6 as Te,a7 as Ue,g as K,f as se,o as Xe,s as P,u as At,y as qs,r as j,ar as Vs,as as Pt,ad as Ks,B as D,a9 as js,a1 as vs,a2 as ys,a3 as Ns,I as O,aa as k,ai as He,aj as Qe,ak as qe,al as Ve,am as Ke,at as Mt,K as le,N as ie,O as oe,Q as ce,R as de,T as me,U as he,V as J,z as b,_ as It,e as We,ag as Ze,ah as Je,ae as Gs,C as Q,a as pe,m as ge,i as Re,b as q,aq as Ne,ac as kt,h as ws,P as Rt,au as Ot,af as T,Z as Dt,a0 as ue,k as ee,av as Ys,a8 as ke,aw as Fs,ax as Ie}from"./index-BFidtWYN.js";import{H as Oe}from"./heart-DS5IU7dG.js";import{T as ps,a as gs,b as re,c as ne}from"./tabs-V42ZnOFF.js";import{C as Ft,a as Tt,b as ze}from"./carousel-CEN6AmS-.js";import{a as Ut}from"./useActivities-BUBs5DRw.js";import{u as Xs}from"./useLocalizedContent-Cz_sBRuN.js";import{u as Lt}from"./useActivityParticipation-DueaNpTF.js";import{d as $t}from"./useCoupons-X8DmgDrq.js";import{S as zt}from"./settings-Co93kUzF.js";import{U as Bt}from"./upload-DoDgKf96.js";import{L as Ht}from"./lock-2WR3uX6W.js";import{T as Ws}from"./trash-2-CsnJWyJn.js";import{C as Qt}from"./checkbox-CGJO7sNO.js";import{P as Ts}from"./plus-Do2rl3FN.js";import{S as qt}from"./square-pen-BhohwWi8.js";import{B as Vt}from"./briefcase-81j0hQGi.js";import{B as Kt}from"./building-Ik8YA65b.js";import{A as Us}from"./ActivityTermsAgreement-DRMcmX9A.js";import{S as Ls}from"./separator-CvUnWby8.js";import{T as Ge}from"./ticket-BkzIWh41.js";import{C as Gt}from"./clock-CoSDiFhL.js";import{f as Se}from"./format-Ljp4baOn.js";import{u as Yt}from"./use-mobile-CcEjnPFc.js";import"./arrow-left-vcc9JHTg.js";import"./useActivityRules-lPeDwzO9.js";import"./file-text-DwQz1xoA.js";import"./circle-alert-RWepbIRp.js";import"./startOfDay-fLkWSNzR.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=Is("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=Is("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=Is("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);function Zt({open:s,onOpenChange:t,activity:i}){const{t:n}=Ce();return e.jsx(De,{open:s,onOpenChange:t,children:e.jsxs(Fe,{className:"max-w-[90vw] sm:max-w-md",children:[e.jsx(Te,{children:e.jsx(Ue,{className:"text-lg font-semibold line-clamp-2",children:i.title})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(K,{variant:"secondary",className:"flex items-center gap-1.5 w-fit",children:[e.jsx(Oe,{className:"w-3.5 h-3.5 fill-primary text-primary"}),n("profile.activityFavorited")]}),i.image_url&&e.jsx("div",{className:"w-full aspect-video rounded-lg overflow-hidden bg-secondary/30",children:e.jsx("img",{src:i.image_url,alt:i.title,className:"w-full h-full object-cover"})}),e.jsx("div",{className:`text-muted-foreground text-sm prose prose-sm max-w-none line-clamp-4\r
              [&_span[style*='color']]:!text-inherit`,dangerouslySetInnerHTML:{__html:i.content}})]})]})})}const Jt=()=>{const{user:s}=se();return Xe({queryKey:["favorites",s==null?void 0:s.id],queryFn:async()=>{if(!s)return[];const{data:t,error:i}=await P.from("favorites").select("restaurant_id").eq("user_id",s.id);if(i)throw i;if(!t||t.length===0)return[];const n=t.map(x=>x.restaurant_id),{data:u,error:d}=await P.from("restaurants").select("*").in("id",n);if(d)throw d;return u||[]},enabled:!!s})},ea=()=>{const{user:s}=se();return Xe({queryKey:["user-comments",s==null?void 0:s.id],queryFn:async()=>{if(!s)return[];const{data:t,error:i}=await P.from("comments").select("*").eq("user_id",s.id).is("parent_id",null).order("created_at",{ascending:!1});if(i)throw i;if(!t||t.length===0)return[];const n=t.filter(o=>o.target_type==="restaurant").map(o=>o.target_id),u=t.filter(o=>o.target_type==="activity").map(o=>o.target_id),d=new Map;if(n.length>0){const{data:o}=await P.from("restaurants").select("id, name, name_en, name_pt").in("id",n);o==null||o.forEach(r=>{d.set(r.id,{name:r.name,name_en:r.name_en||void 0,name_pt:r.name_pt||void 0})})}const x=new Map;if(u.length>0){const{data:o}=await P.from("activities").select("id, title_zh, title_en, title_pt").in("id",u);o==null||o.forEach(r=>{x.set(r.id,{title_zh:r.title_zh,title_en:r.title_en,title_pt:r.title_pt})})}return t.map(o=>{if(o.target_type==="restaurant"){const r=d.get(o.target_id);return{...o,target_name:(r==null?void 0:r.name)||"Unknown Restaurant",target_name_en:r==null?void 0:r.name_en,target_name_pt:r==null?void 0:r.name_pt}}else if(o.target_type==="activity"){const r=x.get(o.target_id);return{...o,target_name:(r==null?void 0:r.title_zh)||"Unknown Activity",target_name_en:r==null?void 0:r.title_en,target_name_pt:r==null?void 0:r.title_pt}}return o})},enabled:!!s,staleTime:3e4})},sa=()=>{const{user:s}=se(),{data:t=[]}=Lt();return Xe({queryKey:["merchantActivities",s==null?void 0:s.id],queryFn:async()=>{if(!s||t.length===0)return[];const i=t.map(a=>a.id),{data:n,error:u}=await P.from("activity_restaurants").select("*").in("restaurant_id",i).order("created_at",{ascending:!1});if(u)throw u;if(!n||n.length===0)return[];const{data:d}=await P.from("restaurants").select("id, name, name_en, name_pt, address").in("id",i),x=[...new Set(n.map(a=>a.activity_id))],{data:o}=await P.from("activities").select("*").in("id",x).eq("status","published");return n.map(a=>{const l=d==null?void 0:d.find(m=>m.id===a.restaurant_id),c=o==null?void 0:o.find(m=>m.id===a.activity_id);return{activity_id:a.activity_id,restaurant_id:a.restaurant_id,restaurant_name:(l==null?void 0:l.name)||"",restaurant_name_en:(l==null?void 0:l.name_en)||null,restaurant_name_pt:(l==null?void 0:l.name_pt)||null,restaurant_address:(l==null?void 0:l.address)||"",activity:c||null,created_at:a.created_at}}).filter(a=>a.activity!==null)},enabled:!!s&&t.length>0})},Zs=[{code:"+351",country:"Portugal",flag:"ðŸ‡µðŸ‡¹"},{code:"+34",country:"Spain",flag:"ðŸ‡ªðŸ‡¸"},{code:"+33",country:"France",flag:"ðŸ‡«ðŸ‡·"},{code:"+49",country:"Germany",flag:"ðŸ‡©ðŸ‡ª"},{code:"+39",country:"Italy",flag:"ðŸ‡®ðŸ‡¹"},{code:"+44",country:"UK",flag:"ðŸ‡¬ðŸ‡§"},{code:"+31",country:"Netherlands",flag:"ðŸ‡³ðŸ‡±"},{code:"+32",country:"Belgium",flag:"ðŸ‡§ðŸ‡ª"},{code:"+86",country:"China",flag:"ðŸ‡¨ðŸ‡³"},{code:"+1",country:"USA/Canada",flag:"ðŸ‡ºðŸ‡¸"},{code:"+55",country:"Brazil",flag:"ðŸ‡§ðŸ‡·"}],$s=s=>{if(!s)return{code:"+351",number:""};for(const t of Zs)if(s.startsWith(t.code))return{code:t.code,number:s.slice(t.code.length).trim()};return{code:"+351",number:s}},zs=({profile:s})=>{const{t}=Ce(),i=At(),{user:n}=se(),{isAdmin:u}=qs(),[d,x]=j.useState(!1),[o,r]=j.useState(s.display_name),a=$s(s.phone),[l,c]=j.useState(a.code),[m,p]=j.useState(a.number),[f,y]=j.useState(!1),[v,F]=j.useState(null),[E,N]=j.useState(s.avatar_url||""),[S,R]=j.useState(!1),[L,G]=j.useState(!1),[$,M]=j.useState(""),[te,U]=j.useState(!1),xe=j.useRef(!1);j.useEffect(()=>{const h=xe.current;if(xe.current=d,d&&!h){r(s.display_name);const w=$s(s.phone);c(w.code),p(w.number),N(s.avatar_url||""),F(null),y(!1)}},[d,s.display_name,s.phone,s.avatar_url]);const[je,z]=j.useState(!1),[H,Y]=j.useState(!1),[X,W]=j.useState(!1),[g,_]=j.useState(""),[A,B]=j.useState(""),[fe,_e]=j.useState(""),[be,Le]=j.useState(!1),[ve,$e]=j.useState(!1),[ks,es]=j.useState(!1),[mt,Pe]=j.useState(!1),[ht,Me]=j.useState(!1),[ss,ts]=j.useState(""),[ae,as]=j.useState(""),[ye,rs]=j.useState(""),[Rs,ns]=j.useState(!1),[ls,is]=j.useState(""),[Ee,os]=j.useState(!1),[Os,Ds]=j.useState(!1),[Z,cs]=j.useState(null),ds=j.useRef(null),ms=j.useRef(null),hs=j.useRef(null),us=Vs(),xs=Pt();j.useEffect(()=>{be&&ds.current&&ds.current.focus()},[be]),j.useEffect(()=>{ve&&ms.current&&ms.current.focus()},[ve]),j.useEffect(()=>{Ee&&hs.current&&hs.current.focus()},[Ee]);const ut=h=>{var V;const w=(V=h.target.files)==null?void 0:V[0];if(w){if(w.size>2*1024*1024)return;F(w),N(URL.createObjectURL(w))}},xt=async()=>{let h=s.avatar_url;if(v){const V=await xs.mutateAsync(v);V&&(h=V)}const w=m?`${l} ${m}`:void 0;await us.mutateAsync({display_name:o,phone:w,avatar_url:h||void 0}),y(!1),x(!1)},ft=async()=>{if(!(!n||$.toLowerCase()!=="delete")){U(!0);try{const{error:h}=await P.functions.invoke("delete-account",{body:{userId:n.id}});if(h){b.error(t("profile.deleteAccountFailed")),console.error(h),U(!1);return}b.success(t("profile.deleteAccountSuccess")),G(!1),R(!1),M(""),await new Promise(w=>setTimeout(w,1500)),await P.auth.signOut(),i("/auth")}catch(h){b.error(h.message||t("profile.deleteAccountFailed")),U(!1)}finally{U(!1)}}},pt=async()=>{if(n!=null&&n.email)try{const{error:h}=await P.functions.invoke("send-verification-code",{body:{email:n.email}});if(h)throw h;Le(!0),b.success(t("profile.codeSentToOldEmail"))}catch(h){b.error(t("profile.sendCodeFailed")),console.error(h)}},gt=async()=>{if(!A){b.error(t("profile.enterCodePlaceholder"));return}try{const{data:h,error:w}=await P.functions.invoke("verify-email-code",{body:{email:n==null?void 0:n.email,code:A}});if(w||!(h!=null&&h.success)){b.error(t("profile.codeIncorrect"));return}b.success(t("profile.oldEmailVerified")),z(!1),Y(!0)}catch(h){b.error(t("profile.verificationFailed")),console.error(h)}},jt=async()=>{if(!g||!g.includes("@")){b.error(t("profile.enterValidEmail"));return}try{const{error:h}=await P.functions.invoke("send-verification-code",{body:{email:g}});if(h)throw h;b.success(t("profile.codeSentToNewEmail")),$e(!0)}catch(h){b.error(t("profile.sendCodeFailed")),console.error(h)}},vt=async()=>{if(!fe){b.error(t("profile.enterCodePlaceholder"));return}try{const{data:h,error:w}=await P.functions.invoke("verify-email-code",{body:{email:g,code:fe}});if(w||!(h!=null&&h.success)){b.error(t("profile.codeIncorrect"));return}b.success(t("profile.newEmailVerified")),Y(!1),setTimeout(()=>{W(!0)},100)}catch(h){b.error(t("toast.verificationFailed")),console.error(h)}},yt=async()=>{es(!0);try{const{data:{session:h}}=await P.auth.getSession();if(!h||!n){b.error(t("toast.pleaseSignIn")),es(!1);return}const{data:w,error:V}=await P.functions.invoke("update-email",{body:{userId:n.id,oldEmail:n.email,oldEmailCode:A,newEmail:g,newEmailCode:fe},headers:{Authorization:`Bearer ${h.access_token}`}});if(V||!(w!=null&&w.success))throw new Error((w==null?void 0:w.error)||"Failed to update email");b.success(t("toast.emailUpdatedSuccess")),W(!1),x(!1),B(""),_(""),_e(""),Le(!1),$e(!1),await new Promise(fs=>setTimeout(fs,1500)),await P.auth.signOut(),i("/auth")}catch(h){b.error(h.message||t("toast.emailUpdateError")),console.error(h)}finally{es(!1)}},Nt=h=>{let w=0;return h.length>=6&&w++,h.length>=8&&w++,/[a-z]/.test(h)&&w++,/[A-Z]/.test(h)&&w++,/[0-9]/.test(h)&&w++,/[^a-zA-Z0-9]/.test(h)&&w++,w<=2?"weak":w<=4?"medium":"strong"},wt=async h=>{if(h==null||h.preventDefault(),h==null||h.stopPropagation(),!ss){b.error(t("profile.enterCurrentPassword"));return}try{const{createClient:w}=await It(async()=>{const{createClient:Et}=await import("./index-BFidtWYN.js").then(St=>St.bJ);return{createClient:Et}},__vite__mapDeps([0,1])),V=w("https://tzdgqhwyzsxkxnncgzap.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR6ZGdxaHd5enN4a3hubmNnemFwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM2NTg2ODgsImV4cCI6MjA3OTIzNDY4OH0.D76C4OkjQVWyMxtjjdOofpD8X_hEEoTtrXHqi4XSYUw",{auth:{persistSession:!1,autoRefreshToken:!1}}),{error:fs}=await V.auth.signInWithPassword({email:(n==null?void 0:n.email)||"",password:ss});if(fs){b.error(t("profile.oldPasswordIncorrect"));return}b.success(t("profile.oldPasswordVerified")),Pe(!1),Me(!0)}catch(w){b.error(t("profile.verificationFailed")),console.error(w)}},Ct=async()=>{if(n!=null&&n.email)try{const{error:h}=await P.functions.invoke("send-verification-code",{body:{email:n.email}});if(h)throw h;os(!0),b.success(t("profile.codeSentToOldEmail"))}catch(h){b.error(t("profile.sendCodeFailed")),console.error(h)}},_t=async h=>{if(h==null||h.preventDefault(),h==null||h.stopPropagation(),!ls){b.error(t("profile.enterCodePlaceholder"));return}try{const{data:w,error:V}=await P.functions.invoke("verify-email-code",{body:{email:n==null?void 0:n.email,code:ls}});if(V||!(w!=null&&w.success)){b.error(t("profile.codeIncorrect"));return}b.success(t("profile.oldEmailVerified")),Pe(!1),Me(!0)}catch(w){b.error(t("profile.verificationFailed")),console.error(w)}},bt=async h=>{if(h==null||h.preventDefault(),h==null||h.stopPropagation(),!ae||!ye){b.error(t("profile.enterNewPassword"));return}if(ae.length<6){b.error(t("profile.passwordTooShort"));return}if(ae!==ye){b.error(t("profile.passwordsDontMatch"));return}Ds(!0);try{const{error:w}=await P.auth.updateUser({password:ae});if(w)throw w;b.success(t("profile.passwordUpdated")),Me(!1),x(!1),ts(""),as(""),rs(""),ns(!1),is(""),os(!1)}catch(w){b.error(w.message||t("profile.passwordUpdateFailed")),console.error(w)}finally{Ds(!1)}};return e.jsxs(De,{open:d,onOpenChange:x,children:[e.jsx(Ks,{asChild:!0,children:e.jsxs(D,{variant:"outline",children:[e.jsx(zt,{className:"w-4 h-4 mr-2"}),t("profile.editProfile")]})}),e.jsxs(Fe,{className:"max-w-[90vw] sm:max-w-[425px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Te,{children:[e.jsx(Ue,{children:t("profile.editProfile")}),e.jsx(js,{children:t("profile.editProfileDescription")})]}),e.jsxs("div",{className:"space-y-3 py-3",children:[e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsxs(vs,{className:"w-16 h-16 sm:w-24 sm:h-24",children:[e.jsx(ys,{src:E}),e.jsx(Ns,{children:o==null?void 0:o.charAt(0).toUpperCase()})]}),e.jsxs("div",{children:[e.jsx(O,{type:"file",accept:"image/*",onChange:ut,className:"hidden",id:"avatar-upload"}),e.jsxs(D,{variant:"outline",size:"sm",onClick:()=>{var h;return(h=document.getElementById("avatar-upload"))==null?void 0:h.click()},className:"text-xs sm:text-sm",children:[e.jsx(Bt,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 sm:mr-2"}),t("profile.uploadAvatar")]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(k,{htmlFor:"displayName",className:"text-sm",children:t("profile.displayName")}),e.jsx(O,{id:"displayName",value:o,onChange:h=>r(h.target.value),placeholder:t("profile.displayName"),className:"h-9"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(k,{htmlFor:"phone",className:"text-sm",children:t("profile.phone")}),!s.phone&&!f?e.jsx(D,{variant:"outline",size:"sm",onClick:()=>y(!0),className:"w-full justify-start h-9",children:t("profile.addPhoneNumber")}):f||!s.phone?e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(He,{value:l,onValueChange:c,children:[e.jsx(Qe,{className:"w-[110px] h-9",children:e.jsx(qe,{placeholder:"+351"})}),e.jsx(Ve,{children:Zs.map(h=>e.jsx(Ke,{value:h.code,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:h.flag}),e.jsx("span",{children:h.code})]})},h.code))})]}),e.jsx(O,{id:"phone",className:"flex-1 h-9",value:m,onChange:h=>p(h.target.value),placeholder:t("profile.phonePlaceholder")})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{value:`${l} ${m}`,disabled:!0,className:"h-9 flex-1"}),e.jsx(D,{variant:"outline",size:"sm",onClick:()=>y(!0),className:"text-xs whitespace-nowrap",children:t("profile.modifyPhoneNumber")})]})]}),!u&&e.jsxs("div",{className:"space-y-1.5 pt-2 border-t",children:[e.jsx(k,{className:"text-sm",children:t("profile.email")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{value:(n==null?void 0:n.email)||"",disabled:!0,className:"h-9 flex-1"}),e.jsxs(D,{variant:"outline",size:"sm",onClick:()=>z(!0),className:"text-xs",children:[e.jsx(Mt,{className:"w-3 h-3 mr-1"}),t("profile.modify")]})]})]}),e.jsxs("div",{className:`space-y-1.5 ${u?"pt-2 border-t":""}`,children:[e.jsx(k,{className:"text-sm",children:t("profile.changePassword")}),e.jsxs(D,{variant:"outline",size:"sm",onClick:()=>Pe(!0),className:"w-full justify-start h-9",children:[e.jsx(Ht,{className:"w-3 h-3 mr-2"}),t("profile.changePassword")]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 pt-2 border-t",children:[!u&&e.jsxs(D,{variant:"destructive",size:"sm",onClick:()=>R(!0),className:"w-full sm:w-auto text-xs sm:text-sm",children:[e.jsx(Ws,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 sm:mr-2"}),t("profile.deleteAccount")]}),e.jsxs("div",{className:`flex gap-2 w-full sm:w-auto ${u?"sm:ml-auto":""}`,children:[e.jsx(D,{variant:"outline",size:"sm",onClick:()=>{y(!1),x(!1)},className:"flex-1 sm:flex-none sm:min-w-[80px] text-xs sm:text-sm",children:t("common.cancel")}),e.jsx(D,{size:"sm",onClick:xt,disabled:us.isPending||xs.isPending,className:"flex-1 sm:flex-none sm:min-w-[80px] text-xs sm:text-sm",children:us.isPending||xs.isPending?t("common.loading"):t("common.save")})]})]})]}),e.jsx(le,{open:S,onOpenChange:R,children:e.jsxs(ie,{children:[e.jsxs(oe,{children:[e.jsx(ce,{children:t("profile.deleteAccountWarning")}),e.jsx(de,{children:t("profile.deleteAccountDescription")})]}),e.jsxs(me,{children:[e.jsx(he,{children:t("common.cancel")}),e.jsx(J,{onClick:()=>{R(!1),G(!0)},className:"bg-destructive hover:bg-destructive/90",children:t("common.continue")})]})]})}),e.jsx(le,{open:L,onOpenChange:G,children:e.jsxs(ie,{children:[e.jsxs(oe,{children:[e.jsx(ce,{children:t("profile.confirmDeleteAccount")}),e.jsxs(de,{className:"space-y-4",children:[e.jsx("p",{children:t("profile.confirmDeleteDescription")}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"confirm-delete",children:t("profile.typeDeleteToConfirm")}),e.jsx(O,{id:"confirm-delete",value:$,onChange:h=>M(h.target.value),placeholder:"DELETE",className:"uppercase"})]})]})]}),e.jsxs(me,{children:[e.jsx(he,{onClick:()=>M(""),children:t("common.cancel")}),e.jsx(J,{onClick:ft,disabled:$.toLowerCase()!=="delete"||te,className:"bg-destructive hover:bg-destructive/90",children:t(te?"common.loading":"profile.deleteAccount")})]})]})}),e.jsx(le,{open:je,onOpenChange:z,children:e.jsxs(ie,{className:"max-w-[90vw] sm:max-w-md",children:[e.jsxs(oe,{children:[e.jsx(ce,{children:t("profile.verifyOldEmail")}),e.jsx(de,{children:t("profile.oldEmailStep")})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{children:t("profile.currentEmail")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(O,{value:(n==null?void 0:n.email)||"",disabled:!0,className:"flex-1"}),e.jsx(D,{variant:"outline",size:"sm",onClick:pt,disabled:be,children:t(be?"profile.codeSent":"profile.sendCode")})]})]}),be&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{children:t("profile.verificationCode")}),e.jsx(O,{ref:ds,value:A,onChange:h=>B(h.target.value),placeholder:t("profile.enterCode"),maxLength:4})]})]}),e.jsxs(me,{children:[e.jsx(he,{onClick:()=>{z(!1),setTimeout(()=>{B(""),Le(!1)},300)},children:t("common.cancel")}),be&&e.jsx(J,{onClick:gt,children:t("profile.verify")})]})]})}),e.jsx(le,{open:H,onOpenChange:Y,children:e.jsxs(ie,{className:"max-w-[90vw] sm:max-w-md",children:[e.jsxs(oe,{className:"text-center space-y-3",children:[e.jsx(ce,{className:"text-xl",children:t("profile.verifyNewEmail")}),e.jsx(de,{className:"text-center",children:t("profile.newEmailStep")})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{className:"text-sm font-normal",children:t("profile.newEmail")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(O,{type:"email",value:g,onChange:h=>_(h.target.value),placeholder:t("profile.enterNewEmail"),disabled:ve,className:"border-2 focus:border-primary flex-1"}),e.jsx(D,{variant:"outline",size:"sm",onClick:jt,disabled:!g||ve,className:"text-xs whitespace-nowrap px-3",children:t(ve?"profile.codeSent":"profile.sendCode")})]})]}),ve&&e.jsxs("div",{className:"space-y-2 animate-in fade-in slide-in-from-top-2 duration-300",children:[e.jsx(k,{className:"text-sm font-normal",children:t("profile.verificationCode")}),e.jsx(O,{ref:ms,value:fe,onChange:h=>_e(h.target.value),placeholder:t("profile.enterCode"),maxLength:4,className:"border-2 focus:border-primary"})]})]}),e.jsxs(me,{className:"flex-col sm:flex-col gap-2",children:[ve&&e.jsx(J,{onClick:vt,disabled:!fe||fe.length!==4,className:"w-full bg-primary hover:bg-primary/90",children:"ç¡®è®¤éªŒè¯ç "}),e.jsx(he,{onClick:()=>{Y(!1),setTimeout(()=>{_(""),_e(""),$e(!1)},300)},className:"w-full mt-0",children:"å–æ¶ˆ"})]})]})}),e.jsx(le,{open:X,onOpenChange:W,children:e.jsxs(ie,{className:"max-w-[90vw] sm:max-w-md",children:[e.jsxs(oe,{children:[e.jsx(ce,{children:"ç¡®è®¤ä¿®æ”¹é‚®ç®±"}),e.jsx(de,{children:"æ­¥éª¤ 3/3: æ‰€æœ‰éªŒè¯å·²å®Œæˆ"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"rounded-lg bg-green-50 dark:bg-green-950 p-4 text-sm",children:[e.jsx("p",{className:"font-medium text-green-900 dark:text-green-100",children:"éªŒè¯å®Œæˆï¼"}),e.jsx("p",{className:"text-green-700 dark:text-green-300 mt-1",children:'æ—§é‚®ç®±å’Œæ–°é‚®ç®±éƒ½å·²éªŒè¯æˆåŠŸï¼Œç‚¹å‡»"ç¡®è®¤ä¿®æ”¹"å®Œæˆé‚®ç®±æ›´æ–°ã€‚'})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"å½“å‰é‚®ç®±:"}),e.jsx("span",{className:"font-medium",children:n==null?void 0:n.email})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"æ–°é‚®ç®±:"}),e.jsx("span",{className:"font-medium",children:g})]})]})]}),e.jsxs(me,{children:[e.jsx(he,{onClick:()=>{W(!1),setTimeout(()=>{B(""),_(""),_e(""),Le(!1),$e(!1)},300)},children:"å–æ¶ˆ"}),e.jsx(J,{onClick:yt,disabled:ks,children:ks?"æ›´æ–°ä¸­...":"ç¡®è®¤ä¿®æ”¹"})]})]})}),e.jsx(le,{open:mt,onOpenChange:Pe,children:e.jsxs(ie,{className:"max-w-[90vw] sm:max-w-md",children:[e.jsxs(oe,{children:[e.jsx(ce,{children:t("profile.verifyOldPassword")}),e.jsx(de,{children:t("profile.oldPasswordStep")})]}),e.jsx("div",{className:"space-y-4 py-4",children:Rs?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{children:t("profile.currentEmail")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(O,{value:(n==null?void 0:n.email)||"",disabled:!0,className:"flex-1"}),e.jsx(D,{variant:"outline",size:"sm",onClick:Ct,disabled:Ee,children:t(Ee?"profile.codeSent":"profile.sendCode")})]})]}),Ee&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{children:t("profile.verificationCode")}),e.jsx(O,{ref:hs,value:ls,onChange:h=>is(h.target.value),placeholder:t("profile.enterCode"),maxLength:4})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{children:t("profile.currentPassword")}),e.jsx(O,{type:"password",value:ss,onChange:h=>ts(h.target.value),placeholder:t("profile.enterCurrentPassword")})]}),e.jsxs(D,{variant:"link",size:"sm",onClick:()=>ns(!0),className:"text-xs p-0 h-auto",children:[t("profile.forgotPassword")," ",t("profile.useEmailVerification")]})]})}),e.jsxs(me,{children:[e.jsx(he,{onClick:()=>{Pe(!1),setTimeout(()=>{ts(""),ns(!1),is(""),os(!1)},300)},children:t("common.cancel")}),Rs?Ee&&e.jsx(J,{onClick:_t,children:t("profile.verify")}):e.jsx(J,{onClick:wt,children:t("profile.verify")})]})]})}),e.jsx(le,{open:ht,onOpenChange:Me,children:e.jsxs(ie,{className:"max-w-[90vw] sm:max-w-md",children:[e.jsxs(oe,{children:[e.jsx(ce,{children:t("profile.setNewPassword")}),e.jsx(de,{children:t("profile.newPasswordStep")})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{children:t("profile.newPassword")}),e.jsx(O,{type:"password",value:ae,onChange:h=>{as(h.target.value),h.target.value?cs(Nt(h.target.value)):cs(null)},placeholder:t("profile.enterNewPassword")}),Z&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:`h-1.5 flex-1 rounded-full transition-colors ${Z==="weak"?"bg-destructive":Z==="medium"?"bg-warning":"bg-success"}`}),e.jsx("div",{className:`h-1.5 flex-1 rounded-full transition-colors ${Z==="medium"||Z==="strong"?Z==="medium"?"bg-warning":"bg-success":"bg-muted"}`}),e.jsx("div",{className:`h-1.5 flex-1 rounded-full transition-colors ${Z==="strong"?"bg-success":"bg-muted"}`})]}),e.jsx("p",{className:`text-xs ${Z==="weak"?"text-destructive":Z==="medium"?"text-warning":"text-success"}`,children:t(`auth.passwordStrength.${Z}`)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{children:t("profile.confirmNewPassword")}),e.jsx(O,{type:"password",value:ye,onChange:h=>rs(h.target.value),placeholder:t("profile.confirmNewPasswordPlaceholder")})]}),ae&&ye&&ae!==ye&&e.jsx("p",{className:"text-sm text-destructive",children:t("profile.passwordsDontMatch")})]}),e.jsxs(me,{children:[e.jsx(he,{onClick:()=>{Me(!1),setTimeout(()=>{as(""),rs(""),cs(null)},300)},children:t("common.cancel")}),e.jsx(J,{onClick:bt,disabled:!ae||!ye||ae!==ye||Os,children:t(Os?"common.loading":"profile.updatePassword")})]})]})})]})},ta=()=>{const{user:s}=se();return Xe({queryKey:["user-addresses",s==null?void 0:s.id],queryFn:async()=>{if(!s)return[];const{data:t,error:i}=await P.from("user_addresses").select("*").eq("user_id",s.id).order("is_default",{ascending:!1}).order("created_at",{ascending:!1});if(i)throw i;return t},enabled:!!s})},aa=()=>{const{user:s}=se(),{toast:t}=We(),i=Ze();return Je({mutationFn:async n=>{if(!s)throw new Error("User not authenticated");const{data:u,error:d}=await P.from("user_addresses").insert({user_id:s.id,label:n.label,street:n.street,district:n.district||null,city:n.city,postal_code:n.postal_code||null,country:n.country,phone:n.phone||null,phone_code:n.phone_code||"+351",is_default:n.is_default||!1}).select().single();if(d)throw d;return u},onSuccess:()=>{i.invalidateQueries({queryKey:["user-addresses"]}),t({title:"Success",description:"Address added successfully"})},onError:()=>{t({title:"Error",description:"Failed to add address",variant:"destructive"})}})},ra=()=>{const{user:s}=se(),{toast:t}=We(),i=Ze();return Je({mutationFn:async({id:n,address:u})=>{if(!s)throw new Error("User not authenticated");const{data:d,error:x}=await P.from("user_addresses").update({label:u.label,street:u.street,district:u.district||null,city:u.city,postal_code:u.postal_code||null,country:u.country,phone:u.phone||null,phone_code:u.phone_code||"+351",is_default:u.is_default}).eq("id",n).eq("user_id",s.id).select().single();if(x)throw x;return d},onSuccess:()=>{i.invalidateQueries({queryKey:["user-addresses"]}),t({title:"Success",description:"Address updated successfully"})},onError:()=>{t({title:"Error",description:"Failed to update address",variant:"destructive"})}})},na=()=>{const{user:s}=se(),{toast:t}=We(),i=Ze();return Je({mutationFn:async n=>{if(!s)throw new Error("User not authenticated");const{error:u}=await P.from("user_addresses").delete().eq("id",n).eq("user_id",s.id);if(u)throw u},onSuccess:()=>{i.invalidateQueries({queryKey:["user-addresses"]}),t({title:"Success",description:"Address deleted successfully"})},onError:()=>{t({title:"Error",description:"Failed to delete address",variant:"destructive"})}})},la=()=>{const{user:s}=se(),{toast:t}=We(),i=Ze();return Je({mutationFn:async n=>{if(!s)throw new Error("User not authenticated");const{data:u,error:d}=await P.from("user_addresses").update({is_default:!0}).eq("id",n).eq("user_id",s.id).select().single();if(d)throw d;return u},onSuccess:()=>{i.invalidateQueries({queryKey:["user-addresses"]}),t({title:"Success",description:"Default address updated"})},onError:()=>{t({title:"Error",description:"Failed to set default address",variant:"destructive"})}})},Cs=[{value:"Home",icon:Xt,labelKey:"address.labelHome"},{value:"Work",icon:Vt,labelKey:"address.labelWork"},{value:"Office",icon:Kt,labelKey:"address.labelOffice"},{value:"Other",icon:Re,labelKey:"address.labelOther"}],ia=[{code:"+351",country:"Portugal",flag:"ðŸ‡µðŸ‡¹"},{code:"+34",country:"Spain",flag:"ðŸ‡ªðŸ‡¸"},{code:"+33",country:"France",flag:"ðŸ‡«ðŸ‡·"},{code:"+49",country:"Germany",flag:"ðŸ‡©ðŸ‡ª"},{code:"+39",country:"Italy",flag:"ðŸ‡®ðŸ‡¹"},{code:"+44",country:"UK",flag:"ðŸ‡¬ðŸ‡§"},{code:"+31",country:"Netherlands",flag:"ðŸ‡³ðŸ‡±"},{code:"+32",country:"Belgium",flag:"ðŸ‡§ðŸ‡ª"},{code:"+86",country:"China",flag:"ðŸ‡¨ðŸ‡³"},{code:"+1",country:"USA/Canada",flag:"ðŸ‡ºðŸ‡¸"},{code:"+55",country:"Brazil",flag:"ðŸ‡§ðŸ‡·"}],oa=["Portugal","Spain","France","Germany","Italy","United Kingdom","Netherlands","Belgium","China","Other"],Bs=({initialData:s,onSubmit:t,onCancel:i,isLoading:n,isEdit:u})=>{const{t:d}=Ce(),[x,o]=j.useState({label:(s==null?void 0:s.label)||"Home",street:(s==null?void 0:s.street)||"",district:(s==null?void 0:s.district)||"",city:(s==null?void 0:s.city)||"",postal_code:(s==null?void 0:s.postal_code)||"",country:(s==null?void 0:s.country)||"Portugal",phone:(s==null?void 0:s.phone)||"",phone_code:(s==null?void 0:s.phone_code)||"+351",is_default:(s==null?void 0:s.is_default)||!1}),r=a=>{a.preventDefault(),t(x)};return e.jsxs("form",{onSubmit:r,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"label",children:d("address.label")}),e.jsxs(He,{value:x.label,onValueChange:a=>o({...x,label:a}),children:[e.jsx(Qe,{children:e.jsx(qe,{placeholder:d("address.selectLabel")})}),e.jsx(Ve,{children:Cs.map(a=>e.jsx(Ke,{value:a.value,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(a.icon,{className:"w-4 h-4"}),d(a.labelKey)]})},a.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(k,{htmlFor:"street",children:[d("address.street")," *"]}),e.jsx(O,{id:"street",value:x.street,onChange:a=>o({...x,street:a.target.value}),placeholder:d("address.streetPlaceholder"),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"district",children:d("address.district")}),e.jsx(O,{id:"district",value:x.district,onChange:a=>o({...x,district:a.target.value}),placeholder:d("address.districtPlaceholder")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(k,{htmlFor:"city",children:[d("address.city")," *"]}),e.jsx(O,{id:"city",value:x.city,onChange:a=>o({...x,city:a.target.value}),placeholder:d("address.cityPlaceholder"),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(k,{htmlFor:"postal_code",children:[d("address.postalCode")," *"]}),e.jsx(O,{id:"postal_code",value:x.postal_code,onChange:a=>o({...x,postal_code:a.target.value}),placeholder:d("address.postalCodePlaceholder"),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(k,{htmlFor:"country",children:[d("address.country")," *"]}),e.jsxs(He,{value:x.country,onValueChange:a=>o({...x,country:a}),children:[e.jsx(Qe,{children:e.jsx(qe,{placeholder:d("address.selectCountry")})}),e.jsx(Ve,{children:oa.map(a=>e.jsx(Ke,{value:a,children:a},a))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(k,{htmlFor:"phone",children:[d("address.phone")," *"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(He,{value:x.phone_code,onValueChange:a=>o({...x,phone_code:a}),children:[e.jsx(Qe,{className:"w-[130px]",children:e.jsx(qe,{placeholder:"+351"})}),e.jsx(Ve,{children:ia.map(a=>e.jsx(Ke,{value:a.code,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:a.flag}),e.jsx("span",{children:a.code})]})},a.code))})]}),e.jsx(O,{id:"phone",className:"flex-1",value:x.phone,onChange:a=>o({...x,phone:a.target.value}),placeholder:d("address.phonePlaceholder"),required:!0})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Qt,{id:"is_default",checked:x.is_default,onCheckedChange:a=>o({...x,is_default:a})}),e.jsx(k,{htmlFor:"is_default",className:"text-sm font-normal cursor-pointer",children:d("address.setAsDefault")})]}),e.jsxs(kt,{className:"gap-2 sm:gap-0",children:[e.jsx(D,{type:"button",variant:"outline",onClick:i,children:d("common.cancel")}),e.jsx(D,{type:"submit",disabled:n,children:d(n?"common.saving":u?"common.save":"address.add")})]})]})},ca=({address:s,onEdit:t,onDelete:i,onSetDefault:n,isDeleting:u,isSettingDefault:d,canDelete:x=!0})=>{const{t:o}=Ce(),r=Cs.find(l=>l.value===s.label)||Cs[3],a=r.icon;return e.jsx("div",{className:`p-4 border rounded-lg hover:shadow-medium transition-shadow relative ${s.is_default?"bg-primary/5 border-primary/20":""}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:`p-2 rounded-full ${s.is_default?"bg-primary/20":"bg-primary/10"}`,children:e.jsx(a,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-semibold text-foreground",children:o(r.labelKey)}),s.is_default&&e.jsxs(K,{variant:"secondary",className:"text-xs",children:[e.jsx(ws,{className:"w-3 h-3 mr-1 fill-current"}),o("address.default")]})]}),e.jsxs("p",{className:"text-sm text-foreground",children:[s.street,s.district&&`, ${s.district}`]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:[s.postal_code,s.city,s.country].filter(Boolean).join(", ")}),s.phone&&e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1 mt-1",children:[e.jsx(Rt,{className:"w-3 h-3"}),s.phone_code," ",s.phone]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[!s.is_default&&e.jsx(D,{variant:"ghost",size:"icon",onClick:()=>n(s.id),disabled:d,title:o("address.setAsDefault"),children:e.jsx(ws,{className:"w-4 h-4"})}),e.jsx(D,{variant:"ghost",size:"icon",onClick:()=>t(s),title:o("common.edit"),children:e.jsx(qt,{className:"w-4 h-4"})}),x&&e.jsxs(le,{children:[e.jsx(Ot,{asChild:!0,children:e.jsx(D,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive",title:o("common.delete"),children:e.jsx(Ws,{className:"w-4 h-4"})})}),e.jsxs(ie,{children:[e.jsxs(oe,{children:[e.jsx(ce,{children:o("address.deleteTitle")}),e.jsx(de,{children:o("address.deleteDescription")})]}),e.jsxs(me,{children:[e.jsx(he,{children:o("common.cancel")}),e.jsx(J,{onClick:()=>i(s.id),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",disabled:u,children:o(u?"common.deleting":"common.delete")})]})]})]})]})]})})},Hs=()=>{const{t:s}=Ce(),{data:t,isLoading:i}=ta(),{data:n}=Gs(),u=aa(),d=ra(),x=Vs(),o=na(),r=la(),[a,l]=j.useState(!1),[c,m]=j.useState(null),[p,f]=j.useState(null),[y,v]=j.useState(!1),F=!(n!=null&&n.phone),E=M=>{if(F&&M.phone){f(M),v(!0);return}u.mutate(M,{onSuccess:()=>l(!1)})},N=()=>{if(!p)return;const M=`${p.phone_code||"+351"} ${p.phone}`;x.mutate({phone:M}),u.mutate(p,{onSuccess:()=>{l(!1),f(null),v(!1)}})},S=()=>{f(null),v(!1)},R=M=>{c&&d.mutate({id:c.id,address:M},{onSuccess:()=>m(null)})},L=M=>{o.mutate(M)},G=M=>{r.mutate(M)};if(i)return e.jsxs(Q,{children:[e.jsx(pe,{children:e.jsxs(ge,{className:"flex items-center gap-2",children:[e.jsx(Re,{className:"w-5 h-5"}),s("address.myAddresses")]})}),e.jsx(q,{children:e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:s("common.loading")})})]});const $=t&&t.length>0;return e.jsxs(Q,{children:[e.jsx(pe,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3",children:[e.jsxs("div",{className:"space-y-1.5 min-w-0 flex-1",children:[e.jsxs(ge,{className:"flex items-center gap-2",children:[e.jsx(Re,{className:"w-5 h-5 flex-shrink-0"}),s("address.myAddresses")]}),e.jsx(Ne,{className:"text-xs text-primary",children:s("address.manageDescription")})]}),$&&e.jsxs(De,{open:a,onOpenChange:l,children:[e.jsx(Ks,{asChild:!0,children:e.jsxs(D,{size:"sm",className:"w-full sm:w-auto flex-shrink-0",children:[e.jsx(Ts,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"truncate",children:s("address.addNew")})]})}),e.jsxs(Fe,{className:"sm:max-w-[500px]",children:[e.jsxs(Te,{children:[e.jsx(Ue,{children:s("address.addNew")}),e.jsx(js,{children:s("address.addDescription")})]}),e.jsx(Bs,{onSubmit:E,onCancel:()=>l(!1),isLoading:u.isPending})]})]})]})}),e.jsx(q,{children:$?e.jsx("div",{className:"space-y-4",children:t.map(M=>e.jsx(ca,{address:M,onEdit:m,onDelete:L,onSetDefault:G,isDeleting:o.isPending,isSettingDefault:r.isPending,canDelete:t.length>1},M.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Re,{className:"w-12 h-12 mx-auto text-muted-foreground/50 mb-4"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:s("address.noAddresses")}),e.jsxs(D,{onClick:()=>l(!0),children:[e.jsx(Ts,{className:"w-4 h-4 mr-2"}),s("address.addFirst")]})]})}),e.jsx(De,{open:!!c,onOpenChange:()=>m(null),children:e.jsxs(Fe,{className:"sm:max-w-[500px]",children:[e.jsxs(Te,{children:[e.jsx(Ue,{children:s("address.editAddress")}),e.jsx(js,{children:s("address.editDescription")})]}),c&&e.jsx(Bs,{initialData:c,onSubmit:R,onCancel:()=>m(null),isLoading:d.isPending,isEdit:!0})]})}),e.jsx(le,{open:y,onOpenChange:v,children:e.jsxs(ie,{children:[e.jsxs(oe,{children:[e.jsx(ce,{children:s("address.phoneConfirmTitle")}),e.jsx(de,{children:s("address.phoneConfirmDescription")})]}),e.jsxs(me,{children:[e.jsx(he,{onClick:S,children:s("common.cancel")}),e.jsx(J,{onClick:N,disabled:u.isPending||x.isPending,children:u.isPending||x.isPending?s("common.saving"):s("common.confirm")})]})]})})]})};var da=Object.defineProperty,Ye=Object.getOwnPropertySymbols,Js=Object.prototype.hasOwnProperty,et=Object.prototype.propertyIsEnumerable,Qs=(s,t,i)=>t in s?da(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i,_s=(s,t)=>{for(var i in t||(t={}))Js.call(t,i)&&Qs(s,i,t[i]);if(Ye)for(var i of Ye(t))et.call(t,i)&&Qs(s,i,t[i]);return s},bs=(s,t)=>{var i={};for(var n in s)Js.call(s,n)&&t.indexOf(n)<0&&(i[n]=s[n]);if(s!=null&&Ye)for(var n of Ye(s))t.indexOf(n)<0&&et.call(s,n)&&(i[n]=s[n]);return i};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var we;(s=>{const t=class C{constructor(r,a,l,c){if(this.version=r,this.errorCorrectionLevel=a,this.modules=[],this.isFunction=[],r<C.MIN_VERSION||r>C.MAX_VERSION)throw new RangeError("Version value out of range");if(c<-1||c>7)throw new RangeError("Mask value out of range");this.size=r*4+17;let m=[];for(let f=0;f<this.size;f++)m.push(!1);for(let f=0;f<this.size;f++)this.modules.push(m.slice()),this.isFunction.push(m.slice());this.drawFunctionPatterns();const p=this.addEccAndInterleave(l);if(this.drawCodewords(p),c==-1){let f=1e9;for(let y=0;y<8;y++){this.applyMask(y),this.drawFormatBits(y);const v=this.getPenaltyScore();v<f&&(c=y,f=v),this.applyMask(y)}}u(0<=c&&c<=7),this.mask=c,this.applyMask(c),this.drawFormatBits(c),this.isFunction=[]}static encodeText(r,a){const l=s.QrSegment.makeSegments(r);return C.encodeSegments(l,a)}static encodeBinary(r,a){const l=s.QrSegment.makeBytes(r);return C.encodeSegments([l],a)}static encodeSegments(r,a,l=1,c=40,m=-1,p=!0){if(!(C.MIN_VERSION<=l&&l<=c&&c<=C.MAX_VERSION)||m<-1||m>7)throw new RangeError("Invalid value");let f,y;for(f=l;;f++){const N=C.getNumDataCodewords(f,a)*8,S=x.getTotalBits(r,f);if(S<=N){y=S;break}if(f>=c)throw new RangeError("Data too long")}for(const N of[C.Ecc.MEDIUM,C.Ecc.QUARTILE,C.Ecc.HIGH])p&&y<=C.getNumDataCodewords(f,N)*8&&(a=N);let v=[];for(const N of r){i(N.mode.modeBits,4,v),i(N.numChars,N.mode.numCharCountBits(f),v);for(const S of N.getData())v.push(S)}u(v.length==y);const F=C.getNumDataCodewords(f,a)*8;u(v.length<=F),i(0,Math.min(4,F-v.length),v),i(0,(8-v.length%8)%8,v),u(v.length%8==0);for(let N=236;v.length<F;N^=253)i(N,8,v);let E=[];for(;E.length*8<v.length;)E.push(0);return v.forEach((N,S)=>E[S>>>3]|=N<<7-(S&7)),new C(f,a,E,m)}getModule(r,a){return 0<=r&&r<this.size&&0<=a&&a<this.size&&this.modules[a][r]}getModules(){return this.modules}drawFunctionPatterns(){for(let l=0;l<this.size;l++)this.setFunctionModule(6,l,l%2==0),this.setFunctionModule(l,6,l%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const r=this.getAlignmentPatternPositions(),a=r.length;for(let l=0;l<a;l++)for(let c=0;c<a;c++)l==0&&c==0||l==0&&c==a-1||l==a-1&&c==0||this.drawAlignmentPattern(r[l],r[c]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(r){const a=this.errorCorrectionLevel.formatBits<<3|r;let l=a;for(let m=0;m<10;m++)l=l<<1^(l>>>9)*1335;const c=(a<<10|l)^21522;u(c>>>15==0);for(let m=0;m<=5;m++)this.setFunctionModule(8,m,n(c,m));this.setFunctionModule(8,7,n(c,6)),this.setFunctionModule(8,8,n(c,7)),this.setFunctionModule(7,8,n(c,8));for(let m=9;m<15;m++)this.setFunctionModule(14-m,8,n(c,m));for(let m=0;m<8;m++)this.setFunctionModule(this.size-1-m,8,n(c,m));for(let m=8;m<15;m++)this.setFunctionModule(8,this.size-15+m,n(c,m));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let r=this.version;for(let l=0;l<12;l++)r=r<<1^(r>>>11)*7973;const a=this.version<<12|r;u(a>>>18==0);for(let l=0;l<18;l++){const c=n(a,l),m=this.size-11+l%3,p=Math.floor(l/3);this.setFunctionModule(m,p,c),this.setFunctionModule(p,m,c)}}drawFinderPattern(r,a){for(let l=-4;l<=4;l++)for(let c=-4;c<=4;c++){const m=Math.max(Math.abs(c),Math.abs(l)),p=r+c,f=a+l;0<=p&&p<this.size&&0<=f&&f<this.size&&this.setFunctionModule(p,f,m!=2&&m!=4)}}drawAlignmentPattern(r,a){for(let l=-2;l<=2;l++)for(let c=-2;c<=2;c++)this.setFunctionModule(r+c,a+l,Math.max(Math.abs(c),Math.abs(l))!=1)}setFunctionModule(r,a,l){this.modules[a][r]=l,this.isFunction[a][r]=!0}addEccAndInterleave(r){const a=this.version,l=this.errorCorrectionLevel;if(r.length!=C.getNumDataCodewords(a,l))throw new RangeError("Invalid argument");const c=C.NUM_ERROR_CORRECTION_BLOCKS[l.ordinal][a],m=C.ECC_CODEWORDS_PER_BLOCK[l.ordinal][a],p=Math.floor(C.getNumRawDataModules(a)/8),f=c-p%c,y=Math.floor(p/c);let v=[];const F=C.reedSolomonComputeDivisor(m);for(let N=0,S=0;N<c;N++){let R=r.slice(S,S+y-m+(N<f?0:1));S+=R.length;const L=C.reedSolomonComputeRemainder(R,F);N<f&&R.push(0),v.push(R.concat(L))}let E=[];for(let N=0;N<v[0].length;N++)v.forEach((S,R)=>{(N!=y-m||R>=f)&&E.push(S[N])});return u(E.length==p),E}drawCodewords(r){if(r.length!=Math.floor(C.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let a=0;for(let l=this.size-1;l>=1;l-=2){l==6&&(l=5);for(let c=0;c<this.size;c++)for(let m=0;m<2;m++){const p=l-m,y=(l+1&2)==0?this.size-1-c:c;!this.isFunction[y][p]&&a<r.length*8&&(this.modules[y][p]=n(r[a>>>3],7-(a&7)),a++)}}u(a==r.length*8)}applyMask(r){if(r<0||r>7)throw new RangeError("Mask value out of range");for(let a=0;a<this.size;a++)for(let l=0;l<this.size;l++){let c;switch(r){case 0:c=(l+a)%2==0;break;case 1:c=a%2==0;break;case 2:c=l%3==0;break;case 3:c=(l+a)%3==0;break;case 4:c=(Math.floor(l/3)+Math.floor(a/2))%2==0;break;case 5:c=l*a%2+l*a%3==0;break;case 6:c=(l*a%2+l*a%3)%2==0;break;case 7:c=((l+a)%2+l*a%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[a][l]&&c&&(this.modules[a][l]=!this.modules[a][l])}}getPenaltyScore(){let r=0;for(let m=0;m<this.size;m++){let p=!1,f=0,y=[0,0,0,0,0,0,0];for(let v=0;v<this.size;v++)this.modules[m][v]==p?(f++,f==5?r+=C.PENALTY_N1:f>5&&r++):(this.finderPenaltyAddHistory(f,y),p||(r+=this.finderPenaltyCountPatterns(y)*C.PENALTY_N3),p=this.modules[m][v],f=1);r+=this.finderPenaltyTerminateAndCount(p,f,y)*C.PENALTY_N3}for(let m=0;m<this.size;m++){let p=!1,f=0,y=[0,0,0,0,0,0,0];for(let v=0;v<this.size;v++)this.modules[v][m]==p?(f++,f==5?r+=C.PENALTY_N1:f>5&&r++):(this.finderPenaltyAddHistory(f,y),p||(r+=this.finderPenaltyCountPatterns(y)*C.PENALTY_N3),p=this.modules[v][m],f=1);r+=this.finderPenaltyTerminateAndCount(p,f,y)*C.PENALTY_N3}for(let m=0;m<this.size-1;m++)for(let p=0;p<this.size-1;p++){const f=this.modules[m][p];f==this.modules[m][p+1]&&f==this.modules[m+1][p]&&f==this.modules[m+1][p+1]&&(r+=C.PENALTY_N2)}let a=0;for(const m of this.modules)a=m.reduce((p,f)=>p+(f?1:0),a);const l=this.size*this.size,c=Math.ceil(Math.abs(a*20-l*10)/l)-1;return u(0<=c&&c<=9),r+=c*C.PENALTY_N4,u(0<=r&&r<=2568888),r}getAlignmentPatternPositions(){if(this.version==1)return[];{const r=Math.floor(this.version/7)+2,a=this.version==32?26:Math.ceil((this.version*4+4)/(r*2-2))*2;let l=[6];for(let c=this.size-7;l.length<r;c-=a)l.splice(1,0,c);return l}}static getNumRawDataModules(r){if(r<C.MIN_VERSION||r>C.MAX_VERSION)throw new RangeError("Version number out of range");let a=(16*r+128)*r+64;if(r>=2){const l=Math.floor(r/7)+2;a-=(25*l-10)*l-55,r>=7&&(a-=36)}return u(208<=a&&a<=29648),a}static getNumDataCodewords(r,a){return Math.floor(C.getNumRawDataModules(r)/8)-C.ECC_CODEWORDS_PER_BLOCK[a.ordinal][r]*C.NUM_ERROR_CORRECTION_BLOCKS[a.ordinal][r]}static reedSolomonComputeDivisor(r){if(r<1||r>255)throw new RangeError("Degree out of range");let a=[];for(let c=0;c<r-1;c++)a.push(0);a.push(1);let l=1;for(let c=0;c<r;c++){for(let m=0;m<a.length;m++)a[m]=C.reedSolomonMultiply(a[m],l),m+1<a.length&&(a[m]^=a[m+1]);l=C.reedSolomonMultiply(l,2)}return a}static reedSolomonComputeRemainder(r,a){let l=a.map(c=>0);for(const c of r){const m=c^l.shift();l.push(0),a.forEach((p,f)=>l[f]^=C.reedSolomonMultiply(p,m))}return l}static reedSolomonMultiply(r,a){if(r>>>8||a>>>8)throw new RangeError("Byte out of range");let l=0;for(let c=7;c>=0;c--)l=l<<1^(l>>>7)*285,l^=(a>>>c&1)*r;return u(l>>>8==0),l}finderPenaltyCountPatterns(r){const a=r[1];u(a<=this.size*3);const l=a>0&&r[2]==a&&r[3]==a*3&&r[4]==a&&r[5]==a;return(l&&r[0]>=a*4&&r[6]>=a?1:0)+(l&&r[6]>=a*4&&r[0]>=a?1:0)}finderPenaltyTerminateAndCount(r,a,l){return r&&(this.finderPenaltyAddHistory(a,l),a=0),a+=this.size,this.finderPenaltyAddHistory(a,l),this.finderPenaltyCountPatterns(l)}finderPenaltyAddHistory(r,a){a[0]==0&&(r+=this.size),a.pop(),a.unshift(r)}};t.MIN_VERSION=1,t.MAX_VERSION=40,t.PENALTY_N1=3,t.PENALTY_N2=3,t.PENALTY_N3=40,t.PENALTY_N4=10,t.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],t.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],s.QrCode=t;function i(o,r,a){if(r<0||r>31||o>>>r)throw new RangeError("Value out of range");for(let l=r-1;l>=0;l--)a.push(o>>>l&1)}function n(o,r){return(o>>>r&1)!=0}function u(o){if(!o)throw new Error("Assertion error")}const d=class I{constructor(r,a,l){if(this.mode=r,this.numChars=a,this.bitData=l,a<0)throw new RangeError("Invalid argument");this.bitData=l.slice()}static makeBytes(r){let a=[];for(const l of r)i(l,8,a);return new I(I.Mode.BYTE,r.length,a)}static makeNumeric(r){if(!I.isNumeric(r))throw new RangeError("String contains non-numeric characters");let a=[];for(let l=0;l<r.length;){const c=Math.min(r.length-l,3);i(parseInt(r.substring(l,l+c),10),c*3+1,a),l+=c}return new I(I.Mode.NUMERIC,r.length,a)}static makeAlphanumeric(r){if(!I.isAlphanumeric(r))throw new RangeError("String contains unencodable characters in alphanumeric mode");let a=[],l;for(l=0;l+2<=r.length;l+=2){let c=I.ALPHANUMERIC_CHARSET.indexOf(r.charAt(l))*45;c+=I.ALPHANUMERIC_CHARSET.indexOf(r.charAt(l+1)),i(c,11,a)}return l<r.length&&i(I.ALPHANUMERIC_CHARSET.indexOf(r.charAt(l)),6,a),new I(I.Mode.ALPHANUMERIC,r.length,a)}static makeSegments(r){return r==""?[]:I.isNumeric(r)?[I.makeNumeric(r)]:I.isAlphanumeric(r)?[I.makeAlphanumeric(r)]:[I.makeBytes(I.toUtf8ByteArray(r))]}static makeEci(r){let a=[];if(r<0)throw new RangeError("ECI assignment value out of range");if(r<128)i(r,8,a);else if(r<16384)i(2,2,a),i(r,14,a);else if(r<1e6)i(6,3,a),i(r,21,a);else throw new RangeError("ECI assignment value out of range");return new I(I.Mode.ECI,0,a)}static isNumeric(r){return I.NUMERIC_REGEX.test(r)}static isAlphanumeric(r){return I.ALPHANUMERIC_REGEX.test(r)}getData(){return this.bitData.slice()}static getTotalBits(r,a){let l=0;for(const c of r){const m=c.mode.numCharCountBits(a);if(c.numChars>=1<<m)return 1/0;l+=4+m+c.bitData.length}return l}static toUtf8ByteArray(r){r=encodeURI(r);let a=[];for(let l=0;l<r.length;l++)r.charAt(l)!="%"?a.push(r.charCodeAt(l)):(a.push(parseInt(r.substring(l+1,l+3),16)),l+=2);return a}};d.NUMERIC_REGEX=/^[0-9]*$/,d.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,d.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let x=d;s.QrSegment=d})(we||(we={}));(s=>{(t=>{const i=class{constructor(u,d){this.ordinal=u,this.formatBits=d}};i.LOW=new i(0,1),i.MEDIUM=new i(1,0),i.QUARTILE=new i(2,3),i.HIGH=new i(3,2),t.Ecc=i})(s.QrCode||(s.QrCode={}))})(we||(we={}));(s=>{(t=>{const i=class{constructor(u,d){this.modeBits=u,this.numBitsCharCount=d}numCharCountBits(u){return this.numBitsCharCount[Math.floor((u+7)/17)]}};i.NUMERIC=new i(1,[10,12,14]),i.ALPHANUMERIC=new i(2,[9,11,13]),i.BYTE=new i(4,[8,16,16]),i.KANJI=new i(8,[8,10,12]),i.ECI=new i(7,[0,0,0]),t.Mode=i})(s.QrSegment||(s.QrSegment={}))})(we||(we={}));var Ae=we;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var ma={L:Ae.QrCode.Ecc.LOW,M:Ae.QrCode.Ecc.MEDIUM,Q:Ae.QrCode.Ecc.QUARTILE,H:Ae.QrCode.Ecc.HIGH},st=128,tt="L",at="#FFFFFF",rt="#000000",nt=!1,lt=1,ha=4,ua=0,xa=.1;function it(s,t=0){const i=[];return s.forEach(function(n,u){let d=null;n.forEach(function(x,o){if(!x&&d!==null){i.push(`M${d+t} ${u+t}h${o-d}v1H${d+t}z`),d=null;return}if(o===n.length-1){if(!x)return;d===null?i.push(`M${o+t},${u+t} h1v1H${o+t}z`):i.push(`M${d+t},${u+t} h${o+1-d}v1H${d+t}z`);return}x&&d===null&&(d=o)})}),i.join("")}function ot(s,t){return s.slice().map((i,n)=>n<t.y||n>=t.y+t.h?i:i.map((u,d)=>d<t.x||d>=t.x+t.w?u:!1))}function fa(s,t,i,n){if(n==null)return null;const u=s.length+i*2,d=Math.floor(t*xa),x=u/t,o=(n.width||d)*x,r=(n.height||d)*x,a=n.x==null?s.length/2-o/2:n.x*x,l=n.y==null?s.length/2-r/2:n.y*x,c=n.opacity==null?1:n.opacity;let m=null;if(n.excavate){let f=Math.floor(a),y=Math.floor(l),v=Math.ceil(o+a-f),F=Math.ceil(r+l-y);m={x:f,y,w:v,h:F}}const p=n.crossOrigin;return{x:a,y:l,h:r,w:o,excavation:m,opacity:c,crossOrigin:p}}function pa(s,t){return t!=null?Math.max(Math.floor(t),0):s?ha:ua}function ct({value:s,level:t,minVersion:i,includeMargin:n,marginSize:u,imageSettings:d,size:x,boostLevel:o}){let r=T.useMemo(()=>{const f=(Array.isArray(s)?s:[s]).reduce((y,v)=>(y.push(...Ae.QrSegment.makeSegments(v)),y),[]);return Ae.QrCode.encodeSegments(f,ma[t],i,void 0,void 0,o)},[s,t,i,o]);const{cells:a,margin:l,numCells:c,calculatedImageSettings:m}=T.useMemo(()=>{let p=r.getModules();const f=pa(n,u),y=p.length+f*2,v=fa(p,x,f,d);return{cells:p,margin:f,numCells:y,calculatedImageSettings:v}},[r,x,d,n,u]);return{qrcode:r,margin:l,cells:a,numCells:c,calculatedImageSettings:m}}var ga=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),ja=T.forwardRef(function(t,i){const n=t,{value:u,size:d=st,level:x=tt,bgColor:o=at,fgColor:r=rt,includeMargin:a=nt,minVersion:l=lt,boostLevel:c,marginSize:m,imageSettings:p}=n,y=bs(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:v}=y,F=bs(y,["style"]),E=p==null?void 0:p.src,N=T.useRef(null),S=T.useRef(null),R=T.useCallback(z=>{N.current=z,typeof i=="function"?i(z):i&&(i.current=z)},[i]),[L,G]=T.useState(!1),{margin:$,cells:M,numCells:te,calculatedImageSettings:U}=ct({value:u,level:x,minVersion:l,boostLevel:c,includeMargin:a,marginSize:m,imageSettings:p,size:d});T.useEffect(()=>{if(N.current!=null){const z=N.current,H=z.getContext("2d");if(!H)return;let Y=M;const X=S.current,W=U!=null&&X!==null&&X.complete&&X.naturalHeight!==0&&X.naturalWidth!==0;W&&U.excavation!=null&&(Y=ot(M,U.excavation));const g=window.devicePixelRatio||1;z.height=z.width=d*g;const _=d/te*g;H.scale(_,_),H.fillStyle=o,H.fillRect(0,0,te,te),H.fillStyle=r,ga?H.fill(new Path2D(it(Y,$))):M.forEach(function(A,B){A.forEach(function(fe,_e){fe&&H.fillRect(_e+$,B+$,1,1)})}),U&&(H.globalAlpha=U.opacity),W&&H.drawImage(X,U.x+$,U.y+$,U.w,U.h)}}),T.useEffect(()=>{G(!1)},[E]);const xe=_s({height:d,width:d},v);let je=null;return E!=null&&(je=T.createElement("img",{src:E,key:E,style:{display:"none"},onLoad:()=>{G(!0)},ref:S,crossOrigin:U==null?void 0:U.crossOrigin})),T.createElement(T.Fragment,null,T.createElement("canvas",_s({style:xe,height:d,width:d,ref:R,role:"img"},F)),je)});ja.displayName="QRCodeCanvas";var dt=T.forwardRef(function(t,i){const n=t,{value:u,size:d=st,level:x=tt,bgColor:o=at,fgColor:r=rt,includeMargin:a=nt,minVersion:l=lt,boostLevel:c,title:m,marginSize:p,imageSettings:f}=n,y=bs(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:v,cells:F,numCells:E,calculatedImageSettings:N}=ct({value:u,level:x,minVersion:l,boostLevel:c,includeMargin:a,marginSize:p,imageSettings:f,size:d});let S=F,R=null;f!=null&&N!=null&&(N.excavation!=null&&(S=ot(F,N.excavation)),R=T.createElement("image",{href:f.src,height:N.h,width:N.w,x:N.x+v,y:N.y+v,preserveAspectRatio:"none",opacity:N.opacity,crossOrigin:N.crossOrigin}));const L=it(S,v);return T.createElement("svg",_s({height:d,width:d,viewBox:`0 0 ${E} ${E}`,ref:i,role:"img"},y),!!m&&T.createElement("title",null,m),T.createElement("path",{fill:o,d:`M0,0 h${E}v${E}H0z`,shapeRendering:"crispEdges"}),T.createElement("path",{fill:r,d:L,shapeRendering:"crispEdges"}),R)});dt.displayName="QRCodeSVG";const va=({open:s,onOpenChange:t,coupon:i})=>{var l,c;const{t:n}=Ce(),{getLocalizedField:u}=Xs(),[d,x]=j.useState(!1),o=(l=i.coupon_codes)==null?void 0:l.coupon_templates,r=(c=i.coupon_codes)==null?void 0:c.code,a=!!i.used_at;return e.jsx(De,{open:s,onOpenChange:m=>{t(m),m||x(!1)},children:e.jsxs(Fe,{className:"max-w-lg max-h-[90vh]",children:[e.jsx(Te,{children:e.jsxs(Ue,{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"w-5 h-5 text-primary"}),n("profile.coupons.details")]})}),e.jsx(Dt,{className:"max-h-[70vh] pr-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-foreground",children:u(o,"title")}),e.jsx(K,{variant:a?"secondary":"default",children:n(a?"profile.coupons.used":"profile.coupons.available")})]}),o!=null&&o.description_zh||o!=null&&o.description_en||o!=null&&o.description_pt?e.jsx("p",{className:"text-muted-foreground text-sm",children:u(o,"description")}):null]}),e.jsx(Ls,{}),e.jsx("div",{className:"bg-secondary/30 p-4 rounded-lg cursor-pointer hover:bg-secondary/50 transition-colors",onClick:()=>x(!d),children:e.jsx("div",{className:"flex flex-col items-center gap-3",children:d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white p-3 rounded-lg",children:e.jsx(dt,{value:r||"",size:140,level:"M",includeMargin:!1})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:n("profile.coupons.tapToHideQr")})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-2xl font-mono font-bold tracking-wider",children:r}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Wt,{className:"w-4 h-4"}),e.jsx("p",{className:"text-xs",children:n("profile.coupons.tapToShowQr")})]})]})})}),e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-primary/10 rounded-lg",children:[e.jsx(Be,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:n("profile.coupons.discount")}),e.jsx("p",{className:"text-xl font-bold text-primary",children:(o==null?void 0:o.discount_type)==="percentage"?`${o==null?void 0:o.discount_value}% OFF`:`â‚¬${o==null?void 0:o.discount_value}`})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Gt,{className:"w-5 h-5 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:n("profile.coupons.claimedAt")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:Se(new Date(i.claimed_at),"yyyy-MM-dd HH:mm")})]})]}),a&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ue,{className:"w-5 h-5 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:n("profile.coupons.usedOn")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:Se(new Date(i.used_at),"yyyy-MM-dd HH:mm")})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ue,{className:"w-5 h-5 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:n("profile.coupons.validity")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:o!=null&&o.valid_until?`${Se(new Date(o.valid_from),"yyyy-MM-dd")} - ${Se(new Date(o.valid_until),"yyyy-MM-dd")}`:n("profile.coupons.noExpiry")})]})]}),(o==null?void 0:o.min_order_amount)&&o.min_order_amount>0&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Be,{className:"w-5 h-5 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:n("profile.coupons.minOrder")}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["â‚¬",o.min_order_amount]})]})]}),(o==null?void 0:o.max_discount_amount)&&o.max_discount_amount>0&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Be,{className:"w-5 h-5 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:n("profile.coupons.maxDiscount")}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["â‚¬",o.max_discount_amount]})]})]}),e.jsx(Ls,{}),i.activity_id&&i.source==="share"&&e.jsxs(ee,{to:`/activity/${i.activity_id}`,className:"flex items-center justify-center gap-2 p-3 rounded-lg border hover:shadow-md transition-all hover:border-primary",children:[e.jsx(Be,{className:"w-4 h-4 text-primary"}),e.jsxs("span",{className:"text-sm font-medium text-foreground",children:[n("profile.coupons.source"),": ",n("profile.coupons.fromSharing")]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",n("profile.coupons.viewActivity"),")"]})]})]})})]})})},Es=j.memo(({comment:s,getLocalizedField:t})=>e.jsxs(ee,{to:`/${s.target_type}/${s.target_id}`,className:"block p-3 md:p-4 rounded-lg border hover:shadow-medium transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2 gap-2",children:[e.jsx("h3",{className:"font-semibold text-card-foreground text-sm md:text-base line-clamp-1 flex-1",children:t(s,"target_name")}),e.jsx("span",{className:"text-xs md:text-sm text-muted-foreground whitespace-nowrap",children:Ys(new Date(s.created_at),{addSuffix:!0})})]}),e.jsx("p",{className:"text-muted-foreground line-clamp-2 text-sm md:text-base",children:s.content}),s.image_url&&e.jsx("img",{src:s.image_url,alt:"Comment",className:"mt-2 rounded-lg max-w-full md:max-w-xs",loading:"lazy"})]}));Es.displayName="CommentItem";const Ss=j.memo(({restaurant:s,getLocalizedField:t,t:i})=>e.jsxs(ee,{to:`/restaurant/${s.id}`,className:"flex gap-3 md:gap-4 p-3 md:p-4 rounded-lg border hover:shadow-medium transition-shadow",children:[e.jsx("div",{className:"w-20 h-20 md:w-24 md:h-24 rounded-lg overflow-hidden bg-secondary/30 flex-shrink-0",children:e.jsx("img",{src:s.image_url||"https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=400&q=80",alt:String(t(s,"name")),className:"w-full h-full object-cover",loading:"lazy",onError:n=>{n.currentTarget.src="https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=400&q=80"}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-base md:text-lg text-card-foreground line-clamp-1",children:t(s,"name")}),e.jsx("p",{className:"text-muted-foreground text-sm mb-2 line-clamp-1",children:t(s,"type")}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ws,{className:`w-4 h-4 ${s.rating?"fill-accent text-accent":"text-muted-foreground"}`}),s.rating?e.jsx("span",{className:"font-medium",children:s.rating.toFixed(1)}):e.jsxs("span",{className:"text-xs text-muted-foreground text-center whitespace-nowrap",children:[i("restaurant.noRatingLine1"),e.jsx("br",{}),i("restaurant.noRatingLine2")]})]})]})]}));Ss.displayName="FavoriteRestaurantItem";const As=j.memo(({subscription:s,getLocalizedField:t,t:i,isMobile:n})=>{var x,o;const[u,d]=j.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx("div",{onClick:()=>d(!0),className:`block rounded-lg border hover:shadow-medium transition-shadow cursor-pointer ${n?"p-3":"p-4"}`,children:e.jsxs("div",{className:`flex items-start ${n?"gap-3":"gap-4"}`,children:[((x=s.activity)==null?void 0:x.image_url)&&e.jsx("img",{src:s.activity.image_url,alt:String(t(s.activity,"title")),className:`rounded-lg object-cover flex-shrink-0 ${n?"w-20 h-20":"w-24 h-24"}`,loading:"lazy"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:`font-semibold text-card-foreground mb-1 ${n?"text-sm":""}`,children:t(s.activity,"title")}),e.jsx("div",{className:`text-muted-foreground line-clamp-2 prose max-w-none ${n?"text-xs prose-xs":"text-sm prose-sm"}`,dangerouslySetInnerHTML:{__html:t(s.activity,"content")}}),e.jsxs("p",{className:"text-muted-foreground mt-2 text-xs",children:[i("profile.joinedOn"),":"," ",Ys(new Date(s.created_at),{addSuffix:!0})]})]}),e.jsx(Oe,{className:`text-primary fill-primary flex-shrink-0 ${n?"w-4 h-4":"w-5 h-5"}`})]})}),e.jsx(Zt,{open:u,onOpenChange:d,activity:{title:String(t(s.activity,"title")),image_url:(o=s.activity)==null?void 0:o.image_url,content:String(t(s.activity,"content"))}})]})});As.displayName="ActivitySubscriptionItem";const Ps=j.memo(({activityGroup:s,getLocalizedField:t,t:i,isMobile:n})=>{const u=s.activity,d=s.restaurants;return e.jsxs("div",{className:`rounded-lg border hover:shadow-medium transition-shadow ${n?"p-3":"p-4"}`,children:[e.jsx(ee,{to:`/activity/${u.id}`,className:n?"block mb-2":"block mb-3",children:e.jsxs("div",{className:`flex items-start ${n?"gap-3":"gap-4"}`,children:[u.image_url&&e.jsx("img",{src:u.image_url,alt:String(t(u,"title")),className:`rounded-lg object-cover flex-shrink-0 ${n?"w-20 h-20":"w-24 h-24"}`,loading:"lazy"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:`font-semibold text-card-foreground mb-1 ${n?"text-sm":""}`,children:t(u,"title")}),e.jsx("div",{className:`text-muted-foreground line-clamp-2 prose max-w-none mb-2 ${n?"text-xs prose-xs":"text-sm prose-sm"}`,dangerouslySetInnerHTML:{__html:t(u,"content")}}),e.jsxs("div",{className:"flex items-center gap-2 md:gap-4 text-xs text-muted-foreground flex-wrap",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ue,{className:"w-3 h-3"}),new Date(u.start_date).toLocaleDateString()]}),u.end_date&&e.jsxs("span",{children:["- ",new Date(u.end_date).toLocaleDateString()]})]})]})]})}),e.jsxs("div",{className:`pt-2 md:pt-3 border-t ${n?"mt-2":"mt-3"}`,children:[e.jsxs("div",{className:`flex items-center gap-2 ${n?"mb-1.5":"mb-2"}`,children:[e.jsx(ke,{className:`text-primary ${n?"w-3.5 h-3.5":"w-4 h-4"}`}),e.jsxs("span",{className:`font-medium text-foreground ${n?"text-xs":"text-sm"}`,children:[i("profile.participatingRestaurants")," (",d.length,")"]})]}),e.jsx("div",{className:`flex flex-wrap ${n?"gap-1.5":"gap-2"}`,children:d.map(x=>e.jsx(K,{variant:"secondary",className:n?"text-xs px-2 py-0.5":"text-xs",children:t(x,"name")},x.id))})]})]})});Ps.displayName="MerchantActivityItem";const Ms=j.memo(({coupon:s,getLocalizedField:t,t:i,isMobile:n})=>{var a,l;const[u,d]=j.useState(!1),x=(a=s.coupon_codes)==null?void 0:a.coupon_templates,o=(l=s.coupon_codes)==null?void 0:l.code,r=!!s.used_at;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`rounded-lg border transition-shadow cursor-pointer ${r?"bg-muted/30":"hover:shadow-medium"} ${n?"p-3":"p-4"}`,onClick:()=>d(!0),children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`font-semibold text-card-foreground mb-1 ${n?"text-sm":"text-base"}`,children:t(x,"title")}),e.jsx("p",{className:`text-muted-foreground line-clamp-2 ${n?"text-xs":"text-sm"}`,children:t(x,"description")})]}),e.jsx(K,{variant:r?"secondary":"default",className:n?"text-xs":"",children:i(r?"profile.coupons.used":"profile.coupons.available")})]}),e.jsxs("div",{className:`flex items-center gap-2 mb-2 ${n?"text-xs":"text-sm"}`,children:[e.jsx("span",{className:"font-mono bg-secondary/50 px-2 py-1 rounded",children:o}),e.jsx("span",{className:"text-muted-foreground",children:(x==null?void 0:x.discount_type)==="percentage"?`${x==null?void 0:x.discount_value}%`:`â‚¬${x==null?void 0:x.discount_value}`})]}),e.jsx("div",{className:`text-muted-foreground ${n?"text-xs":"text-sm"}`,children:r?e.jsxs("span",{children:[i("profile.coupons.usedOn"),": ",Se(new Date(s.used_at),"yyyy-MM-dd HH:mm")]}):x!=null&&x.valid_until?e.jsxs("span",{children:[i("profile.coupons.validUntil"),": ",Se(new Date(x.valid_until),"yyyy-MM-dd")]}):e.jsx("span",{children:i("profile.coupons.noExpiry")})})]}),e.jsx(va,{open:u,onOpenChange:d,coupon:s})]})});Ms.displayName="UserCouponItem";const Xa=()=>{var X,W;const{t:s}=Ce(),{user:t}=se(),i=Yt(),{data:n,isLoading:u}=Gs(),{data:d,isLoading:x}=Jt(),{data:o,isLoading:r}=ea(),{data:a,isLoading:l}=Ut(),{data:c,isLoading:m}=sa(),{data:p,isLoading:f}=$t(),{role:y,isMerchant:v,isSupervisor:F}=qs(),{getLocalizedField:E}=Xs(),N=v||F,[S,R]=j.useState("profile"),[L,G]=j.useState(),[$,M]=j.useState({}),[te,U]=j.useState(new Set(["profile"])),xe=N?[{value:"profile",label:s("profile.profile"),icon:Fs},{value:"favorites",label:s("profile.favorites"),icon:Oe},{value:"comments",label:s("profile.comments"),icon:Ie},{value:"activities",label:s("profile.participatedActivities"),icon:ue}]:[{value:"profile",label:s("profile.profile"),icon:Fs},{value:"favorites",label:s("profile.favorites"),icon:Oe},{value:"comments",label:s("profile.comments"),icon:Ie}],je=g=>{M(_=>({..._,[g]:window.scrollY}))},z=g=>{if(te.has(g)){const _=$[g]||0;setTimeout(()=>window.scrollTo(0,_),0)}else setTimeout(()=>window.scrollTo(0,0),0),U(_=>new Set([..._,g]))};j.useEffect(()=>{if(!L)return;const g=()=>{const _=L.selectedScrollSnap(),A=xe[_].value;A!==S&&(je(S),z(A),R(A))};return L.on("select",g),()=>{L.off("select",g)}},[L,S,$,te]);const H=g=>{if(g===S)return;je(S);const _=xe.findIndex(A=>A.value===g);_!==-1&&L&&L.scrollTo(_),z(g),R(g)};if(!t||u)return e.jsx("div",{className:"min-h-screen bg-secondary/20 py-8 px-4",children:e.jsx("div",{className:"container mx-auto max-w-6xl",children:e.jsx("div",{className:"text-center",children:s("common.loading")})})});const Y=s(y?`profile.role.${y}`:"profile.role.user");return e.jsx("div",{className:`min-h-screen bg-secondary/20 ${i?"pb-20 pt-4":"py-4 md:py-8 px-3 md:px-4"}`,children:e.jsxs("div",{className:`container mx-auto max-w-6xl ${i?"px-3":""}`,children:[!i&&e.jsx(e.Fragment,{children:e.jsx(Q,{className:"mb-6 md:mb-8",children:e.jsx(q,{className:"pt-4 md:pt-6 pb-4 md:pb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start gap-4 md:gap-6",children:[e.jsxs(vs,{className:"w-24 h-24",children:[e.jsx(ys,{src:(n==null?void 0:n.avatar_url)||""}),e.jsx(Ns,{className:"text-3xl",children:((X=n==null?void 0:n.display_name)==null?void 0:X.charAt(0).toUpperCase())||"U"})]}),e.jsxs("div",{className:"flex-1 text-center md:text-left",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2 text-foreground",children:n==null?void 0:n.display_name}),e.jsx("p",{className:"text-muted-foreground mb-2 md:mb-3",children:t.email}),(n==null?void 0:n.phone)&&e.jsx("p",{className:"text-muted-foreground mb-2 md:mb-3",children:n.phone}),y&&y!=="user"&&e.jsx(K,{className:"bg-primary capitalize",children:Y})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-start",children:[n&&e.jsx(zs,{profile:n}),N&&n&&e.jsx(Us,{isAgreed:(n==null?void 0:n.activity_terms_agreed)||!1,agreedAt:(n==null?void 0:n.activity_terms_agreed_at)||null})]})]})})})}),i?e.jsxs(e.Fragment,{children:[e.jsx(Ft,{setApi:G,opts:{align:"start",loop:!1},className:"w-full",children:e.jsxs(Tt,{className:"-ml-0",children:[e.jsx(ze,{className:"pl-0",children:e.jsxs("div",{className:"pb-4 space-y-4",children:[e.jsx(Q,{children:e.jsx(q,{className:"pt-6 pb-6",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs(vs,{className:"w-20 h-20",children:[e.jsx(ys,{src:(n==null?void 0:n.avatar_url)||""}),e.jsx(Ns,{className:"text-2xl",children:((W=n==null?void 0:n.display_name)==null?void 0:W.charAt(0).toUpperCase())||"U"})]}),e.jsxs("div",{className:"flex-1 text-center w-full",children:[e.jsx("h1",{className:"text-2xl font-bold mb-2 text-foreground",children:n==null?void 0:n.display_name}),e.jsx("p",{className:"text-muted-foreground text-sm mb-2",children:t.email}),(n==null?void 0:n.phone)&&e.jsx("p",{className:"text-muted-foreground text-sm mb-3",children:n.phone}),y&&y!=="user"&&e.jsx(K,{className:"bg-primary capitalize text-xs mb-4",children:Y}),n&&e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row gap-2 w-full",children:[e.jsx(zs,{profile:n}),N&&e.jsx(Us,{isAgreed:(n==null?void 0:n.activity_terms_agreed)||!1,agreedAt:(n==null?void 0:n.activity_terms_agreed_at)||null})]})]})]})})}),e.jsxs(Q,{children:[e.jsxs(pe,{className:"pb-3",children:[e.jsxs(ge,{className:"text-lg flex items-center gap-2",children:[e.jsx(Ge,{className:"w-5 h-5"}),s("profile.coupons.title")]}),e.jsx(Ne,{className:"text-xs",children:s("profile.coupons.description")})]}),e.jsx(q,{className:"px-3",children:f?e.jsx("div",{className:"text-center py-8 text-sm",children:s("common.loading")}):p&&p.length>0?e.jsx("div",{className:"space-y-3",children:p.map(g=>e.jsx(Ms,{coupon:g,getLocalizedField:E,t:s,isMobile:!0},g.id))}):e.jsxs("p",{className:"text-muted-foreground text-center py-8 text-sm",children:[s("profile.coupons.noCoupons")," ",e.jsx(ee,{to:"/activities",className:"text-primary hover:underline",children:s("profile.coupons.browseActivities")})]})})]}),e.jsx(Hs,{})]})}),e.jsx(ze,{className:"pl-0",children:e.jsx("div",{className:"pb-4",children:e.jsx(Q,{children:e.jsx(q,{className:"pt-4",children:e.jsxs(ps,{defaultValue:"restaurants",className:"w-full",children:[e.jsxs(gs,{className:"grid w-full grid-cols-2 mb-4",children:[e.jsxs(re,{value:"restaurants",className:"flex items-center gap-2 text-xs",children:[e.jsx(ke,{className:"w-4 h-4"}),s("profile.restaurantFavorites"),d&&d.length>0&&e.jsx(K,{variant:"secondary",className:"ml-1 px-1.5 py-0 text-xs min-w-[20px] h-5",children:d.length})]}),e.jsxs(re,{value:"activities",className:"flex items-center gap-2 text-xs",children:[e.jsx(ue,{className:"w-4 h-4"}),s("profile.activityFavorites"),a&&a.length>0&&e.jsx(K,{variant:"secondary",className:"ml-1 px-1.5 py-0 text-xs min-w-[20px] h-5",children:a.length})]})]}),e.jsx(ne,{value:"restaurants",children:x?e.jsx("div",{className:"text-center py-8 text-sm",children:s("common.loading")}):d&&d.length>0?e.jsx("div",{className:"grid gap-3 grid-cols-1",children:d.map(g=>e.jsx(Ss,{restaurant:g,getLocalizedField:E,t:s},g.id))}):e.jsx("p",{className:"text-muted-foreground text-center py-8 text-sm",children:s("profile.noFavorites")})}),e.jsx(ne,{value:"activities",children:l?e.jsx("div",{className:"text-center py-8 text-sm",children:s("common.loading")}):a&&a.length>0?e.jsx("div",{className:"space-y-3",children:a.map(g=>e.jsx(As,{subscription:g,getLocalizedField:E,t:s,isMobile:!0},g.activity_id))}):e.jsxs("p",{className:"text-muted-foreground text-center py-8 text-sm",children:[s("profile.noActivityFavorites")," ",e.jsx(ee,{to:"/activities",className:"text-primary hover:underline",children:s("profile.browseActivities")})]})})]})})})})}),e.jsx(ze,{className:"pl-0",children:e.jsx("div",{className:"pb-4",children:e.jsxs(Q,{children:[e.jsxs(pe,{className:"pb-3",children:[e.jsxs(ge,{className:"text-lg flex items-center gap-2",children:[e.jsx(Ie,{className:"w-5 h-5"}),s("profile.myComments")]}),e.jsx(Ne,{className:"text-xs",children:s("profile.commentsDesc")})]}),e.jsx(q,{className:"space-y-3 px-3",children:r?e.jsx("div",{className:"text-center py-8 text-sm",children:s("common.loading")}):o&&o.length>0?o.map(g=>e.jsx(Es,{comment:g,getLocalizedField:E},g.id)):e.jsx("p",{className:"text-muted-foreground text-center py-8 text-sm",children:s("profile.noComments")})})]})})}),N&&e.jsx(ze,{className:"pl-0",children:e.jsx("div",{className:"pb-4",children:e.jsxs(Q,{children:[e.jsxs(pe,{className:"pb-3",children:[e.jsxs(ge,{className:"text-lg flex items-center gap-2",children:[e.jsx(ue,{className:"w-5 h-5"}),s("profile.participatedActivities")]}),e.jsx(Ne,{className:"text-xs",children:s("profile.participatedActivitiesDesc")})]}),e.jsx(q,{className:"px-3",children:e.jsx("div",{className:"space-y-4",children:m?e.jsx("div",{className:"text-center py-8 text-sm",children:s("common.loading")}):c&&c.length>0?e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2 text-base",children:[e.jsx(ke,{className:"w-4 h-4"}),s("profile.restaurantActivities")]}),e.jsx("div",{className:"space-y-3",children:(()=>{const g=c.reduce((_,A)=>{const B=A.activity_id;return _[B]||(_[B]={activity:A.activity,restaurants:[],participationDate:A.created_at}),_[B].restaurants.push({id:A.restaurant_id,name:A.restaurant_name,name_en:A.restaurant_name_en,name_pt:A.restaurant_name_pt}),_},{});return Object.values(g).map(_=>e.jsx(Ps,{activityGroup:_,getLocalizedField:E,t:s,isMobile:!0},_.activity.id))})()})]}):e.jsxs("p",{className:"text-muted-foreground text-center py-8 text-sm",children:[s("profile.noParticipatedActivities")," ",e.jsx(ee,{to:"/activities",className:"text-primary hover:underline",children:s("profile.browseActivities")})]})})})]})})})]})}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-background border-t z-50",children:e.jsx("div",{className:"flex justify-around items-center py-2 px-2",children:xe.map(g=>{const _=g.icon;return e.jsxs("button",{onClick:()=>H(g.value),className:`flex flex-col items-center gap-1 py-2 px-3 rounded-lg transition-all ${S===g.value?"text-primary":"text-muted-foreground"}`,children:[e.jsx(_,{className:`${S===g.value?"w-6 h-6":"w-5 h-5"}`}),e.jsx("span",{className:"text-xs font-medium",children:g.label})]},g.value)})})})]}):e.jsxs(ps,{defaultValue:"favorites",className:"space-y-4 md:space-y-6",children:[e.jsxs(gs,{className:`grid w-full ${N?"grid-cols-5":"grid-cols-4"}`,children:[e.jsxs(re,{value:"favorites",children:[e.jsx(Oe,{className:"w-4 h-4 mr-2"}),s("profile.favorites")]}),e.jsxs(re,{value:"coupons",children:[e.jsx(Ge,{className:"w-4 h-4 mr-2"}),s("profile.coupons.title")]}),e.jsxs(re,{value:"comments",children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),s("profile.comments")]}),N&&e.jsxs(re,{value:"activities",children:[e.jsx(ue,{className:"w-4 h-4 mr-2"}),s("profile.participatedActivities")]}),e.jsxs(re,{value:"addresses",children:[e.jsx(Re,{className:"w-4 h-4 mr-2"}),s("address.myAddresses")]})]}),e.jsx(ne,{value:"favorites",children:e.jsx(Q,{children:e.jsx(q,{className:"pt-6",children:e.jsxs(ps,{defaultValue:"restaurants",className:"w-full",children:[e.jsxs(gs,{className:"grid w-full grid-cols-2 mb-6",children:[e.jsxs(re,{value:"restaurants",className:"flex items-center gap-2",children:[e.jsx(ke,{className:"w-4 h-4"}),s("profile.restaurantFavorites"),d&&d.length>0&&e.jsx(K,{variant:"secondary",className:"ml-1 px-1.5 py-0 text-xs min-w-[20px] h-5",children:d.length})]}),e.jsxs(re,{value:"activities",className:"flex items-center gap-2",children:[e.jsx(ue,{className:"w-4 h-4"}),s("profile.activityFavorites"),a&&a.length>0&&e.jsx(K,{variant:"secondary",className:"ml-1 px-1.5 py-0 text-xs min-w-[20px] h-5",children:a.length})]})]}),e.jsx(ne,{value:"restaurants",children:x?e.jsx("div",{className:"text-center py-8",children:s("common.loading")}):d&&d.length>0?e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:d.map(g=>e.jsx(Ss,{restaurant:g,getLocalizedField:E,t:s},g.id))}):e.jsx("p",{className:"text-muted-foreground text-center py-8",children:s("profile.noFavorites")})}),e.jsx(ne,{value:"activities",children:l?e.jsx("div",{className:"text-center py-8",children:s("common.loading")}):a&&a.length>0?e.jsx("div",{className:"space-y-4",children:a.map(g=>e.jsx(As,{subscription:g,getLocalizedField:E,t:s,isMobile:i},g.activity_id))}):e.jsxs("p",{className:"text-muted-foreground text-center py-8",children:[s("profile.noActivityFavorites")," ",e.jsx(ee,{to:"/activities",className:"text-primary hover:underline",children:s("profile.browseActivities")})]})})]})})})}),e.jsx(ne,{value:"comments",children:e.jsxs(Q,{children:[e.jsxs(pe,{className:i?"pb-3":"",children:[e.jsxs(ge,{className:`flex items-center gap-2 ${i?"text-lg":""}`,children:[e.jsx(Ie,{className:"w-5 h-5"}),s("profile.myComments")]}),e.jsx(Ne,{className:i?"text-xs":"",children:s("profile.commentsDesc")})]}),e.jsx(q,{className:`space-y-3 md:space-y-4 ${i?"px-3":""}`,children:r?e.jsx("div",{className:`text-center py-8 ${i?"text-sm":""}`,children:s("common.loading")}):o&&o.length>0?o.map(g=>e.jsx(Es,{comment:g,getLocalizedField:E},g.id)):e.jsx("p",{className:`text-muted-foreground text-center py-8 ${i?"text-sm":""}`,children:s("profile.noComments")})})]})}),N&&e.jsx(ne,{value:"activities",children:e.jsxs(Q,{children:[e.jsxs(pe,{className:i?"pb-3":"",children:[e.jsxs(ge,{className:`flex items-center gap-2 ${i?"text-lg":""}`,children:[e.jsx(ue,{className:"w-5 h-5"}),s("profile.participatedActivities")]}),e.jsx(Ne,{className:i?"text-xs":"",children:s("profile.participatedActivitiesDesc")})]}),e.jsx(q,{className:i?"px-3":"",children:e.jsx("div",{className:i?"space-y-4":"space-y-6",children:m?e.jsx("div",{className:`text-center py-8 ${i?"text-sm":""}`,children:s("common.loading")}):c&&c.length>0?e.jsxs("div",{children:[e.jsxs("h3",{className:`font-semibold mb-3 md:mb-4 flex items-center gap-2 ${i?"text-base":"text-lg"}`,children:[e.jsx(ke,{className:i?"w-4 h-4":"w-5 h-5"}),s("profile.restaurantActivities")]}),e.jsx("div",{className:i?"space-y-3":"space-y-4",children:(()=>{const g=c.reduce((_,A)=>{const B=A.activity_id;return _[B]||(_[B]={activity:A.activity,restaurants:[],participationDate:A.created_at}),_[B].restaurants.push({id:A.restaurant_id,name:A.restaurant_name,name_en:A.restaurant_name_en,name_pt:A.restaurant_name_pt}),_},{});return Object.values(g).map(_=>e.jsx(Ps,{activityGroup:_,getLocalizedField:E,t:s,isMobile:i},_.activity.id))})()})]}):e.jsxs("p",{className:`text-muted-foreground text-center py-8 ${i?"text-sm":""}`,children:[s("profile.noParticipatedActivities")," ",e.jsx(ee,{to:"/activities",className:"text-primary hover:underline",children:s("profile.browseActivities")})]})})})]})}),e.jsx(ne,{value:"coupons",children:e.jsxs(Q,{children:[e.jsxs(pe,{className:i?"pb-3":"",children:[e.jsxs(ge,{className:`flex items-center gap-2 ${i?"text-lg":""}`,children:[e.jsx(Ge,{className:"w-5 h-5"}),s("profile.coupons.title")]}),e.jsx(Ne,{className:i?"text-xs":"",children:s("profile.coupons.description")})]}),e.jsx(q,{className:i?"px-3":"",children:f?e.jsx("div",{className:`text-center py-8 ${i?"text-sm":""}`,children:s("common.loading")}):p&&p.length>0?e.jsx("div",{className:`grid gap-3 md:gap-4 ${i?"grid-cols-1":"md:grid-cols-2"}`,children:p.map(g=>e.jsx(Ms,{coupon:g,getLocalizedField:E,t:s,isMobile:i},g.id))}):e.jsxs("p",{className:`text-muted-foreground text-center py-8 ${i?"text-sm":""}`,children:[s("profile.coupons.noCoupons")," ",e.jsx(ee,{to:"/activities",className:"text-primary hover:underline",children:s("profile.coupons.browseActivities")})]})})]})}),e.jsx(ne,{value:"addresses",children:e.jsx(Hs,{})})]})]})})};export{Xa as default};
