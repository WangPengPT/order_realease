import{j as e}from"./vendor-ui-DAmPMpEA.js";import{r as n}from"./vendor-react-iAJ0IrSD.js";import{C as j,k as g,I as Q,a6 as U,a7 as V,a8 as Z,a9 as $,aa as o,g as w,j as J,t as K,ac as W,U as X,B as l,ag as G,D,a as C,b,d as _,$ as Y,ab as ee,a2 as se,J as te,K as ae,N as ie,O as ne,Q as ce,R as le,T as de,V as re,r as y}from"./index-Do1W_89N.js";import{a as me,b as oe,c as xe}from"./useActivityRequests-DSW11i2n.js";import{u as ue}from"./useLocalizedContent-tJ7i_ycU.js";import{u as he}from"./vendor-i18n-DxKeo2S1.js";import{S as pe}from"./search-DsePuv7P.js";import{E as ve}from"./eye-BYP9cNA5.js";import{C as S}from"./circle-check-D2dz3442.js";import{C as A}from"./circle-x-C1hLrEm8.js";import{C as je}from"./clock-C2dMhwrG.js";import{f as m}from"./format-DMNSJgyu.js";import"./vendor-charts-Bz7hPIBd.js";import"./vendor-query-BlSVl3IQ.js";import"./vendor-supabase-KNAP0qdW.js";import"./startOfDay-D6pD3B6q.js";const ze=()=>{const{t:s}=he(),{data:T,isLoading:k}=me(),{getLocalizedField:d}=ue(),x=oe(),M=xe(),[f,O]=n.useState(""),[u,z]=n.useState("all"),[E,r]=n.useState(!1),[P,N]=n.useState(!1),[F,h]=n.useState(!1),[a,i]=n.useState(null),[c,R]=n.useState("approved"),[q,p]=n.useState(""),v=T?.filter(t=>{const H=String(d(t,"title")||"").toLowerCase().includes(f.toLowerCase()),L=u==="all"||t.status===u;return H&&L}),I=t=>{switch(t){case"pending":return e.jsxs(y,{variant:"secondary",className:"gap-1",children:[e.jsx(je,{className:"h-3 w-3"}),s("admin.activityRequests.pending")]});case"approved":return e.jsxs(y,{className:"gap-1 bg-green-500",children:[e.jsx(S,{className:"h-3 w-3"}),s("admin.activityRequests.approved")]});case"rejected":return e.jsxs(y,{variant:"destructive",className:"gap-1",children:[e.jsx(A,{className:"h-3 w-3"}),s("admin.activityRequests.rejected")]});default:return null}},B=()=>{a&&(x.mutate({requestId:a.id,status:c,adminNotes:q||void 0}),r(!1),i(null),p(""))};return k?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("p",{className:"text-muted-foreground",children:s("common.loading")})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:s("admin.activityRequests.title")}),e.jsx("p",{className:"text-muted-foreground mt-2",children:s("admin.activityRequests.description")})]})}),e.jsx(j,{children:e.jsx(g,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(pe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(Q,{placeholder:s("admin.activityRequests.searchPlaceholder"),value:f,onChange:t=>O(t.target.value),className:"pl-10"})]}),e.jsxs(U,{value:u,onValueChange:z,children:[e.jsx(V,{className:"w-[180px]",children:e.jsx(Z,{placeholder:s("admin.activityRequests.statusFilter")})}),e.jsxs($,{children:[e.jsx(o,{value:"all",children:s("admin.activityRequests.allStatus")}),e.jsx(o,{value:"pending",children:s("admin.activityRequests.pending")}),e.jsx(o,{value:"approved",children:s("admin.activityRequests.approved")}),e.jsx(o,{value:"rejected",children:s("admin.activityRequests.rejected")})]})]})]})})}),e.jsx("div",{className:"grid gap-4",children:!v||v.length===0?e.jsx(j,{children:e.jsxs(g,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(w,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg font-medium",children:s("admin.activityRequests.noRequests")})]})}):v.map(t=>e.jsxs(j,{children:[e.jsx(J,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs(K,{className:"text-lg md:text-xl flex items-center gap-2",children:[e.jsx(w,{className:"h-5 w-5"}),d(t,"title")]}),e.jsxs(W,{className:"mt-2 flex items-center gap-2",children:[e.jsx(X,{className:"h-3 w-3"}),t.profiles?.display_name||s("admin.activityRequests.unknownUser"),e.jsx("span",{children:"•"}),m(new Date(t.created_at),"yyyy-MM-dd HH:mm")]})]}),I(t.status)]})}),e.jsx(g,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[s("admin.activityRequests.activityTime"),"：",m(new Date(t.start_date),"yyyy-MM-dd"),t.end_date?` - ${m(new Date(t.end_date),"yyyy-MM-dd")}`:` - ${s("admin.activityRequests.noEndDate")}`]}),d(t,"intro")&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:d(t,"intro")}),t.admin_notes&&e.jsxs("div",{className:"p-3 rounded-lg bg-muted",children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:s("admin.activityRequests.adminNotes")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.admin_notes})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>{i(t),N(!0)},children:[e.jsx(ve,{className:"mr-2 h-3 w-3"}),s("admin.activityRequests.viewDetails")]}),t.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs(l,{size:"sm",onClick:()=>{i(t),R("approved"),r(!0)},children:[e.jsx(S,{className:"mr-2 h-3 w-3"}),s("admin.activityRequests.approve")]}),e.jsxs(l,{variant:"destructive",size:"sm",onClick:()=>{i(t),R("rejected"),r(!0)},children:[e.jsx(A,{className:"mr-2 h-3 w-3"}),s("admin.activityRequests.reject")]})]}),e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>{i(t),h(!0)},children:[e.jsx(G,{className:"mr-2 h-3 w-3"}),s("admin.activityRequests.delete")]})]})]})})]},t.id))}),e.jsx(D,{open:E,onOpenChange:r,children:e.jsxs(C,{children:[e.jsxs(b,{children:[e.jsx(_,{children:s(c==="approved"?"admin.activityRequests.approveTitle":"admin.activityRequests.rejectTitle")}),e.jsx(Y,{children:s(c==="approved"?"admin.activityRequests.approveDesc":"admin.activityRequests.rejectDesc")})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:s("admin.activityRequests.activityName")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a&&d(a,"title")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:s("admin.activityRequests.adminNotes")}),e.jsx(ee,{placeholder:s(c==="approved"?"admin.activityRequests.notesPlaceholder.approve":"admin.activityRequests.notesPlaceholder.reject"),value:q,onChange:t=>p(t.target.value)})]})]}),e.jsxs(se,{children:[e.jsx(l,{variant:"outline",onClick:()=>{r(!1),i(null),p("")},children:s("admin.activityRequests.cancel")}),e.jsx(l,{variant:c==="approved"?"default":"destructive",onClick:B,disabled:x.isPending,children:x.isPending?s("admin.activityRequests.processing"):s(c==="approved"?"admin.activityRequests.confirmApprove":"admin.activityRequests.confirmReject")})]})]})}),e.jsx(D,{open:P,onOpenChange:N,children:e.jsxs(C,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(b,{children:e.jsx(_,{children:s("admin.activityRequests.detailsTitle")})}),a&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:s("admin.activityRequests.titleZh")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.title_zh})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:s("admin.activityRequests.titleEn")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.title_en})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:s("admin.activityRequests.titlePt")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.title_pt})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:s("admin.activityRequests.introZh")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.intro_zh||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:s("admin.activityRequests.introEn")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.intro_en||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:s("admin.activityRequests.introPt")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.intro_pt||"-"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:s("admin.activityRequests.contentZh")}),e.jsx("p",{className:"text-sm text-muted-foreground whitespace-pre-wrap",children:a.content_zh})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:s("admin.activityRequests.contentEn")}),e.jsx("p",{className:"text-sm text-muted-foreground whitespace-pre-wrap",children:a.content_en})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:s("admin.activityRequests.contentPt")}),e.jsx("p",{className:"text-sm text-muted-foreground whitespace-pre-wrap",children:a.content_pt})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:s("admin.activityRequests.startDate")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:m(new Date(a.start_date),"yyyy-MM-dd")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:s("admin.activityRequests.endDate")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.end_date?m(new Date(a.end_date),"yyyy-MM-dd"):s("admin.activityRequests.noEndDate")})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:s("admin.activityRequests.serviceType")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.service_type==="dine_in"?s("admin.activityRequests.serviceType.dineIn"):a.service_type==="takeaway"?s("admin.activityRequests.serviceType.takeaway"):s("admin.activityRequests.serviceType.both")})]}),a.image_url&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:s("admin.activityRequests.coverImage")}),e.jsx("img",{src:a.image_url,alt:s("admin.activityRequests.coverImage"),className:"rounded-lg max-w-full h-auto max-h-48 object-cover"})]})]})]})}),e.jsx(te,{open:F,onOpenChange:h,children:e.jsxs(ae,{children:[e.jsxs(ie,{children:[e.jsx(ne,{children:s("admin.activityRequests.confirmDelete")}),e.jsx(ce,{children:s("admin.activityRequests.deleteWarning")})]}),e.jsxs(le,{children:[e.jsx(de,{onClick:()=>i(null),children:s("admin.activityRequests.cancel")}),e.jsx(re,{onClick:()=>{a&&(M.mutate(a.id),h(!1),i(null))},children:s("admin.activityRequests.confirmDeleteBtn")})]})]})})]})};export{ze as default};
//# sourceMappingURL=AdminActivityRequests-WTcq9oph.js.map
