import{j as e,p as ie,b6 as I,u as ze,q as Me,r,aM as Fe,b7 as Ie,b8 as Pe,b9 as qe,ba as _e,X as F,bb as Qe,bc as Ee,bd as Ke,y as Be,be as Ve,L as Oe,bf as We}from"./vendor-react-87iFmKFJ.js";import{f as Ge}from"./textFormatting-37JGiPHb.js";import{C as ne,S as l,m as oe,n as ce,p as de,A as He,q as Xe,r as Je,t as Ue,v as Ye,w as Ze,x as es,y as ss,z as ts,a as as,u as ls,I as rs,h as u,B as w,s as is}from"./index-CH4FpCej.js";import{P as me,a as ue,b as xe}from"./popover-pxVAyhDa.js";import{u as ns,a as os,b as cs,c as ds}from"./useRestaurants-CuLkQhYp.js";import{g as re,c as ms,o as us}from"./geolocation-YPf7LJYy.js";import{u as xs,R as hs,l as fs}from"./xiaoxiong-logo-clean-X0XoY2GF.js";import{u as gs}from"./useLocalizedContent-CFh79NZC.js";import{f as ps}from"./timeUtils-pgRxO0UB.js";import{u as vs}from"./useActivities-Cx4MTjAu.js";import{u as js}from"./useInfiniteScroll-D740jfGn.js";import{L as Ns}from"./LocationPermissionDialog-xb98OC7b.js";import{P as ws}from"./PullToRefresh-BOMISILW.js";import{T as bs,a as ys,b as W}from"./tabs-C0xzZL5g.js";import"./vendor-i18n-AOdgFpXS.js";import"./vendor-editor-B1vH4T8i.js";import"./vendor-utils-vwQGbBim.js";import"./vendor-supabase-CQWbleDe.js";import"./vendor-map-CvE3ASYw.js";import"./map-icon-DR07RZr_.js";const ks=({count:h=6})=>e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:h}).map((o,t)=>e.jsxs(ne,{className:"overflow-hidden flex flex-col h-full",style:{animationDelay:`${t*100}ms`},children:[e.jsxs("div",{className:"relative h-48 overflow-hidden",children:[e.jsx(l,{className:"w-full h-full rounded-none"}),e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx(l,{className:"h-9 w-9 rounded-md"})})]}),e.jsx(oe,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(l,{className:"h-6 w-40"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(l,{className:"h-4 w-4 rounded-full"}),e.jsx(l,{className:"h-4 w-16"})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(l,{className:"h-5 w-5 rounded-full"}),e.jsx(l,{className:"h-5 w-8"})]})]})}),e.jsxs(ce,{className:"space-y-3 flex-grow",children:[e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(l,{className:"h-5 w-16 rounded-full"}),e.jsx(l,{className:"h-5 w-20 rounded-full"}),e.jsx(l,{className:"h-5 w-14 rounded-full"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{className:"h-4 w-4 rounded-full flex-shrink-0"}),e.jsx(l,{className:"h-4 w-full"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{className:"h-4 w-4 rounded-full flex-shrink-0"}),e.jsx(l,{className:"h-4 w-32"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{className:"h-4 w-4 rounded-full flex-shrink-0"}),e.jsx(l,{className:"h-4 w-40"})]})]}),e.jsxs(de,{className:"gap-2 mt-auto",children:[e.jsx(l,{className:"h-10 flex-1 rounded-md"}),e.jsx(l,{className:"h-10 w-10 rounded-md"})]})]},t))}),Cs=()=>e.jsxs("div",{className:"relative flex-1 min-h-[300px] sm:min-h-[400px] lg:mx-4 lg:mb-4 lg:rounded-lg overflow-hidden lg:shadow-lg bg-muted",children:[e.jsx(l,{className:"absolute inset-0 w-full h-full rounded-none"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:e.jsx(l,{className:"h-8 w-8 rounded-full"})}),e.jsx("div",{className:"absolute top-1/4 left-1/3",children:e.jsx(l,{className:"h-6 w-6 rounded-full"})}),e.jsx("div",{className:"absolute top-1/3 right-1/4",children:e.jsx(l,{className:"h-6 w-6 rounded-full"})}),e.jsx("div",{className:"absolute bottom-1/3 left-1/4",children:e.jsx(l,{className:"h-6 w-6 rounded-full"})}),e.jsx("div",{className:"absolute bottom-1/4 right-1/3",children:e.jsx(l,{className:"h-6 w-6 rounded-full"})})]})}),e.jsx("div",{className:"absolute bottom-4 left-4 z-10",children:e.jsx(l,{className:"h-10 w-36 rounded-full"})}),e.jsxs("div",{className:"absolute top-4 right-4 z-10 flex flex-col gap-2",children:[e.jsx(l,{className:"h-8 w-8 rounded-md"}),e.jsx(l,{className:"h-8 w-8 rounded-md"})]})]}),Ss=()=>{const h=/iPad|iPhone|iPod/.test(navigator.userAgent),o=/Android/.test(navigator.userAgent);return h?"Apple Maps":"Google Maps"},Ts=({open:h,onOpenChange:o,onConfirm:t,destinationName:f})=>{const{t:g}=ie(),R=Ss();return e.jsx(He,{open:h,onOpenChange:o,children:e.jsxs(Xe,{className:"max-w-md",children:[e.jsxs(Je,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 rounded-full bg-primary/10",children:e.jsx(I,{className:"w-5 h-5 text-primary"})}),e.jsx(Ue,{children:g("navigation.confirmTitle")})]}),e.jsx(Ye,{className:"text-left",children:g("navigation.confirmDescription",{appName:R,destination:f})})]}),e.jsxs(Ze,{className:"flex-col sm:flex-row gap-2",children:[e.jsx(es,{className:"w-full sm:w-auto",children:g("common.cancel")}),e.jsx(ss,{onClick:t,className:"w-full sm:w-auto",children:g("navigation.openApp",{appName:R})})]})]})})},Rs=({restaurant:h,language:o})=>{const[t,f]=r.useState(999),g=r.useRef(null),j=h.type.map((i,d)=>({key:`type-${d}`,label:i,variant:"secondary",color:void 0}));r.useEffect(()=>{const i=()=>{if(!g.current)return;const C=g.current,n=Array.from(C.querySelectorAll(".tag-badge"));if(n.length===0){setTimeout(i,50);return}const S=n[0]?.offsetTop;let b=n.length;for(let p=0;p<n.length;p++)if(n[p].offsetTop>S){b=p;break}if(b===n.length){f(n.length);return}const y=C.offsetWidth,c=40;let $=0,N=b;for(let p=0;p<b;p++)$+=n[p].offsetWidth+8;$+c>y&&(N=Math.max(1,b-1)),f(N)};f(999);const d=setTimeout(i,100);return window.addEventListener("resize",i),()=>{clearTimeout(d),window.removeEventListener("resize",i)}},[j.length,h.id]);const A=j.slice(0,t),z=j.slice(t),k=z.length>0;return e.jsxs("div",{className:"flex items-center gap-2 -mt-1",children:[e.jsx("div",{ref:g,className:"flex gap-2 flex-wrap flex-1",children:A.map(i=>e.jsx(w,{variant:i.variant,className:"text-xs whitespace-nowrap tag-badge",style:i.color?{backgroundColor:i.color,color:"white"}:void 0,children:i.label},i.key))}),k&&e.jsxs(me,{children:[e.jsx(ue,{asChild:!0,children:e.jsx(u,{variant:"ghost",size:"sm",className:"h-6 px-2 text-muted-foreground hover:text-foreground flex-shrink-0",children:e.jsx(We,{className:"h-4 w-4"})})}),e.jsx(xe,{className:"w-auto max-w-80",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:z.map(i=>e.jsx(w,{variant:i.variant,className:"text-xs",style:i.color?{backgroundColor:i.color,color:"white"}:void 0,children:i.label},i.key))})})]})]})},Xs=()=>{const h=ze(),o=Me(),{t,i18n:f}=ie(),{toast:g}=ts(),{localizeRestaurant:R}=gs(),j=as(),[A,z]=r.useState(""),[k,i]=r.useState("all"),[d,C]=r.useState([]),[n,S]=r.useState(null),[b,y]=r.useState([]),[c,$]=r.useState("list"),[N,p]=r.useState(()=>localStorage.getItem("restaurant-list-columns")==="1"?1:2),[x,P]=r.useState(null),[m,q]=r.useState(()=>{const s=localStorage.getItem("restaurant-user-location");if(s)try{return JSON.parse(s)}catch{return null}return null}),[L,G]=r.useState(()=>localStorage.getItem("restaurant-sort-by-distance")==="true"),[_,he]=r.useState(!1),[Q,fe]=r.useState(!1),[ge,E]=r.useState(!1),[pe,K]=r.useState(!1),[B,H]=r.useState(!1),[D,ve]=r.useState(null),{user:X}=ls(),{data:J,isLoading:je}=ns(A,d.length>0?d.join(","):void 0),{data:Ne=[]}=os(),{data:V=[]}=cs(),{data:we=[]}=vs(),{data:be={}}=xs(),ye=r.useCallback(async()=>{o.removeQueries({queryKey:["restaurants"]}),o.removeQueries({queryKey:["activities"]}),o.removeQueries({queryKey:["restaurantTypes"]}),o.removeQueries({queryKey:["favorites"]}),o.removeQueries({queryKey:["favorite-ids"]}),await Promise.all([o.invalidateQueries({queryKey:["restaurants"]}),o.invalidateQueries({queryKey:["activities"]}),o.invalidateQueries({queryKey:["restaurantTypes"]}),o.invalidateQueries({queryKey:["favorites"]}),o.invalidateQueries({queryKey:["favorite-ids"]})])},[o]),M=we.filter(s=>(be[s.id]||0)>0),ke=ds(),Ce=(s,a)=>{a.preventDefault(),a.stopPropagation(),X&&ke.mutate(s)},Se=s=>{C(a=>a.includes(s)?a.filter(v=>v!==s):[...a,s])},Te=()=>{if(L){G(!1),q(null),localStorage.removeItem("restaurant-user-location"),localStorage.removeItem("restaurant-sort-by-distance");return}K(!0)};r.useEffect(()=>{m&&localStorage.setItem("restaurant-user-location",JSON.stringify(m))},[m]),r.useEffect(()=>{localStorage.setItem("restaurant-sort-by-distance",String(L))},[L]),r.useEffect(()=>{L&&m&&re().then(s=>{q({lat:s.coords.latitude,lng:s.coords.longitude})}).catch(()=>{})},[]);const U=async()=>{K(!1),H(!0);try{const s=await re();q({lat:s.coords.latitude,lng:s.coords.longitude}),G(!0),g({title:t("restaurants.locationEnabled"),description:t("restaurants.sortByDistance")})}catch(s){console.error("Location error:",s)}finally{H(!1)}},Re=s=>{P(s),s&&!m&&U()},Ae=async s=>{if(n===s)S(null),y([]);else{S(s);const{data:a,error:v}=await is.from("activity_restaurants").select("restaurant_id").eq("activity_id",s);v?(console.error("Error fetching activity restaurants:",v),y([])):y(a.map(O=>O.restaurant_id))}},Y=J?.map(s=>{const a=R(s);if(m){const v=ms(m.lat,m.lng,s.lat,s.lng);return{...a,distance:v}}return a})||[],Z=k==="all"?Y:Y.filter(s=>(s.template||"default")===k),ee=n?Z.filter(s=>b.includes(s.id)):Z,se=x&&m?ee.filter(s=>s.distance&&s.distance<=x):ee,T=m?[...se].sort((s,a)=>(s.distance||0)-(a.distance||0)):[...se].sort((s,a)=>(a.rating||0)-(s.rating||0)),{displayedData:te,hasMore:$e,loadMore:Le,reset:ae}=js({data:T,initialItemsPerPage:12,incrementPerPage:12});r.useEffect(()=>{ae()},[A,d,n,x,L,k,ae]);const De=s=>{h(`/restaurant/${s.id}`)},le=e.jsx("div",{className:`bg-secondary/20 animate-fade-in ${c==="map"?"h-screen flex flex-col overflow-hidden":"min-h-screen py-8 px-4"}`,children:e.jsxs("div",{className:`${c==="map"?"flex flex-col h-full":"container mx-auto max-w-7xl"}`,children:[e.jsxs("div",{className:`${c==="map"?"px-4 pt-4 pb-2 flex-shrink-0":"mb-8"}`,children:[e.jsx("h1",{className:`text-3xl sm:text-4xl font-medium text-primary ${c==="map"?"hidden md:block md:mb-4":"mb-4"}`,children:t("restaurants.title")}),e.jsx(bs,{value:k,onValueChange:s=>i(s),className:"mb-4",children:e.jsxs(ys,{className:"w-full sm:w-auto",children:[e.jsx(W,{value:"all",className:"flex-1 sm:flex-auto",children:t("restaurants.tabAll")}),e.jsx(W,{value:"default",className:"flex-1 sm:flex-auto",children:t("restaurants.tabPhysical")}),e.jsx(W,{value:"ghost",className:"flex-1 sm:flex-auto",children:t("restaurants.tabGhost")})]})}),e.jsx("div",{className:"flex flex-col gap-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:items-center",children:[e.jsx(rs,{placeholder:t("restaurants.search"),value:A,onChange:s=>z(s.target.value),className:"w-full md:max-w-md"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(u,{variant:m?"default":"outline",size:"sm",onClick:Te,disabled:B,className:"gap-1.5",children:[B?e.jsx(Fe,{className:"h-4 w-4 animate-spin"}):e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{children:B?t("restaurants.locating","定位中..."):t("restaurants.getLocation")})]}),e.jsxs("div",{className:"inline-flex h-9 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",children:[e.jsx("button",{onClick:()=>{if(c==="list"){if(j){const s=N===2?1:2;p(s),localStorage.setItem("restaurant-list-columns",String(s))}}else $("list")},title:c==="list"&&j?N===2?t("restaurants.singleColumn","单列布局"):t("restaurants.doubleColumn","双列布局"):t("restaurants.listView"),className:`inline-flex items-center justify-center whitespace-nowrap rounded-sm px-2.5 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 ${c==="list"?"bg-background text-foreground shadow-sm":""}`,children:c==="list"&&j&&N===1?e.jsx(Ie,{className:"h-3.5 w-3.5"}):e.jsx(Pe,{className:"h-3.5 w-3.5"})}),e.jsx("button",{onClick:()=>$("map"),title:t("restaurants.mapView"),className:`inline-flex items-center justify-center whitespace-nowrap rounded-sm px-2.5 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 ${c==="map"?"bg-background text-foreground shadow-sm":""}`,children:e.jsx(qe,{className:"h-3.5 w-3.5"})}),e.jsxs(me,{children:[e.jsx(ue,{asChild:!0,children:e.jsxs("button",{title:t("restaurants.filter"),className:`inline-flex items-center justify-center whitespace-nowrap rounded-sm px-2.5 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 relative ${d.length>0||n||x?"bg-background text-foreground shadow-sm":""}`,children:[e.jsx(_e,{className:"h-3.5 w-3.5"}),(d.length>0||n||x)&&e.jsx(w,{variant:"secondary",className:"absolute -top-1 -right-1 h-4 w-4 p-0 flex items-center justify-center text-[10px]",children:(d.length>0?1:0)+(n?1:0)+(x?1:0)})]})}),e.jsx(xe,{className:"w-[90vw] max-w-sm p-0",align:"start",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border/50 bg-muted/30",children:[e.jsx("span",{className:"font-semibold text-foreground text-base",children:t("restaurants.filter")}),(d.length>0||n||x)&&e.jsxs(u,{variant:"ghost",size:"sm",className:"h-7 px-2 text-xs text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>{C([]),S(null),y([]),P(null)},children:[e.jsx(F,{className:"w-3 h-3 mr-1"}),t("common.actions.clearFilter")]})]}),e.jsxs("div",{className:"p-4 space-y-5",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:t("restaurants.restaurantTypes")}),e.jsxs("div",{className:"flex items-center gap-2",children:[d.length>0&&e.jsxs(u,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>C([]),children:[e.jsx(F,{className:"w-3 h-3 mr-1"}),t("common.actions.clear")]}),V.length>8&&e.jsx(u,{variant:"link",size:"sm",className:"h-auto p-0 text-xs text-primary hover:text-primary/80",onClick:()=>he(!_),children:t(_?"common.showLess":"common.showMore")})]})]}),e.jsx("div",{className:"flex gap-2 flex-wrap max-h-36 overflow-y-auto pr-1",children:(_?V:V.slice(0,8)).map(s=>e.jsx(w,{variant:d.includes(s)?"default":"outline",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs font-normal whitespace-nowrap hover:bg-primary/10 ${d.includes(s)?"bg-primary text-primary-foreground shadow-sm":"bg-background hover:border-primary/50"}`,onClick:()=>Se(s),children:s},s))})]}),M.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:t("nav.activities")}),e.jsxs("div",{className:"flex items-center gap-2",children:[n&&e.jsxs(u,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>{S(null),y([])},children:[e.jsx(F,{className:"w-3 h-3 mr-1"}),t("common.actions.clear")]}),M.length>8&&e.jsx(u,{variant:"link",size:"sm",className:"h-auto p-0 text-xs text-primary hover:text-primary/80",onClick:()=>fe(!Q),children:t(Q?"common.showLess":"common.showMore")})]})]}),e.jsx("div",{className:"flex gap-2 flex-wrap max-h-36 overflow-y-auto pr-1",children:(Q?M:M.slice(0,8)).map(s=>{const a=f.language==="zh"?s.badge_text_zh||s.title_zh:f.language==="pt"?s.badge_text_pt||s.title_pt:s.badge_text_en||s.title_en;return e.jsx(w,{variant:n===s.id?"default":"outline",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs font-normal whitespace-nowrap hover:bg-primary/10 ${n===s.id?"bg-primary text-primary-foreground shadow-sm":"bg-background hover:border-primary/50"}`,onClick:()=>Ae(s.id),children:a},s.id)})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:t("restaurants.radius")}),x&&e.jsxs(u,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>P(null),children:[e.jsx(F,{className:"w-3 h-3 mr-1"}),t("common.actions.clear")]})]}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:[{value:null,label:t("restaurants.allRestaurants")},{value:5,label:t("restaurants.radius5km")},{value:10,label:t("restaurants.radius10km")},{value:20,label:t("restaurants.radius20km")}].map(s=>e.jsx(w,{variant:x===s.value?"default":"outline",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs font-normal whitespace-nowrap hover:bg-primary/10 ${x===s.value?"bg-primary text-primary-foreground shadow-sm":"bg-background hover:border-primary/50"}`,onClick:()=>Re(s.value),children:s.label},s.value??"all"))})]})]})]})})]})]})]})]})})]}),je||!J?c==="map"?e.jsx(Cs,{}):e.jsx(ks,{count:6}):T.length===0?e.jsxs("div",{className:`text-center ${c==="map"?"flex-1 flex flex-col justify-center px-4":"py-20"}`,children:[e.jsx("p",{className:"text-xl text-muted-foreground",children:t("restaurants.noResults")}),e.jsx("p",{className:"text-muted-foreground mt-2",children:t("restaurants.noResultsDesc")})]}):e.jsxs(e.Fragment,{children:[c==="map"&&T.length>0&&e.jsxs("div",{className:"relative flex-1 min-h-[300px] sm:min-h-[400px] lg:mx-4 lg:mb-4 lg:rounded-lg overflow-hidden lg:shadow-lg",children:[e.jsx(hs,{restaurants:T,onRestaurantClick:De,userLocation:m,radiusFilter:x,showViewDetailsButton:!0}),e.jsxs("div",{className:"absolute bottom-4 left-4 z-10 pointer-events-none flex items-center gap-2 bg-background/80 backdrop-blur-sm px-3 py-2 rounded-full shadow-lg",children:[e.jsx("img",{src:fs,alt:"Xiaoxiong Market Logo",className:"h-6 w-6 object-contain"}),e.jsx("span",{className:"text-sm font-semibold text-foreground whitespace-nowrap",children:f.language==="zh"?"小熊市场":"Xiaoxiong Market"})]})]}),c==="list"&&T.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`grid gap-6 ${N===1?"grid-cols-1":"grid-cols-2"} md:grid-cols-2 lg:grid-cols-3`,children:te.map(s=>{const a=j&&N===2;return e.jsxs(ne,{className:`overflow-hidden hover:shadow-large transition-shadow flex flex-col h-full ${a?"gap-0":""}`,children:[e.jsxs("div",{className:`relative overflow-hidden ${a?"h-28":"h-48"}`,children:[e.jsx("img",{src:s.image_url||"https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=600&q=80",alt:s.name,className:"w-full h-full object-cover transition-transform hover:scale-105"}),X&&e.jsx(u,{size:"icon",variant:"secondary",className:`absolute ${a?"top-1.5 right-1.5 h-7 w-7":"top-3 right-3"}`,onClick:v=>Ce(s.id,v),children:e.jsx(Qe,{className:`${a?"w-3.5 h-3.5":"w-5 h-5"} ${Ne.includes(s.id)?"fill-destructive text-destructive":""}`})})]}),e.jsx(oe,{className:a?"p-2 pb-1":"mb-px pb-[15px]",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:`flex flex-col ${a?"gap-0.5":"gap-2"}`,children:[e.jsx("h3",{className:`font-semibold text-card-foreground ${a?"text-sm line-clamp-2":"text-xl"}`,children:Ge(s.name)}),s.distance!==void 0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(I,{className:`text-primary ${a?"w-3 h-3":"w-4 h-4"}`}),e.jsxs("span",{className:`font-semibold text-foreground ${a?"text-xs":"text-sm"}`,children:[s.distance.toFixed(1)," km"]})]})]}),e.jsxs("div",{className:"flex items-center gap-0.5",children:[e.jsx(Ee,{className:`${a?"w-3.5 h-3.5":"w-5 h-5"} ${s.rating?"fill-accent text-accent":"text-muted-foreground"}`}),s.rating?e.jsx("span",{className:`font-semibold text-card-foreground ${a?"text-xs":""}`,children:s.rating.toFixed(1)}):!a&&e.jsxs("span",{className:"text-xs text-muted-foreground text-center whitespace-nowrap",children:[t("restaurant.noRatingLine1"),e.jsx("br",{}),t("restaurant.noRatingLine2")]})]})]})}),e.jsxs(ce,{className:`flex-grow ${a?"p-2 pt-0 space-y-1":"space-y-2"}`,children:[e.jsx("div",{className:`flex items-center flex-wrap ${a?"gap-1":"gap-2"}`,children:a?s.type.slice(0,2).map((v,O)=>e.jsx(w,{variant:"secondary",className:"text-xs px-1.5 py-0.5",children:v},`type-${O}`)):e.jsxs(e.Fragment,{children:[e.jsx(Rs,{restaurant:s,language:f.language}),s.template==="ghost"&&e.jsx(w,{variant:"outline",className:"text-xs",children:t("restaurants.ghostKitchen")})]})}),!a&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm",children:[e.jsx(Ke,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:"line-clamp-1",children:s.address})]}),!a&&s.phone&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm",children:[e.jsx(Be,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:s.phone})]}),!a&&s.opening_hours&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm",children:[e.jsx(Ve,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:ps(s.opening_hours)})]})]}),e.jsxs(de,{className:`mt-auto ${a?"p-2 pt-0":"gap-2"}`,children:[e.jsx(u,{asChild:!0,className:`flex-1 ${a?"h-7 text-xs":""}`,size:a?"sm":"default",children:e.jsx(Oe,{to:`/restaurant/${s.id}`,children:t("restaurants.viewDetails")})}),!a&&m&&e.jsx(u,{variant:"outline",size:"icon",onClick:()=>{ve({lat:s.lat,lng:s.lng,name:s.name}),E(!0)},title:t("restaurants.directions"),children:e.jsx(I,{className:"w-4 h-4"})})]})]},s.id)})}),$e&&e.jsx("div",{className:"flex justify-center mt-8",children:e.jsxs(u,{onClick:Le,size:"lg",variant:"outline",children:[t("common.loadMore")," (",te.length," / ",T.length,")"]})})]})]}),e.jsx(Ts,{open:ge,onOpenChange:E,onConfirm:()=>{D&&us(D.lat,D.lng,D.name),E(!1)},destinationName:D?.name||""}),e.jsx(Ns,{open:pe,onOpenChange:K,onConfirm:U})]})});return c==="list"?e.jsx(ws,{onRefresh:ye,children:le}):le};export{Xs as default};
//# sourceMappingURL=Restaurants-DsTA5ABw.js.map
