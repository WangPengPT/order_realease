{"version":3,"file":"RestaurantFormDialog-CNUUMFVf.js","sources":["../../src/hooks/useDishImages.ts","../../src/components/admin/DishImageManager.tsx","../../src/components/admin/RestaurantFormDialog.tsx"],"sourcesContent":["import { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { useAuth } from \"@/contexts/AuthContext\";\r\nimport { toast } from \"sonner\";\r\nimport i18n from \"i18next\";\r\n\r\nexport interface DishImage {\r\n  id: string;\r\n  restaurant_id: string;\r\n  image_url: string;\r\n  sort_order: number;\r\n  created_at: string;\r\n  created_by: string | null;\r\n}\r\n\r\nexport const useDishImages = (restaurantId: string) => {\r\n  return useQuery({\r\n    queryKey: [\"dish-images\", restaurantId],\r\n    queryFn: async () => {\r\n      const { data, error } = await supabase\r\n        .from(\"restaurant_dish_images\")\r\n        .select(\"*\")\r\n        .eq(\"restaurant_id\", restaurantId)\r\n        .order(\"sort_order\", { ascending: true });\r\n\r\n      if (error) throw error;\r\n      return data as DishImage[];\r\n    },\r\n    enabled: !!restaurantId,\r\n  });\r\n};\r\n\r\nexport const useAddDishImage = () => {\r\n  const { user } = useAuth();\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: async ({ restaurantId, file }: { restaurantId: string; file: File }) => {\r\n      if (!user) throw new Error(\"Must be logged in\");\r\n\r\n      // Check current image count\r\n      const { data: existingImages, error: countError } = await supabase\r\n        .from(\"restaurant_dish_images\")\r\n        .select(\"id\")\r\n        .eq(\"restaurant_id\", restaurantId);\r\n\r\n      if (countError) throw countError;\r\n      if (existingImages && existingImages.length >= 10) {\r\n        throw new Error(\"MAX_IMAGES_REACHED\");\r\n      }\r\n\r\n      // Upload image\r\n      const fileExt = file.name.split(\".\").pop();\r\n      const fileName = `${restaurantId}/${Date.now()}-${Math.random().toString(36).substring(7)}.${fileExt}`;\r\n\r\n      const { error: uploadError } = await supabase.storage\r\n        .from(\"dish-images\")\r\n        .upload(fileName, file);\r\n\r\n      if (uploadError) throw uploadError;\r\n\r\n      // Get public URL\r\n      const { data: { publicUrl } } = supabase.storage\r\n        .from(\"dish-images\")\r\n        .getPublicUrl(fileName);\r\n\r\n      // Get next sort order\r\n      const nextSortOrder = existingImages ? existingImages.length : 0;\r\n\r\n      // Insert record\r\n      const { data, error: insertError } = await supabase\r\n        .from(\"restaurant_dish_images\")\r\n        .insert({\r\n          restaurant_id: restaurantId,\r\n          image_url: publicUrl,\r\n          sort_order: nextSortOrder,\r\n          created_by: user.id,\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (insertError) throw insertError;\r\n      return data;\r\n    },\r\n    onSuccess: (_, variables) => {\r\n      queryClient.invalidateQueries({ queryKey: [\"dish-images\", variables.restaurantId] });\r\n      toast.success(i18n.t(\"dishImages.uploadSuccess\"));\r\n    },\r\n    onError: (error: any) => {\r\n      if (error.message === \"MAX_IMAGES_REACHED\") {\r\n        toast.error(i18n.t(\"dishImages.maxImagesReached\"));\r\n      } else {\r\n        toast.error(i18n.t(\"dishImages.uploadFailed\"));\r\n      }\r\n    },\r\n  });\r\n};\r\n\r\nexport const useDeleteDishImage = () => {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: async ({ imageId, restaurantId, imageUrl }: { imageId: string; restaurantId: string; imageUrl: string }) => {\r\n      // Delete from storage\r\n      const urlParts = imageUrl.split(\"/dish-images/\");\r\n      if (urlParts[1]) {\r\n        await supabase.storage\r\n          .from(\"dish-images\")\r\n          .remove([urlParts[1]]);\r\n      }\r\n\r\n      // Delete record\r\n      const { error } = await supabase\r\n        .from(\"restaurant_dish_images\")\r\n        .delete()\r\n        .eq(\"id\", imageId);\r\n\r\n      if (error) throw error;\r\n      return { restaurantId };\r\n    },\r\n    onSuccess: (data) => {\r\n      queryClient.invalidateQueries({ queryKey: [\"dish-images\", data.restaurantId] });\r\n      toast.success(i18n.t(\"dishImages.deleteSuccess\"));\r\n    },\r\n    onError: () => {\r\n      toast.error(i18n.t(\"dishImages.deleteFailed\"));\r\n    },\r\n  });\r\n};\r\n\r\nexport const useReorderDishImages = () => {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: async ({ images, restaurantId }: { images: { id: string; sort_order: number }[]; restaurantId: string }) => {\r\n      const updates = images.map(img => \r\n        supabase\r\n          .from(\"restaurant_dish_images\")\r\n          .update({ sort_order: img.sort_order })\r\n          .eq(\"id\", img.id)\r\n      );\r\n\r\n      await Promise.all(updates);\r\n      return { restaurantId };\r\n    },\r\n    onSuccess: (data) => {\r\n      queryClient.invalidateQueries({ queryKey: [\"dish-images\", data.restaurantId] });\r\n    },\r\n  });\r\n};\r\n","import { useState, useRef } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Upload, X, Loader2, ImageIcon, GripVertical } from \"lucide-react\";\r\nimport { useDishImages, useAddDishImage, useDeleteDishImage, useReorderDishImages, DishImage } from \"@/hooks/useDishImages\";\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n} from \"@/components/ui/alert-dialog\";\r\nimport {\r\n  DndContext,\r\n  closestCenter,\r\n  KeyboardSensor,\r\n  PointerSensor,\r\n  useSensor,\r\n  useSensors,\r\n  DragEndEvent,\r\n} from \"@dnd-kit/core\";\r\nimport {\r\n  arrayMove,\r\n  SortableContext,\r\n  sortableKeyboardCoordinates,\r\n  useSortable,\r\n  rectSortingStrategy,\r\n} from \"@dnd-kit/sortable\";\r\nimport { CSS } from \"@dnd-kit/utilities\";\r\n\r\ninterface DishImageManagerProps {\r\n  restaurantId: string;\r\n}\r\n\r\ninterface SortableImageProps {\r\n  image: DishImage;\r\n  index: number;\r\n  onDelete: (id: string, url: string) => void;\r\n}\r\n\r\nfunction SortableImage({ image, index, onDelete }: SortableImageProps) {\r\n  const {\r\n    attributes,\r\n    listeners,\r\n    setNodeRef,\r\n    transform,\r\n    transition,\r\n    isDragging,\r\n  } = useSortable({ id: image.id });\r\n\r\n  const style = {\r\n    transform: CSS.Transform.toString(transform),\r\n    transition,\r\n    zIndex: isDragging ? 10 : 1,\r\n    opacity: isDragging ? 0.8 : 1,\r\n  };\r\n\r\n  return (\r\n    <div\r\n      ref={setNodeRef}\r\n      style={style}\r\n      className={`relative group aspect-square rounded-lg overflow-hidden border ${\r\n        isDragging ? \"ring-2 ring-primary shadow-lg\" : \"\"\r\n      }`}\r\n    >\r\n      {/* Drag Handle */}\r\n      <div\r\n        {...attributes}\r\n        {...listeners}\r\n        className=\"absolute top-1 left-1 z-10 p-1 bg-black/60 rounded cursor-grab active:cursor-grabbing opacity-0 group-hover:opacity-100 transition-opacity\"\r\n      >\r\n        <GripVertical className=\"w-4 h-4 text-white\" />\r\n      </div>\r\n\r\n      <img\r\n        src={image.image_url}\r\n        alt={`Dish ${index + 1}`}\r\n        className=\"w-full h-full object-cover\"\r\n        draggable={false}\r\n      />\r\n      \r\n      <div className=\"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center\">\r\n        <Button\r\n          type=\"button\"\r\n          variant=\"destructive\"\r\n          size=\"icon\"\r\n          className=\"h-8 w-8\"\r\n          onClick={(e) => {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            onDelete(image.id, image.image_url);\r\n          }}\r\n        >\r\n          <X className=\"w-4 h-4\" />\r\n        </Button>\r\n      </div>\r\n      \r\n      <div className=\"absolute bottom-1 right-1 bg-black/60 text-white text-xs px-1.5 py-0.5 rounded\">\r\n        {index + 1}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport function DishImageManager({ restaurantId }: DishImageManagerProps) {\r\n  const { t } = useTranslation();\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n  const { data: images = [], isLoading } = useDishImages(restaurantId);\r\n  const addImage = useAddDishImage();\r\n  const deleteImage = useDeleteDishImage();\r\n  const reorderImages = useReorderDishImages();\r\n  const [deleteConfirm, setDeleteConfirm] = useState<{ id: string; url: string } | null>(null);\r\n  const [localImages, setLocalImages] = useState<DishImage[]>([]);\r\n  const [isDeleting, setIsDeleting] = useState(false);\r\n\r\n  // Sync local state with fetched images\r\n  const displayImages = localImages.length > 0 ? localImages : images;\r\n\r\n  const sensors = useSensors(\r\n    useSensor(PointerSensor, {\r\n      activationConstraint: {\r\n        distance: 8,\r\n      },\r\n    }),\r\n    useSensor(KeyboardSensor, {\r\n      coordinateGetter: sortableKeyboardCoordinates,\r\n    })\r\n  );\r\n\r\n  const handleDragEnd = (event: DragEndEvent) => {\r\n    const { active, over } = event;\r\n\r\n    if (over && active.id !== over.id) {\r\n      const oldIndex = displayImages.findIndex((img) => img.id === active.id);\r\n      const newIndex = displayImages.findIndex((img) => img.id === over.id);\r\n\r\n      const newOrder = arrayMove(displayImages, oldIndex, newIndex);\r\n      setLocalImages(newOrder);\r\n\r\n      // Update sort orders in database\r\n      const updates = newOrder.map((img, idx) => ({\r\n        id: img.id,\r\n        sort_order: idx,\r\n      }));\r\n\r\n      reorderImages.mutate(\r\n        { images: updates, restaurantId },\r\n        {\r\n          onSuccess: () => {\r\n            setLocalImages([]);\r\n          },\r\n          onError: () => {\r\n            setLocalImages([]);\r\n          },\r\n        }\r\n      );\r\n    }\r\n  };\r\n\r\n  const handleFileSelect = async (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (!file) return;\r\n\r\n    if (file.size > 5 * 1024 * 1024) {\r\n      return;\r\n    }\r\n\r\n    if (!file.type.startsWith(\"image/\")) {\r\n      return;\r\n    }\r\n\r\n    await addImage.mutateAsync({ restaurantId, file });\r\n    \r\n    if (fileInputRef.current) {\r\n      fileInputRef.current.value = \"\";\r\n    }\r\n  };\r\n\r\n  const handleDeleteClick = (id: string, url: string) => {\r\n    setDeleteConfirm({ id, url });\r\n  };\r\n\r\n  const handleDeleteConfirm = async () => {\r\n    if (!deleteConfirm || isDeleting) return;\r\n    \r\n    const { id, url } = deleteConfirm;\r\n    setIsDeleting(true);\r\n    \r\n    try {\r\n      await deleteImage.mutateAsync({\r\n        imageId: id,\r\n        restaurantId,\r\n        imageUrl: url,\r\n      });\r\n      // Only close dialog after successful deletion\r\n      setDeleteConfirm(null);\r\n    } catch (error) {\r\n      console.error(\"Delete failed:\", error);\r\n    } finally {\r\n      setIsDeleting(false);\r\n    }\r\n  };\r\n\r\n  const handleDialogClose = (open: boolean) => {\r\n    // Only allow closing if not currently deleting\r\n    if (!open && !isDeleting) {\r\n      setDeleteConfirm(null);\r\n    }\r\n  };\r\n\r\n  const canAddMore = displayImages.length < 10;\r\n\r\n  return (\r\n    <Card>\r\n      <CardHeader className=\"pb-3\">\r\n        <CardTitle className=\"text-lg flex items-center gap-2\">\r\n          <ImageIcon className=\"w-5 h-5\" />\r\n          {t(\"dishImages.title\")}\r\n        </CardTitle>\r\n        <CardDescription>\r\n          {t(\"dishImages.description\", { current: displayImages.length, max: 10 })}\r\n          {displayImages.length > 1 && (\r\n            <span className=\"block mt-1 text-xs\">\r\n              {t(\"dishImages.dragToReorder\")}\r\n            </span>\r\n          )}\r\n        </CardDescription>\r\n      </CardHeader>\r\n      <CardContent>\r\n        {isLoading ? (\r\n          <div className=\"flex items-center justify-center py-8\">\r\n            <Loader2 className=\"w-6 h-6 animate-spin\" />\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-4\">\r\n            {/* Image Grid with Drag and Drop */}\r\n            {displayImages.length > 0 && (\r\n              <DndContext\r\n                sensors={sensors}\r\n                collisionDetection={closestCenter}\r\n                onDragEnd={handleDragEnd}\r\n              >\r\n                <SortableContext\r\n                  items={displayImages.map((img) => img.id)}\r\n                  strategy={rectSortingStrategy}\r\n                >\r\n                  <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3\">\r\n                    {displayImages.map((image, index) => (\r\n                      <SortableImage\r\n                        key={image.id}\r\n                        image={image}\r\n                        index={index}\r\n                        onDelete={(id, url) => setDeleteConfirm({ id, url })}\r\n                      />\r\n                    ))}\r\n                  </div>\r\n                </SortableContext>\r\n              </DndContext>\r\n            )}\r\n\r\n            {/* Upload Button */}\r\n            {canAddMore && (\r\n              <div>\r\n                <input\r\n                  ref={fileInputRef}\r\n                  type=\"file\"\r\n                  accept=\"image/*\"\r\n                  className=\"hidden\"\r\n                  onChange={handleFileSelect}\r\n                  disabled={addImage.isPending}\r\n                />\r\n                <Button\r\n                  type=\"button\"\r\n                  variant=\"outline\"\r\n                  className=\"w-full\"\r\n                  onClick={() => fileInputRef.current?.click()}\r\n                  disabled={addImage.isPending}\r\n                >\r\n                  {addImage.isPending ? (\r\n                    <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\r\n                  ) : (\r\n                    <Upload className=\"w-4 h-4 mr-2\" />\r\n                  )}\r\n                  {t(\"dishImages.upload\")}\r\n                </Button>\r\n              </div>\r\n            )}\r\n\r\n            {!canAddMore && (\r\n              <p className=\"text-sm text-muted-foreground text-center\">\r\n                {t(\"dishImages.maxReached\")}\r\n              </p>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Delete Confirmation - Rendered in portal to avoid form interference */}\r\n        <AlertDialog open={!!deleteConfirm} onOpenChange={handleDialogClose}>\r\n          <AlertDialogContent \r\n            onClick={(e) => e.stopPropagation()}\r\n            onKeyDown={(e) => {\r\n              if (e.key === 'Enter') {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n              }\r\n            }}\r\n          >\r\n            <form onSubmit={(e) => e.preventDefault()}>\r\n              <AlertDialogHeader>\r\n                <AlertDialogTitle>{t(\"dishImages.deleteConfirmTitle\")}</AlertDialogTitle>\r\n                <AlertDialogDescription>\r\n                  {t(\"dishImages.deleteConfirmDescription\")}\r\n                </AlertDialogDescription>\r\n              </AlertDialogHeader>\r\n              <AlertDialogFooter className=\"mt-4\">\r\n                <Button\r\n                  type=\"button\"\r\n                  variant=\"outline\"\r\n                  onClick={(e) => {\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    if (!isDeleting) {\r\n                      setDeleteConfirm(null);\r\n                    }\r\n                  }}\r\n                  disabled={isDeleting}\r\n                >\r\n                  {t(\"common.cancel\")}\r\n                </Button>\r\n                <Button\r\n                  type=\"button\"\r\n                  variant=\"destructive\"\r\n                  onClick={(e) => {\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    handleDeleteConfirm();\r\n                  }}\r\n                  disabled={isDeleting}\r\n                >\r\n                  {isDeleting ? <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" /> : null}\r\n                  {t(\"common.delete\")}\r\n                </Button>\r\n              </AlertDialogFooter>\r\n            </form>\r\n          </AlertDialogContent>\r\n        </AlertDialog>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}\r\n","import { useState, useEffect, useRef } from \"react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { zodResolver } from \"@hookform/resolvers/zod\";\r\nimport * as z from \"zod\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport mapboxgl from \"mapbox-gl\";\r\nimport \"mapbox-gl/dist/mapbox-gl.css\";\r\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Checkbox } from \"@/components/ui/checkbox\";\r\nimport { Switch } from \"@/components/ui/switch\";\r\nimport { Upload, X, MapPin, Globe, Store, Clock, Phone, Globe as WebIcon, Key, ImageIcon } from \"lucide-react\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\r\nimport { Card, CardContent } from \"@/components/ui/card\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { useToast } from \"@/hooks/use-toast\";\r\nimport { useQueryClient } from \"@tanstack/react-query\";\r\nimport { useUserRole } from \"@/hooks/useUserRole\";\r\nimport { DishImageManager } from \"@/components/admin/DishImageManager\";\r\nimport { RichTextEditor } from \"@/components/admin/RichTextEditor\";\r\nimport i18n from \"@/i18n/config\";\r\n\r\nconst restaurantSchema = z.object({\r\n  name: z.string().min(1, i18n.t(\"validation.nameRequired\")),\r\n  name_en: z.string().min(1, i18n.t(\"validation.nameRequired\")),\r\n  name_pt: z.string().min(1, i18n.t(\"validation.nameRequired\")),\r\n  key_id: z.string().optional(),\r\n  type: z.array(z.string()).min(1, i18n.t(\"validation.typeRequired\")).max(3, i18n.t(\"validation.typeMaximum\")),\r\n  type_en: z.array(z.string()).min(1, i18n.t(\"validation.typeRequired\")).max(3, i18n.t(\"validation.typeMaximum\")),\r\n  type_pt: z.array(z.string()).min(1, i18n.t(\"validation.typeRequired\")).max(3, i18n.t(\"validation.typeMaximum\")),\r\n  description: z.string().optional(),\r\n  description_en: z.string().optional(),\r\n  description_pt: z.string().optional(),\r\n  announcement_zh: z.string().optional(),\r\n  announcement_en: z.string().optional(),\r\n  announcement_pt: z.string().optional(),\r\n  address: z.string().min(1, i18n.t(\"validation.addressRequired\")),\r\n  lat: z.number(),\r\n  lng: z.number(),\r\n  phone: z.string().optional(),\r\n  website_url: z.string().optional(),\r\n  show_website_button: z.boolean().default(true),\r\n  show_dish_gallery: z.boolean().default(true),\r\n});\r\n\r\ntype RestaurantFormData = z.infer<typeof restaurantSchema>;\r\n\r\ninterface RestaurantFormDialogProps {\r\n  restaurant?: any;\r\n  trigger: React.ReactNode;\r\n}\r\n\r\ninterface DayHours {\r\n  open: string;\r\n  close: string;\r\n  closed: boolean;\r\n  splitShift?: boolean; // ÂàÜÊÆµËê•‰∏öÊ®°Âºè\r\n  open2?: string; // Á¨¨‰∫åÊó∂ÊÆµÂºÄÈó®Êó∂Èó¥\r\n  close2?: string; // Á¨¨‰∫åÊó∂ÊÆµÂÖ≥Èó®Êó∂Èó¥\r\n}\r\n\r\nconst DAYS = [\"monday\", \"tuesday\", \"wednesday\", \"thursday\", \"friday\", \"saturday\", \"sunday\"];\r\n\r\nexport function RestaurantFormDialog({ restaurant, trigger }: RestaurantFormDialogProps) {\r\n  const { t } = useTranslation();\r\n  const { toast } = useToast();\r\n  const queryClient = useQueryClient();\r\n  const { isAdmin } = useUserRole();\r\n  const [open, setOpen] = useState(false);\r\n  const [imageFile, setImageFile] = useState<File | null>(null);\r\n  const [imagePreview, setImagePreview] = useState<string | null>(restaurant?.image_url || null);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const mapContainer = useRef<HTMLDivElement>(null);\r\n  const map = useRef<mapboxgl.Map | null>(null);\r\n  const marker = useRef<mapboxgl.Marker | null>(null);\r\n  const [openingHours, setOpeningHours] = useState<Record<string, DayHours>>(() => {\r\n    const defaultHours: Record<string, DayHours> = {};\r\n    DAYS.forEach(day => {\r\n      defaultHours[day] = { \r\n        open: \"12:00\", \r\n        close: \"23:00\", \r\n        closed: false,\r\n        splitShift: false,\r\n        open2: \"19:00\",\r\n        close2: \"23:00\"\r\n      };\r\n    });\r\n    if (restaurant?.opening_hours) {\r\n      return { ...defaultHours, ...restaurant.opening_hours };\r\n    }\r\n    return defaultHours;\r\n  });\r\n  \r\n  // State for multiple types (1-3 tags)\r\n  const [types, setTypes] = useState<{ zh: string; en: string; pt: string }[]>(() => {\r\n    if (restaurant?.type && Array.isArray(restaurant.type)) {\r\n      return restaurant.type.map((zh: string, idx: number) => ({\r\n        zh,\r\n        en: restaurant.type_en?.[idx] || \"\",\r\n        pt: restaurant.type_pt?.[idx] || \"\",\r\n      }));\r\n    }\r\n    return [{ zh: \"\", en: \"\", pt: \"\" }];\r\n  });\r\n\r\n  const {\r\n    register,\r\n    handleSubmit,\r\n    formState: { errors },\r\n    setValue,\r\n    watch,\r\n  } = useForm<RestaurantFormData>({\r\n    resolver: zodResolver(restaurantSchema),\r\n    defaultValues: restaurant ? {\r\n      name: restaurant.name,\r\n      name_en: restaurant.name_en || \"\",\r\n      name_pt: restaurant.name_pt || \"\",\r\n      key_id: restaurant.key_id || \"\",\r\n      type: Array.isArray(restaurant.type) ? restaurant.type : [restaurant.type],\r\n      type_en: Array.isArray(restaurant.type_en) ? restaurant.type_en : (restaurant.type_en ? [restaurant.type_en] : [\"\"]),\r\n      type_pt: Array.isArray(restaurant.type_pt) ? restaurant.type_pt : (restaurant.type_pt ? [restaurant.type_pt] : [\"\"]),\r\n      description: restaurant.description || \"\",\r\n      description_en: restaurant.description_en || \"\",\r\n      description_pt: restaurant.description_pt || \"\",\r\n      announcement_zh: restaurant.announcement_zh || \"\",\r\n      announcement_en: restaurant.announcement_en || \"\",\r\n      announcement_pt: restaurant.announcement_pt || \"\",\r\n      address: restaurant.address,\r\n      lat: typeof restaurant.lat === 'number' && !isNaN(restaurant.lat) ? restaurant.lat : 38.7223,\r\n      lng: typeof restaurant.lng === 'number' && !isNaN(restaurant.lng) ? restaurant.lng : -9.1393,\r\n      phone: restaurant.phone || \"\",\r\n      website_url: restaurant.website_url || \"\",\r\n      show_website_button: restaurant.show_website_button ?? true,\r\n      show_dish_gallery: restaurant.show_dish_gallery ?? true,\r\n    } : {\r\n      name: \"\",\r\n      name_en: \"\",\r\n      name_pt: \"\",\r\n      key_id: \"\",\r\n      type: [\"\"],\r\n      type_en: [\"\"],\r\n      type_pt: [\"\"],\r\n      description: \"\",\r\n      description_en: \"\",\r\n      description_pt: \"\",\r\n      announcement_zh: \"\",\r\n      announcement_en: \"\",\r\n      announcement_pt: \"\",\r\n      address: \"\",\r\n      lat: 38.7223,\r\n      lng: -9.1393,\r\n      phone: \"\",\r\n      website_url: \"\",\r\n      show_website_button: true,\r\n      show_dish_gallery: true,\r\n    },\r\n  });\r\n  \r\n  const addType = () => {\r\n    if (types.length < 3) {\r\n      setTypes([...types, { zh: \"\", en: \"\", pt: \"\" }]);\r\n    }\r\n  };\r\n  \r\n  const removeType = (index: number) => {\r\n    if (types.length > 1) {\r\n      setTypes(types.filter((_, i) => i !== index));\r\n    }\r\n  };\r\n  \r\n  const updateType = (index: number, field: 'zh' | 'en' | 'pt', value: string) => {\r\n    const newTypes = [...types];\r\n    newTypes[index][field] = value;\r\n    setTypes(newTypes);\r\n    \r\n    // Update form values\r\n    setValue('type', newTypes.map(t => t.zh).filter(Boolean));\r\n    setValue('type_en', newTypes.map(t => t.en).filter(Boolean));\r\n    setValue('type_pt', newTypes.map(t => t.pt).filter(Boolean));\r\n  };\r\n\r\n  const lat = watch(\"lat\");\r\n  const lng = watch(\"lng\");\r\n  const showWebsiteButton = watch(\"show_website_button\");\r\n  const showDishGallery = watch(\"show_dish_gallery\");\r\n\r\n  // Helper function to check if coordinates are valid\r\n  const isValidCoordinate = (lat: number, lng: number) => {\r\n    return typeof lat === 'number' && typeof lng === 'number' && \r\n           !isNaN(lat) && !isNaN(lng) && \r\n           isFinite(lat) && isFinite(lng);\r\n  };\r\n\r\n  // Initialize map when dialog opens\r\n  useEffect(() => {\r\n    if (!open) {\r\n      // Clean up map when dialog closes\r\n      if (map.current) {\r\n        map.current.remove();\r\n        map.current = null;\r\n        marker.current = null;\r\n      }\r\n      return;\r\n    }\r\n\r\n    // Don't initialize if already exists\r\n    if (map.current) return;\r\n\r\n    const mapboxToken = import.meta.env.VITE_MAPBOX_TOKEN;\r\n    if (!mapboxToken) {\r\n      console.error(\"Mapbox token not found\");\r\n      toast({\r\n        title: t(\"common.error\"),\r\n        description: \"Mapbox token not configured\",\r\n        variant: \"destructive\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    // Wait for container to be rendered\r\n    const initMap = () => {\r\n      if (!mapContainer.current) {\r\n        console.error(\"Map container not found\");\r\n        return;\r\n      }\r\n\r\n      try {\r\n        mapboxgl.accessToken = mapboxToken;\r\n\r\n        // Use valid coordinates or default to Lisbon\r\n        const centerLng = isValidCoordinate(lat, lng) ? lng : -9.1393;\r\n        const centerLat = isValidCoordinate(lat, lng) ? lat : 38.7223;\r\n\r\n        map.current = new mapboxgl.Map({\r\n          container: mapContainer.current,\r\n          style: \"mapbox://styles/mapbox/light-v11\",\r\n          center: [centerLng, centerLat],\r\n          zoom: 15,\r\n        });\r\n\r\n        // Disable scroll zoom by default (require Ctrl key)\r\n        map.current.scrollZoom.disable();\r\n\r\n        map.current.on('load', () => {\r\n          if (!map.current) return;\r\n          \r\n          // Add marker after map loads only if coordinates are valid\r\n          if (isValidCoordinate(lat, lng)) {\r\n            marker.current = new mapboxgl.Marker({ draggable: true })\r\n              .setLngLat([lng, lat])\r\n              .addTo(map.current);\r\n          }\r\n\r\n          marker.current.on(\"dragend\", () => {\r\n            const lngLat = marker.current!.getLngLat();\r\n            setValue(\"lng\", lngLat.lng);\r\n            setValue(\"lat\", lngLat.lat);\r\n          });\r\n\r\n          // Resize to fit container\r\n          setTimeout(() => {\r\n            map.current?.resize();\r\n          }, 100);\r\n        });\r\n\r\n        // Enable scroll zoom only when Ctrl key is pressed\r\n        const handleWheel = (e: WheelEvent) => {\r\n          if (e.ctrlKey || e.metaKey) {\r\n            map.current?.scrollZoom.enable();\r\n          } else {\r\n            map.current?.scrollZoom.disable();\r\n          }\r\n        };\r\n\r\n        mapContainer.current.addEventListener('wheel', handleWheel);\r\n\r\n        map.current.on(\"click\", (e) => {\r\n          const { lng, lat } = e.lngLat;\r\n          setValue(\"lng\", lng);\r\n          setValue(\"lat\", lat);\r\n          marker.current?.setLngLat([lng, lat]);\r\n        });\r\n\r\n        map.current.on('error', (e) => {\r\n          console.error(\"Map error:\", e);\r\n        });\r\n      } catch (error) {\r\n        console.error(\"Failed to initialize map:\", error);\r\n      }\r\n    };\r\n\r\n    // Give time for dialog animation and container to render\r\n    const timer = setTimeout(initMap, 500);\r\n\r\n    return () => {\r\n      clearTimeout(timer);\r\n    };\r\n  }, [open, lat, lng]);\r\n\r\n  // Update marker position when lat/lng changes\r\n  useEffect(() => {\r\n    if (marker.current && map.current && isValidCoordinate(lat, lng)) {\r\n      marker.current.setLngLat([lng, lat]);\r\n      map.current.setCenter([lng, lat]);\r\n    }\r\n  }, [lat, lng]);\r\n\r\n  const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (file) {\r\n      setImageFile(file);\r\n      const reader = new FileReader();\r\n      reader.onloadend = () => {\r\n        setImagePreview(reader.result as string);\r\n      };\r\n      reader.readAsDataURL(file);\r\n    }\r\n  };\r\n\r\n  const uploadImage = async (): Promise<string | null> => {\r\n    if (!imageFile) return restaurant?.image_url || null;\r\n\r\n    const fileExt = imageFile.name.split(\".\").pop();\r\n    const fileName = `${Math.random()}.${fileExt}`;\r\n    const filePath = `${fileName}`;\r\n\r\n    const { error: uploadError } = await supabase.storage\r\n      .from(\"restaurant-images\")\r\n      .upload(filePath, imageFile);\r\n\r\n    if (uploadError) {\r\n      throw uploadError;\r\n    }\r\n\r\n    const { data: { publicUrl } } = supabase.storage\r\n      .from(\"restaurant-images\")\r\n      .getPublicUrl(filePath);\r\n\r\n    return publicUrl;\r\n  };\r\n\r\n  const onSubmit = async (data: RestaurantFormData) => {\r\n    setIsSubmitting(true);\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (!user) throw new Error(\"Not authenticated\");\r\n\r\n      const imageUrl = await uploadImage();\r\n\r\n      const restaurantData = {\r\n        name: data.name,\r\n        name_en: data.name_en,\r\n        name_pt: data.name_pt,\r\n        key_id: data.key_id || null,\r\n        type: data.type,\r\n        type_en: data.type_en,\r\n        type_pt: data.type_pt,\r\n        description: data.description || null,\r\n        description_en: data.description_en || null,\r\n        description_pt: data.description_pt || null,\r\n        announcement_zh: data.announcement_zh || null,\r\n        announcement_en: data.announcement_en || null,\r\n        announcement_pt: data.announcement_pt || null,\r\n        address: data.address,\r\n        lat: data.lat,\r\n        lng: data.lng,\r\n        phone: data.phone || null,\r\n        website_url: data.website_url || null,\r\n        show_website_button: data.show_website_button,\r\n        show_dish_gallery: data.show_dish_gallery,\r\n        image_url: imageUrl,\r\n        opening_hours: openingHours as any,\r\n      };\r\n\r\n      if (restaurant) {\r\n        const { error } = await supabase\r\n          .from(\"restaurants\")\r\n          .update({ ...restaurantData, updated_by: user.id })\r\n          .eq(\"id\", restaurant.id);\r\n\r\n        if (error) throw error;\r\n\r\n        toast({\r\n          title: t(\"common.success\"),\r\n          description: t(\"admin.restaurantUpdated\"),\r\n        });\r\n      } else {\r\n        const { error } = await supabase\r\n          .from(\"restaurants\")\r\n          .insert([{ ...restaurantData, created_by: user.id }]);\r\n\r\n        if (error) throw error;\r\n\r\n        toast({\r\n          title: t(\"common.success\"),\r\n          description: t(\"admin.restaurantCreated\"),\r\n        });\r\n      }\r\n\r\n      queryClient.invalidateQueries({ queryKey: [\"restaurants\"] });\r\n      setOpen(false);\r\n    } catch (error: any) {\r\n      toast({\r\n        title: t(\"common.error\"),\r\n        description: error.message,\r\n        variant: \"destructive\",\r\n      });\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={setOpen}>\r\n      <DialogTrigger asChild>{trigger}</DialogTrigger>\r\n      <DialogContent className=\"max-w-[95vw] sm:max-w-6xl max-h-[95vh] overflow-hidden flex flex-col p-0\">\r\n        <DialogHeader className=\"px-6 pt-6 pb-4 border-b bg-muted/30\">\r\n          <DialogTitle className=\"text-2xl flex items-center gap-2\">\r\n            <Store className=\"w-6 h-6 text-primary\" />\r\n            {restaurant ? t(\"admin.editRestaurant\") : t(\"admin.addRestaurant\")}\r\n          </DialogTitle>\r\n          <DialogDescription className=\"text-base\">\r\n            {restaurant ? t(\"admin.editRestaurantDetails\") : t(\"admin.createRestaurantWithInfo\")}\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        <ScrollArea className=\"px-6 h-[calc(95vh-220px)]\">\r\n          <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-6 py-6\">\r\n            {/* Image Upload */}\r\n            <Card className=\"border-primary/20 bg-gradient-to-br from-background to-muted/20\">\r\n              <CardContent className=\"p-6\">\r\n                <Label className=\"text-base font-semibold flex items-center gap-2 mb-4\">\r\n                  <Upload className=\"w-5 h-5 text-primary\" />\r\n                  {t(\"admin.restaurantImage\")}\r\n                </Label>\r\n                <div className=\"flex items-center gap-6\">\r\n                  {imagePreview && (\r\n                    <div className=\"relative group\">\r\n                      <img\r\n                        src={imagePreview}\r\n                        alt=\"Preview\"\r\n                        className=\"w-40 h-40 object-cover rounded-lg shadow-lg ring-2 ring-primary/20 transition-transform duration-200 group-hover:scale-105\"\r\n                      />\r\n                      <Button\r\n                        type=\"button\"\r\n                        variant=\"destructive\"\r\n                        size=\"icon\"\r\n                        className=\"absolute -top-2 -right-2 h-8 w-8 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity\"\r\n                        onClick={() => {\r\n                          setImageFile(null);\r\n                          setImagePreview(null);\r\n                        }}\r\n                      >\r\n                        <X className=\"h-4 w-4\" />\r\n                      </Button>\r\n                    </div>\r\n                  )}\r\n                  <Label htmlFor=\"image-upload\" className=\"cursor-pointer\">\r\n                    <div className=\"flex flex-col items-center gap-3 px-8 py-6 border-2 border-dashed border-primary/30 rounded-lg hover:border-primary hover:bg-primary/5 transition-all duration-200\">\r\n                      <Upload className=\"h-8 w-8 text-primary\" />\r\n                      <div className=\"text-center\">\r\n                        <p className=\"font-medium text-sm\">{t(\"admin.uploadImage\")}</p>\r\n                        <p className=\"text-xs text-muted-foreground mt-1\">{t(\"admin.imageMaxSize\")}</p>\r\n                      </div>\r\n                    </div>\r\n                    <Input\r\n                      id=\"image-upload\"\r\n                      type=\"file\"\r\n                      accept=\"image/*\"\r\n                      className=\"hidden\"\r\n                      onChange={handleImageChange}\r\n                    />\r\n                  </Label>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Dish Images - Only show when editing existing restaurant */}\r\n            {restaurant?.id && (\r\n              <Card className=\"border-primary/20\">\r\n                <CardContent className=\"p-6\">\r\n                  <div className=\"flex items-center justify-between mb-4\">\r\n                    <Label className=\"text-base font-semibold flex items-center gap-2\">\r\n                      <ImageIcon className=\"w-5 h-5 text-primary\" />\r\n                      {t(\"admin.dishGallery\")}\r\n                    </Label>\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <Label htmlFor=\"show-dish-gallery\" className=\"text-sm text-muted-foreground\">\r\n                        {t(\"admin.showDishGallery\")}\r\n                      </Label>\r\n                      <Switch\r\n                        id=\"show-dish-gallery\"\r\n                        checked={showDishGallery}\r\n                        onCheckedChange={(checked) => setValue(\"show_dish_gallery\", checked)}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                  <DishImageManager restaurantId={restaurant.id} />\r\n                </CardContent>\r\n              </Card>\r\n            )}\r\n\r\n            {/* Multi-language Content with Tabs */}\r\n            <Card className=\"border-primary/20\">\r\n              <CardContent className=\"p-6\">\r\n                <Label className=\"text-base font-semibold flex items-center gap-2 mb-4\">\r\n                  <Globe className=\"w-5 h-5 text-primary\" />\r\n                  {t(\"admin.multilingualContent\")}\r\n                </Label>\r\n                <Tabs defaultValue=\"zh\" className=\"w-full\">\r\n                  <TabsList className=\"grid w-full grid-cols-3 mb-6\">\r\n                    <TabsTrigger value=\"zh\" className=\"gap-2\">\r\n                      üá®üá≥ {t(\"admin.chinese\")}\r\n                    </TabsTrigger>\r\n                    <TabsTrigger value=\"en\" className=\"gap-2\">\r\n                      üá¨üáß {t(\"admin.english\")}\r\n                    </TabsTrigger>\r\n                    <TabsTrigger value=\"pt\" className=\"gap-2\">\r\n                      üáµüáπ {t(\"admin.portuguese\")}\r\n                    </TabsTrigger>\r\n                  </TabsList>\r\n                  \r\n                  <TabsContent value=\"zh\" className=\"space-y-4 mt-0\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"name\" className=\"text-sm font-medium\">{t(\"admin.restaurantName\")}</Label>\r\n                      <Input \r\n                        id=\"name\" \r\n                        {...register(\"name\")} \r\n                        placeholder={t(\"admin.enterRestaurantName\")}\r\n                        className=\"text-base\"\r\n                      />\r\n                      {errors.name && (\r\n                        <p className=\"text-sm text-destructive\">{errors.name.message}</p>\r\n                      )}\r\n                    </div>\r\n                    <div className=\"space-y-3\">\r\n                      <div className=\"flex justify-between items-center\">\r\n                        <Label className=\"text-sm font-medium\">{t(\"admin.restaurantType\")}</Label>\r\n                        {types.length < 3 && (\r\n                          <Button type=\"button\" variant=\"outline\" size=\"sm\" onClick={addType}>\r\n                            {t(\"admin.addType\")}\r\n                          </Button>\r\n                        )}\r\n                      </div>\r\n                      {types.map((type, index) => (\r\n                        <div key={index} className=\"flex gap-2 items-center\">\r\n                          <Input\r\n                            placeholder={t(\"admin.typeExample\")}\r\n                            value={type.zh}\r\n                            onChange={(e) => updateType(index, 'zh', e.target.value)}\r\n                          />\r\n                          <Button\r\n                            type=\"button\"\r\n                            variant=\"ghost\"\r\n                            size=\"icon\"\r\n                            onClick={() => removeType(index)}\r\n                            disabled={types.length === 1}\r\n                          >\r\n                            <X className=\"h-4 w-4\" />\r\n                          </Button>\r\n                        </div>\r\n                      ))}\r\n                      {errors.type && (\r\n                        <p className=\"text-sm text-destructive\">{errors.type.message}</p>\r\n                      )}\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"description\" className=\"text-sm font-medium\">{t(\"admin.description\")}</Label>\r\n                      <RichTextEditor\r\n                        value={watch(\"description\") || \"\"}\r\n                        onChange={(value) => setValue(\"description\", value)}\r\n                        placeholder={t(\"admin.enterDescription\")}\r\n                      />\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"announcement_zh\" className=\"text-sm font-medium\">{t(\"admin.announcement\")}</Label>\r\n                      <Textarea \r\n                        id=\"announcement_zh\" \r\n                        {...register(\"announcement_zh\")} \r\n                        rows={2}\r\n                        placeholder={t(\"admin.enterAnnouncement\")}\r\n                      />\r\n                      <p className=\"text-xs text-muted-foreground\">{t(\"admin.announcementHint\")}</p>\r\n                    </div>\r\n                  </TabsContent>\r\n                  \r\n                  <TabsContent value=\"en\" className=\"space-y-4 mt-0\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"name_en\" className=\"text-sm font-medium\">Restaurant Name</Label>\r\n                      <Input \r\n                        id=\"name_en\" \r\n                        {...register(\"name_en\")} \r\n                        placeholder=\"Enter restaurant name...\"\r\n                        className=\"text-base\"\r\n                      />\r\n                      {errors.name_en && (\r\n                        <p className=\"text-sm text-destructive\">{errors.name_en.message}</p>\r\n                      )}\r\n                    </div>\r\n                    <div className=\"space-y-3\">\r\n                      <Label className=\"text-sm font-medium\">Restaurant Types (1-3 tags)</Label>\r\n                      {types.map((type, index) => (\r\n                        <div key={index} className=\"flex gap-2 items-center\">\r\n                          <Input\r\n                            placeholder=\"e.g. Cantonese\"\r\n                            value={type.en}\r\n                            onChange={(e) => updateType(index, 'en', e.target.value)}\r\n                          />\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"description_en\" className=\"text-sm font-medium\">Description</Label>\r\n                      <RichTextEditor\r\n                        value={watch(\"description_en\") || \"\"}\r\n                        onChange={(value) => setValue(\"description_en\", value)}\r\n                        placeholder=\"Enter restaurant description...\"\r\n                      />\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"announcement_en\" className=\"text-sm font-medium\">Announcement</Label>\r\n                      <Textarea \r\n                        id=\"announcement_en\" \r\n                        {...register(\"announcement_en\")} \r\n                        rows={2}\r\n                        placeholder=\"Enter announcement (optional)...\"\r\n                      />\r\n                      <p className=\"text-xs text-muted-foreground\">Display important notices at top of restaurant page</p>\r\n                    </div>\r\n                  </TabsContent>\r\n                  \r\n                  <TabsContent value=\"pt\" className=\"space-y-4 mt-0\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"name_pt\" className=\"text-sm font-medium\">Nome do Restaurante</Label>\r\n                      <Input \r\n                        id=\"name_pt\" \r\n                        {...register(\"name_pt\")} \r\n                        placeholder=\"Digite o nome do restaurante...\"\r\n                        className=\"text-base\"\r\n                      />\r\n                      {errors.name_pt && (\r\n                        <p className=\"text-sm text-destructive\">{errors.name_pt.message}</p>\r\n                      )}\r\n                    </div>\r\n                    <div className=\"space-y-3\">\r\n                      <Label className=\"text-sm font-medium\">Tipos de Restaurante (1-3 tags)</Label>\r\n                      {types.map((type, index) => (\r\n                        <div key={index} className=\"flex gap-2 items-center\">\r\n                          <Input\r\n                            placeholder=\"ex: Cantonesa\"\r\n                            value={type.pt}\r\n                            onChange={(e) => updateType(index, 'pt', e.target.value)}\r\n                          />\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"description_pt\" className=\"text-sm font-medium\">Descri√ß√£o</Label>\r\n                      <RichTextEditor\r\n                        value={watch(\"description_pt\") || \"\"}\r\n                        onChange={(value) => setValue(\"description_pt\", value)}\r\n                        placeholder=\"Digite a descri√ß√£o do restaurante...\"\r\n                      />\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"announcement_pt\" className=\"text-sm font-medium\">An√∫ncio</Label>\r\n                      <Textarea \r\n                        id=\"announcement_pt\" \r\n                        {...register(\"announcement_pt\")} \r\n                        rows={2}\r\n                        placeholder=\"Digite o an√∫ncio (opcional)...\"\r\n                      />\r\n                      <p className=\"text-xs text-muted-foreground\">Exibir avisos importantes no topo da p√°gina do restaurante</p>\r\n                    </div>\r\n                  </TabsContent>\r\n                </Tabs>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Location and Contact */}\r\n            <Card className=\"border-primary/20\">\r\n              <CardContent className=\"p-6 space-y-4\">\r\n                <Label className=\"text-base font-semibold flex items-center gap-2\">\r\n                  <MapPin className=\"w-5 h-5 text-primary\" />\r\n                  {t(\"admin.locationAndContact\")}\r\n                </Label>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"address\" className=\"text-sm font-medium flex items-center gap-2\">\r\n                      <MapPin className=\"w-4 h-4\" />\r\n                      {t(\"admin.address\")}\r\n                    </Label>\r\n                    <Input id=\"address\" {...register(\"address\")} placeholder={t(\"admin.enterAddress\")} />\r\n                    {errors.address && (\r\n                      <p className=\"text-sm text-destructive\">{errors.address.message}</p>\r\n                    )}\r\n                  </div>\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"phone\" className=\"text-sm font-medium flex items-center gap-2\">\r\n                      <Phone className=\"w-4 h-4\" />\r\n                      {t(\"admin.phone\")}\r\n                    </Label>\r\n                    <Input id=\"phone\" {...register(\"phone\")} placeholder=\"+351...\" />\r\n                  </div>\r\n                </div>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"website_url\" className=\"text-sm font-medium flex items-center gap-2\">\r\n                      <WebIcon className=\"w-4 h-4\" />\r\n                      {t(\"admin.website\")}\r\n                    </Label>\r\n                    <Input \r\n                      id=\"website_url\" \r\n                      {...register(\"website_url\")} \r\n                      placeholder=\"https://\" \r\n                      readOnly={!isAdmin}\r\n                      disabled={!isAdmin}\r\n                      className={!isAdmin ? \"bg-muted cursor-not-allowed\" : \"\"}\r\n                    />\r\n                    {!isAdmin && (\r\n                      <p className=\"text-xs text-muted-foreground\">{t(\"admin.websiteReadOnly\")}</p>\r\n                    )}\r\n                  </div>\r\n                  {isAdmin && (\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"key_id\" className=\"text-sm font-medium flex items-center gap-2\">\r\n                        <Key className=\"w-4 h-4\" />\r\n                        Key ID (API)\r\n                      </Label>\r\n                      <Input \r\n                        id=\"key_id\" \r\n                        {...register(\"key_id\")} \r\n                        placeholder=\"‰æãÂ¶Ç: saldanha01\" \r\n                      />\r\n                    </div>\r\n                  )}\r\n                  <div className=\"flex items-center space-x-2 pt-8\">\r\n                    <Checkbox\r\n                      id=\"show_website_button\"\r\n                      checked={showWebsiteButton}\r\n                      onCheckedChange={(checked) => setValue(\"show_website_button\", checked as boolean)}\r\n                    />\r\n                    <Label htmlFor=\"show_website_button\" className=\"cursor-pointer text-sm\">\r\n                      {t(\"admin.showWebsiteButton\")}\r\n                    </Label>\r\n                  </div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Map Location */}\r\n            <Card className=\"border-primary/20\">\r\n              <CardContent className=\"p-6 space-y-4\">\r\n                <Label className=\"text-base font-semibold flex items-center gap-2\">\r\n                  <MapPin className=\"w-5 h-5 text-primary\" />\r\n                  {t(\"admin.location\")}\r\n                </Label>\r\n                <div className=\"grid grid-cols-2 gap-4 mb-2\">\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"lat\" className=\"text-sm font-medium\">{t(\"admin.latitude\")}</Label>\r\n                    <Input\r\n                      id=\"lat\"\r\n                      type=\"number\"\r\n                      step=\"any\"\r\n                      {...register(\"lat\", { valueAsNumber: true })}\r\n                    />\r\n                  </div>\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"lng\" className=\"text-sm font-medium\">{t(\"admin.longitude\")}</Label>\r\n                    <Input\r\n                      id=\"lng\"\r\n                      type=\"number\"\r\n                      step=\"any\"\r\n                      {...register(\"lng\", { valueAsNumber: true })}\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div ref={mapContainer} className=\"h-96 w-full rounded-lg border-2 border-primary/20 shadow-sm\" style={{ minHeight: '384px' }} />\r\n                <p className=\"text-sm text-muted-foreground flex items-center gap-2\">\r\n                  <MapPin className=\"w-4 h-4\" />\r\n                  {t(\"admin.clickOrDragToSetLocation\")}\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Opening Hours */}\r\n            <Card className=\"border-primary/20 overflow-hidden\">\r\n              <CardContent className=\"p-3 md:p-6 space-y-4\">\r\n                <Label className=\"text-base font-semibold flex items-center gap-2\">\r\n                  <Clock className=\"w-5 h-5 text-primary\" />\r\n                  {t(\"admin.openingHours\")}\r\n                </Label>\r\n                <div className=\"space-y-2\">\r\n                  {DAYS.map((day) => (\r\n                    <div key={day} className=\"space-y-2 p-2 md:p-3 rounded-lg hover:bg-muted/50 transition-colors\">\r\n                      {/* Mobile Layout */}\r\n                      <div className=\"md:hidden space-y-2\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                          <Label className=\"capitalize font-semibold text-sm\">{t(`admin.day.${day}`)}</Label>\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <div className=\"flex items-center gap-1\">\r\n                              <Checkbox\r\n                                id={`split-mobile-${day}`}\r\n                                checked={openingHours[day].splitShift}\r\n                                onCheckedChange={(checked) =>\r\n                                  setOpeningHours({\r\n                                    ...openingHours,\r\n                                    [day]: { ...openingHours[day], splitShift: checked as boolean },\r\n                                  })\r\n                                }\r\n                                disabled={openingHours[day].closed}\r\n                                className=\"h-4 w-4\"\r\n                              />\r\n                              <Label htmlFor={`split-mobile-${day}`} className=\"cursor-pointer text-xs\">\r\n                                ÂàÜÊÆµ\r\n                              </Label>\r\n                            </div>\r\n                            <div className=\"flex items-center gap-1\">\r\n                              <Checkbox\r\n                                id={`closed-mobile-${day}`}\r\n                                checked={openingHours[day].closed}\r\n                                onCheckedChange={(checked) =>\r\n                                  setOpeningHours({\r\n                                    ...openingHours,\r\n                                    [day]: { ...openingHours[day], closed: checked as boolean },\r\n                                  })\r\n                                }\r\n                                className=\"h-4 w-4\"\r\n                              />\r\n                              <Label htmlFor={`closed-mobile-${day}`} className=\"cursor-pointer text-xs\">\r\n                                {t(\"admin.closed\")}\r\n                              </Label>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        \r\n                        {!openingHours[day].closed && (\r\n                          <div className=\"space-y-1.5\">\r\n                            {openingHours[day].splitShift ? (\r\n                              <div className=\"space-y-1.5\">\r\n                                <div className=\"grid grid-cols-[32px_1fr_12px_1fr] gap-1 items-center\">\r\n                                  <span className=\"text-xs text-muted-foreground\">ÂçàÈ§ê</span>\r\n                                  <Input\r\n                                    type=\"time\"\r\n                                    value={openingHours[day].open}\r\n                                    onChange={(e) =>\r\n                                      setOpeningHours({\r\n                                        ...openingHours,\r\n                                        [day]: { ...openingHours[day], open: e.target.value },\r\n                                      })\r\n                                    }\r\n                                    className=\"h-8 text-xs px-2 min-w-0\"\r\n                                  />\r\n                                  <span className=\"text-muted-foreground text-xs text-center\">-</span>\r\n                                  <Input\r\n                                    type=\"time\"\r\n                                    value={openingHours[day].close}\r\n                                    onChange={(e) =>\r\n                                      setOpeningHours({\r\n                                        ...openingHours,\r\n                                        [day]: { ...openingHours[day], close: e.target.value },\r\n                                      })\r\n                                    }\r\n                                    className=\"h-8 text-xs px-2 min-w-0\"\r\n                                  />\r\n                                </div>\r\n                                <div className=\"grid grid-cols-[32px_1fr_12px_1fr] gap-1 items-center\">\r\n                                  <span className=\"text-xs text-muted-foreground\">ÊôöÈ§ê</span>\r\n                                  <Input\r\n                                    type=\"time\"\r\n                                    value={openingHours[day].open2 || \"19:00\"}\r\n                                    onChange={(e) =>\r\n                                      setOpeningHours({\r\n                                        ...openingHours,\r\n                                        [day]: { ...openingHours[day], open2: e.target.value },\r\n                                      })\r\n                                    }\r\n                                    className=\"h-8 text-xs px-2 min-w-0\"\r\n                                  />\r\n                                  <span className=\"text-muted-foreground text-xs text-center\">-</span>\r\n                                  <Input\r\n                                    type=\"time\"\r\n                                    value={openingHours[day].close2 || \"23:00\"}\r\n                                    onChange={(e) =>\r\n                                      setOpeningHours({\r\n                                        ...openingHours,\r\n                                        [day]: { ...openingHours[day], close2: e.target.value },\r\n                                      })\r\n                                    }\r\n                                    className=\"h-8 text-xs px-2 min-w-0\"\r\n                                  />\r\n                                </div>\r\n                              </div>\r\n                            ) : (\r\n                              <div className=\"grid grid-cols-[1fr_12px_1fr] gap-1 items-center\">\r\n                                <Input\r\n                                  type=\"time\"\r\n                                  value={openingHours[day].open}\r\n                                  onChange={(e) =>\r\n                                    setOpeningHours({\r\n                                      ...openingHours,\r\n                                      [day]: { ...openingHours[day], open: e.target.value },\r\n                                    })\r\n                                  }\r\n                                  className=\"h-8 text-xs px-2 min-w-0\"\r\n                                />\r\n                                <span className=\"text-muted-foreground text-xs text-center\">-</span>\r\n                                <Input\r\n                                  type=\"time\"\r\n                                  value={openingHours[day].close}\r\n                                  onChange={(e) =>\r\n                                    setOpeningHours({\r\n                                      ...openingHours,\r\n                                      [day]: { ...openingHours[day], close: e.target.value },\r\n                                    })\r\n                                  }\r\n                                  className=\"h-8 text-xs px-2 min-w-0\"\r\n                                />\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n\r\n                      {/* Desktop Layout */}\r\n                      <div className=\"hidden md:block\">\r\n                        <div className=\"grid grid-cols-[120px_1fr_auto] gap-4 items-center\">\r\n                          <Label className=\"capitalize font-semibold\">{t(`admin.day.${day}`)}</Label>\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <Checkbox\r\n                              id={`split-${day}`}\r\n                              checked={openingHours[day].splitShift}\r\n                              onCheckedChange={(checked) =>\r\n                                setOpeningHours({\r\n                                  ...openingHours,\r\n                                  [day]: { ...openingHours[day], splitShift: checked as boolean },\r\n                                })\r\n                              }\r\n                              disabled={openingHours[day].closed}\r\n                            />\r\n                            <Label htmlFor={`split-${day}`} className=\"cursor-pointer text-sm\">\r\n                              ÂàÜÊÆµËê•‰∏ö\r\n                            </Label>\r\n                          </div>\r\n                          <div className=\"flex items-center space-x-2\">\r\n                            <Checkbox\r\n                              id={`closed-${day}`}\r\n                              checked={openingHours[day].closed}\r\n                              onCheckedChange={(checked) =>\r\n                                setOpeningHours({\r\n                                  ...openingHours,\r\n                                  [day]: { ...openingHours[day], closed: checked as boolean },\r\n                                })\r\n                              }\r\n                            />\r\n                            <Label htmlFor={`closed-${day}`} className=\"cursor-pointer\">\r\n                              {t(\"admin.closed\")}\r\n                            </Label>\r\n                          </div>\r\n                        </div>\r\n                        \r\n                        {!openingHours[day].closed && (\r\n                          <div className=\"ml-[120px] space-y-2 mt-2\">\r\n                            {openingHours[day].splitShift ? (\r\n                              <div className=\"space-y-2\">\r\n                                <div className=\"flex items-center gap-2\">\r\n                                  <span className=\"text-sm text-muted-foreground w-12\">ÂçàÈ§ê</span>\r\n                                  <Input\r\n                                    type=\"time\"\r\n                                    value={openingHours[day].open}\r\n                                    onChange={(e) =>\r\n                                      setOpeningHours({\r\n                                        ...openingHours,\r\n                                        [day]: { ...openingHours[day], open: e.target.value },\r\n                                      })\r\n                                    }\r\n                                    className=\"w-32\"\r\n                                  />\r\n                                  <span className=\"text-muted-foreground\">-</span>\r\n                                  <Input\r\n                                    type=\"time\"\r\n                                    value={openingHours[day].close}\r\n                                    onChange={(e) =>\r\n                                      setOpeningHours({\r\n                                        ...openingHours,\r\n                                        [day]: { ...openingHours[day], close: e.target.value },\r\n                                      })\r\n                                    }\r\n                                    className=\"w-32\"\r\n                                  />\r\n                                </div>\r\n                                <div className=\"flex items-center gap-2\">\r\n                                  <span className=\"text-sm text-muted-foreground w-12\">ÊôöÈ§ê</span>\r\n                                  <Input\r\n                                    type=\"time\"\r\n                                    value={openingHours[day].open2 || \"19:00\"}\r\n                                    onChange={(e) =>\r\n                                      setOpeningHours({\r\n                                        ...openingHours,\r\n                                        [day]: { ...openingHours[day], open2: e.target.value },\r\n                                      })\r\n                                    }\r\n                                    className=\"w-32\"\r\n                                  />\r\n                                  <span className=\"text-muted-foreground\">-</span>\r\n                                  <Input\r\n                                    type=\"time\"\r\n                                    value={openingHours[day].close2 || \"23:00\"}\r\n                                    onChange={(e) =>\r\n                                      setOpeningHours({\r\n                                        ...openingHours,\r\n                                        [day]: { ...openingHours[day], close2: e.target.value },\r\n                                      })\r\n                                    }\r\n                                    className=\"w-32\"\r\n                                  />\r\n                                </div>\r\n                              </div>\r\n                            ) : (\r\n                              <div className=\"flex items-center gap-2\">\r\n                                <Input\r\n                                  type=\"time\"\r\n                                  value={openingHours[day].open}\r\n                                  onChange={(e) =>\r\n                                    setOpeningHours({\r\n                                      ...openingHours,\r\n                                      [day]: { ...openingHours[day], open: e.target.value },\r\n                                    })\r\n                                  }\r\n                                  className=\"w-32\"\r\n                                />\r\n                                <span className=\"text-muted-foreground\">-</span>\r\n                                <Input\r\n                                  type=\"time\"\r\n                                  value={openingHours[day].close}\r\n                                  onChange={(e) =>\r\n                                    setOpeningHours({\r\n                                      ...openingHours,\r\n                                      [day]: { ...openingHours[day], close: e.target.value },\r\n                                    })\r\n                                  }\r\n                                  className=\"w-32\"\r\n                                />\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </form>\r\n        </ScrollArea>\r\n\r\n        <div className=\"flex justify-end gap-2 px-6 py-4 border-t bg-muted/30\">\r\n          <Button type=\"button\" variant=\"outline\" onClick={() => setOpen(false)}>\r\n            {t(\"common.cancel\")}\r\n          </Button>\r\n          <Button type=\"submit\" disabled={isSubmitting} onClick={handleSubmit(onSubmit)} className=\"gap-2\">\r\n            <Store className=\"w-4 h-4\" />\r\n            {isSubmitting ? t(\"common.saving\") : t(\"common.save\")}\r\n          </Button>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}\r\n"],"names":["useDishImages","restaurantId","useQuery","data","error","supabase","useAddDishImage","user","useAuth","queryClient","useQueryClient","useMutation","file","existingImages","countError","fileExt","fileName","uploadError","publicUrl","nextSortOrder","insertError","_","variables","toast","i18n","useDeleteDishImage","imageId","imageUrl","urlParts","useReorderDishImages","images","updates","img","SortableImage","image","index","onDelete","attributes","listeners","setNodeRef","transform","transition","isDragging","useSortable","style","CSS","jsxs","jsx","GripVertical","Button","e","X","DishImageManager","t","useTranslation","fileInputRef","useRef","isLoading","addImage","deleteImage","reorderImages","deleteConfirm","setDeleteConfirm","useState","localImages","setLocalImages","isDeleting","setIsDeleting","displayImages","sensors","useSensors","useSensor","PointerSensor","KeyboardSensor","sortableKeyboardCoordinates","handleDragEnd","event","active","over","oldIndex","newIndex","newOrder","arrayMove","idx","handleFileSelect","handleDeleteConfirm","id","url","handleDialogClose","open","canAddMore","Card","CardHeader","CardTitle","ImageIcon","CardDescription","CardContent","Loader2","DndContext","closestCenter","SortableContext","rectSortingStrategy","Upload","AlertDialog","AlertDialogContent","AlertDialogHeader","AlertDialogTitle","AlertDialogDescription","AlertDialogFooter","restaurantSchema","z.object","z.string","z.array","z.number","z.boolean","DAYS","RestaurantFormDialog","restaurant","trigger","useToast","isAdmin","useUserRole","setOpen","imageFile","setImageFile","imagePreview","setImagePreview","isSubmitting","setIsSubmitting","mapContainer","map","marker","openingHours","setOpeningHours","defaultHours","day","types","setTypes","zh","register","handleSubmit","errors","setValue","watch","useForm","zodResolver","addType","removeType","i","updateType","field","value","newTypes","lat","lng","showWebsiteButton","showDishGallery","isValidCoordinate","useEffect","mapboxToken","timer","mapboxgl","centerLng","centerLat","lngLat","handleWheel","handleImageChange","reader","uploadImage","filePath","onSubmit","restaurantData","Dialog","DialogTrigger","DialogContent","DialogHeader","DialogTitle","Store","DialogDescription","ScrollArea","Label","Input","Switch","checked","Globe","Tabs","TabsList","TabsTrigger","TabsContent","type","RichTextEditor","Textarea","MapPin","Phone","WebIcon","Key","Checkbox","Clock"],"mappings":"4gCAea,MAAAA,GAAiBC,GACrBC,GAAS,CACd,SAAU,CAAC,cAAeD,CAAY,EACtC,QAAS,SAAY,CACb,KAAA,CAAE,KAAAE,EAAM,MAAAC,GAAU,MAAMC,EAC3B,KAAK,wBAAwB,EAC7B,OAAO,GAAG,EACV,GAAG,gBAAiBJ,CAAY,EAChC,MAAM,aAAc,CAAE,UAAW,EAAA,CAAM,EAE1C,GAAIG,EAAa,MAAAA,EACV,OAAAD,CACT,EACA,QAAS,CAAC,CAACF,CAAA,CACZ,EAGUK,GAAkB,IAAM,CAC7B,KAAA,CAAE,KAAAC,GAASC,KACXC,EAAcC,IAEpB,OAAOC,GAAY,CACjB,WAAY,MAAO,CAAE,aAAAV,EAAc,KAAAW,KAAiD,CAClF,GAAI,CAACL,EAAY,MAAA,IAAI,MAAM,mBAAmB,EAG9C,KAAM,CAAE,KAAMM,EAAgB,MAAOC,CAAA,EAAe,MAAMT,EACvD,KAAK,wBAAwB,EAC7B,OAAO,IAAI,EACX,GAAG,gBAAiBJ,CAAY,EAEnC,GAAIa,EAAkB,MAAAA,EAClB,GAAAD,GAAkBA,EAAe,QAAU,GACvC,MAAA,IAAI,MAAM,oBAAoB,EAItC,MAAME,EAAUH,EAAK,KAAK,MAAM,GAAG,EAAE,MAC/BI,EAAW,GAAGf,CAAY,IAAI,KAAK,IAAA,CAAK,IAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,UAAU,CAAC,CAAC,IAAIc,CAAO,GAE9F,CAAE,MAAOE,CAAY,EAAI,MAAMZ,EAAS,QAC3C,KAAK,aAAa,EAClB,OAAOW,EAAUJ,CAAI,EAExB,GAAIK,EAAmB,MAAAA,EAGvB,KAAM,CAAE,KAAM,CAAE,UAAAC,CAAA,CAAY,EAAIb,EAAS,QACtC,KAAK,aAAa,EAClB,aAAaW,CAAQ,EAGlBG,EAAgBN,EAAiBA,EAAe,OAAS,EAGzD,CAAE,KAAAV,EAAM,MAAOiB,CAAY,EAAI,MAAMf,EACxC,KAAK,wBAAwB,EAC7B,OAAO,CACN,cAAeJ,EACf,UAAWiB,EACX,WAAYC,EACZ,WAAYZ,EAAK,EAAA,CAClB,EACA,SACA,SAEH,GAAIa,EAAmB,MAAAA,EAChB,OAAAjB,CACT,EACA,UAAW,CAACkB,EAAGC,IAAc,CACfb,EAAA,kBAAkB,CAAE,SAAU,CAAC,cAAea,EAAU,YAAY,EAAG,EACnFC,EAAM,QAAQC,EAAK,EAAE,0BAA0B,CAAC,CAClD,EACA,QAAUpB,GAAe,CACnBA,EAAM,UAAY,qBACpBmB,EAAM,MAAMC,EAAK,EAAE,6BAA6B,CAAC,EAEjDD,EAAM,MAAMC,EAAK,EAAE,yBAAyB,CAAC,CAEjD,CAAA,CACD,CACH,EAEaC,GAAqB,IAAM,CACtC,MAAMhB,EAAcC,IAEpB,OAAOC,GAAY,CACjB,WAAY,MAAO,CAAE,QAAAe,EAAS,aAAAzB,EAAc,SAAA0B,KAA4E,CAEhH,MAAAC,EAAWD,EAAS,MAAM,eAAe,EAC3CC,EAAS,CAAC,GACN,MAAAvB,EAAS,QACZ,KAAK,aAAa,EAClB,OAAO,CAACuB,EAAS,CAAC,CAAC,CAAC,EAIzB,KAAM,CAAE,MAAAxB,CAAA,EAAU,MAAMC,EACrB,KAAK,wBAAwB,EAC7B,SACA,GAAG,KAAMqB,CAAO,EAEnB,GAAItB,EAAa,MAAAA,EACjB,MAAO,CAAE,aAAAH,CAAa,CACxB,EACA,UAAYE,GAAS,CACPM,EAAA,kBAAkB,CAAE,SAAU,CAAC,cAAeN,EAAK,YAAY,EAAG,EAC9EoB,EAAM,QAAQC,EAAK,EAAE,0BAA0B,CAAC,CAClD,EACA,QAAS,IAAM,CACbD,EAAM,MAAMC,EAAK,EAAE,yBAAyB,CAAC,CAC/C,CAAA,CACD,CACH,EAEaK,GAAuB,IAAM,CACxC,MAAMpB,EAAcC,IAEpB,OAAOC,GAAY,CACjB,WAAY,MAAO,CAAE,OAAAmB,EAAQ,aAAA7B,KAA2F,CACtH,MAAM8B,EAAUD,EAAO,IACrBE,GAAA3B,EACG,KAAK,wBAAwB,EAC7B,OAAO,CAAE,WAAY2B,EAAI,UAAY,CAAA,EACrC,GAAG,KAAMA,EAAI,EAAE,CAAA,EAGd,aAAA,QAAQ,IAAID,CAAO,EAClB,CAAE,aAAA9B,CAAa,CACxB,EACA,UAAYE,GAAS,CACPM,EAAA,kBAAkB,CAAE,SAAU,CAAC,cAAeN,EAAK,YAAY,EAAG,CAChF,CAAA,CACD,CACH,EC3GA,SAAS8B,GAAc,CAAE,MAAAC,EAAO,MAAAC,EAAO,SAAAC,GAAgC,CAC/D,KAAA,CACJ,WAAAC,EACA,UAAAC,EACA,WAAAC,EACA,UAAAC,EACA,WAAAC,EACA,WAAAC,GACEC,GAAY,CAAE,GAAIT,EAAM,EAAI,CAAA,EAE1BU,EAAQ,CACZ,UAAWC,GAAI,UAAU,SAASL,CAAS,EAC3C,WAAAC,EACA,OAAQC,EAAa,GAAK,EAC1B,QAASA,EAAa,GAAM,CAAA,EAI5B,OAAAI,EAAA,KAAC,MAAA,CACC,IAAKP,EACL,MAAAK,EACA,UAAW,kEACTF,EAAa,gCAAkC,EACjD,GAGA,SAAA,CAAAK,EAAA,IAAC,MAAA,CACE,GAAGV,EACH,GAAGC,EACJ,UAAU,6IAEV,SAAAS,EAAAA,IAACC,GAAa,CAAA,UAAU,oBAAqB,CAAA,CAAA,CAC/C,EAEAD,EAAA,IAAC,MAAA,CACC,IAAKb,EAAM,UACX,IAAK,QAAQC,EAAQ,CAAC,GACtB,UAAU,6BACV,UAAW,EAAA,CACb,EAEAY,EAAAA,IAAC,MAAI,CAAA,UAAU,qHACb,SAAAA,EAAA,IAACE,EAAA,CACC,KAAK,SACL,QAAQ,cACR,KAAK,OACL,UAAU,UACV,QAAUC,GAAM,CACdA,EAAE,eAAe,EACjBA,EAAE,gBAAgB,EACTd,EAAAF,EAAM,GAAIA,EAAM,SAAS,CACpC,EAEA,SAAAa,EAAAA,IAACI,GAAE,CAAA,UAAU,SAAU,CAAA,CAAA,CAAA,EAE3B,EAECJ,EAAA,IAAA,MAAA,CAAI,UAAU,iFACZ,WAAQ,EACX,CAAA,CAAA,CAAA,CAGN,CAEgB,SAAAK,GAAiB,CAAE,aAAAnD,GAAuC,CAClE,KAAA,CAAE,EAAAoD,GAAMC,KACRC,EAAeC,SAAyB,IAAI,EAC5C,CAAE,KAAM1B,EAAS,CAAA,EAAI,UAAA2B,GAAczD,GAAcC,CAAY,EAC7DyD,EAAWpD,KACXqD,EAAclC,KACdmC,EAAgB/B,KAChB,CAACgC,EAAeC,CAAgB,EAAIC,WAA6C,IAAI,EACrF,CAACC,EAAaC,CAAc,EAAIF,EAAA,SAAsB,CAAE,CAAA,EACxD,CAACG,EAAYC,CAAa,EAAIJ,WAAS,EAAK,EAG5CK,EAAgBJ,EAAY,OAAS,EAAIA,EAAclC,EAEvDuC,EAAUC,GACdC,GAAUC,GAAe,CACvB,qBAAsB,CACpB,SAAU,CACZ,CAAA,CACD,EACDD,GAAUE,GAAgB,CACxB,iBAAkBC,EAAA,CACnB,CAAA,EAGGC,EAAiBC,GAAwB,CACvC,KAAA,CAAE,OAAAC,EAAQ,KAAAC,CAAS,EAAAF,EAEzB,GAAIE,GAAQD,EAAO,KAAOC,EAAK,GAAI,CAC3B,MAAAC,EAAWX,EAAc,UAAWpC,GAAQA,EAAI,KAAO6C,EAAO,EAAE,EAChEG,EAAWZ,EAAc,UAAWpC,GAAQA,EAAI,KAAO8C,EAAK,EAAE,EAE9DG,EAAWC,GAAUd,EAAeW,EAAUC,CAAQ,EAC5Df,EAAegB,CAAQ,EAGvB,MAAMlD,EAAUkD,EAAS,IAAI,CAACjD,EAAKmD,KAAS,CAC1C,GAAInD,EAAI,GACR,WAAYmD,CACZ,EAAA,EAEYvB,EAAA,OACZ,CAAE,OAAQ7B,EAAS,aAAA9B,CAAa,EAChC,CACE,UAAW,IAAM,CACfgE,EAAe,CAAE,CAAA,CACnB,EACA,QAAS,IAAM,CACbA,EAAe,CAAE,CAAA,CACnB,CACF,CAAA,CAEJ,CAAA,EAGImB,EAAmB,MAAOlC,GAA2C,CACzE,MAAMtC,EAAOsC,EAAE,OAAO,QAAQ,CAAC,EAC1BtC,IAEDA,EAAK,KAAO,EAAI,KAAO,MAItBA,EAAK,KAAK,WAAW,QAAQ,IAIlC,MAAM8C,EAAS,YAAY,CAAE,aAAAzD,EAAc,KAAAW,CAAM,CAAA,EAE7C2C,EAAa,UACfA,EAAa,QAAQ,MAAQ,KAC/B,EAOI8B,EAAsB,SAAY,CAClC,GAAA,CAACxB,GAAiBK,EAAY,OAE5B,KAAA,CAAE,GAAAoB,EAAI,IAAAC,CAAQ,EAAA1B,EACpBM,EAAc,EAAI,EAEd,GAAA,CACF,MAAMR,EAAY,YAAY,CAC5B,QAAS2B,EACT,aAAArF,EACA,SAAUsF,CAAA,CACX,EAEDzB,EAAiB,IAAI,QACd1D,EAAO,CACN,QAAA,MAAM,iBAAkBA,CAAK,CAAA,QACrC,CACA+D,EAAc,EAAK,CACrB,CAAA,EAGIqB,EAAqBC,GAAkB,CAEvC,CAACA,GAAQ,CAACvB,GACZJ,EAAiB,IAAI,CACvB,EAGI4B,EAAatB,EAAc,OAAS,GAE1C,cACGuB,EACC,CAAA,SAAA,CAAC7C,EAAAA,KAAA8C,GAAA,CAAW,UAAU,OACpB,SAAA,CAAC9C,EAAAA,KAAA+C,GAAA,CAAU,UAAU,kCACnB,SAAA,CAAC9C,EAAAA,IAAA+C,GAAA,CAAU,UAAU,SAAU,CAAA,EAC9BzC,EAAE,kBAAkB,CAAA,EACvB,SACC0C,GACE,CAAA,SAAA,CAAA1C,EAAE,yBAA0B,CAAE,QAASe,EAAc,OAAQ,IAAK,GAAI,EACtEA,EAAc,OAAS,GACtBrB,EAAAA,IAAC,QAAK,UAAU,qBACb,SAAEM,EAAA,0BAA0B,CAC/B,CAAA,CAAA,EAEJ,CAAA,EACF,SACC2C,EACE,CAAA,SAAA,CAAAvC,EACEV,EAAAA,IAAA,MAAA,CAAI,UAAU,wCACb,SAACA,EAAA,IAAAkD,GAAA,CAAQ,UAAU,sBAAuB,CAAA,CAC5C,CAAA,EAECnD,EAAA,KAAA,MAAA,CAAI,UAAU,YAEZ,SAAA,CAAAsB,EAAc,OAAS,GACtBrB,EAAA,IAACmD,GAAA,CACC,QAAA7B,EACA,mBAAoB8B,GACpB,UAAWxB,EAEX,SAAA5B,EAAA,IAACqD,GAAA,CACC,MAAOhC,EAAc,IAAKpC,GAAQA,EAAI,EAAE,EACxC,SAAUqE,GAEV,SAAAtD,EAAA,IAAC,OAAI,UAAU,uDACZ,WAAc,IAAI,CAACb,EAAOC,IACzBY,EAAA,IAACd,GAAA,CAEC,MAAAC,EACA,MAAAC,EACA,SAAU,CAACmD,EAAIC,IAAQzB,EAAiB,CAAE,GAAAwB,EAAI,IAAAC,EAAK,CAAA,EAH9CrD,EAAM,EAKd,CAAA,EACH,CAAA,CACF,CAAA,CACF,EAIDwD,UACE,MACC,CAAA,SAAA,CAAA3C,EAAA,IAAC,QAAA,CACC,IAAKQ,EACL,KAAK,OACL,OAAO,UACP,UAAU,SACV,SAAU6B,EACV,SAAU1B,EAAS,SAAA,CACrB,EACAZ,EAAA,KAACG,EAAA,CACC,KAAK,SACL,QAAQ,UACR,UAAU,SACV,QAAS,IAAMM,EAAa,SAAS,MAAM,EAC3C,SAAUG,EAAS,UAElB,SAAA,CAASA,EAAA,gBACPuC,GAAQ,CAAA,UAAU,4BAA4B,EAE/ClD,EAAA,IAACuD,GAAO,CAAA,UAAU,cAAe,CAAA,EAElCjD,EAAE,mBAAmB,CAAA,CAAA,CACxB,CAAA,EACF,EAGD,CAACqC,GACC3C,MAAA,IAAA,CAAE,UAAU,4CACV,SAAAM,EAAE,uBAAuB,EAC5B,CAAA,EAEJ,QAIDkD,GAAY,CAAA,KAAM,CAAC,CAAC1C,EAAe,aAAc2B,EAChD,SAAAzC,EAAA,IAACyD,GAAA,CACC,QAAUtD,GAAMA,EAAE,gBAAgB,EAClC,UAAYA,GAAM,CACZA,EAAE,MAAQ,UACZA,EAAE,eAAe,EACjBA,EAAE,gBAAgB,EAEtB,EAEA,gBAAC,OAAK,CAAA,SAAWA,GAAMA,EAAE,eACvB,EAAA,SAAA,CAAAJ,OAAC2D,GACC,CAAA,SAAA,CAAC1D,EAAA,IAAA2D,GAAA,CAAkB,SAAErD,EAAA,+BAA+B,CAAE,CAAA,EACrDN,EAAA,IAAA4D,GAAA,CACE,SAAEtD,EAAA,qCAAqC,CAC1C,CAAA,CAAA,EACF,EACAP,EAAAA,KAAC8D,GAAkB,CAAA,UAAU,OAC3B,SAAA,CAAA7D,EAAA,IAACE,EAAA,CACC,KAAK,SACL,QAAQ,UACR,QAAUC,GAAM,CACdA,EAAE,eAAe,EACjBA,EAAE,gBAAgB,EACbgB,GACHJ,EAAiB,IAAI,CAEzB,EACA,SAAUI,EAET,WAAE,eAAe,CAAA,CACpB,EACApB,EAAA,KAACG,EAAA,CACC,KAAK,SACL,QAAQ,cACR,QAAUC,GAAM,CACdA,EAAE,eAAe,EACjBA,EAAE,gBAAgB,EACEmC,GACtB,EACA,SAAUnB,EAET,SAAA,CAAAA,EAAcnB,EAAA,IAAAkD,GAAA,CAAQ,UAAU,2BAA4B,CAAA,EAAK,KACjE5C,EAAE,eAAe,CAAA,CAAA,CACpB,CAAA,EACF,CAAA,EACF,CAAA,CAAA,EAEJ,CAAA,EACF,CACF,CAAA,CAAA,CAEJ,CCrUA,MAAMwD,GAAmBC,GAAS,CAChC,KAAMC,EAAS,EAAE,IAAI,EAAGvF,EAAK,EAAE,yBAAyB,CAAC,EACzD,QAASuF,EAAS,EAAE,IAAI,EAAGvF,EAAK,EAAE,yBAAyB,CAAC,EAC5D,QAASuF,EAAS,EAAE,IAAI,EAAGvF,EAAK,EAAE,yBAAyB,CAAC,EAC5D,OAAQuF,EAAS,EAAE,SAAS,EAC5B,KAAMC,EAAQD,EAAS,CAAC,EAAE,IAAI,EAAGvF,EAAK,EAAE,yBAAyB,CAAC,EAAE,IAAI,EAAGA,EAAK,EAAE,wBAAwB,CAAC,EAC3G,QAASwF,EAAQD,EAAS,CAAC,EAAE,IAAI,EAAGvF,EAAK,EAAE,yBAAyB,CAAC,EAAE,IAAI,EAAGA,EAAK,EAAE,wBAAwB,CAAC,EAC9G,QAASwF,EAAQD,EAAS,CAAC,EAAE,IAAI,EAAGvF,EAAK,EAAE,yBAAyB,CAAC,EAAE,IAAI,EAAGA,EAAK,EAAE,wBAAwB,CAAC,EAC9G,YAAauF,EAAS,EAAE,SAAS,EACjC,eAAgBA,EAAS,EAAE,SAAS,EACpC,eAAgBA,EAAS,EAAE,SAAS,EACpC,gBAAiBA,EAAS,EAAE,SAAS,EACrC,gBAAiBA,EAAS,EAAE,SAAS,EACrC,gBAAiBA,EAAS,EAAE,SAAS,EACrC,QAASA,EAAS,EAAE,IAAI,EAAGvF,EAAK,EAAE,4BAA4B,CAAC,EAC/D,IAAKyF,GAAS,EACd,IAAKA,GAAS,EACd,MAAOF,EAAS,EAAE,SAAS,EAC3B,YAAaA,EAAS,EAAE,SAAS,EACjC,oBAAqBG,GAAU,EAAE,QAAQ,EAAI,EAC7C,kBAAmBA,GAAU,EAAE,QAAQ,EAAI,CAC7C,CAAC,EAkBKC,GAAO,CAAC,SAAU,UAAW,YAAa,WAAY,SAAU,WAAY,QAAQ,EAEnF,SAASC,GAAqB,CAAE,WAAAC,EAAY,QAAAC,GAAsC,CACjF,KAAA,CAAEjE,EAAAA,GAAMC,KACR,CAAE,MAAA/B,GAAUgG,KACZ9G,EAAcC,IACd,CAAE,QAAA8G,GAAYC,KACd,CAAChC,EAAMiC,CAAO,EAAI3D,WAAS,EAAK,EAChC,CAAC4D,EAAWC,CAAY,EAAI7D,WAAsB,IAAI,EACtD,CAAC8D,EAAcC,CAAe,EAAI/D,EAAwB,SAAAsD,GAAY,WAAa,IAAI,EACvF,CAACU,EAAcC,CAAe,EAAIjE,WAAS,EAAK,EAChDkE,EAAezE,SAAuB,IAAI,EAC1C0E,EAAM1E,SAA4B,IAAI,EACtC2E,EAAS3E,SAA+B,IAAI,EAC5C,CAAC4E,EAAcC,CAAe,EAAItE,WAAmC,IAAM,CAC/E,MAAMuE,EAAyC,CAAA,EAW/C,OAVKnB,GAAA,QAAeoB,GAAA,CAClBD,EAAaC,CAAG,EAAI,CAClB,KAAM,QACN,MAAO,QACP,OAAQ,GACR,WAAY,GACZ,MAAO,QACP,OAAQ,OAAA,CACV,CACD,EACGlB,GAAY,cACP,CAAE,GAAGiB,EAAc,GAAGjB,EAAW,aAAc,EAEjDiB,CAAA,CACR,EAGK,CAACE,EAAOC,CAAQ,EAAI1E,WAAmD,IACvEsD,GAAY,MAAQ,MAAM,QAAQA,EAAW,IAAI,EAC5CA,EAAW,KAAK,IAAI,CAACqB,EAAYvD,KAAiB,CACvD,GAAAuD,EACA,GAAIrB,EAAW,UAAUlC,CAAG,GAAK,GACjC,GAAIkC,EAAW,UAAUlC,CAAG,GAAK,EACjC,EAAA,EAEG,CAAC,CAAE,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,CACnC,EAEK,CACJ,SAAAwD,EACA,aAAAC,EACA,UAAW,CAAE,OAAAC,CAAO,EACpB,SAAAC,EACA,MAAAC,GACEC,GAA4B,CAC9B,SAAUC,GAAYpC,EAAgB,EACtC,cAAeQ,EAAa,CAC1B,KAAMA,EAAW,KACjB,QAASA,EAAW,SAAW,GAC/B,QAASA,EAAW,SAAW,GAC/B,OAAQA,EAAW,QAAU,GAC7B,KAAM,MAAM,QAAQA,EAAW,IAAI,EAAIA,EAAW,KAAO,CAACA,EAAW,IAAI,EACzE,QAAS,MAAM,QAAQA,EAAW,OAAO,EAAIA,EAAW,QAAWA,EAAW,QAAU,CAACA,EAAW,OAAO,EAAI,CAAC,EAAE,EAClH,QAAS,MAAM,QAAQA,EAAW,OAAO,EAAIA,EAAW,QAAWA,EAAW,QAAU,CAACA,EAAW,OAAO,EAAI,CAAC,EAAE,EAClH,YAAaA,EAAW,aAAe,GACvC,eAAgBA,EAAW,gBAAkB,GAC7C,eAAgBA,EAAW,gBAAkB,GAC7C,gBAAiBA,EAAW,iBAAmB,GAC/C,gBAAiBA,EAAW,iBAAmB,GAC/C,gBAAiBA,EAAW,iBAAmB,GAC/C,QAASA,EAAW,QACpB,IAAK,OAAOA,EAAW,KAAQ,UAAY,CAAC,MAAMA,EAAW,GAAG,EAAIA,EAAW,IAAM,QACrF,IAAK,OAAOA,EAAW,KAAQ,UAAY,CAAC,MAAMA,EAAW,GAAG,EAAIA,EAAW,IAAM,QACrF,MAAOA,EAAW,OAAS,GAC3B,YAAaA,EAAW,aAAe,GACvC,oBAAqBA,EAAW,qBAAuB,GACvD,kBAAmBA,EAAW,mBAAqB,EAAA,EACjD,CACF,KAAM,GACN,QAAS,GACT,QAAS,GACT,OAAQ,GACR,KAAM,CAAC,EAAE,EACT,QAAS,CAAC,EAAE,EACZ,QAAS,CAAC,EAAE,EACZ,YAAa,GACb,eAAgB,GAChB,eAAgB,GAChB,gBAAiB,GACjB,gBAAiB,GACjB,gBAAiB,GACjB,QAAS,GACT,IAAK,QACL,IAAK,QACL,MAAO,GACP,YAAa,GACb,oBAAqB,GACrB,kBAAmB,EACrB,CAAA,CACD,EAEK6B,EAAU,IAAM,CAChBV,EAAM,OAAS,GACRC,EAAA,CAAC,GAAGD,EAAO,CAAE,GAAI,GAAI,GAAI,GAAI,GAAI,EAAG,CAAC,CAAC,CACjD,EAGIW,EAAchH,GAAkB,CAChCqG,EAAM,OAAS,GACjBC,EAASD,EAAM,OAAO,CAACnH,EAAG+H,IAAMA,IAAMjH,CAAK,CAAC,CAC9C,EAGIkH,EAAa,CAAClH,EAAemH,EAA2BC,IAAkB,CACxE,MAAAC,EAAW,CAAC,GAAGhB,CAAK,EACjBgB,EAAArH,CAAK,EAAEmH,CAAK,EAAIC,EACzBd,EAASe,CAAQ,EAGRV,EAAA,OAAQU,EAAS,IAAInG,GAAKA,EAAE,EAAE,EAAE,OAAO,OAAO,CAAC,EAC/CyF,EAAA,UAAWU,EAAS,IAAInG,GAAKA,EAAE,EAAE,EAAE,OAAO,OAAO,CAAC,EAClDyF,EAAA,UAAWU,EAAS,IAAInG,GAAKA,EAAE,EAAE,EAAE,OAAO,OAAO,CAAC,CAAA,EAGvDoG,EAAMV,EAAM,KAAK,EACjBW,EAAMX,EAAM,KAAK,EACjBY,GAAoBZ,EAAM,qBAAqB,EAC/Ca,GAAkBb,EAAM,mBAAmB,EAG3Cc,EAAoB,CAACJ,EAAaC,IAC/B,OAAOD,GAAQ,UAAY,OAAOC,GAAQ,UAC1C,CAAC,MAAMD,CAAG,GAAK,CAAC,MAAMC,CAAG,GACzB,SAASD,CAAG,GAAK,SAASC,CAAG,EAItCI,EAAAA,UAAU,IAAM,CACd,GAAI,CAACrE,EAAM,CAELyC,EAAI,UACNA,EAAI,QAAQ,SACZA,EAAI,QAAU,KACdC,EAAO,QAAU,MAEnB,MACF,CAGA,GAAID,EAAI,QAAS,OAEX,MAAA6B,EAAc,mGAoFdC,EAAQ,WAxEE,IAAM,CAChB,GAAA,CAAC/B,EAAa,QAAS,CACzB,QAAQ,MAAM,yBAAyB,EACvC,MACF,CAEI,GAAA,CACFgC,EAAS,YAAcF,EAGvB,MAAMG,EAAYL,EAAkBJ,EAAKC,CAAG,EAAIA,EAAM,QAChDS,EAAYN,EAAkBJ,EAAKC,CAAG,EAAID,EAAM,QAElDvB,EAAA,QAAU,IAAI+B,EAAS,IAAI,CAC7B,UAAWhC,EAAa,QACxB,MAAO,mCACP,OAAQ,CAACiC,EAAWC,CAAS,EAC7B,KAAM,EAAA,CACP,EAGGjC,EAAA,QAAQ,WAAW,UAEnBA,EAAA,QAAQ,GAAG,OAAQ,IAAM,CACtBA,EAAI,UAGL2B,EAAkBJ,EAAKC,CAAG,IAC5BvB,EAAO,QAAU,IAAI8B,EAAS,OAAO,CAAE,UAAW,EAAM,CAAA,EACrD,UAAU,CAACP,EAAKD,CAAG,CAAC,EACpB,MAAMvB,EAAI,OAAO,GAGfC,EAAA,QAAQ,GAAG,UAAW,IAAM,CAC3B,MAAAiC,EAASjC,EAAO,QAAS,UAAU,EAChCW,EAAA,MAAOsB,EAAO,GAAG,EACjBtB,EAAA,MAAOsB,EAAO,GAAG,CAAA,CAC3B,EAGD,WAAW,IAAM,CACflC,EAAI,SAAS,UACZ,GAAG,EAAA,CACP,EAGK,MAAAmC,GAAenH,GAAkB,CACjCA,EAAE,SAAWA,EAAE,QACbgF,EAAA,SAAS,WAAW,SAEpBA,EAAA,SAAS,WAAW,SAC1B,EAGWD,EAAA,QAAQ,iBAAiB,QAASoC,EAAW,EAE1DnC,EAAI,QAAQ,GAAG,QAAUhF,GAAM,CAC7B,KAAM,CAAE,IAAAwG,GAAK,IAAAD,IAAQvG,EAAE,OACvB4F,EAAS,MAAOY,EAAG,EACnBZ,EAAS,MAAOW,EAAG,EACnBtB,EAAO,SAAS,UAAU,CAACuB,GAAKD,EAAG,CAAC,CAAA,CACrC,EAEDvB,EAAI,QAAQ,GAAG,QAAUhF,GAAM,CACrB,QAAA,MAAM,aAAcA,CAAC,CAAA,CAC9B,QACM9C,EAAO,CACN,QAAA,MAAM,4BAA6BA,CAAK,CAClD,CAAA,EAIgC,GAAG,EAErC,MAAO,IAAM,CACX,aAAa4J,CAAK,CAAA,CAEnB,EAAA,CAACvE,EAAMgE,EAAKC,CAAG,CAAC,EAGnBI,EAAAA,UAAU,IAAM,CACV3B,EAAO,SAAWD,EAAI,SAAW2B,EAAkBJ,EAAKC,CAAG,IAC7DvB,EAAO,QAAQ,UAAU,CAACuB,EAAKD,CAAG,CAAC,EACnCvB,EAAI,QAAQ,UAAU,CAACwB,EAAKD,CAAG,CAAC,EAClC,EACC,CAACA,EAAKC,CAAG,CAAC,EAEP,MAAAY,GAAqBpH,GAA2C,CACpE,MAAMtC,EAAOsC,EAAE,OAAO,QAAQ,CAAC,EAC/B,GAAItC,EAAM,CACRgH,EAAahH,CAAI,EACX,MAAA2J,EAAS,IAAI,WACnBA,EAAO,UAAY,IAAM,CACvBzC,EAAgByC,EAAO,MAAgB,CAAA,EAEzCA,EAAO,cAAc3J,CAAI,CAC3B,CAAA,EAGI4J,GAAc,SAAoC,CACtD,GAAI,CAAC7C,EAAkB,OAAAN,GAAY,WAAa,KAEhD,MAAMtG,EAAU4G,EAAU,KAAK,MAAM,GAAG,EAAE,MAEpC8C,EAAW,GADA,GAAG,KAAK,OAAO,CAAC,IAAI1J,CAAO,EAChB,GAEtB,CAAE,MAAOE,CAAY,EAAI,MAAMZ,EAAS,QAC3C,KAAK,mBAAmB,EACxB,OAAOoK,EAAU9C,CAAS,EAE7B,GAAI1G,EACI,MAAAA,EAGR,KAAM,CAAE,KAAM,CAAE,UAAAC,CAAA,CAAY,EAAIb,EAAS,QACtC,KAAK,mBAAmB,EACxB,aAAaoK,CAAQ,EAEjB,OAAAvJ,CAAA,EAGHwJ,GAAW,MAAOvK,GAA6B,CACnD6H,EAAgB,EAAI,EAChB,GAAA,CACI,KAAA,CAAE,KAAM,CAAE,KAAAzH,IAAW,MAAMF,EAAS,KAAK,UAC/C,GAAI,CAACE,EAAY,MAAA,IAAI,MAAM,mBAAmB,EAExC,MAAAoB,EAAW,MAAM6I,KAEjBG,EAAiB,CACrB,KAAMxK,EAAK,KACX,QAASA,EAAK,QACd,QAASA,EAAK,QACd,OAAQA,EAAK,QAAU,KACvB,KAAMA,EAAK,KACX,QAASA,EAAK,QACd,QAASA,EAAK,QACd,YAAaA,EAAK,aAAe,KACjC,eAAgBA,EAAK,gBAAkB,KACvC,eAAgBA,EAAK,gBAAkB,KACvC,gBAAiBA,EAAK,iBAAmB,KACzC,gBAAiBA,EAAK,iBAAmB,KACzC,gBAAiBA,EAAK,iBAAmB,KACzC,QAASA,EAAK,QACd,IAAKA,EAAK,IACV,IAAKA,EAAK,IACV,MAAOA,EAAK,OAAS,KACrB,YAAaA,EAAK,aAAe,KACjC,oBAAqBA,EAAK,oBAC1B,kBAAmBA,EAAK,kBACxB,UAAWwB,EACX,cAAeyG,CAAA,EAGjB,GAAIf,EAAY,CACR,KAAA,CAAE,MAAAjH,GAAU,MAAMC,EACrB,KAAK,aAAa,EAClB,OAAO,CAAE,GAAGsK,EAAgB,WAAYpK,EAAK,GAAI,EACjD,GAAG,KAAM8G,EAAW,EAAE,EAEzB,GAAIjH,EAAa,MAAAA,EAEXmB,EAAA,CACJ,MAAO8B,EAAE,gBAAgB,EACzB,YAAaA,EAAE,yBAAyB,CAAA,CACzC,CAAA,KACI,CACL,KAAM,CAAE,MAAAjD,CAAM,EAAI,MAAMC,EACrB,KAAK,aAAa,EAClB,OAAO,CAAC,CAAE,GAAGsK,EAAgB,WAAYpK,EAAK,EAAA,CAAI,CAAC,EAEtD,GAAIH,EAAa,MAAAA,EAEXmB,EAAA,CACJ,MAAO8B,EAAE,gBAAgB,EACzB,YAAaA,EAAE,yBAAyB,CAAA,CACzC,CACH,CAEA5C,EAAY,kBAAkB,CAAE,SAAU,CAAC,aAAa,CAAG,CAAA,EAC3DiH,EAAQ,EAAK,QACNtH,EAAY,CACbmB,EAAA,CACJ,MAAO8B,EAAE,cAAc,EACvB,YAAajD,EAAM,QACnB,QAAS,aAAA,CACV,CAAA,QACD,CACA4H,EAAgB,EAAK,CACvB,CAAA,EAGF,cACG4C,GAAA,CAAO,KAAAnF,EAAY,aAAciC,EAChC,SAAA,OAACmD,GAAA,CAAc,QAAO,GAAE,SAAQvD,EAAA,EAC/BxE,EAAAA,KAAAgI,GAAc,CAAA,UAAU,2EACvB,SAAA,CAAChI,EAAAA,KAAAiI,GAAA,CAAa,UAAU,sCACtB,SAAA,CAACjI,EAAAA,KAAAkI,GAAA,CAAY,UAAU,mCACrB,SAAA,CAACjI,EAAAA,IAAAkI,GAAA,CAAM,UAAU,uBAAuB,EAC1B5H,EAAbgE,EAAe,uBAA4B,qBAAN,CAA2B,EACnE,EACCtE,EAAAA,IAAAmI,GAAkB,CAAA,UAAU,YAC1B,SAAa7H,EAAbgE,EAAe,8BAAmC,gCAAN,EAC/C,CAAA,EACF,EAECtE,EAAA,IAAAoI,GAAW,CAAA,UAAU,4BACpB,SAAArI,EAAAA,KAAC,OAAK,CAAA,SAAU8F,EAAa8B,EAAQ,EAAG,UAAU,iBAEhD,SAAA,CAAA3H,EAAAA,IAAC4C,GAAK,UAAU,kEACd,SAAC7C,EAAA,KAAAkD,EAAA,CAAY,UAAU,MACrB,SAAA,CAAClD,EAAAA,KAAAsI,EAAA,CAAM,UAAU,uDACf,SAAA,CAACrI,EAAAA,IAAAuD,GAAA,CAAO,UAAU,uBAAuB,EACxCjD,EAAE,uBAAuB,CAAA,EAC5B,EACCP,EAAAA,KAAA,MAAI,CAAA,UAAU,0BACZ,SAAA,CACC+E,GAAC/E,EAAA,KAAA,MAAI,CAAA,UAAU,iBACb,SAAA,CAAAC,EAAA,IAAC,MAAA,CACC,IAAK8E,EACL,IAAI,UACJ,UAAU,4HAAA,CACZ,EACA9E,EAAA,IAACE,EAAA,CACC,KAAK,SACL,QAAQ,cACR,KAAK,OACL,UAAU,kGACV,QAAS,IAAM,CACb2E,EAAa,IAAI,EACjBE,EAAgB,IAAI,CACtB,EAEA,SAAC/E,EAAAA,IAAAI,GAAE,CAAA,UAAU,UAAU,CAAA,CACzB,CAAA,EACF,SAEDiI,EAAA,CAAM,QAAQ,eAAe,UAAU,iBACtC,SAAA,CAACtI,EAAAA,KAAA,MAAA,CAAI,UAAU,qKACb,SAAA,CAACC,EAAAA,IAAAuD,GAAA,CAAO,UAAU,uBAAuB,EACxCxD,EAAAA,KAAA,MAAI,CAAA,UAAU,cACb,SAAA,CAAAC,MAAC,IAAE,CAAA,UAAU,sBAAuB,SAAAM,EAAE,mBAAmB,EAAE,QAC1D,IAAE,CAAA,UAAU,qCAAsC,SAAAA,EAAE,oBAAoB,EAAE,CAAA,EAC7E,CAAA,EACF,EACAN,EAAA,IAACsI,EAAA,CACC,GAAG,eACH,KAAK,OACL,OAAO,UACP,UAAU,SACV,SAAUf,EAAA,CACZ,CAAA,EACF,CAAA,EACF,CAAA,CAAA,CACF,CAAA,CACF,EAGCjD,GAAY,IACVtE,EAAAA,IAAA4C,EAAA,CAAK,UAAU,oBACd,SAAC7C,EAAA,KAAAkD,EAAY,CAAA,UAAU,MACrB,SAAA,CAAClD,EAAAA,KAAA,MAAA,CAAI,UAAU,yCACb,SAAA,CAACA,EAAAA,KAAAsI,EAAA,CAAM,UAAU,kDACf,SAAA,CAACrI,EAAAA,IAAA+C,GAAA,CAAU,UAAU,uBAAuB,EAC3CzC,EAAE,mBAAmB,CAAA,EACxB,EACCP,EAAAA,KAAA,MAAI,CAAA,UAAU,0BACb,SAAA,CAAAC,EAAAA,IAACqI,GAAM,QAAQ,oBAAoB,UAAU,gCAC1C,SAAA/H,EAAE,uBAAuB,EAC5B,EACAN,EAAA,IAACuI,GAAA,CACC,GAAG,oBACH,QAAS1B,GACT,gBAAkB2B,GAAYzC,EAAS,oBAAqByC,CAAO,CAAA,CACrE,CAAA,EACF,CAAA,EACF,QACCnI,GAAA,CAAiB,aAAciE,EAAW,GAAI,CAAA,CAAA,CACjD,CAAA,CACF,QAID1B,EAAK,CAAA,UAAU,oBACd,SAAC7C,EAAA,KAAAkD,EAAA,CAAY,UAAU,MACrB,SAAA,CAAClD,EAAAA,KAAAsI,EAAA,CAAM,UAAU,uDACf,SAAA,CAACrI,EAAAA,IAAAyI,GAAA,CAAM,UAAU,uBAAuB,EACvCnI,EAAE,2BAA2B,CAAA,EAChC,SACCoI,GAAA,CAAK,aAAa,KAAK,UAAU,SAChC,SAAA,CAAC3I,EAAAA,KAAA4I,GAAA,CAAS,UAAU,+BAClB,SAAA,QAACC,GAAY,CAAA,MAAM,KAAK,UAAU,QAAQ,SAAA,CAAA,QAClCtI,EAAE,eAAe,CAAA,EACzB,SACCsI,GAAA,CAAY,MAAM,KAAK,UAAU,QAAQ,SAAA,CAAA,QAClCtI,EAAE,eAAe,CAAA,EACzB,SACCsI,GAAA,CAAY,MAAM,KAAK,UAAU,QAAQ,SAAA,CAAA,QAClCtI,EAAE,kBAAkB,CAAA,EAC5B,CAAA,EACF,SAECuI,GAAA,CAAY,MAAM,KAAK,UAAU,iBAChC,SAAA,CAAC9I,EAAAA,KAAA,MAAA,CAAI,UAAU,YACb,SAAA,CAAAC,EAAAA,IAACqI,GAAM,QAAQ,OAAO,UAAU,sBAAuB,SAAA/H,EAAE,sBAAsB,EAAE,EACjFN,EAAA,IAACsI,EAAA,CACC,GAAG,OACF,GAAG1C,EAAS,MAAM,EACnB,YAAatF,EAAE,2BAA2B,EAC1C,UAAU,WAAA,CACZ,EACCwF,EAAO,MACL9F,MAAA,IAAA,CAAE,UAAU,2BAA4B,SAAA8F,EAAO,KAAK,OAAA,CAAQ,CAAA,EAEjE,EACC/F,EAAAA,KAAA,MAAI,CAAA,UAAU,YACb,SAAA,CAACA,EAAAA,KAAA,MAAA,CAAI,UAAU,oCACb,SAAA,CAAAC,MAACqI,EAAM,CAAA,UAAU,sBAAuB,SAAA/H,EAAE,sBAAsB,EAAE,EACjEmF,EAAM,OAAS,SACbvF,GAAO,KAAK,SAAS,QAAQ,UAAU,KAAK,KAAK,QAASiG,EACxD,SAAA7F,EAAE,eAAe,EACpB,CAAA,EAEJ,EACCmF,EAAM,IAAI,CAACqD,EAAM1J,WACf,MAAA,CAAgB,UAAU,0BACzB,SAAA,CAAAY,EAAA,IAACsI,EAAA,CACC,YAAahI,EAAE,mBAAmB,EAClC,MAAOwI,EAAK,GACZ,SAAW3I,GAAMmG,EAAWlH,EAAO,KAAMe,EAAE,OAAO,KAAK,CAAA,CACzD,EACAH,EAAA,IAACE,EAAA,CACC,KAAK,SACL,QAAQ,QACR,KAAK,OACL,QAAS,IAAMkG,EAAWhH,CAAK,EAC/B,SAAUqG,EAAM,SAAW,EAE3B,SAACzF,EAAAA,IAAAI,GAAE,CAAA,UAAU,UAAU,CAAA,CACzB,CAAA,CAdQ,EAAAhB,CAeV,CACD,EACA0G,EAAO,MACL9F,MAAA,IAAA,CAAE,UAAU,2BAA4B,SAAA8F,EAAO,KAAK,OAAA,CAAQ,CAAA,EAEjE,EACC/F,EAAAA,KAAA,MAAI,CAAA,UAAU,YACb,SAAA,CAAAC,EAAAA,IAACqI,GAAM,QAAQ,cAAc,UAAU,sBAAuB,SAAA/H,EAAE,mBAAmB,EAAE,EACrFN,EAAA,IAAC+I,GAAA,CACC,MAAO/C,EAAM,aAAa,GAAK,GAC/B,SAAWQ,GAAUT,EAAS,cAAeS,CAAK,EAClD,YAAalG,EAAE,wBAAwB,CAAA,CACzC,CAAA,EACF,EACCP,EAAAA,KAAA,MAAI,CAAA,UAAU,YACb,SAAA,CAAAC,EAAAA,IAACqI,GAAM,QAAQ,kBAAkB,UAAU,sBAAuB,SAAA/H,EAAE,oBAAoB,EAAE,EAC1FN,EAAA,IAACgJ,GAAA,CACC,GAAG,kBACF,GAAGpD,EAAS,iBAAiB,EAC9B,KAAM,EACN,YAAatF,EAAE,yBAAyB,CAAA,CAC1C,QACC,IAAE,CAAA,UAAU,gCAAiC,SAAAA,EAAE,wBAAwB,EAAE,CAAA,EAC5E,CAAA,EACF,SAECuI,GAAA,CAAY,MAAM,KAAK,UAAU,iBAChC,SAAA,CAAC9I,EAAAA,KAAA,MAAA,CAAI,UAAU,YACb,SAAA,CAAAC,MAACqI,EAAM,CAAA,QAAQ,UAAU,UAAU,sBAAsB,SAAe,kBAAA,EACxErI,EAAA,IAACsI,EAAA,CACC,GAAG,UACF,GAAG1C,EAAS,SAAS,EACtB,YAAY,2BACZ,UAAU,WAAA,CACZ,EACCE,EAAO,SACL9F,MAAA,IAAA,CAAE,UAAU,2BAA4B,SAAA8F,EAAO,QAAQ,OAAA,CAAQ,CAAA,EAEpE,EACC/F,EAAAA,KAAA,MAAI,CAAA,UAAU,YACb,SAAA,OAACsI,EAAA,CAAM,UAAU,sBAAsB,SAA2B,8BAAA,EACjE5C,EAAM,IAAI,CAACqD,EAAM1J,UACf,MAAA,CAAgB,UAAU,0BACzB,SAAAY,EAAA,IAACsI,EAAA,CACC,YAAY,iBACZ,MAAOQ,EAAK,GACZ,SAAW3I,GAAMmG,EAAWlH,EAAO,KAAMe,EAAE,OAAO,KAAK,CAAA,CAAA,CAJjD,EAAAf,CAMV,CACD,CAAA,EACH,EACCW,EAAAA,KAAA,MAAI,CAAA,UAAU,YACb,SAAA,CAAAC,MAACqI,EAAM,CAAA,QAAQ,iBAAiB,UAAU,sBAAsB,SAAW,cAAA,EAC3ErI,EAAA,IAAC+I,GAAA,CACC,MAAO/C,EAAM,gBAAgB,GAAK,GAClC,SAAWQ,GAAUT,EAAS,iBAAkBS,CAAK,EACrD,YAAY,iCAAA,CACd,CAAA,EACF,EACCzG,EAAAA,KAAA,MAAI,CAAA,UAAU,YACb,SAAA,CAAAC,MAACqI,EAAM,CAAA,QAAQ,kBAAkB,UAAU,sBAAsB,SAAY,eAAA,EAC7ErI,EAAA,IAACgJ,GAAA,CACC,GAAG,kBACF,GAAGpD,EAAS,iBAAiB,EAC9B,KAAM,EACN,YAAY,kCAAA,CACd,QACC,IAAA,CAAE,UAAU,gCAAgC,SAAmD,sDAAA,CAAA,EAClG,CAAA,EACF,SAECiD,GAAA,CAAY,MAAM,KAAK,UAAU,iBAChC,SAAA,CAAC9I,EAAAA,KAAA,MAAA,CAAI,UAAU,YACb,SAAA,CAAAC,MAACqI,EAAM,CAAA,QAAQ,UAAU,UAAU,sBAAsB,SAAmB,sBAAA,EAC5ErI,EAAA,IAACsI,EAAA,CACC,GAAG,UACF,GAAG1C,EAAS,SAAS,EACtB,YAAY,kCACZ,UAAU,WAAA,CACZ,EACCE,EAAO,SACL9F,MAAA,IAAA,CAAE,UAAU,2BAA4B,SAAA8F,EAAO,QAAQ,OAAA,CAAQ,CAAA,EAEpE,EACC/F,EAAAA,KAAA,MAAI,CAAA,UAAU,YACb,SAAA,OAACsI,EAAA,CAAM,UAAU,sBAAsB,SAA+B,kCAAA,EACrE5C,EAAM,IAAI,CAACqD,EAAM1J,UACf,MAAA,CAAgB,UAAU,0BACzB,SAAAY,EAAA,IAACsI,EAAA,CACC,YAAY,gBACZ,MAAOQ,EAAK,GACZ,SAAW3I,GAAMmG,EAAWlH,EAAO,KAAMe,EAAE,OAAO,KAAK,CAAA,CAAA,CAJjD,EAAAf,CAMV,CACD,CAAA,EACH,EACCW,EAAAA,KAAA,MAAI,CAAA,UAAU,YACb,SAAA,CAAAC,MAACqI,EAAM,CAAA,QAAQ,iBAAiB,UAAU,sBAAsB,SAAS,YAAA,EACzErI,EAAA,IAAC+I,GAAA,CACC,MAAO/C,EAAM,gBAAgB,GAAK,GAClC,SAAWQ,GAAUT,EAAS,iBAAkBS,CAAK,EACrD,YAAY,sCAAA,CACd,CAAA,EACF,EACCzG,EAAAA,KAAA,MAAI,CAAA,UAAU,YACb,SAAA,CAAAC,MAACqI,EAAM,CAAA,QAAQ,kBAAkB,UAAU,sBAAsB,SAAO,UAAA,EACxErI,EAAA,IAACgJ,GAAA,CACC,GAAG,kBACF,GAAGpD,EAAS,iBAAiB,EAC9B,KAAM,EACN,YAAY,gCAAA,CACd,QACC,IAAA,CAAE,UAAU,gCAAgC,SAA0D,6DAAA,CAAA,EACzG,CAAA,EACF,CAAA,EACF,CAAA,CAAA,CACF,CAAA,CACF,QAGChD,EAAK,CAAA,UAAU,oBACd,SAAC7C,EAAA,KAAAkD,EAAA,CAAY,UAAU,gBACrB,SAAA,CAAClD,EAAAA,KAAAsI,EAAA,CAAM,UAAU,kDACf,SAAA,CAACrI,EAAAA,IAAAiJ,EAAA,CAAO,UAAU,uBAAuB,EACxC3I,EAAE,0BAA0B,CAAA,EAC/B,EACCP,EAAAA,KAAA,MAAI,CAAA,UAAU,wCACb,SAAA,CAACA,EAAAA,KAAA,MAAA,CAAI,UAAU,YACb,SAAA,QAACsI,EAAM,CAAA,QAAQ,UAAU,UAAU,8CACjC,SAAA,CAACrI,EAAAA,IAAAiJ,EAAA,CAAO,UAAU,UAAU,EAC3B3I,EAAE,eAAe,CAAA,EACpB,EACCN,EAAAA,IAAAsI,EAAM,CAAA,GAAG,UAAW,GAAG1C,EAAS,SAAS,EAAG,YAAatF,EAAE,oBAAoB,EAAG,EAClFwF,EAAO,SACL9F,MAAA,IAAA,CAAE,UAAU,2BAA4B,SAAA8F,EAAO,QAAQ,OAAA,CAAQ,CAAA,EAEpE,EACC/F,EAAAA,KAAA,MAAI,CAAA,UAAU,YACb,SAAA,QAACsI,EAAM,CAAA,QAAQ,QAAQ,UAAU,8CAC/B,SAAA,CAACrI,EAAAA,IAAAkJ,GAAA,CAAM,UAAU,UAAU,EAC1B5I,EAAE,aAAa,CAAA,EAClB,EACAN,MAACsI,GAAM,GAAG,QAAS,GAAG1C,EAAS,OAAO,EAAG,YAAY,UAAU,CAAA,EACjE,CAAA,EACF,EACC7F,EAAAA,KAAA,MAAI,CAAA,UAAU,wCACb,SAAA,CAACA,EAAAA,KAAA,MAAA,CAAI,UAAU,YACb,SAAA,QAACsI,EAAM,CAAA,QAAQ,cAAc,UAAU,8CACrC,SAAA,CAACrI,EAAAA,IAAAmJ,GAAA,CAAQ,UAAU,UAAU,EAC5B7I,EAAE,eAAe,CAAA,EACpB,EACAN,EAAA,IAACsI,EAAA,CACC,GAAG,cACF,GAAG1C,EAAS,aAAa,EAC1B,YAAY,WACZ,SAAU,CAACnB,EACX,SAAU,CAACA,EACX,UAAYA,EAA0C,GAAhC,6BAAgC,CACxD,EACC,CAACA,GACCzE,MAAA,IAAA,CAAE,UAAU,gCAAiC,SAAAM,EAAE,uBAAuB,EAAE,CAAA,EAE7E,EACCmE,GACE1E,EAAA,KAAA,MAAI,CAAA,UAAU,YACb,SAAA,QAACsI,EAAM,CAAA,QAAQ,SAAS,UAAU,8CAChC,SAAA,CAACrI,EAAAA,IAAAoJ,GAAA,CAAI,UAAU,UAAU,EAAE,cAAA,EAE7B,EACApJ,EAAA,IAACsI,EAAA,CACC,GAAG,SACF,GAAG1C,EAAS,QAAQ,EACrB,YAAY,gBAAA,CACd,CAAA,EACF,EAED7F,EAAAA,KAAA,MAAI,CAAA,UAAU,mCACb,SAAA,CAAAC,EAAA,IAACqJ,EAAA,CACC,GAAG,sBACH,QAASzC,GACT,gBAAkB4B,GAAYzC,EAAS,sBAAuByC,CAAkB,CAAA,CAClF,EACAxI,EAAAA,IAACqI,GAAM,QAAQ,sBAAsB,UAAU,yBAC5C,SAAA/H,EAAE,yBAAyB,EAC9B,CAAA,EACF,CAAA,EACF,CAAA,CAAA,CACF,CAAA,CACF,QAGCsC,EAAK,CAAA,UAAU,oBACd,SAAC7C,EAAA,KAAAkD,EAAA,CAAY,UAAU,gBACrB,SAAA,CAAClD,EAAAA,KAAAsI,EAAA,CAAM,UAAU,kDACf,SAAA,CAACrI,EAAAA,IAAAiJ,EAAA,CAAO,UAAU,uBAAuB,EACxC3I,EAAE,gBAAgB,CAAA,EACrB,EACCP,EAAAA,KAAA,MAAI,CAAA,UAAU,8BACb,SAAA,CAACA,EAAAA,KAAA,MAAA,CAAI,UAAU,YACb,SAAA,CAAAC,EAAAA,IAACqI,GAAM,QAAQ,MAAM,UAAU,sBAAuB,SAAA/H,EAAE,gBAAgB,EAAE,EAC1EN,EAAA,IAACsI,EAAA,CACC,GAAG,MACH,KAAK,SACL,KAAK,MACJ,GAAG1C,EAAS,MAAO,CAAE,cAAe,GAAM,CAAA,CAC7C,CAAA,EACF,EACC7F,EAAAA,KAAA,MAAI,CAAA,UAAU,YACb,SAAA,CAAAC,EAAAA,IAACqI,GAAM,QAAQ,MAAM,UAAU,sBAAuB,SAAA/H,EAAE,iBAAiB,EAAE,EAC3EN,EAAA,IAACsI,EAAA,CACC,GAAG,MACH,KAAK,SACL,KAAK,MACJ,GAAG1C,EAAS,MAAO,CAAE,cAAe,GAAM,CAAA,CAC7C,CAAA,EACF,CAAA,EACF,EACC5F,EAAAA,IAAA,MAAI,CAAA,IAAKkF,EAAc,UAAU,8DAA8D,MAAO,CAAE,UAAW,OAAQ,CAAA,CAAG,EAC9HnF,EAAAA,KAAA,IAAE,CAAA,UAAU,wDACX,SAAA,CAACC,EAAAA,IAAAiJ,EAAA,CAAO,UAAU,UAAU,EAC3B3I,EAAE,gCAAgC,CAAA,EACrC,CAAA,CAAA,CACF,CAAA,CACF,QAGCsC,EAAK,CAAA,UAAU,oCACd,SAAC7C,EAAA,KAAAkD,EAAA,CAAY,UAAU,uBACrB,SAAA,CAAClD,EAAAA,KAAAsI,EAAA,CAAM,UAAU,kDACf,SAAA,CAACrI,EAAAA,IAAAsJ,GAAA,CAAM,UAAU,uBAAuB,EACvChJ,EAAE,oBAAoB,CAAA,EACzB,EACCN,EAAA,IAAA,MAAI,CAAA,UAAU,YACZ,SAAAoE,GAAK,IAAKoB,GACRzF,EAAA,KAAA,MAAc,CAAA,UAAU,sEAEvB,SAAA,CAACA,EAAAA,KAAA,MAAA,CAAI,UAAU,sBACb,SAAA,CAACA,EAAAA,KAAA,MAAA,CAAI,UAAU,oCACb,SAAA,CAAAC,EAAAA,IAACqI,GAAM,UAAU,mCAAoC,WAAE,aAAa7C,CAAG,EAAE,CAAA,CAAE,EAC1EzF,EAAAA,KAAA,MAAI,CAAA,UAAU,0BACb,SAAA,CAACA,EAAAA,KAAA,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAC,EAAA,IAACqJ,EAAA,CACC,GAAI,gBAAgB7D,CAAG,GACvB,QAASH,EAAaG,CAAG,EAAE,WAC3B,gBAAkBgD,GAChBlD,EAAgB,CACd,GAAGD,EACH,CAACG,CAAG,EAAG,CAAE,GAAGH,EAAaG,CAAG,EAAG,WAAYgD,CAAmB,CAAA,CAC/D,EAEH,SAAUnD,EAAaG,CAAG,EAAE,OAC5B,UAAU,SAAA,CACZ,EACAxF,EAAAA,IAACqI,GAAM,QAAS,gBAAgB7C,CAAG,GAAI,UAAU,yBAAyB,SAE1E,IAAA,CAAA,CAAA,EACF,EACCzF,EAAAA,KAAA,MAAI,CAAA,UAAU,0BACb,SAAA,CAAAC,EAAA,IAACqJ,EAAA,CACC,GAAI,iBAAiB7D,CAAG,GACxB,QAASH,EAAaG,CAAG,EAAE,OAC3B,gBAAkBgD,GAChBlD,EAAgB,CACd,GAAGD,EACH,CAACG,CAAG,EAAG,CAAE,GAAGH,EAAaG,CAAG,EAAG,OAAQgD,CAAmB,CAAA,CAC3D,EAEH,UAAU,SAAA,CACZ,EACCxI,EAAAA,IAAAqI,EAAM,CAAA,QAAS,iBAAiB7C,CAAG,GAAI,UAAU,yBAC/C,SAAElF,EAAA,cAAc,EACnB,CAAA,EACF,CAAA,EACF,CAAA,EACF,EAEC,CAAC+E,EAAaG,CAAG,EAAE,QACjBxF,EAAA,IAAA,MAAI,CAAA,UAAU,cACZ,SAAAqF,EAAaG,CAAG,EAAE,WAChBzF,EAAA,KAAA,MAAA,CAAI,UAAU,cACb,SAAA,CAACA,EAAAA,KAAA,MAAA,CAAI,UAAU,wDACb,SAAA,OAAC,OAAA,CAAK,UAAU,gCAAgC,SAAE,KAAA,EAClDC,EAAA,IAACsI,EAAA,CACC,KAAK,OACL,MAAOjD,EAAaG,CAAG,EAAE,KACzB,SAAWrF,GACTmF,EAAgB,CACd,GAAGD,EACH,CAACG,CAAG,EAAG,CAAE,GAAGH,EAAaG,CAAG,EAAG,KAAMrF,EAAE,OAAO,KAAM,CAAA,CACrD,EAEH,UAAU,0BAAA,CACZ,QACC,OAAA,CAAK,UAAU,4CAA4C,SAAC,IAAA,EAC7DH,EAAA,IAACsI,EAAA,CACC,KAAK,OACL,MAAOjD,EAAaG,CAAG,EAAE,MACzB,SAAWrF,GACTmF,EAAgB,CACd,GAAGD,EACH,CAACG,CAAG,EAAG,CAAE,GAAGH,EAAaG,CAAG,EAAG,MAAOrF,EAAE,OAAO,KAAM,CAAA,CACtD,EAEH,UAAU,0BAAA,CACZ,CAAA,EACF,EACCJ,EAAAA,KAAA,MAAI,CAAA,UAAU,wDACb,SAAA,OAAC,OAAA,CAAK,UAAU,gCAAgC,SAAE,KAAA,EAClDC,EAAA,IAACsI,EAAA,CACC,KAAK,OACL,MAAOjD,EAAaG,CAAG,EAAE,OAAS,QAClC,SAAWrF,GACTmF,EAAgB,CACd,GAAGD,EACH,CAACG,CAAG,EAAG,CAAE,GAAGH,EAAaG,CAAG,EAAG,MAAOrF,EAAE,OAAO,KAAM,CAAA,CACtD,EAEH,UAAU,0BAAA,CACZ,QACC,OAAA,CAAK,UAAU,4CAA4C,SAAC,IAAA,EAC7DH,EAAA,IAACsI,EAAA,CACC,KAAK,OACL,MAAOjD,EAAaG,CAAG,EAAE,QAAU,QACnC,SAAWrF,GACTmF,EAAgB,CACd,GAAGD,EACH,CAACG,CAAG,EAAG,CAAE,GAAGH,EAAaG,CAAG,EAAG,OAAQrF,EAAE,OAAO,KAAM,CAAA,CACvD,EAEH,UAAU,0BAAA,CACZ,CAAA,EACF,CAAA,CACF,CAAA,EAEAJ,EAAAA,KAAC,MAAI,CAAA,UAAU,mDACb,SAAA,CAAAC,EAAA,IAACsI,EAAA,CACC,KAAK,OACL,MAAOjD,EAAaG,CAAG,EAAE,KACzB,SAAWrF,GACTmF,EAAgB,CACd,GAAGD,EACH,CAACG,CAAG,EAAG,CAAE,GAAGH,EAAaG,CAAG,EAAG,KAAMrF,EAAE,OAAO,KAAM,CAAA,CACrD,EAEH,UAAU,0BAAA,CACZ,QACC,OAAA,CAAK,UAAU,4CAA4C,SAAC,IAAA,EAC7DH,EAAA,IAACsI,EAAA,CACC,KAAK,OACL,MAAOjD,EAAaG,CAAG,EAAE,MACzB,SAAWrF,GACTmF,EAAgB,CACd,GAAGD,EACH,CAACG,CAAG,EAAG,CAAE,GAAGH,EAAaG,CAAG,EAAG,MAAOrF,EAAE,OAAO,KAAM,CAAA,CACtD,EAEH,UAAU,0BAAA,CACZ,CAAA,CAAA,CACF,CAAA,CAEJ,CAAA,EAEJ,EAGCJ,EAAAA,KAAA,MAAI,CAAA,UAAU,kBACb,SAAA,CAACA,EAAAA,KAAA,MAAA,CAAI,UAAU,qDACb,SAAA,CAAAC,EAAAA,IAACqI,GAAM,UAAU,2BAA4B,WAAE,aAAa7C,CAAG,EAAE,CAAA,CAAE,EAClEzF,EAAAA,KAAA,MAAI,CAAA,UAAU,0BACb,SAAA,CAAAC,EAAA,IAACqJ,EAAA,CACC,GAAI,SAAS7D,CAAG,GAChB,QAASH,EAAaG,CAAG,EAAE,WAC3B,gBAAkBgD,GAChBlD,EAAgB,CACd,GAAGD,EACH,CAACG,CAAG,EAAG,CAAE,GAAGH,EAAaG,CAAG,EAAG,WAAYgD,CAAmB,CAAA,CAC/D,EAEH,SAAUnD,EAAaG,CAAG,EAAE,MAAA,CAC9B,EACAxF,EAAAA,IAACqI,GAAM,QAAS,SAAS7C,CAAG,GAAI,UAAU,yBAAyB,SAEnE,MAAA,CAAA,CAAA,EACF,EACCzF,EAAAA,KAAA,MAAI,CAAA,UAAU,8BACb,SAAA,CAAAC,EAAA,IAACqJ,EAAA,CACC,GAAI,UAAU7D,CAAG,GACjB,QAASH,EAAaG,CAAG,EAAE,OAC3B,gBAAkBgD,GAChBlD,EAAgB,CACd,GAAGD,EACH,CAACG,CAAG,EAAG,CAAE,GAAGH,EAAaG,CAAG,EAAG,OAAQgD,CAAmB,CAAA,CAC3D,CAAA,CAEL,EACCxI,EAAAA,IAAAqI,EAAM,CAAA,QAAS,UAAU7C,CAAG,GAAI,UAAU,iBACxC,SAAElF,EAAA,cAAc,EACnB,CAAA,EACF,CAAA,EACF,EAEC,CAAC+E,EAAaG,CAAG,EAAE,QACjBxF,EAAA,IAAA,MAAI,CAAA,UAAU,4BACZ,SAAAqF,EAAaG,CAAG,EAAE,WAChBzF,EAAA,KAAA,MAAA,CAAI,UAAU,YACb,SAAA,CAACA,EAAAA,KAAA,MAAA,CAAI,UAAU,0BACb,SAAA,OAAC,OAAA,CAAK,UAAU,qCAAqC,SAAE,KAAA,EACvDC,EAAA,IAACsI,EAAA,CACC,KAAK,OACL,MAAOjD,EAAaG,CAAG,EAAE,KACzB,SAAWrF,GACTmF,EAAgB,CACd,GAAGD,EACH,CAACG,CAAG,EAAG,CAAE,GAAGH,EAAaG,CAAG,EAAG,KAAMrF,EAAE,OAAO,KAAM,CAAA,CACrD,EAEH,UAAU,MAAA,CACZ,QACC,OAAA,CAAK,UAAU,wBAAwB,SAAC,IAAA,EACzCH,EAAA,IAACsI,EAAA,CACC,KAAK,OACL,MAAOjD,EAAaG,CAAG,EAAE,MACzB,SAAWrF,GACTmF,EAAgB,CACd,GAAGD,EACH,CAACG,CAAG,EAAG,CAAE,GAAGH,EAAaG,CAAG,EAAG,MAAOrF,EAAE,OAAO,KAAM,CAAA,CACtD,EAEH,UAAU,MAAA,CACZ,CAAA,EACF,EACCJ,EAAAA,KAAA,MAAI,CAAA,UAAU,0BACb,SAAA,OAAC,OAAA,CAAK,UAAU,qCAAqC,SAAE,KAAA,EACvDC,EAAA,IAACsI,EAAA,CACC,KAAK,OACL,MAAOjD,EAAaG,CAAG,EAAE,OAAS,QAClC,SAAWrF,GACTmF,EAAgB,CACd,GAAGD,EACH,CAACG,CAAG,EAAG,CAAE,GAAGH,EAAaG,CAAG,EAAG,MAAOrF,EAAE,OAAO,KAAM,CAAA,CACtD,EAEH,UAAU,MAAA,CACZ,QACC,OAAA,CAAK,UAAU,wBAAwB,SAAC,IAAA,EACzCH,EAAA,IAACsI,EAAA,CACC,KAAK,OACL,MAAOjD,EAAaG,CAAG,EAAE,QAAU,QACnC,SAAWrF,GACTmF,EAAgB,CACd,GAAGD,EACH,CAACG,CAAG,EAAG,CAAE,GAAGH,EAAaG,CAAG,EAAG,OAAQrF,EAAE,OAAO,KAAM,CAAA,CACvD,EAEH,UAAU,MAAA,CACZ,CAAA,EACF,CAAA,CACF,CAAA,EAEAJ,EAAAA,KAAC,MAAI,CAAA,UAAU,0BACb,SAAA,CAAAC,EAAA,IAACsI,EAAA,CACC,KAAK,OACL,MAAOjD,EAAaG,CAAG,EAAE,KACzB,SAAWrF,GACTmF,EAAgB,CACd,GAAGD,EACH,CAACG,CAAG,EAAG,CAAE,GAAGH,EAAaG,CAAG,EAAG,KAAMrF,EAAE,OAAO,KAAM,CAAA,CACrD,EAEH,UAAU,MAAA,CACZ,QACC,OAAA,CAAK,UAAU,wBAAwB,SAAC,IAAA,EACzCH,EAAA,IAACsI,EAAA,CACC,KAAK,OACL,MAAOjD,EAAaG,CAAG,EAAE,MACzB,SAAWrF,GACTmF,EAAgB,CACd,GAAGD,EACH,CAACG,CAAG,EAAG,CAAE,GAAGH,EAAaG,CAAG,EAAG,MAAOrF,EAAE,OAAO,KAAM,CAAA,CACtD,EAEH,UAAU,MAAA,CACZ,CAAA,CAAA,CACF,CAAA,CAEJ,CAAA,EAEJ,CAAA,GA7PQqF,CA8PV,CACD,EACH,CAAA,CAAA,CACF,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CACF,EAECzF,EAAAA,KAAA,MAAI,CAAA,UAAU,wDACb,SAAA,OAACG,EAAO,CAAA,KAAK,SAAS,QAAQ,UAAU,QAAS,IAAMyE,EAAQ,EAAK,EACjE,SAAErE,EAAA,eAAe,EACpB,EACCP,EAAAA,KAAAG,EAAO,CAAA,KAAK,SAAS,SAAU8E,EAAc,QAASa,EAAa8B,EAAQ,EAAG,UAAU,QACvF,SAAA,CAAC3H,EAAAA,IAAAkI,GAAA,CAAM,UAAU,UAAU,EACX5H,EAAf0E,EAAiB,gBAAqB,aAAN,CAAmB,EACtD,CAAA,EACF,CAAA,EACF,GACF,CAEJ"}