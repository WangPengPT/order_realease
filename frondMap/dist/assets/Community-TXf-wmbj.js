import{p as A,u as ts,r as m,j as e,ea as te,bm as as,cr as rs,bf as oe,bD as Ue,ba as ns,b5 as je,be as is,bJ as Le,bI as he,ao as ls,b4 as ge,X as Z,ei as Te,a4 as Y,a_ as Ee,ej as $,ek as cs,bN as ye,aM as ae,bh as ve,eb as os,ec as De,ay as ds,aw as ms,w as S,ak as Fe,bW as le,d0 as us,q as $e,v as xs,bR as ce,b7 as ps,el as hs,cQ as gs,em as fs,bc as js,bb as ys}from"./vendor-react-3frukg7q.js";import{u as vs,g as K,P as Ns,Q as bs,R as ws,D as ks,W as Cs,c as Ss,d as Rs,e as _s,a as de,I as z,B as T,i as F,S as Me,U as O,a8 as Ne,a2 as Ps,a3 as Is,a4 as Us,a5 as Ls,a6 as Ts,s as I,G as Es,af as Ds,ak as Fs,ag as $s,al as Ms,j as X}from"./index-DBl0LkXN.js";import{a as As,f as qs,g as Os,h as zs,u as Bs,i as Hs}from"./useCommunityPosts-B56e2sFC.js";import{u as me}from"./useLocalizedContent-CqXl0rku.js";import{c as Vs}from"./usePoints-B0l-kRFR.js";import{D as be,b as we,c as ke,d as Ce,f as Ae}from"./drawer-P_E3SVyF.js";import{P as Se,a as Re,b as _e}from"./popover-BEpZj3Ho.js";import{P as Ks}from"./progress-CNQkUshi.js";import{C as Gs,a as Qs,b as Ws}from"./collapsible-BMuahlhm.js";import{u as Js}from"./useActivities-CiIZkAMt.js";import{u as Xs}from"./useRestaurants-DJgnWpFb.js";import{P as Ys}from"./PullToRefresh-KDxOc2Xn.js";import"./vendor-i18n-jtdHZIRR.js";import"./vendor-editor-B1vH4T8i.js";import"./vendor-utils-vwQGbBim.js";import"./vendor-supabase-CcYybVOv.js";const Zs=({post:t,showAssociations:a=!1})=>{const{t:s}=A(),{user:f}=vs(),o=ts(),{getLocalizedField:d}=me(),j=As(),[u,r]=m.useState(!1),h=t,c=h.post_type==="recipe",p=n=>{n.preventDefault(),n.stopPropagation(),f&&j.mutate({postId:t.id,liked:t.user_liked||!1})},x=()=>o(`/community/${t.id}`),v=(n,g)=>{n.preventDefault(),n.stopPropagation(),o(`/restaurant/${g}`)},w=n=>{n.preventDefault(),n.stopPropagation(),t.activity?.id&&o(`/activity/${t.activity.id}`)},i=n=>new DOMParser().parseFromString(n,"text/html").body.textContent||"",N=d(t,"content"),y=i(N),C=t.image_urls&&t.image_urls.length>0,_=!!t.video_url,P=C||_,q=t.image_urls?.length||0,E=[...t.restaurants||[],...t.restaurant&&!t.restaurants?.find(n=>n.id===t.restaurant?.id)?[t.restaurant]:[]],V=t.activity?d(t.activity,"title"):null,B=2,D=n=>{switch(n){case"easy":return"bg-green-500/20 text-green-700 dark:text-green-400";case"medium":return"bg-yellow-500/20 text-yellow-700 dark:text-yellow-400";case"hard":return"bg-red-500/20 text-red-700 dark:text-red-400";default:return"bg-muted text-muted-foreground"}},l=n=>{switch(n){case"easy":return s("recipe.difficulty.easy","ç®€å•");case"medium":return s("recipe.difficulty.medium","ä¸­ç­‰");case"hard":return s("recipe.difficulty.hard","å›°éš¾");default:return n}};return e.jsxs("div",{className:"group cursor-pointer rounded-lg overflow-hidden bg-card border border-border/50 hover:shadow-lg transition-all duration-300 hover:-translate-y-1",onClick:x,children:[P&&e.jsxs("div",{className:`relative ${c?"aspect-[4/3]":"aspect-[4/5]"} overflow-hidden`,children:[C?u?e.jsx("div",{className:"w-full h-full bg-muted flex items-center justify-center",children:e.jsx("span",{className:"text-xs text-muted-foreground",children:s("common.imageLoadError","å›¾ç‰‡åŠ è½½å¤±è´¥")})}):e.jsx("img",{src:t.image_urls[0],alt:"",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500",onError:()=>r(!0)}):_?e.jsx("video",{src:t.video_url,className:"w-full h-full object-cover",preload:"metadata",muted:!0,playsInline:!0}):null,c&&e.jsxs(K,{className:"absolute top-2 left-2 bg-primary text-primary-foreground gap-1",children:[e.jsx(te,{className:"h-3 w-3"}),s("recipe.badge","é£Ÿè°±")]}),_&&!c&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:e.jsx("div",{className:"w-12 h-12 rounded-full bg-black/50 backdrop-blur-sm flex items-center justify-center",children:e.jsx(as,{className:"h-5 w-5 text-white fill-white ml-0.5"})})}),!_&&q>1&&!c&&e.jsxs("div",{className:"absolute top-2 right-2 bg-black/60 text-white text-xs px-2 py-0.5 rounded-full z-10 flex items-center gap-1",children:[e.jsx(rs,{className:"h-3 w-3"}),e.jsx("span",{children:q})]})]}),!P&&c&&e.jsxs("div",{className:"relative aspect-[4/3] overflow-hidden bg-gradient-to-br from-primary/20 to-primary/5 flex items-center justify-center",children:[e.jsx(te,{className:"h-12 w-12 text-primary/40"}),e.jsxs(K,{className:"absolute top-2 left-2 bg-primary text-primary-foreground gap-1",children:[e.jsx(te,{className:"h-3 w-3"}),s("recipe.badge","é£Ÿè°±")]})]}),e.jsxs("div",{className:"p-3",children:[c&&e.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground mb-2",children:[h.cook_time&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(oe,{className:"h-3.5 w-3.5"}),e.jsxs("span",{children:[h.cook_time,s("recipe.min","åˆ†")]})]}),h.servings&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ue,{className:"h-3.5 w-3.5"}),e.jsxs("span",{children:[h.servings,s("recipe.servingsShort","äºº")]})]}),h.difficulty&&e.jsx(K,{variant:"secondary",className:`text-xs px-1.5 py-0 h-5 ${D(h.difficulty)}`,children:l(h.difficulty)})]}),a&&(E.length>0||V)&&e.jsxs("div",{className:"flex flex-wrap gap-1.5 mb-2",children:[E.slice(0,B).map(n=>e.jsxs(K,{variant:"secondary",className:"text-xs cursor-pointer hover:bg-secondary/80 gap-1",onClick:g=>v(g,n.id),children:[e.jsx(ns,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate max-w-[120px]",children:d(n,"name")})]},n.id)),E.length>B&&e.jsxs(K,{variant:"secondary",className:"text-xs gap-1",children:["+",E.length-B]}),V&&e.jsxs(K,{variant:"secondary",className:"text-xs cursor-pointer hover:bg-secondary/80 gap-1",onClick:w,children:[e.jsx(je,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate max-w-[120px]",children:V})]})]}),e.jsx("p",{className:`text-sm font-medium line-clamp-2 leading-relaxed ${P?"":"min-h-[60px]"}`,children:c?h.recipe_name:y}),e.jsxs("div",{className:"flex items-center justify-between mt-3",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[e.jsxs(Ns,{className:"h-5 w-5 flex-shrink-0",children:[e.jsx(bs,{src:t.author?.avatar_url||void 0}),e.jsx(ws,{className:"text-[10px]",children:t.author?.display_name?.charAt(0)||"?"})]}),e.jsx("span",{className:"text-xs text-muted-foreground truncate",children:t.author?.display_name})]}),e.jsxs("button",{className:`flex items-center gap-1 text-xs ${t.user_liked?"text-red-500":"text-muted-foreground"} hover:text-red-500 transition-colors`,onClick:p,disabled:!f,children:[e.jsx(is,{className:`h-4 w-4 ${t.user_liked?"fill-current":""}`}),e.jsx("span",{children:t.likes_count||0})]})]})]})]})},et=()=>{const{t}=A(),{data:a}=Vs(),s=a?.find(d=>d.key==="post_points")?.value||"5",f=a?.find(d=>d.key==="min_post_length")?.value||"10",o=a?.find(d=>d.key==="post_require_media")?.value==="true";return e.jsxs(ks,{children:[e.jsx(Cs,{asChild:!0,children:e.jsx("button",{className:"text-primary hover:underline text-sm whitespace-nowrap",children:t("community.viewPointsRules","æŸ¥çœ‹è¯¦ç»†è§„åˆ™")})}),e.jsxs(Ss,{className:"max-w-md",children:[e.jsx(Rs,{children:e.jsxs(_s,{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"h-5 w-5 text-primary"}),t("community.pointsRulesTitle","å‘å¸–ç§¯åˆ†è§„åˆ™")]})}),e.jsxs("div",{className:"space-y-4 pt-2",children:[e.jsx("p",{className:"text-muted-foreground text-sm",children:t("community.pointsRulesIntro","é€šè¿‡å‘å¸ƒç¤¾åŒºå¸–å­èŽ·å¾—ç§¯åˆ†ï¼Œå…·ä½“è§„åˆ™å¦‚ä¸‹ï¼š")}),e.jsxs("ul",{className:"space-y-3",children:[e.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[e.jsx(he,{className:"h-4 w-4 text-green-500 mt-0.5 shrink-0"}),e.jsx("span",{children:t("community.rulePostPoints",{points:s})})]}),e.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[e.jsx(he,{className:"h-4 w-4 text-green-500 mt-0.5 shrink-0"}),e.jsx("span",{children:t("community.ruleMinLength",{length:f})})]}),o&&e.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[e.jsx(he,{className:"h-4 w-4 text-green-500 mt-0.5 shrink-0"}),e.jsx("span",{children:t("community.ruleRequireMedia","å¸–å­å¿…é¡»åŒ…å«è‡³å°‘ä¸€å¼ å›¾ç‰‡æˆ–ä¸€ä¸ªè§†é¢‘")})]}),e.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[e.jsx(oe,{className:"h-4 w-4 text-blue-500 mt-0.5 shrink-0"}),e.jsx("span",{children:t("community.ruleDailyLimit","æ¯å¤©ä»…å¯é€šè¿‡å‘å¸–èŽ·å¾—ä¸€æ¬¡ç§¯åˆ†å¥–åŠ±")})]}),e.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[e.jsx(ls,{className:"h-4 w-4 text-purple-500 mt-0.5 shrink-0"}),e.jsx("span",{children:t("community.ruleModerationRequired","å¸–å­éœ€é€šè¿‡å®¡æ ¸åŽæ‰èƒ½èŽ·å¾—ç§¯åˆ†")})]})]})]})]})]})},st=({open:t,onOpenChange:a,value:s,onSelect:f,restaurants:o,required:d=!1,maxDisplay:j=2})=>{const{t:u}=A(),{getLocalizedField:r}=me(),h=de(),[c,p]=m.useState(""),[x,v]=m.useState(s),[w,i]=m.useState("85vh");m.useEffect(()=>{if(!t||!h)return;const l=window.visualViewport;if(!l){i("85vh");return}const n=()=>{const g=l.height,M=Math.min(g*.85,g-50);i(`${M}px`)};return n(),l.addEventListener("resize",n),()=>{l.removeEventListener("resize",n)}},[t,h]);const N=l=>{l&&(v(s),p("")),a(l)},y=o?.filter(l=>{if(!c)return!0;const n=r(l,"name")?.toLowerCase()||"",g=l.address?.toLowerCase()||"",M=c.toLowerCase();return n.includes(M)||g.includes(M)})||[],C=l=>{v(n=>n.includes(l)?n.filter(g=>g!==l):[...n,l])},_=()=>{f(x),a(!1),p("")},P=l=>{const n=s.includes(l)?s.filter(g=>g!==l):[...s,l];f(n)},E=s.map(l=>{const n=o?.find(g=>g.id===l);return n?r(n,"name"):null}).filter(Boolean),V=()=>{if(E.length===0)return e.jsxs("span",{className:"text-muted-foreground",children:[u("community.linkRestaurants","å…³è”é¤åŽ…"),d&&e.jsx("span",{className:"text-destructive ml-1",children:"*"})]});const l=E.slice(0,j),n=E.length-j;return e.jsxs("span",{className:"text-primary flex items-center gap-1 flex-wrap",children:[l.map((g,M)=>e.jsxs("span",{children:[g,M<l.length-1?"ã€":""]},M)),n>0&&e.jsxs(K,{variant:"secondary",className:"text-xs px-1.5 py-0",children:["+",n]})]})},B=e.jsxs("button",{type:"button",className:"flex items-center gap-1 text-sm hover:text-primary transition-colors text-left",onClick:()=>N(!0),children:[e.jsx(V,{}),e.jsx(Te,{className:"h-4 w-4 opacity-50 shrink-0"})]}),D=({restaurant:l,isSelected:n,onToggle:g})=>e.jsxs("div",{className:F("flex items-start gap-3 py-3 px-3 rounded-lg cursor-pointer transition-colors",n?"bg-primary/10":"hover:bg-muted"),onClick:g,children:[e.jsx("div",{className:F("h-5 w-5 shrink-0 mt-0.5 rounded border flex items-center justify-center transition-colors",n?"bg-primary border-primary":"border-muted-foreground/30"),children:n&&e.jsx(Y,{className:"h-3 w-3 text-primary-foreground"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:r(l,"name")}),l.address&&e.jsxs("p",{className:"text-sm text-muted-foreground truncate flex items-center gap-1 mt-0.5",children:[e.jsx(Ee,{className:"h-3 w-3 shrink-0"}),l.address]})]})]});return h?e.jsxs(e.Fragment,{children:[B,e.jsx(be,{open:t,onOpenChange:N,children:e.jsxs(we,{className:"flex flex-col",style:{height:w,maxHeight:w,transition:"height 0.15s ease-out, max-height 0.15s ease-out"},children:[e.jsx(ke,{className:"pb-2 shrink-0",children:e.jsxs(Ce,{children:[u("community.selectRestaurants","é€‰æ‹©é¤åŽ…"),x.length>0&&e.jsx(K,{variant:"secondary",className:"ml-2",children:x.length})]})}),e.jsx("div",{className:"px-4 pb-3 shrink-0",children:e.jsxs("div",{className:"relative",children:[e.jsx(ge,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(z,{placeholder:u("community.searchRestaurant","æœç´¢é¤åŽ…..."),value:c,onChange:l=>p(l.target.value),className:"pl-9"})]})}),x.length>0&&e.jsx("div",{className:"px-4 pb-3 shrink-0",children:e.jsx("div",{className:"flex flex-wrap gap-1.5",children:x.map(l=>{const n=o?.find(g=>g.id===l);return n?e.jsxs(K,{variant:"secondary",className:"gap-1 pr-1",children:[e.jsx("span",{className:"truncate max-w-[120px]",children:r(n,"name")}),e.jsx("button",{type:"button",className:"hover:bg-muted-foreground/20 rounded-full p-0.5",onClick:g=>{g.stopPropagation(),v(M=>M.filter(H=>H!==l))},children:e.jsx(Z,{className:"h-3 w-3"})})]},l):null})})}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 min-h-0",children:e.jsxs("div",{className:"space-y-1 pb-4",children:[y.map(l=>e.jsx(D,{restaurant:l,isSelected:x.includes(l.id),onToggle:()=>C(l.id)},l.id)),y.length===0&&c&&e.jsx("div",{className:"py-6 text-center text-muted-foreground",children:u("community.noRestaurantFound","æœªæ‰¾åˆ°åŒ¹é…çš„é¤åŽ…")})]})}),e.jsx(Ae,{className:"pt-2",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(T,{variant:"outline",className:"flex-1",onClick:()=>N(!1),children:u("common.cancel","å–æ¶ˆ")}),e.jsxs(T,{className:"flex-1",onClick:_,children:[u("community.confirmSelection","ç¡®è®¤é€‰æ‹©"),x.length>0&&` (${x.length})`]})]})})]})})]}):e.jsxs(Se,{open:t,onOpenChange:N,children:[e.jsx(Re,{asChild:!0,children:B}),e.jsxs(_e,{className:"w-80 p-0",align:"start",children:[e.jsx("div",{className:"p-3 border-b",children:e.jsxs("div",{className:"relative",children:[e.jsx(ge,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(z,{placeholder:u("community.searchRestaurant","æœç´¢é¤åŽ…..."),value:c,onChange:l=>p(l.target.value),className:"pl-9"})]})}),s.length>0&&e.jsx("div",{className:"p-3 border-b",children:e.jsx("div",{className:"flex flex-wrap gap-1.5",children:s.map(l=>{const n=o?.find(g=>g.id===l);return n?e.jsxs(K,{variant:"secondary",className:"gap-1 pr-1",children:[e.jsx("span",{className:"truncate max-w-[100px]",children:r(n,"name")}),e.jsx("button",{type:"button",className:"hover:bg-muted-foreground/20 rounded-full p-0.5",onClick:g=>{g.stopPropagation(),P(l)},children:e.jsx(Z,{className:"h-3 w-3"})})]},l):null})})}),e.jsxs("div",{className:"max-h-64 overflow-y-auto p-2",children:[y.map(l=>e.jsx(D,{restaurant:l,isSelected:s.includes(l.id),onToggle:()=>P(l.id)},l.id)),y.length===0&&c&&e.jsx("div",{className:"py-4 text-center text-muted-foreground text-sm",children:u("community.noRestaurantFound","æœªæ‰¾åˆ°åŒ¹é…çš„é¤åŽ…")})]})]})]})},qe=m.forwardRef(({className:t,...a},s)=>e.jsx($,{ref:s,className:F("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",t),...a}));qe.displayName=$.displayName;const tt=m.forwardRef(({className:t,...a},s)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(ge,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx($.Input,{ref:s,className:F("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",t),...a})]}));tt.displayName=$.Input.displayName;const Oe=m.forwardRef(({className:t,...a},s)=>e.jsx($.List,{ref:s,className:F("max-h-[300px] overflow-y-auto overflow-x-hidden",t),...a}));Oe.displayName=$.List.displayName;const at=m.forwardRef((t,a)=>e.jsx($.Empty,{ref:a,className:"py-6 text-center text-sm",...t}));at.displayName=$.Empty.displayName;const ze=m.forwardRef(({className:t,...a},s)=>e.jsx($.Group,{ref:s,className:F("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",t),...a}));ze.displayName=$.Group.displayName;const rt=m.forwardRef(({className:t,...a},s)=>e.jsx($.Separator,{ref:s,className:F("-mx-1 h-px bg-border",t),...a}));rt.displayName=$.Separator.displayName;const fe=m.forwardRef(({className:t,...a},s)=>e.jsx($.Item,{ref:s,className:F("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",t),...a}));fe.displayName=$.Item.displayName;const nt=({open:t,onOpenChange:a,value:s,onSelect:f,activities:o})=>{const{t:d}=A(),{getLocalizedField:j}=me(),u=de(),[r,h]=m.useState(s),c=i=>{i&&h(s),a(i)},p=()=>{if(!s)return"";const i=o?.find(N=>N.id===s);return i?j(i,"title"):""},x=()=>{f(r),a(!1)},v=i=>{f(i),a(!1)},w=e.jsxs("button",{type:"button",className:"flex items-center gap-1 text-sm hover:text-primary transition-colors",onClick:()=>c(!0),children:[s?e.jsx("span",{className:"text-primary",children:p()}):e.jsx("span",{className:"text-muted-foreground",children:d("community.linkActivity","å…³è”æ´»åŠ¨")}),e.jsx(Te,{className:"h-4 w-4 opacity-50"})]});return u?e.jsxs(e.Fragment,{children:[w,e.jsx(be,{open:t,onOpenChange:c,children:e.jsxs(we,{className:"max-h-[85vh] flex flex-col",children:[e.jsx(ke,{className:"pb-2",children:e.jsx(Ce,{children:d("community.selectActivity","é€‰æ‹©æ´»åŠ¨")})}),e.jsx(Me,{className:"flex-1 px-4",children:e.jsxs("div",{className:"space-y-1 pb-4",children:[e.jsxs("div",{className:F("flex items-center gap-3 py-3 px-3 rounded-lg cursor-pointer transition-colors",r===""?"bg-primary/10":"hover:bg-muted"),onClick:()=>h(""),children:[e.jsx(Y,{className:F("h-4 w-4 shrink-0",r===""?"opacity-100 text-primary":"opacity-0")}),e.jsx("span",{className:"text-muted-foreground",children:d("community.noActivity","ä¸å…³è”æ´»åŠ¨")})]}),o.map(i=>e.jsxs("div",{className:F("flex items-center gap-3 py-3 px-3 rounded-lg cursor-pointer transition-colors",r===i.id?"bg-primary/10":"hover:bg-muted"),onClick:()=>h(i.id),children:[e.jsx(Y,{className:F("h-4 w-4 shrink-0",r===i.id?"opacity-100 text-primary":"opacity-0")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-4 w-4 text-muted-foreground shrink-0"}),e.jsx("span",{className:"font-medium",children:j(i,"title")})]})]},i.id)),o.length===0&&e.jsx("div",{className:"py-6 text-center text-muted-foreground",children:d("activities.noActivities","æš‚æ— å¯ç”¨æ´»åŠ¨")})]})}),e.jsx(Ae,{className:"pt-2",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(T,{variant:"outline",className:"flex-1",onClick:()=>c(!1),children:d("common.cancel","å–æ¶ˆ")}),e.jsx(T,{className:"flex-1",onClick:x,children:d("community.confirmSelection","ç¡®è®¤é€‰æ‹©")})]})})]})})]}):e.jsxs(Se,{open:t,onOpenChange:c,children:[e.jsx(Re,{asChild:!0,children:w}),e.jsx(_e,{className:"w-72 p-0",align:"start",children:e.jsx(qe,{children:e.jsx(Oe,{children:e.jsxs(ze,{children:[e.jsxs(fe,{value:"none",onSelect:()=>v(""),children:[e.jsx(Y,{className:F("mr-2 h-4 w-4",s?"opacity-0":"opacity-100")}),d("community.noActivity","ä¸å…³è”æ´»åŠ¨")]}),o.map(i=>e.jsxs(fe,{value:i.id,onSelect:()=>v(i.id),children:[e.jsx(Y,{className:F("mr-2 h-4 w-4",s===i.id?"opacity-100":"opacity-0")}),j(i,"title")]},i.id))]})})})})]})},Ie=[{name:"smileys",emojis:["ðŸ˜€","ðŸ˜ƒ","ðŸ˜„","ðŸ˜","ðŸ˜†","ðŸ˜…","ðŸ¤£","ðŸ˜‚","ðŸ™‚","ðŸ˜Š","ðŸ˜‡","ðŸ¥°","ðŸ˜","ðŸ¤©","ðŸ˜˜","ðŸ˜—","ðŸ˜š","ðŸ˜‹","ðŸ˜›","ðŸ˜œ","ðŸ¤ª","ðŸ˜","ðŸ¤‘","ðŸ¤—","ðŸ¤­","ðŸ¤«","ðŸ¤”","ðŸ¤","ðŸ¤¨","ðŸ˜","ðŸ˜‘","ðŸ˜¶","ðŸ˜","ðŸ˜’","ðŸ™„","ðŸ˜¬","ðŸ¤¥","ðŸ˜Œ","ðŸ˜”","ðŸ˜ª","ðŸ¤¤","ðŸ˜´","ðŸ˜·","ðŸ¤’","ðŸ¤•","ðŸ¤¢","ðŸ¤®","ðŸ¥µ","ðŸ¥¶","ðŸ¥´","ðŸ˜µ","ðŸ¤¯","ðŸ¤ ","ðŸ¥³","ðŸ˜Ž","ðŸ¤“","ðŸ§"]},{name:"gestures",emojis:["ðŸ‘","ðŸ‘Ž","ðŸ‘Œ","ðŸ¤Œ","âœŒï¸","ðŸ¤ž","ðŸ¤Ÿ","ðŸ¤˜","ðŸ¤™","ðŸ‘ˆ","ðŸ‘‰","ðŸ‘†","ðŸ‘‡","â˜ï¸","âœ‹","ðŸ¤š","ðŸ–ï¸","ðŸ––","ðŸ‘‹","ðŸ¤","ðŸ™","ðŸ’ª","ðŸ¦¾","ðŸ¦¿","ðŸ¦µ","ðŸ¦¶","ðŸ‘‚","ðŸ¦»","ðŸ‘ƒ","ðŸ§ ","ðŸ‘€","ðŸ‘ï¸","ðŸ‘…","ðŸ‘„"]},{name:"food",emojis:["ðŸ","ðŸŽ","ðŸ","ðŸŠ","ðŸ‹","ðŸŒ","ðŸ‰","ðŸ‡","ðŸ“","ðŸ«","ðŸˆ","ðŸ’","ðŸ‘","ðŸ¥­","ðŸ","ðŸ¥¥","ðŸ¥","ðŸ…","ðŸ†","ðŸ¥‘","ðŸ¥¦","ðŸ¥¬","ðŸ¥’","ðŸŒ¶ï¸","ðŸ«‘","ðŸŒ½","ðŸ¥•","ðŸ§„","ðŸ§…","ðŸ¥”","ðŸ ","ðŸ¥","ðŸ¥¯","ðŸž","ðŸ¥–","ðŸ¥¨","ðŸ§€","ðŸ¥š","ðŸ³","ðŸ§ˆ","ðŸ¥ž","ðŸ§‡","ðŸ¥“","ðŸ¥©","ðŸ—","ðŸ–","ðŸ¦´","ðŸŒ­","ðŸ”","ðŸŸ","ðŸ•","ðŸ«“","ðŸ¥ª","ðŸ¥™","ðŸ§†","ðŸŒ®","ðŸŒ¯","ðŸ«”","ðŸ¥—","ðŸ¥˜","ðŸ«•","ðŸ¥«","ðŸ","ðŸœ","ðŸ²","ðŸ›","ðŸ£","ðŸ±","ðŸ¥Ÿ","ðŸ¦ª","ðŸ¤","ðŸ™","ðŸš","ðŸ˜","ðŸ¥","ðŸ¥ ","ðŸ¥®","ðŸ¢","ðŸ¡","ðŸ§","ðŸ¨","ðŸ¦","ðŸ¥§","ðŸ§","ðŸ°","ðŸŽ‚","ðŸ®","ðŸ­","ðŸ¬","ðŸ«","ðŸ¿","ðŸ©","ðŸª"]},{name:"hearts",emojis:["â¤ï¸","ðŸ§¡","ðŸ’›","ðŸ’š","ðŸ’™","ðŸ’œ","ðŸ–¤","ðŸ¤","ðŸ¤Ž","ðŸ’”","â£ï¸","ðŸ’•","ðŸ’ž","ðŸ’“","ðŸ’—","ðŸ’–","ðŸ’˜","ðŸ’","ðŸ’Ÿ","â™¥ï¸"]},{name:"objects",emojis:["â­","ðŸŒŸ","âœ¨","ðŸ’«","ðŸ”¥","ðŸ’¯","ðŸŽ‰","ðŸŽŠ","ðŸŽˆ","ðŸŽ","ðŸ†","ðŸ¥‡","ðŸ¥ˆ","ðŸ¥‰","âš½","ðŸ€","ðŸˆ","âš¾","ðŸŽ¾","ðŸ","ðŸŽ±","ðŸ“","ðŸŽ®","ðŸŽ²","ðŸ§©","ðŸŽ­","ðŸŽ¨","ðŸŽ¬","ðŸŽ¤","ðŸŽ§","ðŸŽµ","ðŸŽ¶","ðŸŽ¹","ðŸŽ¸","ðŸŽº","ðŸŽ»","ðŸ“·","ðŸ“¸","ðŸ“¹","ðŸŽ¥","ðŸ“±","ðŸ’»","âŒ¨ï¸","ðŸ–¥ï¸","ðŸ“º","ðŸ“»","â°","âŒš","ðŸ’¡","ðŸ”¦","ðŸ“š","ðŸ“–","âœï¸","ðŸ“","ðŸ’°","ðŸ’µ","ðŸ’´","ðŸ’¶","ðŸ’·","ðŸ’³","ðŸ›’","ðŸŽ€","ðŸŽ—ï¸"]},{name:"nature",emojis:["ðŸŒ¸","ðŸ’®","ðŸµï¸","ðŸŒ¹","ðŸ¥€","ðŸŒº","ðŸŒ»","ðŸŒ¼","ðŸŒ·","ðŸŒ±","ðŸª´","ðŸŒ²","ðŸŒ³","ðŸŒ´","ðŸŒµ","ðŸŒ¾","ðŸŒ¿","â˜˜ï¸","ðŸ€","ðŸ","ðŸ‚","ðŸƒ","ðŸŒ","ðŸŒŽ","ðŸŒ","ðŸŒ™","â­","â˜€ï¸","ðŸŒ¤ï¸","â›…","ðŸŒ¥ï¸","â˜ï¸","ðŸŒ¦ï¸","ðŸŒ§ï¸","â›ˆï¸","ðŸŒ©ï¸","ðŸŒ¨ï¸","â„ï¸","â˜ƒï¸","â›„","ðŸŒ¬ï¸","ðŸ’¨","ðŸŒŠ","ðŸ’§","ðŸ’¦","â˜”","ðŸŒˆ"]}],it=({onSelect:t})=>{const{t:a}=A(),s=de(),[f,o]=m.useState(!1),[d,j]=m.useState(0),u=p=>{t(p),s||o(!1)},r={smileys:a("emoji.smileys","è¡¨æƒ…"),gestures:a("emoji.gestures","æ‰‹åŠ¿"),food:a("emoji.food","ç¾Žé£Ÿ"),hearts:a("emoji.hearts","çˆ±å¿ƒ"),objects:a("emoji.objects","ç‰©å“"),nature:a("emoji.nature","è‡ªç„¶")},h=e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex gap-1 overflow-x-auto pb-2 border-b",children:Ie.map((p,x)=>e.jsx("button",{type:"button",onClick:()=>j(x),className:`px-3 py-1.5 text-sm rounded-full whitespace-nowrap transition-colors ${d===x?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80 text-muted-foreground"}`,children:r[p.name]},p.name))}),e.jsx("div",{className:"grid grid-cols-8 gap-1",children:Ie[d].emojis.map((p,x)=>e.jsx("button",{type:"button",onClick:()=>u(p),className:"w-9 h-9 flex items-center justify-center text-xl hover:bg-muted rounded-md transition-colors",children:p},x))})]}),c=e.jsxs("button",{type:"button",onClick:()=>o(!0),className:"flex items-center gap-1.5 text-muted-foreground hover:text-foreground transition-colors",children:[e.jsx(cs,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:a("community.emoji","è¡¨æƒ…")})]});return s?e.jsxs(e.Fragment,{children:[c,e.jsx(be,{open:f,onOpenChange:o,children:e.jsxs(we,{className:"h-[50vh]",children:[e.jsx(ke,{className:"pb-2",children:e.jsx(Ce,{children:a("emoji.title","é€‰æ‹©è¡¨æƒ…")})}),e.jsx(Me,{className:"flex-1 px-4 pb-4",children:h})]})})]}):e.jsxs(Se,{open:f,onOpenChange:o,children:[e.jsx(Re,{asChild:!0,children:c}),e.jsx(_e,{className:"w-80 p-3",align:"start",side:"top",children:h})]})},lt=({onSelect:t})=>{const{t:a}=A();return e.jsxs("div",{className:"h-full flex flex-col items-center justify-center p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-2",children:a("community.selectPostType","é€‰æ‹©å‘å¸ƒç±»åž‹")}),e.jsx("p",{className:"text-muted-foreground text-sm mb-8 text-center",children:a("community.selectPostTypeDesc","é€‰æ‹©æ‚¨æƒ³è¦å‘å¸ƒçš„å†…å®¹ç±»åž‹")}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 w-full max-w-sm",children:[e.jsxs("button",{onClick:()=>t("post"),className:"flex flex-col items-center gap-3 p-6 rounded-xl border-2 border-border hover:border-primary hover:bg-primary/5 transition-all duration-200 group",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center group-hover:bg-primary/20 transition-colors",children:e.jsx(ye,{className:"h-8 w-8 text-primary"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"font-medium",children:a("community.postType.post","å‘å¸ƒå¸–å­")}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:a("community.postType.postDesc","åˆ†äº«ç¾Žé£Ÿä½“éªŒå’Œæƒ³æ³•")})]})]}),e.jsxs("button",{onClick:()=>t("recipe"),className:"flex flex-col items-center gap-3 p-6 rounded-xl border-2 border-border hover:border-primary hover:bg-primary/5 transition-all duration-200 group",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center group-hover:bg-primary/20 transition-colors",children:e.jsx(te,{className:"h-8 w-8 text-primary"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"font-medium",children:a("community.postType.recipe","å‘å¸ƒé£Ÿè°±")}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:a("community.postType.recipeDesc","åˆ†äº«çƒ¹é¥ªæ•™ç¨‹å’Œèœè°±")})]})]})]})]})},ct=[{value:"easy",labelKey:"recipe.difficulty.easy"},{value:"medium",labelKey:"recipe.difficulty.medium"},{value:"hard",labelKey:"recipe.difficulty.hard"}],ot=["g","kg","ml","L","tsp","tbsp","cup","piece","slice","clove","pinch"],dt=({data:t,coverImage:a,nutrition:s,introduction:f,onDataChange:o,onCoverImageChange:d,onNutritionChange:j,onIntroductionChange:u})=>{const{t:r}=A(),h=m.useRef(null),[c,p]=m.useState(!!(s.calories||s.protein||s.carbs||s.fat)),[x,v]=m.useState(!1),w=async i=>{const N=i.target.files?.[0];if(N){if(N.size>5*1024*1024){S.error(r("common.imageTooLarge","å›¾ç‰‡ä¸èƒ½è¶…è¿‡5MB"));return}v(!0);try{const{data:{user:y}}=await I.auth.getUser();if(!y)throw new Error("Not authenticated");const C=N.name.split(".").pop(),_=`${y.id}/${Date.now()}-recipe-cover.${C}`,{error:P}=await I.storage.from("community-posts").upload(_,N);if(P)throw P;const{data:{publicUrl:q}}=I.storage.from("community-posts").getPublicUrl(_);d(q)}catch(y){console.error("Upload error:",y),S.error(r("common.uploadError","ä¸Šä¼ å¤±è´¥"))}finally{v(!1),h.current&&(h.current.value="")}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{children:r("recipe.coverImage","å°é¢å›¾ç‰‡")}),e.jsx("input",{ref:h,type:"file",accept:"image/*",className:"hidden",onChange:w}),a?e.jsxs("div",{className:"relative aspect-video rounded-lg overflow-hidden bg-muted",children:[e.jsx("img",{src:a,alt:"",className:"w-full h-full object-cover"}),e.jsx("button",{type:"button",onClick:()=>d(null),className:"absolute top-2 right-2 p-1 bg-black/50 rounded-full text-white hover:bg-black/70",children:e.jsx(Z,{className:"h-4 w-4"})})]}):e.jsx("button",{type:"button",onClick:()=>h.current?.click(),disabled:x,className:"w-full aspect-video rounded-lg border-2 border-dashed border-muted-foreground/30 flex flex-col items-center justify-center gap-2 text-muted-foreground hover:border-primary hover:text-primary transition-colors",children:x?e.jsx(ae,{className:"h-8 w-8 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(ve,{className:"h-8 w-8"}),e.jsx("span",{className:"text-sm",children:r("recipe.addCoverImage","æ·»åŠ å°é¢å›¾ç‰‡")})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(O,{htmlFor:"recipe-name",children:[r("recipe.name","é£Ÿè°±åç§°")," *"]}),e.jsx(z,{id:"recipe-name",value:t.recipe_name||"",onChange:i=>o({...t,recipe_name:i.target.value}),placeholder:r("recipe.namePlaceholder","å¦‚ï¼šçº¢çƒ§è‚‰ã€ç•ªèŒ„ç‚’è›‹")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(O,{htmlFor:"introduction",children:[e.jsx(ye,{className:"h-4 w-4 inline mr-1"}),r("recipe.introduction","ç¾Žé£Ÿä»‹ç»")]}),e.jsx(Ne,{id:"introduction",value:f,onChange:i=>u(i.target.value),placeholder:r("recipe.introductionPlaceholder","ä»‹ç»è¿™é“ç¾Žé£Ÿçš„ç‰¹è‰²ã€å£æ„Ÿã€æ¥æºæ•…äº‹ç­‰..."),rows:3,className:"resize-none"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(O,{htmlFor:"cook-time",children:[e.jsx(oe,{className:"h-4 w-4 inline mr-1"}),r("recipe.cookTime","çƒ¹é¥ªæ—¶é—´")," *"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{id:"cook-time",type:"number",min:1,value:t.cook_time||"",onChange:i=>o({...t,cook_time:parseInt(i.target.value)||0}),placeholder:"30",className:"w-24"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:r("recipe.minutes","åˆ†é’Ÿ")})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(O,{children:[e.jsx(os,{className:"h-4 w-4 inline mr-1"}),r("recipe.difficulty","éš¾åº¦")," *"]}),e.jsxs(Ps,{value:t.difficulty||"",onValueChange:i=>o({...t,difficulty:i}),children:[e.jsx(Is,{children:e.jsx(Us,{placeholder:r("recipe.selectDifficulty","é€‰æ‹©éš¾åº¦")})}),e.jsx(Ls,{children:ct.map(i=>e.jsx(Ts,{value:i.value,children:r(i.labelKey,i.value)},i.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(O,{htmlFor:"servings",children:[e.jsx(Ue,{className:"h-4 w-4 inline mr-1"}),r("recipe.servings","ä»½é‡")," *"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{id:"servings",type:"number",min:1,value:t.servings||"",onChange:i=>o({...t,servings:parseInt(i.target.value)||0}),placeholder:"2",className:"w-24"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:r("recipe.people","äººä»½")})]})]}),e.jsxs(Gs,{open:c,onOpenChange:p,children:[e.jsx(Qs,{asChild:!0,children:e.jsxs(T,{variant:"ghost",type:"button",className:"w-full justify-between px-0 hover:bg-transparent",children:[e.jsxs("span",{className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx(De,{className:"h-4 w-4"}),r("recipe.nutritionInfo","è¥å…»ä¿¡æ¯"),e.jsxs("span",{className:"text-xs text-muted-foreground font-normal",children:["(",r("common.optional","å¯é€‰"),")"]})]}),c?e.jsx(ds,{className:"h-4 w-4"}):e.jsx(ms,{className:"h-4 w-4"})]})}),e.jsx(Ws,{className:"space-y-4 pt-2",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(O,{htmlFor:"calories",className:"text-xs",children:r("recipe.calories","å¡è·¯é‡Œ")}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(z,{id:"calories",type:"number",min:0,value:s.calories||"",onChange:i=>j({...s,calories:parseInt(i.target.value)||void 0}),placeholder:"300",className:"h-8"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"kcal"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(O,{htmlFor:"protein",className:"text-xs",children:r("recipe.protein","è›‹ç™½è´¨")}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(z,{id:"protein",type:"number",min:0,value:s.protein||"",onChange:i=>j({...s,protein:parseInt(i.target.value)||void 0}),placeholder:"20",className:"h-8"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"g"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(O,{htmlFor:"carbs",className:"text-xs",children:r("recipe.carbs","ç¢³æ°´")}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(z,{id:"carbs",type:"number",min:0,value:s.carbs||"",onChange:i=>j({...s,carbs:parseInt(i.target.value)||void 0}),placeholder:"30",className:"h-8"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"g"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(O,{htmlFor:"fat",className:"text-xs",children:r("recipe.fat","è„‚è‚ª")}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(z,{id:"fat",type:"number",min:0,value:s.fat||"",onChange:i=>j({...s,fat:parseInt(i.target.value)||void 0}),placeholder:"10",className:"h-8"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"g"})]})]})]})})]})]})},mt=({ingredients:t,onChange:a})=>{const{t:s}=A(),f=()=>{a([...t,{name:"",amount:"",unit:""}])},o=(j,u,r)=>{const h=[...t];h[j]={...h[j],[u]:r},a(h)},d=j=>{a(t.filter((u,r)=>r!==j))};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(O,{className:"text-base font-medium",children:[s("recipe.ingredients","é…æ–™")," *"]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[t.filter(j=>j.name).length," ",s("recipe.items","é¡¹")]})]}),e.jsx("div",{className:"space-y-3",children:t.map((j,u)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx(z,{value:j.name,onChange:r=>o(u,"name",r.target.value),placeholder:s("recipe.ingredientName","é…æ–™åç§°")})}),e.jsx("div",{className:"w-20",children:e.jsx(z,{value:j.amount,onChange:r=>o(u,"amount",r.target.value),placeholder:s("recipe.amount","é‡")})}),e.jsxs("div",{className:"w-20",children:[e.jsx(z,{value:j.unit,onChange:r=>o(u,"unit",r.target.value),placeholder:s("recipe.unit","å•ä½"),list:"common-units"}),e.jsx("datalist",{id:"common-units",children:ot.map(r=>e.jsx("option",{value:r},r))})]}),e.jsx(T,{type:"button",variant:"ghost",size:"icon",onClick:()=>d(u),disabled:t.length===1,className:"shrink-0",children:e.jsx(Fe,{className:"h-4 w-4 text-destructive"})})]},u))}),e.jsxs(T,{type:"button",variant:"outline",onClick:f,className:"w-full",children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),s("recipe.addIngredient","æ·»åŠ é…æ–™")]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s("recipe.unitsHint","å¸¸ç”¨å•ä½ï¼šg, kg, ml, L, å‹º, æ¯, ä¸ª, ç‰‡, é€‚é‡")})]})},ut=({steps:t,onChange:a})=>{const{t:s}=A(),[f,o]=m.useState(null),d=m.useRef([]),j=()=>{const c=t.length+1;a([...t,{order:c,description:"",image_url:void 0}])},u=(c,p,x)=>{const v=[...t];v[c]={...v[c],[p]:x},a(v)},r=c=>{const p=t.filter((x,v)=>v!==c).map((x,v)=>({...x,order:v+1}));a(p)},h=async(c,p)=>{const x=p.target.files?.[0];if(x){if(x.size>5*1024*1024){S.error(s("common.imageTooLarge","å›¾ç‰‡ä¸èƒ½è¶…è¿‡5MB"));return}o(c);try{const{data:{user:v}}=await I.auth.getUser();if(!v)throw new Error("Not authenticated");const w=x.name.split(".").pop(),i=`${v.id}/${Date.now()}-step-${c}.${w}`,{error:N}=await I.storage.from("community-posts").upload(i,x);if(N)throw N;const{data:{publicUrl:y}}=I.storage.from("community-posts").getPublicUrl(i);u(c,"image_url",y)}catch(v){console.error("Upload error:",v),S.error(s("common.uploadError","ä¸Šä¼ å¤±è´¥"))}finally{o(null),d.current[c]&&(d.current[c].value="")}}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(O,{className:"text-base font-medium",children:[s("recipe.steps","çƒ¹é¥ªæ­¥éª¤")," *"]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[t.filter(c=>c.description).length," ",s("recipe.stepsCount","æ­¥")]})]}),e.jsx("div",{className:"space-y-4",children:t.map((c,p)=>e.jsxs("div",{className:"p-4 border rounded-lg space-y-3 bg-card",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(us,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium text-primary",children:s("recipe.stepNumber","ç¬¬{{n}}æ­¥",{n:p+1})})]}),e.jsx(T,{type:"button",variant:"ghost",size:"icon",onClick:()=>r(p),disabled:t.length===1,children:e.jsx(Fe,{className:"h-4 w-4 text-destructive"})})]}),e.jsx(Ne,{value:c.description,onChange:x=>u(p,"description",x.target.value),placeholder:s("recipe.stepDescriptionPlaceholder","æè¿°è¿™ä¸€æ­¥çš„æ“ä½œ..."),className:"min-h-[80px]"}),e.jsxs("div",{children:[e.jsx("input",{ref:x=>d.current[p]=x,type:"file",accept:"image/*",className:"hidden",onChange:x=>h(p,x)}),c.image_url?e.jsxs("div",{className:"relative w-32 h-24 rounded-lg overflow-hidden bg-muted",children:[e.jsx("img",{src:c.image_url,alt:"",className:"w-full h-full object-cover"}),e.jsx("button",{type:"button",onClick:()=>u(p,"image_url",void 0),className:"absolute top-1 right-1 p-1 bg-black/50 rounded-full text-white hover:bg-black/70",children:e.jsx(Z,{className:"h-3 w-3"})})]}):e.jsxs("button",{type:"button",onClick:()=>d.current[p]?.click(),disabled:f===p,className:"flex items-center gap-2 text-sm text-muted-foreground hover:text-primary transition-colors",children:[f===p?e.jsx(ae,{className:"h-4 w-4 animate-spin"}):e.jsx(ve,{className:"h-4 w-4"}),e.jsx("span",{children:s("recipe.addStepImage","æ·»åŠ æ­¥éª¤å›¾ç‰‡ï¼ˆå¯é€‰ï¼‰")})]})]})]},p))}),e.jsxs(T,{type:"button",variant:"outline",onClick:j,className:"w-full",children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),s("recipe.addStep","æ·»åŠ æ­¥éª¤")]})]})},xt=()=>{const t=$e(),{t:a}=A();return xs({mutationFn:async s=>{const{data:{user:f}}=await I.auth.getUser();if(!f)throw new Error("Not authenticated");let o;s.introduction?o=s.introduction:o="";const d=[];s.cover_image&&d.push(s.cover_image),s.steps.forEach(r=>{r.image_url&&d.push(r.image_url)});const{data:j,error:u}=await I.from("community_posts").insert({author_id:f.id,post_type:"recipe",content:o,image_urls:d,recipe_name:s.recipe_name,cook_time:s.cook_time,difficulty:s.difficulty,servings:s.servings,ingredients:s.ingredients,steps:s.steps,nutrition:s.nutrition?s.nutrition:null,recipe_tags:s.recipe_tags||null,recipe_category:s.recipe_category||null,status:"pending",moderation_status:"pending"}).select().single();if(u)throw u;try{await I.functions.invoke("moderate-post",{body:{post_id:j.id,content:o,user_id:f.id,image_urls:d}})}catch(r){console.error("Moderation call failed:",r)}return j},onSuccess:()=>{t.invalidateQueries({queryKey:["community-posts"]}),t.invalidateQueries({queryKey:["has-posted-today"]}),S.success(a("recipe.publishSuccess","é£Ÿè°±å‘å¸ƒæˆåŠŸ"))},onError:s=>{console.error("Create recipe error:",s),S.error(a("recipe.publishError","å‘å¸ƒå¤±è´¥"))}})},pt=({onClose:t,onSuccess:a})=>{const{t:s}=A(),f=xt(),[o,d]=m.useState(0),[j,u]=m.useState(null),[r,h]=m.useState({recipe_name:"",cook_time:void 0,difficulty:void 0,servings:void 0}),[c,p]=m.useState([{name:"",amount:"",unit:""}]),[x,v]=m.useState([{order:1,description:""}]),[w,i]=m.useState({}),[N,y]=m.useState(""),C=[{key:"basic",title:s("recipe.step.basic","åŸºæœ¬ä¿¡æ¯")},{key:"ingredients",title:s("recipe.step.ingredients","é…æ–™")},{key:"steps",title:s("recipe.step.steps","æ­¥éª¤")}],_=(o+1)/C.length*100,P=()=>r.recipe_name?.trim()?!r.cook_time||r.cook_time<1?(S.error(s("recipe.cookTimeRequired","è¯·è¾“å…¥çƒ¹é¥ªæ—¶é—´")),!1):r.difficulty?!r.servings||r.servings<1?(S.error(s("recipe.servingsRequired","è¯·è¾“å…¥ä»½é‡")),!1):!0:(S.error(s("recipe.difficultyRequired","è¯·é€‰æ‹©éš¾åº¦")),!1):(S.error(s("recipe.nameRequired","è¯·è¾“å…¥é£Ÿè°±åç§°")),!1),q=()=>c.filter(g=>g.name.trim()).length===0?(S.error(s("recipe.ingredientsRequired","è¯·è‡³å°‘æ·»åŠ ä¸€ç§é…æ–™")),!1):!0,E=()=>x.filter(g=>g.description.trim()).length===0?(S.error(s("recipe.stepsRequired","è¯·è‡³å°‘æ·»åŠ ä¸€ä¸ªæ­¥éª¤")),!1):!0,V=()=>{o===0&&!P()||o===1&&!q()||d(n=>Math.min(n+1,C.length-1))},B=()=>{d(n=>Math.max(n-1,0))},D=async()=>{if(!E())return;const n=c.filter(H=>H.name.trim()),g=x.filter(H=>H.description.trim()).map((H,ue)=>({...H,order:ue+1})),M=w.calories||w.protein||w.carbs||w.fat;try{await f.mutateAsync({recipe_name:r.recipe_name,cook_time:r.cook_time,difficulty:r.difficulty,servings:r.servings,ingredients:n,steps:g,cover_image:j,nutrition:M?w:void 0,introduction:N.trim()||void 0}),a()}catch{}},l=()=>{switch(o){case 0:return e.jsx(dt,{data:r,coverImage:j,nutrition:w,introduction:N,onDataChange:h,onCoverImageChange:u,onNutritionChange:i,onIntroductionChange:y});case 1:return e.jsx(mt,{ingredients:c,onChange:p});case 2:return e.jsx(ut,{steps:x,onChange:v});default:return null}};return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"px-4 py-3 border-b bg-background shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("button",{type:"button",onClick:t,className:"p-1 -ml-1 hover:bg-muted rounded-md transition-colors",children:e.jsx(ce,{className:"h-5 w-5"})}),e.jsx("h2",{className:"font-medium",children:s("recipe.createTitle","åˆ›å»ºé£Ÿè°±")}),e.jsx("div",{className:"w-6"})," "]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ks,{value:_,className:"h-1"}),e.jsx("div",{className:"flex justify-between text-xs text-muted-foreground",children:C.map((n,g)=>e.jsx("span",{className:g===o?"text-primary font-medium":"",children:n.title},n.key))})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:l()}),e.jsx("div",{className:"px-4 py-3 pb-[max(1rem,env(safe-area-inset-bottom))] border-t bg-background shrink-0",children:e.jsxs("div",{className:"flex gap-3",children:[o>0&&e.jsxs(T,{type:"button",variant:"outline",onClick:B,className:"flex-1",children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),s("common.back","ä¸Šä¸€æ­¥")]}),o<C.length-1?e.jsxs(T,{type:"button",onClick:V,className:"flex-1",children:[s("common.next","ä¸‹ä¸€æ­¥"),e.jsx(ps,{className:"h-4 w-4 ml-2"})]}):e.jsxs(T,{type:"button",onClick:D,disabled:f.isPending,className:"flex-1",children:[f.isPending?e.jsx(ae,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(Y,{className:"h-4 w-4 mr-2"}),s("recipe.publish","å‘å¸ƒé£Ÿè°±")]})]})})]})},ht=({trigger:t})=>{const{t:a}=A(),{getLocalizedField:s}=me(),f=qs(),{data:o}=Js(),{data:d}=Xs(),{role:j,isMerchant:u,isAdmin:r,isSupervisor:h}=Es(),{data:c}=Os(),{data:p,isLoading:x}=zs(),[v,w]=m.useState(!1),[i,N]=m.useState("selecting"),[y,C]=m.useState(""),[_,P]=m.useState([]),[q,E]=m.useState(null),[V,B]=m.useState(""),[D,l]=m.useState([]),[n,g]=m.useState(!1),[M,H]=m.useState(!1),[ue,Pe]=m.useState(!1),[xe,ee]=m.useState(!1),re=m.useRef(null),ne=m.useRef(null),se=!u&&!h&&!r,ie=r||h||u;m.useEffect(()=>{u&&c&&v&&l([c.id])},[u,c,v]);const pe=()=>{N(ie?"selecting":"post"),C(""),P([]),E(null),B(""),l([]),H(!1),Pe(!1),ee(!1)};m.useEffect(()=>{v&&N(ie?"selecting":"post")},[v,ie]);const Be=b=>{w(b),b||pe()},He=o?.filter(b=>b.status==="published")||[],Ve=async b=>{const R=b.target.files;if(!(!R||R.length===0)){if(_.length+R.length>9){S.error(a("community.maxImages","æœ€å¤šä¸Šä¼ 9å¼ å›¾ç‰‡"));return}g(!0);try{const{data:{user:L}}=await I.auth.getUser();if(!L)throw new Error("Not authenticated");const k=[];for(const U of Array.from(R)){const J=U.name.split(".").pop(),G=`${L.id}/${Date.now()}-${Math.random().toString(36).substring(7)}.${J}`,{error:Q}=await I.storage.from("community-posts").upload(G,U);if(Q)throw Q;const{data:{publicUrl:W}}=I.storage.from("community-posts").getPublicUrl(G);k.push(W)}P(U=>[...U,...k])}catch(L){console.error("Upload error:",L),S.error(a("common.uploadError","ä¸Šä¼ å¤±è´¥"))}finally{g(!1),re.current&&(re.current.value="")}}},Ke=b=>new Promise((R,L)=>{const k=document.createElement("video"),U=document.createElement("canvas"),J=U.getContext("2d");k.preload="auto",k.muted=!0,k.playsInline=!0;let G=!1;const Q=()=>{G||k.videoWidth===0||k.videoHeight===0||(U.width=k.videoWidth,U.height=k.videoHeight,J&&(J.drawImage(k,0,0,U.width,U.height),U.toBlob(W=>{W&&W.size>0?(G=!0,k.pause(),URL.revokeObjectURL(k.src),R(W)):L(new Error("Failed to create blob"))},"image/jpeg",.85)))};k.onloadedmetadata=()=>{U.width=k.videoWidth,U.height=k.videoHeight,k.currentTime=.1},k.onseeked=()=>{setTimeout(Q,100)},k.onerror=()=>{URL.revokeObjectURL(k.src),L(new Error("Failed to load video"))},setTimeout(()=>{G||(URL.revokeObjectURL(k.src),L(new Error("Timeout")))},1e4),k.src=URL.createObjectURL(b),k.load()}),Ge=async b=>{const R=b.target.files?.[0];if(R){if(R.size>100*1024*1024){S.error(a("community.videoTooLarge","è§†é¢‘ä¸èƒ½è¶…è¿‡100MB"));return}g(!0);try{const{data:{user:L}}=await I.auth.getUser();if(!L)throw new Error("Not authenticated");const k=R.name.split(".").pop(),U=`${L.id}/${Date.now()}.${k}`,{error:J}=await I.storage.from("community-posts").upload(U,R);if(J)throw J;const{data:{publicUrl:G}}=I.storage.from("community-posts").getPublicUrl(U);E(G);try{S.info(a("community.extractingCover","æ­£åœ¨æå–è§†é¢‘å°é¢..."));const Q=await Ke(R),W=`${L.id}/${Date.now()}-cover.jpg`,{error:Ze}=await I.storage.from("community-posts").upload(W,Q);if(!Ze){const{data:{publicUrl:es}}=I.storage.from("community-posts").getPublicUrl(W);P(ss=>[es,...ss]),S.success(a("community.coverExtracted","å°é¢å·²è‡ªåŠ¨ç”Ÿæˆ"))}}catch(Q){console.warn("Cover extraction failed:",Q)}}catch(L){console.error("Upload error:",L),S.error(a("common.uploadError","ä¸Šä¼ å¤±è´¥"))}finally{g(!1),ne.current&&(ne.current.value="")}}},Qe=b=>{P(R=>R.filter((L,k)=>k!==b))},We=()=>{E(null),P(b=>b.length>0&&b[0].includes("-cover.jpg")?b.slice(1):b)},Je=async()=>{if(ee(!1),!y.trim()){S.error(a("community.contentRequired","è¯·è¾“å…¥å†…å®¹"));return}if(se&&D.length===0){ee(!0),S.error(a("community.restaurantRequired","è¯·é€‰æ‹©é¤åŽ…"));return}await f.mutateAsync({content:y,image_urls:_,video_url:q||void 0,activity_id:V||void 0,restaurant_ids:D.length>0?D:void 0}),pe(),w(!1)},Xe=()=>c?s(c,"name"):a("community.noRestaurant","æœªå…³è”é¤åŽ…"),Ye=()=>{pe(),w(!1)};return e.jsxs(Ds,{open:v,onOpenChange:Be,children:[e.jsx(Fs,{asChild:!0,children:t||e.jsx(T,{children:a("community.createPost","å‘å¸ƒå¸–å­")})}),e.jsxs($s,{side:"bottom",className:"h-full flex flex-col p-0 rounded-none border-0 [&>button]:hidden",children:[e.jsx(hs,{children:e.jsx(Ms,{children:a("community.createPost","å‘å¸ƒå¸–å­")})}),i==="selecting"&&e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b bg-background shrink-0",children:[e.jsx("button",{type:"button",onClick:()=>w(!1),className:"p-1 -ml-1 hover:bg-muted rounded-md transition-colors",children:e.jsx(ce,{className:"h-5 w-5"})}),e.jsx("span",{className:"font-medium",children:a("community.create","å‘å¸ƒ")}),e.jsx("div",{className:"w-6"})]}),e.jsx(lt,{onSelect:N})]}),i==="recipe"&&e.jsx(pt,{onClose:()=>N("selecting"),onSuccess:Ye}),i==="post"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b bg-background shrink-0",children:[e.jsx("button",{type:"button",onClick:()=>ie?N("selecting"):w(!1),className:"p-1 -ml-1 hover:bg-muted rounded-md transition-colors",children:e.jsx(ce,{className:"h-5 w-5"})}),e.jsxs(T,{size:"sm",onClick:Je,disabled:f.isPending||!y.trim(),className:"rounded-full px-6",children:[f.isPending&&e.jsx(ae,{className:"h-4 w-4 mr-2 animate-spin"}),a("community.publish","å‘å¸ƒ")]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"px-4 py-4 space-y-4",children:[!x&&!p&&e.jsxs("div",{className:"flex items-center justify-between gap-2 px-3 py-2 bg-primary/10 dark:bg-primary/20 border border-primary/30 dark:border-primary/40 rounded-md text-sm text-primary dark:text-primary",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"h-4 w-4 shrink-0"}),e.jsx("span",{children:a("community.dailyPointsHint","æ¯æ—¥å‘å¸ƒé¦–ä¸ªå¸–å­å¯èŽ·å¾—5ç§¯åˆ†ï¼")})]}),e.jsx(et,{})]}),e.jsx(Ne,{value:y,onChange:b=>C(b.target.value),placeholder:a("community.contentPlaceholder","åˆ†äº«ä½ çš„æƒ³æ³•..."),className:"min-h-[150px] border-none shadow-none resize-none focus-visible:ring-0 p-0 text-base whitespace-pre-wrap"}),_.length>0&&e.jsx("div",{className:"grid grid-cols-3 gap-2",children:_.map((b,R)=>e.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-muted",children:[e.jsx("img",{src:b,alt:"",className:"w-full h-full object-cover"}),e.jsx("button",{type:"button",onClick:()=>Qe(R),className:"absolute top-1 right-1 p-1 bg-black/50 rounded-full text-white hover:bg-black/70",children:e.jsx(Z,{className:"h-3 w-3"})})]},R))}),q&&e.jsxs("div",{className:"relative rounded-lg overflow-hidden",children:[e.jsx("video",{src:q,controls:!0,className:"w-full max-h-48",preload:"metadata"}),e.jsx("button",{type:"button",onClick:We,className:"absolute top-2 right-2 p-1 bg-black/50 rounded-full text-white hover:bg-black/70",children:e.jsx(Z,{className:"h-4 w-4"})})]})]})}),e.jsxs("div",{className:"px-4 py-2 pb-0 bg-background shrink-0 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:`flex items-center gap-3 ${xe&&se&&D.length===0?"text-destructive":""}`,children:[e.jsx(Ee,{className:`h-5 w-5 shrink-0 ${xe&&se&&D.length===0?"text-destructive":"text-muted-foreground"}`}),u?e.jsx("span",{className:"text-sm text-muted-foreground",children:Xe()}):e.jsx(st,{open:M,onOpenChange:b=>{H(b),b&&ee(!1)},value:D,onSelect:b=>{l(b),ee(!1)},restaurants:d||[],required:se})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(je,{className:"h-5 w-5 text-muted-foreground shrink-0"}),e.jsx(nt,{open:ue,onOpenChange:Pe,value:V,onSelect:B,activities:He})]})]}),xe&&se&&D.length===0&&e.jsx("p",{className:"text-xs text-destructive pl-8",children:a("community.restaurantRequired","è¯·é€‰æ‹©é¤åŽ…")})]}),e.jsxs("div",{className:"flex items-center gap-6 px-4 pt-0 py-2 pb-[max(2rem,calc(env(safe-area-inset-bottom)+1rem))] bg-background shrink-0",children:[e.jsx("input",{ref:re,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:Ve}),e.jsx("input",{ref:ne,type:"file",accept:"video/*",className:"hidden",onChange:Ge}),e.jsxs("button",{type:"button",onClick:()=>re.current?.click(),disabled:n||_.length>=9,className:"flex items-center gap-1.5 text-muted-foreground hover:text-foreground disabled:opacity-50 transition-colors",children:[e.jsx(ve,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:a("community.photo","ç…§ç‰‡")})]}),e.jsxs("button",{type:"button",onClick:()=>ne.current?.click(),disabled:n||!!q,className:"flex items-center gap-1.5 text-muted-foreground hover:text-foreground disabled:opacity-50 transition-colors",children:[e.jsx(gs,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:a("community.video","è§†é¢‘")})]}),e.jsx(it,{onSelect:b=>C(R=>R+b)}),n&&e.jsx(ae,{className:"h-5 w-5 animate-spin ml-auto"})]})]})]})]})},gt=()=>e.jsxs("div",{className:"rounded-xl overflow-hidden bg-card border border-border/50",children:[e.jsx(X,{className:"aspect-[4/5] w-full"}),e.jsxs("div",{className:"p-3 space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{className:"h-4 w-full"}),e.jsx(X,{className:"h-4 w-3/4"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-5 w-5 rounded-full"}),e.jsx(X,{className:"h-3 w-16"})]}),e.jsx(X,{className:"h-4 w-10"})]})]})]}),Tt=()=>{const{t}=A(),a=$e(),s=de(),[f,o]=m.useState(()=>localStorage.getItem("community-mobile-layout")==="single"?"single":"double"),[d,j]=m.useState(()=>localStorage.getItem("community-sort")==="popular"?"popular":"latest"),[u,r]=m.useState(()=>{const y=localStorage.getItem("community-post-type");return["all","post","recipe"].includes(y||"")?y:"all"}),{data:h,isLoading:c}=Bs({status:"approved",sortBy:d,postType:u}),{data:p}=Hs(),x=m.useCallback(async()=>{a.removeQueries({queryKey:["community-posts"]}),a.removeQueries({queryKey:["can-create-post"]}),a.removeQueries({queryKey:["has-posted-today"]}),await Promise.all([a.invalidateQueries({queryKey:["community-posts"]}),a.invalidateQueries({queryKey:["can-create-post"]}),a.invalidateQueries({queryKey:["has-posted-today"]})])},[a]),v=()=>{const y=f==="double"?"single":"double";o(y),localStorage.setItem("community-mobile-layout",y)},w=y=>{const C=y;j(C),localStorage.setItem("community-sort",C)},i=y=>{r(y),localStorage.setItem("community-post-type",y)},N=()=>s?f==="single"?"columns-1 gap-4":"columns-2 gap-3":"columns-3 lg:columns-4 gap-4";return e.jsx(Ys,{onRefresh:x,children:e.jsx("div",{className:"min-h-screen bg-secondary/20 py-8 px-4 animate-fade-in",children:e.jsxs("div",{className:"container mx-auto max-w-5xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl sm:text-4xl mb-2 text-primary font-medium",children:t("community.title","ç¤¾åŒº")}),e.jsx("p",{className:"text-muted-foreground text-base sm:text-lg",children:t("community.description","åˆ†äº«ç¾Žé£Ÿä½“éªŒï¼Œå‘çŽ°æ›´å¤šç²¾å½©")})]}),p&&e.jsx(ht,{trigger:e.jsxs(T,{size:"sm",className:"gap-1.5",children:[e.jsx(le,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:t("community.createPost","å‘å¸ƒ")})]})})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsxs("div",{className:"inline-flex h-9 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",children:[e.jsxs("button",{onClick:()=>w("latest"),className:`inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 gap-1.5 ${d==="latest"?"bg-background text-foreground shadow-sm":""}`,children:[e.jsx(oe,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:t("community.sortLatest","æœ€æ–°")})]}),e.jsxs("button",{onClick:()=>w("popular"),className:`inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 gap-1.5 ${d==="popular"?"bg-background text-foreground shadow-sm":""}`,children:[e.jsx(De,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:t("community.sortPopular","çƒ­é—¨")})]})]}),e.jsxs("div",{className:"inline-flex h-9 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",children:[e.jsxs("button",{onClick:()=>i("all"),className:`inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 gap-1.5 ${u==="all"?"bg-background text-foreground shadow-sm":""}`,children:[e.jsx(fs,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:t("community.filterAll","å…¨éƒ¨")})]}),e.jsxs("button",{onClick:()=>i("post"),className:`inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 gap-1.5 ${u==="post"?"bg-background text-foreground shadow-sm":""}`,children:[e.jsx(ye,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:t("community.filterPost","å¸–å­")})]}),e.jsxs("button",{onClick:()=>i("recipe"),className:`inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 gap-1.5 ${u==="recipe"?"bg-background text-foreground shadow-sm":""}`,children:[e.jsx(te,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:t("community.filterRecipe","é£Ÿè°±")})]})]}),s&&e.jsx("button",{onClick:v,className:"ml-auto inline-flex h-9 items-center justify-center whitespace-nowrap rounded-md bg-muted px-2.5 py-1.5 text-sm font-medium text-muted-foreground ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",title:f==="double"?t("community.singleColumn","å•åˆ—å¸ƒå±€"):t("community.doubleColumn","åŒåˆ—å¸ƒå±€"),children:f==="double"?e.jsx(js,{className:"h-3.5 w-3.5"}):e.jsx(ys,{className:"h-3.5 w-3.5"})})]}),c?e.jsx("div",{className:N(),children:Array.from({length:8}).map((y,C)=>e.jsx("div",{className:"break-inside-avoid mb-3 sm:mb-4",children:e.jsx(gt,{})},C))}):h&&h.length>0?e.jsx("div",{className:N(),children:h.map(y=>e.jsx("div",{className:"break-inside-avoid mb-3 sm:mb-4",children:e.jsx(Zs,{post:y,showAssociations:s&&f==="single"})},y.id))}):e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[60vh] text-center px-4",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-muted/50 flex items-center justify-center mb-4",children:e.jsx(le,{className:"w-8 h-8 text-muted-foreground/50"})}),e.jsx("p",{className:"text-muted-foreground text-lg",children:t("community.noPosts","æš‚æ— å¸–å­")}),p&&e.jsx("p",{className:"mt-2 text-sm text-muted-foreground/70",children:t("community.beFirst","æˆä¸ºç¬¬ä¸€ä¸ªå‘å¸–çš„äººå§ï¼")})]})]})})})};export{Tt as default};
//# sourceMappingURL=Community-TXf-wmbj.js.map
