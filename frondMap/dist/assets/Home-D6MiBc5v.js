import{p as U,u as ge,r as o,j as e,aW as ne,aX as Xe,aY as Qe,aZ as Ke,aw as ye,ay as ve,a_ as ie,a$ as je,b0 as Ue,L as Ce,al as Ge,b1 as ce,b2 as Se,b3 as Le,b4 as Ae,b5 as Ze,b6 as we,b7 as Ye,q as Je,b8 as es,b9 as ss,ba as ts}from"./vendor-react-Dd_5Sawp.js";import{a as Te,b as be,D as as,c as rs,d as os,e as ns,f as is,I as ls,B as E,g as S,C as de,S as cs,s as ds,h as ms,o as us,i as $,j as he,k as xs,H as hs,l as Re,m as Me,n as ps}from"./index-BTawsUvj.js";import{c as fs,g as gs,m as ze}from"./geolocation-DRm3QMsJ.js";import{a as bs,g as ys}from"./app-store-badge-CyCtXXOt.js";import{u as De}from"./useHomepageTemplates-DVfj1SeX.js";import{u as vs}from"./usePageView-C6p0e0v-.js";import{u as js,X as ws}from"./XiaoxiongChatContent-OFHmDqOm.js";import{P as Ns}from"./PullToRefresh-C5cS2eNQ.js";import{P as ks,a as _s,b as Cs}from"./popover-DEo1gqDn.js";import{u as Ss,a as Ls}from"./useRestaurants-B9CCGo6C.js";import{u as As,R as Ts,l as Rs}from"./xiaoxiong-logo-clean-mZ583h23.js";import{u as Ee}from"./useLocalizedContent-N57tkM8u.js";import{u as $e}from"./useActivities-CqdXqqts.js";import{L as Ms}from"./LocationPermissionDialog-376pRSlV.js";import{E as zs}from"./ExternalLinkConfirmDialog-BKNEKkc3.js";import{a as Ne,f as pe,K as Ds,L as ke,M as Es,i as $s}from"./vendor-utils-vwQGbBim.js";import"./vendor-i18n-jtdHZIRR.js";import"./vendor-editor-B1vH4T8i.js";import"./vendor-supabase-BnZwaL-Z.js";import"./vendor-map-CvE3ASYw.js";const Is=({open:t,onOpenChange:a})=>{const{i18n:n}=U(),m=ge(),r=Te(),{settings:p}=be(),l=p?.logo_url,x=p?.ai_provider||"xiaoxiong-community",{input:i,setInput:c,messages:g,isLoading:d,showLocationDialog:b,setShowLocationDialog:v,pendingMessage:j,setPendingMessage:y,handleSubmit:R,handleKeyDown:C,handleLocationConfirm:F,processMessage:L,abortRequest:B,requestLocation:k}=js(x);o.useEffect(()=>{t&&r&&(a(!1),m("/ask-xiaoxiong"))},[t,r,m,a]),o.useEffect(()=>{t&&!r&&k()},[t,r,k]);const V=()=>{B(),a(!1)},A=()=>n.language==="zh"?"小熊AI助手":n.language==="pt"?"Assistente IA Xiaoxiong":"Xiaoxiong AI Assistant";return r?null:e.jsx(as,{open:t,onOpenChange:V,children:e.jsxs(rs,{className:"sm:max-w-2xl sm:h-[90vh] sm:max-h-[90vh] flex flex-col p-0 gap-0 overflow-hidden",children:[e.jsx(os,{className:"px-4 py-3 shrink-0 border-b",children:e.jsxs(ns,{className:"text-base font-semibold flex items-center gap-2",children:[l&&e.jsx("img",{src:l,alt:"Logo",className:"w-8 h-8 rounded-full object-cover"}),A()]})}),e.jsx("div",{className:"flex-1 min-h-0 flex flex-col overflow-hidden",children:e.jsx(ws,{messages:g,input:i,setInput:c,isLoading:d,showLocationDialog:b,setShowLocationDialog:v,pendingMessage:j,handleSubmit:R,handleKeyDown:C,handleLocationConfirm:F,processMessage:L,setPendingMessage:y,onClose:V,showBackButton:!1,showHeader:!1,className:"flex-1"})})]})})},_e=({restaurant:t,language:a})=>{const[n,m]=o.useState(999),r=o.useRef(null),p=t.type.slice(0,3).map((i,c)=>({key:`type-${c}`,label:i,variant:"secondary",color:void 0}));o.useEffect(()=>{const i=()=>{if(!r.current)return;const g=r.current,d=Array.from(g.querySelectorAll(".tag-badge"));if(d.length===0){setTimeout(i,50);return}const b=d[0]?.offsetTop;let v=d.length;for(let j=0;j<d.length;j++)if(d[j].offsetTop>b){v=j;break}v<d.length&&(v=Math.max(1,v-1)),m(v)};m(999);const c=setTimeout(i,100);return window.addEventListener("resize",i),()=>{clearTimeout(c),window.removeEventListener("resize",i)}},[p.length,t.id]);const l=p.slice(0,n),x=p.length>n;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{ref:r,className:"flex gap-1.5 flex-wrap flex-1",children:l.map(i=>e.jsx(S,{variant:i.variant,className:"text-xs font-medium whitespace-nowrap tag-badge",style:i.color?{backgroundColor:i.color,color:"white"}:void 0,children:i.label},i.key))}),x&&e.jsxs(ks,{children:[e.jsx(_s,{asChild:!0,children:e.jsx(E,{variant:"ghost",size:"sm",className:"h-6 px-2 text-muted-foreground hover:text-foreground flex-shrink-0",children:e.jsx(Ue,{className:"h-4 w-4"})})}),e.jsx(Cs,{className:"w-80",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:p.map(i=>e.jsx(S,{variant:i.variant,className:"text-xs font-medium",style:i.color?{backgroundColor:i.color,color:"white"}:void 0,children:i.label},i.key))})})]})]})},Fs=()=>{const t=ge(),{t:a,i18n:n}=U(),{toast:m}=is(),{localizeRestaurant:r}=Ee(),[p,l]=o.useState(""),[x,i]=o.useState([]),[c,g]=o.useState(null),[d,b]=o.useState([]),[v,j]=o.useState(null),[y,R]=o.useState(null),[C,F]=o.useState(!1),[L,B]=o.useState(!1),[k,V]=o.useState(!1),A=o.useRef(null),M=o.useRef(null),I=o.useRef({}),[w,h]=o.useState(null),[P,me]=o.useState(!1),[ue,H]=o.useState(!1),[W,ae]=o.useState(!1),[X,re]=o.useState(!1),G=4,{data:Z,isLoading:Y}=Ss(p,x.length>0?x.join(","):void 0),{data:f=[]}=Ls(),{data:_=[]}=$e(),{data:z={}}=As(),N=_.filter(s=>(z[s.id]||0)>0),J=s=>{i(u=>u.includes(s)?u.filter(T=>T!==s):[...u,s])},Q=()=>{H(!0)},ee=async()=>{H(!1);try{const s=await gs();R({lat:s.coords.latitude,lng:s.coords.longitude}),m({title:a("restaurants.locationEnabled"),description:a("restaurants.sortByDistance")})}catch(s){console.error("Location error:",s)}},O=s=>{j(s),s&&!y&&Q()},oe=async s=>{if(c===s)g(null),b([]);else{g(s);const{data:u,error:T}=await ds.from("activity_restaurants").select("restaurant_id").eq("activity_id",s);T?(console.error("Error fetching activity restaurants:",T),b([])):b(u.map(We=>We.restaurant_id))}},K=Z?.map(s=>{const u=r(s);if(y){const T=fs(y.lat,y.lng,s.lat,s.lng);return{...u,distance:T}}return u})||[],se=c?K.filter(s=>d.includes(s.id)):K,D=v&&y?se.filter(s=>s.distance&&s.distance<=v).sort((s,u)=>(s.distance||0)-(u.distance||0)):y?se.sort((s,u)=>(s.distance||0)-(u.distance||0)):se.sort((s,u)=>(u.rating||0)-(s.rating||0)),te=s=>{t(`/restaurant/${s.id}`)},q=s=>{h(s.id);const u=I.current[s.id];u&&u.scrollIntoView({behavior:"smooth",block:"center"})},xe=()=>{const s=document.getElementById("home-map-container");if(s)if(C)document.exitFullscreen&&document.exitFullscreen();else{if(A.current){const u=A.current.getCenter(),T=A.current.getZoom();M.current={center:[u.lng,u.lat],zoom:T}}s.requestFullscreen&&s.requestFullscreen()}};return o.useEffect(()=>{const s=()=>{const u=!!document.fullscreenElement;F(u),!u&&M.current&&A.current&&setTimeout(()=>{A.current?.jumpTo({center:M.current.center,zoom:M.current.zoom})},100)};return document.addEventListener("fullscreenchange",s),()=>{document.removeEventListener("fullscreenchange",s)}},[]),e.jsxs("div",{className:"animate-fade-in",children:[e.jsxs("div",{className:"text-left mb-6",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-foreground mb-2 sm:mb-3",children:a("nav.mapView")}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:a("map.subtitle")})]}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[e.jsx("div",{className:"flex-1 max-w-md",children:e.jsx(ls,{placeholder:a("restaurants.search"),value:p,onChange:s=>l(s.target.value),className:"h-11 bg-background/60 backdrop-blur-sm border-primary/20 focus:border-primary"})}),e.jsxs("div",{className:"flex gap-2 md:contents",children:[e.jsxs(E,{variant:y?"default":"outline",onClick:y?void 0:Q,className:"flex-1 md:flex-initial gap-2 h-11 md:px-6",children:[e.jsx(ne,{className:`w-4 h-4 ${y?"animate-pulse":""}`}),e.jsx("span",{className:"md:hidden",children:a("restaurants.getLocationMobile")}),e.jsx("span",{className:"hidden md:inline",children:a(y?"restaurants.locationEnabled":"restaurants.getLocation")})]}),e.jsxs(E,{variant:P?"default":"outline",onClick:()=>me(!P),className:"flex-1 md:flex-initial gap-2 h-11 md:px-6",children:[e.jsx(Xe,{className:"w-4 h-4"}),a("restaurants.filter")]})]})]}),P&&e.jsxs("div",{className:"space-y-3 bg-card/50 backdrop-blur-sm rounded-lg p-4 border border-border/50 animate-fade-in",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("span",{className:"text-sm font-semibold text-foreground",children:[a("restaurants.restaurantTypes"),":"]}),x.length>0&&e.jsx(S,{variant:"outline",className:"cursor-pointer hover:bg-destructive hover:text-destructive-foreground hover:scale-105 transition-all duration-200 px-2 py-0 text-xs h-5",onClick:()=>i([]),children:a("common.actions.clearFilter")}),f.length>8&&e.jsx(E,{variant:"ghost",size:"sm",className:"h-5 px-2 text-xs text-primary hover:text-primary/80 ml-auto hidden sm:flex transition-all duration-200",onClick:()=>B(!L),children:a(L?"common.showLess":"common.showMore")})]}),e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx("div",{className:`hidden sm:flex gap-2 flex-wrap transition-all duration-300 ease-out ${L?"animate-expand-height":""}`,children:(L?f:f.slice(0,8)).map((s,u)=>e.jsx(S,{variant:x.includes(s)?"default":"secondary",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs whitespace-nowrap hover:scale-105 active:animate-tag-select ${x.includes(s)?"ring-2 ring-primary/30 shadow-sm":""}`,style:{animationDelay:`${u*30}ms`},onClick:()=>J(s),children:s},s))}),e.jsxs("div",{className:"sm:hidden relative -mx-1 px-1",children:[e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide snap-x snap-mandatory scroll-smooth",children:f.map((s,u)=>e.jsx(S,{variant:x.includes(s)?"default":"secondary",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs whitespace-nowrap flex-shrink-0 snap-start hover:scale-105 active:animate-tag-select ${x.includes(s)?"ring-2 ring-primary/30 shadow-sm":""}`,style:{animationDelay:`${u*30}ms`},onClick:()=>J(s),children:s},s))}),e.jsx("div",{className:"absolute left-0 top-0 bottom-2 w-4 bg-gradient-to-r from-card via-card/60 to-transparent pointer-events-none"}),e.jsx("div",{className:"absolute right-0 top-0 bottom-2 w-4 bg-gradient-to-l from-card via-card/60 to-transparent pointer-events-none"})]})]})]}),N.length>0&&e.jsxs("div",{className:"space-y-2 pt-1 border-t border-border/30",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("span",{className:"text-sm font-semibold text-foreground",children:[a("nav.activities"),":"]}),c&&e.jsx(S,{variant:"outline",className:"cursor-pointer hover:bg-destructive hover:text-destructive-foreground hover:scale-105 transition-all duration-200 px-2 py-0 text-xs h-5",onClick:()=>{g(null),b([])},children:a("common.actions.clearFilter")}),N.length>8&&e.jsx(E,{variant:"ghost",size:"sm",className:"h-5 px-2 text-xs text-primary hover:text-primary/80 ml-auto hidden sm:flex transition-all duration-200",onClick:()=>V(!k),children:a(k?"common.showLess":"common.showMore")})]}),e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx("div",{className:`hidden sm:flex gap-2 flex-wrap transition-all duration-300 ease-out ${k?"animate-expand-height":""}`,children:(k?N:N.slice(0,8)).map((s,u)=>{const T=n.language==="zh"?s.badge_text_zh||s.title_zh:n.language==="pt"?s.badge_text_pt||s.title_pt:s.badge_text_en||s.title_en;return e.jsx(S,{variant:c===s.id?"default":"secondary",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs whitespace-nowrap hover:scale-105 active:animate-tag-select ${c===s.id?"ring-2 ring-primary/30 shadow-sm":""}`,style:{animationDelay:`${u*30}ms`},onClick:()=>oe(s.id),children:T},s.id)})}),e.jsxs("div",{className:"sm:hidden relative -mx-1 px-1",children:[e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide snap-x snap-mandatory scroll-smooth",children:N.map((s,u)=>{const T=n.language==="zh"?s.badge_text_zh||s.title_zh:n.language==="pt"?s.badge_text_pt||s.title_pt:s.badge_text_en||s.title_en;return e.jsx(S,{variant:c===s.id?"default":"secondary",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs whitespace-nowrap flex-shrink-0 snap-start hover:scale-105 active:animate-tag-select ${c===s.id?"ring-2 ring-primary/30 shadow-sm":""}`,style:{animationDelay:`${u*30}ms`},onClick:()=>oe(s.id),children:T},s.id)})}),e.jsx("div",{className:"absolute left-0 top-0 bottom-2 w-4 bg-gradient-to-r from-card via-card/60 to-transparent pointer-events-none"}),e.jsx("div",{className:"absolute right-0 top-0 bottom-2 w-4 bg-gradient-to-l from-card via-card/60 to-transparent pointer-events-none"})]})]})]})]}),y&&e.jsxs("div",{className:"flex gap-2 flex-wrap items-center bg-muted/30 backdrop-blur-sm rounded-lg p-3 border border-primary/10",children:[e.jsxs("span",{className:"text-sm font-semibold text-primary",children:[a("restaurants.radius"),":"]}),e.jsx(S,{variant:v===null?"default":"secondary",className:"cursor-pointer hover:scale-105 transition-transform",onClick:()=>O(null),children:a("restaurants.allRestaurants")}),e.jsx(S,{variant:v===5?"default":"secondary",className:"cursor-pointer hover:scale-105 transition-transform",onClick:()=>O(5),children:a("restaurants.radius5km")}),e.jsx(S,{variant:v===10?"default":"secondary",className:"cursor-pointer hover:scale-105 transition-transform",onClick:()=>O(10),children:a("restaurants.radius10km")}),e.jsx(S,{variant:v===20?"default":"secondary",className:"cursor-pointer hover:scale-105 transition-transform",onClick:()=>O(20),children:a("restaurants.radius20km")})]})]}),!Y&&D&&e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[e.jsx("div",{className:`w-full lg:flex-1 transition-all duration-300 ease-in-out ${W?"h-0 overflow-hidden lg:h-[500px]":"h-[400px] lg:h-[500px]"}`,children:e.jsxs("div",{id:"home-map-container",className:`${C?"fixed inset-0 z-50 bg-background":"w-full h-full"} rounded-xl overflow-hidden shadow-2xl border border-primary/10 relative group`,children:[e.jsx(E,{variant:"secondary",size:"icon",className:"absolute bottom-4 right-4 z-10 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity",onClick:xe,children:C?e.jsx(Qe,{className:"w-5 h-5"}):e.jsx(Ke,{className:"w-5 h-5"})}),e.jsxs("div",{className:"h-full relative",children:[e.jsx(Ts,{restaurants:D,onRestaurantClick:te,userLocation:y,radiusFilter:v,onMarkerClick:q,showViewDetailsButton:!0,onMapInit:s=>{A.current=s}}),e.jsxs("div",{className:"absolute bottom-4 left-4 z-10 pointer-events-none flex items-center gap-2 bg-background/80 backdrop-blur-sm px-3 py-2 rounded-full shadow-lg",children:[e.jsx("img",{src:Rs,alt:"Xiaoxiong Market Logo",className:"h-6 w-6 object-contain"}),e.jsx("span",{className:"text-sm font-semibold text-foreground whitespace-nowrap",children:n.language==="zh"?"小熊市场":"Xiaoxiong Market"})]})]})]})}),e.jsx(E,{variant:"outline",size:"sm",className:"lg:hidden flex items-center justify-center gap-2 -mt-3 mb-1",onClick:()=>ae(!W),children:W?e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"w-4 h-4"}),a("map.showMap")]}):e.jsxs(e.Fragment,{children:[e.jsx(ve,{className:"w-4 h-4"}),a("map.hideMap")]})}),e.jsxs("div",{className:"w-full lg:w-[420px] flex flex-col",children:[e.jsxs("div",{className:"mb-4 pb-4 border-b border-border",children:[e.jsxs("h2",{className:"text-xl sm:text-2xl font-bold text-foreground flex items-center gap-2",children:[e.jsx(ie,{className:"w-6 h-6 text-primary"}),a("restaurants.title"),e.jsx(S,{variant:"secondary",className:"ml-2",children:D.length})]}),y&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-2 flex items-center gap-1.5",children:[e.jsx(ne,{className:"w-4 h-4"}),a("restaurants.sortedByDistance")]})]}),D.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(ie,{className:"w-16 h-16 text-muted-foreground/40 mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-foreground mb-2",children:a("restaurants.noResults")}),e.jsx("p",{className:"text-muted-foreground max-w-xs",children:a("restaurants.noResultsDesc")})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"lg:hidden space-y-3 pb-4",children:[(X?D:D.slice(0,G)).map(s=>e.jsx(de,{ref:u=>I.current[s.id]=u,className:`p-5 cursor-pointer hover:shadow-xl transition-all duration-300 hover:scale-[1.02] hover:border-primary/40 border-2 bg-gradient-to-br from-card to-card/50 backdrop-blur-sm ${w===s.id?"border-primary ring-2 ring-primary ring-offset-2":"border-transparent"}`,onClick:()=>te(s),children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h3",{className:"font-bold text-lg text-foreground line-clamp-1 flex-1",children:s.name}),s.distance!==void 0&&e.jsxs("div",{className:"flex items-center gap-1.5 bg-primary/10 px-2.5 py-1 rounded-full w-fit",children:[e.jsx(ne,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"font-bold text-sm text-primary",children:s.distance<1?`${(s.distance*1e3).toFixed(0)} m`:`${s.distance.toFixed(1)} km`})]})]}),s.rating>0&&e.jsxs("div",{className:"flex items-center gap-1.5 bg-primary/10 px-2.5 py-1 rounded-full flex-shrink-0",children:[e.jsx(je,{className:"w-4 h-4",style:{fill:"#016450",color:"#016450"}}),e.jsx("span",{className:"font-bold text-sm text-primary",children:s.rating})]})]}),s.type&&s.type.length>0&&e.jsx(_e,{restaurant:s,language:n.language}),e.jsxs("div",{className:"flex items-start gap-2 text-sm text-muted-foreground",children:[e.jsx(ie,{className:"w-4 h-4 mt-0.5 flex-shrink-0 text-primary/60"}),e.jsx("span",{className:"line-clamp-2",children:s.address})]})]})},s.id)),D.length>G&&e.jsx(E,{variant:"outline",className:"w-full mt-2 gap-2",onClick:()=>re(!X),children:X?e.jsxs(e.Fragment,{children:[e.jsx(ve,{className:"w-4 h-4"}),a("map.collapseList")]}):e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"w-4 h-4"}),a("map.showAllRestaurants",{count:D.length})]})})]}),e.jsx(cs,{className:"hidden lg:block h-[420px] pr-4",children:e.jsx("div",{className:"space-y-3 pb-4",children:D.map(s=>e.jsx(de,{ref:u=>I.current[s.id]=u,className:`p-5 cursor-pointer hover:shadow-xl transition-all duration-300 hover:scale-[1.02] hover:border-primary/40 border-2 bg-gradient-to-br from-card to-card/50 backdrop-blur-sm ${w===s.id?"border-primary ring-2 ring-primary ring-offset-2":"border-transparent"}`,onClick:()=>te(s),children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h3",{className:"font-bold text-lg text-foreground line-clamp-1 flex-1",children:s.name}),s.distance!==void 0&&e.jsxs("div",{className:"flex items-center gap-1.5 bg-primary/10 px-2.5 py-1 rounded-full w-fit",children:[e.jsx(ne,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"font-bold text-sm text-primary",children:s.distance<1?`${(s.distance*1e3).toFixed(0)} m`:`${s.distance.toFixed(1)} km`})]})]}),s.rating>0&&e.jsxs("div",{className:"flex items-center gap-1.5 bg-primary/10 px-2.5 py-1 rounded-full flex-shrink-0",children:[e.jsx(je,{className:"w-4 h-4",style:{fill:"#016450",color:"#016450"}}),e.jsx("span",{className:"font-bold text-sm text-primary",children:s.rating})]})]}),s.type&&s.type.length>0&&e.jsx(_e,{restaurant:s,language:n.language}),e.jsxs("div",{className:"flex items-start gap-2 text-sm text-muted-foreground",children:[e.jsx(ie,{className:"w-4 h-4 mt-0.5 flex-shrink-0 text-primary/60"}),e.jsx("span",{className:"line-clamp-2",children:s.address})]})]})},s.id))})})]})]})]}),e.jsx(Ms,{open:ue,onOpenChange:H,onConfirm:ee})]})},Ie=o.memo(({stats:t,onAskXiaoxiong:a})=>{const{t:n,i18n:m}=U(),{data:r}=De(),{buttons:p}=ms(),{settings:l}=be(),x=m.language,[i,c]=o.useState(!1),g=l?.about_us_button_mobile!==!1,d=p?.find(C=>C.label_zh==="演示"||C.link?.includes("v.xiaoxiong.pt"));d&&d.enabled!==!1&&d.visible!==!1&&d.show_on_mobile;const b=C=>!r||r.length===0?"":r[0][`${C}${x==="zh"?"_zh":x==="pt"?"_pt":"_en"}`]||"",v=b("title")||n("home.hero.title"),j=b("description")||n("home.hero.description"),y=b("subtitle_button_text")||n("home.hero.subtitle"),R=()=>{d?.link&&us(d.link),c(!1)};return e.jsxs("section",{className:"min-h-[55vh] flex flex-col bg-secondary/20",children:[e.jsxs("div",{className:"pt-20 px-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl font-bold text-foreground",children:n("home.hero.brandName")}),e.jsx("img",{src:ze,alt:"map icon",width:28,height:28,loading:"eager",decoding:"async",className:"w-7 h-7 object-contain flex-shrink-0"})]}),g&&e.jsxs(Ce,{to:"/about-us",className:"flex items-center gap-1 px-2 py-1 text-xs bg-background/80 backdrop-blur-sm rounded-full border border-border/50 shadow-sm hover:bg-background transition-colors whitespace-nowrap flex-shrink-0",children:[e.jsx(Ge,{className:"w-3.5 h-3.5 text-primary flex-shrink-0"}),e.jsx("span",{className:"text-foreground/80",children:n("nav.aboutUs","关于我们")})]})]}),t&&e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(ce,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:n("home.stats.delivery")}),e.jsx("span",{className:"font-bold text-foreground text-sm",children:t.order_count})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Se,{className:"w-4 h-4 text-accent"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:n("home.stats.reservation")}),e.jsx("span",{className:"font-bold text-foreground text-sm",children:t.reserve_count})]})]})]}),e.jsx("div",{className:"flex-1 flex flex-col items-center justify-center px-4 py-8",children:e.jsxs("div",{className:"max-w-md mx-auto text-center space-y-4",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground leading-tight",children:v}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground max-w-sm mx-auto",children:j}),e.jsx("div",{className:"pt-4",children:e.jsxs("button",{onClick:a,className:"group flex items-center gap-3 bg-secondary/50 backdrop-blur-sm text-foreground px-5 py-3.5 rounded-full shadow-sm hover:shadow-md hover:bg-secondary/70 transition-all duration-300 cursor-text border border-border/50 mx-auto",children:[e.jsx(Le,{className:"w-5 h-5 text-primary group-hover:text-primary/80 transition-colors"}),e.jsx("span",{className:"text-sm text-muted-foreground group-hover:text-foreground transition-colors",children:y}),e.jsx(Ae,{className:"w-4 h-4 text-muted-foreground/60 ml-2"})]})})]})}),e.jsx(zs,{open:i,onOpenChange:c,onConfirm:R,url:d?.link})]})});Ie.displayName="MobileHeroSection";const Bs=t=>!t||!Array.isArray(t)?!1:t.every(a=>typeof a=="object"&&a!==null&&"start"in a&&"end"in a&&typeof a.start=="number"&&typeof a.end=="number"),Vs=(t,a)=>{const n=pe(new Date(t.start_date)),m=t.end_date?pe(new Date(t.end_date)):null,r=pe(a);if(r<n||m&&r>m)return!1;switch(t.repeat_mode||"none"){case"none":return $s(n,r);case"daily":return!0;case"weekly":const l=Es(r);return t.repeat_weekday===l;case"monthly":const i=ke(r),c=t.repeat_month_day;return Bs(c)?c.some(j=>i>=j.start&&i<=j.end):!1;case"yearly":const g=Ds(r)+1,d=ke(r),b=t.repeat_yearly_month,v=t.repeat_yearly_day;return b===g&&v===d;default:return!1}},le=t=>{switch(t.repeat_mode||"none"){case"none":return 0;case"weekly":return 1;case"monthly":return 2;case"yearly":return 3;case"daily":return 4;default:return 5}},Ps=()=>{const{data:t,isLoading:a}=$e(),n=o.useMemo(()=>{if(!t)return{today:[],tomorrow:[],dayAfterTomorrow:[]};const r=new Date,p=Ne(r,1),l=Ne(r,2),x=i=>t.filter(c=>c.visible&&c.status==="published").filter(c=>Vs(c,i)).sort((c,g)=>{const d=le(c)-le(g);return d!==0?d:c.pinned!==g.pinned?c.pinned?-1:1:(c.sort_order||0)-(g.sort_order||0)});return{today:x(r),tomorrow:x(p),dayAfterTomorrow:x(l)}},[t]),m=o.useMemo(()=>{const r=new Set,p=[];return n.today.forEach(l=>{r.has(l.id)||(r.add(l.id),p.push({...l,dayLabel:"today"}))}),n.tomorrow.forEach(l=>{r.has(l.id)||(r.add(l.id),p.push({...l,dayLabel:"tomorrow"}))}),n.dayAfterTomorrow.forEach(l=>{r.has(l.id)||(r.add(l.id),p.push({...l,dayLabel:"dayAfterTomorrow"}))}),p.sort((l,x)=>{const i=le(l)-le(x);return i!==0?i:l.pinned!==x.pinned?l.pinned?-1:1:(l.sort_order||0)-(x.sort_order||0)})},[n]);return{recentActivities:n,allRecentActivities:m,isLoading:a,hasActivities:m.length>0}},Fe=()=>{const[t,a]=o.useState(4);return o.useEffect(()=>{const n=()=>{const m=window.innerWidth;m<640?a(2):m<1024?a(3):a(4)};return n(),window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]),t},Be=o.memo(({activity:t,dayLabel:a})=>{const n=ge(),{t:m}=U(),{getLocalizedField:r}=Ee(),p=r(t,"title"),l=o.useMemo(()=>{switch(t.service_type){case"dine_in":return m("activities.serviceType.dine_in");case"takeaway":return m("activities.serviceType.takeaway");case"both":return m("activities.serviceType.both");default:return""}},[t.service_type,m]),x=()=>{n(`/activity/${t.id}`)};return e.jsxs(de,{className:"group cursor-pointer overflow-hidden hover:shadow-lg transition-all duration-300 border-border/50 bg-card",onClick:x,children:[e.jsxs("div",{className:"relative aspect-[16/10] overflow-hidden bg-muted",children:[t.image_url?e.jsx("img",{src:t.image_url,alt:p,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",loading:"lazy"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-primary/20 to-primary/5",children:e.jsx(Ze,{className:"w-12 h-12 text-primary/40"})}),e.jsx(S,{className:$("absolute top-2 left-2 text-xs font-medium",a===m("home.recentActivities.today")?"bg-primary text-primary-foreground":"bg-secondary text-secondary-foreground"),children:a}),t.pinned&&e.jsx(S,{className:"absolute top-2 right-2 text-xs bg-accent text-accent-foreground",children:m("activities.pinned")})]}),e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx("h3",{className:"font-medium text-sm leading-tight line-clamp-2 text-foreground group-hover:text-primary transition-colors",children:p}),e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[t.service_type==="dine_in"&&e.jsx(we,{className:"w-3 h-3 flex-shrink-0"}),t.service_type==="takeaway"&&e.jsx(ce,{className:"w-3 h-3 flex-shrink-0"}),t.service_type==="both"&&e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"w-3 h-3 flex-shrink-0"}),e.jsx(ce,{className:"w-3 h-3 flex-shrink-0"})]}),e.jsx("span",{className:"truncate",children:l})]})]})]})});Be.displayName="ActivityCard";const Ve=o.memo(()=>{const t=Fe();return e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4",children:Array.from({length:t}).map((a,n)=>e.jsxs(de,{className:"overflow-hidden",children:[e.jsx(he,{className:"aspect-[16/10] w-full"}),e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx(he,{className:"h-4 w-full"}),e.jsx(he,{className:"h-3 w-2/3"})]})]},n))})});Ve.displayName="LoadingSkeleton";const Pe=o.memo(()=>{const{t}=U(),{allRecentActivities:a,isLoading:n,hasActivities:m}=Ps(),r=Fe(),[p,l]=o.useState(!1),x=g=>{switch(g){case"today":return t("home.recentActivities.today");case"tomorrow":return t("home.recentActivities.tomorrow");case"dayAfterTomorrow":return t("home.recentActivities.dayAfterTomorrow");default:return""}},i=o.useMemo(()=>p?a:a.slice(0,r),[a,r,p]),c=a.length>r;return!n&&!m?null:e.jsx("section",{className:"py-8 sm:py-12 px-4 bg-secondary/20",children:e.jsxs("div",{className:"container mx-auto max-w-7xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-foreground",children:t("home.recentActivities.title")}),c&&!p&&e.jsx(E,{variant:"ghost",size:"sm",className:"text-primary hover:text-primary/80",onClick:()=>l(!0),children:e.jsxs("span",{className:"flex items-center gap-1",children:[t("home.recentActivities.viewAll"),e.jsx(Ye,{className:"w-4 h-4"})]})}),p&&e.jsx(E,{variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-foreground",onClick:()=>l(!1),children:e.jsx("span",{className:"flex items-center gap-1",children:t("home.recentActivities.collapse")})})]}),n?e.jsx(Ve,{}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4",children:i.map(g=>e.jsx(Be,{activity:g,dayLabel:x(g.dayLabel)},g.id))})]})})});Pe.displayName="RecentActivitiesSection";const fe="/images/sushi-ramen-hero.jpg",Oe="/images/sushi-ramen-mobile.jpg",qe=o.memo(({stats:t,t:a})=>e.jsx("div",{className:"absolute top-16 sm:top-20 left-3 z-20",children:e.jsxs("div",{className:"gap-4 w-fit flex-col flex items-start justify-start",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm text-white/90 drop-shadow-md",children:a("home.stats.delivery")}),e.jsx("span",{className:"font-bold text-white text-sm drop-shadow-md",children:t.order_count})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"w-4 h-4 text-accent"}),e.jsx("span",{className:"text-sm text-white/90 drop-shadow-md",children:a("home.stats.reservation")}),e.jsx("span",{className:"font-bold text-white text-sm drop-shadow-md",children:t.reserve_count})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl sm:text-2xl font-bold text-white drop-shadow-md",children:a("home.hero.brandName")}),e.jsx("img",{src:ze,alt:"map icon",width:32,height:32,loading:"eager",decoding:"async",className:"w-7 sm:w-8 h-7 sm:h-8 object-contain flex-shrink-0"})]})]})}));qe.displayName="StatsDisplay";const Os=()=>{const t=window.innerWidth<640,a=window.innerWidth>=1024,n=navigator.connection,m=Me(),r=Re();return a?!!n?.saveData:!!(r&&!m||n&&(n.saveData||n.effectiveType==="2g"||n.effectiveType==="slow-2g")||t&&navigator.deviceMemory&&navigator.deviceMemory<2)},He=o.memo(({template:t,isActive:a,currentLang:n,t:m,onContentReady:r,onAskXiaoxiong:p})=>{const[l,x]=o.useState({}),[i,c]=o.useState({}),[g,d]=o.useState({}),[b,v]=o.useState({mobile:!0,tablet:!0,desktop:!0}),[j,y]=o.useState(!1),R=Os(),C=o.useRef(null),F=o.useRef(null),L=o.useRef(null),B=f=>t[`${f}${n==="zh"?"_zh":n==="pt"?"_pt":"_en"}`]||"",k=()=>window.innerWidth<640?"mobile":window.innerWidth<1024?"tablet":"desktop",V=()=>{const f=k();return f==="mobile"&&t.mobile_overlay_opacity!==null?t.mobile_overlay_opacity:f==="tablet"&&t.tablet_overlay_opacity!==null?t.tablet_overlay_opacity:f==="desktop"&&t.desktop_overlay_opacity!==null?t.desktop_overlay_opacity:t.overlay_opacity??30},A=()=>{const f=V(),_=t.overlay_gradient_direction||"to-b",z=(q,xe)=>q==null?xe/100:q>1?q/100:q,N=f>1?f/100:f,J=z(t.overlay_gradient_from_opacity,30)*N,Q=z(t.overlay_gradient_via_opacity,25)*N,ee=z(t.overlay_gradient_to_opacity,40)*N,oe={"to-t":"to top","to-b":"to bottom","to-l":"to left","to-r":"to right","to-tl":"to top left","to-tr":"to top right","to-bl":"to bottom left","to-br":"to bottom right"}[_]||"to bottom",K={black:"0, 0, 0",white:"255, 255, 255",background:"0, 0, 0",foreground:"255, 255, 255",primary:"1, 100, 80",secondary:"240, 240, 240"},se=K[t.overlay_gradient_from||"black"]||"0, 0, 0",D=K[t.overlay_gradient_via||"black"]||"0, 0, 0",te=K[t.overlay_gradient_to||"black"]||"0, 0, 0";return{background:`linear-gradient(${oe}, rgba(${se}, ${J}), rgba(${D}, ${Q}), rgba(${te}, ${ee}))`}},M=t.mobile_image_url||Oe,I=t.tablet_image_url||t.desktop_image_url||fe,w=t.desktop_image_url||fe,h=t.background_blur||0,P=t.desktop_media_type||t.media_type||"image",me=t.tablet_media_type||t.media_type||"image",ue=t.mobile_media_type||t.media_type||"image",H=P==="video"&&!R,W=me==="video"&&!R,ae=ue==="video"&&!R,X=ae?t.mobile_video_url:null,re=W?t.tablet_video_url||t.desktop_video_url:null,G=H?t.desktop_video_url:null;o.useEffect(()=>{const f=k(),_=f==="mobile"?M:f==="tablet"?I:w;if(_){const z=new Image;z.onload=()=>{x(N=>({...N,[f]:!0})),v(N=>({...N,[f]:!0})),a&&(r?.(),setTimeout(()=>y(!0),100))},z.src=_}},[M,I,w,a,r]),o.useEffect(()=>{a&&l[k()]&&y(!0)},[a,l]);const Z=f=>{c(_=>({..._,[f]:!0}))},Y=(f,_)=>{console.error(`[HeroSlide] Video error on ${f}:`,_),d(z=>({...z,[f]:!0}))};return o.useEffect(()=>{if(!j||!a||!ps())return;const _=k(),N=(_==="mobile"?C:_==="tablet"?F:L).current;if(!N)return;const Q=setTimeout(async()=>{try{N.muted=!0,N.playsInline=!0,N.setAttribute("webkit-playsinline","true"),await N.play(),console.log(`[HeroSlide] iOS video play successful on ${_}`)}catch(ee){console.error(`[HeroSlide] iOS video play failed on ${_}:`,ee),d(O=>({...O,[_]:!0}))}},150);return()=>clearTimeout(Q)},[j,a]),e.jsxs("div",{className:$("absolute inset-0 w-full h-full transition-opacity duration-1000",a?"opacity-100 z-10":"opacity-0 z-0"),children:[e.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[e.jsxs("div",{className:"absolute inset-0 w-full h-full sm:hidden",children:[!b.mobile&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),ae&&X?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:M,alt:"Background",className:$("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",i.mobile&&!g.mobile?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:h>0?`blur(${h}px)`:void 0}}),j&&!g.mobile&&e.jsx("video",{ref:C,src:X,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>Z("mobile"),onError:f=>Y("mobile",f),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:h>0?`blur(${h}px)`:void 0}})]}):e.jsx("img",{src:M,alt:"Background",className:$("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",b.mobile?"opacity-100":"opacity-0"),style:{filter:h>0?`blur(${h}px)`:void 0}})]}),e.jsxs("div",{className:"absolute inset-0 w-full h-full hidden sm:block lg:hidden",children:[!b.tablet&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),W&&re?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:I,alt:"Background",className:$("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",i.tablet&&!g.tablet?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:h>0?`blur(${h}px)`:void 0}}),j&&!g.tablet&&e.jsx("video",{ref:F,src:re,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>Z("tablet"),onError:f=>Y("tablet",f),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:h>0?`blur(${h}px)`:void 0}})]}):e.jsx("img",{src:I,alt:"Background",className:$("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",b.tablet?"opacity-100":"opacity-0"),style:{filter:h>0?`blur(${h}px)`:void 0}})]}),e.jsxs("div",{className:"absolute inset-0 w-full h-full hidden lg:block",children:[!b.desktop&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),H&&G?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:w,alt:"Background",className:$("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",i.desktop&&!g.desktop?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:h>0?`blur(${h}px)`:void 0}}),j&&!g.desktop&&e.jsx("video",{ref:L,src:G,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>Z("desktop"),onError:f=>Y("desktop",f),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:h>0?`blur(${h}px)`:void 0}})]}):e.jsx("img",{src:w,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:$("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",b.desktop?"opacity-100":"opacity-0"),style:{filter:h>0?`blur(${h}px)`:void 0}})]}),e.jsx("div",{className:"absolute inset-0 w-full h-full",style:A()})]}),e.jsx("div",{className:"relative z-10 container mx-auto px-4 sm:px-6 flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center space-y-4 sm:space-y-8 animate-fade-in w-full",children:[e.jsx("h1",{className:"text-3xl sm:text-5xl md:text-7xl font-bold text-white leading-tight px-4 drop-shadow-[0_2px_8px_rgba(0,0,0,0.8)]",children:B("title")||m("home.hero.title")}),e.jsx("p",{className:"text-sm sm:text-xl md:text-2xl text-white/95 max-w-2xl mx-auto px-4 drop-shadow-[0_2px_6px_rgba(0,0,0,0.7)]",children:B("description")||m("home.hero.description")}),t.subtitle_button_text_zh&&e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:p,className:"group flex items-center gap-3 bg-white/20 backdrop-blur-xl text-white px-5 sm:px-7 py-3.5 sm:py-4 rounded-full shadow-[0_8px_32px_rgba(0,0,0,0.12)] hover:shadow-[0_16px_48px_rgba(0,0,0,0.2)] hover:bg-white/30 transition-all duration-300 cursor-text border border-white/40",children:[e.jsx(Le,{className:"w-5 h-5 text-white/90 group-hover:text-white transition-colors drop-shadow-sm"}),e.jsx("span",{className:"text-sm sm:text-base text-primary group-hover:text-primary/80 transition-colors drop-shadow-sm font-medium",children:B("subtitle_button_text")||m("home.hero.subtitle")}),e.jsx(Ae,{className:"w-4 h-4 text-white/60 ml-2 drop-shadow-sm"})]})})]})})]})});He.displayName="HeroSlide";const ct=()=>{const{t,i18n:a}=U(),n=Je(),{settings:m}=be(),{data:r,isLoading:p,refetch:l}=De(),[x,i]=o.useState(0),[c,g]=o.useState(null),d=o.useRef(null),[b,v]=o.useState(!1),[j,y]=o.useState(!1),R=Te(),{isWebView:C}=xs(),F=R||C,L=m?.ai_assistant_enabled!==!1,B=o.useCallback(()=>{v(!0)},[]);vs({pageType:"home"});const k=o.useCallback(async()=>{try{const h=await(await fetch("https://v.xiaoxiong.pt/api/get_info")).json();h&&g({order_count:h.order_count||0,reserve_count:h.reserve_count||0})}catch(w){console.error("Failed to fetch stats:",w)}},[]);o.useEffect(()=>{k()},[k]);const V=o.useCallback(async()=>{n.removeQueries({queryKey:["homepage-templates"]}),n.removeQueries({queryKey:["restaurants"]}),n.removeQueries({queryKey:["activities"]}),n.removeQueries({queryKey:["recent-activities"]}),await Promise.all([l(),k(),n.invalidateQueries({queryKey:["restaurants"]}),n.invalidateQueries({queryKey:["activities"]}),n.invalidateQueries({queryKey:["recent-activities"]})])},[l,k,n]);o.useEffect(()=>{if(!r||r.length<=1)return;const h=r[x]?.duration||5e3;return d.current=setTimeout(()=>{i(P=>(P+1)%r.length)},h),()=>{d.current&&clearTimeout(d.current)}},[r,x]);const A=o.useCallback(w=>{d.current&&clearTimeout(d.current),i(w)},[]);o.useCallback(()=>{r&&(d.current&&clearTimeout(d.current),i(w=>(w-1+r.length)%r.length))},[r]),o.useCallback(()=>{r&&(d.current&&clearTimeout(d.current),i(w=>(w+1)%r.length))},[r]);const M=a.language,I=r&&r.length>1;return e.jsx(Ns,{onRefresh:V,children:e.jsxs("div",{className:"min-h-screen",children:[F?e.jsx(Ie,{stats:c,onAskXiaoxiong:()=>y(!0)}):e.jsxs("section",{className:"relative h-screen flex items-start overflow-hidden bg-background",children:[c&&e.jsx(qe,{stats:c,t}),e.jsx("div",{className:$("absolute inset-0 w-full h-full transition-opacity duration-500",b?"opacity-100":"opacity-0"),children:r?.map((w,h)=>e.jsx(He,{template:w,isActive:h===x,currentLang:M,t,onContentReady:h===0?B:void 0,onAskXiaoxiong:()=>y(!0)},w.id))}),e.jsx("div",{className:$("absolute inset-0 w-full h-full z-20 transition-opacity duration-500",p||!b?"opacity-100":"opacity-0 pointer-events-none"),children:e.jsx(hs,{})}),!p&&(!r||r.length===0)&&e.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[e.jsx("img",{src:Oe,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:"absolute inset-0 w-full h-full object-cover object-center sm:hidden"}),e.jsx("img",{src:fe,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:"absolute inset-0 w-full h-full object-cover object-center hidden sm:block"}),e.jsx("div",{className:"absolute inset-0 w-full h-full bg-gradient-to-b from-black/30 via-black/25 to-black/40"}),e.jsx("div",{className:"relative z-10 container mx-auto px-4 sm:px-6 flex items-center min-h-screen",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center space-y-4 sm:space-y-8 animate-fade-in w-full",children:[e.jsx("h1",{className:"text-3xl sm:text-5xl md:text-7xl font-bold text-white leading-tight px-4 drop-shadow-[0_2px_8px_rgba(0,0,0,0.8)]",children:t("home.hero.title")}),e.jsx("p",{className:"text-sm sm:text-xl md:text-2xl text-white/95 max-w-2xl mx-auto px-4 drop-shadow-[0_2px_6px_rgba(0,0,0,0.7)]",children:t("home.hero.description")})]})})]}),I&&e.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 z-30 flex gap-2",children:r.map((w,h)=>e.jsx("button",{onClick:()=>A(h),className:$("w-3 h-3 rounded-full transition-all duration-300",h===x?"bg-white w-8":"bg-white/50 hover:bg-white/70"),"aria-label":`Go to slide ${h+1}`},h))})]}),e.jsx(Pe,{}),e.jsx("section",{className:"py-12 sm:py-20 px-4 bg-secondary/20",children:e.jsx("div",{className:"container mx-auto max-w-7xl",children:e.jsx(Fs,{})})}),!Re()&&!Me()&&e.jsxs("section",{className:"py-16 sm:py-24 px-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 via-primary/3 to-primary/8",style:{maskImage:"radial-gradient(ellipse 80% 70% at 50% 50%, black 40%, transparent 100%)",WebkitMaskImage:"radial-gradient(ellipse 80% 70% at 50% 50%, black 40%, transparent 100%)"}}),e.jsx("div",{className:"absolute top-1/4 left-1/4 w-72 h-72 bg-primary/8 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-primary/5 rounded-full blur-3xl"}),e.jsx("div",{className:"container mx-auto max-w-5xl relative z-10",children:e.jsx("div",{className:"flex flex-col items-center justify-center gap-8",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-primary/10 text-primary text-sm font-medium px-4 py-2 rounded-full mb-4",children:[e.jsx(es,{className:"w-4 h-4"}),e.jsx("span",{children:"Mobile App"})]}),e.jsx("h3",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-foreground mb-4",children:t("home.app.title")}),e.jsx("p",{className:"text-base sm:text-lg text-muted-foreground mb-8 leading-relaxed",children:t("home.app.description")}),e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[e.jsxs("a",{href:"https://apps.apple.com/cn/app/xiaoxiong/id6755481369",target:"_blank",rel:"noopener noreferrer",className:"relative group",children:[e.jsx("div",{className:"absolute -inset-2 bg-gradient-to-r from-primary via-primary-glow to-primary rounded-2xl blur-lg opacity-40 group-hover:opacity-70 transition-opacity"}),e.jsx("div",{className:"relative bg-black hover:bg-gray-900 h-[52px] sm:h-[56px] w-[160px] sm:w-[180px] rounded-xl transition-all hover:scale-105 shadow-2xl hover:shadow-primary/30 border border-white/10 flex items-center justify-center",children:e.jsx("img",{src:bs,alt:"Download on the App Store",className:"h-8 sm:h-9"})})]}),e.jsxs("a",{href:"https://play.google.com/store/apps/details?id=com.xiaoxiong.market",target:"_blank",rel:"noopener noreferrer",className:"relative group",children:[e.jsx("div",{className:"absolute -inset-2 bg-gradient-to-r from-primary via-primary-glow to-primary rounded-2xl blur-lg opacity-40 group-hover:opacity-70 transition-opacity"}),e.jsx("div",{className:"relative bg-black hover:bg-gray-900 h-[52px] sm:h-[56px] w-[160px] sm:w-[180px] rounded-xl transition-all hover:scale-105 shadow-2xl hover:shadow-primary/30 border border-white/10 flex items-center justify-center",children:e.jsx("img",{src:ys,alt:"Get it on Google Play",className:"h-12 sm:h-14"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(ss,{className:"w-4 h-4 animate-bounce"}),e.jsx("span",{children:t("home.app.downloadNow")})]})]})]})})})]}),e.jsxs("section",{className:"py-16 sm:py-20 px-4 bg-gradient-to-r from-primary/90 to-primary relative overflow-hidden rounded-3xl mx-4 sm:mx-8 lg:mx-16 mb-8",children:[e.jsx("div",{className:"absolute inset-0 bg-grid-pattern opacity-10"}),e.jsx("div",{className:"absolute top-0 right-0 w-64 sm:w-96 h-64 sm:h-96 bg-white/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-64 sm:w-96 h-64 sm:h-96 bg-white/10 rounded-full blur-3xl"}),e.jsxs("div",{className:"container mx-auto max-w-4xl text-center relative z-10",children:[e.jsx("h2",{className:"text-3xl sm:text-4xl md:text-5xl font-bold text-primary-foreground mb-4 sm:mb-6 px-4",children:t("home.cta.title")}),e.jsx("p",{className:"text-base sm:text-xl text-primary-foreground/90 mb-6 sm:mb-8 max-w-2xl mx-auto px-4",children:t("home.cta.description")}),e.jsx("div",{className:"flex justify-center",children:e.jsx(E,{size:"lg",variant:"secondary",asChild:!0,className:"text-base sm:text-lg shadow-xl hover:shadow-2xl",children:e.jsxs(Ce,{to:"/join-us",children:[e.jsx(ts,{className:"mr-2 w-4 sm:w-5 h-4 sm:h-5"}),t("home.cta.button")]})})})]})]}),L&&e.jsx(Is,{open:j,onOpenChange:y})]})})};export{ct as default};
//# sourceMappingURL=Home-D6MiBc5v.js.map
