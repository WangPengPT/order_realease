{"version":3,"file":"Activities-9_mvPR86.js","sources":["../../src/components/skeletons/ActivityListSkeleton.tsx","../../src/components/ActivityFavoriteButton.tsx","../../src/pages/Activities.tsx"],"sourcesContent":["import { Skeleton } from \"@/components/ui/skeleton\";\r\n\r\ninterface ActivityListSkeletonProps {\r\n  count?: number;\r\n}\r\n\r\nconst ActivityListSkeleton = ({ count = 4 }: ActivityListSkeletonProps) => {\r\n  return (\r\n    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6\">\r\n      {Array.from({ length: count }).map((_, i) => (\r\n        <div key={i} className=\"rounded-lg border border-border overflow-hidden bg-card\">\r\n          {/* Image skeleton with badge */}\r\n          <div className=\"relative\">\r\n            <Skeleton className=\"w-full h-48 sm:h-56 rounded-none\" />\r\n            <Skeleton className=\"absolute top-3 left-3 h-6 w-20 rounded-full\" />\r\n          </div>\r\n          \r\n          {/* Content */}\r\n          <div className=\"p-4 sm:p-5\">\r\n            {/* Title */}\r\n            <Skeleton className=\"h-7 w-3/4 mb-2\" />\r\n            \r\n            {/* Date range */}\r\n            <Skeleton className=\"h-4 w-48 mb-3\" />\r\n            \r\n            {/* Description */}\r\n            <Skeleton className=\"h-4 w-full mb-1\" />\r\n            <Skeleton className=\"h-4 w-5/6 mb-4\" />\r\n            \r\n            {/* Stats row */}\r\n            <div className=\"flex items-center gap-4 mb-4\">\r\n              <Skeleton className=\"h-5 w-24\" />\r\n              <Skeleton className=\"h-5 w-20\" />\r\n            </div>\r\n            \r\n            {/* Actions */}\r\n            <div className=\"flex gap-2\">\r\n              <Skeleton className=\"h-9 flex-1 rounded-md\" />\r\n              <Skeleton className=\"h-9 w-9 rounded-md\" />\r\n              <Skeleton className=\"h-9 w-9 rounded-md\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ActivityListSkeleton;\r\n","import { useState, useEffect } from \"react\";\r\nimport { Heart } from \"lucide-react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { useAuth } from \"@/contexts/AuthContext\";\r\nimport { useToast } from \"@/hooks/use-toast\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport i18n from \"@/i18n/config\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\ninterface ActivityFavoriteButtonProps {\r\n  activityId: string;\r\n  initialSubscribed?: boolean;\r\n}\r\n\r\nexport const ActivityFavoriteButton = ({ \r\n  activityId, \r\n  initialSubscribed = false \r\n}: ActivityFavoriteButtonProps) => {\r\n  const { t } = useTranslation();\r\n  const { user } = useAuth();\r\n  const { toast } = useToast();\r\n  const [isSubscribed, setIsSubscribed] = useState(initialSubscribed);\r\n  const [isPending, setIsPending] = useState(false);\r\n\r\n  // Sync with initial value when it changes\r\n  useEffect(() => {\r\n    setIsSubscribed(initialSubscribed);\r\n  }, [initialSubscribed]);\r\n\r\n  const handleToggle = async (e: React.MouseEvent) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n\r\n    if (!user) {\r\n      toast({\r\n        title: t(\"activities.signInToSubscribe\") || \"请先登录\",\r\n        description: t(\"activities.signInToSubscribeDesc\") || \"您需要登录才能订阅活动\",\r\n        variant: \"destructive\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    setIsPending(true);\r\n    \r\n    // Optimistic update\r\n    const wasSubscribed = isSubscribed;\r\n    setIsSubscribed(!wasSubscribed);\r\n\r\n    try {\r\n      if (wasSubscribed) {\r\n        const { error } = await supabase\r\n          .from(\"subscriptions\")\r\n          .delete()\r\n          .eq(\"activity_id\", activityId)\r\n          .eq(\"user_id\", user.id);\r\n\r\n        if (error) throw error;\r\n        \r\n        toast({\r\n          title: i18n.t(\"toast.unsubscribed\"),\r\n          description: i18n.t(\"toast.unsubscribedDesc\"),\r\n        });\r\n      } else {\r\n        const { error } = await supabase\r\n          .from(\"subscriptions\")\r\n          .insert({\r\n            activity_id: activityId,\r\n            user_id: user.id,\r\n          });\r\n\r\n        if (error) throw error;\r\n        \r\n        toast({\r\n          title: i18n.t(\"toast.subscribed\"),\r\n          description: i18n.t(\"toast.subscribedDesc\"),\r\n        });\r\n      }\r\n    } catch (error) {\r\n      // Rollback on error\r\n      setIsSubscribed(wasSubscribed);\r\n      toast({\r\n        title: i18n.t(\"common.error\"),\r\n        description: i18n.t(\"toast.subscriptionFailed\"),\r\n        variant: \"destructive\",\r\n      });\r\n    } finally {\r\n      setIsPending(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Button\r\n      variant={isSubscribed ? \"default\" : \"outline\"}\r\n      size=\"icon\"\r\n      onClick={handleToggle}\r\n      disabled={isPending}\r\n      title={isSubscribed ? t(\"activities.favorited\") : t(\"activities.favorite\")}\r\n      className=\"transition-all duration-200\"\r\n    >\r\n      <Heart \r\n        className={`w-4 h-4 transition-all duration-200 ${\r\n          isSubscribed ? \"fill-current\" : \"\"\r\n        }`} \r\n      />\r\n    </Button>\r\n  );\r\n};\r\n","import { useCallback, useState } from \"react\";\r\nimport { Card, CardContent, CardFooter, CardHeader } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\r\nimport { Calendar, Clock, Users, UtensilsCrossed, ShoppingBag, UserCircle, Forward, List, LayoutGrid } from \"lucide-react\";\r\nimport { Link, useNavigate } from \"react-router-dom\";\r\nimport { useActivities, useSubscriptions, ActivityCreator } from \"@/hooks/useActivities\";\r\nimport { useActivitiesListRealtime } from \"@/hooks/useActivityRealtime\";\r\nimport { useAuth } from \"@/contexts/AuthContext\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useLocalizedContent } from \"@/hooks/useLocalizedContent\";\r\nimport { format } from \"date-fns\";\r\nimport { useInfiniteScroll } from \"@/hooks/useInfiniteScroll\";\r\nimport i18n from \"@/i18n/config\";\r\nimport platformLogo from \"@/assets/xiaoxiong-logo-v3.png\";\r\nimport { ActivityListSkeleton } from \"@/components/skeletons\";\r\nimport { ActivityFavoriteButton } from \"@/components/ActivityFavoriteButton\";\r\nimport { PullToRefresh } from \"@/components/PullToRefresh\";\r\nimport { useQueryClient } from \"@tanstack/react-query\";\r\nimport { useIsMobile } from \"@/hooks/use-mobile\";\r\n\r\n\r\nconst getLocalizedRestaurantName = (restaurant: ActivityCreator[\"restaurant\"]) => {\r\n  if (!restaurant) return \"\";\r\n  const lang = i18n.language;\r\n  if (lang === \"zh\") return restaurant.name;\r\n  if (lang === \"pt\") return restaurant.name_pt || restaurant.name_en || restaurant.name;\r\n  return restaurant.name_en || restaurant.name;\r\n};\r\n\r\nconst Activities = () => {\r\n  const { t } = useTranslation();\r\n  const { user } = useAuth();\r\n  const { localizeActivity } = useLocalizedContent();\r\n  const navigate = useNavigate();\r\n  const queryClient = useQueryClient();\r\n  const isMobile = useIsMobile();\r\n\r\n  // Mobile layout state: 1 or 2 columns\r\n  const [mobileColumns, setMobileColumns] = useState<1 | 2>(() => {\r\n    const saved = localStorage.getItem('activity-mobile-columns');\r\n    return (saved === '2' ? 2 : 1) as 1 | 2;\r\n  });\r\n\r\n  const toggleMobileColumns = () => {\r\n    const newColumns = mobileColumns === 1 ? 2 : 1;\r\n    setMobileColumns(newColumns);\r\n    localStorage.setItem('activity-mobile-columns', String(newColumns));\r\n  };\r\n\r\n  // Enable realtime updates for activities list\r\n  useActivitiesListRealtime();\r\n\r\n  const { data: activitiesData, isLoading } = useActivities();\r\n  const { data: subscriptions = [] } = useSubscriptions();\r\n  const subscribedIds = subscriptions.map(sub => sub.activity_id);\r\n\r\n  // Filter to only show published activities (draft activities should never show to frontend users)\r\n  const activities = activitiesData?.filter(activity => \r\n    activity.status === \"published\" && activity.visible === true\r\n  );\r\n\r\n  // Infinite scroll for activities\r\n  const { displayedData: displayedActivities, hasMore, loadMore } = useInfiniteScroll({\r\n    data: activities,\r\n    initialItemsPerPage: 6,\r\n    incrementPerPage: 6,\r\n  });\r\n\r\n  // Pull-to-refresh handler - clears cache and forces fresh data\r\n  const handleRefresh = useCallback(async () => {\r\n    // Clear caches first to ensure fresh data\r\n    queryClient.removeQueries({ queryKey: ['activities'] });\r\n    queryClient.removeQueries({ queryKey: ['subscriptions'] });\r\n    \r\n    // Refetch with fresh data\r\n    await Promise.all([\r\n      queryClient.invalidateQueries({ queryKey: ['activities'] }),\r\n      queryClient.invalidateQueries({ queryKey: ['subscriptions'] }),\r\n    ]);\r\n  }, [queryClient]);\r\n\r\n  return (\r\n    <PullToRefresh onRefresh={handleRefresh}>\r\n      <div className=\"min-h-screen bg-secondary/20 py-8 px-4 animate-fade-in\">\r\n        <div className=\"container mx-auto max-w-7xl\">\r\n          {/* Header */}\r\n        <div className=\"mb-8\">\r\n          <div className=\"flex items-center justify-between mb-2\">\r\n            <h1 className=\"text-3xl sm:text-4xl font-medium text-primary\">\r\n              {t(\"activities.title\")}\r\n            </h1>\r\n            {/* Mobile layout toggle - only show on mobile */}\r\n            {isMobile && (\r\n              <div className=\"inline-flex h-9 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\">\r\n                <button \r\n                  onClick={toggleMobileColumns}\r\n                  title={mobileColumns === 1 \r\n                    ? t(\"activities.doubleColumn\", \"双列布局\") \r\n                    : t(\"activities.singleColumn\", \"单列布局\")}\r\n                  className=\"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-2.5 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 bg-background text-foreground shadow-sm\"\r\n                >\r\n                  {mobileColumns === 1 ? (\r\n                    <LayoutGrid className=\"h-3.5 w-3.5\" />\r\n                  ) : (\r\n                    <List className=\"h-3.5 w-3.5\" />\r\n                  )}\r\n                </button>\r\n              </div>\r\n            )}\r\n          </div>\r\n          <p className=\"text-muted-foreground text-base sm:text-lg\">{t(\"activities.description\")}</p>\r\n        </div>\r\n\r\n        {/* Loading State */}\r\n        {isLoading && (\r\n          <ActivityListSkeleton count={4} />\r\n        )}\r\n\r\n        {/* Empty State */}\r\n        {!isLoading && (!activities || activities.length === 0) && (\r\n          <div className=\"text-center py-20\">\r\n            <p className=\"text-xl text-muted-foreground\">\r\n              {t(\"activities.noActivities\") || \"No activities available\"}\r\n            </p>\r\n          </div>\r\n        )}\r\n\r\n        {/* Activities Grid */}\r\n        {!isLoading && activities && activities.length > 0 && (\r\n          <>\r\n            <div className={`grid gap-6 ${mobileColumns === 2 ? 'grid-cols-2' : 'grid-cols-1'} md:grid-cols-2`}>\r\n            {displayedActivities.map((activity) => {\r\n              const localizedActivity = localizeActivity(activity);\r\n              // Compact mode: mobile + 2 columns\r\n              const isCompactMode = isMobile && mobileColumns === 2;\r\n              \r\n              return (\r\n                <Card key={activity.id} className={`overflow-hidden hover:shadow-large transition-shadow flex flex-col h-full ${isCompactMode ? 'gap-0' : ''}`}>\r\n                  <Link to={`/activity/${activity.id}`} className=\"flex flex-col h-full\">\r\n                    <div className={`relative overflow-hidden ${isCompactMode ? 'h-28' : 'h-48'}`}>\r\n                      {activity.media_type === \"video\" && activity.video_url ? (\r\n                        <video\r\n                          src={activity.video_url}\r\n                          poster={activity.image_url || undefined}\r\n                          className=\"w-full h-full object-cover transition-transform hover:scale-105\"\r\n                          muted\r\n                          loop\r\n                          playsInline\r\n                          autoPlay\r\n                        />\r\n                      ) : (\r\n                        <img\r\n                          src={activity.image_url || \"https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=600&q=80\"}\r\n                          alt={localizedActivity.title}\r\n                          className=\"w-full h-full object-cover transition-transform hover:scale-105\"\r\n                        />\r\n                      )}\r\n                      {activity.pinned && (\r\n                        <Badge className={`absolute ${isCompactMode ? 'top-1.5 left-1.5 text-[10px] px-1.5 py-0' : 'top-3 left-3'} bg-accent`}>\r\n                          {t(\"activities.pinned\")}\r\n                        </Badge>\r\n                      )}\r\n                      {/* Service Type Badge - hide in compact mode */}\r\n                      {!isCompactMode && activity.service_type && (\r\n                        <Badge \r\n                          className=\"absolute bottom-3 left-3 flex items-center gap-1\"\r\n                          variant=\"secondary\"\r\n                        >\r\n                          {activity.service_type === \"dine_in\" && <UtensilsCrossed className=\"w-3 h-3\" />}\r\n                          {activity.service_type === \"takeaway\" && <ShoppingBag className=\"w-3 h-3\" />}\r\n                          {activity.service_type === \"both\" && (\r\n                            <>\r\n                              <UtensilsCrossed className=\"w-3 h-3\" />\r\n                              <ShoppingBag className=\"w-3 h-3\" />\r\n                            </>\r\n                          )}\r\n                          {t(`activities.serviceType.${activity.service_type}`)}\r\n                        </Badge>\r\n                      )}\r\n                      {activity.end_date && new Date(activity.end_date) < new Date() ? (\r\n                        <Badge className={`absolute ${isCompactMode ? 'top-1.5 right-1.5 text-[10px] px-1.5 py-0' : 'top-3 right-3'} bg-secondary`}>\r\n                          {t(\"activities.ended\")}\r\n                        </Badge>\r\n                      ) : (\r\n                        <div className={`absolute ${isCompactMode ? 'top-1.5 right-1.5' : 'top-3 right-3'} flex gap-1`}>\r\n                          {activity.subscriber_count !== undefined && (\r\n                            <Badge variant=\"secondary\" className={`flex items-center gap-0.5 ${isCompactMode ? 'text-[10px] px-1 py-0' : 'gap-1'}`}>\r\n                              <Users className={isCompactMode ? 'w-2.5 h-2.5' : 'w-3 h-3'} />\r\n                              <span>{activity.subscriber_count}</span>\r\n                            </Badge>\r\n                          )}\r\n                          {!isCompactMode && activity.share_count !== undefined && activity.share_count > 0 && (\r\n                            <Badge variant=\"secondary\" className=\"flex items-center gap-1\">\r\n                              <Forward className=\"w-3 h-3\" />\r\n                              <span>{activity.share_count}</span>\r\n                            </Badge>\r\n                          )}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n\r\n                    <CardHeader className={isCompactMode ? 'p-2 pb-1' : ''}>\r\n                      <h3 className={`font-semibold text-card-foreground line-clamp-2 ${isCompactMode ? 'text-sm' : 'text-xl'}`}>\r\n                        {localizedActivity.title}\r\n                      </h3>\r\n                    </CardHeader>\r\n\r\n                    <CardContent className={`flex-1 ${isCompactMode ? 'p-2 pt-0 space-y-1' : 'space-y-3'}`}>\r\n                      {/* Content - hide in compact mode */}\r\n                      {!isCompactMode && (\r\n                        <div \r\n                          className=\"text-muted-foreground text-sm line-clamp-3\r\n                            [&_h1]:text-base [&_h1]:font-bold [&_h1]:text-foreground\r\n                            [&_h2]:text-sm [&_h2]:font-semibold [&_h2]:text-foreground\r\n                            [&_h3]:text-sm [&_h3]:font-medium [&_h3]:text-foreground\r\n                            [&_strong]:font-semibold [&_strong]:text-foreground\r\n                            [&_p]:my-1\r\n                            [&_ul]:list-disc [&_ul]:ml-4\r\n                            [&_ol]:list-decimal [&_ol]:ml-4\r\n                            [&_*]:!text-inherit\"\r\n                          dangerouslySetInnerHTML={{ __html: localizedActivity.content }}\r\n                        />\r\n                      )}\r\n                      \r\n                      {activity.start_date && (\r\n                        <div className={`flex items-center gap-1 text-muted-foreground ${isCompactMode ? 'text-xs' : 'gap-2 text-sm'}`}>\r\n                          <Calendar className={isCompactMode ? 'w-3 h-3' : 'w-4 h-4'} />\r\n                          <span>{format(new Date(activity.start_date), isCompactMode ? \"MM/dd\" : \"PPP\")}</span>\r\n                        </div>\r\n                      )}\r\n\r\n                      {/* End date - hide in compact mode */}\r\n                      {!isCompactMode && activity.end_date && (\r\n                        <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n                          <Clock className=\"w-4 h-4\" />\r\n                          <span>{t(\"activities.until\")} {format(new Date(activity.end_date), \"PPP\")}</span>\r\n                        </div>\r\n                      )}\r\n\r\n                      {/* Creator Info - hide in compact mode */}\r\n                      {!isCompactMode && (\r\n                        <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n                          <UserCircle className=\"w-4 h-4\" />\r\n                          <span>{t(\"activities.creatorLabel\")}</span>\r\n                          {activity.creator?.isAdmin ? (\r\n                            <div className=\"flex items-center gap-1\">\r\n                              <img src={platformLogo} alt=\"Platform\" className=\"w-4 h-4 rounded-full object-contain\" />\r\n                              <span className=\"font-medium\">{t(\"activities.createdByPlatform\")}</span>\r\n                            </div>\r\n                          ) : activity.creator?.restaurant ? (\r\n                            <div \r\n                              className=\"flex items-center gap-1 cursor-pointer\"\r\n                              onClick={(e) => {\r\n                                e.preventDefault();\r\n                                e.stopPropagation();\r\n                                navigate(`/restaurant/${activity.creator.restaurant!.id}`);\r\n                              }}\r\n                            >\r\n                              {activity.creator.avatar_url ? (\r\n                                <Avatar className=\"w-4 h-4\">\r\n                                  <AvatarImage src={activity.creator.avatar_url} alt=\"Creator\" />\r\n                                  <AvatarFallback className=\"text-[8px]\">\r\n                                    {activity.creator.restaurant.name.charAt(0)}\r\n                                  </AvatarFallback>\r\n                                </Avatar>\r\n                              ) : (\r\n                                <div className=\"w-4 h-4 rounded-full bg-muted flex items-center justify-center\">\r\n                                  <span className=\"text-[8px] font-medium\">\r\n                                    {activity.creator.restaurant.name.charAt(0)}\r\n                                  </span>\r\n                                </div>\r\n                              )}\r\n                              <span className=\"text-primary font-medium hover:underline\">\r\n                                {getLocalizedRestaurantName(activity.creator.restaurant)}\r\n                              </span>\r\n                            </div>\r\n                          ) : (\r\n                            <div className=\"flex items-center gap-1\">\r\n                              <img src={platformLogo} alt=\"Platform\" className=\"w-4 h-4 rounded-full object-contain\" />\r\n                              <span className=\"font-medium\">{t(\"activities.createdByPlatform\")}</span>\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                      )}\r\n                    </CardContent>\r\n\r\n                    <CardFooter className={`${isCompactMode ? 'p-2 pt-0' : 'gap-2'}`}>\r\n                      <Button asChild className={`flex-1 ${isCompactMode ? 'h-7 text-xs' : ''}`} size={isCompactMode ? 'sm' : 'default'}>\r\n                        <span>{t(\"activities.viewDetails\")}</span>\r\n                      </Button>\r\n                      {!isCompactMode && (\r\n                        <ActivityFavoriteButton \r\n                          activityId={activity.id}\r\n                          initialSubscribed={subscribedIds.includes(activity.id)}\r\n                        />\r\n                      )}\r\n                    </CardFooter>\r\n                  </Link>\r\n                </Card>\r\n              );\r\n            })}\r\n          </div>\r\n            \r\n            {/* Load More Button */}\r\n            {hasMore && (\r\n              <div className=\"flex justify-center mt-8\">\r\n                <Button onClick={loadMore} size=\"lg\" variant=\"outline\">\r\n                  {t(\"common.loadMore\")} ({displayedActivities.length} / {activities.length})\r\n                </Button>\r\n              </div>\r\n            )}\r\n          </>\r\n        )}\r\n      </div>\r\n    </div>\r\n    </PullToRefresh>\r\n  );\r\n};\r\n\r\nexport default Activities;\r\n"],"names":["ActivityListSkeleton","count","_","i","jsxs","jsx","Skeleton","ActivityFavoriteButton","activityId","initialSubscribed","t","useTranslation","user","useAuth","toast","useToast","isSubscribed","setIsSubscribed","useState","isPending","setIsPending","useEffect","handleToggle","e","wasSubscribed","error","supabase","i18n","Button","Heart","getLocalizedRestaurantName","restaurant","lang","Activities","localizeActivity","useLocalizedContent","navigate","useNavigate","queryClient","useQueryClient","isMobile","useIsMobile","mobileColumns","setMobileColumns","toggleMobileColumns","newColumns","useActivitiesListRealtime","activitiesData","isLoading","useActivities","subscriptions","useSubscriptions","subscribedIds","sub","activities","activity","displayedActivities","hasMore","loadMore","useInfiniteScroll","handleRefresh","useCallback","PullToRefresh","LayoutGrid","List","Fragment","localizedActivity","isCompactMode","Card","Link","Badge","UtensilsCrossed","ShoppingBag","Users","Forward","CardHeader","CardContent","Calendar","format","Clock","UserCircle","platformLogo","Avatar","AvatarImage","AvatarFallback","CardFooter"],"mappings":"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"}