import{p as z,r as d,j as e,X as T,bk as P,a4 as R,W as $}from"./vendor-react-87iFmKFJ.js";import{h as o}from"./index-CH4FpCej.js";import{P as I}from"./progress-Ud7m7MPX.js";import{T as U}from"./TranslateButton-n7ikl_oX.js";import{I as B}from"./ImagePreviewModal-BqCHox3o.js";const W=({steps:N,onExit:u,onComplete:c})=>{const{t:n,i18n:g}=z(),[a,p]=d.useState(0),[b,x]=d.useState({}),[h,f]=d.useState(null),i=[...N].sort((s,r)=>s.order-r.order),m=i.length,t=i[a],w=(a+1)/m*100,j=a===m-1,v=a===0,y=()=>{j||p(s=>s+1)},S=()=>{v||p(s=>s-1)},k=()=>{c?c():u()};return e.jsxs("div",{className:"flex flex-col h-full min-h-[60vh]",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b bg-background sticky top-0 z-10",children:[e.jsx(o,{variant:"ghost",size:"icon",onClick:u,children:e.jsx(T,{className:"h-5 w-5"})}),e.jsx("span",{className:"font-medium",children:n("recipe.stepProgress","步骤 {{current}} / {{total}}",{current:a+1,total:m})}),e.jsx(U,{text:i.map(s=>s.description).join(`
---
`),onTranslation:s=>{if(s){const r=s.split(`
---
`),l={};r.forEach((C,_)=>{l[_]=C}),x(l)}else x({})}})]}),e.jsx(I,{value:w,className:"h-1 rounded-none"}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[e.jsx("div",{className:"flex items-center justify-center mb-6",children:e.jsx("div",{className:"w-16 h-16 rounded-full bg-primary text-primary-foreground flex items-center justify-center text-2xl font-bold shadow-lg",children:t.order})}),(()=>{const s=t.image_urls&&t.image_urls.length>0?t.image_urls:t.image_url?[t.image_url]:[];return s.length>0&&e.jsx("div",{className:"mb-6 flex flex-wrap justify-center gap-2",children:s.map((r,l)=>e.jsx("img",{src:r,alt:`Step ${t.order} - ${l+1}`,className:`h-auto max-h-64 object-cover cursor-pointer rounded-xl ${s.length===1?"max-w-[75%]":"w-[calc(50%-0.25rem)]"}`,onClick:()=>f(r)},l))})})(),e.jsx("p",{className:"text-lg leading-relaxed text-center",children:b[a]||(g.language==="en"&&t.description_en?t.description_en:g.language==="pt"&&t.description_pt?t.description_pt:t.description)})]}),e.jsx("div",{className:"flex justify-center gap-1.5 py-3",children:i.map((s,r)=>e.jsx("button",{className:`w-2 h-2 rounded-full transition-all ${r===a?"bg-primary w-6":r<a?"bg-primary/50":"bg-muted-foreground/30"}`,onClick:()=>p(r)},r))}),e.jsxs("div",{className:"flex items-center justify-between p-4 border-t bg-background",children:[e.jsxs(o,{variant:"outline",size:"lg",onClick:S,disabled:v,className:"gap-2",children:[e.jsx(P,{className:"h-5 w-5"}),n("recipe.prevStep","上一步")]}),j?e.jsxs(o,{size:"lg",onClick:k,className:"gap-2",variant:"default",children:[e.jsx(R,{className:"h-5 w-5"}),c?n("recipe.completeCooking","完成烹饪"):n("recipe.complete","完成")]}):e.jsxs(o,{size:"lg",onClick:y,className:"gap-2",children:[n("recipe.nextStep","下一步"),e.jsx($,{className:"h-5 w-5"})]})]}),e.jsx(B,{imageUrl:h||"",isOpen:!!h,onClose:()=>f(null)})]})};export{W as R};
//# sourceMappingURL=RecipeCookingMode-Brf7h4xI.js.map
