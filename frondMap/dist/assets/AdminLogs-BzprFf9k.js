import{j as e}from"./vendor-ui-DAmPMpEA.js";import{r as c}from"./vendor-react-iAJ0IrSD.js";import{c as $,C as d,k as i,I as q,a6 as L,a7 as P,a8 as D,a9 as A,aa as m,S as v,U as K,B as Q,v as W,w as X,r as _}from"./index-Do1W_89N.js";import{T as Y,a as Z,b as w,c as j,d as ee,e as o}from"./table-Bc8sHo2y.js";import{t as se}from"./useAdmin-Cqjt-KAT.js";import{u as ae,P as re,a as te,b as k,c as le,d as de,f as ne}from"./usePagination-DzBUX65H.js";import{u as ce}from"./vendor-i18n-DxKeo2S1.js";import{F as y}from"./file-text-EiQL9V8p.js";import{S as ie}from"./search-DsePuv7P.js";import{F as me}from"./filter-CBzs1yBA.js";import{C as oe}from"./clock-C2dMhwrG.js";import{f as xe}from"./format-DMNSJgyu.js";import"./vendor-charts-Bz7hPIBd.js";import"./vendor-query-BlSVl3IQ.js";import"./vendor-supabase-KNAP0qdW.js";import"./chevron-left-BcmQFin1.js";import"./ellipsis-BlUeEC9G.js";import"./startOfDay-D6pD3B6q.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p=$("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),De=()=>{const{t:r}=ce(),{data:l,isLoading:I}=se(),[F,R]=c.useState(new Set),[x,M]=c.useState(""),[u,U]=c.useState("all"),[N,B]=c.useState("all"),V=c.useMemo(()=>l?[...new Set(l.map(t=>t.table_name))].sort():[],[l]),T=c.useMemo(()=>l?l.filter(s=>{const t=x===""||s.user_name?.toLowerCase().includes(x.toLowerCase())||s.table_name.toLowerCase().includes(x.toLowerCase()),a=u==="all"||s.action===u,g=N==="all"||s.table_name===N;return t&&a&&g}):[],[l,x,u,N]),{currentPage:n,totalPages:h,paginatedData:f,goToPage:b,canGoNext:E,canGoPrevious:S,startIndex:H,endIndex:z,totalItems:G}=ae({data:T,itemsPerPage:15}),J=s=>{R(t=>{const a=new Set(t);return a.has(s)?a.delete(s):a.add(s),a})},O=s=>({INSERT:{variant:"default",className:"bg-emerald-500/10 text-emerald-600 dark:text-emerald-400 border-emerald-500/20 hover:bg-emerald-500/20"},UPDATE:{variant:"secondary",className:"bg-amber-500/10 text-amber-600 dark:text-amber-400 border-amber-500/20 hover:bg-amber-500/20"},DELETE:{variant:"destructive",className:"bg-red-500/10 text-red-600 dark:text-red-400 border-red-500/20 hover:bg-red-500/20"}})[s]||{variant:"outline",className:""},C=s=>{if(!s)return null;try{return JSON.stringify(s,null,2)}catch{return String(s)}};return I?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),e.jsx("span",{className:"text-muted-foreground",children:r("common.loading")})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(y,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:r("admin.operationLogs")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r("admin.viewSystemLogs")})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(d,{className:"border-none shadow-sm bg-gradient-to-br from-emerald-500/5 to-emerald-500/10 dark:from-emerald-500/10 dark:to-emerald-500/20",children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-emerald-500/10 dark:bg-emerald-500/20",children:e.jsx(p,{className:"h-4 w-4 text-emerald-600 dark:text-emerald-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"INSERT"}),e.jsx("p",{className:"text-xl font-bold text-emerald-600 dark:text-emerald-400",children:l?.filter(s=>s.action==="INSERT").length||0})]})]})})}),e.jsx(d,{className:"border-none shadow-sm bg-gradient-to-br from-amber-500/5 to-amber-500/10 dark:from-amber-500/10 dark:to-amber-500/20",children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-amber-500/10 dark:bg-amber-500/20",children:e.jsx(p,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"UPDATE"}),e.jsx("p",{className:"text-xl font-bold text-amber-600 dark:text-amber-400",children:l?.filter(s=>s.action==="UPDATE").length||0})]})]})})}),e.jsx(d,{className:"border-none shadow-sm bg-gradient-to-br from-red-500/5 to-red-500/10 dark:from-red-500/10 dark:to-red-500/20",children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-red-500/10 dark:bg-red-500/20",children:e.jsx(p,{className:"h-4 w-4 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"DELETE"}),e.jsx("p",{className:"text-xl font-bold text-red-600 dark:text-red-400",children:l?.filter(s=>s.action==="DELETE").length||0})]})]})})}),e.jsx(d,{className:"border-none shadow-sm bg-gradient-to-br from-primary/5 to-primary/10",children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-primary/10",children:e.jsx(y,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:r("common.total")}),e.jsx("p",{className:"text-xl font-bold text-primary",children:l?.length||0})]})]})})})]}),e.jsx(d,{className:"border-none shadow-sm",children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ie,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(q,{placeholder:r("common.search"),value:x,onChange:s=>M(s.target.value),className:"pl-9"})]}),e.jsxs(L,{value:u,onValueChange:U,children:[e.jsxs(P,{className:"w-full sm:w-[140px]",children:[e.jsx(me,{className:"h-4 w-4 mr-2"}),e.jsx(D,{placeholder:r("admin.action")})]}),e.jsxs(A,{children:[e.jsx(m,{value:"all",children:r("common.all")}),e.jsx(m,{value:"INSERT",children:"INSERT"}),e.jsx(m,{value:"UPDATE",children:"UPDATE"}),e.jsx(m,{value:"DELETE",children:"DELETE"})]})]}),e.jsxs(L,{value:N,onValueChange:B,children:[e.jsxs(P,{className:"w-full sm:w-[180px]",children:[e.jsx(p,{className:"h-4 w-4 mr-2"}),e.jsx(D,{placeholder:r("admin.table")})]}),e.jsxs(A,{children:[e.jsx(m,{value:"all",children:r("common.all")}),V.map(s=>e.jsx(m,{value:s,children:s},s))]})]})]})})}),T.length>0&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:[r("common.showing")," ",H,"-",z," ",r("common.of")," ",G," ",r("common.results")]}),f&&f.length>0?e.jsx(d,{className:"border-none shadow-sm overflow-hidden",children:e.jsx(v,{className:"w-full",children:e.jsxs(Y,{children:[e.jsx(Z,{children:e.jsxs(w,{className:"bg-muted/30 hover:bg-muted/30",children:[e.jsx(j,{className:"w-[50px]"}),e.jsx(j,{className:"min-w-[120px]",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4"}),r("admin.user")]})}),e.jsx(j,{className:"min-w-[120px]",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-4 w-4"}),r("admin.table")]})}),e.jsx(j,{className:"min-w-[100px]",children:r("admin.action")}),e.jsx(j,{className:"min-w-[160px]",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-4 w-4"}),r("admin.time")]})})]})}),e.jsx(ee,{children:f.map(s=>{const t=F.has(s.id),a=s.old_data||s.new_data,g=O(s.action);return e.jsxs(e.Fragment,{children:[e.jsxs(w,{className:`cursor-pointer transition-colors ${a?"hover:bg-muted/50":""}`,onClick:()=>a&&J(s.id),children:[e.jsx(o,{className:"w-[50px]",children:a&&e.jsx(Q,{variant:"ghost",size:"icon",className:"h-6 w-6",children:t?e.jsx(W,{className:"h-4 w-4"}):e.jsx(X,{className:"h-4 w-4"})})}),e.jsx(o,{children:e.jsx("span",{className:"font-medium",children:s.user_name||"-"})}),e.jsx(o,{children:e.jsx(_,{variant:"outline",className:"font-mono text-xs",children:s.table_name})}),e.jsx(o,{children:e.jsx(_,{variant:g.variant,className:g.className,children:s.action})}),e.jsx(o,{className:"text-muted-foreground text-sm",children:xe(new Date(s.created_at),"yyyy-MM-dd HH:mm:ss")})]},s.id),t&&a&&e.jsx(w,{children:e.jsx(o,{colSpan:5,className:"bg-muted/20 p-0",children:e.jsx("div",{className:"p-4 space-y-4",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[s.old_data&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-red-500 dark:bg-red-400"}),e.jsx("span",{className:"font-semibold text-sm text-red-600 dark:text-red-400",children:r("admin.oldData")})]}),e.jsx(v,{className:"h-[200px] rounded-lg border border-red-500/20 dark:border-red-400/30 bg-red-500/5 dark:bg-red-500/10",children:e.jsx("pre",{className:"p-3 text-xs font-mono whitespace-pre-wrap break-all text-foreground",children:C(s.old_data)})})]}),s.new_data&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-emerald-500 dark:bg-emerald-400"}),e.jsx("span",{className:"font-semibold text-sm text-emerald-600 dark:text-emerald-400",children:r("admin.newData")})]}),e.jsx(v,{className:"h-[200px] rounded-lg border border-emerald-500/20 dark:border-emerald-400/30 bg-emerald-500/5 dark:bg-emerald-500/10",children:e.jsx("pre",{className:"p-3 text-xs font-mono whitespace-pre-wrap break-all text-foreground",children:C(s.new_data)})})]})]})})})},`${s.id}-expanded`)]})})})]})})}):e.jsx(d,{className:"border-none shadow-sm",children:e.jsx(i,{className:"py-16 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"p-4 rounded-full bg-muted",children:e.jsx(y,{className:"h-8 w-8 text-muted-foreground"})}),e.jsx("p",{className:"text-muted-foreground",children:r("admin.noLogs")})]})})}),h>1&&e.jsx(re,{children:e.jsxs(te,{children:[e.jsx(k,{children:e.jsx(le,{onClick:()=>S&&b(n-1),className:S?"cursor-pointer":"pointer-events-none opacity-50"})}),Array.from({length:Math.min(5,h)},(s,t)=>{let a;return h<=5||n<=3?a=t+1:n>=h-2?a=h-4+t:a=n-2+t,e.jsx(k,{children:e.jsx(de,{onClick:()=>b(a),isActive:n===a,className:"cursor-pointer",children:a})},a)}),e.jsx(k,{children:e.jsx(ne,{onClick:()=>E&&b(n+1),className:E?"cursor-pointer":"pointer-events-none opacity-50"})})]})})]})};export{De as default};
//# sourceMappingURL=AdminLogs-BzprFf9k.js.map
