{"version":3,"file":"AdminAIConfigList-BHHAnito.js","sources":["../../src/pages/admin/AdminAIConfigList.tsx"],"sourcesContent":["import { useTranslation } from \"react-i18next\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Bot, Settings, ChevronRight, CheckCircle, XCircle, AlertCircle, Sparkles, Play } from \"lucide-react\";\r\nimport { useState, useEffect } from \"react\";\r\nimport { Skeleton } from \"@/components/ui/skeleton\";\r\nimport { LovableAIDemoDialog } from \"@/components/admin/LovableAIDemoDialog\";\r\n\r\ninterface ModelConfig {\r\n  name: string;\r\n  baseURL: string;\r\n}\r\n\r\nconst SUPABASE_URL = import.meta.env.VITE_SUPABASE_URL;\r\nconst SUPABASE_KEY = import.meta.env.VITE_SUPABASE_PUBLISHABLE_KEY;\r\n\r\ninterface AIProviderConfig {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  icon: React.ElementType;\r\n  iconColor: string;\r\n  configurable: boolean;\r\n  configPath?: string;\r\n  status?: 'configured' | 'not-configured' | 'no-config-needed';\r\n  modelName?: string;\r\n  hasDemo?: boolean;\r\n  recommended?: boolean;\r\n}\r\n\r\nconst AdminAIConfigList = () => {\r\n  const { t } = useTranslation();\r\n  const [agentModelConfig, setAgentModelConfig] = useState<ModelConfig | null>(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [lovableAIDemoOpen, setLovableAIDemoOpen] = useState(false);\r\n\r\n  // Fetch agent model config to show status\r\n  useEffect(() => {\r\n    const fetchAgentConfig = async () => {\r\n      try {\r\n        const response = await fetch(\r\n          `${SUPABASE_URL}/functions/v1/xiaoxiong-agent-model?type=main&endpoint=model`,\r\n          {\r\n            method: 'GET',\r\n            headers: {\r\n              'Authorization': `Bearer ${SUPABASE_KEY}`,\r\n              'Content-Type': 'application/json',\r\n            },\r\n          }\r\n        );\r\n\r\n        if (response.ok) {\r\n          const result = await response.json();\r\n          if (result?.success && result?.data) {\r\n            setAgentModelConfig(result.data);\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Failed to fetch agent config:\", error);\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchAgentConfig();\r\n  }, []);\r\n\r\n  const aiProviders: AIProviderConfig[] = [\r\n    {\r\n      id: 'lovable-ai',\r\n      name: 'Lovable AI',\r\n      description: '智能餐厅推荐助手，支持餐厅知识库和位置感知',\r\n      icon: Sparkles,\r\n      iconColor: \"text-purple-500\",\r\n      configurable: true,\r\n      configPath: '/admin/ai-config/lovable-ai',\r\n      status: 'configured',\r\n      hasDemo: true,\r\n      recommended: true,\r\n    },\r\n    {\r\n      id: 'ask-xiaoxiong',\r\n      name: t(\"admin.aiSettings.providers.askXiaoxiong\", \"小熊AI\"),\r\n      description: t(\"admin.aiSettings.providers.askXiaoxiongDesc\", \"原有AI接口，直接问答\"),\r\n      icon: Bot,\r\n      iconColor: \"text-primary\",\r\n      configurable: false,\r\n      status: 'no-config-needed',\r\n    },\r\n    {\r\n      id: 'xiaoxiong-agent',\r\n      name: t(\"admin.aiSettings.providers.xiaoxiongAgent\", \"小熊Agent\"),\r\n      description: t(\"admin.aiSettings.providers.xiaoxiongAgentDesc\", \"新AI接口，支持模型配置\"),\r\n      icon: Settings,\r\n      iconColor: \"text-orange-500\",\r\n      configurable: true,\r\n      configPath: '/admin/ai-config/xiaoxiong-agent',\r\n      status: agentModelConfig?.name ? 'configured' : 'not-configured',\r\n      modelName: agentModelConfig?.name,\r\n      hasDemo: true,\r\n    },\r\n  ];\r\n\r\n  const getStatusBadge = (provider: AIProviderConfig) => {\r\n    if (provider.status === 'no-config-needed') {\r\n      return (\r\n        <Badge variant=\"secondary\" className=\"text-xs\">\r\n          <CheckCircle className=\"h-3 w-3 mr-1\" />\r\n          无需配置\r\n        </Badge>\r\n      );\r\n    }\r\n    if (provider.status === 'configured') {\r\n      return (\r\n        <Badge variant=\"default\" className=\"text-xs bg-green-500\">\r\n          <CheckCircle className=\"h-3 w-3 mr-1\" />\r\n          已配置\r\n        </Badge>\r\n      );\r\n    }\r\n    return (\r\n      <Badge variant=\"outline\" className=\"text-xs text-orange-500 border-orange-500\">\r\n        <AlertCircle className=\"h-3 w-3 mr-1\" />\r\n        待配置\r\n      </Badge>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-6 max-w-4xl mx-auto\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center gap-3\">\r\n        <Settings className=\"h-8 w-8 text-primary\" />\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold\">{t(\"admin.aiConfig.title\", \"AI配置管理\")}</h1>\r\n          <p className=\"text-muted-foreground\">\r\n            {t(\"admin.aiConfig.subtitle\", \"管理和配置各个AI服务的模型和参数\")}\r\n          </p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* AI Providers List */}\r\n      <div className=\"grid grid-cols-1 gap-4\">\r\n        {isLoading ? (\r\n          <>\r\n            <Skeleton className=\"h-32 w-full\" />\r\n            <Skeleton className=\"h-32 w-full\" />\r\n          </>\r\n        ) : (\r\n          aiProviders.map((provider) => (\r\n            <Card \r\n              key={provider.id} \r\n              className={`transition-all ${provider.configurable ? 'hover:border-primary/50 cursor-pointer' : ''}`}\r\n            >\r\n              <CardHeader className=\"pb-3\">\r\n                  <div className=\"flex items-start justify-between\">\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <div className={`p-2 rounded-lg bg-muted ${provider.iconColor}`}>\r\n                      <provider.icon className=\"h-6 w-6\" />\r\n                    </div>\r\n                    <div>\r\n                      <CardTitle className=\"text-lg flex items-center gap-2\">\r\n                        {provider.name}\r\n                        {provider.recommended && (\r\n                          <Badge className=\"text-xs bg-purple-500\">推荐</Badge>\r\n                        )}\r\n                        {getStatusBadge(provider)}\r\n                      </CardTitle>\r\n                      <CardDescription className=\"mt-1\">\r\n                        {provider.description}\r\n                      </CardDescription>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  <div className=\"flex items-center gap-2\">\r\n                    {provider.hasDemo && (\r\n                      <Button \r\n                        variant=\"outline\" \r\n                        size=\"sm\"\r\n                        onClick={() => {\r\n                          if (provider.id === 'lovable-ai') {\r\n                            setLovableAIDemoOpen(true);\r\n                          } else if (provider.id === 'xiaoxiong-agent' && provider.configPath) {\r\n                            // 跳转到配置页面进行测试\r\n                            window.location.href = provider.configPath;\r\n                          }\r\n                        }}\r\n                      >\r\n                        <Play className=\"h-4 w-4 mr-1\" />\r\n                        测试\r\n                      </Button>\r\n                    )}\r\n                    {provider.configurable && provider.configPath && (\r\n                      <Button variant=\"outline\" size=\"sm\" asChild>\r\n                        <Link to={provider.configPath}>\r\n                          配置\r\n                          <ChevronRight className=\"h-4 w-4 ml-1\" />\r\n                        </Link>\r\n                      </Button>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </CardHeader>\r\n              \r\n              {provider.configurable && (\r\n                <CardContent className=\"pt-0\">\r\n                  <div className=\"bg-muted/30 rounded-lg p-3 text-sm\">\r\n                    {provider.modelName ? (\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <span className=\"text-muted-foreground\">当前模型:</span>\r\n                        <code className=\"px-2 py-0.5 bg-background rounded text-xs font-mono\">\r\n                          {provider.modelName}\r\n                        </code>\r\n                      </div>\r\n                    ) : (\r\n                      <p className=\"text-muted-foreground\">\r\n                        尚未配置模型，点击右侧\"配置\"按钮进行设置\r\n                      </p>\r\n                    )}\r\n                  </div>\r\n                </CardContent>\r\n              )}\r\n            </Card>\r\n          ))\r\n        )}\r\n      </div>\r\n\r\n      {/* Quick Links */}\r\n      <Card className=\"bg-muted/30\">\r\n        <CardContent className=\"pt-6\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <p className=\"font-medium\">需要更改主页使用的AI接口？</p>\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                前往AI管理页面切换主页使用的AI服务提供商\r\n              </p>\r\n            </div>\r\n            <Button variant=\"outline\" size=\"sm\" asChild>\r\n              <Link to=\"/admin/ai-settings\">\r\n                前往AI管理\r\n                <ChevronRight className=\"h-4 w-4 ml-1\" />\r\n              </Link>\r\n            </Button>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Lovable AI Demo Dialog */}\r\n      <LovableAIDemoDialog \r\n        open={lovableAIDemoOpen} \r\n        onOpenChange={setLovableAIDemoOpen} \r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdminAIConfigList;\r\n"],"names":["SUPABASE_URL","SUPABASE_KEY","AdminAIConfigList","t","useTranslation","agentModelConfig","setAgentModelConfig","useState","isLoading","setIsLoading","lovableAIDemoOpen","setLovableAIDemoOpen","useEffect","response","result","error","aiProviders","Sparkles","Bot","Settings","getStatusBadge","provider","Badge","jsx","CheckCircle","AlertCircle","jsxs","Fragment","Skeleton","Card","CardHeader","CardTitle","CardDescription","Button","Play","Link","ChevronRight","CardContent","LovableAIDemoDialog"],"mappings":"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"}