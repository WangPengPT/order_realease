{"version":3,"file":"xiaoxiong-logo-clean-Tcc5zC8x.js","sources":["../../src/components/RestaurantMap.tsx","../../src/hooks/useActivityRestaurantCounts.ts","../../src/assets/xiaoxiong-logo-clean.png"],"sourcesContent":["import { useEffect, useRef, useState, useCallback } from \"react\";\r\nimport mapboxgl from \"mapbox-gl\";\r\nimport \"mapbox-gl/dist/mapbox-gl.css\";\r\nimport { Restaurant } from \"@/hooks/useRestaurants\";\r\nimport { calculateDistance } from \"@/lib/geolocation\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { isIOSDevice, isIOSWebView } from \"@/lib/externalLinks\";\r\nimport { AlertTriangle, MapPin } from \"lucide-react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport mapIcon from \"@/assets/map-icon.png\";\r\n\r\ninterface RestaurantMapProps {\r\n  restaurants: Restaurant[];\r\n  onRestaurantClick: (restaurant: Restaurant) => void;\r\n  userLocation: { lat: number; lng: number } | null;\r\n  radiusFilter: number | null;\r\n  onMapInit?: (map: mapboxgl.Map) => void;\r\n  onMarkerClick?: (restaurant: Restaurant) => void;\r\n  showViewDetailsButton?: boolean;\r\n}\r\n\r\nconst RestaurantMap = ({ \r\n  restaurants, \r\n  onRestaurantClick, \r\n  userLocation,\r\n  radiusFilter,\r\n  onMapInit,\r\n  onMarkerClick,\r\n  showViewDetailsButton = false\r\n}: RestaurantMapProps) => {\r\n  const { i18n, t } = useTranslation();\r\n  const mapContainer = useRef<HTMLDivElement>(null);\r\n  const map = useRef<mapboxgl.Map | null>(null);\r\n  const markers = useRef<mapboxgl.Marker[]>([]);\r\n  const [mapLoaded, setMapLoaded] = useState(false);\r\n  const [mapError, setMapError] = useState<string | null>(null);\r\n  const currentPopup = useRef<mapboxgl.Popup | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (!mapContainer.current || map.current) return;\r\n\r\n    const token = import.meta.env.VITE_MAPBOX_TOKEN;\r\n    if (!token) {\r\n      console.warn('[RestaurantMap] No Mapbox token found');\r\n      return;\r\n    }\r\n\r\n    // Enhanced WebGL support check for iOS WebView\r\n    const checkWebGLSupport = (): boolean => {\r\n      try {\r\n        const canvas = document.createElement('canvas');\r\n        const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');\r\n        if (!gl) {\r\n          console.warn('[RestaurantMap] WebGL context creation failed');\r\n          return false;\r\n        }\r\n        return mapboxgl.supported();\r\n      } catch (e) {\r\n        console.warn('[RestaurantMap] WebGL check error:', e);\r\n        return false;\r\n      }\r\n    };\r\n\r\n    if (!checkWebGLSupport()) {\r\n      console.warn('[RestaurantMap] WebGL not supported', {\r\n        isIOSDevice: isIOSDevice(),\r\n        isIOSWebView: isIOSWebView(),\r\n        userAgent: navigator.userAgent\r\n      });\r\n      setMapError(t('map.webglNotSupported', 'Your browser does not support map display'));\r\n      return;\r\n    }\r\n\r\n    let retryCount = 0;\r\n    const maxRetries = 30; // 3 seconds max wait\r\n\r\n    // Wait for container to have valid dimensions\r\n    const initMap = () => {\r\n      if (!mapContainer.current) return;\r\n      \r\n      const rect = mapContainer.current.getBoundingClientRect();\r\n      \r\n      if (rect.width === 0 || rect.height === 0) {\r\n        retryCount++;\r\n        if (retryCount >= maxRetries) {\r\n          console.error('[RestaurantMap] Container never got valid dimensions after', maxRetries, 'retries');\r\n          // For iOS WebView, show error with option to open in browser\r\n          if (isIOSWebView()) {\r\n            setMapError(t('map.loadError', 'Map failed to load'));\r\n          } else {\r\n            // Try once more after a longer delay\r\n            setTimeout(initMap, 500);\r\n          }\r\n          return;\r\n        }\r\n        setTimeout(initMap, 100);\r\n        return;\r\n      }\r\n\r\n      try {\r\n        mapboxgl.accessToken = token;\r\n\r\n        const initialCenter: [number, number] = userLocation \r\n          ? [userLocation.lng, userLocation.lat]\r\n          : [-9.1393, 38.7223];\r\n\r\n        map.current = new mapboxgl.Map({\r\n          container: mapContainer.current,\r\n          style: \"mapbox://styles/mapbox/light-v11\",\r\n          center: initialCenter,\r\n          zoom: 13,\r\n          cooperativeGestures: true,\r\n          doubleClickZoom: false,\r\n          // iOS WebView optimizations\r\n          fadeDuration: isIOSWebView() ? 0 : 300,\r\n          preserveDrawingBuffer: isIOSWebView(), // Helps with some WebView rendering issues\r\n        });\r\n\r\n        map.current.on('error', (e) => {\r\n          console.error('[RestaurantMap] Map error:', e);\r\n          setMapError(t('map.loadError', 'Map failed to load'));\r\n        });\r\n\r\n        map.current.addControl(\r\n          new mapboxgl.NavigationControl({\r\n            visualizePitch: true,\r\n          }),\r\n          \"top-right\"\r\n        );\r\n\r\n        map.current.on(\"load\", () => {\r\n          setMapLoaded(true);\r\n          \r\n          if (onMapInit && map.current) {\r\n            onMapInit(map.current);\r\n          }\r\n        });\r\n      } catch (error) {\r\n        console.error('[RestaurantMap] Failed to initialize map:', error);\r\n        setMapError(t('map.loadError', 'Map failed to load'));\r\n      }\r\n    };\r\n\r\n    // For iOS WebView, add a small delay to ensure container is ready\r\n    if (isIOSWebView()) {\r\n      setTimeout(initMap, 200);\r\n    } else {\r\n      initMap();\r\n    }\r\n\r\n    return () => {\r\n      markers.current.forEach(marker => marker.remove());\r\n      markers.current = [];\r\n      if (currentPopup.current) {\r\n        currentPopup.current.remove();\r\n        currentPopup.current = null;\r\n      }\r\n      map.current?.remove();\r\n      map.current = null;\r\n      setMapLoaded(false);\r\n    };\r\n  }, []);\r\n\r\n  // Update map center when user location changes\r\n  useEffect(() => {\r\n    if (map.current && userLocation && mapLoaded) {\r\n      map.current.flyTo({\r\n        center: [userLocation.lng, userLocation.lat],\r\n        zoom: 14,\r\n        duration: 1500,\r\n      });\r\n    }\r\n  }, [userLocation, mapLoaded]);\r\n\r\n  useEffect(() => {\r\n    if (!map.current || !mapLoaded) return;\r\n\r\n    markers.current.forEach(marker => marker.remove());\r\n    markers.current = [];\r\n    if (currentPopup.current) {\r\n      currentPopup.current.remove();\r\n      currentPopup.current = null;\r\n    }\r\n\r\n    let filteredRestaurants = restaurants;\r\n    if (userLocation && radiusFilter) {\r\n      filteredRestaurants = restaurants.filter(restaurant => {\r\n        const distance = calculateDistance(\r\n          userLocation.lat,\r\n          userLocation.lng,\r\n          restaurant.lat,\r\n          restaurant.lng\r\n        );\r\n        return distance <= radiusFilter;\r\n      });\r\n    }\r\n\r\n    filteredRestaurants.forEach((restaurant) => {\r\n      const popupContent = document.createElement('div');\r\n      popupContent.className = 'p-3 min-w-[200px]';\r\n      popupContent.innerHTML = `\r\n        <div class=\"space-y-2\">\r\n          <h3 class=\"font-bold text-base text-foreground\">${restaurant.name}</h3>\r\n          ${restaurant.type && restaurant.type.length > 0 ? `\r\n            <div class=\"flex flex-wrap gap-1\">\r\n              ${restaurant.type.slice(0, 2).map(type => \r\n                `<span class=\"text-xs bg-secondary text-secondary-foreground px-2 py-0.5 rounded\">${type}</span>`\r\n              ).join('')}\r\n            </div>\r\n          ` : ''}\r\n          ${restaurant.rating ? `\r\n            <div class=\"flex items-center gap-1\">\r\n              <span style=\"color: #016450;\">‚≠ê</span>\r\n              <span class=\"font-semibold text-sm\">${restaurant.rating.toFixed(1)}</span>\r\n            </div>\r\n          ` : ''}\r\n          <p class=\"text-xs text-muted-foreground\">${restaurant.address}</p>\r\n          ${showViewDetailsButton ? `\r\n            <button \r\n              id=\"view-details-${restaurant.id}\" \r\n              class=\"w-full mt-2 px-3 py-1.5 text-sm font-medium text-white rounded-md transition-colors\"\r\n              style=\"background-color: #016450;\"\r\n              onmouseover=\"this.style.opacity='0.9'\"\r\n              onmouseout=\"this.style.opacity='1'\"\r\n            >\r\n              ${t('restaurants.viewDetails')}\r\n            </button>\r\n          ` : ''}\r\n        </div>\r\n      `;\r\n\r\n      const popup = new mapboxgl.Popup({ \r\n        offset: 25,\r\n        closeButton: true,\r\n        closeOnClick: false,\r\n        closeOnMove: false,\r\n        maxWidth: '300px'\r\n      })\r\n        .setLngLat([restaurant.lng, restaurant.lat])\r\n        .setDOMContent(popupContent);\r\n\r\n      const el = document.createElement('div');\r\n      el.className = 'custom-marker';\r\n      el.style.backgroundImage = `url(${mapIcon})`;\r\n      el.style.width = '40px';\r\n      el.style.height = '40px';\r\n      el.style.backgroundSize = 'contain';\r\n      el.style.backgroundRepeat = 'no-repeat';\r\n      el.style.backgroundPosition = 'center';\r\n      el.style.cursor = 'pointer';\r\n\r\n      const marker = new mapboxgl.Marker({ \r\n        element: el,\r\n        draggable: false\r\n      })\r\n        .setLngLat([restaurant.lng, restaurant.lat])\r\n        .addTo(map.current!);\r\n\r\n      const markerElement = marker.getElement();\r\n      markerElement.style.cursor = 'pointer';\r\n      \r\n      // Remove any existing click handlers\r\n      const handleMarkerClick = (e: MouseEvent) => {\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n        \r\n        if (currentPopup.current && currentPopup.current !== popup) {\r\n          currentPopup.current.remove();\r\n        }\r\n        \r\n        popup.addTo(map.current!);\r\n        currentPopup.current = popup;\r\n        \r\n        map.current!.easeTo({\r\n          center: [restaurant.lng, restaurant.lat],\r\n          zoom: 17,\r\n          duration: 800,\r\n        });\r\n        \r\n        if (onMarkerClick) {\r\n          onMarkerClick(restaurant);\r\n        }\r\n      };\r\n      \r\n      markerElement.addEventListener('click', handleMarkerClick, true);\r\n\r\n      if (showViewDetailsButton) {\r\n        popup.on('open', () => {\r\n          const button = document.getElementById(`view-details-${restaurant.id}`);\r\n          if (button) {\r\n            button.addEventListener('click', (e) => {\r\n              e.stopPropagation();\r\n              onRestaurantClick(restaurant);\r\n            });\r\n          }\r\n        });\r\n      }\r\n\r\n      popup.on('close', () => {\r\n        if (currentPopup.current === popup) {\r\n          currentPopup.current = null;\r\n        }\r\n      });\r\n\r\n      markers.current.push(marker);\r\n    });\r\n\r\n    if (filteredRestaurants.length > 0) {\r\n      const bounds = new mapboxgl.LngLatBounds();\r\n      filteredRestaurants.forEach(restaurant => {\r\n        bounds.extend([restaurant.lng, restaurant.lat]);\r\n      });\r\n      \r\n      if (userLocation) {\r\n        bounds.extend([userLocation.lng, userLocation.lat]);\r\n      }\r\n\r\n      map.current.fitBounds(bounds, {\r\n        padding: 50,\r\n        maxZoom: 15,\r\n      });\r\n    }\r\n  }, [restaurants, radiusFilter, userLocation, mapLoaded, onRestaurantClick, i18n.language, showViewDetailsButton, t, onMarkerClick]);\r\n\r\n  useEffect(() => {\r\n    if (!map.current || !userLocation || !mapLoaded) return;\r\n\r\n    const userMarkerEl = document.createElement(\"div\");\r\n    userMarkerEl.className = \"user-location-marker\";\r\n    userMarkerEl.style.backgroundColor = \"#3b82f6\";\r\n    userMarkerEl.style.width = \"20px\";\r\n    userMarkerEl.style.height = \"20px\";\r\n    userMarkerEl.style.borderRadius = \"50%\";\r\n    userMarkerEl.style.border = \"3px solid white\";\r\n    userMarkerEl.style.boxShadow = \"0 2px 4px rgba(0,0,0,0.3)\";\r\n\r\n    const userMarker = new mapboxgl.Marker(userMarkerEl)\r\n      .setLngLat([userLocation.lng, userLocation.lat])\r\n      .addTo(map.current);\r\n\r\n    return () => {\r\n      userMarker.remove();\r\n    };\r\n  }, [userLocation, mapLoaded]);\r\n\r\n  // Show error fallback UI\r\n  if (mapError) {\r\n    return (\r\n      <div className=\"w-full h-full rounded-lg overflow-hidden bg-muted/50 flex flex-col items-center justify-center p-6 text-center\">\r\n        <AlertTriangle className=\"w-12 h-12 text-muted-foreground mb-4\" />\r\n        <p className=\"text-muted-foreground mb-2\">{mapError}</p>\r\n        <p className=\"text-sm text-muted-foreground mb-4\">\r\n          {t('map.viewListInstead', 'Please view the restaurant list below')}\r\n        </p>\r\n        {isIOSWebView() && (\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={() => window.open(window.location.href, '_blank')}\r\n          >\r\n            <MapPin className=\"w-4 h-4 mr-2\" />\r\n            {t('map.openInBrowser', 'Open in Browser')}\r\n          </Button>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div \r\n      ref={mapContainer} \r\n      className=\"w-full h-full rounded-lg overflow-hidden\"\r\n      style={{ \r\n        minHeight: '300px', // Ensure minimum height for iOS WebView\r\n        WebkitTransform: 'translateZ(0)', // Force hardware acceleration on iOS\r\n      }} \r\n    />\r\n  );\r\n};\r\n\r\nexport default RestaurantMap;\r\n","import { useQuery } from \"@tanstack/react-query\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\n\r\nexport interface ActivityRestaurantCount {\r\n  activityId: string;\r\n  count: number;\r\n}\r\n\r\nexport const useActivityRestaurantCounts = () => {\r\n  return useQuery({\r\n    queryKey: [\"activity-restaurant-counts\"],\r\n    queryFn: async () => {\r\n      const { data, error } = await supabase\r\n        .from(\"activity_restaurants\")\r\n        .select(\"activity_id\");\r\n\r\n      if (error) throw error;\r\n\r\n      // Count restaurants per activity\r\n      const counts: Record<string, number> = {};\r\n      data.forEach((item) => {\r\n        counts[item.activity_id] = (counts[item.activity_id] || 0) + 1;\r\n      });\r\n\r\n      return counts;\r\n    },\r\n  });\r\n};\r\n","export default \"__VITE_ASSET__CJwYOB8R__\""],"names":["RestaurantMap","restaurants","onRestaurantClick","userLocation","radiusFilter","onMapInit","onMarkerClick","showViewDetailsButton","i18n","t","useTranslation","mapContainer","useRef","map","markers","mapLoaded","setMapLoaded","useState","mapError","setMapError","currentPopup","useEffect","token","canvas","mapboxgl","e","isIOSDevice","isIOSWebView","retryCount","maxRetries","initMap","rect","initialCenter","error","marker","filteredRestaurants","restaurant","calculateDistance","popupContent","type","popup","el","mapIcon","markerElement","handleMarkerClick","button","bounds","userMarkerEl","userMarker","jsxs","jsx","AlertTriangle","Button","MapPin","useActivityRestaurantCounts","useQuery","data","supabase","counts","item","logoIcon"],"mappings":"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"}