{"version":3,"file":"AIRecipeSelect-D5hIZTtB.js","sources":["../../src/components/ai-recipe/AIVideoGenerator.tsx","../../src/pages/AIRecipeSelect.tsx"],"sourcesContent":["import { useState, useCallback } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Video, Loader2, Download, Shuffle, Search, BookOpen, Bookmark, BookmarkCheck } from \"lucide-react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { toast } from \"sonner\";\r\nimport { useRecipeVideo, VideoTask } from \"@/hooks/useRecipeVideo\";\r\nimport { useWatermarkedVideo } from \"@/hooks/useWatermarkedVideo\";\r\nimport { useSavedRecipes } from \"@/hooks/useSavedRecipes\";\r\nimport { useAuth } from \"@/contexts/AuthContext\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport xiaoxiongLogo from \"@/assets/xiaoxiong-logo-clean.png\";\r\nimport SavedRecipeDetailDialog from \"@/components/ai-recipe/SavedRecipeDetailDialog\";\r\n\r\nconst SUPABASE_URL = import.meta.env.VITE_SUPABASE_URL;\r\nconst ANON_KEY = import.meta.env.VITE_SUPABASE_PUBLISHABLE_KEY;\r\nconst LOOKUP_URL = `${SUPABASE_URL}/functions/v1/ai-recipe/lookup-dish`;\r\n\r\ninterface RecipeResult {\r\n  recipe_name: string;\r\n  recipe_name_en?: string;\r\n  recipe_name_pt?: string;\r\n  image_url?: string;\r\n  steps?: any[];\r\n  [key: string]: any;\r\n}\r\n\r\nconst buildVideoPrompt = (recipe: RecipeResult): string => {\r\n  const steps = recipe.steps || [];\r\n  const stepDescriptions = steps\r\n    .slice(0, 5)\r\n    .map((s: any) => s.description_en || s.description || \"\")\r\n    .filter(Boolean)\r\n    .join(\". \");\r\n  const dishName = recipe.recipe_name_en || recipe.recipe_name;\r\n  return `Step-by-step cooking tutorial video showing the complete preparation process of ${dishName}. Show hands chopping ingredients, mixing in a bowl, cooking in a pan with oil sizzling. ${stepDescriptions}. Kitchen counter with fresh ingredients, cutting board, knife, pots and pans visible. Warm natural kitchen lighting, steam rising from the pan, close-up of each cooking step, smooth transitions between steps. --duration 5 --camerafixed true`;\r\n};\r\n\r\nconst VideoPreview = ({ videoTask, recipeName, recipe }: { videoTask: VideoTask; recipeName: string; recipe: RecipeResult }) => {\r\n  const rawVideoUrl = videoTask.status === \"succeeded\" ? videoTask.videoUrl : null;\r\n  const { watermarkedUrl, isMp4 } = useWatermarkedVideo(rawVideoUrl, xiaoxiongLogo);\r\n  const { t } = useTranslation();\r\n  const { user } = useAuth();\r\n  const navigate = useNavigate();\r\n  const { saveRecipe, isSaving, savedRecipes } = useSavedRecipes();\r\n  const [saved, setSaved] = useState(false);\r\n  const [showRecipeDialog, setShowRecipeDialog] = useState(false);\r\n\r\n  const isSavedAlready = saved || savedRecipes.some(r => r.recipe_name === recipeName);\r\n\r\n  const handleDownload = () => {\r\n    const url = watermarkedUrl || rawVideoUrl;\r\n    if (!url) return;\r\n    const ext = watermarkedUrl ? (isMp4 ? \"mp4\" : \"webm\") : \"mp4\";\r\n    const a = document.createElement(\"a\");\r\n    a.href = url;\r\n    a.download = `${recipeName}-xiaoxiong.${ext}`;\r\n    document.body.appendChild(a);\r\n    a.click();\r\n    document.body.removeChild(a);\r\n    toast.success(t(\"aiRecipe.video.downloadComplete\", \"视频下载完成\"));\r\n  };\r\n\r\n  const handleSave = async () => {\r\n    if (!user) {\r\n      toast.error(t(\"auth.loginRequired\", \"请先登录\"));\r\n      navigate(\"/auth\");\r\n      return;\r\n    }\r\n    if (isSavedAlready) return;\r\n    try {\r\n      await saveRecipe(recipe as any);\r\n      setSaved(true);\r\n    } catch {\r\n      // error handled in hook\r\n    }\r\n  };\r\n\r\n  const handleViewRecipe = () => {\r\n    setShowRecipeDialog(true);\r\n  };\r\n\r\n  const isWatermarking = videoTask.status === \"succeeded\" && rawVideoUrl && !watermarkedUrl;\r\n\r\n  const recipeDialog = (\r\n    <SavedRecipeDetailDialog\r\n      open={showRecipeDialog}\r\n      onOpenChange={setShowRecipeDialog}\r\n      recipe={recipe as any}\r\n      recipeName={recipeName}\r\n      initialImageUrl={recipe.image_url}\r\n      onSave={!isSavedAlready ? (r) => handleSave() : undefined}\r\n      isSaving={isSaving}\r\n      isSaved={isSavedAlready}\r\n    />\r\n  );\r\n\r\n  if (videoTask.status === \"succeeded\" && rawVideoUrl) {\r\n    return (\r\n      <div className=\"space-y-3\">\r\n        {isWatermarking ? (\r\n          <div className=\"w-full aspect-video rounded-2xl bg-muted/30 flex items-center justify-center\">\r\n            <Loader2 className=\"h-5 w-5 animate-spin text-muted-foreground\" />\r\n          </div>\r\n        ) : (\r\n          <video\r\n            src={watermarkedUrl || rawVideoUrl}\r\n            controls\r\n            autoPlay\r\n            muted\r\n            loop\r\n            playsInline\r\n            className=\"w-full rounded-2xl shadow-lg\"\r\n          />\r\n        )}\r\n        <div className=\"flex gap-2\">\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            className=\"gap-1.5 flex-1\"\r\n            onClick={handleDownload}\r\n          >\r\n            <Download className=\"h-3.5 w-3.5\" />\r\n            {t(\"aiRecipe.video.downloadWithWatermark\", \"下载视频\")}\r\n          </Button>\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            className=\"gap-1.5 flex-1\"\r\n            onClick={handleViewRecipe}\r\n          >\r\n            <BookOpen className=\"h-3.5 w-3.5\" />\r\n            {t(\"aiRecipe.video.viewRecipe\", \"查看菜谱\")}\r\n          </Button>\r\n          <Button\r\n            variant={isSavedAlready ? \"secondary\" : \"outline\"}\r\n            size=\"sm\"\r\n            className=\"gap-1.5 flex-1\"\r\n            onClick={handleSave}\r\n            disabled={isSaving || isSavedAlready}\r\n          >\r\n            {isSavedAlready ? (\r\n              <BookmarkCheck className=\"h-3.5 w-3.5\" />\r\n            ) : (\r\n              <Bookmark className=\"h-3.5 w-3.5\" />\r\n            )}\r\n            {isSavedAlready\r\n              ? t(\"aiRecipe.video.saved\", \"已保存\")\r\n              : t(\"aiRecipe.video.save\", \"保存\")}\r\n          </Button>\r\n        </div>\r\n        {recipeDialog}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (videoTask.status === \"creating\" || videoTask.status === \"processing\") {\r\n    return (\r\n      <div className=\"flex items-center justify-center gap-2 p-4\">\r\n        <Loader2 className=\"h-4 w-4 animate-spin text-primary\" />\r\n        <span className=\"text-xs text-muted-foreground\">\r\n          {videoTask.status === \"creating\"\r\n            ? t(\"aiRecipe.video.creating\", \"正在创建视频任务...\")\r\n            : t(\"aiRecipe.video.processing\", \"AI 视频生成中，请稍候...\")}\r\n        </span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (videoTask.status === \"failed\") {\r\n    return (\r\n      <div className=\"text-xs text-destructive text-center p-4\">\r\n        {videoTask.error || t(\"aiRecipe.video.failed\", \"视频生成失败\")}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return null;\r\n};\r\n\r\n/** Placeholder shown when no video is active */\r\nconst VideoPlaceholder = () => {\r\n  const { t } = useTranslation();\r\n  return (\r\n    <div className=\"w-full aspect-video rounded-2xl bg-muted/40 border border-dashed border-border flex flex-col items-center justify-center gap-2 px-4\">\r\n      <div className=\"w-9 h-9 rounded-full bg-primary/10 flex items-center justify-center shrink-0\">\r\n        <Video className=\"h-4 w-4 text-primary/60\" />\r\n      </div>\r\n      <p className=\"text-xs text-muted-foreground text-center\">\r\n        {t(\"aiRecipe.videoGen.placeholderHint\", \"输入菜名或随机挑选，AI 将为您生成烹饪视频\")}\r\n      </p>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst AIVideoGenerator = () => {\r\n  const { t, i18n } = useTranslation();\r\n  const [dishName, setDishName] = useState(\"\");\r\n  const [isLookingUp, setIsLookingUp] = useState(false);\r\n  const [recipe, setRecipe] = useState<RecipeResult | null>(null);\r\n  const { videoTasks, generateVideo } = useRecipeVideo();\r\n\r\n  const getDisplayName = (r: RecipeResult) => {\r\n    if (i18n.language === \"en\" && r.recipe_name_en) return r.recipe_name_en;\r\n    if (i18n.language === \"pt\" && r.recipe_name_pt) return r.recipe_name_pt;\r\n    return r.recipe_name;\r\n  };\r\n\r\n  const handleLookup = useCallback(async (random = false) => {\r\n    setIsLookingUp(true);\r\n    setRecipe(null);\r\n    try {\r\n      const resp = await fetch(LOOKUP_URL, {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Authorization: `Bearer ${ANON_KEY}`,\r\n        },\r\n        body: JSON.stringify({\r\n          dish_name: random ? \"\" : dishName.trim(),\r\n          language: i18n.language,\r\n        }),\r\n      });\r\n\r\n      if (!resp.ok) {\r\n        const err = await resp.json().catch(() => ({}));\r\n        throw new Error(err.error || `Error ${resp.status}`);\r\n      }\r\n\r\n      const data = await resp.json();\r\n      setRecipe(data.recipe);\r\n      toast.success(t(\"aiRecipe.videoGen.found\", \"食谱已找到！\"));\r\n\r\n      if (data.recipe?.image_url) {\r\n        const prompt = buildVideoPrompt(data.recipe);\r\n        generateVideo(data.recipe.recipe_name, data.recipe.image_url, prompt);\r\n      }\r\n    } catch (err: any) {\r\n      console.error(\"Lookup error:\", err);\r\n      toast.error(err.message || t(\"aiRecipe.videoGen.error\", \"查询失败，请重试\"));\r\n    } finally {\r\n      setIsLookingUp(false);\r\n    }\r\n  }, [dishName, i18n.language, generateVideo, t]);\r\n\r\n  const currentVideoTask = recipe ? videoTasks[recipe.recipe_name] : undefined;\r\n\r\n  // Whether to show video area (only when actively looking up, generating, or done)\r\n  const showVideoArea = isLookingUp || !!recipe;\r\n\r\n  return (\r\n    <div className=\"w-full space-y-4\">\r\n      {/* Header */}\r\n      <div className=\"text-center space-y-1\">\r\n        <div className=\"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-primary/10 text-primary text-xs font-medium\">\r\n          <Video className=\"h-3.5 w-3.5\" />\r\n          {t(\"aiRecipe.videoGen.title\", \"AI 烹饪视频\")}\r\n        </div>\r\n        <p className=\"text-xs text-muted-foreground\">\r\n          {t(\"aiRecipe.videoGen.desc\", \"输入菜名生成AI烹饪视频，或随机挑选\")}\r\n        </p>\r\n      </div>\r\n\r\n      {/* Input - always visible */}\r\n      <div className=\"flex gap-2\">\r\n        <Input\r\n          value={dishName}\r\n          onChange={(e) => setDishName(e.target.value)}\r\n          placeholder={t(\"aiRecipe.videoGen.placeholder\", \"输入菜名，如：红烧肉\")}\r\n          className=\"text-sm h-10\"\r\n          onKeyDown={(e) => {\r\n            if (e.key === \"Enter\" && !isLookingUp) handleLookup(false);\r\n          }}\r\n          disabled={isLookingUp}\r\n        />\r\n        <Button\r\n          size=\"icon\"\r\n          onClick={() => handleLookup(false)}\r\n          disabled={isLookingUp || !dishName.trim()}\r\n          className=\"h-10 w-10 shrink-0\"\r\n        >\r\n          {isLookingUp ? (\r\n            <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n          ) : (\r\n            <Search className=\"h-4 w-4\" />\r\n          )}\r\n        </Button>\r\n        <Button\r\n          size=\"icon\"\r\n          variant=\"outline\"\r\n          onClick={() => handleLookup(true)}\r\n          disabled={isLookingUp}\r\n          className=\"h-10 w-10 shrink-0\"\r\n          title={t(\"aiRecipe.videoGen.random\", \"随机挑选\")}\r\n        >\r\n          {isLookingUp ? (\r\n            <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n          ) : (\r\n            <Shuffle className=\"h-4 w-4\" />\r\n          )}\r\n        </Button>\r\n      </div>\r\n\r\n      {/* Video Area - slide down animation, only visible when active */}\r\n      <div\r\n        className={`grid transition-all duration-500 ease-out ${\r\n          showVideoArea ? \"grid-rows-[1fr] opacity-100\" : \"grid-rows-[0fr] opacity-0\"\r\n        }`}\r\n      >\r\n        <div className=\"overflow-hidden\">\r\n          <div className=\"pt-1\">\r\n            {isLookingUp ? (\r\n              <div className=\"w-full aspect-video rounded-2xl bg-muted/30 flex flex-col items-center justify-center gap-3\">\r\n                <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\r\n                <p className=\"text-sm text-muted-foreground\">\r\n                  {dishName.trim()\r\n                    ? t(\"aiRecipe.videoGen.searching\", \"正在查找食谱...\")\r\n                    : t(\"aiRecipe.videoGen.randomPicking\", \"随机挑选中...\")}\r\n                </p>\r\n              </div>\r\n            ) : recipe ? (\r\n              <div className=\"w-full\">\r\n                {currentVideoTask ? (\r\n                  <>\r\n                    {currentVideoTask.status !== \"succeeded\" && recipe.image_url && (\r\n                      <div className=\"relative w-full aspect-video rounded-2xl overflow-hidden mb-3\">\r\n                        <img\r\n                          src={recipe.image_url}\r\n                          alt={getDisplayName(recipe)}\r\n                          className=\"w-full h-full object-cover\"\r\n                        />\r\n                        <div className=\"absolute inset-0 bg-black/30 flex items-center justify-center\">\r\n                          <div className=\"text-center text-white space-y-2\">\r\n                            <Loader2 className=\"h-8 w-8 animate-spin mx-auto\" />\r\n                            <p className=\"text-sm font-medium\">{getDisplayName(recipe)}</p>\r\n                            <p className=\"text-xs opacity-80\">\r\n                              {t(\"aiRecipe.video.processing\", \"AI 视频生成中，请稍候...\")}\r\n                            </p>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                    {currentVideoTask.status === \"succeeded\" && (\r\n                      <p className=\"text-sm font-medium text-center mb-2\">{getDisplayName(recipe)}</p>\r\n                    )}\r\n                    <VideoPreview videoTask={currentVideoTask} recipeName={recipe.recipe_name} recipe={recipe} />\r\n                  </>\r\n                ) : !recipe.image_url ? (\r\n                  <div className=\"w-full aspect-video rounded-2xl bg-muted/30 flex items-center justify-center\">\r\n                    <p className=\"text-sm text-muted-foreground\">\r\n                      {t(\"aiRecipe.videoGen.noImage\", \"此食谱暂无图片，无法生成视频\")}\r\n                    </p>\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"relative w-full aspect-video rounded-2xl overflow-hidden\">\r\n                    <img src={recipe.image_url} alt={getDisplayName(recipe)} className=\"w-full h-full object-cover\" />\r\n                    <div className=\"absolute inset-0 bg-black/30 flex items-center justify-center\">\r\n                      <Loader2 className=\"h-8 w-8 animate-spin text-white\" />\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            ) : null}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AIVideoGenerator;\r\n","import { useState, useRef, useEffect } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useNavigate, useLocation } from \"react-router-dom\";\r\nimport { ArrowLeft, Sparkles, ChefHat, HelpCircle } from \"lucide-react\";\r\nimport { useLoginRequired } from \"@/hooks/useLoginRequired\";\r\nimport AIVideoGenerator from \"@/components/ai-recipe/AIVideoGenerator\";\r\n\r\nconst AIRecipeSelect = () => {\r\n  const { t } = useTranslation();\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const { requireLogin } = useLoginRequired();\r\n\r\n  const fromPath = (location.state as any)?.from || \"/\";\r\n\r\n  return (\r\n    <div className=\"min-h-screen flex flex-col bg-background\">\r\n      {/* Header */}\r\n      <div className=\"px-4 py-3 border-b bg-background shrink-0 sticky top-14 z-10\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <button\r\n            onClick={() => navigate(fromPath, { replace: true })}\r\n            className=\"p-1 -ml-1 hover:bg-muted rounded-md\"\r\n          >\r\n            <ArrowLeft className=\"h-5 w-5\" />\r\n          </button>\r\n          <div className=\"flex items-center gap-2\">\r\n            <Sparkles className=\"h-4 w-4 text-primary\" />\r\n            <h2 className=\"font-medium\">{t(\"aiRecipe.title\")}</h2>\r\n          </div>\r\n          <div className=\"w-6\" />\r\n        </div>\r\n      </div>\r\n\r\n      {/* Content */}\r\n      <div className=\"flex-1 flex flex-col items-center px-4 py-4 sm:p-6 gap-4 sm:gap-6 max-w-md mx-auto w-full\">\r\n        {/* AI Video Generator */}\r\n        <AIVideoGenerator />\r\n\r\n        <div className=\"w-full border-t border-border\" />\r\n\r\n        <div className=\"text-center space-y-1\">\r\n          <h1 className=\"text-xl sm:text-2xl font-bold\">{t(\"aiRecipe.selectTitle\")}</h1>\r\n          <p className=\"text-xs sm:text-sm text-muted-foreground\">\r\n            {t(\"aiRecipe.selectDesc\")}\r\n          </p>\r\n        </div>\r\n\r\n        <div className=\"grid gap-3 w-full\">\r\n          {/* 吃什么 */}\r\n          <button\r\n            onClick={() => navigate(\"/ai-recipe/what-to-eat\", { state: { from: fromPath } })}\r\n            className=\"flex items-start gap-3 p-4 sm:p-5 rounded-2xl border-2 border-border hover:border-primary hover:bg-primary/5 transition-all duration-200 group text-left\"\r\n          >\r\n            <div className=\"w-11 h-11 sm:w-14 sm:h-14 rounded-xl bg-primary/10 flex items-center justify-center shrink-0 group-hover:scale-105 transition-transform\">\r\n              <HelpCircle className=\"h-5 w-5 sm:h-7 sm:w-7 text-primary\" />\r\n            </div>\r\n            <div className=\"space-y-1\">\r\n              <h3 className=\"font-semibold text-base\">\r\n                {t(\"aiRecipe.whatToEat\")}\r\n              </h3>\r\n              <p className=\"text-xs text-muted-foreground leading-relaxed\">\r\n                {t(\"aiRecipe.whatToEatDesc\")}\r\n              </p>\r\n            </div>\r\n          </button>\r\n\r\n          {/* 做什么 */}\r\n          <button\r\n            onClick={() => { if (requireLogin()) navigate(\"/ai-recipe/how-to-cook\", { state: { from: fromPath } }); }}\r\n            className=\"flex items-start gap-3 p-4 sm:p-5 rounded-2xl border-2 border-border hover:border-primary hover:bg-primary/5 transition-all duration-200 group text-left\"\r\n          >\r\n            <div className=\"w-11 h-11 sm:w-14 sm:h-14 rounded-xl bg-accent flex items-center justify-center shrink-0 group-hover:scale-105 transition-transform\">\r\n              <ChefHat className=\"h-5 w-5 sm:h-7 sm:w-7 text-accent-foreground\" />\r\n            </div>\r\n            <div className=\"space-y-1\">\r\n              <h3 className=\"font-semibold text-base\">\r\n                {t(\"aiRecipe.howToCook\")}\r\n              </h3>\r\n              <p className=\"text-xs text-muted-foreground leading-relaxed\">\r\n                {t(\"aiRecipe.howToCookDesc\")}\r\n              </p>\r\n            </div>\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AIRecipeSelect;\r\n"],"names":["SUPABASE_URL","ANON_KEY","LOOKUP_URL","buildVideoPrompt","recipe","stepDescriptions","s","VideoPreview","videoTask","recipeName","rawVideoUrl","watermarkedUrl","isMp4","useWatermarkedVideo","xiaoxiongLogo","t","useTranslation","user","useAuth","navigate","useNavigate","saveRecipe","isSaving","savedRecipes","useSavedRecipes","saved","setSaved","useState","showRecipeDialog","setShowRecipeDialog","isSavedAlready","r","handleDownload","url","ext","a","toast","handleSave","handleViewRecipe","isWatermarking","recipeDialog","jsx","SavedRecipeDetailDialog","jsxs","Loader2","Button","Download","BookOpen","BookmarkCheck","Bookmark","AIVideoGenerator","i18n","dishName","setDishName","isLookingUp","setIsLookingUp","setRecipe","videoTasks","generateVideo","useRecipeVideo","getDisplayName","handleLookup","useCallback","random","resp","err","data","prompt","currentVideoTask","showVideoArea","Video","Input","e","Search","Shuffle","Fragment","AIRecipeSelect","location","useLocation","requireLogin","useLoginRequired","fromPath","ArrowLeft","Sparkles","HelpCircle","ChefHat"],"mappings":"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"}