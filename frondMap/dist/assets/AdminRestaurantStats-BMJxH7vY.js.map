{"version":3,"file":"AdminRestaurantStats-BMJxH7vY.js","sources":["../../src/pages/admin/AdminRestaurantStats.tsx"],"sourcesContent":["import { formatTrademarkSymbols } from \"@/lib/textFormatting\";\r\nimport { useState } from \"react\";\r\nimport { useParams, Link } from \"react-router-dom\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Skeleton } from \"@/components/ui/skeleton\";\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\r\nimport { fetchAllPaginated } from \"@/lib/paginatedQuery\";\r\nimport { \r\n  ChevronLeft, \r\n  Eye, \r\n  Star, \r\n  MessageCircle,\r\n  TrendingUp,\r\n  Calendar,\r\n  Store,\r\n  Heart,\r\n  ExternalLink,\r\n  Edit,\r\n  FileText\r\n} from \"lucide-react\";\r\nimport { useRestaurant } from \"@/hooks/useRestaurants\";\r\nimport { useLocalizedContent } from \"@/hooks/useLocalizedContent\";\r\nimport { useQuery } from \"@tanstack/react-query\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { format, subDays, startOfDay, eachDayOfInterval } from \"date-fns\";\r\nimport { \r\n  LineChart, \r\n  Line, \r\n  XAxis, \r\n  YAxis, \r\n  CartesianGrid, \r\n  Tooltip, \r\n  ResponsiveContainer\r\n} from \"recharts\";\r\n\r\ntype TimeRange = \"today\" | \"7days\" | \"30days\" | \"all\";\r\n\r\nconst AdminRestaurantStats = () => {\r\n  const { id } = useParams<{ id: string }>();\r\n  const { t } = useTranslation();\r\n  const { localizeRestaurant } = useLocalizedContent();\r\n  const [timeRange, setTimeRange] = useState<TimeRange>(\"30days\");\r\n\r\n  const getDateFilter = () => {\r\n    const now = new Date();\r\n    switch (timeRange) {\r\n      case \"today\":\r\n        return startOfDay(now).toISOString();\r\n      case \"7days\":\r\n        return startOfDay(subDays(now, 6)).toISOString();\r\n      case \"30days\":\r\n        return startOfDay(subDays(now, 29)).toISOString();\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  const getChartDays = () => {\r\n    switch (timeRange) {\r\n      case \"today\": return 1;\r\n      case \"7days\": return 7;\r\n      case \"30days\": return 30;\r\n      default: return 30;\r\n    }\r\n  };\r\n  \r\n  const { data: restaurant, isLoading: restaurantLoading } = useRestaurant(id!);\r\n  const dateFilter = getDateFilter();\r\n\r\n  // Fetch page views for this restaurant (with pagination)\r\n  const { data: pageViews = [], isLoading: viewsLoading } = useQuery({\r\n    queryKey: [\"restaurant-page-views\", id, timeRange],\r\n    queryFn: async () => {\r\n      return await fetchAllPaginated(\r\n        \"page_views\",\r\n        \"created_at\",\r\n        (query) => {\r\n          query = query\r\n            .eq(\"page_type\", \"restaurant\")\r\n            .eq(\"target_id\", id!);\r\n          if (dateFilter) {\r\n            query = query.gte(\"created_at\", dateFilter);\r\n          }\r\n          return query;\r\n        }\r\n      );\r\n    },\r\n    enabled: !!id,\r\n  });\r\n\r\n  // Fetch comments for this restaurant with user profiles (with pagination)\r\n  const { data: comments = [], isLoading: commentsLoading } = useQuery({\r\n    queryKey: [\"restaurant-comments\", id, timeRange],\r\n    queryFn: async () => {\r\n      const data = await fetchAllPaginated(\r\n        \"comments\",\r\n        \"id, user_id, content, rating_value, created_at\",\r\n        (query) => {\r\n          query = query\r\n            .eq(\"target_type\", \"restaurant\")\r\n            .eq(\"target_id\", id!)\r\n            .order(\"created_at\", { ascending: false });\r\n          if (dateFilter) {\r\n            query = query.gte(\"created_at\", dateFilter);\r\n          }\r\n          return query;\r\n        }\r\n      );\r\n      \r\n      if (data && data.length > 0) {\r\n        const userIds = [...new Set(data.map(c => c.user_id))];\r\n        const { data: profiles } = await supabase\r\n          .rpc(\"get_public_profiles\", { user_ids: userIds });\r\n        \r\n        return data.map(c => ({\r\n          ...c,\r\n          profile: profiles?.find((p: any) => p.id === c.user_id)\r\n        }));\r\n      }\r\n      return [];\r\n    },\r\n    enabled: !!id,\r\n  });\r\n\r\n  // Fetch favorites for this restaurant (with pagination)\r\n  const { data: favorites = [], isLoading: favoritesLoading } = useQuery({\r\n    queryKey: [\"restaurant-favorites\", id, timeRange],\r\n    queryFn: async () => {\r\n      const data = await fetchAllPaginated(\r\n        \"favorites\",\r\n        \"user_id, created_at\",\r\n        (query) => {\r\n          query = query.eq(\"restaurant_id\", id!);\r\n          if (dateFilter) {\r\n            query = query.gte(\"created_at\", dateFilter);\r\n          }\r\n          return query;\r\n        }\r\n      );\r\n      \r\n      if (data && data.length > 0) {\r\n        const userIds = data.map(f => f.user_id);\r\n        const { data: profiles } = await supabase\r\n          .rpc(\"get_public_profiles\", { user_ids: userIds });\r\n        \r\n        return data.map(f => ({\r\n          ...f,\r\n          profile: profiles?.find((p: any) => p.id === f.user_id)\r\n        }));\r\n      }\r\n      return [];\r\n    },\r\n    enabled: !!id,\r\n  });\r\n\r\n  // Fetch community posts for this restaurant (with pagination)\r\n  const { data: posts = [], isLoading: postsLoading } = useQuery({\r\n    queryKey: [\"restaurant-posts\", id, timeRange],\r\n    queryFn: async () => {\r\n      const data = await fetchAllPaginated(\r\n        \"community_posts\",\r\n        \"id, author_id, content, likes_count, comments_count, views_count, created_at, status\",\r\n        (query) => {\r\n          query = query\r\n            .eq(\"restaurant_id\", id!)\r\n            .order(\"created_at\", { ascending: false });\r\n          if (dateFilter) {\r\n            query = query.gte(\"created_at\", dateFilter);\r\n          }\r\n          return query;\r\n        }\r\n      );\r\n      \r\n      if (data && data.length > 0) {\r\n        const userIds = [...new Set(data.map(p => p.author_id))];\r\n        const { data: profiles } = await supabase\r\n          .rpc(\"get_public_profiles\", { user_ids: userIds });\r\n        \r\n        return data.map(p => ({\r\n          ...p,\r\n          profile: profiles?.find((pr: any) => pr.id === p.author_id)\r\n        }));\r\n      }\r\n      return [];\r\n    },\r\n    enabled: !!id,\r\n  });\r\n\r\n  // Fetch participating activities\r\n  const { data: activities = [] } = useQuery({\r\n    queryKey: [\"restaurant-activities\", id],\r\n    queryFn: async () => {\r\n      const { data, error } = await supabase\r\n        .from(\"activity_restaurants\")\r\n        .select(`\r\n          activity_id,\r\n          activities (\r\n            id,\r\n            title_zh,\r\n            title_en,\r\n            title_pt,\r\n            status\r\n          )\r\n        `)\r\n        .eq(\"restaurant_id\", id!);\r\n      \r\n      if (error) throw error;\r\n      return data?.map(ar => ar.activities).filter(Boolean) || [];\r\n    },\r\n    enabled: !!id,\r\n  });\r\n\r\n  // Generate view trend data\r\n  const viewTrendData = (() => {\r\n    if (timeRange === \"all\") {\r\n      // For all time, group by day for last 30 days\r\n      const days = 30;\r\n      const endDate = new Date();\r\n      const startDate = subDays(endDate, days - 1);\r\n      const dateRange = eachDayOfInterval({ start: startDate, end: endDate });\r\n      \r\n      return dateRange.map(date => {\r\n        const dateStr = format(date, \"yyyy-MM-dd\");\r\n        const count = pageViews.filter(v => \r\n          format(new Date(v.created_at), \"yyyy-MM-dd\") === dateStr\r\n        ).length;\r\n        return { date: dateStr, views: count };\r\n      });\r\n    } else {\r\n      const days = getChartDays();\r\n      const endDate = new Date();\r\n      const startDate = subDays(endDate, days - 1);\r\n      const dateRange = eachDayOfInterval({ start: startDate, end: endDate });\r\n      \r\n      return dateRange.map(date => {\r\n        const dateStr = format(date, \"yyyy-MM-dd\");\r\n        const count = pageViews.filter(v => \r\n          format(new Date(v.created_at), \"yyyy-MM-dd\") === dateStr\r\n        ).length;\r\n        return { date: dateStr, views: count };\r\n      });\r\n    }\r\n  })();\r\n\r\n  // Calculate average rating\r\n  const avgRating = comments.length > 0\r\n    ? comments.filter(c => c.rating_value).reduce((sum, c) => sum + (c.rating_value || 0), 0) / \r\n      comments.filter(c => c.rating_value).length\r\n    : 0;\r\n\r\n  const localizedRestaurant = restaurant ? localizeRestaurant(restaurant) : null;\r\n\r\n  if (restaurantLoading) {\r\n    return (\r\n      <div className=\"space-y-6\">\r\n        <Skeleton className=\"h-8 w-48\" />\r\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n          {[1, 2, 3, 4].map(i => <Skeleton key={i} className=\"h-24\" />)}\r\n        </div>\r\n        <Skeleton className=\"h-64\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!restaurant || !localizedRestaurant) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-[50vh]\">\r\n        <p className=\"text-muted-foreground\">{t(\"error.notFound\")}</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\r\n        <div className=\"flex items-center gap-4\">\r\n          <Button variant=\"ghost\" size=\"icon\" asChild>\r\n            <Link to=\"/admin/restaurant-stats\">\r\n              <ChevronLeft className=\"h-5 w-5\" />\r\n            </Link>\r\n          </Button>\r\n          <div className=\"flex items-center gap-3\">\r\n            {restaurant.image_url ? (\r\n              <img \r\n                src={restaurant.image_url} \r\n                alt={localizedRestaurant.name}\r\n                className=\"w-12 h-12 rounded-lg object-cover\"\r\n              />\r\n            ) : (\r\n              <div className=\"w-12 h-12 rounded-lg bg-muted flex items-center justify-center\">\r\n                <Store className=\"h-6 w-6 text-muted-foreground\" />\r\n              </div>\r\n            )}\r\n            <div>\r\n              <h1 className=\"text-2xl font-bold\">{formatTrademarkSymbols(localizedRestaurant.name)}</h1>\r\n              {restaurant.rating > 0 && (\r\n                <div className=\"flex items-center gap-1 text-sm text-muted-foreground\">\r\n                  <Star className=\"h-3 w-3 fill-amber-400 text-amber-400\" />\r\n                  <span>{restaurant.rating.toFixed(1)}</span>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"flex items-center gap-2\">\r\n          <Calendar className=\"h-4 w-4 text-muted-foreground\" />\r\n          <Select value={timeRange} onValueChange={(v) => setTimeRange(v as TimeRange)}>\r\n            <SelectTrigger className=\"w-[140px]\">\r\n              <SelectValue />\r\n            </SelectTrigger>\r\n            <SelectContent>\r\n              <SelectItem value=\"today\">{t('analytics.today', '今日')}</SelectItem>\r\n              <SelectItem value=\"7days\">{t('analytics.last7Days', '近7天')}</SelectItem>\r\n              <SelectItem value=\"30days\">{t('analytics.last30Days', '近30天')}</SelectItem>\r\n              <SelectItem value=\"all\">{t('analytics.allTime', '所有时间')}</SelectItem>\r\n            </SelectContent>\r\n          </Select>\r\n          <Button variant=\"outline\" size=\"sm\" asChild>\r\n            <Link to={`/restaurant/${id}`} target=\"_blank\">\r\n              <ExternalLink className=\"h-4 w-4 mr-1\" />\r\n              {t('admin.preview', '预览')}\r\n            </Link>\r\n          </Button>\r\n          <Button variant=\"outline\" size=\"sm\" asChild>\r\n            <Link to=\"/admin/restaurants\" state={{ editRestaurantId: id }}>\r\n              <Edit className=\"h-4 w-4 mr-1\" />\r\n              {t('admin.edit', '编辑')}\r\n            </Link>\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Stats Cards */}\r\n      <div className=\"grid grid-cols-2 md:grid-cols-5 gap-4\">\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <div className=\"p-2 bg-blue-500/10 rounded-lg\">\r\n                <Eye className=\"h-5 w-5 text-blue-500\" />\r\n              </div>\r\n              <div>\r\n                <p className=\"text-sm text-muted-foreground\">{t('admin.views', '浏览量')}</p>\r\n                <p className=\"text-2xl font-bold\">{pageViews.length}</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <div className=\"p-2 bg-amber-500/10 rounded-lg\">\r\n                <MessageCircle className=\"h-5 w-5 text-amber-500\" />\r\n              </div>\r\n              <div>\r\n                <p className=\"text-sm text-muted-foreground\">{t('admin.comments', '评论')}</p>\r\n                <p className=\"text-2xl font-bold\">{comments.length}</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <div className=\"p-2 bg-red-500/10 rounded-lg\">\r\n                <Heart className=\"h-5 w-5 text-red-500\" />\r\n              </div>\r\n              <div>\r\n                <p className=\"text-sm text-muted-foreground\">{t('admin.favorites', '收藏')}</p>\r\n                <p className=\"text-2xl font-bold\">{favorites.length}</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <div className=\"p-2 bg-purple-500/10 rounded-lg\">\r\n                <FileText className=\"h-5 w-5 text-purple-500\" />\r\n              </div>\r\n              <div>\r\n                <p className=\"text-sm text-muted-foreground\">{t('admin.posts', '帖子')}</p>\r\n                <p className=\"text-2xl font-bold\">{posts.length}</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <div className=\"p-2 bg-green-500/10 rounded-lg\">\r\n                <Star className=\"h-5 w-5 text-green-500\" />\r\n              </div>\r\n              <div>\r\n                <p className=\"text-sm text-muted-foreground\">{t('admin.avgRating', '平均评分')}</p>\r\n                <p className=\"text-2xl font-bold\">{avgRating > 0 ? avgRating.toFixed(1) : '-'}</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* View Trend Chart */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <TrendingUp className=\"w-5 h-5\" />\r\n            {t('admin.viewTrend', '浏览趋势')}\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"h-[300px]\">\r\n            {viewTrendData.length > 0 ? (\r\n              <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                <LineChart data={viewTrendData}>\r\n                  <CartesianGrid strokeDasharray=\"3 3\" className=\"stroke-muted\" />\r\n                  <XAxis \r\n                    dataKey=\"date\" \r\n                    tickFormatter={(value) => format(new Date(value), \"MM/dd\")}\r\n                    className=\"text-xs\"\r\n                  />\r\n                  <YAxis className=\"text-xs\" />\r\n                  <Tooltip \r\n                    labelFormatter={(value) => format(new Date(value), \"yyyy-MM-dd\")}\r\n                    contentStyle={{ \r\n                      backgroundColor: \"hsl(var(--background))\", \r\n                      border: \"1px solid hsl(var(--border))\" \r\n                    }}\r\n                  />\r\n                  <Line \r\n                    type=\"monotone\" \r\n                    dataKey=\"views\" \r\n                    stroke=\"hsl(var(--primary))\" \r\n                    strokeWidth={2}\r\n                    name={t(\"admin.views\")}\r\n                  />\r\n                </LineChart>\r\n              </ResponsiveContainer>\r\n            ) : (\r\n              <div className=\"h-full flex items-center justify-center text-muted-foreground\">\r\n                {t(\"analytics.noData\")}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n        {/* Recent Comments */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center gap-2\">\r\n              <MessageCircle className=\"w-5 h-5\" />\r\n              {t('admin.recentComments', '最近评论')}\r\n            </CardTitle>\r\n            <CardDescription>\r\n              {t('admin.showingRecent', '显示最近 {{count}} 条', { count: Math.min(comments.length, 10) })}\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-4 max-h-[400px] overflow-y-auto\">\r\n              {comments.slice(0, 10).map((comment: any) => (\r\n                <div key={comment.id} className=\"flex gap-3 p-3 bg-muted/50 rounded-lg\">\r\n                  <Avatar className=\"h-8 w-8\">\r\n                    <AvatarImage src={comment.profile?.avatar_url} />\r\n                    <AvatarFallback>\r\n                      {comment.profile?.display_name?.[0] || \"?\"}\r\n                    </AvatarFallback>\r\n                  </Avatar>\r\n                  <div className=\"flex-1 min-w-0\">\r\n                    <div className=\"flex items-center gap-2 mb-1\">\r\n                      <span className=\"font-medium text-sm\">\r\n                        {comment.profile?.display_name || t(\"common.anonymous\")}\r\n                      </span>\r\n                      {comment.rating_value && (\r\n                        <Badge variant=\"secondary\" className=\"text-xs\">\r\n                          <Star className=\"h-3 w-3 mr-1 fill-amber-400 text-amber-400\" />\r\n                          {comment.rating_value}\r\n                        </Badge>\r\n                      )}\r\n                    </div>\r\n                    <p className=\"text-sm text-muted-foreground line-clamp-2\">{comment.content}</p>\r\n                    <p className=\"text-xs text-muted-foreground mt-1\">\r\n                      {format(new Date(comment.created_at), \"yyyy-MM-dd HH:mm\")}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n              {comments.length === 0 && (\r\n                <p className=\"text-center text-muted-foreground py-8\">\r\n                  {t(\"admin.noComments\", \"暂无评论\")}\r\n                </p>\r\n              )}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Recent Favorites */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center gap-2\">\r\n              <Heart className=\"w-5 h-5\" />\r\n              {t('admin.recentFavorites', '最近收藏')}\r\n            </CardTitle>\r\n            <CardDescription>\r\n              {t('admin.showingRecent', '显示最近 {{count}} 条', { count: Math.min(favorites.length, 10) })}\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-3 max-h-[400px] overflow-y-auto\">\r\n              {favorites.slice(0, 10).map((favorite: any, index: number) => (\r\n                <div key={index} className=\"flex items-center gap-3 p-3 bg-muted/50 rounded-lg\">\r\n                  <Avatar className=\"h-8 w-8\">\r\n                    <AvatarImage src={favorite.profile?.avatar_url} />\r\n                    <AvatarFallback>\r\n                      {favorite.profile?.display_name?.[0] || \"?\"}\r\n                    </AvatarFallback>\r\n                  </Avatar>\r\n                  <div className=\"flex-1 min-w-0\">\r\n                    <span className=\"font-medium text-sm\">\r\n                      {favorite.profile?.display_name || t(\"common.anonymous\")}\r\n                    </span>\r\n                    <p className=\"text-xs text-muted-foreground\">\r\n                      {format(new Date(favorite.created_at), \"yyyy-MM-dd HH:mm\")}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n              {favorites.length === 0 && (\r\n                <p className=\"text-center text-muted-foreground py-8\">\r\n                  {t(\"admin.noFavorites\", \"暂无收藏\")}\r\n                </p>\r\n              )}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Recent Posts */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center gap-2\">\r\n              <FileText className=\"w-5 h-5\" />\r\n              {t('admin.recentPosts', '最近帖子')}\r\n            </CardTitle>\r\n            <CardDescription>\r\n              {t('admin.showingRecent', '显示最近 {{count}} 条', { count: Math.min(posts.length, 10) })}\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"space-y-4 max-h-[400px] overflow-y-auto\">\r\n              {posts.slice(0, 10).map((post: any) => (\r\n                <Link \r\n                  key={post.id} \r\n                  to={`/post/${post.id}`}\r\n                  className=\"flex gap-3 p-3 bg-muted/50 rounded-lg hover:bg-muted/70 transition-colors block\"\r\n                >\r\n                  <Avatar className=\"h-8 w-8\">\r\n                    <AvatarImage src={post.profile?.avatar_url} />\r\n                    <AvatarFallback>\r\n                      {post.profile?.display_name?.[0] || \"?\"}\r\n                    </AvatarFallback>\r\n                  </Avatar>\r\n                  <div className=\"flex-1 min-w-0\">\r\n                    <div className=\"flex items-center gap-2 mb-1\">\r\n                      <span className=\"font-medium text-sm\">\r\n                        {post.profile?.display_name || t(\"common.anonymous\")}\r\n                      </span>\r\n                      <Badge variant={post.status === 'approved' ? 'default' : 'secondary'} className=\"text-xs\">\r\n                        {post.status === 'approved' ? t('admin.published', '已发布') : post.status}\r\n                      </Badge>\r\n                    </div>\r\n                    <p className=\"text-sm text-muted-foreground line-clamp-2\">{post.content?.replace(/<[^>]*>/g, '')}</p>\r\n                    <div className=\"flex items-center gap-3 mt-1 text-xs text-muted-foreground\">\r\n                      <span className=\"flex items-center gap-1\">\r\n                        <Eye className=\"h-3 w-3\" />\r\n                        {post.views_count || 0}\r\n                      </span>\r\n                      <span className=\"flex items-center gap-1\">\r\n                        <Heart className=\"h-3 w-3\" />\r\n                        {post.likes_count || 0}\r\n                      </span>\r\n                      <span className=\"flex items-center gap-1\">\r\n                        <MessageCircle className=\"h-3 w-3\" />\r\n                        {post.comments_count || 0}\r\n                      </span>\r\n                      <span>{format(new Date(post.created_at), \"MM-dd HH:mm\")}</span>\r\n                    </div>\r\n                  </div>\r\n                </Link>\r\n              ))}\r\n              {posts.length === 0 && (\r\n                <p className=\"text-center text-muted-foreground py-8\">\r\n                  {t(\"admin.noPosts\", \"暂无帖子\")}\r\n                </p>\r\n              )}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Participating Activities */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Calendar className=\"w-5 h-5\" />\r\n            {t('admin.participatingActivities', '参与的活动')}\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n            {activities.map((activity: any) => (\r\n              <div \r\n                key={activity.id} \r\n                className=\"p-4 border rounded-lg bg-card hover:shadow-md transition-shadow\"\r\n              >\r\n                <div className=\"flex items-center justify-between mb-2\">\r\n                  <h4 className=\"font-medium line-clamp-1\">\r\n                    {activity.title_zh || activity.title_en}\r\n                  </h4>\r\n                  <Badge variant={activity.status === 'published' ? 'default' : 'secondary'}>\r\n                    {activity.status === 'published' ? t('admin.published', '已发布') : t('admin.draft', '草稿')}\r\n                  </Badge>\r\n                </div>\r\n                <Button variant=\"outline\" size=\"sm\" className=\"w-full\" asChild>\r\n                  <Link to={`/admin/activity-stats/${activity.id}`}>\r\n                    {t('admin.viewStats', '查看统计')}\r\n                  </Link>\r\n                </Button>\r\n              </div>\r\n            ))}\r\n            {activities.length === 0 && (\r\n              <p className=\"text-muted-foreground col-span-full text-center py-8\">\r\n                {t(\"admin.noActivities\", \"暂未参与活动\")}\r\n              </p>\r\n            )}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdminRestaurantStats;\r\n"],"names":["AdminRestaurantStats","id","useParams","useTranslation","localizeRestaurant","useLocalizedContent","timeRange","setTimeRange","useState","getDateFilter","now","startOfDay","subDays","getChartDays","restaurant","restaurantLoading","useRestaurant","dateFilter","pageViews","viewsLoading","useQuery","fetchAllPaginated","query","comments","commentsLoading","data","userIds","c","profiles","supabase","p","favorites","favoritesLoading","f","posts","postsLoading","pr","activities","error","ar","viewTrendData","endDate","startDate","eachDayOfInterval","date","dateStr","format","count","v","days","avgRating","sum","localizedRestaurant","jsxs","jsx","Skeleton","i","Button","Link","ChevronLeft","Store","formatTrademarkSymbols","Star","Calendar","Select","SelectTrigger","SelectValue","SelectContent","SelectItem","ExternalLink","Edit","Card","CardContent","Eye","MessageCircle","Heart","FileText","CardHeader","CardTitle","TrendingUp","ResponsiveContainer","LineChart","CartesianGrid","XAxis","value","YAxis","Tooltip","Line","CardDescription","comment","Avatar","AvatarImage","AvatarFallback","Badge","favorite","index","post","activity"],"mappings":"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"}