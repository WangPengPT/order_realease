{"version":3,"file":"AdminJoinRequests-Bd50GlKi.js","sources":["../../src/pages/admin/AdminJoinRequests.tsx"],"sourcesContent":["import { useTranslation } from \"react-i18next\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { formatDistanceToNow, format } from \"date-fns\";\r\nimport { Mail, Phone, Store, MapPin, Download, Search, Trash2, Filter, Send, Eye, Ticket, UserCircle, Clock, CheckCircle2 } from \"lucide-react\";\r\nimport { useState, useEffect } from \"react\";\r\nimport { toast } from \"@/hooks/use-toast\";\r\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from \"@/components/ui/alert-dialog\";\r\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\r\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger } from \"@/components/ui/dropdown-menu\";\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\r\nimport { Switch } from \"@/components/ui/switch\";\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\r\nimport { Separator } from \"@/components/ui/separator\";\r\n\r\nconst STATUS_OPTIONS = [\"pending\", \"received\", \"completed\", \"cancelled\"] as const;\r\n\r\nconst AdminJoinRequests = () => {\r\n  const { t } = useTranslation();\r\n  const [search, setSearch] = useState(\"\");\r\n  const [statusFilter, setStatusFilter] = useState<string>(\"all\");\r\n  const [deleteId, setDeleteId] = useState<string | null>(null);\r\n  const [emailDialogOpen, setEmailDialogOpen] = useState(false);\r\n  const [detailDialogOpen, setDetailDialogOpen] = useState(false);\r\n  const [selectedRequest, setSelectedRequest] = useState<any>(null);\r\n  const [merchantAccount, setMerchantAccount] = useState(\"\");\r\n  const [merchantPassword, setMerchantPassword] = useState(\"\");\r\n  const [sendingEmail, setSendingEmail] = useState(false);\r\n  const [creatingUser, setCreatingUser] = useState(false);\r\n  const [emailOnlyMode, setEmailOnlyMode] = useState(false);\r\n  const queryClient = useQueryClient();\r\n\r\n  const { data: joinRequests, isLoading } = useQuery({\r\n    queryKey: [\"joinRequests\"],\r\n    queryFn: async () => {\r\n      const { data, error } = await supabase\r\n        .from(\"join_requests\")\r\n        .select(\"*\")\r\n        .order(\"created_at\", { ascending: false });\r\n\r\n      if (error) throw error;\r\n\r\n      // Get inviter profile names for requests with invitation codes\r\n      const inviterIds = data?.map(r => r.invited_by_user_id).filter(Boolean) || [];\r\n      let inviterProfiles: Record<string, string> = {};\r\n      \r\n      if (inviterIds.length > 0) {\r\n        const { data: profiles } = await supabase\r\n          .from(\"profiles\")\r\n          .select(\"id, display_name\")\r\n          .in(\"id\", inviterIds);\r\n        \r\n        if (profiles) {\r\n          inviterProfiles = profiles.reduce((acc, p) => {\r\n            acc[p.id] = p.display_name || '';\r\n            return acc;\r\n          }, {} as Record<string, string>);\r\n        }\r\n      }\r\n\r\n      // Merge inviter names into requests\r\n      return data?.map(request => ({\r\n        ...request,\r\n        inviter_name: request.invited_by_user_id ? inviterProfiles[request.invited_by_user_id] : null\r\n      })) || [];\r\n    },\r\n  });\r\n\r\n  const { data: emailConfig } = useQuery({\r\n    queryKey: [\"emailConfig\", \"join_request\"],\r\n    queryFn: async () => {\r\n      const { data, error } = await supabase\r\n        .from(\"email_config\")\r\n        .select(\"*\")\r\n        .eq(\"type\", \"join_request\")\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      return data;\r\n    },\r\n  });\r\n\r\n  const { data: siteSettings } = useQuery({\r\n    queryKey: [\"siteSettings\"],\r\n    queryFn: async () => {\r\n      const { data, error } = await supabase\r\n        .from(\"site_settings\")\r\n        .select(\"logo_url\")\r\n        .single();\r\n\r\n      if (error) throw error;\r\n      return data;\r\n    },\r\n  });\r\n\r\n  // Realtime subscription for join_requests status updates\r\n  useEffect(() => {\r\n    const channel = supabase\r\n      .channel('join_requests_changes')\r\n      .on(\r\n        'postgres_changes',\r\n        {\r\n          event: '*',\r\n          schema: 'public',\r\n          table: 'join_requests'\r\n        },\r\n        () => {\r\n          queryClient.invalidateQueries({ queryKey: [\"joinRequests\"] });\r\n        }\r\n      )\r\n      .subscribe();\r\n\r\n    return () => {\r\n      supabase.removeChannel(channel);\r\n    };\r\n  }, [queryClient]);\r\n\r\n  const filteredRequests = joinRequests?.filter((request) => {\r\n    const searchLower = search.toLowerCase();\r\n    const matchesSearch = \r\n      request.name.toLowerCase().includes(searchLower) ||\r\n      request.email.toLowerCase().includes(searchLower) ||\r\n      request.restaurant_name.toLowerCase().includes(searchLower) ||\r\n      request.phone.toLowerCase().includes(searchLower);\r\n    \r\n    const matchesStatus = statusFilter === \"all\" || request.status === statusFilter;\r\n    \r\n    return matchesSearch && matchesStatus;\r\n  });\r\n\r\n  const handleUpdateEmail = async () => {\r\n    const newEmail = prompt(t(\"joinUs.enterNewEmail\"), emailConfig?.recipient_email);\r\n    if (!newEmail) return;\r\n\r\n    try {\r\n      const { error } = await supabase\r\n        .from(\"email_config\")\r\n        .update({ recipient_email: newEmail })\r\n        .eq(\"id\", emailConfig?.id);\r\n\r\n      if (error) throw error;\r\n\r\n      toast({\r\n        title: t(\"common.success\"),\r\n        description: t(\"joinUs.emailUpdated\"),\r\n      });\r\n    } catch (error) {\r\n      console.error(\"Error updating email:\", error);\r\n      toast({\r\n        title: t(\"common.error\"),\r\n        description: t(\"joinUs.emailUpdateError\"),\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  };\r\n\r\n  const updateStatusMutation = useMutation({\r\n    mutationFn: async ({ id, status }: { id: string; status: string }) => {\r\n      const { error } = await supabase\r\n        .from(\"join_requests\")\r\n        .update({ status })\r\n        .eq(\"id\", id);\r\n      \r\n      if (error) throw error;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: [\"joinRequests\"] });\r\n      toast({\r\n        title: t(\"common.success\"),\r\n        description: t(\"joinUs.statusUpdated\"),\r\n      });\r\n    },\r\n    onError: (error) => {\r\n      console.error(\"Error updating status:\", error);\r\n      toast({\r\n        title: t(\"common.error\"),\r\n        description: t(\"joinUs.statusUpdateError\"),\r\n        variant: \"destructive\",\r\n      });\r\n    },\r\n  });\r\n\r\n  const deleteMutation = useMutation({\r\n    mutationFn: async (id: string) => {\r\n      const { error } = await supabase\r\n        .from(\"join_requests\")\r\n        .delete()\r\n        .eq(\"id\", id);\r\n      \r\n      if (error) throw error;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: [\"joinRequests\"] });\r\n      toast({\r\n        title: t(\"common.success\"),\r\n        description: t(\"joinUs.requestDeleted\"),\r\n      });\r\n      setDeleteId(null);\r\n    },\r\n    onError: (error) => {\r\n      console.error(\"Error deleting request:\", error);\r\n      toast({\r\n        title: t(\"common.error\"),\r\n        description: t(\"joinUs.deleteError\"),\r\n        variant: \"destructive\",\r\n      });\r\n    },\r\n  });\r\n\r\n  const handleExport = () => {\r\n    if (!filteredRequests || filteredRequests.length === 0) {\r\n      toast({\r\n        title: t(\"admin.noDataToExport\"),\r\n        variant: \"destructive\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    const csvContent = [\r\n      [\"Name\", \"Email\", \"Phone\", \"Restaurant Name\", \"Restaurant Address\", \"Features\", \"Invitation Code\", \"Invited By\", \"Status\", \"Submitted Date\"],\r\n      ...filteredRequests.map((request) => [\r\n        request.name,\r\n        request.email,\r\n        request.phone,\r\n        request.restaurant_name,\r\n        request.restaurant_address || \"\",\r\n        Array.isArray(request.features_selected) ? request.features_selected.join(\", \") : \"\",\r\n        request.invitation_code || \"\",\r\n        request.inviter_name || \"\",\r\n        request.status || \"pending\",\r\n        new Date(request.created_at).toLocaleString(),\r\n      ]),\r\n    ]\r\n      .map((row) => row.map((cell) => `\"${cell}\"`).join(\",\"))\r\n      .join(\"\\n\");\r\n\r\n    const blob = new Blob([csvContent], { type: \"text/csv;charset=utf-8;\" });\r\n    const link = document.createElement(\"a\");\r\n    const url = URL.createObjectURL(blob);\r\n    link.setAttribute(\"href\", url);\r\n    link.setAttribute(\"download\", `join_requests_${new Date().toISOString()}.csv`);\r\n    link.click();\r\n    URL.revokeObjectURL(url);\r\n\r\n    toast({\r\n      title: t(\"admin.exportSuccess\"),\r\n    });\r\n  };\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case \"completed\":\r\n        return \"default\";\r\n      case \"received\":\r\n        return \"secondary\";\r\n      case \"cancelled\":\r\n        return \"destructive\";\r\n      default:\r\n        return \"outline\";\r\n    }\r\n  };\r\n\r\n  const openEmailDialog = (request: any) => {\r\n    setSelectedRequest(request);\r\n    setMerchantAccount(request.email);\r\n    setMerchantPassword(\"\");\r\n    setEmailOnlyMode(false);\r\n    setEmailDialogOpen(true);\r\n  };\r\n\r\n  const openDetailDialog = (request: any) => {\r\n    setSelectedRequest(request);\r\n    setDetailDialogOpen(true);\r\n  };\r\n\r\n  const handleSendEmail = async () => {\r\n    if (!selectedRequest || !merchantAccount.trim() || !merchantPassword.trim()) {\r\n      toast({\r\n        title: t(\"common.error\"),\r\n        description: t(\"joinUs.accountPasswordRequired\"),\r\n        variant: \"destructive\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    // Validate password length\r\n    if (merchantPassword.length < 6) {\r\n      toast({\r\n        title: t(\"common.error\"),\r\n        description: t(\"auth.passwordTooShort\"),\r\n        variant: \"destructive\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Email-only mode: skip user creation\r\n      if (emailOnlyMode) {\r\n        setSendingEmail(true);\r\n        \r\n        const emailSubject = `【小熊市场】您的商家账号信息 - ${selectedRequest.restaurant_name}`;\r\n        const emailContent = `您的商家账号信息如下！`;\r\n\r\n        const { data, error } = await supabase.functions.invoke(\"send-merchant-email\", {\r\n          body: {\r\n            to: selectedRequest.email,\r\n            subject: emailSubject,\r\n            content: emailContent,\r\n            merchantName: selectedRequest.name,\r\n            account: merchantAccount,\r\n            password: merchantPassword,\r\n            logoUrl: siteSettings?.logo_url || null,\r\n          },\r\n        });\r\n\r\n        if (error) throw error;\r\n        if (!data.success) throw new Error(data.error);\r\n\r\n        // Update email_sent_at after email sent successfully\r\n        await supabase\r\n          .from(\"join_requests\")\r\n          .update({ \r\n            email_sent_at: new Date().toISOString()\r\n          })\r\n          .eq(\"id\", selectedRequest.id);\r\n\r\n        queryClient.invalidateQueries({ queryKey: [\"joinRequests\"] });\r\n\r\n        toast({\r\n          title: t(\"common.success\"),\r\n          description: t(\"joinUs.emailSentSuccess\"),\r\n        });\r\n        setEmailDialogOpen(false);\r\n        return;\r\n      }\r\n\r\n      // Create user mode\r\n      setCreatingUser(true);\r\n      \r\n      // Step 1: Create merchant user first\r\n      const { data: sessionData } = await supabase.auth.getSession();\r\n      \r\n      // Verify session exists\r\n      if (!sessionData?.session) {\r\n        toast({\r\n          title: t(\"common.error\"),\r\n          description: t(\"auth.sessionExpired\"),\r\n          variant: \"destructive\",\r\n        });\r\n        setCreatingUser(false);\r\n        return;\r\n      }\r\n\r\n      const { data: createData, error: createError } = await supabase.functions.invoke(\"admin-create-user\", {\r\n        body: {\r\n          email: merchantAccount,\r\n          password: merchantPassword,\r\n          displayName: selectedRequest.name,\r\n          phone: selectedRequest.phone,\r\n          role: \"merchant\",\r\n        },\r\n      });\r\n\r\n      // Check for network/function invocation error\r\n      if (createError) {\r\n        console.error(\"Create user function error:\", createError);\r\n        toast({\r\n          title: t(\"common.error\"),\r\n          description: createError.message || t(\"admin.createUserError\"),\r\n          variant: \"destructive\",\r\n        });\r\n        setCreatingUser(false);\r\n        return;\r\n      }\r\n\r\n      // Check for business logic error returned from edge function\r\n      if (createData?.error) {\r\n        console.error(\"Create user business error:\", createData.error);\r\n        toast({\r\n          title: t(\"common.error\"),\r\n          description: createData.error,\r\n          variant: \"destructive\",\r\n        });\r\n        setCreatingUser(false);\r\n        return;\r\n      }\r\n\r\n      // Verify user was actually created\r\n      if (!createData?.success || !createData?.user) {\r\n        console.error(\"User creation failed - no user returned\");\r\n        toast({\r\n          title: t(\"common.error\"),\r\n          description: t(\"admin.createUserError\"),\r\n          variant: \"destructive\",\r\n        });\r\n        setCreatingUser(false);\r\n        return;\r\n      }\r\n\r\n      toast({\r\n        title: t(\"common.success\"),\r\n        description: t(\"joinUs.merchantUserCreated\"),\r\n      });\r\n\r\n      setCreatingUser(false);\r\n      setSendingEmail(true);\r\n\r\n      // Step 2: Send email to merchant (only if user creation succeeded)\r\n      const emailSubject = `【小熊市场】您的商家账号已创建 - ${selectedRequest.restaurant_name}`;\r\n      const emailContent = `您的商家账号已创建成功！`;\r\n\r\n      const { data, error } = await supabase.functions.invoke(\"send-merchant-email\", {\r\n        body: {\r\n          to: selectedRequest.email,\r\n          subject: emailSubject,\r\n          content: emailContent,\r\n          merchantName: selectedRequest.name,\r\n          account: merchantAccount,\r\n          password: merchantPassword,\r\n          logoUrl: siteSettings?.logo_url || null,\r\n        },\r\n      });\r\n\r\n      if (error) throw error;\r\n      if (!data.success) throw new Error(data.error);\r\n\r\n      // Update status to \"received\" and record email_sent_at after email sent successfully\r\n      await supabase\r\n        .from(\"join_requests\")\r\n        .update({ \r\n          status: \"received\",\r\n          email_sent_at: new Date().toISOString()\r\n        })\r\n        .eq(\"id\", selectedRequest.id);\r\n\r\n      queryClient.invalidateQueries({ queryKey: [\"joinRequests\"] });\r\n\r\n      toast({\r\n        title: t(\"common.success\"),\r\n        description: t(\"joinUs.emailSentSuccess\"),\r\n      });\r\n      setEmailDialogOpen(false);\r\n    } catch (error: any) {\r\n      console.error(\"Error:\", error);\r\n      toast({\r\n        title: t(\"common.error\"),\r\n        description: error.message || t(\"joinUs.emailSendError\"),\r\n        variant: \"destructive\",\r\n      });\r\n    } finally {\r\n      setCreatingUser(false);\r\n      setSendingEmail(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className=\"space-y-6\">\r\n        <div>\r\n          <h2 className=\"text-3xl font-bold\">{t(\"joinUs.adminTitle\")}</h2>\r\n          <p className=\"text-muted-foreground mt-2\">{t(\"joinUs.adminDescription\")}</p>\r\n        </div>\r\n\r\n        <div className=\"grid gap-4 md:grid-cols-2\">\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>{t(\"joinUs.recipientEmail\")}</CardTitle>\r\n              <CardDescription>{t(\"joinUs.recipientEmailDesc\")}</CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"flex items-center gap-4\">\r\n                <Input value={emailConfig?.recipient_email || \"\"} readOnly />\r\n                <Button onClick={handleUpdateEmail}>{t(\"common.edit\")}</Button>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>{t(\"joinUs.totalRequests\")}</CardTitle>\r\n              <CardDescription>{t(\"joinUs.totalRequestsDesc\")}</CardDescription>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <div className=\"text-3xl font-bold\">{joinRequests?.length || 0}</div>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n\r\n        <Card>\r\n          <CardHeader>\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <CardTitle>{t(\"joinUs.allRequests\")}</CardTitle>\r\n                <CardDescription>{t(\"joinUs.allRequestsDesc\")}</CardDescription>\r\n              </div>\r\n              <Button onClick={handleExport} variant=\"outline\">\r\n                <Download className=\"w-4 h-4 mr-2\" />\r\n                {t(\"admin.exportCSV\")}\r\n              </Button>\r\n            </div>\r\n            <div className=\"flex items-center gap-4 mt-4\">\r\n              <div className=\"relative flex-1\">\r\n                <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground\" />\r\n                <Input\r\n                  placeholder={t(\"joinUs.searchPlaceholder\")}\r\n                  value={search}\r\n                  onChange={(e) => setSearch(e.target.value)}\r\n                  className=\"pl-10\"\r\n                />\r\n              </div>\r\n              <DropdownMenu>\r\n                <DropdownMenuTrigger asChild>\r\n                  <Button variant=\"outline\" className=\"gap-2\">\r\n                    <Filter className=\"w-4 h-4\" />\r\n                    {statusFilter === \"all\" \r\n                      ? t(\"admin.allStatus\") \r\n                      : t(`joinUs.status.${statusFilter}`)}\r\n                  </Button>\r\n                </DropdownMenuTrigger>\r\n                <DropdownMenuContent align=\"end\" className=\"bg-background\">\r\n                  <DropdownMenuItem onClick={() => setStatusFilter(\"all\")}>\r\n                    {t(\"admin.allStatus\")}\r\n                  </DropdownMenuItem>\r\n                  {STATUS_OPTIONS.map((status) => (\r\n                    <DropdownMenuItem key={status} onClick={() => setStatusFilter(status)}>\r\n                      {t(`joinUs.status.${status}`)}\r\n                    </DropdownMenuItem>\r\n                  ))}\r\n                </DropdownMenuContent>\r\n              </DropdownMenu>\r\n            </div>\r\n          </CardHeader>\r\n          <CardContent>\r\n            {isLoading ? (\r\n              <div className=\"text-center py-8 text-muted-foreground\">{t(\"common.loading\")}</div>\r\n            ) : filteredRequests && filteredRequests.length > 0 ? (\r\n              <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\r\n                {filteredRequests.map((request) => (\r\n                  <Card key={request.id} className=\"relative overflow-hidden hover:shadow-md transition-shadow\">\r\n                    {/* Status badge at top right */}\r\n                    <div className=\"absolute top-3 right-3\">\r\n                      <Badge variant={getStatusColor(request.status || \"pending\")}>\r\n                        {t(`joinUs.status.${request.status || \"pending\"}`)}\r\n                      </Badge>\r\n                    </div>\r\n                    \r\n                    <CardContent className=\"pt-6\">\r\n                      {/* Header: Name & Restaurant */}\r\n                      <div className=\"mb-4\">\r\n                        <h3 className=\"font-semibold text-lg truncate pr-20\">{request.name}</h3>\r\n                        <div className=\"flex items-center gap-2 text-sm text-muted-foreground mt-1\">\r\n                          <Store className=\"w-3.5 h-3.5 flex-shrink-0\" />\r\n                          <span className=\"truncate\">{request.restaurant_name}</span>\r\n                        </div>\r\n                      </div>\r\n                      \r\n                      {/* Contact info */}\r\n                      <div className=\"space-y-2 mb-4\">\r\n                        <div className=\"flex items-center gap-2 text-sm\">\r\n                          <Mail className=\"w-3.5 h-3.5 text-muted-foreground flex-shrink-0\" />\r\n                          <span className=\"truncate\">{request.email}</span>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2 text-sm\">\r\n                          <Phone className=\"w-3.5 h-3.5 text-muted-foreground flex-shrink-0\" />\r\n                          <span>{request.phone}</span>\r\n                        </div>\r\n                      </div>\r\n                      \r\n                      {/* Time & Invitation code */}\r\n                      <div className=\"flex items-center justify-between text-xs text-muted-foreground mb-4\">\r\n                        <div className=\"flex items-center gap-1.5\">\r\n                          <Clock className=\"w-3 h-3\" />\r\n                          <span>{formatDistanceToNow(new Date(request.created_at), { addSuffix: true })}</span>\r\n                        </div>\r\n                        {request.invitation_code && (\r\n                          <div className=\"flex items-center gap-1.5\">\r\n                            <Ticket className=\"w-3 h-3\" />\r\n                            <code className=\"text-xs bg-muted px-1 py-0.5 rounded\">{request.invitation_code}</code>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                      \r\n                      {/* Email sent indicator */}\r\n                      {request.email_sent_at && (\r\n                        <div className=\"flex items-center gap-1.5 text-xs text-green-600 dark:text-green-400 mb-4\">\r\n                          <CheckCircle2 className=\"w-3 h-3\" />\r\n                          <span>{t(\"joinUs.emailSent\", \"邮件已发送\")}</span>\r\n                        </div>\r\n                      )}\r\n                      \r\n                      <Separator className=\"my-3\" />\r\n                      \r\n                      {/* Action buttons */}\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <Button\r\n                          size=\"sm\"\r\n                          variant=\"outline\"\r\n                          className=\"flex-1\"\r\n                          onClick={() => openDetailDialog(request)}\r\n                        >\r\n                          <Eye className=\"w-4 h-4 mr-1.5\" />\r\n                          {t(\"common.viewDetails\", \"查看详情\")}\r\n                        </Button>\r\n                        <Button\r\n                          size=\"sm\"\r\n                          variant=\"outline\"\r\n                          onClick={() => openEmailDialog(request)}\r\n                          title={t(\"joinUs.sendEmail\")}\r\n                        >\r\n                          <Send className=\"w-4 h-4\" />\r\n                        </Button>\r\n                        <Button\r\n                          size=\"sm\"\r\n                          variant=\"destructive\"\r\n                          onClick={() => setDeleteId(request.id)}\r\n                          disabled={deleteMutation.isPending}\r\n                        >\r\n                          <Trash2 className=\"w-4 h-4\" />\r\n                        </Button>\r\n                      </div>\r\n                    </CardContent>\r\n                  </Card>\r\n                ))}\r\n              </div>\r\n            ) : (\r\n              <div className=\"text-center py-8 text-muted-foreground\">{t(\"joinUs.noRequests\")}</div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Detail Dialog */}\r\n      <Dialog open={detailDialogOpen} onOpenChange={setDetailDialogOpen}>\r\n        <DialogContent className=\"sm:max-w-[600px] max-h-[85vh]\">\r\n          <DialogHeader>\r\n            <DialogTitle className=\"flex items-center gap-2\">\r\n              <Store className=\"w-5 h-5\" />\r\n              {selectedRequest?.restaurant_name}\r\n            </DialogTitle>\r\n            <DialogDescription>\r\n              {t(\"joinUs.requestDetail\", \"申请详情\")}\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          \r\n          <ScrollArea className=\"max-h-[60vh] pr-4\">\r\n            {selectedRequest && (\r\n              <div className=\"space-y-6\">\r\n                {/* Status */}\r\n                <div className=\"flex items-center justify-between\">\r\n                  <span className=\"text-sm font-medium text-muted-foreground\">{t(\"joinUs.status\")}</span>\r\n                  <Select\r\n                    value={selectedRequest.status || \"pending\"}\r\n                    onValueChange={(value) => {\r\n                      updateStatusMutation.mutate({ id: selectedRequest.id, status: value });\r\n                      setSelectedRequest({ ...selectedRequest, status: value });\r\n                    }}\r\n                    disabled={updateStatusMutation.isPending}\r\n                  >\r\n                    <SelectTrigger className=\"w-[150px]\">\r\n                      <SelectValue>\r\n                        <Badge variant={getStatusColor(selectedRequest.status || \"pending\")}>\r\n                          {t(`joinUs.status.${selectedRequest.status || \"pending\"}`)}\r\n                        </Badge>\r\n                      </SelectValue>\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      {STATUS_OPTIONS.map((status) => (\r\n                        <SelectItem key={status} value={status}>\r\n                          <Badge variant={getStatusColor(status)}>\r\n                            {t(`joinUs.status.${status}`)}\r\n                          </Badge>\r\n                        </SelectItem>\r\n                      ))}\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n                \r\n                <Separator />\r\n                \r\n                {/* Contact Info Section */}\r\n                <div>\r\n                  <h4 className=\"font-medium mb-3\">{t(\"joinUs.contactInfo\", \"联系信息\")}</h4>\r\n                  <div className=\"space-y-3\">\r\n                    <div className=\"flex items-start gap-3\">\r\n                      <UserCircle className=\"w-4 h-4 text-muted-foreground mt-0.5\" />\r\n                      <div>\r\n                        <p className=\"text-sm font-medium\">{selectedRequest.name}</p>\r\n                        <p className=\"text-xs text-muted-foreground\">{t(\"joinUs.name\")}</p>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex items-start gap-3\">\r\n                      <Mail className=\"w-4 h-4 text-muted-foreground mt-0.5\" />\r\n                      <div>\r\n                        <a href={`mailto:${selectedRequest.email}`} className=\"text-sm font-medium hover:underline\">\r\n                          {selectedRequest.email}\r\n                        </a>\r\n                        <p className=\"text-xs text-muted-foreground\">{t(\"joinUs.email\")}</p>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex items-start gap-3\">\r\n                      <Phone className=\"w-4 h-4 text-muted-foreground mt-0.5\" />\r\n                      <div>\r\n                        <a href={`tel:${selectedRequest.phone}`} className=\"text-sm font-medium hover:underline\">\r\n                          {selectedRequest.phone}\r\n                        </a>\r\n                        <p className=\"text-xs text-muted-foreground\">{t(\"joinUs.phone\")}</p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                \r\n                <Separator />\r\n                \r\n                {/* Restaurant Info Section */}\r\n                <div>\r\n                  <h4 className=\"font-medium mb-3\">{t(\"joinUs.restaurantInfo\", \"餐厅信息\")}</h4>\r\n                  <div className=\"space-y-3\">\r\n                    <div className=\"flex items-start gap-3\">\r\n                      <Store className=\"w-4 h-4 text-muted-foreground mt-0.5\" />\r\n                      <div>\r\n                        <p className=\"text-sm font-medium\">{selectedRequest.restaurant_name}</p>\r\n                        <p className=\"text-xs text-muted-foreground\">{t(\"joinUs.restaurantName\")}</p>\r\n                      </div>\r\n                    </div>\r\n                    {selectedRequest.restaurant_address && (\r\n                      <div className=\"flex items-start gap-3\">\r\n                        <MapPin className=\"w-4 h-4 text-muted-foreground mt-0.5\" />\r\n                        <div>\r\n                          <p className=\"text-sm font-medium\">{selectedRequest.restaurant_address}</p>\r\n                          <p className=\"text-xs text-muted-foreground\">{t(\"joinUs.restaurantAddress\")}</p>\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n                \r\n                <Separator />\r\n                \r\n                {/* Features Section */}\r\n                <div>\r\n                  <h4 className=\"font-medium mb-3\">{t(\"joinUs.featuresNeeded\")}</h4>\r\n                  <div className=\"flex flex-wrap gap-2\">\r\n                    {Array.isArray(selectedRequest.features_selected) &&\r\n                      selectedRequest.features_selected.map((feature: string, idx: number) => (\r\n                        <Badge key={idx} variant=\"secondary\">\r\n                          {t(`joinUs.feature.${feature}`)}\r\n                        </Badge>\r\n                      ))}\r\n                    {(!selectedRequest.features_selected || selectedRequest.features_selected.length === 0) && (\r\n                      <span className=\"text-sm text-muted-foreground\">-</span>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n                \r\n                {/* Invitation Code Section */}\r\n                {selectedRequest.invitation_code && (\r\n                  <>\r\n                    <Separator />\r\n                    <div>\r\n                      <h4 className=\"font-medium mb-3\">{t(\"joinUs.invitationCode\", \"邀请码\")}</h4>\r\n                      <div className=\"space-y-2\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <Ticket className=\"w-4 h-4 text-muted-foreground\" />\r\n                          <code className=\"text-sm bg-muted px-2 py-1 rounded\">\r\n                            {selectedRequest.invitation_code}\r\n                          </code>\r\n                        </div>\r\n                        {selectedRequest.inviter_name && (\r\n                          <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n                            <UserCircle className=\"w-4 h-4\" />\r\n                            {t(\"joinUs.invitedBy\", \"邀请人\")}: {selectedRequest.inviter_name}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </>\r\n                )}\r\n                \r\n                <Separator />\r\n                \r\n                {/* Timestamps Section */}\r\n                <div>\r\n                  <h4 className=\"font-medium mb-3\">{t(\"joinUs.timestamps\", \"时间信息\")}</h4>\r\n                  <div className=\"space-y-2 text-sm\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <span className=\"text-muted-foreground\">{t(\"joinUs.submittedAt\")}</span>\r\n                      <span>{format(new Date(selectedRequest.created_at), \"yyyy-MM-dd HH:mm\")}</span>\r\n                    </div>\r\n                    {selectedRequest.email_sent_at && (\r\n                      <div className=\"flex items-center justify-between\">\r\n                        <span className=\"text-muted-foreground\">{t(\"joinUs.emailSentAt\", \"邮件发送时间\")}</span>\r\n                        <div className=\"flex items-center gap-1.5 text-green-600 dark:text-green-400\">\r\n                          <CheckCircle2 className=\"w-3.5 h-3.5\" />\r\n                          <span>{format(new Date(selectedRequest.email_sent_at), \"yyyy-MM-dd HH:mm\")}</span>\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </ScrollArea>\r\n          \r\n          <DialogFooter className=\"flex-row gap-2 sm:justify-between\">\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => {\r\n                setDetailDialogOpen(false);\r\n                openEmailDialog(selectedRequest);\r\n              }}\r\n            >\r\n              <Send className=\"w-4 h-4 mr-2\" />\r\n              {t(\"joinUs.sendEmail\")}\r\n            </Button>\r\n            <Button onClick={() => setDetailDialogOpen(false)}>\r\n              {t(\"common.close\", \"关闭\")}\r\n            </Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Delete Confirmation Dialog */}\r\n      <AlertDialog open={deleteId !== null} onOpenChange={(open) => !open && setDeleteId(null)}>\r\n        <AlertDialogContent>\r\n          <AlertDialogHeader>\r\n            <AlertDialogTitle>{t(\"joinUs.confirmDelete\")}</AlertDialogTitle>\r\n            <AlertDialogDescription>\r\n              {t(\"joinUs.confirmDeleteDescription\")}\r\n            </AlertDialogDescription>\r\n          </AlertDialogHeader>\r\n          <AlertDialogFooter>\r\n            <AlertDialogCancel>{t(\"common.cancel\")}</AlertDialogCancel>\r\n            <AlertDialogAction\r\n              onClick={() => deleteId && deleteMutation.mutate(deleteId)}\r\n              className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\r\n            >\r\n              {t(\"common.delete\")}\r\n            </AlertDialogAction>\r\n          </AlertDialogFooter>\r\n        </AlertDialogContent>\r\n      </AlertDialog>\r\n\r\n      <Dialog open={emailDialogOpen} onOpenChange={setEmailDialogOpen}>\r\n        <DialogContent className=\"sm:max-w-[500px]\">\r\n          <DialogHeader>\r\n            <DialogTitle>{t(\"joinUs.sendAccountTitle\")}</DialogTitle>\r\n            <DialogDescription>\r\n              {t(\"joinUs.sendAccountDescription\", { name: selectedRequest?.name })}\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          <div className=\"space-y-4 py-4\">\r\n            <div className=\"flex items-center justify-between p-3 bg-muted rounded-lg\">\r\n              <div className=\"space-y-0.5\">\r\n                <Label htmlFor=\"emailOnlyMode\" className=\"font-medium\">{t(\"joinUs.emailOnlyMode\")}</Label>\r\n                <p className=\"text-xs text-muted-foreground\">{t(\"joinUs.emailOnlyModeDesc\")}</p>\r\n              </div>\r\n              <Switch\r\n                id=\"emailOnlyMode\"\r\n                checked={emailOnlyMode}\r\n                onCheckedChange={setEmailOnlyMode}\r\n              />\r\n            </div>\r\n            \r\n            {!emailOnlyMode && (\r\n              <div className=\"p-3 bg-blue-50 dark:bg-blue-950 border border-blue-200 dark:border-blue-800 rounded-lg\">\r\n                <p className=\"text-sm text-blue-700 dark:text-blue-300\">\r\n                  ℹ️ {t(\"joinUs.createUserModeNote\")}\r\n                </p>\r\n              </div>\r\n            )}\r\n            \r\n            <div className=\"space-y-2\">\r\n              <Label>{t(\"joinUs.emailRecipient\")}</Label>\r\n              <Input value={selectedRequest?.email || \"\"} disabled />\r\n            </div>\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"account\">{t(\"joinUs.merchantAccount\")}</Label>\r\n              <Input\r\n                id=\"account\"\r\n                value={merchantAccount}\r\n                onChange={(e) => setMerchantAccount(e.target.value)}\r\n                placeholder={t(\"joinUs.merchantAccountPlaceholder\")}\r\n              />\r\n            </div>\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"password\">{t(\"joinUs.merchantPassword\")}</Label>\r\n              <Input\r\n                id=\"password\"\r\n                type=\"text\"\r\n                value={merchantPassword}\r\n                onChange={(e) => setMerchantPassword(e.target.value)}\r\n                placeholder={t(\"joinUs.merchantPasswordPlaceholder\")}\r\n              />\r\n            </div>\r\n            <div className=\"p-3 bg-amber-50 dark:bg-amber-950 border border-amber-200 dark:border-amber-800 rounded-lg\">\r\n              <p className=\"text-sm text-amber-700 dark:text-amber-300\">\r\n                ⚠️ {t(\"joinUs.passwordSecurityNote\")}\r\n              </p>\r\n            </div>\r\n          </div>\r\n          <DialogFooter>\r\n            <Button variant=\"outline\" onClick={() => setEmailDialogOpen(false)} disabled={creatingUser || sendingEmail}>\r\n              {t(\"common.cancel\")}\r\n            </Button>\r\n            <Button onClick={handleSendEmail} disabled={creatingUser || sendingEmail}>\r\n              {creatingUser \r\n                ? t(\"joinUs.creatingUser\") \r\n                : sendingEmail \r\n                  ? t(\"common.sending\") \r\n                  : emailOnlyMode \r\n                    ? t(\"joinUs.sendEmailOnly\")\r\n                    : t(\"joinUs.createAndSendEmail\")}\r\n            </Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default AdminJoinRequests;\r\n"],"names":["STATUS_OPTIONS","AdminJoinRequests","t","useTranslation","search","setSearch","useState","statusFilter","setStatusFilter","deleteId","setDeleteId","emailDialogOpen","setEmailDialogOpen","detailDialogOpen","setDetailDialogOpen","selectedRequest","setSelectedRequest","merchantAccount","setMerchantAccount","merchantPassword","setMerchantPassword","sendingEmail","setSendingEmail","creatingUser","setCreatingUser","emailOnlyMode","setEmailOnlyMode","queryClient","useQueryClient","joinRequests","isLoading","useQuery","data","error","supabase","inviterIds","inviterProfiles","profiles","acc","p","request","emailConfig","siteSettings","useEffect","channel","filteredRequests","searchLower","matchesSearch","matchesStatus","handleUpdateEmail","newEmail","toast","updateStatusMutation","useMutation","id","status","deleteMutation","handleExport","csvContent","row","cell","blob","link","url","getStatusColor","openEmailDialog","openDetailDialog","handleSendEmail","emailSubject","emailContent","sessionData","createData","createError","jsxs","Fragment","jsx","Card","CardHeader","CardTitle","CardDescription","CardContent","Input","Button","Download","Search","e","DropdownMenu","DropdownMenuTrigger","Filter","DropdownMenuContent","DropdownMenuItem","Badge","Store","Mail","Phone","Clock","formatDistanceToNow","Ticket","CheckCircle2","Separator","Eye","Send","Trash2","Dialog","DialogContent","DialogHeader","DialogTitle","DialogDescription","ScrollArea","Select","value","SelectTrigger","SelectValue","SelectContent","SelectItem","UserCircle","MapPin","feature","idx","format","DialogFooter","AlertDialog","open","AlertDialogContent","AlertDialogHeader","AlertDialogTitle","AlertDialogDescription","AlertDialogFooter","AlertDialogCancel","AlertDialogAction","Label","Switch"],"mappings":"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"}