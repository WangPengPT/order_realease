{"version":3,"file":"AdminHomepageTemplates-NV_Lxlsq.js","sources":["../../src/components/admin/HomepageMediaCropDialog.tsx","../../src/pages/admin/AdminHomepageTemplates.tsx"],"sourcesContent":["import { useState, useRef, useCallback, useEffect } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport ReactCrop, { Crop, PixelCrop, centerCrop, makeAspectCrop } from \"react-image-crop\";\r\nimport \"react-image-crop/dist/ReactCrop.css\";\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Crop as CropIcon, Maximize2, Monitor, Tablet, Smartphone, Loader2 } from \"lucide-react\";\r\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\r\nimport { Tabs, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\n\r\ntype DeviceType = \"desktop\" | \"tablet\" | \"mobile\";\r\n\r\ninterface HomepageMediaCropDialogProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  imageSource: File | string; // Can be File or URL string\r\n  deviceType: DeviceType;\r\n  onCropComplete: (croppedFile: File, deviceType: DeviceType) => void;\r\n}\r\n\r\n// Aspect ratios for different devices\r\nconst DEVICE_CONFIGS: Record<DeviceType, { width: number; height: number; aspect: number; label: string; icon: any }> = {\r\n  desktop: { width: 1920, height: 1080, aspect: 16 / 9, label: \"桌面端 16:9\", icon: Monitor },\r\n  tablet: { width: 1024, height: 768, aspect: 4 / 3, label: \"平板端 4:3\", icon: Tablet },\r\n  mobile: { width: 750, height: 1334, aspect: 9 / 16, label: \"移动端 9:16\", icon: Smartphone },\r\n};\r\n\r\nfunction centerAspectCrop(\r\n  mediaWidth: number,\r\n  mediaHeight: number,\r\n  aspect: number,\r\n) {\r\n  return centerCrop(\r\n    makeAspectCrop(\r\n      {\r\n        unit: '%',\r\n        width: 90,\r\n      },\r\n      aspect,\r\n      mediaWidth,\r\n      mediaHeight,\r\n    ),\r\n    mediaWidth,\r\n    mediaHeight,\r\n  );\r\n}\r\n\r\nexport function HomepageMediaCropDialog({\r\n  open,\r\n  onOpenChange,\r\n  imageSource,\r\n  deviceType,\r\n  onCropComplete,\r\n}: HomepageMediaCropDialogProps) {\r\n  const { t } = useTranslation();\r\n  const [imgSrc, setImgSrc] = useState(\"\");\r\n  const [crop, setCrop] = useState<Crop>();\r\n  const [completedCrop, setCompletedCrop] = useState<PixelCrop>();\r\n  const [selectedDevice, setSelectedDevice] = useState<DeviceType>(deviceType);\r\n  const imgRef = useRef<HTMLImageElement>(null);\r\n  const [isCropping, setIsCropping] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  const config = DEVICE_CONFIGS[selectedDevice];\r\n  const DeviceIcon = config.icon;\r\n\r\n  useEffect(() => {\r\n    if (open && imageSource) {\r\n      setSelectedDevice(deviceType);\r\n      setCrop(undefined);\r\n      setCompletedCrop(undefined);\r\n      \r\n      if (typeof imageSource === 'string') {\r\n        // It's a URL - load it directly\r\n        setIsLoading(true);\r\n        setImgSrc(imageSource);\r\n      } else {\r\n        // It's a File - read it\r\n        setIsLoading(true);\r\n        const reader = new FileReader();\r\n        reader.addEventListener(\"load\", () => {\r\n          setImgSrc(reader.result?.toString() || \"\");\r\n        });\r\n        reader.readAsDataURL(imageSource);\r\n      }\r\n    }\r\n  }, [open, imageSource, deviceType]);\r\n\r\n  const onImageLoad = useCallback((e: React.SyntheticEvent<HTMLImageElement>) => {\r\n    setIsLoading(false);\r\n    const { width, height } = e.currentTarget;\r\n    setCrop(centerAspectCrop(width, height, config.aspect));\r\n  }, [config.aspect]);\r\n\r\n  // Update crop when device type changes\r\n  useEffect(() => {\r\n    if (imgRef.current && imgRef.current.complete) {\r\n      const { width, height } = imgRef.current;\r\n      if (width && height) {\r\n        setCrop(centerAspectCrop(width, height, config.aspect));\r\n      }\r\n    }\r\n  }, [selectedDevice, config.aspect]);\r\n\r\n  const getCroppedImg = useCallback(\r\n    async (image: HTMLImageElement, crop: PixelCrop): Promise<Blob> => {\r\n      const canvas = document.createElement(\"canvas\");\r\n      const ctx = canvas.getContext(\"2d\");\r\n\r\n      if (!ctx) {\r\n        throw new Error(\"No 2d context\");\r\n      }\r\n\r\n      const scaleX = image.naturalWidth / image.width;\r\n      const scaleY = image.naturalHeight / image.height;\r\n\r\n      // Calculate output dimensions while maintaining aspect ratio\r\n      const cropWidthPx = crop.width * scaleX;\r\n      const cropHeightPx = crop.height * scaleY;\r\n      \r\n      // Scale down to recommended size if larger\r\n      let outputWidth = cropWidthPx;\r\n      let outputHeight = cropHeightPx;\r\n      \r\n      if (outputWidth > config.width || outputHeight > config.height) {\r\n        const scale = Math.min(config.width / outputWidth, config.height / outputHeight);\r\n        outputWidth = outputWidth * scale;\r\n        outputHeight = outputHeight * scale;\r\n      }\r\n      \r\n      canvas.width = outputWidth;\r\n      canvas.height = outputHeight;\r\n\r\n      ctx.imageSmoothingQuality = \"high\";\r\n\r\n      ctx.drawImage(\r\n        image,\r\n        crop.x * scaleX,\r\n        crop.y * scaleY,\r\n        cropWidthPx,\r\n        cropHeightPx,\r\n        0,\r\n        0,\r\n        canvas.width,\r\n        canvas.height\r\n      );\r\n\r\n      return new Promise((resolve, reject) => {\r\n        canvas.toBlob(\r\n          (blob) => {\r\n            if (!blob) {\r\n              reject(new Error(\"Canvas is empty\"));\r\n              return;\r\n            }\r\n            resolve(blob);\r\n          },\r\n          \"image/jpeg\",\r\n          0.92\r\n        );\r\n      });\r\n    },\r\n    [config]\r\n  );\r\n\r\n  const handleCropConfirm = useCallback(async () => {\r\n    if (!completedCrop || !imgRef.current) return;\r\n\r\n    setIsCropping(true);\r\n    try {\r\n      const croppedBlob = await getCroppedImg(imgRef.current, completedCrop);\r\n      const fileName = typeof imageSource === 'string' \r\n        ? `cropped-${selectedDevice}-${Date.now()}.jpg`\r\n        : imageSource.name;\r\n      const croppedFile = new File([croppedBlob], fileName, {\r\n        type: \"image/jpeg\",\r\n      });\r\n\r\n      onCropComplete(croppedFile, selectedDevice);\r\n      onOpenChange(false);\r\n    } catch (error) {\r\n      console.error(\"Error cropping image:\", error);\r\n    } finally {\r\n      setIsCropping(false);\r\n    }\r\n  }, [completedCrop, imageSource, selectedDevice, onCropComplete, onOpenChange, getCroppedImg]);\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={onOpenChange}>\r\n      <DialogContent className=\"max-w-[95vw] sm:max-w-4xl max-h-[95vh] overflow-hidden flex flex-col p-0\">\r\n        <DialogHeader className=\"px-4 sm:px-6 pt-4 sm:pt-6 pb-4 border-b\">\r\n          <DialogTitle className=\"text-lg sm:text-xl flex items-center gap-2\">\r\n            <CropIcon className=\"w-5 h-5 text-primary\" />\r\n            裁剪图片\r\n          </DialogTitle>\r\n          <DialogDescription className=\"text-xs sm:text-sm\">\r\n            拖动选择要保留的区域，裁剪后将用于主页轮播\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        <div className=\"px-4 sm:px-6 py-4 space-y-4 overflow-y-auto\">\r\n          {/* Device Type Selector */}\r\n          <Tabs value={selectedDevice} onValueChange={(v) => setSelectedDevice(v as DeviceType)}>\r\n            <TabsList className=\"grid w-full grid-cols-3\">\r\n              <TabsTrigger value=\"desktop\" className=\"flex items-center gap-1\">\r\n                <Monitor className=\"w-4 h-4\" />\r\n                <span className=\"hidden sm:inline\">桌面端</span>\r\n              </TabsTrigger>\r\n              <TabsTrigger value=\"tablet\" className=\"flex items-center gap-1\">\r\n                <Tablet className=\"w-4 h-4\" />\r\n                <span className=\"hidden sm:inline\">平板端</span>\r\n              </TabsTrigger>\r\n              <TabsTrigger value=\"mobile\" className=\"flex items-center gap-1\">\r\n                <Smartphone className=\"w-4 h-4\" />\r\n                <span className=\"hidden sm:inline\">移动端</span>\r\n              </TabsTrigger>\r\n            </TabsList>\r\n          </Tabs>\r\n\r\n          <Alert className=\"border-primary/20 bg-primary/5\">\r\n            <DeviceIcon className=\"h-4 w-4\" />\r\n            <AlertDescription className=\"text-xs sm:text-sm\">\r\n              <div className=\"flex flex-col sm:flex-row sm:items-center gap-2\">\r\n                <span className=\"font-medium\">推荐尺寸:</span>\r\n                <Badge variant=\"secondary\" className=\"w-fit\">\r\n                  <Maximize2 className=\"w-3 h-3 mr-1\" />\r\n                  {config.width} × {config.height} px ({config.label})\r\n                </Badge>\r\n              </div>\r\n            </AlertDescription>\r\n          </Alert>\r\n\r\n          <div className=\"relative w-full overflow-hidden rounded-lg border bg-muted/30 min-h-[200px]\">\r\n            {isLoading && (\r\n              <div className=\"absolute inset-0 flex items-center justify-center\">\r\n                <Loader2 className=\"w-8 h-8 animate-spin text-muted-foreground\" />\r\n              </div>\r\n            )}\r\n            {imgSrc && (\r\n              <ReactCrop\r\n                crop={crop}\r\n                onChange={(c) => setCrop(c)}\r\n                onComplete={(c) => setCompletedCrop(c)}\r\n                aspect={config.aspect}\r\n                className=\"max-h-[50vh] sm:max-h-[55vh] flex items-center justify-center\"\r\n              >\r\n                <img\r\n                  ref={imgRef}\r\n                  src={imgSrc}\r\n                  alt=\"Crop preview\"\r\n                  onLoad={onImageLoad}\r\n                  crossOrigin=\"anonymous\"\r\n                  className=\"max-w-full max-h-[50vh] sm:max-h-[55vh] h-auto object-contain\"\r\n                />\r\n              </ReactCrop>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        <DialogFooter className=\"px-4 sm:px-6 pb-4 sm:pb-6 pt-4 border-t gap-2 sm:gap-0\">\r\n          <Button\r\n            type=\"button\"\r\n            variant=\"outline\"\r\n            onClick={() => onOpenChange(false)}\r\n            disabled={isCropping}\r\n            className=\"w-full sm:w-auto\"\r\n          >\r\n            {t(\"common.cancel\")}\r\n          </Button>\r\n          <Button\r\n            type=\"button\"\r\n            onClick={handleCropConfirm}\r\n            disabled={!completedCrop || isCropping || isLoading}\r\n            className=\"w-full sm:w-auto\"\r\n          >\r\n            {isCropping ? \"处理中...\" : \"确认裁剪\"}\r\n          </Button>\r\n        </DialogFooter>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}\r\n","import { useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Slider } from \"@/components/ui/slider\";\r\nimport { Switch } from \"@/components/ui/switch\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\r\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle, AlertDialogTrigger } from \"@/components/ui/alert-dialog\";\r\nimport { \r\n  useHomepageTemplates, \r\n  useCreateHomepageTemplate, \r\n  useUpdateHomepageTemplate, \r\n  useDeleteHomepageTemplate,\r\n  useUploadTemplateImage,\r\n  useUploadTemplateVideo,\r\n  HomepageTemplate \r\n} from \"@/hooks/useHomepageTemplates\";\r\nimport { Loader2, Upload, Save, Plus, Trash2, Edit, GripVertical, Eye, EyeOff, Clock, Image, Video, RefreshCw, ChevronDown, Play, X, Crop } from \"lucide-react\";\r\nimport { HomepageMediaCropDialog } from \"@/components/admin/HomepageMediaCropDialog\";\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuSeparator,\r\n  DropdownMenuTrigger,\r\n} from \"@/components/ui/dropdown-menu\";\r\nimport { toast } from \"sonner\";\r\n\r\n// Default fallback images\r\nconst sushiRamenHero = \"/images/sushi-ramen-hero.jpg\";\r\nconst sushiRamenMobile = \"/images/sushi-ramen-mobile.jpg\";\r\n\r\n// Template Preview Component\r\nconst TemplatePreview = ({ \r\n  template, \r\n  onClose \r\n}: { \r\n  template: Partial<HomepageTemplate>; \r\n  onClose: () => void;\r\n}) => {\r\n  const { i18n } = useTranslation();\r\n  const currentLang = i18n.language?.split('-')[0] || 'zh';\r\n  \r\n  const getLocalizedText = (field: string) => {\r\n    const langSuffix = currentLang === \"zh\" ? \"_zh\" : currentLang === \"pt\" ? \"_pt\" : \"_en\";\r\n    return (template as any)[`${field}${langSuffix}`] || \"\";\r\n  };\r\n\r\n  const getDeviceType = () => {\r\n    if (window.innerWidth < 640) return 'mobile';\r\n    if (window.innerWidth < 1024) return 'tablet';\r\n    return 'desktop';\r\n  };\r\n\r\n  const getOverlayOpacity = () => {\r\n    const deviceType = getDeviceType();\r\n    \r\n    if (deviceType === 'mobile' && template.mobile_overlay_opacity !== null) {\r\n      return template.mobile_overlay_opacity;\r\n    }\r\n    if (deviceType === 'tablet' && template.tablet_overlay_opacity !== null) {\r\n      return template.tablet_overlay_opacity;\r\n    }\r\n    if (deviceType === 'desktop' && template.desktop_overlay_opacity !== null) {\r\n      return template.desktop_overlay_opacity;\r\n    }\r\n    \r\n    return template.overlay_opacity ?? 30;\r\n  };\r\n\r\n  const getOverlayStyle = () => {\r\n    const baseOpacity = getOverlayOpacity() || 30;\r\n    const direction = template.overlay_gradient_direction || 'to-b';\r\n    \r\n    const normalizeOpacity = (value: number | null | undefined, defaultValue: number) => {\r\n      if (value === null || value === undefined) return defaultValue / 100;\r\n      return value > 1 ? value / 100 : value;\r\n    };\r\n    \r\n    const normalizedBaseOpacity = baseOpacity > 1 ? baseOpacity / 100 : baseOpacity;\r\n    \r\n    const fromOpacity = normalizeOpacity(template.overlay_gradient_from_opacity, 30) * normalizedBaseOpacity;\r\n    const viaOpacity = normalizeOpacity(template.overlay_gradient_via_opacity, 25) * normalizedBaseOpacity;\r\n    const toOpacity = normalizeOpacity(template.overlay_gradient_to_opacity, 40) * normalizedBaseOpacity;\r\n\r\n    const directionMap: Record<string, string> = {\r\n      'to-t': 'to top',\r\n      'to-b': 'to bottom',\r\n      'to-l': 'to left',\r\n      'to-r': 'to right',\r\n      'to-tl': 'to top left',\r\n      'to-tr': 'to top right',\r\n      'to-bl': 'to bottom left',\r\n      'to-br': 'to bottom right'\r\n    };\r\n\r\n    const cssDirection = directionMap[direction] || 'to bottom';\r\n\r\n    const colorMap: Record<string, string> = {\r\n      'black': '0, 0, 0',\r\n      'white': '255, 255, 255',\r\n      'background': '0, 0, 0',\r\n      'foreground': '255, 255, 255',\r\n      'primary': '1, 100, 80',\r\n      'secondary': '240, 240, 240'\r\n    };\r\n\r\n    const fromColor = colorMap[template.overlay_gradient_from || 'black'] || '0, 0, 0';\r\n    const viaColor = colorMap[template.overlay_gradient_via || 'black'] || '0, 0, 0';\r\n    const toColor = colorMap[template.overlay_gradient_to || 'black'] || '0, 0, 0';\r\n\r\n    return {\r\n      background: `linear-gradient(${cssDirection}, rgba(${fromColor}, ${fromOpacity}), rgba(${viaColor}, ${viaOpacity}), rgba(${toColor}, ${toOpacity}))`\r\n    };\r\n  };\r\n\r\n  const mobileImg = template.mobile_image_url || sushiRamenMobile;\r\n  const tabletImg = template.tablet_image_url || template.desktop_image_url || sushiRamenHero;\r\n  const desktopImg = template.desktop_image_url || sushiRamenHero;\r\n  const blurAmount = template.background_blur || 0;\r\n\r\n  const desktopMediaType = (template as any).desktop_media_type || template.media_type || 'image';\r\n  const tabletMediaType = (template as any).tablet_media_type || template.media_type || 'image';\r\n  const mobileMediaType = (template as any).mobile_media_type || template.media_type || 'image';\r\n\r\n  const mobileVideo = mobileMediaType === 'video' ? template.mobile_video_url : null;\r\n  const tabletVideo = tabletMediaType === 'video' ? (template.tablet_video_url || template.desktop_video_url) : null;\r\n  const desktopVideo = desktopMediaType === 'video' ? template.desktop_video_url : null;\r\n\r\n  const title = getLocalizedText('title');\r\n  const subtitle = getLocalizedText('subtitle');\r\n  const description = getLocalizedText('description');\r\n  const primaryButtonText = getLocalizedText('primary_button_text');\r\n  const secondaryButtonText = getLocalizedText('secondary_button_text');\r\n\r\n  return (\r\n    <div className=\"relative w-full h-full\">\r\n      {/* Background Media */}\r\n      <div className=\"absolute inset-0 w-full h-full\">\r\n        {/* Mobile */}\r\n        <div className=\"absolute inset-0 w-full h-full sm:hidden\">\r\n          {mobileVideo ? (\r\n            <video\r\n              src={mobileVideo}\r\n              autoPlay\r\n              loop\r\n              muted\r\n              playsInline\r\n              className=\"absolute inset-0 w-full h-full object-cover object-center\"\r\n              style={{ filter: blurAmount > 0 ? `blur(${blurAmount}px)` : undefined }}\r\n            />\r\n          ) : (\r\n            <img \r\n              src={mobileImg || ''} \r\n              alt=\"Background\" \r\n              className=\"absolute inset-0 w-full h-full object-cover object-center\"\r\n              style={{ filter: blurAmount > 0 ? `blur(${blurAmount}px)` : undefined }}\r\n            />\r\n          )}\r\n        </div>\r\n        \r\n        {/* Tablet */}\r\n        <div className=\"absolute inset-0 w-full h-full hidden sm:block lg:hidden\">\r\n          {tabletVideo ? (\r\n            <video\r\n              src={tabletVideo}\r\n              autoPlay\r\n              loop\r\n              muted\r\n              playsInline\r\n              className=\"absolute inset-0 w-full h-full object-cover object-center\"\r\n              style={{ filter: blurAmount > 0 ? `blur(${blurAmount}px)` : undefined }}\r\n            />\r\n          ) : (\r\n            <img \r\n              src={tabletImg || ''} \r\n              alt=\"Background\" \r\n              className=\"absolute inset-0 w-full h-full object-cover object-center\"\r\n              style={{ filter: blurAmount > 0 ? `blur(${blurAmount}px)` : undefined }}\r\n            />\r\n          )}\r\n        </div>\r\n        \r\n        {/* Desktop */}\r\n        <div className=\"absolute inset-0 w-full h-full hidden lg:block\">\r\n          {desktopVideo ? (\r\n            <video\r\n              src={desktopVideo}\r\n              autoPlay\r\n              loop\r\n              muted\r\n              playsInline\r\n              className=\"absolute inset-0 w-full h-full object-cover object-center\"\r\n              style={{ filter: blurAmount > 0 ? `blur(${blurAmount}px)` : undefined }}\r\n            />\r\n          ) : (\r\n            <img \r\n              src={desktopImg || ''} \r\n              alt=\"Background\" \r\n              className=\"absolute inset-0 w-full h-full object-cover object-center\"\r\n              style={{ filter: blurAmount > 0 ? `blur(${blurAmount}px)` : undefined }}\r\n            />\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Overlay */}\r\n      <div className=\"absolute inset-0 z-10\" style={getOverlayStyle()} />\r\n\r\n      {/* Content */}\r\n      <div className=\"absolute inset-0 z-20 flex flex-col items-center justify-center text-center px-4\">\r\n        {subtitle && (\r\n          <p className=\"text-white/90 text-sm sm:text-base mb-2 drop-shadow-md\">\r\n            {subtitle}\r\n          </p>\r\n        )}\r\n        {title && (\r\n          <h1 className=\"text-3xl sm:text-4xl lg:text-5xl font-bold text-white mb-4 drop-shadow-lg\">\r\n            {title}\r\n          </h1>\r\n        )}\r\n        {description && (\r\n          <p className=\"text-white/80 text-base sm:text-lg max-w-2xl mb-8 drop-shadow-md\">\r\n            {description}\r\n          </p>\r\n        )}\r\n        \r\n        <div className=\"flex flex-wrap gap-4 justify-center\">\r\n          {primaryButtonText && (\r\n            <Button \r\n              variant={(template.primary_button_variant as any) || \"default\"}\r\n              size=\"lg\"\r\n              className=\"pointer-events-none\"\r\n            >\r\n              {primaryButtonText}\r\n            </Button>\r\n          )}\r\n          {secondaryButtonText && (\r\n            <Button \r\n              variant={(template.secondary_button_variant as any) || \"outline\"}\r\n              size=\"lg\"\r\n              className=\"pointer-events-none text-white border-white hover:bg-white/10\"\r\n            >\r\n              {secondaryButtonText}\r\n            </Button>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Device indicator */}\r\n      <div className=\"absolute bottom-4 left-4 z-30 bg-black/50 text-white text-xs px-3 py-1 rounded-full\">\r\n        预览模式 - 点击右上角关闭\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst AdminHomepageTemplates = () => {\r\n  const { t } = useTranslation();\r\n  const { data: templates, isLoading } = useHomepageTemplates();\r\n  const createTemplate = useCreateHomepageTemplate();\r\n  const updateTemplate = useUpdateHomepageTemplate();\r\n  const deleteTemplate = useDeleteHomepageTemplate();\r\n  const uploadImage = useUploadTemplateImage();\r\n  const uploadVideo = useUploadTemplateVideo();\r\n\r\n  const [editingTemplate, setEditingTemplate] = useState<HomepageTemplate | null>(null);\r\n  const [isCreateDialogOpen, setIsCreateDialogOpen] = useState(false);\r\n  const [formData, setFormData] = useState<Partial<HomepageTemplate>>({});\r\n  const [activeTab, setActiveTab] = useState(\"images\");\r\n  const [previewTemplate, setPreviewTemplate] = useState<HomepageTemplate | Partial<HomepageTemplate> | null>(null);\r\n  \r\n  // Crop dialog state\r\n  const [cropDialogOpen, setCropDialogOpen] = useState(false);\r\n  const [cropImageSource, setCropImageSource] = useState<File | string | null>(null);\r\n  const [cropDeviceType, setCropDeviceType] = useState<\"desktop\" | \"tablet\" | \"mobile\">(\"desktop\");\r\n\r\n  const handleCreate = () => {\r\n    setFormData({\r\n      sort_order: templates?.length || 0,\r\n      is_active: true,\r\n      media_type: 'image',\r\n      desktop_media_type: 'image',\r\n      tablet_media_type: 'image',\r\n      mobile_media_type: 'image',\r\n      duration: 5000,\r\n      overlay_opacity: 40,\r\n      overlay_gradient_direction: \"to-b\",\r\n      overlay_gradient_from: \"background\",\r\n      overlay_gradient_from_opacity: 30,\r\n      overlay_gradient_via: \"background\",\r\n      overlay_gradient_via_opacity: 25,\r\n      overlay_gradient_to: \"background\",\r\n      overlay_gradient_to_opacity: 40,\r\n      background_blur: 0,\r\n      title_zh: \"发现您的亚洲美食之旅\",\r\n      title_en: \"Discover Your Asian Food Journey\",\r\n      title_pt: \"Descubra Sua Jornada Gastronômica Asiática\",\r\n      subtitle_zh: \"您的美食之旅从这里开始\",\r\n      subtitle_en: \"Your culinary journey starts here\",\r\n      subtitle_pt: \"Sua jornada culinária começa aqui\",\r\n      description_zh: \"探索里斯本地区最好的亚洲美食\",\r\n      description_en: \"Explore the best Asian cuisine in the Lisbon area\",\r\n      description_pt: \"Explore a melhor cozinha asiática na área de Lisboa\",\r\n      primary_button_text_zh: \"探索餐厅\",\r\n      primary_button_text_en: \"Explore Restaurants\",\r\n      primary_button_text_pt: \"Explorar Restaurantes\",\r\n      primary_button_link: \"/restaurants\",\r\n      primary_button_variant: \"default\",\r\n      secondary_button_text_zh: \"活动\",\r\n      secondary_button_text_en: \"Activities\",\r\n      secondary_button_text_pt: \"Atividades\",\r\n      secondary_button_link: \"/activities\",\r\n      secondary_button_variant: \"outline\",\r\n    });\r\n    setIsCreateDialogOpen(true);\r\n    setActiveTab(\"media\");\r\n  };\r\n\r\n  const handleEdit = (template: HomepageTemplate) => {\r\n    setFormData(template);\r\n    setEditingTemplate(template);\r\n    setActiveTab(\"media\");\r\n  };\r\n\r\n  const handleSave = async () => {\r\n    try {\r\n      if (editingTemplate) {\r\n        await updateTemplate.mutateAsync({ id: editingTemplate.id, ...formData });\r\n        setEditingTemplate(null);\r\n      } else {\r\n        await createTemplate.mutateAsync(formData);\r\n        setIsCreateDialogOpen(false);\r\n      }\r\n      setFormData({});\r\n    } catch (error) {\r\n      console.error(\"Save failed:\", error);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (id: string) => {\r\n    try {\r\n      await deleteTemplate.mutateAsync(id);\r\n    } catch (error) {\r\n      console.error(\"Delete failed:\", error);\r\n    }\r\n  };\r\n\r\n  const handleToggleActive = async (template: HomepageTemplate) => {\r\n    try {\r\n      await updateTemplate.mutateAsync({ id: template.id, is_active: !template.is_active });\r\n    } catch (error) {\r\n      console.error(\"Toggle failed:\", error);\r\n    }\r\n  };\r\n\r\n  // Direct upload without crop\r\n  const handleImageFileChange = async (e: React.ChangeEvent<HTMLInputElement>, type: \"desktop\" | \"tablet\" | \"mobile\") => {\r\n    const file = e.target.files?.[0];\r\n    if (!file) return;\r\n\r\n    if (!file.type.startsWith(\"image/\")) {\r\n      toast.error(t(\"admin.homepageTemplates.selectImageFile\"));\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const templateId = editingTemplate?.id || \"new\";\r\n      const result = await uploadImage.mutateAsync({ file, type, templateId });\r\n      setFormData((prev) => ({\r\n        ...prev,\r\n        [`${type}_image_url`]: result.url,\r\n      }));\r\n    } catch (error) {\r\n      console.error(\"Upload failed:\", error);\r\n    }\r\n  };\r\n\r\n  // Open crop dialog for new image upload\r\n  const handleImageCropClick = (e: React.ChangeEvent<HTMLInputElement>, type: \"desktop\" | \"tablet\" | \"mobile\") => {\r\n    const file = e.target.files?.[0];\r\n    if (!file) return;\r\n\r\n    if (!file.type.startsWith(\"image/\")) {\r\n      toast.error(t(\"admin.homepageTemplates.selectImageFile\"));\r\n      return;\r\n    }\r\n\r\n    setCropImageSource(file);\r\n    setCropDeviceType(type);\r\n    setCropDialogOpen(true);\r\n    \r\n    // Reset the input so the same file can be selected again\r\n    e.target.value = '';\r\n  };\r\n\r\n  // Open crop dialog for existing uploaded image\r\n  const handleEditExistingImage = (imageUrl: string, type: \"desktop\" | \"tablet\" | \"mobile\") => {\r\n    setCropImageSource(imageUrl);\r\n    setCropDeviceType(type);\r\n    setCropDialogOpen(true);\r\n  };\r\n\r\n  // Handle crop complete\r\n  const handleCropComplete = async (croppedFile: File, deviceType: \"desktop\" | \"tablet\" | \"mobile\") => {\r\n    try {\r\n      const templateId = editingTemplate?.id || \"new\";\r\n      const result = await uploadImage.mutateAsync({ file: croppedFile, type: deviceType, templateId });\r\n      setFormData((prev) => ({\r\n        ...prev,\r\n        [`${deviceType}_image_url`]: result.url,\r\n      }));\r\n      toast.success(\"图片裁剪并上传成功\");\r\n    } catch (error) {\r\n      console.error(\"Upload failed:\", error);\r\n      toast.error(\"上传失败\");\r\n    }\r\n  };\r\n\r\n  // Extract first frame from video as image\r\n  const extractVideoFirstFrame = (videoFile: File): Promise<Blob> => {\r\n    return new Promise((resolve, reject) => {\r\n      const video = document.createElement('video');\r\n      const canvas = document.createElement('canvas');\r\n      const ctx = canvas.getContext('2d');\r\n      \r\n      video.preload = 'auto';\r\n      video.muted = true;\r\n      video.playsInline = true;\r\n      video.crossOrigin = 'anonymous';\r\n      \r\n      let hasResolved = false;\r\n      \r\n      const captureFrame = () => {\r\n        if (hasResolved) return;\r\n        if (video.videoWidth === 0 || video.videoHeight === 0) return;\r\n        \r\n        // Set canvas size to video dimensions\r\n        canvas.width = video.videoWidth;\r\n        canvas.height = video.videoHeight;\r\n        \r\n        if (ctx) {\r\n          ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\r\n          canvas.toBlob((blob) => {\r\n            if (blob && blob.size > 0) {\r\n              hasResolved = true;\r\n              video.pause();\r\n              URL.revokeObjectURL(video.src);\r\n              resolve(blob);\r\n            } else {\r\n              reject(new Error('Failed to create blob from canvas'));\r\n            }\r\n          }, 'image/jpeg', 0.95);\r\n        } else {\r\n          reject(new Error('Failed to get canvas context'));\r\n        }\r\n      };\r\n      \r\n      // Try multiple approaches to capture the first frame\r\n      video.onloadedmetadata = () => {\r\n        canvas.width = video.videoWidth;\r\n        canvas.height = video.videoHeight;\r\n        // Seek to beginning\r\n        video.currentTime = 0.1; // Slight offset to ensure frame is rendered\r\n      };\r\n      \r\n      video.onseeked = () => {\r\n        // Wait a bit for the frame to actually render\r\n        setTimeout(captureFrame, 100);\r\n      };\r\n      \r\n      video.oncanplay = () => {\r\n        // Fallback: try to capture when video can play\r\n        if (!hasResolved && video.currentTime >= 0.1) {\r\n          setTimeout(captureFrame, 100);\r\n        }\r\n      };\r\n      \r\n      video.onerror = (e) => {\r\n        URL.revokeObjectURL(video.src);\r\n        reject(new Error('Failed to load video: ' + (e as any)?.message || 'Unknown error'));\r\n      };\r\n      \r\n      // Set timeout to prevent hanging\r\n      setTimeout(() => {\r\n        if (!hasResolved) {\r\n          URL.revokeObjectURL(video.src);\r\n          reject(new Error('Timeout while extracting video frame'));\r\n        }\r\n      }, 10000);\r\n      \r\n      video.src = URL.createObjectURL(videoFile);\r\n      video.load();\r\n    });\r\n  };\r\n\r\n  // Extract first frame from video URL (for existing videos)\r\n  const extractFirstFrameFromUrl = (videoUrl: string): Promise<Blob> => {\r\n    return new Promise((resolve, reject) => {\r\n      const video = document.createElement('video');\r\n      const canvas = document.createElement('canvas');\r\n      const ctx = canvas.getContext('2d');\r\n      \r\n      video.preload = 'auto';\r\n      video.muted = true;\r\n      video.playsInline = true;\r\n      video.crossOrigin = 'anonymous';\r\n      \r\n      let hasResolved = false;\r\n      \r\n      const captureFrame = () => {\r\n        if (hasResolved) return;\r\n        if (video.videoWidth === 0 || video.videoHeight === 0) return;\r\n        \r\n        canvas.width = video.videoWidth;\r\n        canvas.height = video.videoHeight;\r\n        \r\n        if (ctx) {\r\n          ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\r\n          canvas.toBlob((blob) => {\r\n            if (blob && blob.size > 0) {\r\n              hasResolved = true;\r\n              video.pause();\r\n              resolve(blob);\r\n            } else {\r\n              reject(new Error('Failed to create blob from canvas'));\r\n            }\r\n          }, 'image/jpeg', 0.95);\r\n        } else {\r\n          reject(new Error('Failed to get canvas context'));\r\n        }\r\n      };\r\n      \r\n      video.onloadedmetadata = () => {\r\n        canvas.width = video.videoWidth;\r\n        canvas.height = video.videoHeight;\r\n        video.currentTime = 0.1;\r\n      };\r\n      \r\n      video.onseeked = () => {\r\n        setTimeout(captureFrame, 100);\r\n      };\r\n      \r\n      video.oncanplay = () => {\r\n        if (!hasResolved && video.currentTime >= 0.1) {\r\n          setTimeout(captureFrame, 100);\r\n        }\r\n      };\r\n      \r\n      video.onerror = () => {\r\n        reject(new Error('Failed to load video from URL'));\r\n      };\r\n      \r\n      setTimeout(() => {\r\n        if (!hasResolved) {\r\n          reject(new Error('Timeout while extracting video frame from URL'));\r\n        }\r\n      }, 15000);\r\n      \r\n      video.src = videoUrl;\r\n      video.load();\r\n    });\r\n  };\r\n\r\n  // Regenerate poster images from existing videos\r\n  const [isRegenerating, setIsRegenerating] = useState(false);\r\n  \r\n  const regeneratePosters = async (targetType?: \"desktop\" | \"tablet\" | \"mobile\") => {\r\n    const videoTypes: Array<\"desktop\" | \"tablet\" | \"mobile\"> = targetType \r\n      ? [targetType] \r\n      : [\"desktop\", \"tablet\", \"mobile\"];\r\n    const templateId = editingTemplate?.id || \"new\";\r\n    \r\n    const typeLabels = {\r\n      desktop: \"桌面端\",\r\n      tablet: \"平板端\", \r\n      mobile: \"移动端\"\r\n    };\r\n    \r\n    setIsRegenerating(true);\r\n    let successCount = 0;\r\n    let failCount = 0;\r\n    \r\n    for (const type of videoTypes) {\r\n      const videoUrl = formData[`${type}_video_url` as keyof typeof formData] as string | undefined;\r\n      if (!videoUrl) continue;\r\n      \r\n      try {\r\n        toast.info(`正在提取${typeLabels[type]}视频第一帧...`);\r\n        const firstFrameBlob = await extractFirstFrameFromUrl(videoUrl);\r\n        const firstFrameFile = new File([firstFrameBlob], `${type}-poster-${Date.now()}.jpg`, { type: 'image/jpeg' });\r\n        const imageResult = await uploadImage.mutateAsync({ file: firstFrameFile, type, templateId });\r\n        \r\n        setFormData((prev) => ({\r\n          ...prev,\r\n          [`${type}_image_url`]: imageResult.url,\r\n        }));\r\n        successCount++;\r\n      } catch (error) {\r\n        console.error(`Failed to regenerate ${type} poster:`, error);\r\n        failCount++;\r\n      }\r\n    }\r\n    \r\n    setIsRegenerating(false);\r\n    \r\n    if (successCount > 0) {\r\n      const message = targetType \r\n        ? `成功重新生成${typeLabels[targetType]}备用图片`\r\n        : `成功重新生成 ${successCount} 个备用图片`;\r\n      toast.success(message);\r\n    }\r\n    if (failCount > 0) {\r\n      toast.warning(`${failCount} 个视频提取失败，可能是跨域限制`);\r\n    }\r\n    if (successCount === 0 && failCount === 0) {\r\n      const message = targetType\r\n        ? `${typeLabels[targetType]}没有视频需要处理`\r\n        : \"没有找到需要处理的视频\";\r\n      toast.info(message);\r\n    }\r\n  };\r\n\r\n  const handleVideoFileChange = async (e: React.ChangeEvent<HTMLInputElement>, type: \"desktop\" | \"tablet\" | \"mobile\") => {\r\n    const file = e.target.files?.[0];\r\n    if (!file) return;\r\n\r\n    if (!file.type.startsWith(\"video/\")) {\r\n      toast.error(\"请选择视频文件\");\r\n      return;\r\n    }\r\n\r\n    // Check file size (max 100MB)\r\n    if (file.size > 100 * 1024 * 1024) {\r\n      toast.error(\"视频文件大小不能超过100MB\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const templateId = editingTemplate?.id || \"new\";\r\n      \r\n      // Upload video\r\n      const result = await uploadVideo.mutateAsync({ file, type, templateId });\r\n      \r\n      // Extract first frame and upload as fallback image\r\n      try {\r\n        toast.info(\"正在提取视频第一帧作为备用图片...\");\r\n        const firstFrameBlob = await extractVideoFirstFrame(file);\r\n        const firstFrameFile = new File([firstFrameBlob], `${type}-poster-${Date.now()}.jpg`, { type: 'image/jpeg' });\r\n        const imageResult = await uploadImage.mutateAsync({ file: firstFrameFile, type, templateId });\r\n        \r\n        setFormData((prev) => ({\r\n          ...prev,\r\n          [`${type}_video_url`]: result.url,\r\n          [`${type}_image_url`]: imageResult.url,\r\n        }));\r\n        toast.success(\"视频和备用图片已自动生成\");\r\n      } catch (frameError) {\r\n        console.error(\"Failed to extract first frame:\", frameError);\r\n        // Still set video URL even if frame extraction fails\r\n        setFormData((prev) => ({\r\n          ...prev,\r\n          [`${type}_video_url`]: result.url,\r\n        }));\r\n        toast.warning(\"视频已上传，但无法自动提取第一帧，请手动上传备用图片\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Upload failed:\", error);\r\n    }\r\n  };\r\n\r\n  const handleFieldChange = (field: string, value: any) => {\r\n    setFormData((prev) => ({\r\n      ...prev,\r\n      [field]: value,\r\n    }));\r\n  };\r\n\r\n  const closeDialog = () => {\r\n    setEditingTemplate(null);\r\n    setIsCreateDialogOpen(false);\r\n    setFormData({});\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-64\">\r\n        <Loader2 className=\"w-8 h-8 animate-spin\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const renderTemplateForm = () => (\r\n    <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\r\n      <TabsList className=\"grid w-full grid-cols-4\">\r\n        <TabsTrigger value=\"media\">媒体</TabsTrigger>\r\n        <TabsTrigger value=\"overlay\">{t(\"admin.homepageTemplates.tabs.overlay\")}</TabsTrigger>\r\n        <TabsTrigger value=\"content\">{t(\"admin.homepageTemplates.tabs.content\")}</TabsTrigger>\r\n        <TabsTrigger value=\"buttons\">{t(\"admin.homepageTemplates.tabs.buttons\")}</TabsTrigger>\r\n      </TabsList>\r\n\r\n      {/* Media Tab */}\r\n      <TabsContent value=\"media\" className=\"space-y-6 mt-4\">\r\n        <p className=\"text-sm text-muted-foreground\">每个端可以独立选择图片或视频，支持混合配置（如：桌面端视频 + 移动端图片）</p>\r\n        \r\n        {/* Desktop Media */}\r\n        <div className=\"space-y-3 p-4 border rounded-lg\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <Label className=\"text-base font-medium\">桌面端</Label>\r\n            <div className=\"flex gap-2\">\r\n              <Button\r\n                type=\"button\"\r\n                size=\"sm\"\r\n                variant={(formData.desktop_media_type || 'image') === 'image' ? 'default' : 'outline'}\r\n                onClick={() => handleFieldChange('desktop_media_type', 'image')}\r\n                className=\"flex items-center gap-1\"\r\n              >\r\n                <Image className=\"w-3 h-3\" />\r\n                图片\r\n              </Button>\r\n              <Button\r\n                type=\"button\"\r\n                size=\"sm\"\r\n                variant={(formData.desktop_media_type || 'image') === 'video' ? 'default' : 'outline'}\r\n                onClick={() => handleFieldChange('desktop_media_type', 'video')}\r\n                className=\"flex items-center gap-1\"\r\n              >\r\n                <Video className=\"w-3 h-3\" />\r\n                视频\r\n              </Button>\r\n            </div>\r\n          </div>\r\n          {(formData.desktop_media_type || 'image') === 'image' ? (\r\n            <div className=\"space-y-2\">\r\n              <div className=\"flex items-center gap-4\">\r\n                {formData.desktop_image_url && (\r\n                  <div className=\"relative group\">\r\n                    <img src={formData.desktop_image_url} alt=\"Desktop\" className=\"w-32 h-20 object-cover rounded border\" />\r\n                    <Button\r\n                      type=\"button\"\r\n                      variant=\"secondary\"\r\n                      size=\"icon\"\r\n                      className=\"absolute inset-0 w-full h-full opacity-0 group-hover:opacity-100 transition-opacity bg-black/50 rounded\"\r\n                      onClick={() => handleEditExistingImage(formData.desktop_image_url!, \"desktop\")}\r\n                      title=\"编辑裁剪\"\r\n                    >\r\n                      <Crop className=\"w-5 h-5 text-white\" />\r\n                    </Button>\r\n                  </div>\r\n                )}\r\n                <div className=\"flex-1 flex gap-2\">\r\n                  <Input type=\"file\" accept=\"image/*\" onChange={(e) => handleImageFileChange(e, \"desktop\")} className=\"flex-1\" />\r\n                  <div className=\"relative\">\r\n                    <Input \r\n                      type=\"file\" \r\n                      accept=\"image/*\" \r\n                      onChange={(e) => handleImageCropClick(e, \"desktop\")} \r\n                      className=\"absolute inset-0 opacity-0 cursor-pointer\"\r\n                      id=\"desktop-crop-input\"\r\n                    />\r\n                    <Button type=\"button\" variant=\"outline\" size=\"icon\" title=\"裁剪上传新图片\">\r\n                      <Crop className=\"w-4 h-4\" />\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-2\">\r\n              <div className=\"flex items-center gap-4\">\r\n                {formData.desktop_video_url && (\r\n                  <video src={formData.desktop_video_url} className=\"w-32 h-20 object-cover rounded border\" muted />\r\n                )}\r\n                <Input type=\"file\" accept=\"video/mp4,video/webm\" onChange={(e) => handleVideoFileChange(e, \"desktop\")} />\r\n              </div>\r\n              {formData.desktop_image_url && (\r\n                <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\r\n                  <span>备用图片:</span>\r\n                  <img src={formData.desktop_image_url} alt=\"Desktop poster\" className=\"w-16 h-10 object-cover rounded border\" />\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n        \r\n        {/* Tablet Media */}\r\n        <div className=\"space-y-3 p-4 border rounded-lg\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <Label className=\"text-base font-medium\">平板端</Label>\r\n            <div className=\"flex gap-2\">\r\n              <Button\r\n                type=\"button\"\r\n                size=\"sm\"\r\n                variant={(formData.tablet_media_type || 'image') === 'image' ? 'default' : 'outline'}\r\n                onClick={() => handleFieldChange('tablet_media_type', 'image')}\r\n                className=\"flex items-center gap-1\"\r\n              >\r\n                <Image className=\"w-3 h-3\" />\r\n                图片\r\n              </Button>\r\n              <Button\r\n                type=\"button\"\r\n                size=\"sm\"\r\n                variant={(formData.tablet_media_type || 'image') === 'video' ? 'default' : 'outline'}\r\n                onClick={() => handleFieldChange('tablet_media_type', 'video')}\r\n                className=\"flex items-center gap-1\"\r\n              >\r\n                <Video className=\"w-3 h-3\" />\r\n                视频\r\n              </Button>\r\n            </div>\r\n          </div>\r\n          {(formData.tablet_media_type || 'image') === 'image' ? (\r\n            <div className=\"space-y-2\">\r\n              <div className=\"flex items-center gap-4\">\r\n                {formData.tablet_image_url && (\r\n                  <div className=\"relative group\">\r\n                    <img src={formData.tablet_image_url} alt=\"Tablet\" className=\"w-32 h-20 object-cover rounded border\" />\r\n                    <Button\r\n                      type=\"button\"\r\n                      variant=\"secondary\"\r\n                      size=\"icon\"\r\n                      className=\"absolute inset-0 w-full h-full opacity-0 group-hover:opacity-100 transition-opacity bg-black/50 rounded\"\r\n                      onClick={() => handleEditExistingImage(formData.tablet_image_url!, \"tablet\")}\r\n                      title=\"编辑裁剪\"\r\n                    >\r\n                      <Crop className=\"w-5 h-5 text-white\" />\r\n                    </Button>\r\n                  </div>\r\n                )}\r\n                <div className=\"flex-1 flex gap-2\">\r\n                  <Input type=\"file\" accept=\"image/*\" onChange={(e) => handleImageFileChange(e, \"tablet\")} className=\"flex-1\" />\r\n                  <div className=\"relative\">\r\n                    <Input \r\n                      type=\"file\" \r\n                      accept=\"image/*\" \r\n                      onChange={(e) => handleImageCropClick(e, \"tablet\")} \r\n                      className=\"absolute inset-0 opacity-0 cursor-pointer\"\r\n                      id=\"tablet-crop-input\"\r\n                    />\r\n                    <Button type=\"button\" variant=\"outline\" size=\"icon\" title=\"裁剪上传新图片\">\r\n                      <Crop className=\"w-4 h-4\" />\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-2\">\r\n              <div className=\"flex items-center gap-4\">\r\n                {formData.tablet_video_url && (\r\n                  <video src={formData.tablet_video_url} className=\"w-32 h-20 object-cover rounded border\" muted />\r\n                )}\r\n                <Input type=\"file\" accept=\"video/mp4,video/webm\" onChange={(e) => handleVideoFileChange(e, \"tablet\")} />\r\n              </div>\r\n              {formData.tablet_image_url && (\r\n                <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\r\n                  <span>备用图片:</span>\r\n                  <img src={formData.tablet_image_url} alt=\"Tablet poster\" className=\"w-16 h-10 object-cover rounded border\" />\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n        \r\n        {/* Mobile Media */}\r\n        <div className=\"space-y-3 p-4 border rounded-lg\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <Label className=\"text-base font-medium\">移动端</Label>\r\n            <div className=\"flex gap-2\">\r\n              <Button\r\n                type=\"button\"\r\n                size=\"sm\"\r\n                variant={(formData.mobile_media_type || 'image') === 'image' ? 'default' : 'outline'}\r\n                onClick={() => handleFieldChange('mobile_media_type', 'image')}\r\n                className=\"flex items-center gap-1\"\r\n              >\r\n                <Image className=\"w-3 h-3\" />\r\n                图片\r\n              </Button>\r\n              <Button\r\n                type=\"button\"\r\n                size=\"sm\"\r\n                variant={(formData.mobile_media_type || 'image') === 'video' ? 'default' : 'outline'}\r\n                onClick={() => handleFieldChange('mobile_media_type', 'video')}\r\n                className=\"flex items-center gap-1\"\r\n              >\r\n                <Video className=\"w-3 h-3\" />\r\n                视频\r\n              </Button>\r\n            </div>\r\n          </div>\r\n          {(formData.mobile_media_type || 'image') === 'image' ? (\r\n            <div className=\"space-y-2\">\r\n              <div className=\"flex items-center gap-4\">\r\n                {formData.mobile_image_url && (\r\n                  <div className=\"relative group\">\r\n                    <img src={formData.mobile_image_url} alt=\"Mobile\" className=\"w-32 h-20 object-cover rounded border\" />\r\n                    <Button\r\n                      type=\"button\"\r\n                      variant=\"secondary\"\r\n                      size=\"icon\"\r\n                      className=\"absolute inset-0 w-full h-full opacity-0 group-hover:opacity-100 transition-opacity bg-black/50 rounded\"\r\n                      onClick={() => handleEditExistingImage(formData.mobile_image_url!, \"mobile\")}\r\n                      title=\"编辑裁剪\"\r\n                    >\r\n                      <Crop className=\"w-5 h-5 text-white\" />\r\n                    </Button>\r\n                  </div>\r\n                )}\r\n                <div className=\"flex-1 flex gap-2\">\r\n                  <Input type=\"file\" accept=\"image/*\" onChange={(e) => handleImageFileChange(e, \"mobile\")} className=\"flex-1\" />\r\n                  <div className=\"relative\">\r\n                    <Input \r\n                      type=\"file\" \r\n                      accept=\"image/*\" \r\n                      onChange={(e) => handleImageCropClick(e, \"mobile\")} \r\n                      className=\"absolute inset-0 opacity-0 cursor-pointer\"\r\n                      id=\"mobile-crop-input\"\r\n                    />\r\n                    <Button type=\"button\" variant=\"outline\" size=\"icon\" title=\"裁剪上传新图片\">\r\n                      <Crop className=\"w-4 h-4\" />\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-2\">\r\n              <div className=\"flex items-center gap-4\">\r\n                {formData.mobile_video_url && (\r\n                  <video src={formData.mobile_video_url} className=\"w-32 h-20 object-cover rounded border\" muted />\r\n                )}\r\n                <Input type=\"file\" accept=\"video/mp4,video/webm\" onChange={(e) => handleVideoFileChange(e, \"mobile\")} />\r\n              </div>\r\n              {formData.mobile_image_url && (\r\n                <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\r\n                  <span>备用图片:</span>\r\n                  <img src={formData.mobile_image_url} alt=\"Mobile poster\" className=\"w-16 h-10 object-cover rounded border\" />\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Regenerate posters button */}\r\n        {(formData.desktop_video_url || formData.tablet_video_url || formData.mobile_video_url) && (\r\n          <div className=\"pt-4 border-t\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <Label className=\"text-sm font-medium\">备用图片管理</Label>\r\n                <p className=\"text-xs text-muted-foreground\">上传视频时会自动截取第一帧作为备用图片</p>\r\n              </div>\r\n              <DropdownMenu>\r\n                <DropdownMenuTrigger asChild>\r\n                  <Button \r\n                    type=\"button\" \r\n                    variant=\"outline\" \r\n                    size=\"sm\"\r\n                    disabled={isRegenerating}\r\n                  >\r\n                    {isRegenerating ? (\r\n                      <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\r\n                    ) : (\r\n                      <RefreshCw className=\"w-4 h-4 mr-2\" />\r\n                    )}\r\n                    重新生成第一帧\r\n                    <ChevronDown className=\"w-4 h-4 ml-2\" />\r\n                  </Button>\r\n                </DropdownMenuTrigger>\r\n                <DropdownMenuContent align=\"end\">\r\n                  <DropdownMenuItem onClick={() => regeneratePosters()}>\r\n                    全部重新生成\r\n                  </DropdownMenuItem>\r\n                  <DropdownMenuSeparator />\r\n                  <DropdownMenuItem \r\n                    onClick={() => regeneratePosters(\"desktop\")}\r\n                    disabled={!formData.desktop_video_url}\r\n                    className={!formData.desktop_video_url ? \"opacity-50 cursor-not-allowed\" : \"\"}\r\n                  >\r\n                    仅桌面端\r\n                  </DropdownMenuItem>\r\n                  <DropdownMenuItem \r\n                    onClick={() => regeneratePosters(\"tablet\")}\r\n                    disabled={!formData.tablet_video_url}\r\n                    className={!formData.tablet_video_url ? \"opacity-50 cursor-not-allowed\" : \"\"}\r\n                  >\r\n                    仅平板端\r\n                  </DropdownMenuItem>\r\n                  <DropdownMenuItem \r\n                    onClick={() => regeneratePosters(\"mobile\")}\r\n                    disabled={!formData.mobile_video_url}\r\n                    className={!formData.mobile_video_url ? \"opacity-50 cursor-not-allowed\" : \"\"}\r\n                  >\r\n                    仅移动端\r\n                  </DropdownMenuItem>\r\n                </DropdownMenuContent>\r\n              </DropdownMenu>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"grid grid-cols-2 gap-4\">\r\n          <div className=\"space-y-2\">\r\n            <Label>{t(\"admin.homepageTemplates.duration\")}</Label>\r\n            <Input\r\n              type=\"number\"\r\n              value={formData.duration || 5000}\r\n              onChange={(e) => handleFieldChange(\"duration\", parseInt(e.target.value) || 5000)}\r\n              min={1000}\r\n              max={30000}\r\n            />\r\n            <p className=\"text-xs text-muted-foreground\">{t(\"admin.homepageTemplates.durationHint\")}</p>\r\n          </div>\r\n          <div className=\"space-y-2\">\r\n            <Label>{t(\"admin.homepageTemplates.sortOrder\")}</Label>\r\n            <Input\r\n              type=\"number\"\r\n              value={formData.sort_order || 0}\r\n              onChange={(e) => handleFieldChange(\"sort_order\", parseInt(e.target.value) || 0)}\r\n            />\r\n          </div>\r\n        </div>\r\n      </TabsContent>\r\n\r\n      {/* Overlay Tab */}\r\n      <TabsContent value=\"overlay\" className=\"space-y-4 mt-4\">\r\n        <div className=\"space-y-4\">\r\n          <div className=\"space-y-2\">\r\n            <Label>{t(\"admin.homepageTemplates.baseOverlayOpacity\")}: {formData.overlay_opacity || 40}%</Label>\r\n            <Slider\r\n              value={[formData.overlay_opacity || 40]}\r\n              onValueChange={([value]) => handleFieldChange(\"overlay_opacity\", value)}\r\n              max={100}\r\n              step={1}\r\n            />\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <Label>{t(\"admin.homepageTemplates.gradientDirection\")}</Label>\r\n            <Select\r\n              value={formData.overlay_gradient_direction || \"to-b\"}\r\n              onValueChange={(value) => handleFieldChange(\"overlay_gradient_direction\", value)}\r\n            >\r\n              <SelectTrigger>\r\n                <SelectValue />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"to-b\">{t(\"admin.homepageTemplates.gradientDirection.toBottom\")}</SelectItem>\r\n                <SelectItem value=\"to-t\">{t(\"admin.homepageTemplates.gradientDirection.toTop\")}</SelectItem>\r\n                <SelectItem value=\"to-r\">{t(\"admin.homepageTemplates.gradientDirection.toRight\")}</SelectItem>\r\n                <SelectItem value=\"to-l\">{t(\"admin.homepageTemplates.gradientDirection.toLeft\")}</SelectItem>\r\n                <SelectItem value=\"to-br\">{t(\"admin.homepageTemplates.gradientDirection.toBottomRight\")}</SelectItem>\r\n                <SelectItem value=\"to-tr\">{t(\"admin.homepageTemplates.gradientDirection.toTopRight\")}</SelectItem>\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n\r\n          <div className=\"grid grid-cols-3 gap-4\">\r\n            <div className=\"space-y-2\">\r\n              <Label>{t(\"admin.homepageTemplates.startOpacity\")}</Label>\r\n              <Input\r\n                type=\"number\"\r\n                min=\"0\"\r\n                max=\"100\"\r\n                value={formData.overlay_gradient_from_opacity || 30}\r\n                onChange={(e) => handleFieldChange(\"overlay_gradient_from_opacity\", parseInt(e.target.value) || 0)}\r\n              />\r\n            </div>\r\n            <div className=\"space-y-2\">\r\n              <Label>{t(\"admin.homepageTemplates.middleOpacity\")}</Label>\r\n              <Input\r\n                type=\"number\"\r\n                min=\"0\"\r\n                max=\"100\"\r\n                value={formData.overlay_gradient_via_opacity || 25}\r\n                onChange={(e) => handleFieldChange(\"overlay_gradient_via_opacity\", parseInt(e.target.value) || 0)}\r\n              />\r\n            </div>\r\n            <div className=\"space-y-2\">\r\n              <Label>{t(\"admin.homepageTemplates.endOpacity\")}</Label>\r\n              <Input\r\n                type=\"number\"\r\n                min=\"0\"\r\n                max=\"100\"\r\n                value={formData.overlay_gradient_to_opacity || 40}\r\n                onChange={(e) => handleFieldChange(\"overlay_gradient_to_opacity\", parseInt(e.target.value) || 0)}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <Label>{t(\"admin.homepageTemplates.backgroundBlur\")}: {formData.background_blur || 0}px</Label>\r\n            <Slider\r\n              value={[formData.background_blur || 0]}\r\n              onValueChange={([value]) => handleFieldChange(\"background_blur\", value)}\r\n              max={50}\r\n              step={1}\r\n            />\r\n          </div>\r\n        </div>\r\n      </TabsContent>\r\n\r\n      {/* Content Tab */}\r\n      <TabsContent value=\"content\" className=\"space-y-4 mt-4\">\r\n        <div className=\"space-y-4\">\r\n          <div className=\"space-y-2\">\r\n            <Label>{t(\"admin.homepageTemplates.titleChinese\")}</Label>\r\n            <Input value={formData.title_zh || \"\"} onChange={(e) => handleFieldChange(\"title_zh\", e.target.value)} />\r\n          </div>\r\n          <div className=\"space-y-2\">\r\n            <Label>{t(\"admin.homepageTemplates.titleEnglish\")}</Label>\r\n            <Input value={formData.title_en || \"\"} onChange={(e) => handleFieldChange(\"title_en\", e.target.value)} />\r\n          </div>\r\n          <div className=\"space-y-2\">\r\n            <Label>{t(\"admin.homepageTemplates.titlePortuguese\")}</Label>\r\n            <Input value={formData.title_pt || \"\"} onChange={(e) => handleFieldChange(\"title_pt\", e.target.value)} />\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <Label>{t(\"admin.homepageTemplates.descriptionChinese\")}</Label>\r\n            <Textarea value={formData.description_zh || \"\"} onChange={(e) => handleFieldChange(\"description_zh\", e.target.value)} />\r\n          </div>\r\n          <div className=\"space-y-2\">\r\n            <Label>{t(\"admin.homepageTemplates.descriptionEnglish\")}</Label>\r\n            <Textarea value={formData.description_en || \"\"} onChange={(e) => handleFieldChange(\"description_en\", e.target.value)} />\r\n          </div>\r\n          <div className=\"space-y-2\">\r\n            <Label>{t(\"admin.homepageTemplates.descriptionPortuguese\")}</Label>\r\n            <Textarea value={formData.description_pt || \"\"} onChange={(e) => handleFieldChange(\"description_pt\", e.target.value)} />\r\n          </div>\r\n        </div>\r\n      </TabsContent>\r\n\r\n      {/* Buttons Tab */}\r\n      <TabsContent value=\"buttons\" className=\"space-y-4 mt-4\">\r\n        <Card>\r\n          <CardHeader className=\"py-3\">\r\n            <CardTitle className=\"text-lg\">{t(\"admin.homepageTemplates.primaryButton\")}</CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-3\">\r\n            <div className=\"grid grid-cols-3 gap-4\">\r\n              <div className=\"space-y-2\">\r\n                <Label>{t(\"admin.homepageTemplates.chinese\")}</Label>\r\n                <Input value={formData.primary_button_text_zh || \"\"} onChange={(e) => handleFieldChange(\"primary_button_text_zh\", e.target.value)} />\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <Label>{t(\"admin.homepageTemplates.english\")}</Label>\r\n                <Input value={formData.primary_button_text_en || \"\"} onChange={(e) => handleFieldChange(\"primary_button_text_en\", e.target.value)} />\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <Label>{t(\"admin.homepageTemplates.portuguese\")}</Label>\r\n                <Input value={formData.primary_button_text_pt || \"\"} onChange={(e) => handleFieldChange(\"primary_button_text_pt\", e.target.value)} />\r\n              </div>\r\n            </div>\r\n            <div className=\"space-y-2\">\r\n              <Label>{t(\"admin.homepageTemplates.link\")}</Label>\r\n              <Input value={formData.primary_button_link || \"\"} onChange={(e) => handleFieldChange(\"primary_button_link\", e.target.value)} />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"py-3\">\r\n            <CardTitle className=\"text-lg\">{t(\"admin.homepageTemplates.secondaryButton\")}</CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-3\">\r\n            <div className=\"grid grid-cols-3 gap-4\">\r\n              <div className=\"space-y-2\">\r\n                <Label>{t(\"admin.homepageTemplates.chinese\")}</Label>\r\n                <Input value={formData.secondary_button_text_zh || \"\"} onChange={(e) => handleFieldChange(\"secondary_button_text_zh\", e.target.value)} />\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <Label>{t(\"admin.homepageTemplates.english\")}</Label>\r\n                <Input value={formData.secondary_button_text_en || \"\"} onChange={(e) => handleFieldChange(\"secondary_button_text_en\", e.target.value)} />\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <Label>{t(\"admin.homepageTemplates.portuguese\")}</Label>\r\n                <Input value={formData.secondary_button_text_pt || \"\"} onChange={(e) => handleFieldChange(\"secondary_button_text_pt\", e.target.value)} />\r\n              </div>\r\n            </div>\r\n            <div className=\"space-y-2\">\r\n              <Label>{t(\"admin.homepageTemplates.link\")}</Label>\r\n              <Input value={formData.secondary_button_link || \"\"} onChange={(e) => handleFieldChange(\"secondary_button_link\", e.target.value)} />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader className=\"py-3\">\r\n            <CardTitle className=\"text-lg\">{t(\"admin.homepageTemplates.mapButton\")}</CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-3\">\r\n            <div className=\"grid grid-cols-3 gap-4\">\r\n              <div className=\"space-y-2\">\r\n                <Label>{t(\"admin.homepageTemplates.chinese\")}</Label>\r\n                <Input value={(formData as any).map_button_text_zh || \"\"} onChange={(e) => handleFieldChange(\"map_button_text_zh\", e.target.value)} />\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <Label>{t(\"admin.homepageTemplates.english\")}</Label>\r\n                <Input value={(formData as any).map_button_text_en || \"\"} onChange={(e) => handleFieldChange(\"map_button_text_en\", e.target.value)} />\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <Label>{t(\"admin.homepageTemplates.portuguese\")}</Label>\r\n                <Input value={(formData as any).map_button_text_pt || \"\"} onChange={(e) => handleFieldChange(\"map_button_text_pt\", e.target.value)} />\r\n              </div>\r\n            </div>\r\n            <div className=\"space-y-2\">\r\n              <Label>{t(\"admin.homepageTemplates.link\")}</Label>\r\n              <Input value={(formData as any).map_button_link || \"\"} onChange={(e) => handleFieldChange(\"map_button_link\", e.target.value)} placeholder=\"/map\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n      </TabsContent>\r\n    </Tabs>\r\n  );\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold\">{t(\"admin.homepageTemplates\")}</h1>\r\n          <p className=\"text-muted-foreground mt-2\">{t(\"admin.homepageTemplatesDescription\")}</p>\r\n        </div>\r\n        <Button onClick={handleCreate}>\r\n          <Plus className=\"w-4 h-4 mr-2\" />\r\n          {t(\"admin.homepageTemplates.createTemplate\")}\r\n        </Button>\r\n      </div>\r\n\r\n      {/* Template List */}\r\n      <div className=\"grid gap-4\">\r\n        {templates?.map((template) => (\r\n          <Card key={template.id} className={!template.is_active ? \"opacity-60\" : \"\"}>\r\n            <CardContent className=\"p-4\">\r\n              <div className=\"flex items-center gap-4\">\r\n                <div className=\"flex items-center gap-2 text-muted-foreground\">\r\n                  <GripVertical className=\"w-5 h-5\" />\r\n                  <span className=\"text-sm font-medium\">#{template.sort_order}</span>\r\n                </div>\r\n                \r\n                {template.desktop_image_url && (\r\n                  <img \r\n                    src={template.desktop_image_url} \r\n                    alt=\"Preview\" \r\n                    className=\"w-24 h-16 object-cover rounded border\"\r\n                  />\r\n                )}\r\n\r\n                <div className=\"flex-1 min-w-0\">\r\n                  <h3 className=\"font-semibold truncate\">{template.title_zh}</h3>\r\n                  <p className=\"text-sm text-muted-foreground truncate\">{template.description_zh}</p>\r\n                  <div className=\"flex items-center gap-2 mt-1\">\r\n                    <Clock className=\"w-3 h-3 text-muted-foreground\" />\r\n                    <span className=\"text-xs text-muted-foreground\">{template.duration / 1000}{t(\"admin.homepageTemplates.seconds\")}</span>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"flex items-center gap-2\">\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"icon\"\r\n                    onClick={() => setPreviewTemplate(template)}\r\n                    title={t(\"admin.homepageTemplates.preview\") || \"预览\"}\r\n                  >\r\n                    <Play className=\"w-4 h-4\" />\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"icon\"\r\n                    onClick={() => handleToggleActive(template)}\r\n                    title={template.is_active ? t(\"admin.homepageTemplates.hide\") : t(\"admin.homepageTemplates.show\")}\r\n                  >\r\n                    {template.is_active ? <Eye className=\"w-4 h-4\" /> : <EyeOff className=\"w-4 h-4\" />}\r\n                  </Button>\r\n                  <Button variant=\"ghost\" size=\"icon\" onClick={() => handleEdit(template)}>\r\n                    <Edit className=\"w-4 h-4\" />\r\n                  </Button>\r\n                  <AlertDialog>\r\n                    <AlertDialogTrigger asChild>\r\n                      <Button variant=\"ghost\" size=\"icon\" className=\"text-destructive hover:text-destructive\">\r\n                        <Trash2 className=\"w-4 h-4\" />\r\n                      </Button>\r\n                    </AlertDialogTrigger>\r\n                    <AlertDialogContent>\r\n                      <AlertDialogHeader>\r\n                        <AlertDialogTitle>{t(\"admin.confirmDelete\")}</AlertDialogTitle>\r\n                        <AlertDialogDescription>\r\n                          {t(\"admin.homepageTemplates.deleteTemplateConfirm\")}\r\n                        </AlertDialogDescription>\r\n                      </AlertDialogHeader>\r\n                      <AlertDialogFooter>\r\n                        <AlertDialogCancel>{t(\"common.cancel\")}</AlertDialogCancel>\r\n                        <AlertDialogAction onClick={() => handleDelete(template.id)}>{t(\"common.delete\")}</AlertDialogAction>\r\n                      </AlertDialogFooter>\r\n                    </AlertDialogContent>\r\n                  </AlertDialog>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        ))}\r\n\r\n        {(!templates || templates.length === 0) && (\r\n          <Card>\r\n            <CardContent className=\"p-8 text-center text-muted-foreground\">\r\n              {t(\"admin.homepageTemplates.noTemplates\")}\r\n            </CardContent>\r\n          </Card>\r\n        )}\r\n      </div>\r\n\r\n      {/* Edit/Create Dialog */}\r\n      <Dialog open={!!editingTemplate || isCreateDialogOpen} onOpenChange={closeDialog}>\r\n        <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto\">\r\n          <DialogHeader>\r\n            <DialogTitle>{editingTemplate ? t(\"admin.homepageTemplates.editTemplate\") : t(\"admin.homepageTemplates.createTemplate\")}</DialogTitle>\r\n            <DialogDescription>\r\n              {t(\"admin.homepageTemplates.configureTemplate\")}\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n\r\n          {renderTemplateForm()}\r\n\r\n          <div className=\"flex justify-between gap-2 mt-4\">\r\n            <Button \r\n              variant=\"outline\" \r\n              onClick={() => setPreviewTemplate(formData)}\r\n              disabled={!formData.desktop_image_url && !formData.mobile_image_url}\r\n            >\r\n              <Play className=\"w-4 h-4 mr-2\" />\r\n              预览\r\n            </Button>\r\n            <div className=\"flex gap-2\">\r\n              <Button variant=\"outline\" onClick={closeDialog}>{t(\"common.cancel\")}</Button>\r\n              <Button onClick={handleSave} disabled={createTemplate.isPending || updateTemplate.isPending}>\r\n                {(createTemplate.isPending || updateTemplate.isPending) && (\r\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\r\n                )}\r\n                <Save className=\"w-4 h-4 mr-2\" />\r\n                {t(\"common.save\")}\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Preview Dialog */}\r\n      {previewTemplate && (\r\n        <div className=\"fixed inset-0 z-50 bg-black\">\r\n          <Button\r\n            variant=\"ghost\"\r\n            size=\"icon\"\r\n            className=\"absolute top-4 right-4 z-50 text-white hover:bg-white/20\"\r\n            onClick={() => setPreviewTemplate(null)}\r\n          >\r\n            <X className=\"w-6 h-6\" />\r\n          </Button>\r\n          <TemplatePreview template={previewTemplate} onClose={() => setPreviewTemplate(null)} />\r\n        </div>\r\n      )}\r\n\r\n      {/* Crop Dialog */}\r\n      {cropImageSource && (\r\n        <HomepageMediaCropDialog\r\n          open={cropDialogOpen}\r\n          onOpenChange={(open) => {\r\n            setCropDialogOpen(open);\r\n            if (!open) setCropImageSource(null);\r\n          }}\r\n          imageSource={cropImageSource}\r\n          deviceType={cropDeviceType}\r\n          onCropComplete={handleCropComplete}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdminHomepageTemplates;\r\n"],"names":["DEVICE_CONFIGS","Monitor","Tablet","Smartphone","centerAspectCrop","mediaWidth","mediaHeight","aspect","centerCrop","makeAspectCrop","HomepageMediaCropDialog","open","onOpenChange","imageSource","deviceType","onCropComplete","t","useTranslation","imgSrc","setImgSrc","useState","crop","setCrop","completedCrop","setCompletedCrop","selectedDevice","setSelectedDevice","imgRef","useRef","isCropping","setIsCropping","isLoading","setIsLoading","config","DeviceIcon","useEffect","reader","onImageLoad","useCallback","e","width","height","getCroppedImg","image","canvas","ctx","scaleX","scaleY","cropWidthPx","cropHeightPx","outputWidth","outputHeight","scale","resolve","reject","blob","handleCropConfirm","croppedBlob","fileName","croppedFile","error","Dialog","jsxs","DialogContent","DialogHeader","DialogTitle","jsx","CropIcon","DialogDescription","Tabs","v","TabsList","TabsTrigger","Alert","AlertDescription","Badge","Maximize2","Loader2","ReactCrop","c","DialogFooter","Button","sushiRamenHero","sushiRamenMobile","TemplatePreview","template","onClose","i18n","currentLang","getLocalizedText","field","getDeviceType","getOverlayOpacity","getOverlayStyle","baseOpacity","direction","normalizeOpacity","value","defaultValue","normalizedBaseOpacity","fromOpacity","viaOpacity","toOpacity","cssDirection","colorMap","fromColor","viaColor","toColor","mobileImg","tabletImg","desktopImg","blurAmount","desktopMediaType","tabletMediaType","mobileVideo","tabletVideo","desktopVideo","title","subtitle","description","primaryButtonText","secondaryButtonText","AdminHomepageTemplates","templates","useHomepageTemplates","createTemplate","useCreateHomepageTemplate","updateTemplate","useUpdateHomepageTemplate","deleteTemplate","useDeleteHomepageTemplate","uploadImage","useUploadTemplateImage","uploadVideo","useUploadTemplateVideo","editingTemplate","setEditingTemplate","isCreateDialogOpen","setIsCreateDialogOpen","formData","setFormData","activeTab","setActiveTab","previewTemplate","setPreviewTemplate","cropDialogOpen","setCropDialogOpen","cropImageSource","setCropImageSource","cropDeviceType","setCropDeviceType","handleCreate","handleEdit","handleSave","handleDelete","id","handleToggleActive","handleImageFileChange","type","file","toast","templateId","result","prev","handleImageCropClick","handleEditExistingImage","imageUrl","handleCropComplete","extractVideoFirstFrame","videoFile","video","hasResolved","captureFrame","extractFirstFrameFromUrl","videoUrl","isRegenerating","setIsRegenerating","regeneratePosters","targetType","videoTypes","typeLabels","successCount","failCount","firstFrameBlob","firstFrameFile","imageResult","message","handleVideoFileChange","frameError","handleFieldChange","closeDialog","renderTemplateForm","TabsContent","Label","Image","Video","Crop","Input","DropdownMenu","DropdownMenuTrigger","RefreshCw","ChevronDown","DropdownMenuContent","DropdownMenuItem","DropdownMenuSeparator","Slider","Select","SelectTrigger","SelectValue","SelectContent","SelectItem","Textarea","Card","CardHeader","CardTitle","CardContent","Plus","GripVertical","Clock","Play","Eye","EyeOff","Edit","AlertDialog","AlertDialogTrigger","Trash2","AlertDialogContent","AlertDialogHeader","AlertDialogTitle","AlertDialogDescription","AlertDialogFooter","AlertDialogCancel","AlertDialogAction","Save","X"],"mappings":"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"}