import{u as L,r as h,am as E,j as e,C as g,m as y,P as I,B as N,l as D,i as q,w as A,ao as B,I as j,f as v,L as O,v as $,ab as p}from"./index-QLT-vsIo.js";import{u as H}from"./index.esm-C-v7GtcD.js";import{o as J,s as x,a as R,e as V,t as G}from"./types-n9UQDQTH.js";import{C as K}from"./checkbox-pu4GXP_T.js";import{F as Q,a as i,b as o,c,d as m,e as d,f as W}from"./form-DLPajT4v.js";import{C as X}from"./circle-check-PnkWIyLR.js";const C=["booking","delivery","qrcode"],ae=()=>{const{t:s,i18n:u}=L(),[_,f]=h.useState(!1),[S,b]=h.useState(!1),{settings:r}=E(),w=h.useMemo(()=>J({name:x().min(2,{message:s("joinUs.nameMin")}),email:x().email({message:s("joinUs.emailInvalid")}),phone:x().min(6,{message:s("joinUs.phoneMin")}),restaurant_name:x().min(2,{message:s("joinUs.restaurantNameMin")}),restaurant_address:x().min(2,{message:s("joinUs.addressMin")}),features_selected:R(V(C)).min(1,{message:s("joinUs.featuresMin")})}),[s]),a=H({resolver:G(w),defaultValues:{name:"",email:"",phone:"",restaurant_name:"",restaurant_address:"",features_selected:[]}}),F=async n=>{f(!0);try{const t=u.language||"en",{error:l}=await $.functions.invoke("send-join-request-email",{body:{...n,language:t}});if(l){if(l.message.includes("rate_limit_exceeded"))p({title:s("joinUs.rateLimitError"),description:s("joinUs.rateLimitErrorDesc"),variant:"destructive"});else throw l;return}b(!0),a.reset(),p({title:s("joinUs.successTitle"),description:s("joinUs.successDescription")})}catch(t){console.error("Error submitting join request:",t),p({title:s("common.error"),description:s("joinUs.submitError"),variant:"destructive"})}finally{f(!1)}},T=()=>{const n=u.language;return n==="zh"&&(r!=null&&r.join_success_title_zh)?r.join_success_title_zh:n==="pt"&&(r!=null&&r.join_success_title_pt)?r.join_success_title_pt:r!=null&&r.join_success_title_en?r.join_success_title_en:s("joinUs.successTitle")},M=()=>{const n=u.language;return n==="zh"&&(r!=null&&r.join_success_message_zh)?r.join_success_message_zh:n==="pt"&&(r!=null&&r.join_success_message_pt)?r.join_success_message_pt:r!=null&&r.join_success_message_en?r.join_success_message_en:s("joinUs.successMessage")},P=(r==null?void 0:r.join_contact_phone)||"968815050";return S?e.jsx("div",{className:"min-h-screen pt-20 pb-12 px-4 bg-secondary/20",children:e.jsx("div",{className:"container mx-auto max-w-2xl",children:e.jsx(g,{className:"border-primary",children:e.jsxs(y,{className:"pt-12 pb-12 text-center",children:[e.jsx(X,{className:"w-16 h-16 text-primary mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-4",children:T()}),e.jsx("p",{className:"text-muted-foreground mb-4 max-w-md mx-auto",children:M()}),e.jsxs("div",{className:"flex items-center justify-center gap-2 text-primary font-semibold mb-6",children:[e.jsx(I,{className:"w-5 h-5"}),e.jsx("span",{children:P})]}),e.jsx(N,{onClick:()=>b(!1),children:s("joinUs.submitAnother")})]})})})}):e.jsx("div",{className:"min-h-screen pt-4 pb-12 px-4 bg-secondary/20",children:e.jsx("div",{className:"container mx-auto max-w-3xl",children:e.jsxs(g,{children:[e.jsxs(D,{className:"text-center space-y-2",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(q,{className:"w-12 h-12 text-primary"})}),e.jsx(A,{className:"text-3xl font-bold",children:s("joinUs.title")}),e.jsx(B,{className:"text-base",children:s("joinUs.description")})]}),e.jsx(y,{children:e.jsx(Q,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(F),className:"space-y-6",children:[e.jsx(i,{control:a.control,name:"name",render:({field:n})=>e.jsxs(o,{children:[e.jsx(c,{children:s("joinUs.name")}),e.jsx(m,{children:e.jsx(j,{placeholder:s("joinUs.namePlaceholder"),...n})}),e.jsx(d,{})]})}),e.jsx(i,{control:a.control,name:"email",render:({field:n})=>e.jsxs(o,{children:[e.jsx(c,{children:s("joinUs.email")}),e.jsx(m,{children:e.jsx(j,{type:"email",placeholder:s("joinUs.emailPlaceholder"),...n})}),e.jsx(d,{})]})}),e.jsx(i,{control:a.control,name:"phone",render:({field:n})=>e.jsxs(o,{children:[e.jsx(c,{children:s("joinUs.phone")}),e.jsx(m,{children:e.jsx(j,{type:"tel",placeholder:s("joinUs.phonePlaceholder"),...n})}),e.jsx(d,{})]})}),e.jsx(i,{control:a.control,name:"restaurant_name",render:({field:n})=>e.jsxs(o,{children:[e.jsx(c,{children:s("joinUs.restaurantName")}),e.jsx(m,{children:e.jsx(j,{placeholder:s("joinUs.restaurantNamePlaceholder"),...n})}),e.jsx(d,{})]})}),e.jsx(i,{control:a.control,name:"restaurant_address",render:({field:n})=>e.jsxs(o,{children:[e.jsx(c,{children:s("joinUs.restaurantAddress")}),e.jsx(m,{children:e.jsx(j,{placeholder:s("joinUs.restaurantAddressPlaceholder"),...n})}),e.jsx(d,{})]})}),e.jsx(i,{control:a.control,name:"features_selected",render:()=>e.jsxs(o,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(c,{children:s("joinUs.featuresNeeded")}),e.jsx(W,{children:s("joinUs.featuresDescription")})]}),C.map(n=>e.jsx(i,{control:a.control,name:"features_selected",render:({field:t})=>{var l;return e.jsxs(o,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(m,{children:e.jsx(K,{checked:(l=t.value)==null?void 0:l.includes(n),onCheckedChange:k=>{var U;return k?t.onChange([...t.value,n]):t.onChange((U=t.value)==null?void 0:U.filter(z=>z!==n))}})}),e.jsx(c,{className:"font-normal cursor-pointer",children:s(`joinUs.feature.${n}`)})]},n)}},n)),e.jsx(d,{})]})}),e.jsxs("div",{className:"text-xs text-muted-foreground text-center pb-4",children:[s("joinUs.consentText")," ",e.jsx(v,{to:"/privacy-policy",className:"text-primary hover:underline",children:s("joinUs.privacyPolicy")})," ",s("joinUs.and")," ",e.jsx(v,{to:"/terms-of-service",className:"text-primary hover:underline",children:s("joinUs.termsOfService")})]}),e.jsxs(N,{type:"submit",className:"w-full",size:"lg",disabled:_,children:[_&&e.jsx(O,{className:"mr-2 h-4 w-4 animate-spin"}),s("joinUs.submit")]})]})})})]})})})};export{ae as default};
