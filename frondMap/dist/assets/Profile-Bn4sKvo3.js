const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/vendor-supabase-CQWbleDe.js","assets/vendor-react-87iFmKFJ.js","assets/vendor-i18n-AOdgFpXS.js","assets/vendor-editor-B1vH4T8i.js","assets/vendor-utils-vwQGbBim.js","assets/vendor-react-CG6K1Se3.css"])))=>i.map(i=>d[i]);
import{p as M,j as e,bb as Ve,s as We,u as ha,r as x,bV as $a,bW as Oa,M as Ta,bX as Ra,ak as xs,w as v,bd as _e,bY as Vs,bc as Ps,y as Ua,bB as za,bZ as qa,b_ as La,b$ as Ha,an as Ge,c0 as Ba,c1 as Ka,c2 as Ze,be as je,b0 as xe,L as I,c3 as Gs,b5 as pe,bG as Bs,c4 as Qa,bQ as Ma,bU as Va,aM as Ds,c5 as Ga,bL as Es,bM as Wa,c6 as Fs,c7 as He,c8 as ze,c9 as Ws,a4 as Xa,ca as Ya,cb as Za,aw as Ja,cc as et,am as Xs,aK as Be,q as st,a_ as Je,cd as Ys,aW as Zs,b6 as Js,bt as ea,ce as sa,bS as aa}from"./vendor-react-87iFmKFJ.js";import{D as Se,c as ke,d as Ae,e as Pe,B as j,u as De,s as A,M as ua,a5 as fa,a6 as at,a0 as ja,h as g,Y as ps,V as Is,W as $s,X as Os,I as C,Z as k,a7 as ls,a8 as cs,a9 as os,aa as ds,ab as ms,A as ie,q as ne,r as le,t as ce,v as oe,w as de,x as me,y as ee,_ as tt,a3 as ga,C as D,m as z,E as B,n as E,a4 as Q,$ as rt,ac as it,U as nt,ad as lt,S as ks,a1 as ct,a as ot,j as dt,b as mt}from"./index-CQ-le21e.js";import{T as Ke,a as Qe,b as O,c as T}from"./tabs-C9rpu1PN.js";import{C as xt,a as pt,b as es}from"./carousel-BwUf62jQ.js";import{a as ht}from"./useActivities-C5706xMJ.js";import{u as us}from"./useLocalizedContent-CFh79NZC.js";import{u as ut}from"./useActivityParticipation-DK7m1fRx.js";import{d as ft}from"./useCoupons-q4bNqZ4S.js";import{u as jt}from"./useCommunityPosts-Bg3kGs1G.js";import{P as ta}from"./PostGridCard-BU9qQ7t7.js";import{u as gt,a as vt,b as Nt,c as yt,d as wt,P as ra}from"./PointsHistoryDialog-BJPfESIN.js";import{C as bt}from"./checkbox-Dp2o64iN.js";import{A as ia}from"./ActivityTermsAgreement-D70VPlhk.js";import{S as Ts}from"./separator-Qxn9Y85X.js";import{D as fe,N as Ct,O as ss,H as hs,p as _t,I as St,J as kt}from"./vendor-utils-vwQGbBim.js";import{P as At}from"./PullToRefresh-DyKBHUfi.js";import{C as Pt,a as Dt,b as Et}from"./collapsible-DE4DVYv9.js";import{u as Ft,a as It,b as $t,c as Ot}from"./useInvitationCodes-D4w44nop.js";import{F as Tt,a as as,b as ts,c as rs,d as is,e as ns}from"./form-G6qNN0ej.js";import{u as Rt}from"./useSavedRecipes-Ds4u60uO.js";import{g as Ut,c as zt}from"./geolocation-YPf7LJYy.js";import"./vendor-i18n-AOdgFpXS.js";import"./vendor-editor-B1vH4T8i.js";import"./vendor-supabase-CQWbleDe.js";import"./useLoginRequired-D9_38lwI.js";import"./EditRecipeDialog-BSnhuEsU.js";import"./drawer-DoDJ2fg7.js";import"./popover-DwPLELKI.js";import"./useRestaurants-UDhE5tzq.js";import"./progress-CptfLxFa.js";import"./usePoints-B89Es_Aj.js";import"./useActivityRules-BN1X-jcU.js";function qt({open:s,onOpenChange:a,activity:c}){const{t}=M();return e.jsx(Se,{open:s,onOpenChange:a,children:e.jsxs(ke,{className:"max-w-[90vw] sm:max-w-md",children:[e.jsx(Ae,{children:e.jsx(Pe,{className:"text-lg font-semibold line-clamp-2",children:c.title})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(j,{variant:"secondary",className:"flex items-center gap-1.5 w-fit",children:[e.jsx(Ve,{className:"w-3.5 h-3.5 fill-primary text-primary"}),t("profile.activityFavorited")]}),c.image_url&&e.jsx("div",{className:"w-full aspect-video rounded-lg overflow-hidden bg-secondary/30",children:e.jsx("img",{src:c.image_url,alt:c.title,className:"w-full h-full object-cover"})}),e.jsx("div",{className:`text-muted-foreground text-sm prose prose-sm max-w-none line-clamp-4\r
              [&_span[style*='color']]:!text-inherit`,dangerouslySetInnerHTML:{__html:c.content}})]})]})})}const Lt=()=>{const{user:s}=De();return We({queryKey:["favorites-restaurants",s?.id],queryFn:async()=>{if(!s)return[];const{data:a,error:c}=await A.from("favorites").select("restaurant_id").eq("user_id",s.id);if(c)throw console.error("Error fetching favorites:",c),c;if(!a||a.length===0)return[];const t=a.map(o=>o.restaurant_id),{data:l,error:i}=await A.from("restaurants").select("*").in("id",t).eq("visible",!0);if(i)throw console.error("Error fetching favorite restaurants:",i),i;return l||[]},enabled:!!s})},Ht=()=>{const{user:s}=De();return We({queryKey:["user-comments",s?.id],queryFn:async()=>{if(!s)return[];const{data:a,error:c}=await A.from("comments").select("*").eq("user_id",s.id).is("parent_id",null).order("created_at",{ascending:!1});if(c)throw c;if(!a||a.length===0)return[];const t=a.filter(n=>n.target_type==="restaurant").map(n=>n.target_id),l=a.filter(n=>n.target_type==="activity").map(n=>n.target_id),i=new Map;if(t.length>0){const{data:n}=await A.from("restaurants").select("id, name, name_en, name_pt").in("id",t);n?.forEach(p=>{i.set(p.id,{name:p.name,name_en:p.name_en||void 0,name_pt:p.name_pt||void 0})})}const o=new Map;if(l.length>0){const{data:n}=await A.from("activities").select("id, title_zh, title_en, title_pt").in("id",l);n?.forEach(p=>{o.set(p.id,{title_zh:p.title_zh,title_en:p.title_en,title_pt:p.title_pt})})}return a.map(n=>{if(n.target_type==="restaurant"){const p=i.get(n.target_id);return{...n,target_name:p?.name||"Unknown Restaurant",target_name_en:p?.name_en,target_name_pt:p?.name_pt}}else if(n.target_type==="activity"){const p=o.get(n.target_id);return{...n,target_name:p?.title_zh||"Unknown Activity",target_name_en:p?.title_en,target_name_pt:p?.title_pt}}return n})},enabled:!!s,staleTime:3e4})},Bt=()=>{const{user:s}=De(),{data:a=[]}=ut();return We({queryKey:["merchantActivities",s?.id],queryFn:async()=>{if(!s||a.length===0)return[];const c=a.map(m=>m.id),{data:t,error:l}=await A.from("activity_restaurants").select("*").in("restaurant_id",c).order("created_at",{ascending:!1});if(l)throw l;if(!t||t.length===0)return[];const{data:i}=await A.from("restaurants").select("id, name, name_en, name_pt, address").in("id",c),o=[...new Set(t.map(m=>m.activity_id))],{data:n}=await A.from("activities").select("*").in("id",o).eq("status","published");return t.map(m=>{const h=i?.find(b=>b.id===m.restaurant_id),F=n?.find(b=>b.id===m.activity_id);return{activity_id:m.activity_id,restaurant_id:m.restaurant_id,restaurant_name:h?.name||"",restaurant_name_en:h?.name_en||null,restaurant_name_pt:h?.name_pt||null,restaurant_address:h?.address||"",activity:F||null,created_at:m.created_at}}).filter(m=>m.activity!==null)},enabled:!!s&&a.length>0})},va=[{code:"+351",country:"Portugal",flag:"ðŸ‡µðŸ‡¹"},{code:"+34",country:"Spain",flag:"ðŸ‡ªðŸ‡¸"},{code:"+33",country:"France",flag:"ðŸ‡«ðŸ‡·"},{code:"+49",country:"Germany",flag:"ðŸ‡©ðŸ‡ª"},{code:"+39",country:"Italy",flag:"ðŸ‡®ðŸ‡¹"},{code:"+44",country:"UK",flag:"ðŸ‡¬ðŸ‡§"},{code:"+31",country:"Netherlands",flag:"ðŸ‡³ðŸ‡±"},{code:"+32",country:"Belgium",flag:"ðŸ‡§ðŸ‡ª"},{code:"+86",country:"China",flag:"ðŸ‡¨ðŸ‡³"},{code:"+1",country:"USA/Canada",flag:"ðŸ‡ºðŸ‡¸"},{code:"+55",country:"Brazil",flag:"ðŸ‡§ðŸ‡·"}],na=s=>{if(!s)return{code:"+351",number:""};for(const a of va)if(s.startsWith(a.code))return{code:a.code,number:s.slice(a.code.length).trim()};return{code:"+351",number:s}},la=({profile:s})=>{const{t:a}=M(),c=ha(),{user:t}=De(),{isAdmin:l}=ua(),[i,o]=x.useState(!1),[n,p]=x.useState(s.display_name),m=na(s.phone),[h,F]=x.useState(m.code),[b,K]=x.useState(m.number),[R,U]=x.useState(!1),[_,q]=x.useState(null),[w,he]=x.useState(s.avatar_url||""),[Ee,L]=x.useState(!1),[qe,ge]=x.useState(!1),[se,y]=x.useState(""),[Le,ae]=x.useState(!1),X=x.useRef(!1);x.useEffect(()=>{const d=X.current;if(X.current=i,i&&!d){p(s.display_name);const f=na(s.phone);F(f.code),K(f.number),he(s.avatar_url||""),q(null),U(!1)}},[i,s.display_name,s.phone,s.avatar_url]);const[Y,ve]=x.useState(!1),[te,Fe]=x.useState(!1),[Xe,Ie]=x.useState(!1),[V,$e]=x.useState(""),[G,Ne]=x.useState(""),[$,ye]=x.useState(""),[H,we]=x.useState(!1),[Z,W]=x.useState(!1),[Oe,Te]=x.useState(!1),[Ye,be]=x.useState(!1),[S,Ce]=x.useState(!1),[Re,r]=x.useState(""),[u,N]=x.useState(""),[P,re]=x.useState(""),[Ks,fs]=x.useState(!1),[js,gs]=x.useState(""),[Ue,vs]=x.useState(!1),[Qs,Ms]=x.useState(!1),[J,Ns]=x.useState(null),ys=x.useRef(null),ws=x.useRef(null),bs=x.useRef(null),Cs=fa(),_s=at();x.useEffect(()=>{H&&ys.current&&ys.current.focus()},[H]),x.useEffect(()=>{Z&&ws.current&&ws.current.focus()},[Z]),x.useEffect(()=>{Ue&&bs.current&&bs.current.focus()},[Ue]);const Na=d=>{const f=d.target.files?.[0];if(f){if(f.size>2*1024*1024)return;q(f),he(URL.createObjectURL(f))}},ya=async()=>{let d=s.avatar_url;if(_){const ue=await _s.mutateAsync(_);ue&&(d=ue)}const f=b?`${h} ${b}`:void 0;await Cs.mutateAsync({display_name:n,phone:f,avatar_url:d||void 0}),U(!1),o(!1)},wa=async()=>{if(!(!t||se.toLowerCase()!=="delete")){ae(!0);try{const{error:d}=await A.functions.invoke("delete-account",{body:{userId:t.id}});if(d){v.error(a("profile.deleteAccountFailed")),console.error(d),ae(!1);return}v.success(a("profile.deleteAccountSuccess")),ge(!1),L(!1),y(""),await new Promise(f=>setTimeout(f,1500)),await A.auth.signOut(),c("/auth")}catch(d){v.error(d.message||a("profile.deleteAccountFailed")),ae(!1)}finally{ae(!1)}}},ba=async()=>{if(t?.email)try{const{error:d}=await A.functions.invoke("send-verification-code",{body:{email:t.email}});if(d)throw d;we(!0),v.success(a("profile.codeSentToOldEmail"))}catch(d){v.error(a("profile.sendCodeFailed")),console.error(d)}},Ca=async()=>{if(!G){v.error(a("profile.enterCodePlaceholder"));return}try{const{data:d,error:f}=await A.functions.invoke("verify-email-code",{body:{email:t?.email,code:G}});if(f||!d?.success){v.error(a("profile.codeIncorrect"));return}v.success(a("profile.oldEmailVerified")),ve(!1),Fe(!0)}catch(d){v.error(a("profile.verificationFailed")),console.error(d)}},_a=async()=>{if(!V||!V.includes("@")){v.error(a("profile.enterValidEmail"));return}try{const{error:d}=await A.functions.invoke("send-verification-code",{body:{email:V}});if(d)throw d;v.success(a("profile.codeSentToNewEmail")),W(!0)}catch(d){v.error(a("profile.sendCodeFailed")),console.error(d)}},Sa=async()=>{if(!$){v.error(a("profile.enterCodePlaceholder"));return}try{const{data:d,error:f}=await A.functions.invoke("verify-email-code",{body:{email:V,code:$}});if(f||!d?.success){v.error(a("profile.codeIncorrect"));return}v.success(a("profile.newEmailVerified")),Fe(!1),setTimeout(()=>{Ie(!0)},100)}catch(d){v.error(a("toast.verificationFailed")),console.error(d)}},ka=async()=>{Te(!0);try{const{data:{session:d}}=await A.auth.getSession();if(!d||!t){v.error(a("toast.pleaseSignIn")),Te(!1);return}const{data:f,error:ue}=await A.functions.invoke("update-email",{body:{userId:t.id,oldEmail:t.email,oldEmailCode:G,newEmail:V,newEmailCode:$},headers:{Authorization:`Bearer ${d.access_token}`}});if(ue||!f?.success)throw new Error(f?.error||"Failed to update email");v.success(a("toast.emailUpdatedSuccess")),Ie(!1),o(!1),Ne(""),$e(""),ye(""),we(!1),W(!1),await new Promise(Ss=>setTimeout(Ss,1500)),await A.auth.signOut(),c("/auth")}catch(d){v.error(d.message||a("toast.emailUpdateError")),console.error(d)}finally{Te(!1)}},Aa=d=>{let f=0;return d.length>=6&&f++,d.length>=8&&f++,/[a-z]/.test(d)&&f++,/[A-Z]/.test(d)&&f++,/[0-9]/.test(d)&&f++,/[^a-zA-Z0-9]/.test(d)&&f++,f<=2?"weak":f<=4?"medium":"strong"},Pa=async d=>{if(d?.preventDefault(),d?.stopPropagation(),!Re){v.error(a("profile.enterCurrentPassword"));return}try{const{createClient:f}=await tt(async()=>{const{createClient:Ia}=await import("./vendor-supabase-CQWbleDe.js");return{createClient:Ia}},__vite__mapDeps([0,1,2,3,4,5])),ue=f("https://tzdgqhwyzsxkxnncgzap.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR6ZGdxaHd5enN4a3hubmNnemFwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM2NTg2ODgsImV4cCI6MjA3OTIzNDY4OH0.D76C4OkjQVWyMxtjjdOofpD8X_hEEoTtrXHqi4XSYUw",{auth:{persistSession:!1,autoRefreshToken:!1}}),{error:Ss}=await ue.auth.signInWithPassword({email:t?.email||"",password:Re});if(Ss){v.error(a("profile.oldPasswordIncorrect"));return}v.success(a("profile.oldPasswordVerified")),be(!1),Ce(!0)}catch(f){v.error(a("profile.verificationFailed")),console.error(f)}},Da=async()=>{if(t?.email)try{const{error:d}=await A.functions.invoke("send-verification-code",{body:{email:t.email}});if(d)throw d;vs(!0),v.success(a("profile.codeSentToOldEmail"))}catch(d){v.error(a("profile.sendCodeFailed")),console.error(d)}},Ea=async d=>{if(d?.preventDefault(),d?.stopPropagation(),!js){v.error(a("profile.enterCodePlaceholder"));return}try{const{data:f,error:ue}=await A.functions.invoke("verify-email-code",{body:{email:t?.email,code:js}});if(ue||!f?.success){v.error(a("profile.codeIncorrect"));return}v.success(a("profile.oldEmailVerified")),be(!1),Ce(!0)}catch(f){v.error(a("profile.verificationFailed")),console.error(f)}},Fa=async d=>{if(d?.preventDefault(),d?.stopPropagation(),!u||!P){v.error(a("profile.enterNewPassword"));return}if(u.length<6){v.error(a("profile.passwordTooShort"));return}if(u!==P){v.error(a("profile.passwordsDontMatch"));return}Ms(!0);try{const{error:f}=await A.auth.updateUser({password:u});if(f)throw f;v.success(a("profile.passwordUpdated")),Ce(!1),o(!1),r(""),N(""),re(""),fs(!1),gs(""),vs(!1)}catch(f){v.error(f.message||a("profile.passwordUpdateFailed")),console.error(f)}finally{Ms(!1)}};return e.jsxs(Se,{open:i,onOpenChange:o,children:[e.jsx(ja,{asChild:!0,children:e.jsxs(g,{variant:"outline",children:[e.jsx($a,{className:"w-4 h-4 mr-2"}),a("profile.editProfile")]})}),e.jsxs(ke,{className:"max-w-[90vw] sm:max-w-[425px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Ae,{children:[e.jsx(Pe,{children:a("profile.editProfile")}),e.jsx(ps,{children:a("profile.editProfileDescription")})]}),e.jsxs("div",{className:"space-y-3 py-3",children:[e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsxs(Is,{className:"w-16 h-16 sm:w-24 sm:h-24",children:[e.jsx($s,{src:w}),e.jsx(Os,{children:n?.charAt(0).toUpperCase()})]}),e.jsxs("div",{children:[e.jsx(C,{type:"file",accept:"image/*",onChange:Na,className:"hidden",id:"avatar-upload"}),e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>document.getElementById("avatar-upload")?.click(),className:"text-xs sm:text-sm",children:[e.jsx(Oa,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 sm:mr-2"}),a("profile.uploadAvatar")]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(k,{htmlFor:"displayName",className:"text-sm",children:a("profile.displayName")}),e.jsx(C,{id:"displayName",value:n,onChange:d=>p(d.target.value),placeholder:a("profile.displayName"),className:"h-9"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(k,{htmlFor:"phone",className:"text-sm",children:a("profile.phone")}),!s.phone&&!R?e.jsx(g,{variant:"outline",size:"sm",onClick:()=>U(!0),className:"w-full justify-start h-9",children:a("profile.addPhoneNumber")}):R||!s.phone?e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(ls,{value:h,onValueChange:F,children:[e.jsx(cs,{className:"w-[110px] h-9",children:e.jsx(os,{placeholder:"+351"})}),e.jsx(ds,{children:va.map(d=>e.jsx(ms,{value:d.code,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:d.flag}),e.jsx("span",{children:d.code})]})},d.code))})]}),e.jsx(C,{id:"phone",className:"flex-1 h-9",value:b,onChange:d=>K(d.target.value),placeholder:a("profile.phonePlaceholder")})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{value:`${h} ${b}`,disabled:!0,className:"h-9 flex-1"}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>U(!0),className:"text-xs whitespace-nowrap",children:a("profile.modifyPhoneNumber")})]})]}),!l&&e.jsxs("div",{className:"space-y-1.5 pt-2 border-t",children:[e.jsx(k,{className:"text-sm",children:a("profile.email")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{value:t?.email||"",disabled:!0,className:"h-9 flex-1"}),e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>ve(!0),className:"text-xs",children:[e.jsx(Ta,{className:"w-3 h-3 mr-1"}),a("profile.modify")]})]})]}),e.jsxs("div",{className:`space-y-1.5 ${l?"pt-2 border-t":""}`,children:[e.jsx(k,{className:"text-sm",children:a("profile.changePassword")}),e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>be(!0),className:"w-full justify-start h-9",children:[e.jsx(Ra,{className:"w-3 h-3 mr-2"}),a("profile.changePassword")]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 pt-2 border-t",children:[!l&&e.jsxs(g,{variant:"destructive",size:"sm",onClick:()=>L(!0),className:"w-full sm:w-auto text-xs sm:text-sm",children:[e.jsx(xs,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 sm:mr-2"}),a("profile.deleteAccount")]}),e.jsxs("div",{className:`flex gap-2 w-full sm:w-auto ${l?"sm:ml-auto":""}`,children:[e.jsx(g,{variant:"outline",size:"sm",onClick:()=>{U(!1),o(!1)},className:"flex-1 sm:flex-none sm:min-w-[80px] text-xs sm:text-sm",children:a("common.cancel")}),e.jsx(g,{size:"sm",onClick:ya,disabled:Cs.isPending||_s.isPending,className:"flex-1 sm:flex-none sm:min-w-[80px] text-xs sm:text-sm",children:Cs.isPending||_s.isPending?a("common.loading"):a("common.save")})]})]})]}),e.jsx(ie,{open:Ee,onOpenChange:L,children:e.jsxs(ne,{children:[e.jsxs(le,{children:[e.jsx(ce,{children:a("profile.deleteAccountWarning")}),e.jsx(oe,{children:a("profile.deleteAccountDescription")})]}),e.jsxs(de,{children:[e.jsx(me,{children:a("common.cancel")}),e.jsx(ee,{onClick:()=>{L(!1),ge(!0)},className:"bg-destructive hover:bg-destructive/90",children:a("common.continue")})]})]})}),e.jsx(ie,{open:qe,onOpenChange:ge,children:e.jsxs(ne,{children:[e.jsxs(le,{children:[e.jsx(ce,{children:a("profile.confirmDeleteAccount")}),e.jsxs(oe,{className:"space-y-4",children:[e.jsx("p",{children:a("profile.confirmDeleteDescription")}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"confirm-delete",children:a("profile.typeDeleteToConfirm")}),e.jsx(C,{id:"confirm-delete",value:se,onChange:d=>y(d.target.value),placeholder:"DELETE",className:"uppercase"})]})]})]}),e.jsxs(de,{children:[e.jsx(me,{onClick:()=>y(""),children:a("common.cancel")}),e.jsx(ee,{onClick:wa,disabled:se.toLowerCase()!=="delete"||Le,className:"bg-destructive hover:bg-destructive/90",children:a(Le?"common.loading":"profile.deleteAccount")})]})]})}),e.jsx(ie,{open:Y,onOpenChange:ve,children:e.jsxs(ne,{className:"max-w-[90vw] sm:max-w-md",children:[e.jsxs(le,{children:[e.jsx(ce,{children:a("profile.verifyOldEmail")}),e.jsx(oe,{children:a("profile.oldEmailStep")})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{children:a("profile.currentEmail")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(C,{value:t?.email||"",disabled:!0,className:"flex-1"}),e.jsx(g,{variant:"outline",size:"sm",onClick:ba,disabled:H,children:a(H?"profile.codeSent":"profile.sendCode")})]})]}),H&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{children:a("profile.verificationCode")}),e.jsx(C,{ref:ys,value:G,onChange:d=>Ne(d.target.value),placeholder:a("profile.enterCode"),maxLength:4})]})]}),e.jsxs(de,{children:[e.jsx(me,{onClick:()=>{ve(!1),setTimeout(()=>{Ne(""),we(!1)},300)},children:a("common.cancel")}),H&&e.jsx(ee,{onClick:Ca,children:a("profile.verify")})]})]})}),e.jsx(ie,{open:te,onOpenChange:Fe,children:e.jsxs(ne,{className:"max-w-[90vw] sm:max-w-md",children:[e.jsxs(le,{className:"text-center space-y-3",children:[e.jsx(ce,{className:"text-xl",children:a("profile.verifyNewEmail")}),e.jsx(oe,{className:"text-center",children:a("profile.newEmailStep")})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{className:"text-sm font-normal",children:a("profile.newEmail")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(C,{type:"email",value:V,onChange:d=>$e(d.target.value),placeholder:a("profile.enterNewEmail"),disabled:Z,className:"border-2 focus:border-primary flex-1"}),e.jsx(g,{variant:"outline",size:"sm",onClick:_a,disabled:!V||Z,className:"text-xs whitespace-nowrap px-3",children:a(Z?"profile.codeSent":"profile.sendCode")})]})]}),Z&&e.jsxs("div",{className:"space-y-2 animate-in fade-in slide-in-from-top-2 duration-300",children:[e.jsx(k,{className:"text-sm font-normal",children:a("profile.verificationCode")}),e.jsx(C,{ref:ws,value:$,onChange:d=>ye(d.target.value),placeholder:a("profile.enterCode"),maxLength:4,className:"border-2 focus:border-primary"})]})]}),e.jsxs(de,{className:"flex-col sm:flex-col gap-2",children:[Z&&e.jsx(ee,{onClick:Sa,disabled:!$||$.length!==4,className:"w-full bg-primary hover:bg-primary/90",children:"ç¡®è®¤éªŒè¯ç "}),e.jsx(me,{onClick:()=>{Fe(!1),setTimeout(()=>{$e(""),ye(""),W(!1)},300)},className:"w-full mt-0",children:"å–æ¶ˆ"})]})]})}),e.jsx(ie,{open:Xe,onOpenChange:Ie,children:e.jsxs(ne,{className:"max-w-[90vw] sm:max-w-md",children:[e.jsxs(le,{children:[e.jsx(ce,{children:"ç¡®è®¤ä¿®æ”¹é‚®ç®±"}),e.jsx(oe,{children:"æ­¥éª¤ 3/3: æ‰€æœ‰éªŒè¯å·²å®Œæˆ"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"rounded-lg bg-green-50 dark:bg-green-950 p-4 text-sm",children:[e.jsx("p",{className:"font-medium text-green-900 dark:text-green-100",children:"éªŒè¯å®Œæˆï¼"}),e.jsx("p",{className:"text-green-700 dark:text-green-300 mt-1",children:'æ—§é‚®ç®±å’Œæ–°é‚®ç®±éƒ½å·²éªŒè¯æˆåŠŸï¼Œç‚¹å‡»"ç¡®è®¤ä¿®æ”¹"å®Œæˆé‚®ç®±æ›´æ–°ã€‚'})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"å½“å‰é‚®ç®±:"}),e.jsx("span",{className:"font-medium",children:t?.email})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"æ–°é‚®ç®±:"}),e.jsx("span",{className:"font-medium",children:V})]})]})]}),e.jsxs(de,{children:[e.jsx(me,{onClick:()=>{Ie(!1),setTimeout(()=>{Ne(""),$e(""),ye(""),we(!1),W(!1)},300)},children:"å–æ¶ˆ"}),e.jsx(ee,{onClick:ka,disabled:Oe,children:Oe?"æ›´æ–°ä¸­...":"ç¡®è®¤ä¿®æ”¹"})]})]})}),e.jsx(ie,{open:Ye,onOpenChange:be,children:e.jsxs(ne,{className:"max-w-[90vw] sm:max-w-md",children:[e.jsxs(le,{children:[e.jsx(ce,{children:a("profile.verifyOldPassword")}),e.jsx(oe,{children:a("profile.oldPasswordStep")})]}),e.jsx("div",{className:"space-y-4 py-4",children:Ks?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{children:a("profile.currentEmail")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(C,{value:t?.email||"",disabled:!0,className:"flex-1"}),e.jsx(g,{variant:"outline",size:"sm",onClick:Da,disabled:Ue,children:a(Ue?"profile.codeSent":"profile.sendCode")})]})]}),Ue&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{children:a("profile.verificationCode")}),e.jsx(C,{ref:bs,value:js,onChange:d=>gs(d.target.value),placeholder:a("profile.enterCode"),maxLength:4})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{children:a("profile.currentPassword")}),e.jsx(C,{type:"password",value:Re,onChange:d=>r(d.target.value),placeholder:a("profile.enterCurrentPassword")})]}),e.jsxs(g,{variant:"link",size:"sm",onClick:()=>fs(!0),className:"text-xs p-0 h-auto",children:[a("profile.forgotPassword")," ",a("profile.useEmailVerification")]})]})}),e.jsxs(de,{children:[e.jsx(me,{onClick:()=>{be(!1),setTimeout(()=>{r(""),fs(!1),gs(""),vs(!1)},300)},children:a("common.cancel")}),Ks?Ue&&e.jsx(ee,{onClick:Ea,children:a("profile.verify")}):e.jsx(ee,{onClick:Pa,children:a("profile.verify")})]})]})}),e.jsx(ie,{open:S,onOpenChange:Ce,children:e.jsxs(ne,{className:"max-w-[90vw] sm:max-w-md",children:[e.jsxs(le,{children:[e.jsx(ce,{children:a("profile.setNewPassword")}),e.jsx(oe,{children:a("profile.newPasswordStep")})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{children:a("profile.newPassword")}),e.jsx(C,{type:"password",value:u,onChange:d=>{N(d.target.value),d.target.value?Ns(Aa(d.target.value)):Ns(null)},placeholder:a("profile.enterNewPassword")}),J&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:`h-1.5 flex-1 rounded-full transition-colors ${J==="weak"?"bg-destructive":J==="medium"?"bg-warning":"bg-success"}`}),e.jsx("div",{className:`h-1.5 flex-1 rounded-full transition-colors ${J==="medium"||J==="strong"?J==="medium"?"bg-warning":"bg-success":"bg-muted"}`}),e.jsx("div",{className:`h-1.5 flex-1 rounded-full transition-colors ${J==="strong"?"bg-success":"bg-muted"}`})]}),e.jsx("p",{className:`text-xs ${J==="weak"?"text-destructive":J==="medium"?"text-warning":"text-success"}`,children:a(`auth.passwordStrength.${J}`)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{children:a("profile.confirmNewPassword")}),e.jsx(C,{type:"password",value:P,onChange:d=>re(d.target.value),placeholder:a("profile.confirmNewPasswordPlaceholder")})]}),u&&P&&u!==P&&e.jsx("p",{className:"text-sm text-destructive",children:a("profile.passwordsDontMatch")})]}),e.jsxs(de,{children:[e.jsx(me,{onClick:()=>{Ce(!1),setTimeout(()=>{N(""),re(""),Ns(null)},300)},children:a("common.cancel")}),e.jsx(ee,{onClick:Fa,disabled:!u||!P||u!==P||Qs,children:a(Qs?"common.loading":"profile.updatePassword")})]})]})})]})},Rs=[{value:"Home",icon:qa,labelKey:"address.labelHome"},{value:"Work",icon:La,labelKey:"address.labelWork"},{value:"Office",icon:Ha,labelKey:"address.labelOffice"},{value:"Other",icon:_e,labelKey:"address.labelOther"}],Kt=[{code:"+351",country:"Portugal",flag:"ðŸ‡µðŸ‡¹"},{code:"+34",country:"Spain",flag:"ðŸ‡ªðŸ‡¸"},{code:"+33",country:"France",flag:"ðŸ‡«ðŸ‡·"},{code:"+49",country:"Germany",flag:"ðŸ‡©ðŸ‡ª"},{code:"+39",country:"Italy",flag:"ðŸ‡®ðŸ‡¹"},{code:"+44",country:"UK",flag:"ðŸ‡¬ðŸ‡§"},{code:"+31",country:"Netherlands",flag:"ðŸ‡³ðŸ‡±"},{code:"+32",country:"Belgium",flag:"ðŸ‡§ðŸ‡ª"},{code:"+86",country:"China",flag:"ðŸ‡¨ðŸ‡³"},{code:"+1",country:"USA/Canada",flag:"ðŸ‡ºðŸ‡¸"},{code:"+55",country:"Brazil",flag:"ðŸ‡§ðŸ‡·"}],Qt=["Portugal","Spain","France","Germany","Italy","United Kingdom","Netherlands","Belgium","China","Other"],ca=({initialData:s,onSubmit:a,onCancel:c,isLoading:t,isEdit:l})=>{const{t:i}=M(),[o,n]=x.useState({label:s?.label||"Home",street:s?.street||"",district:s?.district||"",city:s?.city||"",postal_code:s?.postal_code||"",country:s?.country||"Portugal",phone:s?.phone||"",phone_code:s?.phone_code||"+351",is_default:s?.is_default||!1}),p=m=>{m.preventDefault(),a(o)};return e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"label",children:i("address.label")}),e.jsxs(ls,{value:o.label,onValueChange:m=>n({...o,label:m}),children:[e.jsx(cs,{children:e.jsx(os,{placeholder:i("address.selectLabel")})}),e.jsx(ds,{children:Rs.map(m=>e.jsx(ms,{value:m.value,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m.icon,{className:"w-4 h-4"}),i(m.labelKey)]})},m.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(k,{htmlFor:"street",children:[i("address.street")," *"]}),e.jsx(C,{id:"street",value:o.street,onChange:m=>n({...o,street:m.target.value}),placeholder:i("address.streetPlaceholder"),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"district",children:i("address.district")}),e.jsx(C,{id:"district",value:o.district,onChange:m=>n({...o,district:m.target.value}),placeholder:i("address.districtPlaceholder")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(k,{htmlFor:"city",children:[i("address.city")," *"]}),e.jsx(C,{id:"city",value:o.city,onChange:m=>n({...o,city:m.target.value}),placeholder:i("address.cityPlaceholder"),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(k,{htmlFor:"postal_code",children:[i("address.postalCode")," *"]}),e.jsx(C,{id:"postal_code",value:o.postal_code,onChange:m=>n({...o,postal_code:m.target.value}),placeholder:i("address.postalCodePlaceholder"),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(k,{htmlFor:"country",children:[i("address.country")," *"]}),e.jsxs(ls,{value:o.country,onValueChange:m=>n({...o,country:m}),children:[e.jsx(cs,{children:e.jsx(os,{placeholder:i("address.selectCountry")})}),e.jsx(ds,{children:Qt.map(m=>e.jsx(ms,{value:m,children:m},m))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(k,{htmlFor:"phone",children:[i("address.phone")," *"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(ls,{value:o.phone_code,onValueChange:m=>n({...o,phone_code:m}),children:[e.jsx(cs,{className:"w-[130px]",children:e.jsx(os,{placeholder:"+351"})}),e.jsx(ds,{children:Kt.map(m=>e.jsx(ms,{value:m.code,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:m.flag}),e.jsx("span",{children:m.code})]})},m.code))})]}),e.jsx(C,{id:"phone",className:"flex-1",value:o.phone,onChange:m=>n({...o,phone:m.target.value}),placeholder:i("address.phonePlaceholder"),required:!0})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(bt,{id:"is_default",checked:o.is_default,onCheckedChange:m=>n({...o,is_default:m})}),e.jsx(k,{htmlFor:"is_default",className:"text-sm font-normal cursor-pointer",children:i("address.setAsDefault")})]}),e.jsxs(rt,{className:"gap-2 sm:gap-0",children:[e.jsx(g,{type:"button",variant:"outline",onClick:c,children:i("common.cancel")}),e.jsx(g,{type:"submit",disabled:t,children:i(t?"common.saving":l?"common.save":"address.add")})]})]})},Mt=({address:s,onEdit:a,onDelete:c,onSetDefault:t,isDeleting:l,isSettingDefault:i,canDelete:o=!0})=>{const{t:n}=M(),p=Rs.find(h=>h.value===s.label)||Rs[3],m=p.icon;return e.jsx("div",{className:`p-4 border rounded-lg hover:shadow-medium transition-shadow relative ${s.is_default?"bg-primary/5 border-primary/20":""}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:`p-2 rounded-full ${s.is_default?"bg-primary/20":"bg-primary/10"}`,children:e.jsx(m,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-semibold text-foreground",children:n(p.labelKey)}),s.is_default&&e.jsxs(j,{variant:"secondary",className:"text-xs",children:[e.jsx(Ps,{className:"w-3 h-3 mr-1 fill-current"}),n("address.default")]})]}),e.jsxs("p",{className:"text-sm text-foreground",children:[s.street,s.district&&`, ${s.district}`]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:[s.postal_code,s.city,s.country].filter(Boolean).join(", ")}),s.phone&&e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1 mt-1",children:[e.jsx(Ua,{className:"w-3 h-3"}),s.phone_code," ",s.phone]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[!s.is_default&&e.jsx(g,{variant:"ghost",size:"icon",onClick:()=>t(s.id),disabled:i,title:n("address.setAsDefault"),children:e.jsx(Ps,{className:"w-4 h-4"})}),e.jsx(g,{variant:"ghost",size:"icon",onClick:()=>a(s),title:n("common.edit"),children:e.jsx(za,{className:"w-4 h-4"})}),o&&e.jsxs(ie,{children:[e.jsx(it,{asChild:!0,children:e.jsx(g,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive",title:n("common.delete"),children:e.jsx(xs,{className:"w-4 h-4"})})}),e.jsxs(ne,{children:[e.jsxs(le,{children:[e.jsx(ce,{children:n("address.deleteTitle")}),e.jsx(oe,{children:n("address.deleteDescription")})]}),e.jsxs(de,{children:[e.jsx(me,{children:n("common.cancel")}),e.jsx(ee,{onClick:()=>c(s.id),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",disabled:l,children:n(l?"common.deleting":"common.delete")})]})]})]})]})]})})},oa=()=>{const{t:s}=M(),{data:a,isLoading:c}=gt(),{data:t}=ga(),l=vt(),i=Nt(),o=fa(),n=yt(),p=wt(),[m,h]=x.useState(!1),[F,b]=x.useState(null),[K,R]=x.useState(null),[U,_]=x.useState(!1),q=!t?.phone,w=y=>{if(q&&y.phone){R(y),_(!0);return}l.mutate(y,{onSuccess:()=>h(!1)})},he=()=>{if(!K)return;const y=`${K.phone_code||"+351"} ${K.phone}`;o.mutate({phone:y}),l.mutate(K,{onSuccess:()=>{h(!1),R(null),_(!1)}})},Ee=()=>{R(null),_(!1)},L=y=>{F&&i.mutate({id:F.id,address:y},{onSuccess:()=>b(null)})},qe=y=>{n.mutate(y)},ge=y=>{p.mutate(y)};if(c)return e.jsxs(D,{children:[e.jsx(z,{children:e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"w-5 h-5"}),s("address.myAddresses")]})}),e.jsx(E,{children:e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:s("common.loading")})})]});const se=a&&a.length>0;return e.jsxs(D,{children:[e.jsx(z,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3",children:[e.jsxs("div",{className:"space-y-1.5 min-w-0 flex-1",children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"w-5 h-5 flex-shrink-0"}),s("address.myAddresses")]}),e.jsx(Q,{className:"text-xs text-primary",children:s("address.manageDescription")})]}),se&&e.jsxs(Se,{open:m,onOpenChange:h,children:[e.jsx(ja,{asChild:!0,children:e.jsxs(g,{size:"sm",className:"w-full sm:w-auto flex-shrink-0",children:[e.jsx(Vs,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"truncate",children:s("address.addNew")})]})}),e.jsxs(ke,{className:"sm:max-w-[500px]",children:[e.jsxs(Ae,{children:[e.jsx(Pe,{children:s("address.addNew")}),e.jsx(ps,{children:s("address.addDescription")})]}),e.jsx(ca,{onSubmit:w,onCancel:()=>h(!1),isLoading:l.isPending})]})]})]})}),e.jsx(E,{children:se?e.jsx("div",{className:"space-y-4",children:a.map(y=>e.jsx(Mt,{address:y,onEdit:b,onDelete:qe,onSetDefault:ge,isDeleting:n.isPending,isSettingDefault:p.isPending,canDelete:a.length>1},y.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(_e,{className:"w-12 h-12 mx-auto text-muted-foreground/50 mb-4"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:s("address.noAddresses")}),e.jsxs(g,{onClick:()=>h(!0),children:[e.jsx(Vs,{className:"w-4 h-4 mr-2"}),s("address.addFirst")]})]})}),e.jsx(Se,{open:!!F,onOpenChange:()=>b(null),children:e.jsxs(ke,{className:"sm:max-w-[500px]",children:[e.jsxs(Ae,{children:[e.jsx(Pe,{children:s("address.editAddress")}),e.jsx(ps,{children:s("address.editDescription")})]}),F&&e.jsx(ca,{initialData:F,onSubmit:L,onCancel:()=>b(null),isLoading:i.isPending,isEdit:!0})]})}),e.jsx(ie,{open:U,onOpenChange:_,children:e.jsxs(ne,{children:[e.jsxs(le,{children:[e.jsx(ce,{children:s("address.phoneConfirmTitle")}),e.jsx(oe,{children:s("address.phoneConfirmDescription")})]}),e.jsxs(de,{children:[e.jsx(me,{onClick:Ee,children:s("common.cancel")}),e.jsx(ee,{onClick:he,disabled:l.isPending||o.isPending,children:l.isPending||o.isPending?s("common.saving"):s("common.confirm")})]})]})})]})},Vt=({open:s,onOpenChange:a,coupon:c})=>{const{t}=M(),{getLocalizedField:l}=us(),[i,o]=x.useState(!1),n=c.coupon_codes?.coupon_templates,p=c.coupon_codes?.code,m=!!c.used_at;return e.jsx(Se,{open:s,onOpenChange:h=>{a(h),h||o(!1)},children:e.jsxs(ke,{className:"max-w-lg max-h-[90vh]",children:[e.jsx(Ae,{children:e.jsxs(Pe,{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"w-5 h-5 text-primary"}),t("profile.coupons.details")]})}),e.jsx(nt,{className:"max-h-[70vh] pr-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-foreground",children:l(n,"title")}),e.jsx(j,{variant:m?"secondary":"default",children:t(m?"profile.coupons.used":"profile.coupons.available")})]}),n?.description_zh||n?.description_en||n?.description_pt?e.jsx("p",{className:"text-muted-foreground text-sm",children:l(n,"description")}):null]}),e.jsx(Ts,{}),e.jsx("div",{className:"bg-secondary/30 p-4 rounded-lg cursor-pointer hover:bg-secondary/50 transition-colors",onClick:()=>o(!i),children:e.jsx("div",{className:"flex flex-col items-center gap-3",children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white p-3 rounded-lg",children:e.jsx(Ba,{value:p||"",size:140,level:"M",includeMargin:!1})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t("profile.coupons.tapToHideQr")})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-2xl font-mono font-bold tracking-wider",children:p}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Ka,{className:"w-4 h-4"}),e.jsx("p",{className:"text-xs",children:t("profile.coupons.tapToShowQr")})]})]})})}),e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-primary/10 rounded-lg",children:[e.jsx(Ze,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:t("profile.coupons.discount")}),e.jsx("p",{className:"text-xl font-bold text-primary",children:n?.discount_type==="percentage"?`${n?.discount_value}% OFF`:`â‚¬${n?.discount_value}`})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(je,{className:"w-5 h-5 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:t("profile.coupons.claimedAt")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:fe(new Date(c.claimed_at),"yyyy-MM-dd HH:mm")})]})]}),m&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(xe,{className:"w-5 h-5 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:t("profile.coupons.usedOn")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:fe(new Date(c.used_at),"yyyy-MM-dd HH:mm")})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(xe,{className:"w-5 h-5 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:t("profile.coupons.validity")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:n?.valid_until?`${fe(new Date(n.valid_from),"yyyy-MM-dd")} - ${fe(new Date(n.valid_until),"yyyy-MM-dd")}`:t("profile.coupons.noExpiry")})]})]}),n?.min_order_amount&&n.min_order_amount>0&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ze,{className:"w-5 h-5 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:t("profile.coupons.minOrder")}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["â‚¬",n.min_order_amount]})]})]}),n?.max_discount_amount&&n.max_discount_amount>0&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ze,{className:"w-5 h-5 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:t("profile.coupons.maxDiscount")}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["â‚¬",n.max_discount_amount]})]})]}),e.jsx(Ts,{}),c.activity_id&&c.source==="share"&&e.jsxs(I,{to:`/activity/${c.activity_id}`,className:"flex items-center justify-center gap-2 p-3 rounded-lg border hover:shadow-md transition-all hover:border-primary",children:[e.jsx(Ze,{className:"w-4 h-4 text-primary"}),e.jsxs("span",{className:"text-sm font-medium text-foreground",children:[t("profile.coupons.source"),": ",t("profile.coupons.fromSharing")]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",t("profile.coupons.viewActivity"),")"]})]})]})})]})})},Gt=()=>{const{user:s}=De();return We({queryKey:["bookingRecords",s?.email],queryFn:async()=>{if(!s?.email)return[];const{data:a,error:c}=await A.from("booking_records").select(`
          *,
          restaurants (
            name,
            name_en,
            name_pt,
            image_url
          )
        `).order("booking_date",{ascending:!1});if(c)throw c;return a},enabled:!!s?.email})},Wt=()=>{const{user:s}=De();return We({queryKey:["deliveryRecords",s?.email],queryFn:async()=>{if(!s?.email)return[];const{data:a,error:c}=await A.from("delivery_records").select(`
          *,
          restaurants (
            name,
            name_en,
            name_pt,
            image_url
          )
        `).order("order_date",{ascending:!1});if(c)throw c;return a},enabled:!!s?.email})},da=()=>{const{t:s}=M(),{data:a,isLoading:c}=Gt(),{getLocalizedField:t}=us(),l=i=>{switch(i){case"confirmed":return e.jsx(j,{className:"bg-green-500",children:s("booking.status.confirmed")});case"pending":return e.jsx(j,{variant:"secondary",children:s("booking.status.pending")});case"cancelled":return e.jsx(j,{variant:"destructive",children:s("booking.status.cancelled")});case"completed":return e.jsx(j,{className:"bg-blue-500",children:s("booking.status.completed")});default:return e.jsx(j,{variant:"outline",children:i})}};return e.jsxs(D,{children:[e.jsxs(z,{className:"pb-3",children:[e.jsxs(B,{className:"text-lg flex items-center gap-2",children:[e.jsx(Gs,{className:"w-5 h-5"}),s("profile.bookingRecords.title")]}),e.jsx(Q,{className:"text-xs",children:s("profile.bookingRecords.description")})]}),e.jsx(E,{className:"px-3",children:c?e.jsx("div",{className:"text-center py-8 text-sm",children:s("common.loading")}):a&&a.length>0?e.jsx("div",{className:"space-y-3",children:a.map(i=>{const o=i.restaurants?t(i.restaurants,"name"):i.restaurant_name;return e.jsxs("div",{className:"p-3 rounded-lg border hover:shadow-medium transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[e.jsx("div",{className:"flex-1",children:i.restaurant_id?e.jsxs(I,{to:`/restaurant/${i.restaurant_id}`,className:"font-semibold text-sm hover:text-primary transition-colors",children:[e.jsx(pe,{className:"w-4 h-4 inline mr-1"}),o]}):e.jsxs("span",{className:"font-semibold text-sm",children:[e.jsx(pe,{className:"w-4 h-4 inline mr-1"}),o]})}),l(i.status)]}),e.jsxs("div",{className:"flex flex-wrap gap-3 text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Gs,{className:"w-3 h-3"}),fe(new Date(i.booking_date),"yyyy-MM-dd")]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(je,{className:"w-3 h-3"}),i.booking_time.slice(0,5)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Bs,{className:"w-3 h-3"}),i.party_size," ",s("booking.people")]})]}),i.notes&&e.jsx("p",{className:"text-xs text-muted-foreground mt-2 line-clamp-2",children:i.notes})]},i.id)})}):e.jsx("p",{className:"text-muted-foreground text-center py-8 text-sm",children:s("profile.bookingRecords.noRecords")})})]})},ma=()=>{const{t:s}=M(),{data:a,isLoading:c}=Wt(),{getLocalizedField:t}=us(),l=i=>{switch(i){case"completed":return e.jsx(j,{className:"bg-green-500",children:s("delivery.status.completed")});case"pending":return e.jsx(j,{variant:"secondary",children:s("delivery.status.pending")});case"cancelled":return e.jsx(j,{variant:"destructive",children:s("delivery.status.cancelled")});case"delivering":return e.jsx(j,{className:"bg-blue-500",children:s("delivery.status.delivering")});default:return e.jsx(j,{variant:"outline",children:i})}};return e.jsxs(D,{children:[e.jsxs(z,{className:"pb-3",children:[e.jsxs(B,{className:"text-lg flex items-center gap-2",children:[e.jsx(Qa,{className:"w-5 h-5"}),s("profile.deliveryRecords.title")]}),e.jsx(Q,{className:"text-xs",children:s("profile.deliveryRecords.description")})]}),e.jsx(E,{className:"px-3",children:c?e.jsx("div",{className:"text-center py-8 text-sm",children:s("common.loading")}):a&&a.length>0?e.jsx("div",{className:"space-y-3",children:a.map(i=>{const o=i.restaurants?t(i.restaurants,"name"):i.restaurant_name;return e.jsxs("div",{className:"p-3 rounded-lg border hover:shadow-medium transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[e.jsx("div",{className:"flex-1",children:i.restaurant_id?e.jsxs(I,{to:`/restaurant/${i.restaurant_id}`,className:"font-semibold text-sm hover:text-primary transition-colors",children:[e.jsx(pe,{className:"w-4 h-4 inline mr-1"}),o]}):e.jsxs("span",{className:"font-semibold text-sm",children:[e.jsx(pe,{className:"w-4 h-4 inline mr-1"}),o]})}),l(i.status)]}),e.jsxs("div",{className:"flex flex-wrap gap-3 text-xs text-muted-foreground mb-2",children:[e.jsx("span",{children:fe(new Date(i.order_date),"yyyy-MM-dd HH:mm")}),i.total_amount&&e.jsxs("span",{className:"font-medium text-foreground",children:["â‚¬",i.total_amount.toFixed(2)]})]}),i.delivery_address&&e.jsxs("p",{className:"text-xs text-muted-foreground flex items-start gap-1",children:[e.jsx(_e,{className:"w-3 h-3 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"line-clamp-1",children:i.delivery_address})]}),i.notes&&e.jsx("p",{className:"text-xs text-muted-foreground mt-2 line-clamp-2",children:i.notes})]},i.id)})}):e.jsx("p",{className:"text-muted-foreground text-center py-8 text-sm",children:s("profile.deliveryRecords.noRecords")})})]})},Xt=Ct({full_name:ss().min(2,"å§“åè‡³å°‘2ä¸ªå­—ç¬¦"),nif:ss().min(9,"NIFè‡³å°‘9ä½").max(15,"NIFæœ€å¤š15ä½"),contact:ss().min(5,"è”ç³»æ–¹å¼è‡³å°‘5ä¸ªå­—ç¬¦"),address:ss().min(5,"åœ°å€è‡³å°‘5ä¸ªå­—ç¬¦")}),As=({open:s,onOpenChange:a,mode:c,existingData:t})=>{const{t:l}=M(),i=Ft(),o=It(),n=Ma({resolver:Va(Xt),defaultValues:{full_name:t?.full_name||"",nif:t?.nif||"",contact:t?.contact||"",address:t?.address||""}});x.useEffect(()=>{s&&t?n.reset({full_name:t.full_name||"",nif:t.nif||"",contact:t.contact||"",address:t.address||""}):s&&!t&&n.reset({full_name:"",nif:"",contact:"",address:""})},[s,t,n]);const p=async h=>{try{const F={full_name:h.full_name,nif:h.nif,contact:h.contact,address:h.address};c==="reapply"&&t?.id?await o.mutateAsync({id:t.id,data:F}):await i.mutateAsync(F),a(!1),n.reset()}catch{}},m=i.isPending||o.isPending;return e.jsx(Se,{open:s,onOpenChange:a,children:e.jsxs(ke,{className:"sm:max-w-md",children:[e.jsxs(Ae,{children:[e.jsxs(Pe,{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"w-5 h-5 text-primary"}),c==="apply"?l("profile.invitationCode.applyTitle","ç”³è¯·é‚€è¯·ç "):l("profile.invitationCode.reapplyTitle","é‡æ–°ç”³è¯·é‚€è¯·ç ")]}),e.jsx(ps,{children:l("profile.invitationCode.applyDesc","è¯·å¡«å†™ä»¥ä¸‹ä¿¡æ¯ä»¥ç”³è¯·ä¸“å±žé‚€è¯·ç ")})]}),e.jsx(Tt,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(p),className:"space-y-4",children:[e.jsx(as,{control:n.control,name:"full_name",render:({field:h})=>e.jsxs(ts,{children:[e.jsx(rs,{children:l("profile.invitationCode.fullName","å…¨å")}),e.jsx(is,{children:e.jsx(C,{placeholder:l("profile.invitationCode.fullNamePlaceholder","è¯·è¾“å…¥æ‚¨çš„å…¨å"),...h})}),e.jsx(ns,{})]})}),e.jsx(as,{control:n.control,name:"nif",render:({field:h})=>e.jsxs(ts,{children:[e.jsx(rs,{children:l("profile.invitationCode.nif","NIF (ç¨ŽåŠ¡è¯†åˆ«å·)")}),e.jsx(is,{children:e.jsx(C,{placeholder:l("profile.invitationCode.nifPlaceholder","è¯·è¾“å…¥æ‚¨çš„NIF"),...h})}),e.jsx(ns,{})]})}),e.jsx(as,{control:n.control,name:"contact",render:({field:h})=>e.jsxs(ts,{children:[e.jsx(rs,{children:l("profile.invitationCode.contact","è”ç³»æ–¹å¼")}),e.jsx(is,{children:e.jsx(C,{placeholder:l("profile.invitationCode.contactPlaceholder","è¯·è¾“å…¥æ‚¨çš„è”ç³»æ–¹å¼ï¼ˆç”µè¯/å¾®ä¿¡ç­‰ï¼‰"),...h})}),e.jsx(ns,{})]})}),e.jsx(as,{control:n.control,name:"address",render:({field:h})=>e.jsxs(ts,{children:[e.jsx(rs,{children:l("profile.invitationCode.address","åœ°å€")}),e.jsx(is,{children:e.jsx(lt,{placeholder:l("profile.invitationCode.addressPlaceholder","è¯·è¾“å…¥æ‚¨çš„åœ°å€"),className:"resize-none",rows:3,...h})}),e.jsx(ns,{})]})}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(g,{type:"button",variant:"outline",onClick:()=>a(!1),children:l("common.cancel","å–æ¶ˆ")}),e.jsxs(g,{type:"submit",disabled:m,children:[m&&e.jsx(Ds,{className:"w-4 h-4 mr-2 animate-spin"}),c==="apply"?l("profile.invitationCode.submit","æäº¤ç”³è¯·"):l("profile.invitationCode.resubmit","é‡æ–°æäº¤")]})]})]})})]})})},Me=({open:s,onOpenChange:a})=>{const{t:c}=M();return e.jsx(Se,{open:s,onOpenChange:a,children:e.jsxs(ke,{className:"sm:max-w-md",children:[e.jsx(Ae,{children:e.jsx(Pe,{className:"flex items-center gap-2",children:c("profile.invitationCode.helpTitle","é‚€è¯·ç ä½¿ç”¨è¯´æ˜Ž")})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-primary font-medium",children:[e.jsx(Ga,{className:"h-4 w-4"}),e.jsx("span",{children:c("profile.invitationCode.helpRequirements","ç”³è¯·è¦æ±‚")})]}),e.jsx("p",{className:"text-sm text-muted-foreground pl-6",children:c("profile.invitationCode.helpRequirementsDesc","ç”³è¯·é‚€è¯·ç éœ€æä¾›ï¼šå…¨åã€NIFï¼ˆç¨ŽåŠ¡è¯†åˆ«å·ï¼‰ã€è”ç³»æ–¹å¼ã€åœ°å€")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-primary font-medium",children:[e.jsx(Es,{className:"h-4 w-4"}),e.jsx("span",{children:c("profile.invitationCode.helpUsage","ä½¿ç”¨æ¡ä»¶")})]}),e.jsx("p",{className:"text-sm text-muted-foreground pl-6",children:c("profile.invitationCode.helpUsageDesc",'é‚€è¯·ç åªèƒ½åœ¨"åŠ å…¥æˆ‘ä»¬"ç”³è¯·ä¸­ä½¿ç”¨ï¼Œä¸”ä»…åœ¨å‹¾é€‰"æ‰«ç ç‚¹é¤"åŠŸèƒ½åŽæ‰èƒ½å¡«å†™')})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-primary font-medium",children:[e.jsx(Wa,{className:"h-4 w-4"}),e.jsx("span",{children:c("profile.invitationCode.helpBenefit","ç¦åˆ©è¯´æ˜Ž")})]}),e.jsx("p",{className:"text-sm text-muted-foreground pl-6",children:c("profile.invitationCode.helpBenefitDesc","æˆåŠŸé‚€è¯·å•†å®¶åŽï¼Œè¢«é‚€è¯·äººå¯èŽ·å¾—ä»·å€¼99æ¬§å…ƒçš„é¢å¤–å…è´¹æœˆã€‚é‚€è¯·åŒæ–¹å¯è‡ªç”±åå•†ç¦åˆ©åˆ†é…æ–¹å¼ã€‚")})]}),e.jsx(Ts,{}),e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:c("profile.invitationCode.copyright","Â© 2026 å°ç†Šå¸‚åœº. ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚æœ€ç»ˆè§£é‡Šæƒå½’å°ç†Šå¸‚åœºæ‰€æœ‰ã€‚")})]})]})})},xa=s=>{switch(s){case"zh":return kt;case"pt":return St;default:return _t}},pa=({isMobile:s})=>{const{t:a,i18n:c}=M(),{data:t,isLoading:l}=$t(),{data:i=[]}=Ot(),[o,n]=x.useState(!1),[p,m]=x.useState(!1),[h,F]=x.useState(!1),[b,K]=x.useState(!1),R=async()=>{t?.code&&(await navigator.clipboard.writeText(t.code),F(!0),ct({title:a("profile.invitationCode.copied","å·²å¤åˆ¶"),description:a("profile.invitationCode.copiedDesc","é‚€è¯·ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿")}),setTimeout(()=>F(!1),2e3))},U=i.filter(w=>!(t?.status==="approved"&&w.id===t.id||w.id===t?.id)),_=(w,he)=>{switch(w){case"pending":return e.jsxs(j,{variant:"outline",className:"text-yellow-600 border-yellow-500",children:[e.jsx(je,{className:"w-3 h-3 mr-1"}),a("profile.invitationCode.pending","å®¡æ ¸ä¸­")]});case"approved":return e.jsxs(j,{variant:"outline",className:"text-primary border-primary",children:[e.jsx(Es,{className:"w-3 h-3 mr-1"}),a("profile.invitationCode.approved","å·²é€šè¿‡")]});case"rejected":return e.jsxs(j,{variant:"destructive",children:[e.jsx(ze,{className:"w-3 h-3 mr-1"}),a("profile.invitationCode.rejected","å·²æ‹’ç»")]});case"revoked":return e.jsxs(j,{variant:"outline",className:"text-orange-600 border-orange-500 bg-orange-100 dark:bg-orange-900/50",children:[e.jsx(ze,{className:"w-3 h-3 mr-1"}),a("profile.invitationCode.revoked","å·²æ”¶å›ž")]});default:return null}},q=()=>U.length===0?null:e.jsxs(Pt,{open:b,onOpenChange:K,className:"mt-4",children:[e.jsx(Dt,{asChild:!0,children:e.jsxs(g,{variant:"ghost",size:"sm",className:"w-full justify-between text-muted-foreground hover:text-foreground",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Za,{className:"w-4 h-4"}),a("profile.invitationCode.history","åŽ†å²è®°å½•")," (",U.length,")"]}),e.jsx(Ja,{className:`w-4 h-4 transition-transform ${b?"rotate-180":""}`})]})}),e.jsx(Et,{className:"mt-2 space-y-2",children:U.map(w=>e.jsxs("div",{className:"p-3 rounded-lg border bg-muted/30 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-mono font-medium",children:w.code}),_(w.status)]}),e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsxs("p",{children:[a("profile.invitationCode.appliedAt","ç”³è¯·æ—¶é—´"),": ",hs(new Date(w.created_at),{addSuffix:!0,locale:xa(c.language)})]}),w.reviewed_at&&e.jsxs("p",{children:[a("profile.invitationCode.reviewedAt","å®¡æ ¸æ—¶é—´"),": ",hs(new Date(w.reviewed_at),{addSuffix:!0,locale:xa(c.language)})]}),w.rejection_reason&&e.jsxs("p",{className:"text-destructive",children:[a("profile.invitationCode.reason","åŽŸå› "),": ",w.rejection_reason]}),w.status==="approved"&&e.jsxs("p",{children:[a("profile.invitationCode.usageCount","å·²é‚€è¯·"),": ",w.usage_count," ",a("profile.invitationCode.people","äºº")]})]})]},w.id))})]});return l?e.jsxs(D,{children:[e.jsxs(z,{className:s?"p-4":"",children:[e.jsx(ks,{className:"h-6 w-32"}),e.jsx(ks,{className:"h-4 w-48 mt-2"})]}),e.jsx(E,{className:s?"px-4 pb-4":"",children:e.jsx(ks,{className:"h-20 w-full"})})]}):t?t.status==="pending"?e.jsxs(D,{className:"border-yellow-500/30",children:[e.jsxs(z,{className:s?"p-4":"",children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(je,{className:"w-5 h-5 text-yellow-500"}),a("profile.invitationCode.title","æˆ‘çš„é‚€è¯·ç "),e.jsx(g,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>m(!0),children:e.jsx(He,{className:"w-4 h-4 text-muted-foreground"})})]}),e.jsx(Q,{children:a("profile.invitationCode.pendingDesc","æ‚¨çš„ç”³è¯·æ­£åœ¨å®¡æ ¸ä¸­")})]}),e.jsxs(E,{className:s?"px-4 pb-4":"",children:[e.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-950/30 rounded-lg p-4",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsxs(j,{variant:"outline",className:"text-yellow-600 border-yellow-500",children:[e.jsx(je,{className:"w-3 h-3 mr-1"}),a("profile.invitationCode.pending","å®¡æ ¸ä¸­")]})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a("profile.invitationCode.pendingMessage","ç®¡ç†å‘˜æ­£åœ¨å®¡æ ¸æ‚¨çš„ç”³è¯·ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚å®¡æ ¸é€šè¿‡åŽæ‚¨å°†æ”¶åˆ°é€šçŸ¥ã€‚")})]}),q()]}),e.jsx(Me,{open:p,onOpenChange:m})]}):t.status==="rejected"?e.jsxs(e.Fragment,{children:[e.jsxs(D,{className:"border-destructive/30",children:[e.jsxs(z,{className:s?"p-4":"",children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"w-5 h-5 text-destructive"}),a("profile.invitationCode.title","æˆ‘çš„é‚€è¯·ç "),e.jsx(g,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>m(!0),children:e.jsx(He,{className:"w-4 h-4 text-muted-foreground"})})]}),e.jsx(Q,{children:a("profile.invitationCode.rejectedDesc","æ‚¨çš„ç”³è¯·æœªé€šè¿‡å®¡æ ¸")})]}),e.jsxs(E,{className:s?"px-4 pb-4":"",children:[e.jsxs("div",{className:"bg-destructive/10 rounded-lg p-4 mb-4",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsxs(j,{variant:"destructive",children:[e.jsx(ze,{className:"w-3 h-3 mr-1"}),a("profile.invitationCode.rejected","å·²æ‹’ç»")]})}),t.rejection_reason&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsxs("span",{className:"font-medium",children:[a("profile.invitationCode.reason","åŽŸå› "),":"]})," ",t.rejection_reason]})]}),e.jsxs(g,{onClick:()=>n(!0),variant:"outline",className:"w-full",children:[e.jsx(Ws,{className:"w-4 h-4 mr-2"}),a("profile.invitationCode.reapply","é‡æ–°ç”³è¯·")]}),q()]})]}),e.jsx(As,{open:o,onOpenChange:n,mode:"reapply",existingData:{id:t.id,full_name:t.full_name,nif:t.nif,contact:t.contact||"",address:t.address}}),e.jsx(Me,{open:p,onOpenChange:m})]}):t.status==="revoked"?e.jsxs(e.Fragment,{children:[e.jsxs(D,{className:"border-orange-500/30",children:[e.jsxs(z,{className:s?"p-4":"",children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"w-5 h-5 text-orange-500"}),a("profile.invitationCode.title","æˆ‘çš„é‚€è¯·ç "),e.jsx(g,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>m(!0),children:e.jsx(He,{className:"w-4 h-4 text-muted-foreground"})})]}),e.jsx(Q,{children:a("profile.invitationCode.revokedDesc","æ‚¨çš„é‚€è¯·ç å·²è¢«æ”¶å›ž")})]}),e.jsxs(E,{className:s?"px-4 pb-4":"",children:[e.jsxs("div",{className:"bg-orange-50 dark:bg-orange-950/30 rounded-lg p-4 mb-4",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsxs(j,{variant:"outline",className:"text-orange-600 border-orange-500 bg-orange-100 dark:bg-orange-900/50",children:[e.jsx(ze,{className:"w-3 h-3 mr-1"}),a("profile.invitationCode.revoked","å·²æ”¶å›ž")]})}),t.rejection_reason&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsxs("span",{className:"font-medium",children:[a("profile.invitationCode.reason","åŽŸå› "),":"]})," ",t.rejection_reason]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:a("profile.invitationCode.revokedMessage","æ‚¨çš„é‚€è¯·ç å·²è¢«ç®¡ç†å‘˜æ”¶å›žï¼Œå¦‚éœ€ç»§ç»­ä½¿ç”¨è¯·é‡æ–°ç”³è¯·ã€‚")})]}),e.jsxs(g,{onClick:()=>n(!0),variant:"outline",className:"w-full",children:[e.jsx(Ws,{className:"w-4 h-4 mr-2"}),a("profile.invitationCode.reapply","é‡æ–°ç”³è¯·")]}),q()]})]}),e.jsx(As,{open:o,onOpenChange:n,mode:"reapply",existingData:{id:t.id,full_name:t.full_name,nif:t.nif,contact:t.contact||"",address:t.address}}),e.jsx(Me,{open:p,onOpenChange:m})]}):e.jsxs(e.Fragment,{children:[e.jsxs(D,{className:"border-primary/30",children:[e.jsxs(z,{className:s?"p-4":"",children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(Es,{className:"w-5 h-5 text-primary"}),a("profile.invitationCode.title","æˆ‘çš„é‚€è¯·ç "),e.jsx(g,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>m(!0),children:e.jsx(He,{className:"w-4 h-4 text-muted-foreground"})})]}),e.jsx(Q,{children:a("profile.invitationCode.approvedDesc","åˆ†äº«æ‚¨çš„é‚€è¯·ç ç»™æ–°å•†å®¶")})]}),e.jsxs(E,{className:s?"px-4 pb-4":"",children:[e.jsx("div",{className:"bg-primary/10 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:a("profile.invitationCode.yourCode","æ‚¨çš„é‚€è¯·ç ")}),e.jsx("p",{className:"text-2xl font-mono font-bold text-primary tracking-wider",children:t.code})]}),e.jsx(g,{variant:"outline",size:"icon",onClick:R,className:"flex-shrink-0",children:h?e.jsx(Xa,{className:"w-4 h-4 text-primary"}):e.jsx(Ya,{className:"w-4 h-4"})})]})}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Bs,{className:"w-4 h-4"}),e.jsxs("span",{children:[a("profile.invitationCode.usageCount","å·²é‚€è¯·"),": ",t.usage_count," ",a("profile.invitationCode.people","äºº")]})]}),q()]})]}),e.jsx(Me,{open:p,onOpenChange:m})]}):e.jsxs(e.Fragment,{children:[e.jsxs(D,{children:[e.jsxs(z,{className:s?"p-4":"",children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(Fs,{className:"w-5 h-5 text-primary"}),a("profile.invitationCode.title","æˆ‘çš„é‚€è¯·ç "),e.jsx(g,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>m(!0),children:e.jsx(He,{className:"w-4 h-4 text-muted-foreground"})})]}),e.jsx(Q,{children:a("profile.invitationCode.noCodeDesc","ç”³è¯·ä¸“å±žé‚€è¯·ç ï¼Œé‚€è¯·æ–°å•†å®¶åŠ å…¥å¹³å°")})]}),e.jsxs(E,{className:s?"px-4 pb-4":"",children:[e.jsxs(g,{onClick:()=>n(!0),className:"w-full",children:[e.jsx(Fs,{className:"w-4 h-4 mr-2"}),a("profile.invitationCode.apply","ç”³è¯·é‚€è¯·ç ")]}),q()]})]}),e.jsx(As,{open:o,onOpenChange:n,mode:"apply"}),e.jsx(Me,{open:p,onOpenChange:m})]})},Us=x.memo(({comment:s,getLocalizedField:a,t:c})=>{const t=s.moderation_status==="flagged",l=s.moderation_status==="pending",i=()=>{if(!s.risk_reasons||!Array.isArray(s.risk_reasons))return null;const o={spam:c("riskReason.spam"),offensive:c("riskReason.offensive"),harassment:c("riskReason.harassment"),fake_review:c("riskReason.fakeReview"),flooding:c("riskReason.flooding"),irrelevant:c("riskReason.irrelevant"),sensitive_word_detected:c("riskReason.sensitiveWord"),parse_error:c("riskReason.parseError")};return s.risk_reasons.map(n=>o[n]||n).join(", ")};return e.jsxs("div",{className:"block p-3 md:p-4 rounded-lg border hover:shadow-medium transition-shadow",children:[e.jsxs(I,{to:`/${s.target_type}/${s.target_id}`,className:"block",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2 gap-2",children:[e.jsx("h3",{className:"font-semibold text-card-foreground text-sm md:text-base line-clamp-1 flex-1",children:a(s,"target_name")}),e.jsx("span",{className:"text-xs md:text-sm text-muted-foreground whitespace-nowrap",children:hs(new Date(s.created_at),{addSuffix:!0})})]}),e.jsx("p",{className:"text-muted-foreground line-clamp-2 text-sm md:text-base",children:s.content}),s.image_url&&e.jsx("img",{src:s.image_url,alt:"Comment",className:"mt-2 rounded-lg max-w-full md:max-w-xs",loading:"lazy"})]}),l&&e.jsx("div",{className:"mt-2 flex items-center gap-2",children:e.jsxs(j,{variant:"outline",className:"text-yellow-600 border-yellow-500 bg-yellow-50 dark:bg-yellow-950/30 text-xs",children:[e.jsx(je,{className:"w-3 h-3 mr-1"}),c("restaurant.commentPending")]})}),t&&e.jsxs("div",{className:"mt-2 space-y-1.5",children:[e.jsxs(j,{variant:"outline",className:"text-destructive border-destructive bg-destructive/10 text-xs",children:[e.jsx(et,{className:"w-3 h-3 mr-1"}),c("restaurant.commentFailed")]}),i()&&e.jsxs("p",{className:"text-xs text-destructive/80 pl-0.5",children:[c("restaurant.failReason"),": ",i()]})]})]})});Us.displayName="CommentItem";const zs=x.memo(({restaurant:s,getLocalizedField:a,t:c,distance:t})=>{if(!s||!s.id)return null;const l=a(s,"name")||s.name||"",i=a(s,"type"),o=Array.isArray(i)?i.join(" Â· "):i||"";return e.jsxs(I,{to:`/restaurant/${s.id}`,state:{from:"profile"},className:"flex gap-3 md:gap-4 p-3 md:p-4 rounded-lg border hover:shadow-medium transition-shadow",children:[e.jsx("div",{className:"w-20 h-20 md:w-24 md:h-24 rounded-lg overflow-hidden bg-secondary/30 flex-shrink-0",children:e.jsx("img",{src:s.image_url||"https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=400&q=80",alt:String(l),className:"w-full h-full object-cover",loading:"lazy",onError:n=>{n.currentTarget.src="https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=400&q=80"}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-base md:text-lg text-card-foreground line-clamp-1",children:l}),e.jsx("p",{className:"text-muted-foreground text-sm mb-2 line-clamp-1",children:o}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ps,{className:`w-4 h-4 ${s.rating?"fill-accent text-accent":"text-muted-foreground"}`}),s.rating?e.jsx("span",{className:"font-medium",children:s.rating.toFixed(1)}):e.jsxs("span",{className:"text-xs text-muted-foreground text-center whitespace-nowrap",children:[c("restaurant.noRatingLine1"),e.jsx("br",{}),c("restaurant.noRatingLine2")]})]}),t!==void 0&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-primary",children:[e.jsx(_e,{className:"w-3 h-3"}),e.jsx("span",{children:t<1?`${Math.round(t*1e3)} m`:`${t.toFixed(1)} km`})]})]})]})]})});zs.displayName="FavoriteRestaurantItem";const qs=x.memo(({subscription:s,getLocalizedField:a,t:c,isMobile:t})=>{const[l,i]=x.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx("div",{onClick:()=>i(!0),className:`block rounded-lg border hover:shadow-medium transition-shadow cursor-pointer ${t?"p-3":"p-4"}`,children:e.jsxs("div",{className:`flex items-start ${t?"gap-3":"gap-4"}`,children:[s.activity?.image_url&&e.jsx("img",{src:s.activity.image_url,alt:String(a(s.activity,"title")),className:`rounded-lg object-cover flex-shrink-0 ${t?"w-20 h-20":"w-24 h-24"}`,loading:"lazy"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:`font-semibold text-card-foreground mb-1 ${t?"text-sm":""}`,children:a(s.activity,"title")}),e.jsx("div",{className:`text-muted-foreground line-clamp-2 prose max-w-none ${t?"text-xs prose-xs":"text-sm prose-sm"}`,dangerouslySetInnerHTML:{__html:a(s.activity,"content")}}),e.jsxs("p",{className:"text-muted-foreground mt-2 text-xs",children:[c("profile.joinedOn"),":"," ",hs(new Date(s.created_at),{addSuffix:!0})]})]}),e.jsx(Ve,{className:`text-primary fill-primary flex-shrink-0 ${t?"w-4 h-4":"w-5 h-5"}`})]})}),e.jsx(qt,{open:l,onOpenChange:i,activity:{title:String(a(s.activity,"title")),image_url:s.activity?.image_url,content:String(a(s.activity,"content"))}})]})});qs.displayName="ActivitySubscriptionItem";const Ls=x.memo(({activityGroup:s,getLocalizedField:a,t:c,isMobile:t})=>{const l=s.activity,i=s.restaurants;return e.jsxs("div",{className:`rounded-lg border hover:shadow-medium transition-shadow ${t?"p-3":"p-4"}`,children:[e.jsx(I,{to:`/activity/${l.id}`,className:t?"block mb-2":"block mb-3",children:e.jsxs("div",{className:`flex items-start ${t?"gap-3":"gap-4"}`,children:[l.image_url&&e.jsx("img",{src:l.image_url,alt:String(a(l,"title")),className:`rounded-lg object-cover flex-shrink-0 ${t?"w-20 h-20":"w-24 h-24"}`,loading:"lazy"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:`font-semibold text-card-foreground mb-1 ${t?"text-sm":""}`,children:a(l,"title")}),e.jsx("div",{className:`text-muted-foreground line-clamp-2 prose max-w-none mb-2 ${t?"text-xs prose-xs":"text-sm prose-sm"}`,dangerouslySetInnerHTML:{__html:a(l,"content")}}),e.jsxs("div",{className:"flex items-center gap-2 md:gap-4 text-xs text-muted-foreground flex-wrap",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(xe,{className:"w-3 h-3"}),new Date(l.start_date).toLocaleDateString()]}),l.end_date&&e.jsxs("span",{children:["- ",new Date(l.end_date).toLocaleDateString()]})]})]})]})}),e.jsxs("div",{className:`pt-2 md:pt-3 border-t ${t?"mt-2":"mt-3"}`,children:[e.jsxs("div",{className:`flex items-center gap-2 ${t?"mb-1.5":"mb-2"}`,children:[e.jsx(pe,{className:`text-primary ${t?"w-3.5 h-3.5":"w-4 h-4"}`}),e.jsxs("span",{className:`font-medium text-foreground ${t?"text-xs":"text-sm"}`,children:[c("profile.participatingRestaurants")," (",i.length,")"]})]}),e.jsx("div",{className:`flex flex-wrap ${t?"gap-1.5":"gap-2"}`,children:i.map(o=>e.jsx(j,{variant:"secondary",className:t?"text-xs px-2 py-0.5":"text-xs",children:a(o,"name")},o.id))})]})]})});Ls.displayName="MerchantActivityItem";const Hs=x.memo(({coupon:s,getLocalizedField:a,t:c,isMobile:t})=>{const[l,i]=x.useState(!1),o=s.coupon_codes?.coupon_templates,n=s.coupon_codes?.code,p=!!s.used_at;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`rounded-lg border transition-shadow cursor-pointer ${p?"bg-muted/30":"hover:shadow-medium"} ${t?"p-3":"p-4"}`,onClick:()=>i(!0),children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`font-semibold text-card-foreground mb-1 ${t?"text-sm":"text-base"}`,children:a(o,"title")}),e.jsx("p",{className:`text-muted-foreground line-clamp-2 ${t?"text-xs":"text-sm"}`,children:a(o,"description")})]}),e.jsx(j,{variant:p?"secondary":"default",className:t?"text-xs":"",children:c(p?"profile.coupons.used":"profile.coupons.available")})]}),e.jsxs("div",{className:`flex items-center gap-2 mb-2 ${t?"text-xs":"text-sm"}`,children:[e.jsx("span",{className:"font-mono bg-secondary/50 px-2 py-1 rounded",children:n}),e.jsx("span",{className:"text-muted-foreground",children:o?.discount_type==="percentage"?`${o?.discount_value}%`:`â‚¬${o?.discount_value}`})]}),e.jsx("div",{className:`text-muted-foreground ${t?"text-xs":"text-sm"}`,children:p?e.jsxs("span",{children:[c("profile.coupons.usedOn"),": ",fe(new Date(s.used_at),"yyyy-MM-dd HH:mm")]}):o?.valid_until?e.jsxs("span",{children:[c("profile.coupons.validUntil"),": ",fe(new Date(o.valid_until),"yyyy-MM-dd")]}):e.jsx("span",{children:c("profile.coupons.noExpiry")})})]}),e.jsx(Vt,{open:l,onOpenChange:i,coupon:s})]})});Hs.displayName="UserCouponItem";const Pr=()=>{const{t:s,i18n:a}=M(),{user:c}=De(),t=ot();dt();const{data:l,isLoading:i}=ga(),{data:o,isLoading:n}=Lt(),{data:p,isLoading:m}=Ht(),{data:h,isLoading:F}=ht(),{data:b,isLoading:K}=Bt(),{data:R,isLoading:U}=ft(),{data:_,isLoading:q}=jt({authorId:c?.id}),{savedRecipes:w,isLoading:he,deleteRecipe:Ee}=Rt(),{role:L,isMerchant:qe,isSupervisor:ge,isAdmin:se}=ua(),{getLocalizedField:y}=us(),{settings:Le}=mt(),ae=ha(),X=qe||ge,[Y,ve]=x.useState("profile"),[te,Fe]=x.useState(),[Xe,Ie]=x.useState({}),[V,$e]=x.useState(new Set(["profile"])),[G,Ne]=x.useState(!1),[$,ye]=x.useState(null),[H,we]=x.useState({}),Z=x.useCallback(async()=>{if($){ye(null),we({});return}Ne(!0);try{const r=await Ut(),{latitude:u,longitude:N}=r.coords;if(ye({lat:u,lng:N}),o){const P={};o.forEach(re=>{re.lat&&re.lng&&(P[re.id]=zt(u,N,re.lat,re.lng))}),we(P)}}catch{}finally{Ne(!1)}},[$,o]),W=x.useMemo(()=>o?!$||Object.keys(H).length===0?o:[...o].sort((r,u)=>{const N=H[r.id]??1/0,P=H[u.id]??1/0;return N-P}):[],[o,$,H]),Oe=X?[{value:"profile",label:s("profile.profile"),icon:Xs},{value:"favorites",label:s("profile.favorites"),icon:Ve},{value:"comments",label:s("profile.comments"),icon:Be},{value:"activities",label:s("profile.participatedActivities"),icon:xe}]:[{value:"profile",label:s("profile.profile"),icon:Xs},{value:"favorites",label:s("profile.favorites"),icon:Ve},{value:"comments",label:s("profile.comments"),icon:Be}],Te=r=>{Ie(u=>({...u,[r]:window.scrollY}))},Ye=r=>{if(V.has(r)){const u=Xe[r]||0;requestAnimationFrame(()=>{requestAnimationFrame(()=>{window.scrollTo({top:u,behavior:"instant"})})})}else requestAnimationFrame(()=>{requestAnimationFrame(()=>{window.scrollTo({top:0,behavior:"instant"})})}),$e(u=>new Set([...u,r]))};x.useEffect(()=>{if(!te)return;const r=()=>{const u=te.selectedScrollSnap(),N=Oe[u].value;N!==Y&&(Te(Y),Ye(N),ve(N))};return te.on("select",r),()=>{te.off("select",r)}},[te,Y,Xe,V]);const be=r=>{if(r===Y)return;Te(Y);const u=Oe.findIndex(N=>N.value===r);u!==-1&&te&&te.scrollTo(u),Ye(r),ve(r)},S=st(),Ce=x.useCallback(async()=>{S.removeQueries({queryKey:["profile"]}),S.removeQueries({queryKey:["favorites"]}),S.removeQueries({queryKey:["favorites-restaurants"]}),S.removeQueries({queryKey:["user-comments"]}),S.removeQueries({queryKey:["subscriptions"]}),S.removeQueries({queryKey:["user-coupons"]}),S.removeQueries({queryKey:["merchant-activities"]}),S.removeQueries({queryKey:["user-points"]}),S.removeQueries({queryKey:["community-posts"]}),S.removeQueries({queryKey:["saved-recipes"]}),await Promise.all([S.invalidateQueries({queryKey:["profile"]}),S.invalidateQueries({queryKey:["favorites"]}),S.invalidateQueries({queryKey:["favorites-restaurants"]}),S.invalidateQueries({queryKey:["user-comments"]}),S.invalidateQueries({queryKey:["subscriptions"]}),S.invalidateQueries({queryKey:["user-coupons"]}),S.invalidateQueries({queryKey:["merchant-activities"]}),S.invalidateQueries({queryKey:["user-points"]}),S.invalidateQueries({queryKey:["community-posts"]})])},[S]);if(!c||i)return e.jsx("div",{className:"min-h-screen bg-secondary/20 py-8 px-4",children:e.jsx("div",{className:"container mx-auto max-w-6xl",children:e.jsx("div",{className:"text-center",children:s("common.loading")})})});const Re=s(L?`profile.role.${L}`:"profile.role.user");return e.jsx(e.Fragment,{children:e.jsx(At,{onRefresh:Ce,children:e.jsx("div",{className:`min-h-screen bg-secondary/20 ${t?"pb-20 pt-4":"py-4 md:py-8 px-3 md:px-4"}`,children:e.jsxs("div",{className:`container mx-auto max-w-6xl ${t?"px-3":""}`,children:[!t&&e.jsx(e.Fragment,{children:e.jsx(D,{className:"mb-6 md:mb-8",children:e.jsx(E,{className:"pt-4 md:pt-6 pb-4 md:pb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start gap-4 md:gap-6",children:[e.jsxs(Is,{className:"w-24 h-24",children:[e.jsx($s,{src:l?.avatar_url||""}),e.jsx(Os,{className:"text-3xl",children:l?.display_name?.charAt(0).toUpperCase()||"U"})]}),e.jsxs("div",{className:"flex-1 text-center md:text-left",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2 text-foreground",children:l?.display_name}),e.jsx("p",{className:"text-muted-foreground mb-2 md:mb-3",children:c.email}),l?.phone&&e.jsx("p",{className:"text-muted-foreground mb-2 md:mb-3",children:l.phone}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[L&&L!=="user"&&e.jsx(j,{className:"bg-primary capitalize",children:Re}),l?.has_published_recipe&&e.jsxs(j,{className:"gap-1 border font-semibold",style:{background:"linear-gradient(135deg, #c0c0c0 0%, #e8e8e8 50%, #a8a8a8 100%)",borderColor:"#b0b0b0",color:"#3a3a3a",boxShadow:"0 1px 3px rgba(0,0,0,0.2)"},children:[e.jsx(Je,{className:"w-3 h-3"}),s("profile.recipeExpert")]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(Ys,{className:"h-5 w-5 text-amber-500"}),e.jsx("span",{className:"font-semibold text-lg",children:l?.points||0}),e.jsx("span",{className:"text-muted-foreground",children:s("profile.points")}),e.jsx(ra,{}),(Le?.shop_enabled!==!1||se)&&e.jsxs(I,{to:"/shop",className:"ml-2 inline-flex items-center gap-1 text-sm text-primary hover:underline",children:[e.jsx(Zs,{className:"h-4 w-4"}),s("profile.pointsShop")]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-start",children:[l&&e.jsx(la,{profile:l}),X&&l&&e.jsx(ia,{isAgreed:l?.activity_terms_agreed||!1,agreedAt:l?.activity_terms_agreed_at||null})]})]})})})}),t?e.jsx(e.Fragment,{children:e.jsx(xt,{setApi:Fe,opts:{align:"start",loop:!1},className:"w-full",children:e.jsxs(pt,{className:"-ml-0",children:[e.jsx(es,{className:"pl-0",children:e.jsxs("div",{className:"pb-4 space-y-4",children:[e.jsx(D,{children:e.jsx(E,{className:"pt-6 pb-6",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs(Is,{className:"w-20 h-20",children:[e.jsx($s,{src:l?.avatar_url||""}),e.jsx(Os,{className:"text-2xl",children:l?.display_name?.charAt(0).toUpperCase()||"U"})]}),e.jsxs("div",{className:"flex-1 text-center w-full",children:[e.jsx("h1",{className:"text-2xl font-bold mb-2 text-foreground",children:l?.display_name}),e.jsx("p",{className:"text-muted-foreground text-sm mb-2",children:c.email}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[e.jsx(Ys,{className:"h-4 w-4 text-amber-500"}),e.jsx("span",{className:"font-semibold",children:l?.points||0}),e.jsx("span",{className:"text-muted-foreground text-sm",children:s("profile.points")}),e.jsx(ra,{})]}),(Le?.shop_enabled!==!1||se)&&e.jsxs(I,{to:"/shop",className:"inline-flex items-center justify-center gap-1 text-xs text-primary hover:underline mb-2",children:[e.jsx(Zs,{className:"h-3 w-3"}),s("profile.pointsShop")]}),l?.phone&&e.jsx("p",{className:"text-muted-foreground text-sm mb-3",children:l.phone}),e.jsxs("div",{className:"flex items-center justify-center gap-2 flex-wrap mb-4",children:[L&&L!=="user"&&e.jsx(j,{className:"bg-primary capitalize text-xs",children:Re}),l?.has_published_recipe&&e.jsxs(j,{className:"gap-1 border font-semibold text-xs",style:{background:"linear-gradient(135deg, #c0c0c0 0%, #e8e8e8 50%, #a8a8a8 100%)",borderColor:"#b0b0b0",color:"#3a3a3a",boxShadow:"0 1px 3px rgba(0,0,0,0.2)"},children:[e.jsx(Je,{className:"w-3 h-3"}),s("profile.recipeExpert")]})]}),l&&e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row gap-2 w-full",children:[e.jsx(la,{profile:l}),X&&e.jsx(ia,{isAgreed:l?.activity_terms_agreed||!1,agreedAt:l?.activity_terms_agreed_at||null})]})]})]})})}),e.jsx(pa,{isMobile:!0}),e.jsxs(D,{children:[e.jsxs(z,{className:"pb-3",children:[e.jsxs(B,{className:"text-lg flex items-center gap-2",children:[e.jsx(Ge,{className:"w-5 h-5"}),s("profile.coupons.title")]}),e.jsx(Q,{className:"text-xs",children:s("profile.coupons.description")})]}),e.jsx(E,{className:"px-3",children:U?e.jsx("div",{className:"text-center py-8 text-sm",children:s("common.loading")}):R&&R.length>0?e.jsx("div",{className:"space-y-3",children:R.map(r=>e.jsx(Hs,{coupon:r,getLocalizedField:y,t:s,isMobile:!0},r.id))}):e.jsxs("p",{className:"text-muted-foreground text-center py-8 text-sm",children:[s("profile.coupons.noCoupons")," ",e.jsx(I,{to:"/activities",className:"text-primary hover:underline",children:s("profile.coupons.browseActivities")})]})})]}),e.jsx(oa,{}),e.jsx(da,{}),e.jsx(ma,{})]})}),e.jsx(es,{className:"pl-0",children:e.jsx("div",{className:"pb-4",children:e.jsx(D,{children:e.jsx(E,{className:"pt-4",children:e.jsxs(Ke,{defaultValue:"restaurants",className:"w-full",children:[e.jsxs(Qe,{className:"grid w-full grid-cols-2 mb-4",children:[e.jsxs(O,{value:"restaurants",className:"flex items-center gap-2 text-xs",children:[e.jsx(pe,{className:"w-4 h-4"}),s("profile.restaurantFavorites"),o&&o.length>0&&e.jsx(j,{variant:"secondary",className:"ml-1 px-1.5 py-0 text-xs min-w-[20px] h-5",children:o.length})]}),e.jsxs(O,{value:"activities",className:"flex items-center gap-2 text-xs",children:[e.jsx(xe,{className:"w-4 h-4"}),s("profile.activityFavorites"),h&&h.length>0&&e.jsx(j,{variant:"secondary",className:"ml-1 px-1.5 py-0 text-xs min-w-[20px] h-5",children:h.length})]})]}),e.jsxs(T,{value:"restaurants",children:[o&&o.length>0&&e.jsx("div",{className:"flex items-center gap-2 mb-3 flex-wrap",children:e.jsxs(g,{variant:$?"default":"outline",size:"sm",onClick:Z,disabled:G,className:"h-7 text-xs gap-1",children:[G?e.jsx(Ds,{className:"w-3 h-3 animate-spin"}):e.jsx(Js,{className:"w-3 h-3"}),s(G?"profile.sortingByDistance":$?"profile.sortedByDistance":"profile.sortByDistance")]})}),n?e.jsx("div",{className:"text-center py-8 text-sm",children:s("common.loading")}):W&&W.length>0?e.jsx("div",{className:"grid gap-3 grid-cols-1",children:W.map(r=>e.jsx(zs,{restaurant:r,getLocalizedField:y,t:s,distance:$?H[r.id]:void 0},r.id))}):e.jsx("p",{className:"text-muted-foreground text-center py-8 text-sm",children:s("profile.noFavorites")})]}),e.jsx(T,{value:"activities",children:F?e.jsx("div",{className:"text-center py-8 text-sm",children:s("common.loading")}):h&&h.length>0?e.jsx("div",{className:"space-y-3",children:h.map(r=>e.jsx(qs,{subscription:r,getLocalizedField:y,t:s,isMobile:!0},r.id))}):e.jsxs("p",{className:"text-muted-foreground text-center py-8 text-sm",children:[s("profile.noActivityFavorites")," ",e.jsx(I,{to:"/activities",className:"text-primary hover:underline",children:s("profile.browseActivities")})]})})]})})})})}),e.jsx(es,{className:"pl-0",children:e.jsx("div",{className:"pb-4",children:e.jsx(D,{children:e.jsx(E,{className:"pt-4",children:e.jsxs(Ke,{defaultValue:"comments",className:"w-full",children:[e.jsxs(Qe,{className:"grid w-full grid-cols-3 mb-4",children:[e.jsxs(O,{value:"comments",className:"flex items-center gap-2 text-xs",children:[e.jsx(Be,{className:"w-4 h-4"}),s("profile.myComments"),p&&p.length>0&&e.jsx(j,{variant:"secondary",className:"ml-1 px-1.5 py-0 text-xs min-w-[20px] h-5",children:p.length})]}),e.jsxs(O,{value:"posts",className:"flex items-center gap-2 text-xs",children:[e.jsx(ea,{className:"w-4 h-4"}),s("profile.myPosts"),_&&_.length>0&&e.jsx(j,{variant:"secondary",className:"ml-1 px-1.5 py-0 text-xs min-w-[20px] h-5",children:_.length})]}),e.jsxs(O,{value:"saved-recipes",className:"flex items-center gap-2 text-xs",children:[e.jsx(sa,{className:"w-4 h-4"}),s("profile.savedRecipes","æˆ‘çš„é£Ÿè°±"),w.length>0&&e.jsx(j,{variant:"secondary",className:"ml-1 px-1.5 py-0 text-xs min-w-[20px] h-5",children:w.length})]})]}),e.jsx(T,{value:"comments",children:m?e.jsx("div",{className:"text-center py-8 text-sm",children:s("common.loading")}):p&&p.length>0?e.jsx("div",{className:"space-y-3",children:p.map(r=>e.jsx(Us,{comment:r,getLocalizedField:y,t:s},r.id))}):e.jsx("p",{className:"text-muted-foreground text-center py-8 text-sm",children:s("profile.noComments")})}),e.jsx(T,{value:"posts",children:q?e.jsx("div",{className:"text-center py-8 text-sm",children:s("common.loading")}):_&&_.length>0?e.jsx("div",{className:"space-y-3",children:_.map(r=>e.jsx(ta,{post:r,showAssociations:!0},r.id))}):e.jsxs("p",{className:"text-muted-foreground text-center py-8 text-sm",children:[s("profile.noPosts")," ",e.jsx(I,{to:"/community",className:"text-primary hover:underline",children:s("profile.browseActivities")})]})}),e.jsx(T,{value:"saved-recipes",children:he?e.jsx("div",{className:"text-center py-8 text-sm",children:s("common.loading")}):w.length>0?e.jsx("div",{className:"space-y-3",children:w.map(r=>e.jsx("div",{className:"p-3 rounded-lg border hover:shadow-medium transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0 cursor-pointer",onClick:()=>ae(`/saved-recipe/${r.id}`),children:[e.jsx("h3",{className:"font-semibold text-sm line-clamp-1",children:a.language==="en"&&r.recipe_data.recipe_name_en?r.recipe_data.recipe_name_en:a.language==="pt"&&r.recipe_data.recipe_name_pt?r.recipe_data.recipe_name_pt:r.recipe_name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-muted-foreground",children:[r.recipe_data.cook_time&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(je,{className:"w-3 h-3"}),r.recipe_data.cook_time,s("recipe.minutes","åˆ†é’Ÿ")]}),r.recipe_data.difficulty&&e.jsxs(j,{variant:"outline",className:"text-xs px-1.5 py-0",children:[e.jsx(Je,{className:"w-3 h-3 mr-0.5"}),s(`recipe.difficulty.${r.recipe_data.difficulty}`)]}),r.recipe_data.servings&&e.jsxs("span",{children:[r.recipe_data.servings,s("recipe.servingsUnit","äººä»½")]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[s("recipe.ingredients","é£Ÿæ"),": ",r.recipe_data.ingredients?.length||0," Â· ",s("recipe.steps","æ­¥éª¤"),": ",r.recipe_data.steps?.length||0]})]}),e.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[e.jsx(g,{variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-primary",onClick:()=>ae(`/saved-recipe/${r.id}`),children:e.jsx(aa,{className:"h-4 w-4"})}),e.jsx(g,{variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-destructive",onClick:()=>Ee(r.id),children:e.jsx(xs,{className:"h-4 w-4"})})]})]})},r.id))}):e.jsxs("p",{className:"text-muted-foreground text-center py-8 text-sm",children:[s("profile.noSavedRecipes","è¿˜æ²¡æœ‰ä¿å­˜çš„é£Ÿè°±")," ",e.jsx(I,{to:"/ai-recipe",className:"text-primary hover:underline",children:s("profile.tryAIRecipe","è¯•è¯• AI é£Ÿè°±")})]})})]})})})})}),X&&e.jsx(es,{className:"pl-0",children:e.jsx("div",{className:"pb-4",children:e.jsxs(D,{children:[e.jsxs(z,{className:"pb-3",children:[e.jsxs(B,{className:"text-lg flex items-center gap-2",children:[e.jsx(xe,{className:"w-5 h-5"}),s("profile.participatedActivities")]}),e.jsx(Q,{className:"text-xs",children:s("profile.participatedActivitiesDesc")})]}),e.jsx(E,{className:"px-3",children:e.jsx("div",{className:"space-y-4",children:K?e.jsx("div",{className:"text-center py-8 text-sm",children:s("common.loading")}):b&&b.length>0?e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2 text-base",children:[e.jsx(pe,{className:"w-4 h-4"}),s("profile.restaurantActivities")]}),e.jsx("div",{className:"space-y-3",children:(()=>{const r=b.reduce((u,N)=>{const P=N.activity_id;return u[P]||(u[P]={activity:N.activity,restaurants:[],participationDate:N.created_at}),u[P].restaurants.push({id:N.restaurant_id,name:N.restaurant_name,name_en:N.restaurant_name_en,name_pt:N.restaurant_name_pt}),u},{});return Object.values(r).map(u=>e.jsx(Ls,{activityGroup:u,getLocalizedField:y,t:s,isMobile:!0},u.activity.id))})()})]}):e.jsxs("p",{className:"text-muted-foreground text-center py-8 text-sm",children:[s("profile.noParticipatedActivities")," ",e.jsx(I,{to:"/activities",className:"text-primary hover:underline",children:s("profile.browseActivities")})]})})})]})})})]})})}):e.jsxs(Ke,{defaultValue:"favorites",className:"space-y-4 md:space-y-6",children:[e.jsxs(Qe,{className:`grid w-full ${X?"grid-cols-7":"grid-cols-6"} bg-card border rounded-lg shadow-sm h-auto p-1`,children:[e.jsxs(O,{value:"favorites",className:"data-[state=active]:bg-primary data-[state=active]:text-primary-foreground py-2.5 text-sm",children:[e.jsx(Ve,{className:"w-4 h-4 mr-2"}),s("profile.favorites")]}),e.jsxs(O,{value:"coupons",className:"data-[state=active]:bg-primary data-[state=active]:text-primary-foreground py-2.5 text-sm",children:[e.jsx(Ge,{className:"w-4 h-4 mr-2"}),s("profile.coupons.title")]}),e.jsxs(O,{value:"comments",className:"data-[state=active]:bg-primary data-[state=active]:text-primary-foreground py-2.5 text-sm",children:[e.jsx(Be,{className:"w-4 h-4 mr-2"}),s("profile.comments")]}),X&&e.jsxs(O,{value:"activities",className:"data-[state=active]:bg-primary data-[state=active]:text-primary-foreground py-2.5 text-sm",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),s("profile.participatedActivities")]}),e.jsxs(O,{value:"invitation-code",className:"data-[state=active]:bg-primary data-[state=active]:text-primary-foreground py-2.5 text-sm",children:[e.jsx(Fs,{className:"w-4 h-4 mr-2"}),s("profile.invitationCode.title")]}),e.jsxs(O,{value:"addresses",className:"data-[state=active]:bg-primary data-[state=active]:text-primary-foreground py-2.5 text-sm",children:[e.jsx(_e,{className:"w-4 h-4 mr-2"}),s("address.myAddresses")]}),e.jsxs(O,{value:"orders",className:"data-[state=active]:bg-primary data-[state=active]:text-primary-foreground py-2.5 text-sm",children:[e.jsx(Bs,{className:"w-4 h-4 mr-2"}),s("profile.orderRecords")]})]}),e.jsx(T,{value:"favorites",children:e.jsx(D,{children:e.jsx(E,{className:"pt-6",children:e.jsxs(Ke,{defaultValue:"restaurants",className:"w-full",children:[e.jsxs(Qe,{className:"grid w-full grid-cols-2 mb-6",children:[e.jsxs(O,{value:"restaurants",className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4"}),s("profile.restaurantFavorites"),o&&o.length>0&&e.jsx(j,{variant:"secondary",className:"ml-1 px-1.5 py-0 text-xs min-w-[20px] h-5",children:o.length})]}),e.jsxs(O,{value:"activities",className:"flex items-center gap-2",children:[e.jsx(xe,{className:"w-4 h-4"}),s("profile.activityFavorites"),h&&h.length>0&&e.jsx(j,{variant:"secondary",className:"ml-1 px-1.5 py-0 text-xs min-w-[20px] h-5",children:h.length})]})]}),e.jsxs(T,{value:"restaurants",children:[o&&o.length>0&&e.jsx("div",{className:"flex items-center gap-2 mb-4 flex-wrap",children:e.jsxs(g,{variant:$?"default":"outline",size:"sm",onClick:Z,disabled:G,className:"h-8 text-sm gap-1.5",children:[G?e.jsx(Ds,{className:"w-4 h-4 animate-spin"}):e.jsx(Js,{className:"w-4 h-4"}),s(G?"profile.sortingByDistance":$?"profile.sortedByDistance":"profile.sortByDistance")]})}),n?e.jsx("div",{className:"text-center py-8",children:s("common.loading")}):W&&W.length>0?e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:W.map(r=>e.jsx(zs,{restaurant:r,getLocalizedField:y,t:s,distance:$?H[r.id]:void 0},r.id))}):e.jsx("p",{className:"text-muted-foreground text-center py-8",children:s("profile.noFavorites")})]}),e.jsx(T,{value:"activities",children:F?e.jsx("div",{className:"text-center py-8",children:s("common.loading")}):h&&h.length>0?e.jsx("div",{className:"space-y-4",children:h.map(r=>e.jsx(qs,{subscription:r,getLocalizedField:y,t:s,isMobile:t},r.id))}):e.jsxs("p",{className:"text-muted-foreground text-center py-8",children:[s("profile.noActivityFavorites")," ",e.jsx(I,{to:"/activities",className:"text-primary hover:underline",children:s("profile.browseActivities")})]})})]})})})}),e.jsx(T,{value:"comments",children:e.jsx(D,{children:e.jsx(E,{className:"pt-6",children:e.jsxs(Ke,{defaultValue:"comments",className:"w-full",children:[e.jsxs(Qe,{className:"grid w-full grid-cols-3 mb-6",children:[e.jsxs(O,{value:"comments",className:"flex items-center gap-2",children:[e.jsx(Be,{className:"w-4 h-4"}),s("profile.myComments"),p&&p.length>0&&e.jsx(j,{variant:"secondary",className:"ml-1 px-1.5 py-0 text-xs min-w-[20px] h-5",children:p.length})]}),e.jsxs(O,{value:"posts",className:"flex items-center gap-2",children:[e.jsx(ea,{className:"w-4 h-4"}),s("profile.myPosts"),_&&_.length>0&&e.jsx(j,{variant:"secondary",className:"ml-1 px-1.5 py-0 text-xs min-w-[20px] h-5",children:_.length})]}),e.jsxs(O,{value:"saved-recipes",className:"flex items-center gap-2",children:[e.jsx(sa,{className:"w-4 h-4"}),s("profile.savedRecipes","æˆ‘çš„é£Ÿè°±"),w.length>0&&e.jsx(j,{variant:"secondary",className:"ml-1 px-1.5 py-0 text-xs min-w-[20px] h-5",children:w.length})]})]}),e.jsx(T,{value:"comments",children:m?e.jsx("div",{className:"text-center py-8",children:s("common.loading")}):p&&p.length>0?e.jsx("div",{className:"space-y-4",children:p.map(r=>e.jsx(Us,{comment:r,getLocalizedField:y,t:s},r.id))}):e.jsx("p",{className:"text-muted-foreground text-center py-8",children:s("profile.noComments")})}),e.jsx(T,{value:"posts",children:q?e.jsx("div",{className:"text-center py-8",children:s("common.loading")}):_&&_.length>0?e.jsx("div",{className:"columns-2 gap-4 md:columns-3",children:_.map(r=>e.jsx("div",{className:"break-inside-avoid mb-4",children:e.jsx(ta,{post:r})},r.id))}):e.jsxs("p",{className:"text-muted-foreground text-center py-8",children:[s("profile.noPosts")," ",e.jsx(I,{to:"/community",className:"text-primary hover:underline",children:s("profile.browseActivities")})]})}),e.jsx(T,{value:"saved-recipes",children:he?e.jsx("div",{className:"text-center py-8",children:s("common.loading")}):w.length>0?e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:w.map(r=>e.jsx("div",{className:"p-4 rounded-lg border hover:shadow-medium transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0 cursor-pointer",onClick:()=>ae(`/saved-recipe/${r.id}`),children:[e.jsx("h3",{className:"font-semibold line-clamp-1",children:a.language==="en"&&r.recipe_data.recipe_name_en?r.recipe_data.recipe_name_en:a.language==="pt"&&r.recipe_data.recipe_name_pt?r.recipe_data.recipe_name_pt:r.recipe_name}),e.jsxs("div",{className:"flex items-center gap-3 mt-2 text-sm text-muted-foreground",children:[r.recipe_data.cook_time&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(je,{className:"w-3.5 h-3.5"}),r.recipe_data.cook_time,s("recipe.minutes","åˆ†é’Ÿ")]}),r.recipe_data.difficulty&&e.jsxs(j,{variant:"outline",className:"text-xs",children:[e.jsx(Je,{className:"w-3 h-3 mr-1"}),s(`recipe.difficulty.${r.recipe_data.difficulty}`)]}),r.recipe_data.servings&&e.jsxs("span",{children:[r.recipe_data.servings,s("recipe.servingsUnit","äººä»½")]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[s("recipe.ingredients","é£Ÿæ"),": ",r.recipe_data.ingredients?.length||0," Â· ",s("recipe.steps","æ­¥éª¤"),": ",r.recipe_data.steps?.length||0]})]}),e.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[e.jsx(g,{variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-primary",onClick:()=>ae(`/saved-recipe/${r.id}`),children:e.jsx(aa,{className:"h-4 w-4"})}),e.jsx(g,{variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-destructive",onClick:()=>Ee(r.id),children:e.jsx(xs,{className:"h-4 w-4"})})]})]})},r.id))}):e.jsxs("p",{className:"text-muted-foreground text-center py-8",children:[s("profile.noSavedRecipes","è¿˜æ²¡æœ‰ä¿å­˜çš„é£Ÿè°±")," ",e.jsx(I,{to:"/ai-recipe",className:"text-primary hover:underline",children:s("profile.tryAIRecipe","è¯•è¯• AI é£Ÿè°±")})]})})]})})})}),X&&e.jsx(T,{value:"activities",children:e.jsxs(D,{children:[e.jsxs(z,{className:t?"pb-3":"",children:[e.jsxs(B,{className:`flex items-center gap-2 ${t?"text-lg":""}`,children:[e.jsx(xe,{className:"w-5 h-5"}),s("profile.participatedActivities")]}),e.jsx(Q,{className:t?"text-xs":"",children:s("profile.participatedActivitiesDesc")})]}),e.jsx(E,{className:t?"px-3":"",children:e.jsx("div",{className:t?"space-y-4":"space-y-6",children:K?e.jsx("div",{className:`text-center py-8 ${t?"text-sm":""}`,children:s("common.loading")}):b&&b.length>0?e.jsxs("div",{children:[e.jsxs("h3",{className:`font-semibold mb-3 md:mb-4 flex items-center gap-2 ${t?"text-base":"text-lg"}`,children:[e.jsx(pe,{className:t?"w-4 h-4":"w-5 h-5"}),s("profile.restaurantActivities")]}),e.jsx("div",{className:t?"space-y-3":"space-y-4",children:(()=>{const r=b.reduce((u,N)=>{const P=N.activity_id;return u[P]||(u[P]={activity:N.activity,restaurants:[],participationDate:N.created_at}),u[P].restaurants.push({id:N.restaurant_id,name:N.restaurant_name,name_en:N.restaurant_name_en,name_pt:N.restaurant_name_pt}),u},{});return Object.values(r).map(u=>e.jsx(Ls,{activityGroup:u,getLocalizedField:y,t:s,isMobile:t},u.activity.id))})()})]}):e.jsxs("p",{className:`text-muted-foreground text-center py-8 ${t?"text-sm":""}`,children:[s("profile.noParticipatedActivities")," ",e.jsx(I,{to:"/activities",className:"text-primary hover:underline",children:s("profile.browseActivities")})]})})})]})}),e.jsx(T,{value:"invitation-code",children:e.jsx(pa,{})}),e.jsx(T,{value:"coupons",children:e.jsxs(D,{children:[e.jsxs(z,{className:t?"pb-3":"",children:[e.jsxs(B,{className:`flex items-center gap-2 ${t?"text-lg":""}`,children:[e.jsx(Ge,{className:"w-5 h-5"}),s("profile.coupons.title")]}),e.jsx(Q,{className:t?"text-xs":"",children:s("profile.coupons.description")})]}),e.jsx(E,{className:t?"px-3":"",children:U?e.jsx("div",{className:`text-center py-8 ${t?"text-sm":""}`,children:s("common.loading")}):R&&R.length>0?e.jsx("div",{className:`grid gap-3 md:gap-4 ${t?"grid-cols-1":"md:grid-cols-2"}`,children:R.map(r=>e.jsx(Hs,{coupon:r,getLocalizedField:y,t:s,isMobile:t},r.id))}):e.jsxs("p",{className:`text-muted-foreground text-center py-8 ${t?"text-sm":""}`,children:[s("profile.coupons.noCoupons")," ",e.jsx(I,{to:"/activities",className:"text-primary hover:underline",children:s("profile.coupons.browseActivities")})]})})]})}),e.jsx(T,{value:"addresses",children:e.jsx(oa,{})}),e.jsx(T,{value:"orders",children:e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsx(da,{}),e.jsx(ma,{})]})})]}),t&&e.jsxs("div",{className:"fixed left-4 right-4 z-40 bg-white/20 dark:bg-black/25 backdrop-blur-sm border border-white/40 dark:border-white/30 shadow-[0_2px_20px_rgba(0,0,0,0.08)] rounded-[28px] overflow-hidden",style:{contain:"layout style paint",isolation:"isolate",backfaceVisibility:"hidden",transform:"translateZ(0)",bottom:"max(1rem, calc(env(safe-area-inset-bottom) + 0.25rem))"},children:[e.jsx("div",{className:"absolute inset-0 rounded-[28px] bg-gradient-to-b from-white/10 via-transparent to-transparent pointer-events-none"}),e.jsx("div",{className:"relative flex justify-around items-center h-16 px-4",children:Oe.map(r=>{const u=r.icon;return e.jsxs("button",{onClick:()=>be(r.value),className:`relative flex flex-col items-center justify-center flex-1 h-12 py-1.5 px-2 mx-0.5 transition-all duration-200 rounded-2xl ${Y===r.value?"text-primary dark:text-white bg-primary/15 dark:bg-white/15":"text-gray-700 dark:text-white/80 active:bg-black/5 dark:active:bg-white/5"}`,children:[e.jsx(u,{className:`h-5 w-5 mb-0.5 transition-all duration-200 ${Y===r.value?"scale-110 drop-shadow-[0_0_6px_rgba(34,197,94,0.6)] dark:drop-shadow-[0_0_6px_rgba(255,255,255,0.6)]":""}`}),e.jsx("span",{className:`text-xs text-center leading-tight ${Y===r.value?"font-semibold":"font-normal"}`,children:r.label})]},r.value)})})]})]})})})})};export{Pr as default};
//# sourceMappingURL=Profile-Bn4sKvo3.js.map
