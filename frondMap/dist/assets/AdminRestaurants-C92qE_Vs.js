import{p as me,r as m,j as e,b2 as de,bW as oe,aZ as xe,b3 as he,br as C,ak as je,ba as ue,bb as pe,L as fe}from"./vendor-react-DanJ59UG.js";import{z as ge,N as Ne,h as c,C as w,n as y,I as ve,a7 as S,a8 as R,a9 as T,aa as A,ab as u,A as D,ac as P,q as k,r as _,t as L,v as F,w as z,x as B,y as E,m as we,E as ye,a4 as be,B as I,Z as Ce}from"./index-Czilt4qF.js";import{C as V}from"./checkbox-D0xFfU6y.js";import{S as Se}from"./switch-LeAQa3Fm.js";import{u as Re,P as Te,a as Ae,b as g,c as De,d as Pe,e as ke,f as _e}from"./usePagination-D7SOBOMK.js";import{u as Le}from"./useLocalizedContent-Brt5DvN3.js";import{n as Fe,o as ze,p as Be,q as Ee}from"./useAdmin-BRj3am5E.js";import{R as M}from"./RestaurantFormDialog-DScDgYpu.js";import{a as Ie}from"./exportUtils-YWmY6fTR.js";import"./vendor-i18n-jtdHZIRR.js";import"./vendor-editor-B1vH4T8i.js";import"./vendor-utils-vwQGbBim.js";import"./vendor-supabase-BVVOWwEK.js";import"./vendor-map-CvE3ASYw.js";import"./radio-group-BitjWT_m.js";import"./tabs-DKLE0vJD.js";import"./RichTextEditor-piJZRSSN.js";import"./useBrands-GwcwAfDz.js";const ls=()=>{const{t:a}=me(),{toast:b}=ge(),{isSupervisor:p}=Ne(),{data:n,isLoading:H}=Fe(),{getLocalizedField:l}=Le(),G=ze(),W=Be(),$=Ee(),[r,d]=m.useState([]),[o,q]=m.useState(""),[x,Q]=m.useState("all"),[f,Z]=m.useState("all"),U=m.useMemo(()=>{if(!n)return[];const s=new Set;return n.forEach(t=>{const i=l(t,"type");Array.isArray(i)?i.forEach(v=>s.add(v)):i&&s.add(i)}),Array.from(s)},[n,l]),J=m.useMemo(()=>n?n.filter(s=>{const t=o===""||l(s,"name").toString().toLowerCase().includes(o.toLowerCase())||s.address.toLowerCase().includes(o.toLowerCase()),i=l(s,"type"),v=x==="all"||(Array.isArray(i)?i.includes(x):i===x),ce=s.template||"default";return t&&v&&(f==="all"||ce===f)}):[],[n,o,x,f,l]),{currentPage:h,totalPages:N,paginatedData:j,goToPage:K,nextPage:O,previousPage:X,canGoNext:Y,canGoPrevious:ee,startIndex:se,endIndex:ae,totalItems:te}=Re({data:J,itemsPerPage:10}),le=()=>{if(!n||n.length===0){b({title:a("common.error"),description:a("admin.noDataToExport"),variant:"destructive"});return}Ie(n),b({title:a("common.success"),description:a("admin.exportSuccess")})},ie=s=>{d(t=>t.includes(s)?t.filter(i=>i!==s):[...t,s])},ne=()=>{r.length===j?.length?d([]):d(j?.map(s=>s.id)||[])},re=()=>{r.length!==0&&(W.mutate(r),d([]))};return H?e.jsx("div",{className:"text-center",children:a("common.loading")}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-2",children:a("admin.restaurantManagement")}),e.jsx("p",{className:"text-muted-foreground",children:a("admin.manageRestaurants")})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(c,{variant:"outline",onClick:le,className:"flex-1 sm:flex-initial",children:[e.jsx(de,{className:"mr-2 h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:a("admin.exportCSV")})]}),e.jsx(M,{trigger:e.jsxs(c,{className:"flex-1 sm:flex-initial",children:[e.jsx(oe,{className:"mr-2 h-4 w-4"}),a("admin.addRestaurant")]})})]})]}),e.jsx(w,{children:e.jsx(y,{className:"pt-6",children:e.jsxs("div",{className:"flex gap-4 flex-wrap",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsxs("div",{className:"relative",children:[e.jsx(xe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ve,{placeholder:a("admin.searchRestaurants"),value:o,onChange:s=>q(s.target.value),className:"pl-9"})]})}),e.jsxs(S,{value:f,onValueChange:Z,children:[e.jsx(R,{className:"w-[160px]",children:e.jsx(T,{placeholder:a("admin.filterByTemplate")})}),e.jsxs(A,{children:[e.jsx(u,{value:"all",children:e.jsx("span",{className:"flex items-center gap-2",children:a("admin.allTemplates")})}),e.jsx(u,{value:"default",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-4 w-4"}),a("admin.standardRestaurant")]})}),e.jsx(u,{value:"ghost",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-4 w-4"}),a("admin.ghostRestaurant")]})})]})]}),e.jsxs(S,{value:x,onValueChange:Q,children:[e.jsx(R,{className:"w-[180px]",children:e.jsx(T,{placeholder:a("admin.filterByType")})}),e.jsxs(A,{children:[e.jsx(u,{value:"all",children:a("admin.allTypes")}),U.map(s=>e.jsx(u,{value:s,children:s},s))]})]})]})})}),!p&&r.length>0&&e.jsx(w,{className:"bg-muted/50",children:e.jsx(y,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[e.jsx("span",{className:"font-medium",children:a("admin.selectedCount",{count:r.length})}),e.jsxs("div",{className:"flex gap-2 flex-wrap w-full sm:w-auto",children:[e.jsxs(D,{children:[e.jsx(P,{asChild:!0,children:e.jsxs(c,{variant:"destructive",size:"sm",className:"flex-1 sm:flex-initial",children:[e.jsx(je,{className:"mr-2 h-4 w-4"}),a("admin.batchDelete")]})}),e.jsxs(k,{className:"max-w-[90vw] sm:max-w-[425px]",children:[e.jsxs(_,{children:[e.jsx(L,{children:a("admin.confirmBatchDelete")}),e.jsx(F,{children:a("admin.batchDeleteWarning",{count:r.length})})]}),e.jsxs(z,{children:[e.jsx(B,{children:a("common.cancel")}),e.jsx(E,{onClick:re,children:a("common.delete")})]})]})]}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>d([]),className:"flex-1 sm:flex-initial",children:a("admin.clearSelection")})]})]})})}),e.jsxs("div",{className:"flex items-center justify-between pb-2 border-b",children:[e.jsx("div",{className:"flex items-center gap-2",children:!p&&e.jsxs(e.Fragment,{children:[e.jsx(V,{checked:r.length===j?.length&&j.length>0,onCheckedChange:ne}),e.jsx("span",{className:"font-medium",children:a("admin.selectAll")})]})}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[a("admin.showing")," ",se,"-",ae," ",a("admin.of")," ",te]})]}),e.jsx("div",{className:"grid gap-4",children:j?.map(s=>e.jsx(w,{children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center",children:[e.jsx("div",{className:"p-4 flex items-start md:self-start",children:!p&&e.jsx(V,{checked:r.includes(s.id),onCheckedChange:()=>ie(s.id),className:"mt-1"})}),s.image_url&&e.jsx("div",{className:"w-full md:w-48 h-48 flex items-center justify-center overflow-hidden mx-auto md:mx-0 flex-shrink-0",children:e.jsx("img",{src:s.image_url,alt:String(l(s,"name")),className:"object-cover object-center w-full h-full"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs(we,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2",children:[e.jsx(ye,{className:"text-lg md:text-xl",children:l(s,"name")}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ue,{className:"h-4 w-4 fill-accent text-accent"}),e.jsx("span",{className:"font-medium",children:s.rating||0})]})})]}),e.jsxs("div",{className:"flex flex-col gap-2 mt-2",children:[e.jsxs(be,{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"h-3 w-3 flex-shrink-0"}),e.jsx("span",{className:"text-xs sm:text-sm",children:s.address})]}),l(s,"description")&&e.jsx("div",{className:`text-sm text-muted-foreground prose prose-sm max-w-none line-clamp-2\r
                            [&_p]:inline [&_p]:m-0\r
                            [&_strong]:font-semibold [&_strong]:text-foreground\r
                            [&_em]:italic\r
                            [&_h1]:text-base [&_h2]:text-base [&_h3]:text-base\r
                            [&_*]:text-muted-foreground`,dangerouslySetInnerHTML:{__html:l(s,"description")}})]})]}),e.jsxs(y,{children:[e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[s.template==="ghost"&&e.jsxs(I,{variant:"secondary",className:"bg-primary/10 text-primary border-primary/20",children:[e.jsx(C,{className:"h-3 w-3 mr-1"}),a("admin.ghostRestaurant")]}),(Array.isArray(l(s,"type"))?l(s,"type"):[l(s,"type")]).map((t,i)=>e.jsx(I,{children:t},i))]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(Ce,{htmlFor:`visible-${s.id}`,className:"text-sm font-medium",children:a("admin.frontendDisplay")}),e.jsx("div",{className:"text-xs text-muted-foreground",children:s.visible?a("admin.restaurantShown"):a("admin.restaurantHidden")})]}),e.jsx(Se,{id:`visible-${s.id}`,checked:s.visible??!0,onCheckedChange:t=>$.mutate({restaurantId:s.id,visible:t})})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(c,{variant:"outline",size:"sm",asChild:!0,className:"flex-1 sm:flex-initial",children:e.jsx(fe,{to:`/restaurant/${s.id}`,state:{from:"admin"},children:a("admin.view")})}),e.jsx(M,{restaurant:s,trigger:e.jsx(c,{variant:"outline",size:"sm",className:"flex-1 sm:flex-initial",children:a("common.edit")})}),!p&&e.jsxs(D,{children:[e.jsx(P,{asChild:!0,children:e.jsx(c,{variant:"outline",size:"sm",className:"flex-1 sm:flex-initial",children:a("common.delete")})}),e.jsxs(k,{className:"max-w-[90vw] sm:max-w-[425px]",children:[e.jsxs(_,{children:[e.jsx(L,{children:a("admin.confirmDelete")}),e.jsx(F,{children:a("admin.deleteRestaurantWarning")})]}),e.jsxs(z,{children:[e.jsx(B,{children:a("common.cancel")}),e.jsx(E,{onClick:()=>G.mutate(s.id),children:a("common.delete")})]})]})]})]})]})]})]})]})},s.id))}),N>1&&e.jsx(Te,{className:"mt-6",children:e.jsxs(Ae,{children:[e.jsx(g,{children:e.jsx(De,{onClick:X,className:ee?"cursor-pointer":"pointer-events-none opacity-50"})}),Array.from({length:N},(s,t)=>t+1).map(s=>s===1||s===N||s>=h-1&&s<=h+1?e.jsx(g,{children:e.jsx(Pe,{onClick:()=>K(s),isActive:h===s,className:"cursor-pointer",children:s})},s):s===h-2||s===h+2?e.jsx(g,{children:e.jsx(ke,{})},s):null),e.jsx(g,{children:e.jsx(_e,{onClick:O,className:Y?"cursor-pointer":"pointer-events-none opacity-50"})})]})})]})};export{ls as default};
//# sourceMappingURL=AdminRestaurants-C92qE_Vs.js.map
