import{j as e}from"./vendor-ui-DmpovMYY.js";import{a as je,u as ze,l as $e,D as De,b as Ae,c as Le,d as Ee,S as we,M as me,e as F,U as Me,L as he,I as Ne,B as U,f as Fe,g as Oe,N as le,F as Pe,h as M,i as Be,j as Ve,C as pe,k as ge,m as ie,n as fe,o as be,E as We,s as qe,p as Xe,q as He,r as Ue,H as Je,t as ke,v as _e,w as Ke,x as Qe,y as Ge,z as Ye}from"./index-B44MF3Hr.js";import{u as Se,r as o,a as Ze,L as et}from"./vendor-react-iAJ0IrSD.js";import{c as tt,g as st,m as at}from"./geolocation-DRm3QMsJ.js";import{u as rt}from"./useHomepageTemplates-DxCENpbt.js";import{u as ot}from"./usePageView-CEba-J_T.js";import{u as xe}from"./vendor-i18n-DxKeo2S1.js";import{P as nt}from"./PullToRefresh-CA7kv_F8.js";import{u as lt}from"./vendor-query-D82cqPtt.js";import{P as it,a as ct,b as dt}from"./popover-Bij1ahzr.js";import{u as mt,a as ut}from"./useRestaurants-Cr4yd8yk.js";import{u as xt,R as ht,l as pt}from"./xiaoxiong-logo-clean-BsbPWhK6.js";import{u as gt}from"./useLocalizedContent-BN2IWylL.js";import{u as ft}from"./useActivities-B1pZrTAV.js";import{L as bt}from"./LocationPermissionDialog-CBIs2LQO.js";import"./vendor-charts-Bz7hPIBd.js";import"./vendor-supabase-6pZ9VDFn.js";import"./vendor-map-BaCLwlqt.js";/* empty css                  */const vt="/assets/google-play-badge-new-BAXiFmDF.png",yt="/assets/app-store-badge-C-eOGvqu.svg",ve="https://tzdgqhwyzsxkxnncgzap.supabase.co",ce="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR6ZGdxaHd5enN4a3hubmNnemFwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM2NTg2ODgsImV4cCI6MjA3OTIzNDY4OH0.D76C4OkjQVWyMxtjjdOofpD8X_hEEoTtrXHqi4XSYUw",jt=()=>{const s="xiaoxiong_anonymous_user_id";let n=localStorage.getItem(s);return n||(n=`anon_${Date.now()}_${Math.random().toString(36).substring(2,11)}`,localStorage.setItem(s,n)),n},wt=({open:s,onOpenChange:n,provider:v="ask-xiaoxiong"})=>{const{i18n:y}=xe(),x=Se(),{settings:A}=je(),{user:O}=ze(),I=A?.logo_url||$e,[d,C]=o.useState(""),[z,p]=o.useState([]),[N,_]=o.useState(!1),[R,k]=o.useState(null),D=o.useRef(null),X=o.useRef(null),J=o.useRef(null),L=()=>O?.id?O.id:jt();o.useEffect(()=>{s&&!R&&navigator.geolocation?.getCurrentPosition(r=>{k({lat:r.coords.latitude,lng:r.coords.longitude})},r=>{console.log("Unable to get user location:",r.message)},{enableHighAccuracy:!1,timeout:5e3,maximumAge:3e5})},[s,R]),o.useEffect(()=>{J.current?.scrollIntoView({behavior:"smooth"})},[z]);const K=async(r,g)=>{const l=await fetch(`${ve}/functions/v1/ask-xiaoxiong`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ce}`,apikey:ce},body:JSON.stringify({text:r.content,stream:!0,lat:R?.lat,lng:R?.lng}),signal:D.current?.signal});if(!l.ok)throw new Error(`Request failed with status: ${l.status}`);if(!l.body)throw new Error("No response body");const u=l.body.getReader(),c=new TextDecoder;let a="";for(;;){const{done:f,value:h}=await u.read();if(f)break;const H=c.decode(h,{stream:!0});a+=H;let T=a;T.startsWith('"')&&(T=T.slice(1)),T.endsWith('"')&&(T=T.slice(0,-1)),T=T.replace(/\\n/g,`
`),p(W=>W.map($=>$.id===g?{...$,content:T}:$))}let i=a;i.startsWith('"')&&(i=i.slice(1)),i.endsWith('"')&&(i=i.slice(0,-1)),i=i.replace(/\\n/g,`
`),p(f=>f.map(h=>h.id===g?{...h,content:i,isStreaming:!1}:h))},E=async(r,g)=>{const l=L(),u=Date.now();console.log(`[前端-Agent] ⏱️ 开始发送请求: ${new Date().toISOString()}`);const c=await fetch(`${ve}/functions/v1/xiaoxiong-agent`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ce}`,apikey:ce},body:JSON.stringify({message:r.content,userId:l}),signal:D.current?.signal}),a=Date.now()-u;if(console.log(`[前端-Agent] ⏱️ 收到响应头: ${new Date().toISOString()}, 耗时: ${a}ms`),!c.ok)throw new Error(`Request failed with status: ${c.status}`);if(!c.body)throw new Error("No response body");const i=c.body.getReader(),f=new TextDecoder;let h="",H=!1,T=0;for(;;){const{done:W,value:$}=await i.read();if(W){console.log(`[前端-Agent] ⏱️ 流结束: ${new Date().toISOString()}, 总耗时: ${Date.now()-u}ms, 共 ${T} 个数据块`);break}T++;const te=f.decode($,{stream:!0});if(h+=te,!H){H=!0;const B=Date.now()-u;console.log(`[前端-Agent] ⏱️ 首个数据块 (TTFB): ${new Date().toISOString()}, 耗时: ${B}ms, 大小: ${te.length} 字符`)}Ze.flushSync(()=>{p(B=>B.map(Q=>Q.id===g?{...Q,content:h}:Q))}),await new Promise(B=>requestAnimationFrame(B))}p(W=>W.map($=>$.id===g?{...$,isStreaming:!1}:$))},G=async()=>{if(!d.trim()||N)return;const r={id:Date.now().toString(),role:"user",content:d.trim()},g=(Date.now()+1).toString(),l={id:g,role:"assistant",content:"",isStreaming:!0};p(u=>[...u,r,l]),C(""),_(!0),D.current&&D.current.abort(),D.current=new AbortController;try{v==="xiaoxiong-agent"?await E(r,g):await K(r,g)}catch(u){if(u instanceof Error&&u.name==="AbortError"){console.log("Request aborted");return}console.error("Ask API error:",u);const c=y.language==="zh"?"抱歉，暂时无法获取结果，请稍后再试":y.language==="pt"?"Desculpe, não foi possível obter resultados. Tente novamente mais tarde.":"Sorry, unable to get results. Please try again later.";p(a=>a.map(i=>i.id===g?{...i,content:c,isStreaming:!1}:i))}finally{_(!1)}},P=r=>{r.key==="Enter"&&!r.shiftKey&&(r.preventDefault(),G())},b=()=>{D.current&&D.current.abort(),n(!1)},j=r=>{b(),x(r)},S=r=>{const g=/\[([^\]]+)\]\(([^)]+)\)/g,l=[];let u=0,c,a=0;for(;(c=g.exec(r))!==null;){c.index>u&&l.push(e.jsx("span",{children:r.slice(u,c.index)},a++));const i=c[1],f=c[2];f.startsWith("/")?l.push(e.jsx("button",{onClick:()=>j(f),className:"text-primary hover:underline font-medium cursor-pointer",children:i},a++)):l.push(e.jsx("a",{href:f,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline font-medium",children:i},a++)),u=c.index+c[0].length}return u<r.length&&l.push(e.jsx("span",{children:r.slice(u)},a++)),l.length>0?l:[e.jsx("span",{children:r},"0")]},w=r=>r.replace(/\*\*(.*?)\*\*/g,"$1"),Y=(r,g=20)=>r.length<=g?r:r.slice(0,g)+"...",re=(r,g)=>{const l=a=>a.split("|").slice(1,-1).map(i=>w(i.trim())),u=l(r[0]),c=r.slice(2).map(l);return e.jsx("div",{className:"overflow-x-auto my-2 max-w-full",children:e.jsxs("table",{className:"w-full text-xs border border-border rounded-md overflow-hidden table-fixed",children:[e.jsx("thead",{className:"bg-muted/60",children:e.jsx("tr",{children:u.map((a,i)=>e.jsx("th",{className:"px-2 py-2 text-left font-semibold border-b border-border truncate max-w-[100px]",title:a,children:S(Y(a,15))},i))})}),e.jsx("tbody",{children:c.map((a,i)=>e.jsx("tr",{className:"border-b border-border last:border-0 hover:bg-muted/30 transition-colors",children:a.map((f,h)=>e.jsx("td",{className:"px-2 py-2 truncate max-w-[100px]",title:f,children:S(Y(f,18))},h))},i))})]})},g)},oe=r=>{const g=r.split(`
`),l=[];let u=0;for(;u<g.length;){const c=g[u];if(c.trim().startsWith("|")&&c.split("|").length>2){const a=[];for(;u<g.length&&g[u].trim().startsWith("|");)a.push(g[u]),u++;a.length>=2&&l.push(re(a,l.length));continue}if(c.startsWith("### "))l.push(e.jsx("h3",{className:"text-base font-semibold mt-3 mb-1",children:S(c.slice(4))},l.length));else if(c.startsWith("## "))l.push(e.jsx("h2",{className:"text-lg font-bold mt-4 mb-2",children:S(c.slice(3))},l.length));else if(c.startsWith("# "))l.push(e.jsx("h1",{className:"text-xl font-bold mt-4 mb-2",children:S(c.slice(2))},l.length));else if(c.includes("**")){const a=c.split(/\*\*(.*?)\*\*/g);l.push(e.jsx("p",{className:"mb-1 leading-relaxed",children:a.map((i,f)=>f%2===1?e.jsx("strong",{className:"font-semibold",children:S(i)},f):S(i))},l.length))}else c.startsWith("- ")||c.startsWith("* ")?l.push(e.jsx("li",{className:"ml-4 mb-0.5 list-disc",children:S(c.slice(2))},l.length)):/^\d+\.\s/.test(c)?l.push(e.jsx("li",{className:"ml-4 mb-0.5 list-decimal",children:S(c.replace(/^\d+\.\s/,""))},l.length)):c.match(/^[-*_]{3,}$/)?l.push(e.jsx("hr",{className:"my-3 border-border"},l.length)):c.trim()===""?l.push(e.jsx("div",{className:"h-1"},l.length)):l.push(e.jsx("p",{className:"mb-1 leading-relaxed",children:S(c)},l.length));u++}return l},Z=()=>y.language==="zh"?"小熊AI助手":y.language==="pt"?"Assistente IA Xiaoxiong":"Xiaoxiong AI Assistant",ee=()=>y.language==="zh"?"告诉小熊，你想吃什么...":y.language==="pt"?"Diga ao Xiaoxiong o que você quer comer...":"Tell Xiaoxiong what you want to eat...",ae=()=>y.language==="zh"?"你好，我是小熊，我来帮你推荐餐厅；比如：「我附近的寿司餐厅」":y.language==="pt"?"Olá, eu sou o Xiaoxiong, vou te ajudar a encontrar restaurantes; por exemplo: 「restaurantes de sushi perto de mim」":`Hi, I'm Xiaoxiong, I'll help you find restaurants; for example: "sushi restaurants near me"`;return e.jsx(De,{open:s,onOpenChange:b,children:e.jsxs(Ae,{className:"w-full h-full max-w-full max-h-full sm:max-w-lg sm:h-[70vh] sm:max-h-[70vh] sm:rounded-lg rounded-none flex flex-col p-0 gap-0 overflow-hidden",children:[e.jsx(Le,{className:"px-4 py-3 border-b shrink-0 bg-primary/5",children:e.jsxs(Ee,{className:"flex items-center gap-2 text-base",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:I,alt:"Logo",className:"w-6 h-6 object-contain"})}),Z()]})}),e.jsx(we,{className:"flex-1 h-0",ref:X,children:e.jsxs("div",{className:"p-4 space-y-4",children:[z.length===0&&e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center shrink-0",children:e.jsx(me,{className:"w-4 h-4 text-primary"})}),e.jsx("div",{className:"flex-1 bg-muted/50 rounded-2xl rounded-tl-sm px-4 py-3 text-sm",children:ae()})]}),z.map(r=>e.jsxs("div",{className:F("flex gap-3",r.role==="user"&&"flex-row-reverse"),children:[e.jsx("div",{className:F("w-8 h-8 rounded-full flex items-center justify-center shrink-0",r.role==="user"?"bg-primary text-primary-foreground":"bg-primary/10"),children:r.role==="user"?e.jsx(Me,{className:"h-4 w-4"}):e.jsx(me,{className:"h-4 w-4"})}),e.jsx("div",{className:F("flex-1 max-w-[85%] rounded-2xl px-4 py-3 text-sm",r.role==="user"?"bg-primary text-primary-foreground rounded-tr-sm":"bg-muted/50 rounded-tl-sm"),children:r.role==="assistant"?e.jsxs(e.Fragment,{children:[r.content?e.jsx("div",{className:"prose-sm",children:oe(r.content)}):e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(he,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:y.language==="zh"?"思考中...":y.language==="pt"?"Pensando...":"Thinking..."})]}),r.isStreaming&&r.content&&e.jsx("span",{className:"inline-block w-1.5 h-4 bg-primary/50 animate-pulse ml-0.5 align-middle"})]}):r.content})]},r.id)),e.jsx("div",{ref:J})]})}),e.jsx("div",{className:"p-3 border-t bg-background shrink-0",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ne,{value:d,onChange:r=>C(r.target.value),onKeyDown:P,placeholder:ee(),disabled:N,className:"flex-1 rounded-full bg-muted/50 border-0 focus-visible:ring-1",autoFocus:!0}),e.jsx(U,{onClick:G,disabled:!d.trim()||N,size:"icon",className:"shrink-0 rounded-full",children:N?e.jsx(he,{className:"h-4 w-4 animate-spin"}):e.jsx(Fe,{className:"h-4 w-4"})})]})})]})})},ye=({restaurant:s,language:n})=>{const[v,y]=o.useState(999),x=o.useRef(null),A=s.type.slice(0,3).map((d,C)=>({key:`type-${C}`,label:d,variant:"secondary",color:void 0}));o.useEffect(()=>{const d=()=>{if(!x.current)return;const z=x.current,p=Array.from(z.querySelectorAll(".tag-badge"));if(p.length===0){setTimeout(d,50);return}const N=p[0]?.offsetTop;let _=p.length;for(let R=0;R<p.length;R++)if(p[R].offsetTop>N){_=R;break}_<p.length&&(_=Math.max(1,_-1)),y(_)};y(999);const C=setTimeout(d,100);return window.addEventListener("resize",d),()=>{clearTimeout(C),window.removeEventListener("resize",d)}},[A.length,s.id]);const O=A.slice(0,v),I=A.length>v;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{ref:x,className:"flex gap-1.5 flex-wrap flex-1",children:O.map(d=>e.jsx(M,{variant:d.variant,className:"text-xs font-medium whitespace-nowrap tag-badge",style:d.color?{backgroundColor:d.color,color:"white"}:void 0,children:d.label},d.key))}),I&&e.jsxs(it,{children:[e.jsx(ct,{asChild:!0,children:e.jsx(U,{variant:"ghost",size:"sm",className:"h-6 px-2 text-muted-foreground hover:text-foreground flex-shrink-0",children:e.jsx(We,{className:"h-4 w-4"})})}),e.jsx(dt,{className:"w-80",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:A.map(d=>e.jsx(M,{variant:d.variant,className:"text-xs font-medium",style:d.color?{backgroundColor:d.color,color:"white"}:void 0,children:d.label},d.key))})})]})]})},Nt=()=>{const s=Se(),{t:n,i18n:v}=xe(),{toast:y}=Oe(),{localizeRestaurant:x}=gt(),[A,O]=o.useState(""),[I,d]=o.useState([]),[C,z]=o.useState(null),[p,N]=o.useState([]),[_,R]=o.useState(null),[k,D]=o.useState(null),[X,J]=o.useState(!1),[L,K]=o.useState(!1),[E,G]=o.useState(!1),P=o.useRef(null),b=o.useRef(null),j=o.useRef({}),[S,w]=o.useState(null),[Y,re]=o.useState(!1),[oe,Z]=o.useState(!1),[ee,ae]=o.useState(!1),[r,g]=o.useState(!1),l=4,{data:u,isLoading:c}=mt(A,I.length>0?I.join(","):void 0),{data:a=[]}=ut(),{data:i=[]}=ft(),{data:f={}}=xt(),h=i.filter(t=>(f[t.id]||0)>0),H=t=>{d(m=>m.includes(t)?m.filter(V=>V!==t):[...m,t])},T=()=>{Z(!0)},W=async()=>{Z(!1);try{const t=await st();D({lat:t.coords.latitude,lng:t.coords.longitude}),y({title:n("restaurants.locationEnabled"),description:n("restaurants.sortByDistance")})}catch(t){console.error("Location error:",t)}},$=t=>{R(t),t&&!k&&T()},te=async t=>{if(C===t)z(null),N([]);else{z(t);const{data:m,error:V}=await qe.from("activity_restaurants").select("restaurant_id").eq("activity_id",t);V?(console.error("Error fetching activity restaurants:",V),N([])):N(m.map(Ie=>Ie.restaurant_id))}},B=u?.map(t=>{const m=x(t);if(k){const V=tt(k.lat,k.lng,t.lat,t.lng);return{...m,distance:V}}return m})||[],Q=C?B.filter(t=>p.includes(t.id)):B,q=_&&k?Q.filter(t=>t.distance&&t.distance<=_).sort((t,m)=>(t.distance||0)-(m.distance||0)):k?Q.sort((t,m)=>(t.distance||0)-(m.distance||0)):Q.sort((t,m)=>(m.rating||0)-(t.rating||0)),ne=t=>{s(`/restaurant/${t.id}`)},se=t=>{w(t.id);const m=j.current[t.id];m&&m.scrollIntoView({behavior:"smooth",block:"center"})},de=()=>{const t=document.getElementById("home-map-container");if(t)if(X)document.exitFullscreen&&document.exitFullscreen();else{if(P.current){const m=P.current.getCenter(),V=P.current.getZoom();b.current={center:[m.lng,m.lat],zoom:V}}t.requestFullscreen&&t.requestFullscreen()}};return o.useEffect(()=>{const t=()=>{const m=!!document.fullscreenElement;J(m),!m&&b.current&&P.current&&setTimeout(()=>{P.current?.jumpTo({center:b.current.center,zoom:b.current.zoom})},100)};return document.addEventListener("fullscreenchange",t),()=>{document.removeEventListener("fullscreenchange",t)}},[]),e.jsxs("div",{className:"animate-fade-in",children:[e.jsxs("div",{className:"text-center mb-8 sm:mb-10",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-foreground mb-2 sm:mb-3",children:n("nav.mapView")}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground max-w-xl mx-auto px-4",children:n("map.subtitle")})]}),e.jsxs("div",{className:"mb-6 space-y-4 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[e.jsx("div",{className:"flex-1 max-w-md",children:e.jsx(Ne,{placeholder:n("restaurants.search"),value:A,onChange:t=>O(t.target.value),className:"h-11 bg-background/60 backdrop-blur-sm border-primary/20 focus:border-primary"})}),e.jsxs("div",{className:"flex gap-2 md:contents",children:[e.jsxs(U,{variant:k?"default":"outline",onClick:k?void 0:T,className:"flex-1 md:flex-initial gap-2 h-11 md:px-6",children:[e.jsx(le,{className:`w-4 h-4 ${k?"animate-pulse":""}`}),e.jsx("span",{className:"md:hidden",children:n("restaurants.getLocationMobile")}),e.jsx("span",{className:"hidden md:inline",children:n(k?"restaurants.locationEnabled":"restaurants.getLocation")})]}),e.jsxs(U,{variant:Y?"default":"outline",onClick:()=>re(!Y),className:"flex-1 md:flex-initial gap-2 h-11 md:px-6",children:[e.jsx(Pe,{className:"w-4 h-4"}),n("restaurants.filter")]})]})]}),Y&&e.jsxs("div",{className:"space-y-3 bg-card/50 backdrop-blur-sm rounded-lg p-4 border border-border/50 animate-fade-in",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("span",{className:"text-sm font-semibold text-foreground",children:[n("restaurants.restaurantTypes"),":"]}),I.length>0&&e.jsx(M,{variant:"outline",className:"cursor-pointer hover:bg-destructive hover:text-destructive-foreground hover:scale-105 transition-all duration-200 px-2 py-0 text-xs h-5",onClick:()=>d([]),children:n("common.actions.clearFilter")}),a.length>8&&e.jsx(U,{variant:"ghost",size:"sm",className:"h-5 px-2 text-xs text-primary hover:text-primary/80 ml-auto hidden sm:flex transition-all duration-200",onClick:()=>K(!L),children:n(L?"common.showLess":"common.showMore")})]}),e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx("div",{className:`hidden sm:flex gap-2 flex-wrap transition-all duration-300 ease-out ${L?"animate-expand-height":""}`,children:(L?a:a.slice(0,8)).map((t,m)=>e.jsx(M,{variant:I.includes(t)?"default":"secondary",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs whitespace-nowrap hover:scale-105 active:animate-tag-select ${I.includes(t)?"ring-2 ring-primary/30 shadow-sm":""}`,style:{animationDelay:`${m*30}ms`},onClick:()=>H(t),children:t},t))}),e.jsxs("div",{className:"sm:hidden relative -mx-1 px-1",children:[e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide snap-x snap-mandatory scroll-smooth",children:a.map((t,m)=>e.jsx(M,{variant:I.includes(t)?"default":"secondary",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs whitespace-nowrap flex-shrink-0 snap-start hover:scale-105 active:animate-tag-select ${I.includes(t)?"ring-2 ring-primary/30 shadow-sm":""}`,style:{animationDelay:`${m*30}ms`},onClick:()=>H(t),children:t},t))}),e.jsx("div",{className:"absolute left-0 top-0 bottom-2 w-4 bg-gradient-to-r from-card via-card/60 to-transparent pointer-events-none"}),e.jsx("div",{className:"absolute right-0 top-0 bottom-2 w-4 bg-gradient-to-l from-card via-card/60 to-transparent pointer-events-none"})]})]})]}),h.length>0&&e.jsxs("div",{className:"space-y-2 pt-1 border-t border-border/30",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("span",{className:"text-sm font-semibold text-foreground",children:[n("nav.activities"),":"]}),C&&e.jsx(M,{variant:"outline",className:"cursor-pointer hover:bg-destructive hover:text-destructive-foreground hover:scale-105 transition-all duration-200 px-2 py-0 text-xs h-5",onClick:()=>{z(null),N([])},children:n("common.actions.clearFilter")}),h.length>8&&e.jsx(U,{variant:"ghost",size:"sm",className:"h-5 px-2 text-xs text-primary hover:text-primary/80 ml-auto hidden sm:flex transition-all duration-200",onClick:()=>G(!E),children:n(E?"common.showLess":"common.showMore")})]}),e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx("div",{className:`hidden sm:flex gap-2 flex-wrap transition-all duration-300 ease-out ${E?"animate-expand-height":""}`,children:(E?h:h.slice(0,8)).map((t,m)=>{const V=v.language==="zh"?t.badge_text_zh||t.title_zh:v.language==="pt"?t.badge_text_pt||t.title_pt:t.badge_text_en||t.title_en;return e.jsx(M,{variant:C===t.id?"default":"secondary",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs whitespace-nowrap hover:scale-105 active:animate-tag-select ${C===t.id?"ring-2 ring-primary/30 shadow-sm":""}`,style:{animationDelay:`${m*30}ms`},onClick:()=>te(t.id),children:V},t.id)})}),e.jsxs("div",{className:"sm:hidden relative -mx-1 px-1",children:[e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide snap-x snap-mandatory scroll-smooth",children:h.map((t,m)=>{const V=v.language==="zh"?t.badge_text_zh||t.title_zh:v.language==="pt"?t.badge_text_pt||t.title_pt:t.badge_text_en||t.title_en;return e.jsx(M,{variant:C===t.id?"default":"secondary",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs whitespace-nowrap flex-shrink-0 snap-start hover:scale-105 active:animate-tag-select ${C===t.id?"ring-2 ring-primary/30 shadow-sm":""}`,style:{animationDelay:`${m*30}ms`},onClick:()=>te(t.id),children:V},t.id)})}),e.jsx("div",{className:"absolute left-0 top-0 bottom-2 w-4 bg-gradient-to-r from-card via-card/60 to-transparent pointer-events-none"}),e.jsx("div",{className:"absolute right-0 top-0 bottom-2 w-4 bg-gradient-to-l from-card via-card/60 to-transparent pointer-events-none"})]})]})]})]}),k&&e.jsxs("div",{className:"flex gap-2 flex-wrap items-center bg-muted/30 backdrop-blur-sm rounded-lg p-3 border border-primary/10",children:[e.jsxs("span",{className:"text-sm font-semibold text-primary",children:[n("restaurants.radius"),":"]}),e.jsx(M,{variant:_===null?"default":"secondary",className:"cursor-pointer hover:scale-105 transition-transform",onClick:()=>$(null),children:n("restaurants.allRestaurants")}),e.jsx(M,{variant:_===5?"default":"secondary",className:"cursor-pointer hover:scale-105 transition-transform",onClick:()=>$(5),children:n("restaurants.radius5km")}),e.jsx(M,{variant:_===10?"default":"secondary",className:"cursor-pointer hover:scale-105 transition-transform",onClick:()=>$(10),children:n("restaurants.radius10km")}),e.jsx(M,{variant:_===20?"default":"secondary",className:"cursor-pointer hover:scale-105 transition-transform",onClick:()=>$(20),children:n("restaurants.radius20km")})]})]}),!c&&q&&e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[e.jsx("div",{className:`w-full lg:flex-1 transition-all duration-300 ease-in-out ${ee?"h-0 overflow-hidden lg:h-[500px]":"h-[400px] lg:h-[500px]"}`,children:e.jsxs("div",{id:"home-map-container",className:`${X?"fixed inset-0 z-50 bg-background":"w-full h-full"} rounded-xl overflow-hidden shadow-2xl border border-primary/10 relative group`,children:[e.jsx(U,{variant:"secondary",size:"icon",className:"absolute bottom-4 right-4 z-10 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity",onClick:de,children:X?e.jsx(Be,{className:"w-5 h-5"}):e.jsx(Ve,{className:"w-5 h-5"})}),e.jsxs("div",{className:"h-full relative",children:[e.jsx(ht,{restaurants:q,onRestaurantClick:ne,userLocation:k,radiusFilter:_,onMarkerClick:se,showViewDetailsButton:!0,onMapInit:t=>{P.current=t}}),e.jsxs("div",{className:"absolute bottom-4 left-4 z-10 pointer-events-none flex items-center gap-2 bg-background/80 backdrop-blur-sm px-3 py-2 rounded-full shadow-lg",children:[e.jsx("img",{src:pt,alt:"Xiaoxiong Market Logo",className:"h-6 w-6 object-contain"}),e.jsx("span",{className:"text-sm font-semibold text-foreground whitespace-nowrap",children:v.language==="zh"?"小熊市场":"Xiaoxiong Market"})]})]})]})}),e.jsx(U,{variant:"outline",size:"sm",className:"lg:hidden flex items-center justify-center gap-2 -mt-3 mb-1",onClick:()=>ae(!ee),children:ee?e.jsxs(e.Fragment,{children:[e.jsx(pe,{className:"w-4 h-4"}),n("map.showMap")]}):e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"w-4 h-4"}),n("map.hideMap")]})}),e.jsxs("div",{className:"w-full lg:w-[420px] flex flex-col",children:[e.jsxs("div",{className:"mb-4 pb-4 border-b border-border",children:[e.jsxs("h2",{className:"text-2xl font-bold text-foreground flex items-center gap-2",children:[e.jsx(ie,{className:"w-6 h-6 text-primary"}),n("restaurants.title"),e.jsx(M,{variant:"secondary",className:"ml-2",children:q.length})]}),k&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-2 flex items-center gap-1.5",children:[e.jsx(le,{className:"w-4 h-4"}),n("restaurants.sortedByDistance")]})]}),q.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(ie,{className:"w-16 h-16 text-muted-foreground/40 mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-foreground mb-2",children:n("restaurants.noResults")}),e.jsx("p",{className:"text-muted-foreground max-w-xs",children:n("restaurants.noResultsDesc")})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"lg:hidden space-y-3 pb-4",children:[(r?q:q.slice(0,l)).map(t=>e.jsx(fe,{ref:m=>j.current[t.id]=m,className:`p-5 cursor-pointer hover:shadow-xl transition-all duration-300 hover:scale-[1.02] hover:border-primary/40 border-2 bg-gradient-to-br from-card to-card/50 backdrop-blur-sm ${S===t.id?"border-primary ring-2 ring-primary ring-offset-2":"border-transparent"}`,onClick:()=>ne(t),children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h3",{className:"font-bold text-lg text-foreground line-clamp-1 flex-1",children:t.name}),t.distance!==void 0&&e.jsxs("div",{className:"flex items-center gap-1.5 bg-primary/10 px-2.5 py-1 rounded-full w-fit",children:[e.jsx(le,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"font-bold text-sm text-primary",children:t.distance<1?`${(t.distance*1e3).toFixed(0)} m`:`${t.distance.toFixed(1)} km`})]})]}),t.rating>0&&e.jsxs("div",{className:"flex items-center gap-1.5 bg-primary/10 px-2.5 py-1 rounded-full flex-shrink-0",children:[e.jsx(be,{className:"w-4 h-4",style:{fill:"#016450",color:"#016450"}}),e.jsx("span",{className:"font-bold text-sm text-primary",children:t.rating})]})]}),t.type&&t.type.length>0&&e.jsx(ye,{restaurant:t,language:v.language}),e.jsxs("div",{className:"flex items-start gap-2 text-sm text-muted-foreground",children:[e.jsx(ie,{className:"w-4 h-4 mt-0.5 flex-shrink-0 text-primary/60"}),e.jsx("span",{className:"line-clamp-2",children:t.address})]})]})},t.id)),q.length>l&&e.jsx(U,{variant:"outline",className:"w-full mt-2 gap-2",onClick:()=>g(!r),children:r?e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"w-4 h-4"}),n("map.collapseList")]}):e.jsxs(e.Fragment,{children:[e.jsx(pe,{className:"w-4 h-4"}),n("map.showAllRestaurants",{count:q.length})]})})]}),e.jsx(we,{className:"hidden lg:block h-[420px] pr-4",children:e.jsx("div",{className:"space-y-3 pb-4",children:q.map(t=>e.jsx(fe,{ref:m=>j.current[t.id]=m,className:`p-5 cursor-pointer hover:shadow-xl transition-all duration-300 hover:scale-[1.02] hover:border-primary/40 border-2 bg-gradient-to-br from-card to-card/50 backdrop-blur-sm ${S===t.id?"border-primary ring-2 ring-primary ring-offset-2":"border-transparent"}`,onClick:()=>ne(t),children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h3",{className:"font-bold text-lg text-foreground line-clamp-1 flex-1",children:t.name}),t.distance!==void 0&&e.jsxs("div",{className:"flex items-center gap-1.5 bg-primary/10 px-2.5 py-1 rounded-full w-fit",children:[e.jsx(le,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"font-bold text-sm text-primary",children:t.distance<1?`${(t.distance*1e3).toFixed(0)} m`:`${t.distance.toFixed(1)} km`})]})]}),t.rating>0&&e.jsxs("div",{className:"flex items-center gap-1.5 bg-primary/10 px-2.5 py-1 rounded-full flex-shrink-0",children:[e.jsx(be,{className:"w-4 h-4",style:{fill:"#016450",color:"#016450"}}),e.jsx("span",{className:"font-bold text-sm text-primary",children:t.rating})]})]}),t.type&&t.type.length>0&&e.jsx(ye,{restaurant:t,language:v.language}),e.jsxs("div",{className:"flex items-start gap-2 text-sm text-muted-foreground",children:[e.jsx(ie,{className:"w-4 h-4 mt-0.5 flex-shrink-0 text-primary/60"}),e.jsx("span",{className:"line-clamp-2",children:t.address})]})]})},t.id))})})]})]})]}),e.jsx(bt,{open:oe,onOpenChange:Z,onConfirm:W})]})},ue="/images/sushi-ramen-hero.jpg",Ce="/images/sushi-ramen-mobile.jpg",Re=o.memo(({stats:s,t:n})=>e.jsx("div",{className:"absolute top-16 sm:top-20 left-3 z-20",children:e.jsxs("div",{className:"gap-4 w-fit flex-col flex items-start justify-start",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xe,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm text-white/90 drop-shadow-md",children:n("home.stats.delivery")}),e.jsx("span",{className:"font-bold text-white text-sm drop-shadow-md",children:s.order_count})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(He,{className:"w-4 h-4 text-accent"}),e.jsx("span",{className:"text-sm text-white/90 drop-shadow-md",children:n("home.stats.reservation")}),e.jsx("span",{className:"font-bold text-white text-sm drop-shadow-md",children:s.reserve_count})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl sm:text-2xl font-bold text-white drop-shadow-md",children:n("home.hero.brandName")}),e.jsx("img",{src:at,alt:"map icon",width:32,height:32,loading:"eager",decoding:"async",className:"w-7 sm:w-8 h-7 sm:h-8 object-contain flex-shrink-0"})]})]})}));Re.displayName="StatsDisplay";const kt=()=>{const s=window.innerWidth<640,n=window.innerWidth>=1024,v=navigator.connection,y=_e(),x=ke();return n?!!v?.saveData:!!(x&&!y||v&&(v.saveData||v.effectiveType==="2g"||v.effectiveType==="slow-2g")||s&&navigator.deviceMemory&&navigator.deviceMemory<2)},Te=o.memo(({template:s,isActive:n,currentLang:v,t:y,onContentReady:x,onAskXiaoxiong:A})=>{const[O,I]=o.useState({}),[d,C]=o.useState({}),[z,p]=o.useState({}),[N,_]=o.useState({mobile:!0,tablet:!0,desktop:!0}),[R,k]=o.useState(!1),D=kt(),X=o.useRef(null),J=o.useRef(null),L=o.useRef(null),K=a=>s[`${a}${v==="zh"?"_zh":v==="pt"?"_pt":"_en"}`]||"",E=()=>window.innerWidth<640?"mobile":window.innerWidth<1024?"tablet":"desktop",G=()=>{const a=E();return a==="mobile"&&s.mobile_overlay_opacity!==null?s.mobile_overlay_opacity:a==="tablet"&&s.tablet_overlay_opacity!==null?s.tablet_overlay_opacity:a==="desktop"&&s.desktop_overlay_opacity!==null?s.desktop_overlay_opacity:s.overlay_opacity??30},P=()=>{const a=G(),i=s.overlay_gradient_direction||"to-b",f=(se,de)=>se==null?de/100:se>1?se/100:se,h=a>1?a/100:a,H=f(s.overlay_gradient_from_opacity,30)*h,T=f(s.overlay_gradient_via_opacity,25)*h,W=f(s.overlay_gradient_to_opacity,40)*h,te={"to-t":"to top","to-b":"to bottom","to-l":"to left","to-r":"to right","to-tl":"to top left","to-tr":"to top right","to-bl":"to bottom left","to-br":"to bottom right"}[i]||"to bottom",B={black:"0, 0, 0",white:"255, 255, 255",background:"0, 0, 0",foreground:"255, 255, 255",primary:"1, 100, 80",secondary:"240, 240, 240"},Q=B[s.overlay_gradient_from||"black"]||"0, 0, 0",q=B[s.overlay_gradient_via||"black"]||"0, 0, 0",ne=B[s.overlay_gradient_to||"black"]||"0, 0, 0";return{background:`linear-gradient(${te}, rgba(${Q}, ${H}), rgba(${q}, ${T}), rgba(${ne}, ${W}))`}},b=s.mobile_image_url||Ce,j=s.tablet_image_url||s.desktop_image_url||ue,S=s.desktop_image_url||ue,w=s.background_blur||0,Y=s.desktop_media_type||s.media_type||"image",re=s.tablet_media_type||s.media_type||"image",oe=s.mobile_media_type||s.media_type||"image",Z=Y==="video"&&!D,ee=re==="video"&&!D,ae=oe==="video"&&!D,r=ae?s.mobile_video_url:null,g=ee?s.tablet_video_url||s.desktop_video_url:null,l=Z?s.desktop_video_url:null;o.useEffect(()=>{const a=E(),i=a==="mobile"?b:a==="tablet"?j:S;if(i){const f=new Image;f.onload=()=>{I(h=>({...h,[a]:!0})),_(h=>({...h,[a]:!0})),n&&(x?.(),setTimeout(()=>k(!0),100))},f.src=i}},[b,j,S,n,x]),o.useEffect(()=>{n&&O[E()]&&k(!0)},[n,O]);const u=a=>{C(i=>({...i,[a]:!0}))},c=(a,i)=>{console.error(`[HeroSlide] Video error on ${a}:`,i),p(f=>({...f,[a]:!0}))};return o.useEffect(()=>{if(!R||!n||!Ye())return;const i=E(),h=(i==="mobile"?X:i==="tablet"?J:L).current;if(!h)return;const T=setTimeout(async()=>{try{h.muted=!0,h.playsInline=!0,h.setAttribute("webkit-playsinline","true"),await h.play(),console.log(`[HeroSlide] iOS video play successful on ${i}`)}catch(W){console.error(`[HeroSlide] iOS video play failed on ${i}:`,W),p($=>({...$,[i]:!0}))}},150);return()=>clearTimeout(T)},[R,n]),e.jsxs("div",{className:F("absolute inset-0 w-full h-full transition-opacity duration-1000",n?"opacity-100 z-10":"opacity-0 z-0"),children:[e.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[e.jsxs("div",{className:"absolute inset-0 w-full h-full sm:hidden",children:[!N.mobile&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),ae&&r?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:b,alt:"Background",className:F("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",d.mobile&&!z.mobile?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:w>0?`blur(${w}px)`:void 0}}),R&&!z.mobile&&e.jsx("video",{ref:X,src:r,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>u("mobile"),onError:a=>c("mobile",a),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:w>0?`blur(${w}px)`:void 0}})]}):e.jsx("img",{src:b,alt:"Background",className:F("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",N.mobile?"opacity-100":"opacity-0"),style:{filter:w>0?`blur(${w}px)`:void 0}})]}),e.jsxs("div",{className:"absolute inset-0 w-full h-full hidden sm:block lg:hidden",children:[!N.tablet&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),ee&&g?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:j,alt:"Background",className:F("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",d.tablet&&!z.tablet?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:w>0?`blur(${w}px)`:void 0}}),R&&!z.tablet&&e.jsx("video",{ref:J,src:g,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>u("tablet"),onError:a=>c("tablet",a),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:w>0?`blur(${w}px)`:void 0}})]}):e.jsx("img",{src:j,alt:"Background",className:F("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",N.tablet?"opacity-100":"opacity-0"),style:{filter:w>0?`blur(${w}px)`:void 0}})]}),e.jsxs("div",{className:"absolute inset-0 w-full h-full hidden lg:block",children:[!N.desktop&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),Z&&l?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:S,alt:"Background",className:F("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",d.desktop&&!z.desktop?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:w>0?`blur(${w}px)`:void 0}}),R&&!z.desktop&&e.jsx("video",{ref:L,src:l,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>u("desktop"),onError:a=>c("desktop",a),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:w>0?`blur(${w}px)`:void 0}})]}):e.jsx("img",{src:S,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:F("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",N.desktop?"opacity-100":"opacity-0"),style:{filter:w>0?`blur(${w}px)`:void 0}})]}),e.jsx("div",{className:"absolute inset-0 w-full h-full",style:P()})]}),e.jsx("div",{className:"relative z-10 container mx-auto px-4 sm:px-6 flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center space-y-4 sm:space-y-8 animate-fade-in w-full",children:[e.jsx("h1",{className:"text-3xl sm:text-5xl md:text-7xl font-bold text-white leading-tight px-4 drop-shadow-[0_2px_8px_rgba(0,0,0,0.8)]",children:K("title")||y("home.hero.title")}),e.jsx("p",{className:"text-sm sm:text-xl md:text-2xl text-white/95 max-w-2xl mx-auto px-4 drop-shadow-[0_2px_6px_rgba(0,0,0,0.7)]",children:K("description")||y("home.hero.description")}),s.subtitle_button_text_zh&&e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:A,className:"group flex items-center gap-3 bg-white/95 backdrop-blur-sm text-muted-foreground px-4 sm:px-6 py-3 sm:py-4 rounded-full shadow-lg hover:shadow-2xl hover:bg-white transition-all duration-300 cursor-text border border-border/20",children:[e.jsx(me,{className:"w-5 h-5 text-primary/70 group-hover:text-primary transition-colors"}),e.jsx("span",{className:"text-sm sm:text-base text-muted-foreground/80 group-hover:text-muted-foreground transition-colors",children:K("subtitle_button_text")||y("home.hero.subtitle")}),e.jsx(Ue,{className:"w-4 h-4 text-muted-foreground/50 ml-2"})]})})]})})]})});Te.displayName="HeroSlide";const qt=()=>{const{t:s,i18n:n}=xe(),v=lt(),{settings:y}=je(),{data:x,isLoading:A,refetch:O}=rt(),[I,d]=o.useState(0),[C,z]=o.useState(null),p=o.useRef(null),[N,_]=o.useState(!1),[R,k]=o.useState(!1),D=y?.ai_assistant_enabled!==!1,X=y?.ai_provider||"ask-xiaoxiong",J=o.useCallback(()=>{_(!0)},[]);ot({pageType:"home"});const L=o.useCallback(async()=>{try{const j=await(await fetch("https://v.xiaoxiong.pt/api/get_info")).json();j&&z({order_count:j.order_count||0,reserve_count:j.reserve_count||0})}catch(b){console.error("Failed to fetch stats:",b)}},[]);o.useEffect(()=>{L()},[L]);const K=o.useCallback(async()=>{await Promise.all([O(),L(),v.invalidateQueries({queryKey:["restaurants"]}),v.invalidateQueries({queryKey:["activities"]})])},[O,L,v]);o.useEffect(()=>{if(!x||x.length<=1)return;const j=x[I]?.duration||5e3;return p.current=setTimeout(()=>{d(S=>(S+1)%x.length)},j),()=>{p.current&&clearTimeout(p.current)}},[x,I]);const E=o.useCallback(b=>{p.current&&clearTimeout(p.current),d(b)},[]);o.useCallback(()=>{x&&(p.current&&clearTimeout(p.current),d(b=>(b-1+x.length)%x.length))},[x]),o.useCallback(()=>{x&&(p.current&&clearTimeout(p.current),d(b=>(b+1)%x.length))},[x]);const G=n.language,P=x&&x.length>1;return e.jsx(nt,{onRefresh:K,children:e.jsxs("div",{className:"min-h-screen",children:[e.jsxs("section",{className:"relative h-screen flex items-start overflow-hidden bg-background",children:[C&&e.jsx(Re,{stats:C,t:s}),e.jsx("div",{className:F("absolute inset-0 w-full h-full transition-opacity duration-500",N?"opacity-100":"opacity-0"),children:x?.map((b,j)=>e.jsx(Te,{template:b,isActive:j===I,currentLang:G,t:s,onContentReady:j===0?J:void 0,onAskXiaoxiong:()=>k(!0)},b.id))}),e.jsx("div",{className:F("absolute inset-0 w-full h-full z-20 transition-opacity duration-500",A||!N?"opacity-100":"opacity-0 pointer-events-none"),children:e.jsx(Je,{})}),!A&&(!x||x.length===0)&&e.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[e.jsx("img",{src:Ce,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:"absolute inset-0 w-full h-full object-cover object-center sm:hidden"}),e.jsx("img",{src:ue,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:"absolute inset-0 w-full h-full object-cover object-center hidden sm:block"}),e.jsx("div",{className:"absolute inset-0 w-full h-full bg-gradient-to-b from-black/30 via-black/25 to-black/40"}),e.jsx("div",{className:"relative z-10 container mx-auto px-4 sm:px-6 flex items-center min-h-screen",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center space-y-4 sm:space-y-8 animate-fade-in w-full",children:[e.jsx("h1",{className:"text-3xl sm:text-5xl md:text-7xl font-bold text-white leading-tight px-4 drop-shadow-[0_2px_8px_rgba(0,0,0,0.8)]",children:s("home.hero.title")}),e.jsx("p",{className:"text-sm sm:text-xl md:text-2xl text-white/95 max-w-2xl mx-auto px-4 drop-shadow-[0_2px_6px_rgba(0,0,0,0.7)]",children:s("home.hero.description")})]})})]}),P&&e.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 z-30 flex gap-2",children:x.map((b,j)=>e.jsx("button",{onClick:()=>E(j),className:F("w-3 h-3 rounded-full transition-all duration-300",j===I?"bg-white w-8":"bg-white/50 hover:bg-white/70"),"aria-label":`Go to slide ${j+1}`},j))})]}),e.jsx("section",{className:"py-12 sm:py-20 px-4 bg-secondary/20",children:e.jsx("div",{className:"container mx-auto max-w-7xl",children:e.jsx(Nt,{})})}),!ke()&&!_e()&&e.jsxs("section",{className:"py-16 sm:py-24 px-4 bg-gradient-to-br from-primary/5 via-background to-primary/10 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-1/4 w-72 h-72 bg-primary/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 right-1/4 w-96 h-96 bg-primary/5 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute top-1/2 left-0 w-32 h-32 bg-primary/20 rounded-full blur-2xl -translate-y-1/2"}),e.jsx("div",{className:"absolute top-1/2 right-0 w-32 h-32 bg-primary/20 rounded-full blur-2xl -translate-y-1/2"}),e.jsx("div",{className:"container mx-auto max-w-5xl relative z-10",children:e.jsx("div",{className:"flex flex-col items-center justify-center gap-8",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-primary/10 text-primary text-sm font-medium px-4 py-2 rounded-full mb-4",children:[e.jsx(Ke,{className:"w-4 h-4"}),e.jsx("span",{children:"Mobile App"})]}),e.jsx("h3",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-foreground mb-4",children:s("home.app.title")}),e.jsx("p",{className:"text-base sm:text-lg text-muted-foreground mb-8 leading-relaxed",children:s("home.app.description")}),e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[e.jsxs("a",{href:"https://apps.apple.com/cn/app/xiaoxiong/id6755481369",target:"_blank",rel:"noopener noreferrer",className:"relative group",children:[e.jsx("div",{className:"absolute -inset-2 bg-gradient-to-r from-primary via-primary-glow to-primary rounded-2xl blur-lg opacity-40 group-hover:opacity-70 transition-opacity"}),e.jsx("div",{className:"relative bg-black hover:bg-gray-900 h-[52px] sm:h-[56px] w-[160px] sm:w-[180px] rounded-xl transition-all hover:scale-105 shadow-2xl hover:shadow-primary/30 border border-white/10 flex items-center justify-center",children:e.jsx("img",{src:yt,alt:"Download on the App Store",className:"h-8 sm:h-9"})})]}),e.jsxs("a",{href:"https://play.google.com/store/apps/details?id=com.xiaoxiong.market",target:"_blank",rel:"noopener noreferrer",className:"relative group",children:[e.jsx("div",{className:"absolute -inset-2 bg-gradient-to-r from-primary via-primary-glow to-primary rounded-2xl blur-lg opacity-40 group-hover:opacity-70 transition-opacity"}),e.jsx("div",{className:"relative bg-black hover:bg-gray-900 h-[52px] sm:h-[56px] w-[160px] sm:w-[180px] rounded-xl transition-all hover:scale-105 shadow-2xl hover:shadow-primary/30 border border-white/10 flex items-center justify-center",children:e.jsx("img",{src:vt,alt:"Get it on Google Play",className:"h-12 sm:h-14"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Qe,{className:"w-4 h-4 animate-bounce"}),e.jsx("span",{children:s("home.app.downloadNow")})]})]})]})})})]}),e.jsxs("section",{className:"py-16 sm:py-20 px-4 bg-gradient-to-br from-primary via-primary-glow to-primary-light relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-grid-pattern opacity-10"}),e.jsx("div",{className:"absolute top-0 right-0 w-64 sm:w-96 h-64 sm:h-96 bg-white/5 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-64 sm:w-96 h-64 sm:h-96 bg-white/5 rounded-full blur-3xl"}),e.jsxs("div",{className:"container mx-auto max-w-4xl text-center relative z-10",children:[e.jsx("h2",{className:"text-3xl sm:text-4xl md:text-5xl font-bold text-primary-foreground mb-4 sm:mb-6 px-4",children:s("home.cta.title")}),e.jsx("p",{className:"text-base sm:text-xl text-primary-foreground/90 mb-6 sm:mb-8 max-w-2xl mx-auto px-4",children:s("home.cta.description")}),e.jsx("div",{className:"flex justify-center",children:e.jsx(U,{size:"lg",variant:"secondary",asChild:!0,className:"text-base sm:text-lg shadow-xl hover:shadow-2xl",children:e.jsxs(et,{to:"/join-us",children:[e.jsx(Ge,{className:"mr-2 w-4 sm:w-5 h-4 sm:h-5"}),s("home.cta.button")]})})})]})]}),D&&e.jsx(wt,{open:R,onOpenChange:k,provider:X})]})})};export{qt as default};
//# sourceMappingURL=Home-h4AUeu0q.js.map
