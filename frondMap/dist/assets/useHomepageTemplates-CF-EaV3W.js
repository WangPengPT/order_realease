import{r as d,s as o,y as a}from"./index-BcrfGQEh.js";import{a as p,u as l,b as c}from"./vendor-query-BlSVl3IQ.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y=d("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),f=()=>p({queryKey:["homepage-templates"],queryFn:async()=>{const{data:e,error:r}=await o.from("homepage_templates").select("*").order("sort_order",{ascending:!0});if(r)throw r;return e},staleTime:1e3*60*5,gcTime:1e3*60*30}),w=()=>p({queryKey:["homepage-templates","active"],queryFn:async()=>{const{data:e,error:r}=await o.from("homepage_templates").select("*").eq("is_active",!0).order("sort_order",{ascending:!0});if(r)throw r;return e},staleTime:1e3*60*5,gcTime:1e3*60*30}),q=()=>{const e=l();return c({mutationFn:async r=>{const{data:t,error:s}=await o.from("homepage_templates").insert(r).select().single();if(s)throw s;return t},onSuccess:()=>{e.invalidateQueries({queryKey:["homepage-templates"]}),a.success("模板创建成功")},onError:r=>{console.error("Failed to create template:",r),a.error("创建失败")}})},F=()=>{const e=l();return c({mutationFn:async({id:r,...t})=>{const{data:s,error:i}=await o.from("homepage_templates").update(t).eq("id",r).select().single();if(i)throw i;return s},onSuccess:()=>{e.invalidateQueries({queryKey:["homepage-templates"]}),a.success("模板更新成功")},onError:r=>{console.error("Failed to update template:",r),a.error("更新失败")}})},T=()=>{const e=l();return c({mutationFn:async r=>{const{error:t}=await o.from("homepage_templates").delete().eq("id",r);if(t)throw t},onSuccess:()=>{e.invalidateQueries({queryKey:["homepage-templates"]}),a.success("模板删除成功")},onError:r=>{console.error("Failed to delete template:",r),a.error("删除失败")}})},$=()=>c({mutationFn:async({file:e,type:r,templateId:t})=>{const s=e.name.split(".").pop(),n=`template-${t}-${r}-${Date.now()}.${s}`,{error:u}=await o.storage.from("homepage-images").upload(n,e,{upsert:!0});if(u)throw u;const{data:{publicUrl:m}}=o.storage.from("homepage-images").getPublicUrl(n);return{type:r,url:m}},onSuccess:({type:e})=>{a.success(`${e}图片上传成功`)},onError:e=>{console.error("Failed to upload image:",e),a.error("图片上传失败")}}),v=()=>c({mutationFn:async({file:e,type:r,templateId:t})=>{const s=e.name.split(".").pop(),n=`template-${t}-${r}-video-${Date.now()}.${s}`,{error:u}=await o.storage.from("homepage-images").upload(n,e,{upsert:!0});if(u)throw u;const{data:{publicUrl:m}}=o.storage.from("homepage-images").getPublicUrl(n);return{type:r,url:m}},onSuccess:({type:e})=>{a.success(`${e}视频上传成功`)},onError:e=>{console.error("Failed to upload video:",e),a.error("视频上传失败")}});export{y as S,f as a,q as b,F as c,T as d,$ as e,v as f,w as u};
//# sourceMappingURL=useHomepageTemplates-CF-EaV3W.js.map
