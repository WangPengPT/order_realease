import{p as Ie,r as S,s as L,j as e,a_ as se,c7 as Le,aW as q,aX as M,cz as qe,cq as ae,cA as F,cB as Fe,cC as te,cD as re,cE as de,cF as P,cH as ne,c_ as Pe,c$ as $e,d0 as He,cI as Ke,cJ as ie,bQ as le,am as B,y as ce,M as Ee,bc as ze,bb as $,c2 as Ue,bX as Ve,e0 as We,al as Xe}from"./vendor-react-BSvuipka.js";import{a2 as Qe,a3 as Ye,a4 as Ge,a5 as Je,a6 as _,h as R,g as H,C as x,m as h,E as j,n as u,S as p,$ as I,F as K,B as m,D as me,c as oe,d as xe,e as he,T as Ze,s as E}from"./index-Cu2A95Qe.js";import{T as je,a as ue,b as T,c,d as pe,e as n}from"./table-D9b4-MW1.js";import{T as es,a as ss,b as z,c as U}from"./tabs-BEusYc7V.js";import{P as fe,a as ge,b as Ne}from"./popover-CKKt4HJD.js";import{C as ye}from"./calendar-BuZ_lgjd.js";import{X as ve,D as k,Y as g,f as D,s as O}from"./vendor-utils-vwQGbBim.js";import"./vendor-i18n-jtdHZIRR.js";import"./vendor-editor-B1vH4T8i.js";import"./vendor-supabase-CH4YygDL.js";const be=["hsl(var(--primary))","hsl(var(--chart-2))","hsl(var(--chart-3))","hsl(var(--chart-4))","hsl(var(--chart-5))"],hs=()=>{const{t}=Ie(),[we,Se]=S.useState("overview"),[v,_e]=S.useState("all"),[b,De]=S.useState(void 0),[w,Ce]=S.useState(void 0),[s,V]=S.useState(null),[i,W]=S.useState(null),Te=()=>{const a=new Date;switch(v){case"today":return{start:D(a),end:g(a)};case"7days":return{start:D(O(a,6)),end:g(a)};case"30days":return{start:D(O(a,29)),end:g(a)};case"90days":return{start:D(O(a,89)),end:g(a)};case"180days":return{start:D(O(a,179)),end:g(a)};case"all":return{start:new Date(2020,0,1),end:g(a)};case"custom":return{start:b?D(b):D(O(a,29)),end:w?g(w):g(a)};default:return{start:new Date(2020,0,1),end:g(a)}}},{data:X,isLoading:ke,refetch:Ae}=L({queryKey:["external-stats-info"],queryFn:async()=>{const{data:a,error:r}=await E.functions.invoke("external-stats-api",{body:{action:"get_info"}});if(r)throw r;return a},refetchInterval:3e3}),{data:Q,isLoading:Y,refetch:Re}=L({queryKey:["external-orders-data"],queryFn:async()=>{const{data:a,error:r}=await E.functions.invoke("external-stats-api",{body:{action:"query_data",table:"order",query:{name:{$regex:"^T"}},count:1e4}});if(r)throw r;return Array.isArray(a)?a:[]},refetchInterval:3e3}),{data:G,isLoading:J,refetch:Oe}=L({queryKey:["external-reserves-data"],queryFn:async()=>{const{data:a,error:r}=await E.functions.invoke("external-stats-api",{body:{action:"query_data",table:"reserve",count:1e4}});if(r)throw r;return Array.isArray(a)?a:[]},refetchInterval:3e3}),{filteredOrders:f,filteredReserves:N}=S.useMemo(()=>{const{start:a,end:r}=Te(),C=(Q?.filter(d=>{if(!d.created_at)return!1;const l=new Date(d.created_at);return ve(l,{start:a,end:r})})||[]).sort((d,l)=>{const y=d.created_at?new Date(d.created_at).getTime():0;return(l.created_at?new Date(l.created_at).getTime():0)-y}),A=(G?.filter(d=>{const l=d.creationDate||d.created_at||d.date;if(!l)return!1;const y=new Date(l);return ve(y,{start:a,end:r})})||[]).sort((d,l)=>{const y=d.creationDate?new Date(d.creationDate).getTime():0;return(l.creationDate?new Date(l.creationDate).getTime():0)-y});return{filteredOrders:C,filteredReserves:A}},[Q,G,v,b,w]),Me=()=>{Ae(),Re(),Oe()},o=ke||Y||J,Z=(()=>{const a={},r={};f.forEach(d=>{const l=d.created_at?k(new Date(d.created_at),"MM-dd"):"Unknown";a[l]=(a[l]||0)+1}),N.forEach(d=>{const l=d.created_at||d.date,y=l?k(new Date(l),"MM-dd"):"Unknown";r[y]=(r[y]||0)+1});const C=[...new Set([...Object.keys(a),...Object.keys(r)])].sort(),A=v==="today"?1:v==="7days"?7:v==="30days"?14:30;return C.slice(-A).map(d=>({date:d,orders:a[d]||0,reserves:r[d]||0}))})(),ee=[{name:t("admin.orderStats.orders","外卖订单"),value:f.length},{name:t("admin.orderStats.reserves","订台预约"),value:N.length}];return e.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:t("admin.orderStats.title","外卖订台统计")}),e.jsx("p",{className:"text-muted-foreground",children:t("admin.orderStats.description","查看外卖订单和订台预约数据")})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Qe,{value:v,onValueChange:a=>_e(a),children:[e.jsx(Ye,{className:"w-[140px]",children:e.jsx(Ge,{})}),e.jsxs(Je,{children:[e.jsx(_,{value:"all",children:t("admin.orderStats.allTime","全部")}),e.jsx(_,{value:"today",children:t("admin.orderStats.today","今天")}),e.jsx(_,{value:"7days",children:t("admin.orderStats.last7Days","最近7天")}),e.jsx(_,{value:"30days",children:t("admin.orderStats.last30Days","最近30天")}),e.jsx(_,{value:"90days",children:t("admin.orderStats.last90Days","最近90天")}),e.jsx(_,{value:"180days",children:t("admin.orderStats.last180Days","最近半年")}),e.jsx(_,{value:"custom",children:t("admin.orderStats.customRange","自定义")})]})]}),v==="custom"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(fe,{children:[e.jsx(ge,{asChild:!0,children:e.jsxs(R,{variant:"outline",className:H("w-[130px] justify-start text-left font-normal",!b&&"text-muted-foreground"),children:[e.jsx(se,{className:"mr-2 h-4 w-4"}),b?k(b,"yyyy-MM-dd"):t("admin.orderStats.startDate","开始日期")]})}),e.jsx(Ne,{className:"w-auto p-0",align:"start",children:e.jsx(ye,{mode:"single",selected:b,onSelect:De,initialFocus:!0})})]}),e.jsx("span",{className:"text-muted-foreground",children:"-"}),e.jsxs(fe,{children:[e.jsx(ge,{asChild:!0,children:e.jsxs(R,{variant:"outline",className:H("w-[130px] justify-start text-left font-normal",!w&&"text-muted-foreground"),children:[e.jsx(se,{className:"mr-2 h-4 w-4"}),w?k(w,"yyyy-MM-dd"):t("admin.orderStats.endDate","结束日期")]})}),e.jsx(Ne,{className:"w-auto p-0",align:"start",children:e.jsx(ye,{mode:"single",selected:w,onSelect:Ce,initialFocus:!0})})]})]}),e.jsxs(R,{onClick:Me,variant:"outline",disabled:o,children:[e.jsx(Le,{className:`h-4 w-4 mr-2 ${o?"animate-spin":""}`}),t("common.refresh","刷新")]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(x,{className:"border-primary/30 bg-primary/5",children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(j,{className:"text-sm font-medium",children:t("admin.orderStats.totalOrders","外卖总订单")}),e.jsx(q,{className:"h-5 w-5 text-primary"})]}),e.jsx(u,{children:o?e.jsx(p,{className:"h-10 w-24"}):e.jsx("div",{className:"text-3xl font-bold text-primary",children:X?.order_count??0})})]}),e.jsxs(x,{className:"border-chart-2/30 bg-chart-2/5",children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(j,{className:"text-sm font-medium",children:t("admin.orderStats.totalReserves","订台总预约")}),e.jsx(M,{className:"h-5 w-5 text-chart-2"})]}),e.jsx(u,{children:o?e.jsx(p,{className:"h-10 w-24"}):e.jsx("div",{className:"text-3xl font-bold text-chart-2",children:X?.reserve_count??0})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(x,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(j,{className:"text-sm font-medium",children:t("admin.orderStats.periodOrders","期间外卖订单")}),e.jsx(q,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(u,{children:o?e.jsx(p,{className:"h-8 w-20"}):e.jsx("div",{className:"text-2xl font-bold",children:f.length})})]}),e.jsxs(x,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(j,{className:"text-sm font-medium",children:t("admin.orderStats.periodReserves","期间订台预约")}),e.jsx(M,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(u,{children:o?e.jsx(p,{className:"h-8 w-20"}):e.jsx("div",{className:"text-2xl font-bold",children:N.length})})]}),e.jsxs(x,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(j,{className:"text-sm font-medium",children:t("admin.orderStats.periodTotal","期间总交易")}),e.jsx(qe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(u,{children:o?e.jsx(p,{className:"h-8 w-20"}):e.jsx("div",{className:"text-2xl font-bold",children:f.length+N.length})})]}),e.jsxs(x,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(j,{className:"text-sm font-medium",children:t("admin.orderStats.ratio","订单占比")}),e.jsx(ae,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(u,{children:o?e.jsx(p,{className:"h-8 w-20"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-2xl font-bold",children:f.length+N.length>0?`${Math.round(f.length/(f.length+N.length)*100)}%`:"0%"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t("admin.orderStats.orderVsReserve","外卖 vs 订台")})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(x,{className:"lg:col-span-2",children:[e.jsxs(h,{children:[e.jsx(j,{children:t("admin.orderStats.trendChart","趋势图")}),e.jsx(I,{children:t("admin.orderStats.selectedPeriod","所选时间段数据")})]}),e.jsx(u,{children:o?e.jsx(p,{className:"h-[300px] w-full"}):e.jsx(F,{width:"100%",height:300,children:e.jsxs(Fe,{data:Z,children:[e.jsx(te,{strokeDasharray:"3 3",className:"stroke-muted"}),e.jsx(re,{dataKey:"date",className:"text-xs"}),e.jsx(de,{className:"text-xs"}),e.jsx(P,{contentStyle:{backgroundColor:"hsl(var(--background))",border:"1px solid hsl(var(--border))",borderRadius:"8px"}}),e.jsx(ne,{type:"monotone",dataKey:"orders",stroke:"hsl(var(--primary))",strokeWidth:2,name:t("admin.orderStats.orders","外卖订单")}),e.jsx(ne,{type:"monotone",dataKey:"reserves",stroke:"hsl(var(--chart-2))",strokeWidth:2,name:t("admin.orderStats.reserves","订台预约")})]})})})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(j,{children:t("admin.orderStats.distribution","分布")}),e.jsx(I,{children:t("admin.orderStats.orderTypeRatio","订单类型占比")})]}),e.jsx(u,{children:o?e.jsx(p,{className:"h-[300px] w-full"}):e.jsx(F,{width:"100%",height:300,children:e.jsxs(Pe,{children:[e.jsx($e,{data:ee,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:5,dataKey:"value",label:({name:a,percent:r})=>`${a} ${(r*100).toFixed(0)}%`,children:ee.map((a,r)=>e.jsx(He,{fill:be[r%be.length]},`cell-${r}`))}),e.jsx(P,{contentStyle:{backgroundColor:"hsl(var(--background))",border:"1px solid hsl(var(--border))",borderRadius:"8px"}})]})})})]})]}),e.jsxs(es,{value:we,onValueChange:a=>Se(a),children:[e.jsxs(ss,{children:[e.jsx(z,{value:"overview",children:t("admin.orderStats.overview","概览")}),e.jsx(z,{value:"orders",children:t("admin.orderStats.ordersList","外卖订单")}),e.jsx(z,{value:"reserves",children:t("admin.orderStats.reservesList","订台预约")})]}),e.jsx(U,{value:"overview",children:e.jsxs(x,{children:[e.jsx(h,{children:e.jsx(j,{children:t("admin.orderStats.dailyStats","每日统计")})}),e.jsx(u,{children:o?e.jsx(p,{className:"h-[300px] w-full"}):e.jsx(F,{width:"100%",height:300,children:e.jsxs(Ke,{data:Z,children:[e.jsx(te,{strokeDasharray:"3 3",className:"stroke-muted"}),e.jsx(re,{dataKey:"date",className:"text-xs"}),e.jsx(de,{className:"text-xs"}),e.jsx(P,{contentStyle:{backgroundColor:"hsl(var(--background))",border:"1px solid hsl(var(--border))",borderRadius:"8px"}}),e.jsx(ie,{dataKey:"orders",fill:"hsl(var(--primary))",name:t("admin.orderStats.orders","外卖订单")}),e.jsx(ie,{dataKey:"reserves",fill:"hsl(var(--chart-2))",name:t("admin.orderStats.reserves","订台预约")})]})})})]})}),e.jsx(U,{value:"orders",children:e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(j,{children:t("admin.orderStats.recentOrders","最近外卖订单")}),e.jsx(I,{children:t("admin.orderStats.showingRecent","显示最近的订单记录")})]}),e.jsx(u,{children:Y?e.jsx(p,{className:"h-[400px] w-full"}):e.jsx(K,{className:"h-[400px]",children:e.jsxs(je,{children:[e.jsx(ue,{children:e.jsxs(T,{children:[e.jsx(c,{children:t("admin.orderStats.orderNumber","订单号")}),e.jsx(c,{children:t("admin.orderStats.customer","客户")}),e.jsx(c,{children:t("admin.orderStats.restaurant","餐厅")}),e.jsx(c,{className:"text-right",children:t("admin.orderStats.amount","金额")}),e.jsx(c,{children:t("admin.orderStats.pickupTime","取餐时间")}),e.jsx(c,{children:t("admin.orderStats.paymentStatus","支付状态")}),e.jsx(c,{})]})}),e.jsxs(pe,{children:[f.slice(0,50).map((a,r)=>e.jsxs(T,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>V(a),children:[e.jsx(n,{className:"font-mono text-xs",children:a.name||`#${r+1}`}),e.jsx(n,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-medium",children:a.customer?.name||"-"}),e.jsx("span",{className:"text-xs text-muted-foreground truncate max-w-[150px]",children:a.customer?.email||""})]})}),e.jsx(n,{children:e.jsx("span",{className:"text-xs",children:a.restaurant||"-"})}),e.jsxs(n,{className:"text-right font-medium",children:["€",a.total_price||"0"]}),e.jsx(n,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs",children:a.pickupDate||a.pickup_date||"-"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:a.pickupTime||""})]})}),e.jsx(n,{children:e.jsx(m,{variant:a.pay_state==="paid"?"default":"secondary",className:H("text-xs",a.pay_state==="paid"&&"bg-green-500"),children:a.pay_state==="paid"?"已付款":a.pay_state||"pending"})}),e.jsx(n,{children:e.jsx(R,{variant:"ghost",size:"sm",className:"h-7",children:e.jsx(le,{className:"h-4 w-4"})})})]},a.id||r)),f.length===0&&e.jsx(T,{children:e.jsx(n,{colSpan:7,className:"text-center text-muted-foreground",children:t("common.noData","暂无数据")})})]})]})})})]})}),e.jsx(U,{value:"reserves",children:e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(j,{children:t("admin.orderStats.recentReserves","最近订台预约")}),e.jsx(I,{children:t("admin.orderStats.showingRecent","显示最近的预约记录")})]}),e.jsx(u,{children:J?e.jsx(p,{className:"h-[400px] w-full"}):e.jsx(K,{className:"h-[400px]",children:e.jsxs(je,{children:[e.jsx(ue,{children:e.jsxs(T,{children:[e.jsx(c,{children:t("admin.orderStats.reserveNo","订台号")}),e.jsx(c,{children:t("admin.orderStats.customerName","预订人")}),e.jsx(c,{children:t("admin.orderStats.restaurant","餐厅")}),e.jsx(c,{children:t("admin.orderStats.creationDate","创建时间")}),e.jsx(c,{children:t("admin.orderStats.reserveDateTime","预约日期/时间")}),e.jsx(c,{className:"text-center",children:t("admin.orderStats.guests","人数")}),e.jsx(c,{children:t("common.status","状态")}),e.jsx(c,{})]})}),e.jsxs(pe,{children:[N.slice(0,50).map((a,r)=>e.jsxs(T,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>W(a),children:[e.jsx(n,{children:e.jsx(m,{variant:"outline",className:"font-mono",children:a.name||"-"})}),e.jsx(n,{className:"font-medium",children:a.customerName||"-"}),e.jsx(n,{className:"max-w-[150px] truncate",children:a.restaurant||"-"}),e.jsx(n,{children:e.jsx("span",{className:"text-xs text-muted-foreground",children:a.creationDate?k(new Date(a.creationDate),"yyyy-MM-dd HH:mm"):"-"})}),e.jsx(n,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm",children:a.date||"-"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:a.time||"-"})]})}),e.jsx(n,{className:"text-center",children:e.jsx(m,{variant:"outline",children:a.numberPeople||a.guests||"-"})}),e.jsx(n,{children:e.jsx(m,{variant:a.status==="confirmed"?"default":"secondary",children:a.status||"pending"})}),e.jsx(n,{children:e.jsx(R,{variant:"ghost",size:"sm",className:"h-7",children:e.jsx(le,{className:"h-4 w-4"})})})]},a.id||r)),N.length===0&&e.jsx(T,{children:e.jsx(n,{colSpan:8,className:"text-center text-muted-foreground",children:t("common.noData","暂无数据")})})]})]})})})]})})]}),e.jsx(me,{open:!!s,onOpenChange:a=>!a&&V(null),children:e.jsxs(oe,{className:"max-w-2xl max-h-[85vh] overflow-hidden",children:[e.jsxs(xe,{children:[e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-5 w-5 text-primary"}),t("admin.orderStats.orderDetail","外卖订单详情")]}),e.jsxs(Ze,{className:"flex items-center gap-2",children:[s?.name&&e.jsx(m,{variant:"outline",className:"font-mono",children:s.name}),s?.pay_state&&e.jsx(m,{variant:s.pay_state==="paid"?"default":"secondary",className:s.pay_state==="paid"?"bg-green-500":"",children:s.pay_state==="paid"?"已付款":s.pay_state})]})]}),s&&e.jsx(K,{className:"max-h-[65vh] pr-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-lg border bg-primary/5 p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"订单总额"}),e.jsxs("p",{className:"text-2xl font-bold text-primary",children:["€ ",s.total_price||"0"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"创建时间"}),e.jsx("p",{className:"text-sm font-medium",children:s.created_at?k(new Date(s.created_at),"yyyy-MM-dd HH:mm:ss"):"-"})]})]})}),s.customer&&e.jsxs("div",{className:"rounded-lg border bg-muted/30 p-4 space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4"}),"客户信息"]}),e.jsxs("div",{className:"grid gap-3",children:[s.customer.name&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:s.customer.name})]}),s.customer.phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:s.customer.phone.includes("#")?`+${s.customer.phone.replace("#"," ")}`:s.customer.phone})]}),s.customer.email&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:s.customer.email})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-muted/30 p-4 space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(ze,{className:"h-4 w-4"}),"取餐信息"]}),e.jsxs("div",{className:"grid gap-2",children:[s.restaurant&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"餐厅"}),e.jsx("span",{className:"font-medium",children:s.restaurant})]}),(s.pickupDate||s.pickup_date)&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"取餐日期"}),e.jsx("span",{className:"font-medium",children:s.pickupDate||s.pickup_date})]}),s.pickupTime&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"取餐时间"}),e.jsx(m,{variant:"outline",className:"font-medium",children:s.pickupTime})]})]})]}),(s.shipping_address||s.delivery_address||s.address||s.deliveryAddress)&&e.jsxs("div",{className:"rounded-lg border bg-muted/30 p-4 space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx($,{className:"h-4 w-4"}),"配送地址"]}),e.jsxs("div",{className:"grid gap-2",children:[(s.order_type||s.deliveryType)&&e.jsxs("div",{className:"flex items-center gap-2 pb-2 mb-2 border-b border-border/50",children:[e.jsx(Ue,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"配送方式"}),e.jsx(m,{variant:"outline",className:"ml-auto",children:(s.order_type||s.deliveryType)==="delivery2home"?e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ve,{className:"h-3 w-3"}),"送货上门"]}):(s.order_type||s.deliveryType)==="pickup"?"到店自取":s.order_type||s.deliveryType})]}),typeof(s.shipping_address||s.delivery_address||s.address||s.deliveryAddress)=="object"?e.jsxs(e.Fragment,{children:[(s.shipping_address?.name||s.delivery_address?.name||s.address?.name||s.deliveryAddress?.name)&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:s.shipping_address?.name||s.delivery_address?.name||s.address?.name||s.deliveryAddress?.name})]}),(s.shipping_address?.phone||s.delivery_address?.phone||s.address?.phone||s.deliveryAddress?.phone)&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:s.shipping_address?.phone||s.delivery_address?.phone||s.address?.phone||s.deliveryAddress?.phone})]}),(s.shipping_address?.address1||s.delivery_address?.address1||s.address?.address1||s.deliveryAddress?.address1||s.shipping_address?.street||s.delivery_address?.street||s.address?.street)&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx($,{className:"h-4 w-4 text-muted-foreground mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{children:s.shipping_address?.address1||s.delivery_address?.address1||s.address?.address1||s.deliveryAddress?.address1||s.shipping_address?.street||s.delivery_address?.street||s.address?.street}),(s.shipping_address?.address2||s.delivery_address?.address2||s.address?.address2||s.deliveryAddress?.address2)&&e.jsx("p",{children:s.shipping_address?.address2||s.delivery_address?.address2||s.address?.address2||s.deliveryAddress?.address2}),e.jsx("p",{children:[s.shipping_address?.city||s.delivery_address?.city||s.address?.city||s.deliveryAddress?.city,s.shipping_address?.province||s.delivery_address?.province||s.address?.province,s.shipping_address?.zip||s.delivery_address?.zip||s.address?.zip||s.deliveryAddress?.postalCode||s.shipping_address?.postalCode||s.delivery_address?.postalCode||s.address?.postalCode,s.shipping_address?.country||s.delivery_address?.country||s.address?.country].filter(Boolean).join(", ")})]})]})]}):e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx($,{className:"h-4 w-4 text-muted-foreground mt-0.5"}),e.jsx("span",{className:"text-sm",children:s.shipping_address||s.delivery_address||s.address})]})]})]}),s.line_items&&Array.isArray(s.line_items)&&s.line_items.length>0&&e.jsxs("div",{className:"rounded-lg border bg-muted/30 p-4 space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4"}),"订单商品 (",s.line_items.length,")"]}),e.jsx("div",{className:"space-y-2",children:s.line_items.map((a,r)=>e.jsxs("div",{className:"flex justify-between items-start py-2 border-b border-border/50 last:border-0",children:[e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:a.name||a.title||"商品"}),a.sku&&e.jsxs("p",{className:"text-xs text-muted-foreground font-mono",children:["SKU: ",a.sku]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["数量: ",a.quantity||1," × €",a.price||"0"]}),a.properties&&Array.isArray(a.properties)&&a.properties.length>0&&e.jsx("div",{className:"text-xs text-muted-foreground",children:a.properties.map((C,A)=>e.jsxs("span",{className:"mr-2",children:[C.name,": ",C.value]},A))})]}),e.jsxs("p",{className:"font-medium text-primary",children:["€",((a.quantity||1)*parseFloat(a.price||"0")).toFixed(2)]})]},r))})]}),e.jsxs("div",{className:"rounded-lg border bg-muted/30 p-4 space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(We,{className:"h-4 w-4"}),"付款信息"]}),e.jsxs("div",{className:"grid gap-2",children:[s.pay_type&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"付款方式"}),e.jsx(m,{variant:"outline",children:s.pay_type})]}),s.pay_state&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"付款状态"}),e.jsx(m,{variant:s.pay_state==="paid"?"default":"secondary",className:s.pay_state==="paid"?"bg-green-500":"",children:s.pay_state==="paid"?"已付款":s.pay_state})]}),e.jsxs("div",{className:"flex justify-between items-center font-bold border-t pt-2 mt-2",children:[e.jsx("span",{children:"总计"}),e.jsxs("span",{className:"text-primary",children:["€",s.total_price||"0"]})]})]})]}),s.note&&e.jsxs("div",{className:"rounded-lg border p-4 space-y-2",children:[e.jsxs("h4",{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(Xe,{className:"h-4 w-4"}),"备注"]}),e.jsx("p",{className:"text-sm",children:s.note})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("p",{className:"text-xs text-muted-foreground font-mono",children:["ID: ",s.id||"-"," ",s._id&&`| MongoDB: ${s._id}`]})})]})})]})}),e.jsx(me,{open:!!i,onOpenChange:a=>!a&&W(null),children:e.jsxs(oe,{className:"max-w-md",children:[e.jsx(xe,{children:e.jsxs(he,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-5 w-5 text-chart-2"}),t("admin.orderStats.reserveDetail","订台预约详情"),i?.name&&e.jsx(m,{variant:"outline",className:"font-mono ml-2",children:i.name})]})}),i&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg border bg-muted/30 p-4 space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4"}),t("admin.orderStats.customerInfo","客户信息")]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:t("admin.orderStats.customerName","预订人")}),e.jsx("span",{className:"font-medium",children:i.customerName||"-"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:t("common.phone","电话")}),e.jsx("span",{className:"font-medium",children:i.phone||"-"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:t("common.email","邮箱")}),e.jsx("span",{className:"font-medium text-sm",children:i.email||"-"})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-muted/30 p-4 space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4"}),t("admin.orderStats.reservationDetails","预约信息")]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:t("admin.orderStats.restaurant","餐厅")}),e.jsx("span",{className:"font-medium",children:i.restaurant||"-"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:t("admin.orderStats.reserveDate","预约日期")}),e.jsx("span",{className:"font-medium",children:i.date||"-"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:t("admin.orderStats.reserveTime","预约时间")}),e.jsx("span",{className:"font-medium",children:i.time||"-"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:t("admin.orderStats.guests","人数")}),e.jsxs(m,{variant:"outline",className:"font-medium",children:[i.numberPeople||i.guests||"-"," ",t("admin.orderStats.people","人")]})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center px-1",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:t("common.status","状态")}),e.jsx(m,{variant:i.status==="confirmed"?"default":"secondary",children:i.status||"pending"})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("p",{className:"text-xs text-muted-foreground font-mono",children:["ID: ",i.id||i._id||"-"]})})]})]})})]})};export{hs as default};
//# sourceMappingURL=AdminOrderStats-DnaY5Wyf.js.map
