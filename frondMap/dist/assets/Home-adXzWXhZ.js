import{r,j as e}from"./vendor-react-core-BErlw7p5.js";import{u as ve,l as je,D as we,a as Ne,b as ke,c as _e,S as Se,d as T,I as Ce,B as q,C as Ie,H as Te,i as le,e as ie,f as ne}from"./index-CEqKPgls.js";import{u as Re,L as Y}from"./vendor-router-CLK0c9aH.js";import{m as ze}from"./map-icon-DR07RZr_.js";import{u as De}from"./useHomepageTemplates-CSGE_Si7.js";import{u as Ee}from"./usePageView-CtPIIJd7.js";import{u as ce}from"./vendor-i18n-CqcxoxDo.js";import{q as Z,U as Me,o as re,p as Oe,R as Pe,r as Le,s as $e,A as Ae,t as ae,e as de,d as ue,u as Be,v as Ve,D as We,w as He}from"./vendor-icons-C2Bicc1E.js";import{u as Fe}from"./vendor-query-BS0wY7WL.js";import"./vendor-editor-BdQcs4B3.js";import"./vendor-misc-DH4LiFnZ.js";import"./vendor-date-fYlqblcl.js";import"./vendor-ui-other-CPTlx-W2.js";import"./vendor-supabase-Clrw0GhO.js";import"./vendor-ui-dialog-Sv_VEL0d.js";import"./vendor-ui-dropdown-DwTcg2UT.js";const Xe="/assets/google-play-badge-new-BAXiFmDF.png",qe="/assets/app-store-badge-C-eOGvqu.svg",Ye="https://tzdgqhwyzsxkxnncgzap.supabase.co",oe="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR6ZGdxaHd5enN4a3hubmNnemFwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM2NTg2ODgsImV4cCI6MjA3OTIzNDY4OH0.D76C4OkjQVWyMxtjjdOofpD8X_hEEoTtrXHqi4XSYUw",Ue=({open:t,onOpenChange:u})=>{const{i18n:i}=ce(),a=Re(),{settings:v}=ve(),f=v?.logo_url||je,[g,k]=r.useState(""),[I,z]=r.useState([]),[h,D]=r.useState(!1),[_,O]=r.useState(null),w=r.useRef(null),A=r.useRef(null),x=r.useRef(null);r.useEffect(()=>{t&&!_&&navigator.geolocation?.getCurrentPosition(s=>{O({lat:s.coords.latitude,lng:s.coords.longitude})},s=>{console.log("Unable to get user location:",s.message)},{enableHighAccuracy:!1,timeout:5e3,maximumAge:3e5})},[t,_]),r.useEffect(()=>{x.current?.scrollIntoView({behavior:"smooth"})},[I]);const R=async()=>{if(!g.trim()||h)return;const s={id:Date.now().toString(),role:"user",content:g.trim()},N=(Date.now()+1).toString(),o={id:N,role:"assistant",content:"",isStreaming:!0};z(c=>[...c,s,o]),k(""),D(!0),w.current&&w.current.abort(),w.current=new AbortController;try{const c=await fetch(`${Ye}/functions/v1/ask-xiaoxiong`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${oe}`,apikey:oe},body:JSON.stringify({text:s.content,stream:!0,lat:_?.lat,lng:_?.lng}),signal:w.current.signal});if(!c.ok)throw new Error(`Request failed with status: ${c.status}`);if(!c.body)throw new Error("No response body");const l=c.body.getReader(),p=new TextDecoder;let b="";for(;;){const{done:L,value:$}=await l.read();if(L)break;const d=p.decode($,{stream:!0});b+=d;let m=b;m.startsWith('"')&&(m=m.slice(1)),m.endsWith('"')&&(m=m.slice(0,-1)),m=m.replace(/\\n/g,`
`),z(E=>E.map(C=>C.id===N?{...C,content:m}:C))}let y=b;y.startsWith('"')&&(y=y.slice(1)),y.endsWith('"')&&(y=y.slice(0,-1)),y=y.replace(/\\n/g,`
`),z(L=>L.map($=>$.id===N?{...$,content:y,isStreaming:!1}:$))}catch(c){if(c instanceof Error&&c.name==="AbortError"){console.log("Request aborted");return}console.error("Ask API error:",c);const l=i.language==="zh"?"抱歉，暂时无法获取结果，请稍后再试":i.language==="pt"?"Desculpe, não foi possível obter resultados. Tente novamente mais tarde.":"Sorry, unable to get results. Please try again later.";z(p=>p.map(b=>b.id===N?{...b,content:l,isStreaming:!1}:b))}finally{D(!1)}},B=s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),R())},P=()=>{w.current&&w.current.abort(),u(!1)},M=s=>{P(),a(s)},n=s=>{const N=/\[([^\]]+)\]\(([^)]+)\)/g,o=[];let c=0,l,p=0;for(;(l=N.exec(s))!==null;){l.index>c&&o.push(e.jsx("span",{children:s.slice(c,l.index)},p++));const b=l[1],y=l[2];y.startsWith("/")?o.push(e.jsx("button",{onClick:()=>M(y),className:"text-primary hover:underline font-medium cursor-pointer",children:b},p++)):o.push(e.jsx("a",{href:y,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline font-medium",children:b},p++)),c=l.index+l[0].length}return c<s.length&&o.push(e.jsx("span",{children:s.slice(c)},p++)),o.length>0?o:[e.jsx("span",{children:s},"0")]},S=s=>s.replace(/\*\*(.*?)\*\*/g,"$1"),V=(s,N=20)=>s.length<=N?s:s.slice(0,N)+"...",W=(s,N)=>{const o=p=>p.split("|").slice(1,-1).map(b=>S(b.trim())),c=o(s[0]),l=s.slice(2).map(o);return e.jsx("div",{className:"overflow-x-auto my-2 max-w-full",children:e.jsxs("table",{className:"w-full text-xs border border-border rounded-md overflow-hidden table-fixed",children:[e.jsx("thead",{className:"bg-muted/60",children:e.jsx("tr",{children:c.map((p,b)=>e.jsx("th",{className:"px-2 py-2 text-left font-semibold border-b border-border truncate max-w-[100px]",title:p,children:n(V(p,15))},b))})}),e.jsx("tbody",{children:l.map((p,b)=>e.jsx("tr",{className:"border-b border-border last:border-0 hover:bg-muted/30 transition-colors",children:p.map((y,L)=>e.jsx("td",{className:"px-2 py-2 truncate max-w-[100px]",title:y,children:n(V(y,18))},L))},b))})]})},N)},H=s=>{const N=s.split(`
`),o=[];let c=0;for(;c<N.length;){const l=N[c];if(l.trim().startsWith("|")&&l.split("|").length>2){const p=[];for(;c<N.length&&N[c].trim().startsWith("|");)p.push(N[c]),c++;p.length>=2&&o.push(W(p,o.length));continue}if(l.startsWith("### "))o.push(e.jsx("h3",{className:"text-base font-semibold mt-3 mb-1",children:n(l.slice(4))},o.length));else if(l.startsWith("## "))o.push(e.jsx("h2",{className:"text-lg font-bold mt-4 mb-2",children:n(l.slice(3))},o.length));else if(l.startsWith("# "))o.push(e.jsx("h1",{className:"text-xl font-bold mt-4 mb-2",children:n(l.slice(2))},o.length));else if(l.includes("**")){const p=l.split(/\*\*(.*?)\*\*/g);o.push(e.jsx("p",{className:"mb-1 leading-relaxed",children:p.map((b,y)=>y%2===1?e.jsx("strong",{className:"font-semibold",children:n(b)},y):n(b))},o.length))}else l.startsWith("- ")||l.startsWith("* ")?o.push(e.jsx("li",{className:"ml-4 mb-0.5 list-disc",children:n(l.slice(2))},o.length)):/^\d+\.\s/.test(l)?o.push(e.jsx("li",{className:"ml-4 mb-0.5 list-decimal",children:n(l.replace(/^\d+\.\s/,""))},o.length)):l.match(/^[-*_]{3,}$/)?o.push(e.jsx("hr",{className:"my-3 border-border"},o.length)):l.trim()===""?o.push(e.jsx("div",{className:"h-1"},o.length)):o.push(e.jsx("p",{className:"mb-1 leading-relaxed",children:n(l)},o.length));c++}return o},F=()=>i.language==="zh"?"小熊AI助手":i.language==="pt"?"Assistente IA Xiaoxiong":"Xiaoxiong AI Assistant",j=()=>i.language==="zh"?"输入你的想法...":i.language==="pt"?"Digite sua ideia...":"Type your idea...",J=()=>i.language==="zh"?"你好！我是小熊，告诉我你想吃什么，我来帮你推荐餐厅！":i.language==="pt"?"Olá! Eu sou o Xiaoxiong, me diga o que você quer comer e eu vou te ajudar a encontrar restaurantes!":"Hi! I'm Xiaoxiong, tell me what you want to eat and I'll help you find restaurants!";return e.jsx(we,{open:t,onOpenChange:P,children:e.jsxs(Ne,{className:"w-full h-full max-w-full max-h-full sm:max-w-lg sm:h-[70vh] sm:max-h-[70vh] sm:rounded-lg rounded-none flex flex-col p-0 gap-0 overflow-hidden",children:[e.jsx(ke,{className:"px-4 py-3 border-b shrink-0 bg-primary/5",children:e.jsxs(_e,{className:"flex items-center gap-2 text-base",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:f,alt:"Logo",className:"w-6 h-6 object-contain"})}),F()]})}),e.jsx(Se,{className:"flex-1 h-0",ref:A,children:e.jsxs("div",{className:"p-4 space-y-4",children:[I.length===0&&e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center shrink-0",children:e.jsx(Z,{className:"w-4 h-4 text-primary"})}),e.jsx("div",{className:"flex-1 bg-muted/50 rounded-2xl rounded-tl-sm px-4 py-3 text-sm",children:J()})]}),I.map(s=>e.jsxs("div",{className:T("flex gap-3",s.role==="user"&&"flex-row-reverse"),children:[e.jsx("div",{className:T("w-8 h-8 rounded-full flex items-center justify-center shrink-0",s.role==="user"?"bg-primary text-primary-foreground":"bg-primary/10"),children:s.role==="user"?e.jsx(Me,{className:"h-4 w-4"}):e.jsx(Z,{className:"h-4 w-4"})}),e.jsx("div",{className:T("flex-1 max-w-[85%] rounded-2xl px-4 py-3 text-sm",s.role==="user"?"bg-primary text-primary-foreground rounded-tr-sm":"bg-muted/50 rounded-tl-sm"),children:s.role==="assistant"?e.jsxs(e.Fragment,{children:[s.content?e.jsx("div",{className:"prose-sm",children:H(s.content)}):e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(re,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:i.language==="zh"?"思考中...":i.language==="pt"?"Pensando...":"Thinking..."})]}),s.isStreaming&&s.content&&e.jsx("span",{className:"inline-block w-1.5 h-4 bg-primary/50 animate-pulse ml-0.5 align-middle"})]}):s.content})]},s.id)),e.jsx("div",{ref:x})]})}),e.jsx("div",{className:"p-3 border-t bg-background shrink-0",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ce,{value:g,onChange:s=>k(s.target.value),onKeyDown:B,placeholder:j(),disabled:h,className:"flex-1 rounded-full bg-muted/50 border-0 focus-visible:ring-1",autoFocus:!0}),e.jsx(q,{onClick:R,disabled:!g.trim()||h,size:"icon",className:"shrink-0 rounded-full",children:h?e.jsx(re,{className:"h-4 w-4 animate-spin"}):e.jsx(Oe,{className:"h-4 w-4"})})]})})]})})};function Je({onRefresh:t,threshold:u=80,maxPull:i=120}){const[a,v]=r.useState(!1),[f,g]=r.useState(!1),[k,I]=r.useState(0),z=r.useRef(0),h=r.useRef(0),D=r.useRef(null),_=r.useCallback(x=>{(window.scrollY||document.documentElement.scrollTop)>5||(z.current=x.touches[0].clientY,v(!0))},[]),O=r.useCallback(x=>{if(!a||f)return;h.current=x.touches[0].clientY;const R=h.current-z.current;if(R<0){I(0);return}R>10&&x.preventDefault();const P=Math.min(R*.5,i);I(P)},[a,f,i]),w=r.useCallback(async()=>{if(a)if(v(!1),k>=u&&!f){g(!0),I(u);try{await t()}finally{g(!1),I(0)}}else I(0)},[a,k,u,f,t]);r.useEffect(()=>{const x=D.current;if(x)return x.addEventListener("touchstart",_,{passive:!0}),x.addEventListener("touchmove",O,{passive:!1}),x.addEventListener("touchend",w,{passive:!0}),()=>{x.removeEventListener("touchstart",_),x.removeEventListener("touchmove",O),x.removeEventListener("touchend",w)}},[_,O,w]);const A=Math.min(k/u,1);return{containerRef:D,isPulling:a,isRefreshing:f,pullDistance:k,progress:A}}function Ge({children:t,onRefresh:u,className:i}){const{containerRef:a,isRefreshing:v,pullDistance:f,progress:g}=Je({onRefresh:u,threshold:80,maxPull:120});return e.jsxs("div",{ref:a,className:T("relative",i),children:[e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 z-50 flex items-center justify-center transition-opacity duration-200 pointer-events-none",style:{top:Math.max(f-50,8),opacity:f>20?1:0},children:e.jsx("div",{className:T("w-10 h-10 rounded-full bg-background/90 backdrop-blur-sm shadow-lg flex items-center justify-center border border-border/50",v&&"animate-pulse"),children:e.jsx(Pe,{className:T("w-5 h-5 text-primary transition-transform duration-200",v&&"animate-spin"),style:{transform:v?void 0:`rotate(${g*360}deg)`}})})}),e.jsx("div",{style:{transform:f>0?`translateY(${f}px)`:void 0,transition:f===0?"transform 0.3s ease-out":void 0},children:t})]})}const ee="/images/sushi-ramen-hero.jpg",me="/images/sushi-ramen-mobile.jpg",he=r.memo(({stats:t,t:u})=>e.jsx("div",{className:"absolute top-16 sm:top-20 left-3 z-20",children:e.jsxs("div",{className:"gap-4 w-fit flex-col flex items-start justify-start",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm text-white/90 drop-shadow-md",children:u("home.stats.delivery")}),e.jsx("span",{className:"font-bold text-white text-sm drop-shadow-md",children:t.order_count})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{className:"w-4 h-4 text-accent"}),e.jsx("span",{className:"text-sm text-white/90 drop-shadow-md",children:u("home.stats.reservation")}),e.jsx("span",{className:"font-bold text-white text-sm drop-shadow-md",children:t.reserve_count})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl sm:text-2xl font-bold text-white drop-shadow-md",children:u("home.hero.brandName")}),e.jsx("img",{src:ze,alt:"map icon",width:32,height:32,loading:"eager",decoding:"async",className:"w-7 sm:w-8 h-7 sm:h-8 object-contain flex-shrink-0"})]})]})}));he.displayName="StatsDisplay";const U=r.memo(({to:t,Icon:u,title:i,desc:a,iconBg:v,iconColor:f,hoverBorderColor:g})=>e.jsx(Y,{to:t,children:e.jsxs(Ie,{className:`group p-6 sm:p-8 border-border/50 ${g} transition-all hover:shadow-large cursor-pointer h-full`,children:[e.jsx("div",{className:`w-14 sm:w-16 h-14 sm:h-16 rounded-2xl ${v} flex items-center justify-center mb-4 sm:mb-6 group-hover:scale-110 transition-transform`,children:e.jsx(u,{className:`w-7 sm:w-8 h-7 sm:h-8 ${f}`})}),e.jsx("h3",{className:"text-xl sm:text-2xl font-semibold mb-2 sm:mb-3 text-card-foreground",children:i}),e.jsxs("p",{className:"text-sm sm:text-base text-muted-foreground leading-relaxed flex items-center gap-2",children:[a,e.jsx(Ae,{className:"w-4 h-4 flex-shrink-0 group-hover:translate-x-1 transition-transform"})]})]})}));U.displayName="FeatureCard";const Ke=()=>{const t=window.innerWidth<640,u=window.innerWidth>=1024,i=navigator.connection,a=window.Capacitor,v=ie(),f=le(),g=ne(),k=navigator.userAgent;return console.log("[LightweightMode] Detection:",{isCapacitorApp:v,isInWebView:f,isIOSDevice:g,hasCapacitor:!!a,capacitorDetails:a?{isNativePlatform:a.isNativePlatform,isNative:a.isNative,platform:a.getPlatform?.()}:null,userAgent:k.substring(0,150),hasSafari:/Safari\//.test(k),hasVersion:/Version\/[\d.]+/.test(k),isStandalone:window.navigator.standalone===!0}),g&&!v?(console.log("[LightweightMode] iOS device detected, using lightweight mode for stability"),!0):u?!!i?.saveData:f&&!v?(console.log("[LightweightMode] WebView detected (not Capacitor), using lightweight mode"),!0):i&&(i.saveData||i.effectiveType==="2g"||i.effectiveType==="slow-2g")||t&&navigator.deviceMemory&&navigator.deviceMemory<2?!0:(console.log("[LightweightMode] Normal mode, videos enabled"),!1)},xe=r.memo(({template:t,isActive:u,currentLang:i,t:a,onContentReady:v,onAskXiaoxiong:f})=>{const[g,k]=r.useState({}),[I,z]=r.useState({}),[h,D]=r.useState({}),[_,O]=r.useState({mobile:!0,tablet:!0,desktop:!0}),[w,A]=r.useState(!1),x=Ke(),R=r.useRef(null),B=r.useRef(null),P=r.useRef(null),M=d=>t[`${d}${i==="zh"?"_zh":i==="pt"?"_pt":"_en"}`]||"",n=()=>window.innerWidth<640?"mobile":window.innerWidth<1024?"tablet":"desktop",S=()=>{const d=n();return d==="mobile"&&t.mobile_overlay_opacity!==null?t.mobile_overlay_opacity:d==="tablet"&&t.tablet_overlay_opacity!==null?t.tablet_overlay_opacity:d==="desktop"&&t.desktop_overlay_opacity!==null?t.desktop_overlay_opacity:t.overlay_opacity??30},V=()=>{const d=S(),m=t.overlay_gradient_direction||"to-b",E=(X,ye)=>X==null?ye/100:X>1?X/100:X,C=d>1?d/100:d,te=E(t.overlay_gradient_from_opacity,30)*C,G=E(t.overlay_gradient_via_opacity,25)*C,K=E(t.overlay_gradient_to_opacity,40)*C,pe={"to-t":"to top","to-b":"to bottom","to-l":"to left","to-r":"to right","to-tl":"to top left","to-tr":"to top right","to-bl":"to bottom left","to-br":"to bottom right"}[m]||"to bottom",Q={black:"0, 0, 0",white:"255, 255, 255",background:"0, 0, 0",foreground:"255, 255, 255",primary:"1, 100, 80",secondary:"240, 240, 240"},fe=Q[t.overlay_gradient_from||"black"]||"0, 0, 0",ge=Q[t.overlay_gradient_via||"black"]||"0, 0, 0",be=Q[t.overlay_gradient_to||"black"]||"0, 0, 0";return{background:`linear-gradient(${pe}, rgba(${fe}, ${te}), rgba(${ge}, ${G}), rgba(${be}, ${K}))`}},W=t.mobile_image_url||me,H=t.tablet_image_url||t.desktop_image_url||ee,F=t.desktop_image_url||ee,j=t.background_blur||0,J=t.desktop_media_type||t.media_type||"image",s=t.tablet_media_type||t.media_type||"image",N=t.mobile_media_type||t.media_type||"image",o=J==="video"&&!x,c=s==="video"&&!x,l=N==="video"&&!x,p=l?t.mobile_video_url:null,b=c?t.tablet_video_url||t.desktop_video_url:null,y=o?t.desktop_video_url:null;r.useEffect(()=>{const d=n(),m=d==="mobile"?W:d==="tablet"?H:F;if(m){const E=new Image;E.onload=()=>{k(C=>({...C,[d]:!0})),O(C=>({...C,[d]:!0})),u&&(v?.(),setTimeout(()=>A(!0),100))},E.src=m}},[W,H,F,u,v]),r.useEffect(()=>{u&&g[n()]&&A(!0)},[u,g]);const L=d=>{z(m=>({...m,[d]:!0}))},$=(d,m)=>{console.error(`[HeroSlide] Video error on ${d}:`,m),D(E=>({...E,[d]:!0}))};return r.useEffect(()=>{if(!w||!u||!ne())return;const m=n(),C=(m==="mobile"?R:m==="tablet"?B:P).current;if(!C)return;const G=setTimeout(async()=>{try{C.muted=!0,C.playsInline=!0,C.setAttribute("webkit-playsinline","true"),await C.play(),console.log(`[HeroSlide] iOS video play successful on ${m}`)}catch(K){console.error(`[HeroSlide] iOS video play failed on ${m}:`,K),D(se=>({...se,[m]:!0}))}},150);return()=>clearTimeout(G)},[w,u]),e.jsxs("div",{className:T("absolute inset-0 w-full h-full transition-opacity duration-1000",u?"opacity-100 z-10":"opacity-0 z-0"),children:[e.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[e.jsxs("div",{className:"absolute inset-0 w-full h-full sm:hidden",children:[!_.mobile&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),l&&p?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:W,alt:"Background",className:T("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",I.mobile&&!h.mobile?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:j>0?`blur(${j}px)`:void 0}}),w&&!h.mobile&&e.jsx("video",{ref:R,src:p,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>L("mobile"),onError:d=>$("mobile",d),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:j>0?`blur(${j}px)`:void 0}})]}):e.jsx("img",{src:W,alt:"Background",className:T("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",_.mobile?"opacity-100":"opacity-0"),style:{filter:j>0?`blur(${j}px)`:void 0}})]}),e.jsxs("div",{className:"absolute inset-0 w-full h-full hidden sm:block lg:hidden",children:[!_.tablet&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),c&&b?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:H,alt:"Background",className:T("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",I.tablet&&!h.tablet?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:j>0?`blur(${j}px)`:void 0}}),w&&!h.tablet&&e.jsx("video",{ref:B,src:b,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>L("tablet"),onError:d=>$("tablet",d),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:j>0?`blur(${j}px)`:void 0}})]}):e.jsx("img",{src:H,alt:"Background",className:T("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",_.tablet?"opacity-100":"opacity-0"),style:{filter:j>0?`blur(${j}px)`:void 0}})]}),e.jsxs("div",{className:"absolute inset-0 w-full h-full hidden lg:block",children:[!_.desktop&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),o&&y?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:F,alt:"Background",className:T("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",I.desktop&&!h.desktop?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:j>0?`blur(${j}px)`:void 0}}),w&&!h.desktop&&e.jsx("video",{ref:P,src:y,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>L("desktop"),onError:d=>$("desktop",d),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:j>0?`blur(${j}px)`:void 0}})]}):e.jsx("img",{src:F,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:T("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",_.desktop?"opacity-100":"opacity-0"),style:{filter:j>0?`blur(${j}px)`:void 0}})]}),e.jsx("div",{className:"absolute inset-0 w-full h-full",style:V()})]}),e.jsx("div",{className:"relative z-10 container mx-auto px-4 sm:px-6 flex items-center min-h-screen",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center space-y-4 sm:space-y-8 animate-fade-in w-full",children:[t.subtitle_button_text_zh&&e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:f,className:"group flex items-center gap-3 bg-white/95 backdrop-blur-sm text-muted-foreground px-4 sm:px-6 py-3 sm:py-4 rounded-full shadow-lg hover:shadow-2xl hover:bg-white transition-all duration-300 cursor-text border border-border/20",children:[e.jsx(Z,{className:"w-5 h-5 text-primary/70 group-hover:text-primary transition-colors"}),e.jsx("span",{className:"text-sm sm:text-base text-muted-foreground/80 group-hover:text-muted-foreground transition-colors",children:M("subtitle_button_text")||a("home.hero.subtitle")}),e.jsx(ae,{className:"w-4 h-4 text-muted-foreground/50 ml-2"})]})}),e.jsx("h1",{className:"text-3xl sm:text-5xl md:text-7xl font-bold text-white leading-tight px-4 drop-shadow-[0_2px_8px_rgba(0,0,0,0.8)]",children:M("title")||a("home.hero.title")}),e.jsx("p",{className:"text-sm sm:text-xl md:text-2xl text-white/95 max-w-2xl mx-auto px-4 drop-shadow-[0_2px_6px_rgba(0,0,0,0.7)]",children:M("description")||a("home.hero.description")}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4 justify-center pt-2 sm:pt-4 px-4",children:[e.jsx(q,{size:"lg",asChild:!0,className:"text-base sm:text-lg shadow-lg hover:shadow-2xl hover:scale-105 transition-all w-full sm:w-auto",children:e.jsxs(Y,{to:t.primary_button_link||"/restaurants",children:[e.jsx(ae,{className:"mr-2 w-4 sm:w-5 h-4 sm:h-5"}),M("primary_button_text")||a("home.hero.exploreBtn")]})}),e.jsx(q,{size:"lg",variant:"outline",asChild:!0,className:"text-base sm:text-lg w-full sm:w-auto backdrop-blur-sm hover:border-transparent hover:scale-105 transition-all",children:e.jsxs(Y,{to:t.secondary_button_link||"/activities",children:[e.jsx(de,{className:"mr-2 w-4 sm:w-5 h-4 sm:h-5"}),M("secondary_button_text")||a("home.hero.activitiesBtn")]})}),e.jsx(q,{size:"lg",asChild:!0,className:"text-base sm:text-lg w-full sm:w-auto bg-[#e8f5f0] text-[#3d9970] hover:bg-[#d4ede4] hover:scale-105 transition-all shadow-lg border border-[#3d9970]/30",children:e.jsxs(Y,{to:t.map_button_link||"/map",children:[e.jsx(ue,{className:"mr-2 w-4 sm:w-5 h-4 sm:h-5"}),M("map_button_text")||a("home.hero.mapBtn")]})})]})]})})]})});xe.displayName="HeroSlide";const xt=()=>{const{t,i18n:u}=ce(),i=Fe(),{data:a,isLoading:v,refetch:f}=De(),[g,k]=r.useState(0),[I,z]=r.useState(null),h=r.useRef(null),[D,_]=r.useState(!1),[O,w]=r.useState(!1),A=r.useCallback(()=>{_(!0)},[]);Ee({pageType:"home"});const x=r.useCallback(async()=>{try{const S=await(await fetch("https://v.xiaoxiong.pt/api/get_info")).json();S&&z({order_count:S.order_count||0,reserve_count:S.reserve_count||0})}catch(n){console.error("Failed to fetch stats:",n)}},[]);r.useEffect(()=>{x()},[x]);const R=r.useCallback(async()=>{await Promise.all([f(),x(),i.invalidateQueries({queryKey:["restaurants"]}),i.invalidateQueries({queryKey:["activities"]})])},[f,x,i]);r.useEffect(()=>{if(!a||a.length<=1)return;const S=a[g]?.duration||5e3;return h.current=setTimeout(()=>{k(V=>(V+1)%a.length)},S),()=>{h.current&&clearTimeout(h.current)}},[a,g]);const B=r.useCallback(n=>{h.current&&clearTimeout(h.current),k(n)},[]);r.useCallback(()=>{a&&(h.current&&clearTimeout(h.current),k(n=>(n-1+a.length)%a.length))},[a]),r.useCallback(()=>{a&&(h.current&&clearTimeout(h.current),k(n=>(n+1)%a.length))},[a]);const P=u.language,M=a&&a.length>1;return e.jsx(Ge,{onRefresh:R,children:e.jsxs("div",{className:"min-h-screen",children:[e.jsxs("section",{className:"relative h-screen flex items-start overflow-hidden bg-background",children:[I&&e.jsx(he,{stats:I,t}),e.jsx("div",{className:T("absolute inset-0 w-full h-full transition-opacity duration-500",D?"opacity-100":"opacity-0"),children:a?.map((n,S)=>e.jsx(xe,{template:n,isActive:S===g,currentLang:P,t,onContentReady:S===0?A:void 0,onAskXiaoxiong:()=>w(!0)},n.id))}),e.jsx("div",{className:T("absolute inset-0 w-full h-full z-20 transition-opacity duration-500",v||!D?"opacity-100":"opacity-0 pointer-events-none"),children:e.jsx(Te,{})}),!v&&(!a||a.length===0)&&e.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[e.jsx("img",{src:me,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:"absolute inset-0 w-full h-full object-cover object-center sm:hidden"}),e.jsx("img",{src:ee,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:"absolute inset-0 w-full h-full object-cover object-center hidden sm:block"}),e.jsx("div",{className:"absolute inset-0 w-full h-full bg-gradient-to-b from-black/30 via-black/25 to-black/40"}),e.jsx("div",{className:"relative z-10 container mx-auto px-4 sm:px-6 flex items-center min-h-screen",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center space-y-4 sm:space-y-8 animate-fade-in w-full",children:[e.jsx("h1",{className:"text-3xl sm:text-5xl md:text-7xl font-bold text-white leading-tight px-4 drop-shadow-[0_2px_8px_rgba(0,0,0,0.8)]",children:t("home.hero.title")}),e.jsx("p",{className:"text-sm sm:text-xl md:text-2xl text-white/95 max-w-2xl mx-auto px-4 drop-shadow-[0_2px_6px_rgba(0,0,0,0.7)]",children:t("home.hero.description")})]})})]}),M&&e.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 z-30 flex gap-2",children:a.map((n,S)=>e.jsx("button",{onClick:()=>B(S),className:T("w-3 h-3 rounded-full transition-all duration-300",S===g?"bg-white w-8":"bg-white/50 hover:bg-white/70"),"aria-label":`Go to slide ${S+1}`},S))})]}),e.jsx("section",{className:"py-16 sm:py-24 px-4 bg-secondary/20",children:e.jsxs("div",{className:"container mx-auto max-w-6xl",children:[e.jsxs("div",{className:"text-center mb-12 sm:mb-16",children:[e.jsx("h2",{className:"text-3xl sm:text-4xl md:text-5xl font-bold text-foreground mb-3 sm:mb-4",children:t("home.features.title")}),e.jsx("p",{className:"text-base sm:text-lg text-muted-foreground max-w-2xl mx-auto px-4",children:t("home.features.description")})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 sm:gap-8",children:[e.jsx(U,{to:"/map",Icon:ue,title:t("home.features.map.title"),desc:t("home.features.map.desc"),iconBg:"bg-gradient-to-br from-primary to-primary-light",iconColor:"text-primary-foreground",hoverBorderColor:"hover:border-primary/50"}),e.jsx(U,{to:"/restaurants",Icon:Be,title:t("home.features.reviews.title"),desc:t("home.features.reviews.desc"),iconBg:"bg-gradient-to-br from-accent to-warning",iconColor:"text-accent-foreground",hoverBorderColor:"hover:border-accent/50"}),e.jsx("div",{className:"sm:col-span-2 md:col-span-1",children:e.jsx(U,{to:"/activities",Icon:de,title:t("home.features.events.title"),desc:t("home.features.events.desc"),iconBg:"bg-gradient-to-br from-success to-accent",iconColor:"text-white",hoverBorderColor:"hover:border-success/50"})})]})]})}),!le()&&!ie()&&e.jsxs("section",{className:"py-16 sm:py-24 px-4 bg-gradient-to-br from-primary/5 via-background to-primary/10 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-1/4 w-72 h-72 bg-primary/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 right-1/4 w-96 h-96 bg-primary/5 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute top-1/2 left-0 w-32 h-32 bg-primary/20 rounded-full blur-2xl -translate-y-1/2"}),e.jsx("div",{className:"absolute top-1/2 right-0 w-32 h-32 bg-primary/20 rounded-full blur-2xl -translate-y-1/2"}),e.jsx("div",{className:"container mx-auto max-w-5xl relative z-10",children:e.jsx("div",{className:"flex flex-col items-center justify-center gap-8",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-primary/10 text-primary text-sm font-medium px-4 py-2 rounded-full mb-4",children:[e.jsx(Ve,{className:"w-4 h-4"}),e.jsx("span",{children:"Mobile App"})]}),e.jsx("h3",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-foreground mb-4",children:t("home.app.title")}),e.jsx("p",{className:"text-base sm:text-lg text-muted-foreground mb-8 leading-relaxed",children:t("home.app.description")}),e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[e.jsxs("a",{href:"https://apps.apple.com/cn/app/xiaoxiong/id6755481369",target:"_blank",rel:"noopener noreferrer",className:"relative group",children:[e.jsx("div",{className:"absolute -inset-2 bg-gradient-to-r from-primary via-primary-glow to-primary rounded-2xl blur-lg opacity-40 group-hover:opacity-70 transition-opacity"}),e.jsx("div",{className:"relative bg-black hover:bg-gray-900 h-[52px] sm:h-[56px] w-[160px] sm:w-[180px] rounded-xl transition-all hover:scale-105 shadow-2xl hover:shadow-primary/30 border border-white/10 flex items-center justify-center",children:e.jsx("img",{src:qe,alt:"Download on the App Store",className:"h-8 sm:h-9"})})]}),e.jsxs("a",{href:"https://play.google.com/store/apps/details?id=com.xiaoxiong.market",target:"_blank",rel:"noopener noreferrer",className:"relative group",children:[e.jsx("div",{className:"absolute -inset-2 bg-gradient-to-r from-primary via-primary-glow to-primary rounded-2xl blur-lg opacity-40 group-hover:opacity-70 transition-opacity"}),e.jsx("div",{className:"relative bg-black hover:bg-gray-900 h-[52px] sm:h-[56px] w-[160px] sm:w-[180px] rounded-xl transition-all hover:scale-105 shadow-2xl hover:shadow-primary/30 border border-white/10 flex items-center justify-center",children:e.jsx("img",{src:Xe,alt:"Get it on Google Play",className:"h-12 sm:h-14"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(We,{className:"w-4 h-4 animate-bounce"}),e.jsx("span",{children:t("home.app.downloadNow")})]})]})]})})})]}),e.jsxs("section",{className:"py-16 sm:py-20 px-4 bg-gradient-to-br from-primary via-primary-glow to-primary-light relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-grid-pattern opacity-10"}),e.jsx("div",{className:"absolute top-0 right-0 w-64 sm:w-96 h-64 sm:h-96 bg-white/5 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-64 sm:w-96 h-64 sm:h-96 bg-white/5 rounded-full blur-3xl"}),e.jsxs("div",{className:"container mx-auto max-w-4xl text-center relative z-10",children:[e.jsx("h2",{className:"text-3xl sm:text-4xl md:text-5xl font-bold text-primary-foreground mb-4 sm:mb-6 px-4",children:t("home.cta.title")}),e.jsx("p",{className:"text-base sm:text-xl text-primary-foreground/90 mb-6 sm:mb-8 max-w-2xl mx-auto px-4",children:t("home.cta.description")}),e.jsx("div",{className:"flex justify-center",children:e.jsx(q,{size:"lg",variant:"secondary",asChild:!0,className:"text-base sm:text-lg shadow-xl hover:shadow-2xl",children:e.jsxs(Y,{to:"/join-us",children:[e.jsx(He,{className:"mr-2 w-4 sm:w-5 h-4 sm:h-5"}),t("home.cta.button")]})})})]})]}),e.jsx(Ue,{open:O,onOpenChange:w})]})})};export{xt as default};
//# sourceMappingURL=Home-adXzWXhZ.js.map
