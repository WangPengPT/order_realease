import{r as t,j as f,c0 as k}from"./vendor-react-COnB1Bf9.js";import{i as E}from"./index-T7L6ozN1.js";function C({onRefresh:u,threshold:s=80,maxPull:d=120}){const[h,n]=t.useState(0),[r,m]=t.useState(!1),p=t.useRef(0),c=t.useRef(0),o=t.useRef(!1),a=t.useRef(!1),R=t.useRef(null),w=t.useRef(u);t.useEffect(()=>{w.current=u},[u]),t.useEffect(()=>{a.current=r},[r]);const T=t.useCallback(()=>{const e=R.current,i=window.scrollY||window.pageYOffset||0,l=document.documentElement.scrollTop||0,j=document.body.scrollTop||0,v=e?.scrollTop||0,S=Math.max(i,l,j,v);return e&&e.getBoundingClientRect().top>=56-5?!0:S<=5},[]),g=t.useCallback(e=>{a.current||T()&&(p.current=e.touches[0].clientY,o.current=!0)},[T]),b=t.useCallback(e=>{if(!o.current||a.current)return;const l=e.touches[0].clientY-p.current;if(l<0){c.current=0,n(0);return}l>5&&(e.preventDefault(),e.stopPropagation());const v=Math.min(l*.6,d);c.current=v,n(v)},[d]),x=t.useCallback(async()=>{if(!o.current)return;if(o.current=!1,c.current>=s&&!a.current){m(!0),a.current=!0,n(s);try{await w.current()}finally{m(!1),a.current=!1,c.current=0,n(0)}}else c.current=0,n(0)},[s]),y=t.useCallback(()=>{o.current=!1,c.current=0,n(0)},[]);t.useEffect(()=>{const e=R.current;if(!e)return;const i={passive:!1};return e.addEventListener("touchstart",g,i),e.addEventListener("touchmove",b,i),e.addEventListener("touchend",x,{passive:!0}),e.addEventListener("touchcancel",y,{passive:!0}),()=>{e.removeEventListener("touchstart",g),e.removeEventListener("touchmove",b),e.removeEventListener("touchend",x),e.removeEventListener("touchcancel",y)}},[g,b,x,y]);const P=Math.min(h/s,1);return{containerRef:R,isPulling:o.current,isRefreshing:r,pullDistance:h,progress:P}}function N({children:u,onRefresh:s,className:d}){const{containerRef:h,isRefreshing:n,pullDistance:r,progress:m}=C({onRefresh:s,threshold:80,maxPull:120}),p={overscrollBehavior:"none",WebkitOverflowScrolling:"touch"};return f.jsxs("div",{ref:h,className:E("relative",d),style:p,children:[f.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 z-50 flex items-center justify-center transition-opacity duration-200 pointer-events-none",style:{top:Math.max(r-50,8),opacity:r>20?1:0},children:f.jsx("div",{className:E("w-10 h-10 rounded-full bg-background/90 backdrop-blur-sm shadow-lg flex items-center justify-center border border-border/50",n&&"animate-pulse"),children:f.jsx(k,{className:E("w-5 h-5 text-primary transition-transform duration-200",n&&"animate-spin"),style:{transform:n?void 0:`rotate(${m*360}deg)`}})})}),f.jsx("div",{style:{transform:r>0?`translateY(${r}px)`:void 0,transition:r===0?"transform 0.3s ease-out":void 0},children:u})]})}export{N as P};
//# sourceMappingURL=PullToRefresh-CqIDJCa2.js.map
