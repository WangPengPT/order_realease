{"version":3,"file":"AdminUserSecurity-5d18Qb2c.js","sources":["../../src/hooks/useLoginLockouts.ts","../../src/pages/admin/AdminUserSecurity.tsx"],"sourcesContent":["import { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { toast } from \"sonner\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\ninterface LockedIP {\r\n  ip_address: string;\r\n  email: string | null;\r\n  failed_attempts: number;\r\n  last_attempt: string;\r\n  lockout_expires: string;\r\n}\r\n\r\nexport const useLoginLockouts = () => {\r\n  const { t } = useTranslation();\r\n  const queryClient = useQueryClient();\r\n\r\n  const { data: lockedIPs, isLoading, refetch } = useQuery({\r\n    queryKey: [\"login-lockouts\"],\r\n    queryFn: async () => {\r\n      const { data, error } = await supabase.rpc(\"admin_get_locked_ips\");\r\n      if (error) throw error;\r\n      return (data as LockedIP[]) || [];\r\n    },\r\n    refetchInterval: 30000, // Refresh every 30 seconds\r\n  });\r\n\r\n  const clearLockout = useMutation({\r\n    mutationFn: async ({ ip, email }: { ip?: string; email?: string }) => {\r\n      const { data, error } = await supabase.rpc(\"admin_clear_login_lockout\", {\r\n        p_ip_address: ip || null,\r\n        p_email: email || null,\r\n      });\r\n      if (error) throw error;\r\n      return data;\r\n    },\r\n    onSuccess: () => {\r\n      toast.success(t(\"admin.lockoutCleared\"));\r\n      queryClient.invalidateQueries({ queryKey: [\"login-lockouts\"] });\r\n    },\r\n    onError: () => {\r\n      toast.error(t(\"common.error\"));\r\n    },\r\n  });\r\n\r\n  return { lockedIPs, isLoading, clearLockout, refetch };\r\n};\r\n","import { useState, useMemo, useEffect } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from \"@/components/ui/dialog\";\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport { useAdminUsers, useBanUser, useUnbanUser, useMuteUser, useUnmuteUser } from \"@/hooks/useAdmin\";\r\nimport { useUserRole } from \"@/hooks/useUserRole\";\r\nimport { useInfiniteScroll } from \"@/hooks/useInfiniteScroll\";\r\nimport { useLoginLockouts } from \"@/hooks/useLoginLockouts\";\r\nimport { UserProfileDialog } from \"@/components/admin/UserProfileDialog\";\r\nimport { format } from \"date-fns\";\r\nimport {\r\n  Search,\r\n  Users,\r\n  Briefcase,\r\n  Shield,\r\n  ShieldAlert,\r\n  X,\r\n  Eye,\r\n  Ban,\r\n  UserCheck,\r\n  VolumeX,\r\n  Volume2,\r\n  Loader2,\r\n  Lock,\r\n  Unlock,\r\n  RefreshCw,\r\n} from \"lucide-react\";\r\n\r\nconst BAN_REASONS = [\r\n  \"spam\",\r\n  \"harassment\",\r\n  \"inappropriate_content\",\r\n  \"fraud\",\r\n  \"terms_violation\",\r\n  \"other\",\r\n];\r\n\r\nconst MUTE_REASONS = [\r\n  \"spam_comments\",\r\n  \"inappropriate_language\",\r\n  \"repeated_warnings\",\r\n  \"temporary_restriction\",\r\n  \"other\",\r\n];\r\n\r\nconst AdminUserSecurity = () => {\r\n  const { t } = useTranslation();\r\n  const { isAdmin } = useUserRole();\r\n  const { data: users, isLoading } = useAdminUsers();\r\n  const banUser = useBanUser();\r\n  const unbanUser = useUnbanUser();\r\n  const muteUser = useMuteUser();\r\n  const unmuteUser = useUnmuteUser();\r\n  const { lockedIPs, isLoading: isLoadingLockouts, clearLockout, refetch: refetchLockouts } = useLoginLockouts();\r\n  const [searchQuery, setSearchQuery] = useState(\"\");\r\n  const [banDialog, setBanDialog] = useState<{ open: boolean; userId: string; userName: string }>({\r\n    open: false,\r\n    userId: \"\",\r\n    userName: \"\",\r\n  });\r\n  const [banReasonType, setBanReasonType] = useState<string>(\"other\");\r\n  const [banReason, setBanReason] = useState(\"\");\r\n  const [muteDialog, setMuteDialog] = useState<{ open: boolean; userId: string; userName: string }>({\r\n    open: false,\r\n    userId: \"\",\r\n    userName: \"\",\r\n  });\r\n  const [muteReasonType, setMuteReasonType] = useState<string>(\"other\");\r\n  const [muteReason, setMuteReason] = useState(\"\");\r\n  const [muteDays, setMuteDays] = useState(\"7\");\r\n  const [userProfileDialog, setUserProfileDialog] = useState<{\r\n    open: boolean;\r\n    userId: string;\r\n    userName: string;\r\n    userRole: string;\r\n  }>({ open: false, userId: \"\", userName: \"\", userRole: \"\" });\r\n\r\n  // Calculate statistics\r\n  const stats = useMemo(() => {\r\n    if (!users) return { total: 0, banned: 0, muted: 0 };\r\n    return {\r\n      total: users.length,\r\n      banned: users.filter((u: any) => u.is_banned).length,\r\n      muted: users.filter((u: any) => u.is_muted).length,\r\n    };\r\n  }, [users]);\r\n\r\n  // Filter users\r\n  const filteredUsers = useMemo(() => {\r\n    if (!users) return [];\r\n    return users.filter((user: any) => {\r\n      const matchesSearch =\r\n        searchQuery === \"\" ||\r\n        user.display_name.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n        user.phone?.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n        user.email?.toLowerCase().includes(searchQuery.toLowerCase());\r\n      return matchesSearch;\r\n    });\r\n  }, [users, searchQuery]);\r\n\r\n  // Infinite scroll for users\r\n  const {\r\n    displayedData: displayedUsers,\r\n    hasMore,\r\n    reset: resetInfiniteScroll,\r\n    displayedCount,\r\n    sentinelRef,\r\n  } = useInfiniteScroll({\r\n    data: filteredUsers,\r\n    initialItemsPerPage: 30,\r\n    incrementPerPage: 30,\r\n  });\r\n\r\n  // Reset infinite scroll when search changes\r\n  useEffect(() => {\r\n    resetInfiniteScroll();\r\n  }, [searchQuery, resetInfiniteScroll]);\r\n\r\n  const getFinalBanReason = () => {\r\n    if (banReasonType === \"other\") {\r\n      return banReason;\r\n    }\r\n    return banReason ? `${t(`admin.banReasons.${banReasonType}`)}: ${banReason}` : t(`admin.banReasons.${banReasonType}`);\r\n  };\r\n\r\n  const getFinalMuteReason = () => {\r\n    if (muteReasonType === \"other\") {\r\n      return muteReason;\r\n    }\r\n    return muteReason ? `${t(`admin.muteReasons.${muteReasonType}`)}: ${muteReason}` : t(`admin.muteReasons.${muteReasonType}`);\r\n  };\r\n\r\n  const handleBan = () => {\r\n    if (!banDialog.userId) return;\r\n    banUser.mutate(\r\n      { userId: banDialog.userId, banReason: getFinalBanReason() },\r\n      {\r\n        onSuccess: () => {\r\n          setBanDialog({ open: false, userId: \"\", userName: \"\" });\r\n          setBanReasonType(\"other\");\r\n          setBanReason(\"\");\r\n        },\r\n      }\r\n    );\r\n  };\r\n\r\n  const handleMute = () => {\r\n    if (!muteDialog.userId) return;\r\n    const mutedUntil = muteDays\r\n      ? new Date(Date.now() + parseInt(muteDays) * 24 * 60 * 60 * 1000).toISOString()\r\n      : undefined;\r\n    muteUser.mutate(\r\n      { userId: muteDialog.userId, muteReason: getFinalMuteReason(), mutedUntil },\r\n      {\r\n        onSuccess: () => {\r\n          setMuteDialog({ open: false, userId: \"\", userName: \"\" });\r\n          setMuteReasonType(\"other\");\r\n          setMuteReason(\"\");\r\n          setMuteDays(\"7\");\r\n        },\r\n      }\r\n    );\r\n  };\r\n\r\n  const getRoleBadgeColor = (role: string) => {\r\n    switch (role) {\r\n      case \"admin\":\r\n        return \"bg-primary text-primary-foreground\";\r\n      case \"supervisor\":\r\n        return \"bg-blue-500 text-white\";\r\n      case \"merchant\":\r\n        return \"bg-emerald-500 text-white\";\r\n      default:\r\n        return \"bg-muted text-muted-foreground\";\r\n    }\r\n  };\r\n\r\n  const getRoleIcon = (role: string) => {\r\n    switch (role) {\r\n      case \"admin\":\r\n      case \"supervisor\":\r\n        return <Shield className=\"h-3.5 w-3.5\" />;\r\n      case \"merchant\":\r\n        return <Briefcase className=\"h-3.5 w-3.5\" />;\r\n      default:\r\n        return <Users className=\"h-3.5 w-3.5\" />;\r\n    }\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-[60vh]\">\r\n        <div className=\"text-center space-y-3\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto\"></div>\r\n          <p className=\"text-muted-foreground\">{t(\"common.loading\")}</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div>\r\n        <div className=\"flex items-center gap-3 mb-2\">\r\n          <div className=\"p-2 bg-primary/10 rounded-lg\">\r\n            <ShieldAlert className=\"h-6 w-6 text-primary\" />\r\n          </div>\r\n          <div>\r\n            <h1 className=\"text-3xl font-bold tracking-tight\">{t(\"admin.userSecurity\")}</h1>\r\n            <p className=\"text-muted-foreground\">{t(\"admin.userSecurityDesc\")}</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Statistics Cards */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n        <Card className=\"bg-gradient-to-br from-primary/5 to-primary/10 border-primary/20\">\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm font-medium text-muted-foreground\">{t(\"admin.totalUsersLabel\")}</p>\r\n                <p className=\"text-2xl font-bold\">{stats.total}</p>\r\n              </div>\r\n              <Users className=\"h-8 w-8 text-primary/60\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"bg-gradient-to-br from-orange-50 to-orange-100 border-orange-200 dark:from-orange-950/20 dark:to-orange-900/20 dark:border-orange-900/30\">\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm font-medium text-muted-foreground\">{t(\"admin.bannedCount\")}</p>\r\n                <p className=\"text-2xl font-bold\">{stats.banned}</p>\r\n              </div>\r\n              <Ban className=\"h-8 w-8 text-orange-500\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card className=\"bg-gradient-to-br from-yellow-50 to-yellow-100 border-yellow-200 dark:from-yellow-950/20 dark:to-yellow-900/20 dark:border-yellow-900/30\">\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm font-medium text-muted-foreground\">{t(\"admin.mutedCount\")}</p>\r\n                <p className=\"text-2xl font-bold\">{stats.muted}</p>\r\n              </div>\r\n              <VolumeX className=\"h-8 w-8 text-yellow-500\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Login Lockouts Section */}\r\n      <Card>\r\n        <CardHeader className=\"pb-3\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <Lock className=\"h-5 w-5 text-red-500\" />\r\n              <div>\r\n                <CardTitle className=\"text-lg\">{t(\"admin.loginLockouts\")}</CardTitle>\r\n                <CardDescription>{t(\"admin.loginLockoutsDesc\")}</CardDescription>\r\n              </div>\r\n            </div>\r\n            <Button\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => refetchLockouts()}\r\n              disabled={isLoadingLockouts}\r\n            >\r\n              <RefreshCw className={`h-4 w-4 mr-1 ${isLoadingLockouts ? \"animate-spin\" : \"\"}`} />\r\n              {t(\"common.refresh\")}\r\n            </Button>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent>\r\n          {isLoadingLockouts ? (\r\n            <div className=\"flex justify-center py-4\">\r\n              <Loader2 className=\"h-6 w-6 animate-spin text-muted-foreground\" />\r\n            </div>\r\n          ) : !lockedIPs || lockedIPs.length === 0 ? (\r\n            <p className=\"text-muted-foreground text-center py-4\">\r\n              {t(\"admin.noLockedIPs\")}\r\n            </p>\r\n          ) : (\r\n            <div className=\"space-y-3\">\r\n              {lockedIPs.map((item) => (\r\n                <div \r\n                  key={item.ip_address} \r\n                  className=\"flex items-center justify-between p-3 bg-red-50 dark:bg-red-950/20 rounded-lg border border-red-200 dark:border-red-900/30\"\r\n                >\r\n                  <div className=\"min-w-0 flex-1\">\r\n                    <p className=\"font-mono text-sm truncate\">{item.ip_address}</p>\r\n                    {item.email && (\r\n                      <p className=\"text-sm text-muted-foreground truncate\">{item.email}</p>\r\n                    )}\r\n                    <p className=\"text-xs text-muted-foreground\">\r\n                      {t(\"admin.failedAttempts\")}: {item.failed_attempts} | {t(\"admin.expiresAt\")}: {format(new Date(item.lockout_expires), \"HH:mm:ss\")}\r\n                    </p>\r\n                  </div>\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    onClick={() => clearLockout.mutate({ ip: item.ip_address })}\r\n                    disabled={clearLockout.isPending}\r\n                    className=\"ml-2 shrink-0\"\r\n                  >\r\n                    {clearLockout.isPending ? (\r\n                      <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n                    ) : (\r\n                      <>\r\n                        <Unlock className=\"h-4 w-4 mr-1\" />\r\n                        {t(\"admin.unlock\")}\r\n                      </>\r\n                    )}\r\n                  </Button>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Search */}\r\n      <Card>\r\n        <CardContent className=\"pt-6\">\r\n          <div className=\"relative\">\r\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\r\n            <Input\r\n              placeholder={t(\"admin.searchUserPlaceholder\")}\r\n              value={searchQuery}\r\n              onChange={(e) => setSearchQuery(e.target.value)}\r\n              className=\"pl-10 pr-10\"\r\n            />\r\n            {searchQuery && (\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"sm\"\r\n                className=\"absolute right-1 top-1/2 transform -translate-y-1/2 h-7 w-7 p-0\"\r\n                onClick={() => setSearchQuery(\"\")}\r\n              >\r\n                <X className=\"h-4 w-4\" />\r\n              </Button>\r\n            )}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* User List */}\r\n      <div className=\"space-y-4\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <Badge variant=\"secondary\" className=\"text-xs\">\r\n            {displayedCount} / {filteredUsers?.length || 0} {t(\"admin.totalUsersLabel\")}\r\n          </Badge>\r\n        </div>\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n        {displayedUsers?.map((user: any) => (\r\n          <Card\r\n            key={user.id}\r\n            className={`transition-all duration-200 hover:shadow-md ${\r\n              user.is_banned ? \"border-orange-300 bg-orange-50/50 dark:bg-orange-950/20\" : \"\"\r\n            } ${user.is_muted ? \"border-yellow-300 bg-yellow-50/50 dark:bg-yellow-950/20\" : \"\"}`}\r\n          >\r\n            <CardContent className=\"p-4\">\r\n              <div className=\"flex items-start gap-3\">\r\n                <Avatar className=\"h-12 w-12\">\r\n                  <AvatarImage src={user.avatar_url} alt={user.display_name} />\r\n                  <AvatarFallback>{user.display_name.charAt(0).toUpperCase()}</AvatarFallback>\r\n                </Avatar>\r\n                <div className=\"flex-1 min-w-0\">\r\n                  <div className=\"flex items-center gap-2 flex-wrap\">\r\n                    <h3 className=\"font-semibold truncate\">{user.display_name}</h3>\r\n                    {user.is_banned && (\r\n                      <Badge variant=\"outline\" className=\"text-xs text-orange-500 border-orange-300\">\r\n                        {t(\"admin.banned\")}\r\n                      </Badge>\r\n                    )}\r\n                    {user.is_muted && (\r\n                      <Badge variant=\"outline\" className=\"text-xs text-yellow-500 border-yellow-300\">\r\n                        {t(\"admin.muted\")}\r\n                      </Badge>\r\n                    )}\r\n                  </div>\r\n                  <p className=\"text-sm text-muted-foreground truncate\">{user.email}</p>\r\n                  <Badge className={`${getRoleBadgeColor(user.role)} text-xs mt-1`}>\r\n                    {getRoleIcon(user.role)}\r\n                    <span className=\"ml-1 capitalize\">{user.role}</span>\r\n                  </Badge>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Action Buttons */}\r\n              <div className=\"flex flex-wrap gap-2 mt-4 pt-3 border-t\">\r\n                <Button\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  onClick={() =>\r\n                    setUserProfileDialog({\r\n                      open: true,\r\n                      userId: user.id,\r\n                      userName: user.display_name,\r\n                      userRole: user.role,\r\n                    })\r\n                  }\r\n                >\r\n                  <Eye className=\"h-4 w-4 mr-1\" />\r\n                  {t(\"admin.viewProfile\")}\r\n                </Button>\r\n\r\n                {isAdmin && user.role !== \"admin\" && (\r\n                  <>\r\n                    {user.is_banned ? (\r\n                      <Button\r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                        className=\"text-green-600 border-green-300 hover:bg-green-50\"\r\n                        onClick={() => unbanUser.mutate(user.id)}\r\n                      >\r\n                        <UserCheck className=\"h-4 w-4 mr-1\" />\r\n                        {t(\"admin.unban\")}\r\n                      </Button>\r\n                    ) : (\r\n                      <Button\r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                        className=\"text-orange-600 border-orange-300 hover:bg-orange-50\"\r\n                        onClick={() =>\r\n                          setBanDialog({ open: true, userId: user.id, userName: user.display_name })\r\n                        }\r\n                      >\r\n                        <Ban className=\"h-4 w-4 mr-1\" />\r\n                        {t(\"admin.ban\")}\r\n                      </Button>\r\n                    )}\r\n\r\n                    {user.is_muted ? (\r\n                      <Button\r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                        className=\"text-green-600 border-green-300 hover:bg-green-50\"\r\n                        onClick={() => unmuteUser.mutate(user.id)}\r\n                      >\r\n                        <Volume2 className=\"h-4 w-4 mr-1\" />\r\n                        {t(\"admin.unmute\")}\r\n                      </Button>\r\n                    ) : (\r\n                      <Button\r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                        className=\"text-yellow-600 border-yellow-300 hover:bg-yellow-50\"\r\n                        onClick={() =>\r\n                          setMuteDialog({ open: true, userId: user.id, userName: user.display_name })\r\n                        }\r\n                      >\r\n                        <VolumeX className=\"h-4 w-4 mr-1\" />\r\n                        {t(\"admin.mute\")}\r\n                      </Button>\r\n                    )}\r\n                  </>\r\n                )}\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        ))}\r\n        </div>\r\n\r\n        {/* Infinite scroll sentinel */}\r\n        {hasMore && (\r\n          <div ref={sentinelRef} className=\"flex justify-center py-4\">\r\n            <Loader2 className=\"h-6 w-6 animate-spin text-muted-foreground\" />\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {filteredUsers?.length === 0 && (\r\n        <div className=\"text-center py-12 text-muted-foreground\">{t(\"admin.noUsersFound\")}</div>\r\n      )}\r\n\r\n      {/* Ban Dialog */}\r\n      <Dialog open={banDialog.open} onOpenChange={(open) => setBanDialog({ ...banDialog, open })}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>{t(\"admin.banUser\")}</DialogTitle>\r\n            <DialogDescription>\r\n              {t(\"admin.banUserConfirm\", { name: banDialog.userName })}\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          <div className=\"space-y-4\">\r\n            <div>\r\n              <label className=\"text-sm font-medium\">{t(\"admin.selectBanReason\")}</label>\r\n              <Select value={banReasonType} onValueChange={setBanReasonType}>\r\n                <SelectTrigger className=\"mt-1\">\r\n                  <SelectValue />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  {BAN_REASONS.map((reason) => (\r\n                    <SelectItem key={reason} value={reason}>\r\n                      {t(`admin.banReasons.${reason}`)}\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n            <div>\r\n              <label className=\"text-sm font-medium\">{t(\"admin.additionalDetails\")}</label>\r\n              <Textarea\r\n                placeholder={t(\"admin.banReasonPlaceholder\")}\r\n                value={banReason}\r\n                onChange={(e) => setBanReason(e.target.value)}\r\n                className=\"mt-1\"\r\n              />\r\n            </div>\r\n          </div>\r\n          <DialogFooter>\r\n            <Button variant=\"outline\" onClick={() => setBanDialog({ open: false, userId: \"\", userName: \"\" })}>\r\n              {t(\"common.cancel\")}\r\n            </Button>\r\n            <Button variant=\"destructive\" onClick={handleBan}>\r\n              {t(\"admin.confirmBan\")}\r\n            </Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Mute Dialog */}\r\n      <Dialog open={muteDialog.open} onOpenChange={(open) => setMuteDialog({ ...muteDialog, open })}>\r\n        <DialogContent>\r\n          <DialogHeader>\r\n            <DialogTitle>{t(\"admin.muteUser\")}</DialogTitle>\r\n            <DialogDescription>\r\n              {t(\"admin.muteUserConfirm\", { name: muteDialog.userName })}\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          <div className=\"space-y-4\">\r\n            <div>\r\n              <label className=\"text-sm font-medium\">{t(\"admin.muteDuration\")}</label>\r\n              <Input\r\n                type=\"number\"\r\n                placeholder=\"7\"\r\n                value={muteDays}\r\n                onChange={(e) => setMuteDays(e.target.value)}\r\n                className=\"mt-1\"\r\n              />\r\n              <p className=\"text-xs text-muted-foreground mt-1\">{t(\"admin.muteDurationHint\")}</p>\r\n            </div>\r\n            <div>\r\n              <label className=\"text-sm font-medium\">{t(\"admin.selectMuteReason\")}</label>\r\n              <Select value={muteReasonType} onValueChange={setMuteReasonType}>\r\n                <SelectTrigger className=\"mt-1\">\r\n                  <SelectValue />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  {MUTE_REASONS.map((reason) => (\r\n                    <SelectItem key={reason} value={reason}>\r\n                      {t(`admin.muteReasons.${reason}`)}\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n            <div>\r\n              <label className=\"text-sm font-medium\">{t(\"admin.additionalDetails\")}</label>\r\n              <Textarea\r\n                placeholder={t(\"admin.muteReasonPlaceholder\")}\r\n                value={muteReason}\r\n                onChange={(e) => setMuteReason(e.target.value)}\r\n                className=\"mt-1\"\r\n              />\r\n            </div>\r\n          </div>\r\n          <DialogFooter>\r\n            <Button variant=\"outline\" onClick={() => setMuteDialog({ open: false, userId: \"\", userName: \"\" })}>\r\n              {t(\"common.cancel\")}\r\n            </Button>\r\n            <Button variant=\"destructive\" onClick={handleMute}>\r\n              {t(\"admin.confirmMute\")}\r\n            </Button>\r\n          </DialogFooter>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* User Profile Dialog */}\r\n      <UserProfileDialog\r\n        open={userProfileDialog.open}\r\n        onOpenChange={(open) => setUserProfileDialog({ ...userProfileDialog, open })}\r\n        userId={userProfileDialog.userId}\r\n        userName={userProfileDialog.userName}\r\n        userRole={userProfileDialog.userRole}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdminUserSecurity;\r\n"],"names":["useLoginLockouts","t","useTranslation","queryClient","useQueryClient","lockedIPs","isLoading","refetch","useQuery","data","error","supabase","clearLockout","useMutation","ip","email","toast","BAN_REASONS","MUTE_REASONS","AdminUserSecurity","isAdmin","useUserRole","users","useAdminUsers","banUser","useBanUser","unbanUser","useUnbanUser","muteUser","useMuteUser","unmuteUser","useUnmuteUser","isLoadingLockouts","refetchLockouts","searchQuery","setSearchQuery","useState","banDialog","setBanDialog","banReasonType","setBanReasonType","banReason","setBanReason","muteDialog","setMuteDialog","muteReasonType","setMuteReasonType","muteReason","setMuteReason","muteDays","setMuteDays","userProfileDialog","setUserProfileDialog","stats","useMemo","u","filteredUsers","user","displayedUsers","hasMore","resetInfiniteScroll","displayedCount","sentinelRef","useInfiniteScroll","useEffect","getFinalBanReason","getFinalMuteReason","handleBan","handleMute","mutedUntil","getRoleBadgeColor","role","getRoleIcon","jsx","Shield","Briefcase","Users","jsxs","ShieldAlert","Card","CardContent","Ban","VolumeX","CardHeader","Lock","CardTitle","CardDescription","Button","RefreshCw","Loader2","item","format","Fragment","Unlock","Search","Input","e","X","Badge","Avatar","AvatarImage","AvatarFallback","Eye","UserCheck","Volume2","Dialog","open","DialogContent","DialogHeader","DialogTitle","DialogDescription","Select","SelectTrigger","SelectValue","SelectContent","reason","SelectItem","Textarea","DialogFooter","UserProfileDialog"],"mappings":"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"}