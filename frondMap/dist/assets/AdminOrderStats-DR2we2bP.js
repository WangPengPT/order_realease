import{c as Ce,bl as E,u as Oe,r as C,q as H,j as e,ah as Pe,ai as qe,aj as Ke,ak as Ie,al as _,B as A,a as V,b as ne,C as o,e as x,p as h,f as u,d as j,ap as K,a0 as U,o as p,D as de,v as le,a6 as ie,a7 as ce,a8 as $e,av as z,P as Fe,as as Ee,bw as v,s as W}from"./index-DjxB8hoH.js";import{T as me,a as oe,b as R,c,d as xe,e as l}from"./table-D2Ai0bSV.js";import{T as He,a as Ve,b as X,c as Y}from"./tabs-CPsYcXOy.js";import{P as he,a as ue,b as je}from"./popover-HRbAg6NF.js";import{C as pe}from"./calendar-C6B-cY9t.js";import{R as Ue}from"./refresh-cw-CC4JaQgs.js";import{S as G}from"./shopping-bag-DaZMDb5P.js";import{C as I}from"./calendar-check-DTGAHH6-.js";import{T as ze}from"./trending-up-Bt5d3ZDd.js";import{R as Q,L as We,C as fe,X as Ne,Y as ge,T as J,b as ye,c as Xe,B as ve}from"./LineChart-Cb0Xkix_.js";import{P as Ye,a as Ge}from"./PieChart-BE9t-GDe.js";import{B as Qe}from"./BarChart-B2PaSDSI.js";import{E as be}from"./eye-jy74Z629.js";import{C as Je}from"./clock-BQoUQVhd.js";import{I as Ze}from"./info-Bdh6Cerq.js";import{f as B}from"./format-0Ztyy0_D.js";import{s as k}from"./startOfDay-DwrePYsk.js";import{s as L}from"./subDays-djY9yzJX.js";import"./chevron-left-BVUAV8vX.js";import"./isEqual-B3G6uj_h.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=Ce("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=Ce("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);function Se(a,M){const O=+E(a),[f,$]=[+E(M.start),+E(M.end)].sort((N,F)=>N-F);return O>=f&&O<=$}const De=["hsl(var(--primary))","hsl(var(--chart-2))","hsl(var(--chart-3))","hsl(var(--chart-4))","hsl(var(--chart-5))"],bs=()=>{const{t:a}=Oe(),[M,O]=C.useState("overview"),[f,$]=C.useState("all"),[N,F]=C.useState(void 0),[D,_e]=C.useState(void 0),[t,Z]=C.useState(null),[i,ee]=C.useState(null),ke=()=>{const s=new Date;switch(f){case"today":return{start:k(s),end:v(s)};case"7days":return{start:k(L(s,6)),end:v(s)};case"30days":return{start:k(L(s,29)),end:v(s)};case"90days":return{start:k(L(s,89)),end:v(s)};case"180days":return{start:k(L(s,179)),end:v(s)};case"all":return{start:new Date(2020,0,1),end:v(s)};case"custom":return{start:N?k(N):k(L(s,29)),end:D?v(D):v(s)};default:return{start:new Date(2020,0,1),end:v(s)}}},{data:T,isLoading:Te,refetch:Re}=H({queryKey:["external-stats-info"],queryFn:async()=>{const{data:s,error:r}=await W.functions.invoke("external-stats-api",{body:{action:"get_info"}});if(r)throw r;return s},refetchInterval:3e3}),{data:P,isLoading:se,refetch:Ae}=H({queryKey:["external-orders-data"],queryFn:async()=>{const{data:s,error:r}=await W.functions.invoke("external-stats-api",{body:{action:"query_data",table:"order",query:{name:{$regex:"^T"}},count:1e4}});if(r)throw r;return Array.isArray(s)?s:[]},refetchInterval:3e3}),{data:q,isLoading:ae,refetch:Be}=H({queryKey:["external-reserves-data"],queryFn:async()=>{const{data:s,error:r}=await W.functions.invoke("external-stats-api",{body:{action:"query_data",table:"reserve",count:1e4}});if(r)throw r;return Array.isArray(s)?s:[]},refetchInterval:3e3}),{filteredOrders:g,filteredReserves:b}=C.useMemo(()=>{const{start:s,end:r}=ke(),y=((P==null?void 0:P.filter(n=>{if(!n.created_at)return!1;const d=new Date(n.created_at);return Se(d,{start:s,end:r})}))||[]).sort((n,d)=>{const S=n.created_at?new Date(n.created_at).getTime():0;return(d.created_at?new Date(d.created_at).getTime():0)-S}),w=((q==null?void 0:q.filter(n=>{const d=n.created_at||n.date;if(!d)return!1;const S=new Date(d);return Se(S,{start:s,end:r})}))||[]).sort((n,d)=>{const S=n.date?new Date(n.date).getTime():0;return(d.date?new Date(d.date).getTime():0)-S});return{filteredOrders:y,filteredReserves:w}},[P,q,f,N,D]),Le=()=>{Re(),Ae(),Be()},m=Te||se||ae,te=(()=>{const s={},r={};g.forEach(n=>{const d=n.created_at?B(new Date(n.created_at),"MM-dd"):"Unknown";s[d]=(s[d]||0)+1}),b.forEach(n=>{const d=n.created_at||n.date,S=d?B(new Date(d),"MM-dd"):"Unknown";r[S]=(r[S]||0)+1});const y=[...new Set([...Object.keys(s),...Object.keys(r)])].sort(),w=f==="today"?1:f==="7days"?7:f==="30days"?14:30;return y.slice(-w).map(n=>({date:n,orders:s[n]||0,reserves:r[n]||0}))})(),re=[{name:a("admin.orderStats.orders","外卖订单"),value:g.length},{name:a("admin.orderStats.reserves","订台预约"),value:b.length}];return e.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:a("admin.orderStats.title","外卖订台统计")}),e.jsx("p",{className:"text-muted-foreground",children:a("admin.orderStats.description","查看外卖订单和订台预约数据")})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Pe,{value:f,onValueChange:s=>$(s),children:[e.jsx(qe,{className:"w-[140px]",children:e.jsx(Ke,{})}),e.jsxs(Ie,{children:[e.jsx(_,{value:"all",children:a("admin.orderStats.allTime","全部")}),e.jsx(_,{value:"today",children:a("admin.orderStats.today","今天")}),e.jsx(_,{value:"7days",children:a("admin.orderStats.last7Days","最近7天")}),e.jsx(_,{value:"30days",children:a("admin.orderStats.last30Days","最近30天")}),e.jsx(_,{value:"90days",children:a("admin.orderStats.last90Days","最近90天")}),e.jsx(_,{value:"180days",children:a("admin.orderStats.last180Days","最近半年")}),e.jsx(_,{value:"custom",children:a("admin.orderStats.customRange","自定义")})]})]}),f==="custom"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(he,{children:[e.jsx(ue,{asChild:!0,children:e.jsxs(A,{variant:"outline",className:V("w-[130px] justify-start text-left font-normal",!N&&"text-muted-foreground"),children:[e.jsx(ne,{className:"mr-2 h-4 w-4"}),N?B(N,"yyyy-MM-dd"):a("admin.orderStats.startDate","开始日期")]})}),e.jsx(je,{className:"w-auto p-0",align:"start",children:e.jsx(pe,{mode:"single",selected:N,onSelect:F,initialFocus:!0})})]}),e.jsx("span",{className:"text-muted-foreground",children:"-"}),e.jsxs(he,{children:[e.jsx(ue,{asChild:!0,children:e.jsxs(A,{variant:"outline",className:V("w-[130px] justify-start text-left font-normal",!D&&"text-muted-foreground"),children:[e.jsx(ne,{className:"mr-2 h-4 w-4"}),D?B(D,"yyyy-MM-dd"):a("admin.orderStats.endDate","结束日期")]})}),e.jsx(je,{className:"w-auto p-0",align:"start",children:e.jsx(pe,{mode:"single",selected:D,onSelect:_e,initialFocus:!0})})]})]}),e.jsxs(A,{onClick:Le,variant:"outline",disabled:m,children:[e.jsx(Ue,{className:`h-4 w-4 mr-2 ${m?"animate-spin":""}`}),a("common.refresh","刷新")]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(o,{className:"border-primary/30 bg-primary/5",children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(h,{className:"text-sm font-medium",children:a("admin.orderStats.totalOrders","外卖总订单")}),e.jsx(G,{className:"h-5 w-5 text-primary"})]}),e.jsx(u,{children:m?e.jsx(j,{className:"h-10 w-24"}):e.jsx("div",{className:"text-3xl font-bold text-primary",children:(T==null?void 0:T.order_count)??0})})]}),e.jsxs(o,{className:"border-chart-2/30 bg-chart-2/5",children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(h,{className:"text-sm font-medium",children:a("admin.orderStats.totalReserves","订台总预约")}),e.jsx(I,{className:"h-5 w-5 text-chart-2"})]}),e.jsx(u,{children:m?e.jsx(j,{className:"h-10 w-24"}):e.jsx("div",{className:"text-3xl font-bold text-chart-2",children:(T==null?void 0:T.reserve_count)??0})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(o,{children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(h,{className:"text-sm font-medium",children:a("admin.orderStats.periodOrders","期间外卖订单")}),e.jsx(G,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(u,{children:m?e.jsx(j,{className:"h-8 w-20"}):e.jsx("div",{className:"text-2xl font-bold",children:g.length})})]}),e.jsxs(o,{children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(h,{className:"text-sm font-medium",children:a("admin.orderStats.periodReserves","期间订台预约")}),e.jsx(I,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(u,{children:m?e.jsx(j,{className:"h-8 w-20"}):e.jsx("div",{className:"text-2xl font-bold",children:b.length})})]}),e.jsxs(o,{children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(h,{className:"text-sm font-medium",children:a("admin.orderStats.periodTotal","期间总交易")}),e.jsx(ze,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(u,{children:m?e.jsx(j,{className:"h-8 w-20"}):e.jsx("div",{className:"text-2xl font-bold",children:g.length+b.length})})]}),e.jsxs(o,{children:[e.jsxs(x,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(h,{className:"text-sm font-medium",children:a("admin.orderStats.ratio","订单占比")}),e.jsx(we,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(u,{children:m?e.jsx(j,{className:"h-8 w-20"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-2xl font-bold",children:g.length+b.length>0?`${Math.round(g.length/(g.length+b.length)*100)}%`:"0%"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a("admin.orderStats.orderVsReserve","外卖 vs 订台")})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(o,{className:"lg:col-span-2",children:[e.jsxs(x,{children:[e.jsx(h,{children:a("admin.orderStats.trendChart","趋势图")}),e.jsx(K,{children:a("admin.orderStats.selectedPeriod","所选时间段数据")})]}),e.jsx(u,{children:m?e.jsx(j,{className:"h-[300px] w-full"}):e.jsx(Q,{width:"100%",height:300,children:e.jsxs(We,{data:te,children:[e.jsx(fe,{strokeDasharray:"3 3",className:"stroke-muted"}),e.jsx(Ne,{dataKey:"date",className:"text-xs"}),e.jsx(ge,{className:"text-xs"}),e.jsx(J,{contentStyle:{backgroundColor:"hsl(var(--background))",border:"1px solid hsl(var(--border))",borderRadius:"8px"}}),e.jsx(ye,{type:"monotone",dataKey:"orders",stroke:"hsl(var(--primary))",strokeWidth:2,name:a("admin.orderStats.orders","外卖订单")}),e.jsx(ye,{type:"monotone",dataKey:"reserves",stroke:"hsl(var(--chart-2))",strokeWidth:2,name:a("admin.orderStats.reserves","订台预约")})]})})})]}),e.jsxs(o,{children:[e.jsxs(x,{children:[e.jsx(h,{children:a("admin.orderStats.distribution","分布")}),e.jsx(K,{children:a("admin.orderStats.orderTypeRatio","订单类型占比")})]}),e.jsx(u,{children:m?e.jsx(j,{className:"h-[300px] w-full"}):e.jsx(Q,{width:"100%",height:300,children:e.jsxs(Ye,{children:[e.jsx(Ge,{data:re,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:5,dataKey:"value",label:({name:s,percent:r})=>`${s} ${(r*100).toFixed(0)}%`,children:re.map((s,r)=>e.jsx(Xe,{fill:De[r%De.length]},`cell-${r}`))}),e.jsx(J,{contentStyle:{backgroundColor:"hsl(var(--background))",border:"1px solid hsl(var(--border))",borderRadius:"8px"}})]})})})]})]}),e.jsxs(He,{value:M,onValueChange:s=>O(s),children:[e.jsxs(Ve,{children:[e.jsx(X,{value:"overview",children:a("admin.orderStats.overview","概览")}),e.jsx(X,{value:"orders",children:a("admin.orderStats.ordersList","外卖订单")}),e.jsx(X,{value:"reserves",children:a("admin.orderStats.reservesList","订台预约")})]}),e.jsx(Y,{value:"overview",children:e.jsxs(o,{children:[e.jsx(x,{children:e.jsx(h,{children:a("admin.orderStats.dailyStats","每日统计")})}),e.jsx(u,{children:m?e.jsx(j,{className:"h-[300px] w-full"}):e.jsx(Q,{width:"100%",height:300,children:e.jsxs(Qe,{data:te,children:[e.jsx(fe,{strokeDasharray:"3 3",className:"stroke-muted"}),e.jsx(Ne,{dataKey:"date",className:"text-xs"}),e.jsx(ge,{className:"text-xs"}),e.jsx(J,{contentStyle:{backgroundColor:"hsl(var(--background))",border:"1px solid hsl(var(--border))",borderRadius:"8px"}}),e.jsx(ve,{dataKey:"orders",fill:"hsl(var(--primary))",name:a("admin.orderStats.orders","外卖订单")}),e.jsx(ve,{dataKey:"reserves",fill:"hsl(var(--chart-2))",name:a("admin.orderStats.reserves","订台预约")})]})})})]})}),e.jsx(Y,{value:"orders",children:e.jsxs(o,{children:[e.jsxs(x,{children:[e.jsx(h,{children:a("admin.orderStats.recentOrders","最近外卖订单")}),e.jsx(K,{children:a("admin.orderStats.showingRecent","显示最近的订单记录")})]}),e.jsx(u,{children:se?e.jsx(j,{className:"h-[400px] w-full"}):e.jsx(U,{className:"h-[400px]",children:e.jsxs(me,{children:[e.jsx(oe,{children:e.jsxs(R,{children:[e.jsx(c,{children:a("admin.orderStats.orderNumber","订单号")}),e.jsx(c,{children:a("admin.orderStats.customer","客户")}),e.jsx(c,{children:a("admin.orderStats.restaurant","餐厅")}),e.jsx(c,{className:"text-right",children:a("admin.orderStats.amount","金额")}),e.jsx(c,{children:a("admin.orderStats.pickupTime","取餐时间")}),e.jsx(c,{children:a("admin.orderStats.paymentStatus","支付状态")}),e.jsx(c,{})]})}),e.jsxs(xe,{children:[g.slice(0,50).map((s,r)=>{var y,w;return e.jsxs(R,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>Z(s),children:[e.jsx(l,{className:"font-mono text-xs",children:s.name||`#${r+1}`}),e.jsx(l,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-medium",children:((y=s.customer)==null?void 0:y.name)||"-"}),e.jsx("span",{className:"text-xs text-muted-foreground truncate max-w-[150px]",children:((w=s.customer)==null?void 0:w.email)||""})]})}),e.jsx(l,{children:e.jsx("span",{className:"text-xs",children:s.restaurant||"-"})}),e.jsxs(l,{className:"text-right font-medium",children:["€",s.total_price||"0"]}),e.jsx(l,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs",children:s.pickupDate||s.pickup_date||"-"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.pickupTime||""})]})}),e.jsx(l,{children:e.jsx(p,{variant:s.pay_state==="paid"?"default":"secondary",className:V("text-xs",s.pay_state==="paid"&&"bg-green-500"),children:s.pay_state==="paid"?"已付款":s.pay_state||"pending"})}),e.jsx(l,{children:e.jsx(A,{variant:"ghost",size:"sm",className:"h-7",children:e.jsx(be,{className:"h-4 w-4"})})})]},s.id||r)}),g.length===0&&e.jsx(R,{children:e.jsx(l,{colSpan:7,className:"text-center text-muted-foreground",children:a("common.noData","暂无数据")})})]})]})})})]})}),e.jsx(Y,{value:"reserves",children:e.jsxs(o,{children:[e.jsxs(x,{children:[e.jsx(h,{children:a("admin.orderStats.recentReserves","最近订台预约")}),e.jsx(K,{children:a("admin.orderStats.showingRecent","显示最近的预约记录")})]}),e.jsx(u,{children:ae?e.jsx(j,{className:"h-[400px] w-full"}):e.jsx(U,{className:"h-[400px]",children:e.jsxs(me,{children:[e.jsx(oe,{children:e.jsxs(R,{children:[e.jsx(c,{children:a("admin.orderStats.customerName","预订人")}),e.jsx(c,{children:a("admin.orderStats.restaurant","餐厅")}),e.jsx(c,{children:a("admin.orderStats.reserveDateTime","预约日期/时间")}),e.jsx(c,{className:"text-center",children:a("admin.orderStats.guests","人数")}),e.jsx(c,{children:a("common.status","状态")}),e.jsx(c,{})]})}),e.jsxs(xe,{children:[b.slice(0,50).map((s,r)=>e.jsxs(R,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>ee(s),children:[e.jsx(l,{className:"font-medium",children:s.customerName||"-"}),e.jsx(l,{className:"max-w-[150px] truncate",children:s.restaurant||"-"}),e.jsx(l,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm",children:s.date||"-"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.time||"-"})]})}),e.jsx(l,{className:"text-center",children:e.jsx(p,{variant:"outline",children:s.numberPeople||s.guests||"-"})}),e.jsx(l,{children:e.jsx(p,{variant:s.status==="confirmed"?"default":"secondary",children:s.status||"pending"})}),e.jsx(l,{children:e.jsx(A,{variant:"ghost",size:"sm",className:"h-7",children:e.jsx(be,{className:"h-4 w-4"})})})]},s.id||r)),b.length===0&&e.jsx(R,{children:e.jsx(l,{colSpan:6,className:"text-center text-muted-foreground",children:a("common.noData","暂无数据")})})]})]})})})]})})]}),e.jsx(de,{open:!!t,onOpenChange:s=>!s&&Z(null),children:e.jsxs(le,{className:"max-w-2xl max-h-[85vh] overflow-hidden",children:[e.jsxs(ie,{children:[e.jsxs(ce,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5 text-primary"}),a("admin.orderStats.orderDetail","外卖订单详情")]}),e.jsxs($e,{className:"flex items-center gap-2",children:[(t==null?void 0:t.name)&&e.jsx(p,{variant:"outline",className:"font-mono",children:t.name}),(t==null?void 0:t.pay_state)&&e.jsx(p,{variant:t.pay_state==="paid"?"default":"secondary",className:t.pay_state==="paid"?"bg-green-500":"",children:t.pay_state==="paid"?"已付款":t.pay_state})]})]}),t&&e.jsx(U,{className:"max-h-[65vh] pr-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-lg border bg-primary/5 p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"订单总额"}),e.jsxs("p",{className:"text-2xl font-bold text-primary",children:["€ ",t.total_price||"0"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"创建时间"}),e.jsx("p",{className:"text-sm font-medium",children:t.created_at?B(new Date(t.created_at),"yyyy-MM-dd HH:mm:ss"):"-"})]})]})}),t.customer&&e.jsxs("div",{className:"rounded-lg border bg-muted/30 p-4 space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4"}),"客户信息"]}),e.jsxs("div",{className:"grid gap-3",children:[t.customer.name&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:t.customer.name})]}),t.customer.phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:t.customer.phone.includes("#")?`+${t.customer.phone.replace("#"," ")}`:t.customer.phone})]}),t.customer.email&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:t.customer.email})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-muted/30 p-4 space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(Je,{className:"h-4 w-4"}),"取餐信息"]}),e.jsxs("div",{className:"grid gap-2",children:[t.restaurant&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"餐厅"}),e.jsx("span",{className:"font-medium",children:t.restaurant})]}),(t.pickupDate||t.pickup_date)&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"取餐日期"}),e.jsx("span",{className:"font-medium",children:t.pickupDate||t.pickup_date})]}),t.pickupTime&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"取餐时间"}),e.jsx(p,{variant:"outline",className:"font-medium",children:t.pickupTime})]})]})]}),t.line_items&&Array.isArray(t.line_items)&&t.line_items.length>0&&e.jsxs("div",{className:"rounded-lg border bg-muted/30 p-4 space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(we,{className:"h-4 w-4"}),"订单商品 (",t.line_items.length,")"]}),e.jsx("div",{className:"space-y-2",children:t.line_items.map((s,r)=>e.jsxs("div",{className:"flex justify-between items-start py-2 border-b border-border/50 last:border-0",children:[e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:s.name||s.title||"商品"}),s.sku&&e.jsxs("p",{className:"text-xs text-muted-foreground font-mono",children:["SKU: ",s.sku]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["数量: ",s.quantity||1," × €",s.price||"0"]}),s.properties&&Array.isArray(s.properties)&&s.properties.length>0&&e.jsx("div",{className:"text-xs text-muted-foreground",children:s.properties.map((y,w)=>e.jsxs("span",{className:"mr-2",children:[y.name,": ",y.value]},w))})]}),e.jsxs("p",{className:"font-medium text-primary",children:["€",((s.quantity||1)*parseFloat(s.price||"0")).toFixed(2)]})]},r))})]}),e.jsxs("div",{className:"rounded-lg border bg-muted/30 p-4 space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(es,{className:"h-4 w-4"}),"付款信息"]}),e.jsxs("div",{className:"grid gap-2",children:[t.pay_type&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"付款方式"}),e.jsx(p,{variant:"outline",children:t.pay_type})]}),t.pay_state&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"付款状态"}),e.jsx(p,{variant:t.pay_state==="paid"?"default":"secondary",className:t.pay_state==="paid"?"bg-green-500":"",children:t.pay_state==="paid"?"已付款":t.pay_state})]}),e.jsxs("div",{className:"flex justify-between items-center font-bold border-t pt-2 mt-2",children:[e.jsx("span",{children:"总计"}),e.jsxs("span",{className:"text-primary",children:["€",t.total_price||"0"]})]})]})]}),t.note&&e.jsxs("div",{className:"rounded-lg border p-4 space-y-2",children:[e.jsxs("h4",{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(Ze,{className:"h-4 w-4"}),"备注"]}),e.jsx("p",{className:"text-sm",children:t.note})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("p",{className:"text-xs text-muted-foreground font-mono",children:["ID: ",t.id||"-"," ",t._id&&`| MongoDB: ${t._id}`]})})]})})]})}),e.jsx(de,{open:!!i,onOpenChange:s=>!s&&ee(null),children:e.jsxs(le,{className:"max-w-md",children:[e.jsx(ie,{children:e.jsxs(ce,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-5 w-5 text-chart-2"}),a("admin.orderStats.reserveDetail","订台预约详情")]})}),i&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg border bg-muted/30 p-4 space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4"}),a("admin.orderStats.customerInfo","客户信息")]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:a("admin.orderStats.customerName","预订人")}),e.jsx("span",{className:"font-medium",children:i.customerName||"-"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:a("common.phone","电话")}),e.jsx("span",{className:"font-medium",children:i.phone||"-"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:a("common.email","邮箱")}),e.jsx("span",{className:"font-medium text-sm",children:i.email||"-"})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-muted/30 p-4 space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4"}),a("admin.orderStats.reservationDetails","预约信息")]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:a("admin.orderStats.restaurant","餐厅")}),e.jsx("span",{className:"font-medium",children:i.restaurant||"-"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:a("admin.orderStats.reserveDate","预约日期")}),e.jsx("span",{className:"font-medium",children:i.date||"-"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:a("admin.orderStats.reserveTime","预约时间")}),e.jsx("span",{className:"font-medium",children:i.time||"-"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:a("admin.orderStats.guests","人数")}),e.jsxs(p,{variant:"outline",className:"font-medium",children:[i.numberPeople||i.guests||"-"," ",a("admin.orderStats.people","人")]})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center px-1",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:a("common.status","状态")}),e.jsx(p,{variant:i.status==="confirmed"?"default":"secondary",children:i.status||"pending"})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("p",{className:"text-xs text-muted-foreground font-mono",children:["ID: ",i.id||i._id||"-"]})})]})]})})]})};export{bs as default};
