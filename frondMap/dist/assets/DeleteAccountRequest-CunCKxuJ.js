import{p as V,r as a,j as e,bI as B,ak as F,bF as A,ci as g,aM as b}from"./vendor-react-DanJ59UG.js";import{C as j,n as w,m as k,E as M,a4 as W,I as c,h as N,ad as H,a1 as i,s as m}from"./index-Czilt4qF.js";import"./vendor-i18n-jtdHZIRR.js";import"./vendor-editor-B1vH4T8i.js";import"./vendor-utils-vwQGbBim.js";import"./vendor-supabase-BVVOWwEK.js";const G=()=>{const{i18n:u}=V(),[r,E]=a.useState(""),[l,D]=a.useState(""),[f,T]=a.useState(""),[o,S]=a.useState(""),[p,x]=a.useState(!1),[h,v]=a.useState(!1),[n,C]=a.useState(!1),[P,I]=a.useState(!1),L=u.language?.startsWith("zh")?"zh":u.language?.startsWith("pt")?"pt":"en",y={zh:{title:"删除账号请求",subtitle:"请先验证您的身份，然后提交账号删除请求",stepVerify:"第一步：验证身份",stepVerifyDesc:"请输入您的注册邮箱和密码来验证身份",stepDelete:"第二步：确认删除",stepDeleteDesc:"身份验证通过，请确认删除请求",emailLabel:"注册邮箱",emailPlaceholder:"请输入您注册时使用的邮箱",passwordLabel:"密码",passwordPlaceholder:"请输入您的登录密码",verifyButton:"验证身份",verifying:"验证中...",verifySuccess:"身份验证成功",verifyFailed:"邮箱或密码错误，请重试",reasonLabel:"删除原因（可选）",reasonPlaceholder:"请告诉我们您为什么想删除账号...",confirmLabel:"确认删除",confirmHint:"请输入 DELETE 确认",submitButton:"提交删除请求",submitting:"提交中...",successTitle:"请求已提交",successMessage:"我们已收到您的账号删除请求。我们会在 3-5 个工作日内处理您的请求，届时将通过邮件通知您。",warningTitle:"请注意",warningItems:["您的个人资料和头像将被永久删除","您的收藏、评论、评分将被移除","您的活动订阅和参与记录将被清除","您获得的优惠券将无法使用","此操作不可撤销"],dataTitle:"将被删除的数据",dataItems:["个人资料（姓名、头像、偏好设置）","收藏的餐厅","发表的评论和评分","活动订阅和分享记录","获得的优惠券","地址信息","通知记录"],emailRequired:"请输入邮箱地址",passwordRequired:"请输入密码",confirmRequired:"请输入 DELETE 确认",submitError:"提交失败，请稍后重试",identityVerified:"身份已验证"},pt:{title:"Solicitação de Exclusão de Conta",subtitle:"Verifique sua identidade primeiro e depois envie a solicitação de exclusão",stepVerify:"Passo 1: Verificar Identidade",stepVerifyDesc:"Digite seu e-mail e senha para verificar sua identidade",stepDelete:"Passo 2: Confirmar Exclusão",stepDeleteDesc:"Identidade verificada, confirme a solicitação de exclusão",emailLabel:"E-mail registrado",emailPlaceholder:"Digite o e-mail usado no registro",passwordLabel:"Senha",passwordPlaceholder:"Digite sua senha de login",verifyButton:"Verificar Identidade",verifying:"Verificando...",verifySuccess:"Identidade verificada com sucesso",verifyFailed:"E-mail ou senha incorretos, tente novamente",reasonLabel:"Motivo da exclusão (opcional)",reasonPlaceholder:"Diga-nos por que deseja excluir sua conta...",confirmLabel:"Confirmar exclusão",confirmHint:"Digite DELETE para confirmar",submitButton:"Enviar solicitação",submitting:"Enviando...",successTitle:"Solicitação enviada",successMessage:"Recebemos sua solicitação de exclusão de conta. Processaremos em 3-5 dias úteis e notificaremos por e-mail.",warningTitle:"Atenção",warningItems:["Seu perfil e avatar serão permanentemente excluídos","Seus favoritos, comentários e avaliações serão removidos","Suas assinaturas de atividades serão canceladas","Seus cupons não poderão mais ser utilizados","Esta ação é irreversível"],dataTitle:"Dados que serão excluídos",dataItems:["Perfil pessoal (nome, avatar, preferências)","Restaurantes favoritos","Comentários e avaliações","Assinaturas e compartilhamentos de atividades","Cupons obtidos","Informações de endereço","Registros de notificações"],emailRequired:"Por favor, insira seu e-mail",passwordRequired:"Por favor, insira sua senha",confirmRequired:"Por favor, digite DELETE para confirmar",submitError:"Falha ao enviar, tente novamente mais tarde",identityVerified:"Identidade verificada"},en:{title:"Account Deletion Request",subtitle:"Verify your identity first, then submit the account deletion request",stepVerify:"Step 1: Verify Identity",stepVerifyDesc:"Enter your registered email and password to verify your identity",stepDelete:"Step 2: Confirm Deletion",stepDeleteDesc:"Identity verified, please confirm the deletion request",emailLabel:"Registered Email",emailPlaceholder:"Enter the email used for registration",passwordLabel:"Password",passwordPlaceholder:"Enter your login password",verifyButton:"Verify Identity",verifying:"Verifying...",verifySuccess:"Identity verified successfully",verifyFailed:"Incorrect email or password, please try again",reasonLabel:"Reason for deletion (optional)",reasonPlaceholder:"Tell us why you want to delete your account...",confirmLabel:"Confirm Deletion",confirmHint:"Type DELETE to confirm",submitButton:"Submit Deletion Request",submitting:"Submitting...",successTitle:"Request Submitted",successMessage:"We have received your account deletion request. We will process it within 3-5 business days and notify you via email.",warningTitle:"Please Note",warningItems:["Your profile and avatar will be permanently deleted","Your favorites, comments, and ratings will be removed","Your activity subscriptions will be cancelled","Your coupons will no longer be usable","This action is irreversible"],dataTitle:"Data That Will Be Deleted",dataItems:["Personal profile (name, avatar, preferences)","Favorite restaurants","Comments and ratings","Activity subscriptions and share records","Obtained coupons","Address information","Notification records"],emailRequired:"Please enter your email",passwordRequired:"Please enter your password",confirmRequired:"Please type DELETE to confirm",submitError:"Submission failed, please try again later",identityVerified:"Identity verified"}},s=y[L]||y.en,q=async()=>{if(!r.trim()){i({title:s.emailRequired,variant:"destructive"});return}if(!l){i({title:s.passwordRequired,variant:"destructive"});return}v(!0);try{const{error:t}=await m.auth.signInWithPassword({email:r.trim(),password:l});if(t){i({title:s.verifyFailed,variant:"destructive"});return}await m.auth.signOut(),C(!0),i({title:s.verifySuccess})}catch{i({title:s.verifyFailed,variant:"destructive"})}finally{v(!1)}},R=async()=>{if(n){if(o.toUpperCase()!=="DELETE"){i({title:s.confirmRequired,variant:"destructive"});return}x(!0);try{const{error:t}=await m.from("feedback").insert({email:r.trim(),reason:"account_deletion_request",content:`Account deletion request (identity verified).
Reason: ${f||"Not provided"}`,status:"pending"});if(t)throw t;I(!0)}catch{i({title:s.submitError,variant:"destructive"})}finally{x(!1)}}};return P?e.jsx("div",{className:"container mx-auto px-4 py-12 max-w-lg",children:e.jsx(j,{children:e.jsxs(w,{className:"pt-6 text-center space-y-4",children:[e.jsx(B,{className:"h-16 w-16 text-primary mx-auto"}),e.jsx("h2",{className:"text-xl font-bold",children:s.successTitle}),e.jsx("p",{className:"text-muted-foreground",children:s.successMessage})]})})}):e.jsx("div",{className:"container mx-auto px-4 py-8 max-w-lg space-y-6",children:e.jsxs(j,{children:[e.jsxs(k,{children:[e.jsxs(M,{className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-5 w-5 text-destructive"}),s.title]}),e.jsx(W,{children:s.subtitle})]}),e.jsxs(w,{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-lg border border-destructive/50 bg-destructive/5 p-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 font-semibold text-destructive",children:[e.jsx(A,{className:"h-4 w-4"}),s.warningTitle]}),e.jsx("ul",{className:"text-sm text-muted-foreground space-y-1 list-disc list-inside",children:s.warningItems.map((t,d)=>e.jsx("li",{children:t},d))})]}),e.jsxs("div",{className:"rounded-lg border p-4 space-y-2",children:[e.jsx("h4",{className:"font-semibold text-sm",children:s.dataTitle}),e.jsx("ul",{className:"text-sm text-muted-foreground space-y-1 list-disc list-inside",children:s.dataItems.map((t,d)=>e.jsx("li",{children:t},d))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`flex items-center justify-center w-6 h-6 rounded-full text-xs font-bold ${n?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"}`,children:n?"✓":"1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm",children:s.stepVerify}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.stepVerifyDesc})]})]}),n?e.jsxs("div",{className:"flex items-center gap-2 p-3 rounded-lg bg-primary/10 text-primary text-sm font-medium",children:[e.jsx(g,{className:"h-4 w-4"}),s.identityVerified,": ",r]}):e.jsxs("div",{className:"space-y-3 pl-8",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:s.emailLabel}),e.jsx(c,{type:"email",placeholder:s.emailPlaceholder,value:r,onChange:t=>E(t.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:s.passwordLabel}),e.jsx(c,{type:"password",placeholder:s.passwordPlaceholder,value:l,onChange:t=>D(t.target.value)})]}),e.jsx(N,{onClick:q,disabled:h||!r.trim()||!l,className:"w-full",children:h?e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"h-4 w-4 mr-2 animate-spin"}),s.verifying]}):e.jsxs(e.Fragment,{children:[e.jsx(g,{className:"h-4 w-4 mr-2"}),s.verifyButton]})})]})]}),n&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-muted text-muted-foreground text-xs font-bold",children:"2"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm",children:s.stepDelete}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.stepDeleteDesc})]})]}),e.jsxs("div",{className:"space-y-3 pl-8",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:s.reasonLabel}),e.jsx(H,{placeholder:s.reasonPlaceholder,value:f,onChange:t=>T(t.target.value),rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:s.confirmLabel}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.confirmHint}),e.jsx(c,{placeholder:"DELETE",value:o,onChange:t=>S(t.target.value)})]}),e.jsx(N,{variant:"destructive",className:"w-full",onClick:R,disabled:p||o.toUpperCase()!=="DELETE",children:p?e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"h-4 w-4 mr-2 animate-spin"}),s.submitting]}):s.submitButton})]})]})]})]})})};export{G as default};
//# sourceMappingURL=DeleteAccountRequest-CunCKxuJ.js.map
