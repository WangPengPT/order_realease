import{p as q,r as c,j as e,an as X,bF as pe,y as Z,a_ as ve,b5 as Ne,bv as O,X as ee,aM as P,a4 as se,dA as ae,cd as B,cc as z,bA as S,bf as I,cq as te,e6 as fe,dW as we,bY as H,b_ as W,b4 as be,bI as Ce}from"./vendor-react-DO-hMdHk.js";import{D as ne,c as ie,d as de,e as le,T as ye,P as V,Q as J,R as E,g as j,U as Y,a8 as $,V as G,B as x,S as ke,j as r,C as o,q as m,p as Re,F as Se,I as _e,a2 as De,a3 as Ae,a4 as Ie,a5 as Le,a6 as R}from"./index-KBuYVGMg.js";import{T as Fe,a as Te,b as K,c as N,d as Ue,e as f}from"./table-BN1_t0c3.js";import{e as re,f as ce,g as oe,h as Me,i as Pe,j as He,k as Be}from"./useInvitationCodes-BtqVdqWz.js";import{S as me}from"./separator-DEbXNOsT.js";import{D as L}from"./vendor-utils-Z4kpnli5.js";import"./vendor-i18n-jtdHZIRR.js";import"./vendor-editor-B1vH4T8i.js";import"./vendor-supabase-DUJEpEPV.js";const ze=({open:a,onOpenChange:u,invitationCode:t})=>{const{t:n}=q(),d=re(),l=ce(),g=oe(),[p,i]=c.useState(""),[w,v]=c.useState(""),[_,b]=c.useState(!1),[C,y]=c.useState(!1);if(!t)return null;const D=async()=>{await d.mutateAsync(t.id),u(!1)},F=async()=>{p.trim()&&(await l.mutateAsync({id:t.id,reason:p}),u(!1),i(""),b(!1))},A=async()=>{w.trim()&&(await g.mutateAsync({id:t.id,reason:w}),u(!1),v(""),y(!1))},T=t.status==="pending",U=t.status==="approved",h=d.isPending||l.isPending||g.isPending;return e.jsx(ne,{open:a,onOpenChange:u,children:e.jsxs(ie,{className:"sm:max-w-lg",children:[e.jsxs(de,{children:[e.jsxs(le,{className:"flex items-center gap-2",children:[e.jsx(X,{className:"w-5 h-5 text-primary"}),n("admin.invitationCodes.reviewTitle","审核邀请码申请")]}),e.jsx(ye,{children:n("admin.invitationCodes.reviewDesc","查看申请详情并决定是否通过")})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-muted/50 rounded-lg",children:[e.jsxs(V,{className:"w-12 h-12",children:[e.jsx(J,{src:t.profiles?.avatar_url}),e.jsx(E,{children:t.full_name?.charAt(0)||"U"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold",children:t.full_name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.profiles?.display_name})]}),e.jsxs(j,{variant:t.status==="approved"?"default":t.status==="rejected"?"destructive":t.status==="revoked"?"outline":"secondary",className:t.status==="revoked"?"text-orange-600 border-orange-500":"",children:[t.status==="approved"&&n("admin.invitationCodes.approved","已通过"),t.status==="rejected"&&n("admin.invitationCodes.rejected","已拒绝"),t.status==="pending"&&n("admin.invitationCodes.pending","待审核"),t.status==="revoked"&&n("admin.invitationCodes.revoked","已收回")]})]}),e.jsx(me,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(pe,{className:"w-4 h-4 text-muted-foreground mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:n("admin.invitationCodes.nif","NIF")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.nif})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Z,{className:"w-4 h-4 text-muted-foreground mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:n("admin.invitationCodes.contact","联系方式")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.contact||"-"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ve,{className:"w-4 h-4 text-muted-foreground mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:n("admin.invitationCodes.address","地址")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.address})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(X,{className:"w-4 h-4 text-muted-foreground mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:n("admin.invitationCodes.code","邀请码")}),e.jsx("code",{className:"text-sm font-mono bg-primary/10 text-primary px-2 py-1 rounded",children:t.code})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ne,{className:"w-4 h-4 text-muted-foreground mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:n("admin.invitationCodes.createdAt","申请时间")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:L(new Date(t.created_at),"yyyy-MM-dd HH:mm:ss")})]})]}),t.status==="approved"&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(O,{className:"w-4 h-4 text-muted-foreground mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:n("admin.invitationCodes.usageCount","使用次数")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.usage_count})]})]}),t.rejection_reason&&t.status==="rejected"&&e.jsxs("div",{className:"p-3 bg-destructive/10 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-destructive",children:n("admin.invitationCodes.rejectionReason","拒绝原因")}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:t.rejection_reason})]}),t.rejection_reason&&t.status==="revoked"&&e.jsxs("div",{className:"p-3 bg-orange-500/10 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-orange-600",children:n("admin.invitationCodes.revokeReason","收回原因")}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:t.rejection_reason})]})]}),_&&e.jsxs("div",{className:"space-y-2 p-4 border rounded-lg bg-destructive/5",children:[e.jsx(Y,{children:n("admin.invitationCodes.rejectionReason","拒绝原因")}),e.jsx($,{value:p,onChange:k=>i(k.target.value),placeholder:n("admin.invitationCodes.rejectionReasonPlaceholder","请输入拒绝原因..."),className:"resize-none",rows:3})]}),C&&e.jsxs("div",{className:"space-y-2 p-4 border rounded-lg bg-orange-500/5 border-orange-200",children:[e.jsx(Y,{className:"text-orange-600",children:n("admin.invitationCodes.revokeReason","收回原因")}),e.jsx($,{value:w,onChange:k=>v(k.target.value),placeholder:n("admin.invitationCodes.revokeReasonPlaceholder","请输入收回原因..."),className:"resize-none",rows:3})]})]}),T&&!C&&e.jsx(G,{className:"gap-2 sm:gap-0",children:_?e.jsxs(e.Fragment,{children:[e.jsx(x,{variant:"outline",onClick:()=>{b(!1),i("")},disabled:h,children:n("common.cancel","取消")}),e.jsxs(x,{variant:"destructive",onClick:F,disabled:h||!p.trim(),children:[h&&e.jsx(P,{className:"w-4 h-4 mr-2 animate-spin"}),n("admin.invitationCodes.confirmReject","确认拒绝")]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(x,{variant:"outline",onClick:()=>b(!0),disabled:h,children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),n("admin.invitationCodes.reject","拒绝")]}),e.jsxs(x,{onClick:D,disabled:h,className:"bg-green-600 hover:bg-green-700",children:[h&&e.jsx(P,{className:"w-4 h-4 mr-2 animate-spin"}),e.jsx(se,{className:"w-4 h-4 mr-2"}),n("admin.invitationCodes.approve","通过")]})]})}),U&&e.jsx(G,{className:"gap-2 sm:gap-0",children:C?e.jsxs(e.Fragment,{children:[e.jsx(x,{variant:"outline",onClick:()=>{y(!1),v("")},disabled:h,children:n("common.cancel","取消")}),e.jsxs(x,{variant:"default",className:"bg-orange-600 hover:bg-orange-700",onClick:A,disabled:h||!w.trim(),children:[h&&e.jsx(P,{className:"w-4 h-4 mr-2 animate-spin"}),e.jsx(B,{className:"w-4 h-4 mr-2"}),n("admin.invitationCodes.confirmRevoke","确认收回")]})]}):e.jsxs(x,{variant:"outline",onClick:()=>y(!0),className:"text-orange-600 border-orange-300 hover:bg-orange-50",children:[e.jsx(ae,{className:"w-4 h-4 mr-2"}),n("admin.invitationCodes.revoke","收回邀请码")]})})]})})},qe=({open:a,onOpenChange:u,invitationCode:t,codeOwner:n})=>{const{t:d}=q(),{data:l,isLoading:g}=Me(a?t:null),p=i=>{switch(i){case"completed":return e.jsxs(j,{variant:"outline",className:"text-green-600 border-green-500 bg-green-50 dark:bg-green-950/30",children:[e.jsx(S,{className:"w-3 h-3 mr-1"}),d("admin.invitationCodes.stats.completed","已完成")]});case"pending":case"received":return e.jsxs(j,{variant:"outline",className:"text-yellow-600 border-yellow-500 bg-yellow-50 dark:bg-yellow-950/30",children:[e.jsx(I,{className:"w-3 h-3 mr-1"}),d("admin.invitationCodes.stats.pending","进行中")]});default:return e.jsx(j,{variant:"secondary",children:i})}};return e.jsx(ne,{open:a,onOpenChange:u,children:e.jsxs(ie,{className:"sm:max-w-2xl max-h-[85vh]",children:[e.jsxs(de,{children:[e.jsxs(le,{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5 text-primary"}),d("admin.invitationCodes.statsTitle","邀请码统计详情")]}),t&&e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("code",{className:"px-2 py-1 bg-primary/10 text-primary rounded font-mono text-sm",children:t}),n&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:[d("admin.invitationCodes.stats.owner","所有者"),": ",n]})]})]}),e.jsx(ke,{className:"max-h-[calc(85vh-120px)]",children:g?e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[1,2,3,4].map(i=>e.jsx(r,{className:"h-20"},i))}),e.jsx(r,{className:"h-32"}),e.jsx(r,{className:"h-32"})]}):l?e.jsxs("div",{className:"space-y-6 p-1",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsx(o,{children:e.jsx(m,{className:"pt-4 pb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-primary/10",children:e.jsx(O,{className:"w-4 h-4 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold",children:l.stats.totalUsed}),e.jsx("p",{className:"text-xs text-muted-foreground",children:d("admin.invitationCodes.stats.totalUsed","总使用次数")})]})]})})}),e.jsx(o,{children:e.jsx(m,{className:"pt-4 pb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-green-500/10",children:e.jsx(S,{className:"w-4 h-4 text-green-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold",children:l.stats.completedJoinRequests}),e.jsx("p",{className:"text-xs text-muted-foreground",children:d("admin.invitationCodes.stats.completed","已完成")})]})]})})}),e.jsx(o,{children:e.jsx(m,{className:"pt-4 pb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-yellow-500/10",children:e.jsx(I,{className:"w-4 h-4 text-yellow-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold",children:l.stats.pendingJoinRequests}),e.jsx("p",{className:"text-xs text-muted-foreground",children:d("admin.invitationCodes.stats.inProgress","进行中")})]})]})})}),e.jsx(o,{children:e.jsx(m,{className:"pt-4 pb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-blue-500/10",children:e.jsx(te,{className:"w-4 h-4 text-blue-500"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-xl font-bold",children:[l.stats.successRate,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:d("admin.invitationCodes.stats.successRate","成功率")})]})]})})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2 mb-3",children:[e.jsx(fe,{className:"w-4 h-4"}),d("admin.invitationCodes.stats.joinRequests","商家加入申请"),e.jsx(j,{variant:"secondary",className:"ml-auto",children:l.joinRequests.length})]}),l.joinRequests.length===0?e.jsx("div",{className:"text-sm text-muted-foreground text-center py-6 bg-muted/30 rounded-lg",children:d("admin.invitationCodes.stats.noJoinRequests","暂无使用此邀请码的商家申请")}):e.jsx("div",{className:"space-y-2",children:l.joinRequests.map(i=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/30 rounded-lg",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:i.restaurant_name}),e.jsxs("p",{className:"text-xs text-muted-foreground truncate",children:[i.name," • ",i.email]})]}),e.jsxs("div",{className:"flex items-center gap-3 ml-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground hidden sm:block",children:L(new Date(i.created_at),"yyyy-MM-dd")}),p(i.status)]})]},i.id))})]}),e.jsx(me,{}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2 mb-3",children:[e.jsx(we,{className:"w-4 h-4"}),d("admin.invitationCodes.stats.registeredUsers","已注册用户"),e.jsx(j,{variant:"secondary",className:"ml-auto",children:l.invitedUsers.length})]}),l.invitedUsers.length===0?e.jsx("div",{className:"text-sm text-muted-foreground text-center py-6 bg-muted/30 rounded-lg",children:d("admin.invitationCodes.stats.noUsers","暂无使用此邀请码注册的用户")}):e.jsx("div",{className:"space-y-2",children:l.invitedUsers.map(i=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted/30 rounded-lg",children:[e.jsxs(V,{className:"w-8 h-8",children:[e.jsx(J,{src:i.avatar_url}),e.jsx(E,{children:i.display_name?.charAt(0)||"U"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:i.display_name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[d("admin.invitationCodes.stats.registeredAt","注册时间"),": "," ",L(new Date(i.invited_at||i.created_at),"yyyy-MM-dd HH:mm")]})]}),e.jsxs(j,{variant:"outline",className:"text-green-600 border-green-500",children:[e.jsx(S,{className:"w-3 h-3 mr-1"}),d("admin.invitationCodes.stats.registered","已注册")]})]},i.id))})]})]}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:d("admin.invitationCodes.stats.noData","暂无数据")})})]})})},Ge=()=>{const{t:a}=q(),{data:u,isLoading:t}=Pe(),{data:n,isLoading:d}=He(),{data:l,isLoading:g}=Be(),p=re();ce(),oe();const[i,w]=c.useState(""),[v,_]=c.useState("all"),[b,C]=c.useState(null),[y,D]=c.useState(!1),[F,A]=c.useState(!1),[T,U]=c.useState(null),[h,k]=c.useState(void 0),Q=c.useMemo(()=>u?u.filter(s=>{const ue=s.code.toLowerCase().includes(i.toLowerCase())||s.full_name.toLowerCase().includes(i.toLowerCase())||s.nif.toLowerCase().includes(i.toLowerCase())||(s.contact||"").toLowerCase().includes(i.toLowerCase())||s.profiles?.display_name?.toLowerCase().includes(i.toLowerCase()),ge=v==="all"||s.status===v;return ue&&ge}):[],[u,i,v]),xe=async s=>{await p.mutateAsync(s)},M=s=>{C(s),D(!0)},he=s=>{U(s.code),k(s.full_name),A(!0)},je=s=>{switch(s){case"pending":return e.jsxs(j,{variant:"outline",className:"text-yellow-600 border-yellow-500 bg-yellow-50 dark:bg-yellow-950/30",children:[e.jsx(I,{className:"w-3 h-3 mr-1"}),a("admin.invitationCodes.pending","待审核")]});case"approved":return e.jsxs(j,{variant:"outline",className:"text-green-600 border-green-500 bg-green-50 dark:bg-green-950/30",children:[e.jsx(S,{className:"w-3 h-3 mr-1"}),a("admin.invitationCodes.approved","已通过")]});case"rejected":return e.jsxs(j,{variant:"outline",className:"text-red-600 border-red-500 bg-red-50 dark:bg-red-950/30",children:[e.jsx(W,{className:"w-3 h-3 mr-1"}),a("admin.invitationCodes.rejected","已拒绝")]});case"revoked":return e.jsxs(j,{variant:"outline",className:"text-orange-600 border-orange-500 bg-orange-50 dark:bg-orange-950/30",children:[e.jsx(B,{className:"w-3 h-3 mr-1"}),a("admin.invitationCodes.revoked","已收回")]});default:return null}};return e.jsxs("div",{className:"p-4 md:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(H,{className:"w-6 h-6 text-primary"}),a("admin.invitationCodes.title","邀请码管理")]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:a("admin.invitationCodes.description","审核用户的邀请码申请，管理邀请码使用情况")})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsx(o,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(H,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:d?e.jsx(r,{className:"h-8 w-12"}):n?.total||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a("admin.invitationCodes.totalApplications","总申请数")})]})]})})}),e.jsx(o,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-yellow-500/10",children:e.jsx(I,{className:"w-5 h-5 text-yellow-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:d?e.jsx(r,{className:"h-8 w-12"}):n?.pending||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a("admin.invitationCodes.pendingReview","待审核")})]})]})})}),e.jsx(o,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-green-500/10",children:e.jsx(S,{className:"w-5 h-5 text-green-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:d?e.jsx(r,{className:"h-8 w-12"}):n?.approved||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a("admin.invitationCodes.approvedCount","已通过")})]})]})})}),e.jsx(o,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-red-500/10",children:e.jsx(W,{className:"w-5 h-5 text-red-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:d?e.jsx(r,{className:"h-8 w-12"}):n?.rejected||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a("admin.invitationCodes.rejectedCount","已拒绝")})]})]})})}),e.jsx(o,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-orange-500/10",children:e.jsx(B,{className:"w-5 h-5 text-orange-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:d?e.jsx(r,{className:"h-8 w-12"}):n?.revoked||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a("admin.invitationCodes.revokedCount","已收回")})]})]})})})]}),e.jsxs(o,{children:[e.jsx(Re,{className:"pb-3",children:e.jsxs(Se,{className:"text-base flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4 text-primary"}),a("admin.invitationCodes.performanceStats","邀请码效果统计")]})}),e.jsx(m,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:g?e.jsx(r,{className:"h-8 w-12 mx-auto"}):l?.totalUsage||0}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:a("admin.invitationCodes.stats.totalUsage","总使用次数")})]}),e.jsxs("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:g?e.jsx(r,{className:"h-8 w-12 mx-auto"}):l?.activeCodesCount||0}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:a("admin.invitationCodes.stats.activeCodes","有效使用码")})]}),e.jsxs("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:g?e.jsx(r,{className:"h-8 w-12 mx-auto"}):l?.completedJoinRequests||0}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:a("admin.invitationCodes.stats.successfulInvites","成功邀请")})]}),e.jsxs("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(te,{className:"w-4 h-4 text-green-500"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:g?e.jsx(r,{className:"h-8 w-12"}):`${l?.overallSuccessRate||0}%`})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:a("admin.invitationCodes.stats.overallSuccessRate","整体成功率")})]})]})})]}),e.jsx(o,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(be,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(_e,{placeholder:a("admin.invitationCodes.searchPlaceholder","搜索邀请码、姓名、NIF..."),value:i,onChange:s=>w(s.target.value),className:"pl-10"})]}),e.jsxs(De,{value:v,onValueChange:_,children:[e.jsx(Ae,{className:"w-full md:w-40",children:e.jsx(Ie,{})}),e.jsxs(Le,{children:[e.jsx(R,{value:"all",children:a("common.all","全部")}),e.jsx(R,{value:"pending",children:a("admin.invitationCodes.pending","待审核")}),e.jsx(R,{value:"approved",children:a("admin.invitationCodes.approved","已通过")}),e.jsx(R,{value:"rejected",children:a("admin.invitationCodes.rejected","已拒绝")}),e.jsx(R,{value:"revoked",children:a("admin.invitationCodes.revoked","已收回")})]})]})]})})}),e.jsx(o,{children:e.jsx(m,{className:"p-0",children:t?e.jsx("div",{className:"p-6 space-y-4",children:[1,2,3].map(s=>e.jsx(r,{className:"h-16 w-full"},s))}):Q.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(H,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:a("admin.invitationCodes.noResults","没有找到邀请码申请")})]}):e.jsxs(Fe,{children:[e.jsx(Te,{children:e.jsxs(K,{children:[e.jsx(N,{children:a("admin.invitationCodes.applicant","申请人")}),e.jsx(N,{children:a("admin.invitationCodes.code","邀请码")}),e.jsx(N,{children:a("admin.invitationCodes.nif","NIF")}),e.jsx(N,{children:a("admin.invitationCodes.contact","联系方式")}),e.jsx(N,{children:a("admin.invitationCodes.status","状态")}),e.jsx(N,{children:a("admin.invitationCodes.usageCount","使用次数")}),e.jsx(N,{children:a("admin.invitationCodes.createdAt","申请时间")}),e.jsx(N,{className:"text-right",children:a("common.actions","操作")})]})}),e.jsx(Ue,{children:Q.map(s=>e.jsxs(K,{children:[e.jsx(f,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(V,{className:"w-8 h-8",children:[e.jsx(J,{src:s.profiles?.avatar_url}),e.jsx(E,{children:s.full_name?.charAt(0)||"U"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.full_name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.profiles?.display_name})]})]})}),e.jsx(f,{children:e.jsx("code",{className:"px-2 py-1 bg-muted rounded text-sm font-mono",children:s.code})}),e.jsx(f,{children:s.nif}),e.jsx(f,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-3 h-3 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:s.contact||"-"})]})}),e.jsx(f,{children:je(s.status)}),e.jsx(f,{children:e.jsxs(x,{variant:"ghost",size:"sm",className:"h-auto p-1 gap-1",onClick:()=>he(s),disabled:s.status!=="approved",children:[e.jsx(O,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{children:s.usage_count}),s.status==="approved"&&e.jsx(z,{className:"w-3 h-3 text-primary ml-1"})]})}),e.jsx(f,{children:L(new Date(s.created_at),"yyyy-MM-dd HH:mm")}),e.jsx(f,{children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(x,{variant:"ghost",size:"icon",onClick:()=>M(s),children:e.jsx(Ce,{className:"w-4 h-4"})}),s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(x,{variant:"ghost",size:"icon",className:"text-green-600 hover:text-green-700 hover:bg-green-50",onClick:()=>xe(s.id),disabled:p.isPending,children:e.jsx(se,{className:"w-4 h-4"})}),e.jsx(x,{variant:"ghost",size:"icon",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>M(s),children:e.jsx(ee,{className:"w-4 h-4"})})]}),s.status==="approved"&&e.jsx(x,{variant:"ghost",size:"icon",className:"text-orange-600 hover:text-orange-700 hover:bg-orange-50",onClick:()=>M(s),title:a("admin.invitationCodes.revoke","收回"),children:e.jsx(ae,{className:"w-4 h-4"})})]})})]},s.id))})]})})}),e.jsx(ze,{open:y,onOpenChange:D,invitationCode:b}),e.jsx(qe,{open:F,onOpenChange:A,invitationCode:T,codeOwner:h})]})};export{Ge as default};
//# sourceMappingURL=AdminInvitationCodes-CHm-SZH4.js.map
