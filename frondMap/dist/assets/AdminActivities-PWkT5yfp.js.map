{"version":3,"file":"AdminActivities-PWkT5yfp.js","sources":["../../src/components/admin/ImageCropDialog.tsx","../../src/components/admin/ActivityFormDialog.tsx","../../src/components/admin/ActivityRulesEditorDialog.tsx","../../src/components/admin/GlobalHandbookEditorDialog.tsx","../../src/pages/admin/AdminActivities.tsx"],"sourcesContent":["import { useState, useRef, useCallback, useEffect } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport ReactCrop, { Crop, PixelCrop, centerCrop, makeAspectCrop } from \"react-image-crop\";\r\nimport \"react-image-crop/dist/ReactCrop.css\";\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Crop as CropIcon, Info, Maximize2 } from \"lucide-react\";\r\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\r\n\r\ninterface ImageCropDialogProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  imageFile: File;\r\n  onCropComplete: (croppedFile: File, preview: string) => void;\r\n}\r\n\r\n// Recommended dimensions for activity images\r\nconst RECOMMENDED_WIDTH = 1200;\r\nconst RECOMMENDED_HEIGHT = 630;\r\nconst ASPECT_RATIO = RECOMMENDED_WIDTH / RECOMMENDED_HEIGHT;\r\n\r\nfunction centerAspectCrop(\r\n  mediaWidth: number,\r\n  mediaHeight: number,\r\n  aspect: number,\r\n) {\r\n  return centerCrop(\r\n    makeAspectCrop(\r\n      {\r\n        unit: '%',\r\n        width: 90,\r\n      },\r\n      aspect,\r\n      mediaWidth,\r\n      mediaHeight,\r\n    ),\r\n    mediaWidth,\r\n    mediaHeight,\r\n  );\r\n}\r\n\r\nexport function ImageCropDialog({\r\n  open,\r\n  onOpenChange,\r\n  imageFile,\r\n  onCropComplete,\r\n}: ImageCropDialogProps) {\r\n  const { t } = useTranslation();\r\n  const [imgSrc, setImgSrc] = useState(\"\");\r\n  const [crop, setCrop] = useState<Crop>();\r\n  const [completedCrop, setCompletedCrop] = useState<PixelCrop>();\r\n  const imgRef = useRef<HTMLImageElement>(null);\r\n  const [isCropping, setIsCropping] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (open && imageFile) {\r\n      const reader = new FileReader();\r\n      reader.addEventListener(\"load\", () => {\r\n        setImgSrc(reader.result?.toString() || \"\");\r\n      });\r\n      reader.readAsDataURL(imageFile);\r\n    }\r\n  }, [open, imageFile]);\r\n\r\n  const onImageLoad = useCallback((e: React.SyntheticEvent<HTMLImageElement>) => {\r\n    const { width, height } = e.currentTarget;\r\n    setCrop(centerAspectCrop(width, height, ASPECT_RATIO));\r\n  }, []);\r\n\r\n  const getCroppedImg = useCallback(\r\n    async (image: HTMLImageElement, crop: PixelCrop): Promise<Blob> => {\r\n      const canvas = document.createElement(\"canvas\");\r\n      const ctx = canvas.getContext(\"2d\");\r\n\r\n      if (!ctx) {\r\n        throw new Error(\"No 2d context\");\r\n      }\r\n\r\n      const scaleX = image.naturalWidth / image.width;\r\n      const scaleY = image.naturalHeight / image.height;\r\n\r\n      // Set canvas size to match the crop area\r\n      canvas.width = crop.width * scaleX;\r\n      canvas.height = crop.height * scaleY;\r\n\r\n      ctx.imageSmoothingQuality = \"high\";\r\n\r\n      ctx.drawImage(\r\n        image,\r\n        crop.x * scaleX,\r\n        crop.y * scaleY,\r\n        crop.width * scaleX,\r\n        crop.height * scaleY,\r\n        0,\r\n        0,\r\n        canvas.width,\r\n        canvas.height\r\n      );\r\n\r\n      return new Promise((resolve, reject) => {\r\n        canvas.toBlob(\r\n          (blob) => {\r\n            if (!blob) {\r\n              reject(new Error(\"Canvas is empty\"));\r\n              return;\r\n            }\r\n            resolve(blob);\r\n          },\r\n          \"image/jpeg\",\r\n          0.95\r\n        );\r\n      });\r\n    },\r\n    []\r\n  );\r\n\r\n  const handleCropConfirm = useCallback(async () => {\r\n    if (!completedCrop || !imgRef.current) return;\r\n\r\n    setIsCropping(true);\r\n    try {\r\n      const croppedBlob = await getCroppedImg(imgRef.current, completedCrop);\r\n      const croppedFile = new File([croppedBlob], imageFile.name, {\r\n        type: \"image/jpeg\",\r\n      });\r\n\r\n      // Create preview URL\r\n      const previewUrl = URL.createObjectURL(croppedBlob);\r\n\r\n      onCropComplete(croppedFile, previewUrl);\r\n      onOpenChange(false);\r\n    } catch (error) {\r\n      console.error(\"Error cropping image:\", error);\r\n    } finally {\r\n      setIsCropping(false);\r\n    }\r\n  }, [completedCrop, imageFile, onCropComplete, onOpenChange, getCroppedImg]);\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={onOpenChange}>\r\n      <DialogContent className=\"max-w-[95vw] sm:max-w-4xl max-h-[95vh] overflow-hidden flex flex-col p-0\">\r\n        <DialogHeader className=\"px-4 sm:px-6 pt-4 sm:pt-6 pb-4 border-b\">\r\n          <DialogTitle className=\"text-lg sm:text-xl flex items-center gap-2\">\r\n            <CropIcon className=\"w-5 h-5 text-primary\" />\r\n            {t(\"admin.cropImage\")}\r\n          </DialogTitle>\r\n          <DialogDescription className=\"text-xs sm:text-sm\">\r\n            {t(\"admin.cropImageDescription\")}\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        <div className=\"px-4 sm:px-6 py-4 space-y-4 overflow-y-auto\">\r\n          <Alert className=\"border-primary/20 bg-primary/5\">\r\n            <Info className=\"h-4 w-4\" />\r\n            <AlertDescription className=\"text-xs sm:text-sm\">\r\n              <div className=\"flex flex-col sm:flex-row sm:items-center gap-2\">\r\n                <span className=\"font-medium\">{t(\"admin.recommendedSize\")}:</span>\r\n                <Badge variant=\"secondary\" className=\"w-fit\">\r\n                  <Maximize2 className=\"w-3 h-3 mr-1\" />\r\n                  {RECOMMENDED_WIDTH} √ó {RECOMMENDED_HEIGHT} px\r\n                </Badge>\r\n              </div>\r\n              <p className=\"mt-2 text-muted-foreground text-xs\">\r\n                {t(\"admin.imageSizeHint\")}\r\n              </p>\r\n            </AlertDescription>\r\n          </Alert>\r\n\r\n          <div className=\"relative w-full overflow-hidden rounded-lg border\">\r\n            {imgSrc && (\r\n              <ReactCrop\r\n                crop={crop}\r\n                onChange={(c) => setCrop(c)}\r\n                onComplete={(c) => setCompletedCrop(c)}\r\n                aspect={ASPECT_RATIO}\r\n                className=\"max-h-[50vh] sm:max-h-[60vh]\"\r\n              >\r\n                <img\r\n                  ref={imgRef}\r\n                  src={imgSrc}\r\n                  alt=\"Crop preview\"\r\n                  onLoad={onImageLoad}\r\n                  className=\"max-w-full h-auto\"\r\n                />\r\n              </ReactCrop>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        <DialogFooter className=\"px-4 sm:px-6 pb-4 sm:pb-6 pt-4 border-t gap-2 sm:gap-0\">\r\n          <Button\r\n            type=\"button\"\r\n            variant=\"outline\"\r\n            onClick={() => onOpenChange(false)}\r\n            disabled={isCropping}\r\n            className=\"w-full sm:w-auto\"\r\n          >\r\n            {t(\"common.cancel\")}\r\n          </Button>\r\n          <Button\r\n            type=\"button\"\r\n            onClick={handleCropConfirm}\r\n            disabled={!completedCrop || isCropping}\r\n            className=\"w-full sm:w-auto\"\r\n          >\r\n            {isCropping ? t(\"common.processing\") : t(\"admin.confirmCrop\")}\r\n          </Button>\r\n        </DialogFooter>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}\r\n","import { useState, useEffect } from \"react\";\r\nimport { useForm, Controller } from \"react-hook-form\";\r\nimport { zodResolver } from \"@hookform/resolvers/zod\";\r\nimport * as z from \"zod\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Calendar } from \"@/components/ui/calendar\";\r\nimport { Popover, PopoverContent, PopoverTrigger } from \"@/components/ui/popover\";\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\r\nimport { Checkbox } from \"@/components/ui/checkbox\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\nimport { CalendarIcon, Upload, X, Globe, Pin, ArrowUpDown, Store, FileEdit, Send, Image, Video, Plus, Trash2, Search } from \"lucide-react\";\r\n\r\n// Type for date range\r\ninterface DateRange {\r\n  start: number;\r\n  end: number;\r\n}\r\nimport { format } from \"date-fns\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { toast } from \"sonner\";\r\nimport { useRestaurants } from \"@/hooks/useRestaurants\";\r\nimport { useQueryClient } from \"@tanstack/react-query\";\r\nimport { RichTextEditor } from \"./RichTextEditor\";\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Card, CardContent } from \"@/components/ui/card\";\r\nimport { ImageCropDialog } from \"./ImageCropDialog\";\r\nimport i18n from \"@/i18n/config\";\r\n\r\n// Draft schema - no required fields except status\r\nconst draftSchema = z.object({\r\n  title_en: z.string().optional(),\r\n  title_zh: z.string().optional(),\r\n  title_pt: z.string().optional(),\r\n  intro_zh: z.string().optional(),\r\n  intro_en: z.string().optional(),\r\n  intro_pt: z.string().optional(),\r\n  content_en: z.string().optional(),\r\n  content_zh: z.string().optional(),\r\n  content_pt: z.string().optional(),\r\n  usage_instructions_zh: z.string().optional(),\r\n  usage_instructions_en: z.string().optional(),\r\n  usage_instructions_pt: z.string().optional(),\r\n  start_date: z.date().optional(),\r\n  end_date: z.date().optional(),\r\n  repeat_mode: z.enum([\"none\", \"daily\", \"weekly\", \"monthly\", \"yearly\", \"days_before\"]).optional(),\r\n  repeat_weekday: z.number().min(0).max(6).optional().nullable(),\r\n  repeat_days_before: z.number().min(0).max(30).optional().nullable(),\r\n  repeat_month_day: z.array(z.object({ start: z.number().min(1).max(31), end: z.number().min(1).max(31) })).optional().nullable(),\r\n  repeat_yearly_month: z.number().min(1).max(12).optional().nullable(),\r\n  repeat_yearly_day: z.number().min(1).max(31).optional().nullable(),\r\n  service_type: z.enum([\"dine_in\", \"takeaway\", \"both\"]).optional(),\r\n  status: z.enum([\"draft\", \"published\"]).default(\"draft\"),\r\n  pinned: z.boolean().default(false),\r\n  visible: z.boolean().default(false),\r\n  sort_order: z.number().default(0),\r\n  badge_text_zh: z.string().optional(),\r\n  badge_text_en: z.string().optional(),\r\n  badge_text_pt: z.string().optional(),\r\n  badge_color: z.string().optional(),\r\n  discount_type: z.enum([\"percentage\", \"fixed_amount\"]).optional().nullable(),\r\n  discount_value: z.number().optional().nullable(),\r\n  discount_key: z.string().optional().nullable()\r\n});\r\n\r\n// Published schema - with required fields\r\nconst publishedSchema = z.object({\r\n  title_en: z.string().min(1, i18n.t(\"validation.titleRequired\")),\r\n  title_zh: z.string().min(1, i18n.t(\"validation.titleRequired\")),\r\n  title_pt: z.string().min(1, i18n.t(\"validation.titleRequired\")),\r\n  intro_zh: z.string().optional(),\r\n  intro_en: z.string().optional(),\r\n  intro_pt: z.string().optional(),\r\n  content_en: z.string().min(1, i18n.t(\"validation.contentRequired\")),\r\n  content_zh: z.string().min(1, i18n.t(\"validation.contentRequired\")),\r\n  content_pt: z.string().min(1, i18n.t(\"validation.contentRequired\")),\r\n  usage_instructions_zh: z.string().optional(),\r\n  usage_instructions_en: z.string().optional(),\r\n  usage_instructions_pt: z.string().optional(),\r\n  start_date: z.date(),\r\n  end_date: z.date().optional(),\r\n  repeat_mode: z.enum([\"none\", \"daily\", \"weekly\", \"monthly\", \"yearly\", \"days_before\"]),\r\n  repeat_weekday: z.number().min(0).max(6).optional().nullable(),\r\n  repeat_days_before: z.number().min(0).max(30).optional().nullable(),\r\n  repeat_month_day: z.array(z.object({ start: z.number().min(1).max(31), end: z.number().min(1).max(31) })).optional().nullable(),\r\n  repeat_yearly_month: z.number().min(1).max(12).optional().nullable(),\r\n  repeat_yearly_day: z.number().min(1).max(31).optional().nullable(),\r\n  service_type: z.enum([\"dine_in\", \"takeaway\", \"both\"]),\r\n  status: z.enum([\"draft\", \"published\"]).default(\"published\"),\r\n  pinned: z.boolean().default(false),\r\n  visible: z.boolean().default(true),\r\n  sort_order: z.number().default(0),\r\n  badge_text_zh: z.string().optional(),\r\n  badge_text_en: z.string().optional(),\r\n  badge_text_pt: z.string().optional(),\r\n  badge_color: z.string().optional(),\r\n  discount_type: z.enum([\"percentage\", \"fixed_amount\"]).optional().nullable(),\r\n  discount_value: z.number().optional().nullable(),\r\n  discount_key: z.string().optional().nullable()\r\n});\r\n\r\n// Base schema for form (uses draft schema, validation happens on submit)\r\nconst activitySchema = draftSchema;\r\ntype ActivityFormData = z.infer<typeof activitySchema>;\r\ninterface ActivityFormDialogProps {\r\n  activity?: any;\r\n  trigger: React.ReactNode;\r\n}\r\nexport function ActivityFormDialog({\r\n  activity,\r\n  trigger\r\n}: ActivityFormDialogProps) {\r\n  const {\r\n    t\r\n  } = useTranslation();\r\n  const queryClient = useQueryClient();\r\n  const [open, setOpen] = useState(false);\r\n  const [imageFile, setImageFile] = useState<File | null>(null);\r\n  const [imagePreview, setImagePreview] = useState<string | null>(activity?.image_url || null);\r\n  const [selectedRestaurants, setSelectedRestaurants] = useState<string[]>([]);\r\n  const [restaurantSearch, setRestaurantSearch] = useState(\"\");\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [showCropDialog, setShowCropDialog] = useState(false);\r\n  const [tempImageFile, setTempImageFile] = useState<File | null>(null);\r\n  const [mediaType, setMediaType] = useState<\"image\" | \"video\">(activity?.media_type === \"video\" ? \"video\" : \"image\");\r\n  const [videoFile, setVideoFile] = useState<File | null>(null);\r\n  const [videoPreview, setVideoPreview] = useState<string | null>(activity?.video_url || null);\r\n  const [isUploadingVideo, setIsUploadingVideo] = useState(false);\r\n  const [videoDeleted, setVideoDeleted] = useState(false);\r\n  const {\r\n    data: restaurants\r\n  } = useRestaurants();\r\n  const getDefaultValues = (): ActivityFormData => activity ? {\r\n    title_en: activity.title_en,\r\n    title_zh: activity.title_zh,\r\n    title_pt: activity.title_pt,\r\n    intro_zh: activity.intro_zh || \"\",\r\n    intro_en: activity.intro_en || \"\",\r\n    intro_pt: activity.intro_pt || \"\",\r\n    content_en: activity.content_en,\r\n    content_zh: activity.content_zh,\r\n    content_pt: activity.content_pt,\r\n    usage_instructions_zh: activity.usage_instructions_zh || \"\",\r\n    usage_instructions_en: activity.usage_instructions_en || \"\",\r\n    usage_instructions_pt: activity.usage_instructions_pt || \"\",\r\n    start_date: new Date(activity.start_date),\r\n    end_date: activity.end_date ? new Date(activity.end_date) : undefined,\r\n    repeat_mode: (activity.repeat_mode || \"none\") as \"none\" | \"daily\" | \"weekly\" | \"monthly\" | \"yearly\" | \"days_before\",\r\n    repeat_weekday: activity.repeat_weekday ?? null,\r\n    repeat_days_before: activity.repeat_days_before ?? null,\r\n    repeat_month_day: Array.isArray(activity.repeat_month_day) ? activity.repeat_month_day : null,\r\n    repeat_yearly_month: activity.repeat_yearly_month ?? null,\r\n    repeat_yearly_day: activity.repeat_yearly_day ?? null,\r\n    service_type: (activity.service_type || \"both\") as \"dine_in\" | \"takeaway\" | \"both\",\r\n    status: (activity.status || \"draft\") as \"draft\" | \"published\",\r\n    pinned: activity.pinned || false,\r\n    visible: activity.visible !== undefined ? activity.visible : true,\r\n    sort_order: activity.sort_order || 0,\r\n    badge_text_zh: activity.badge_text_zh || activity.title_zh,\r\n    badge_text_en: activity.badge_text_en || activity.title_en,\r\n    badge_text_pt: activity.badge_text_pt || activity.title_pt,\r\n    badge_color: activity.badge_color || \"#9b87f5\",\r\n    discount_type: activity.discount_type || null,\r\n    discount_value: activity.discount_value || null,\r\n    discount_key: activity.discount_key || null\r\n  } : {\r\n    repeat_mode: \"none\" as const,\r\n    repeat_weekday: null,\r\n    repeat_days_before: null,\r\n    repeat_month_day: null,\r\n    repeat_yearly_month: null,\r\n    repeat_yearly_day: null,\r\n    service_type: \"both\" as const,\r\n    status: \"draft\" as const,\r\n    pinned: false,\r\n    visible: false,\r\n    sort_order: 0,\r\n    badge_color: \"#9b87f5\",\r\n    discount_type: null,\r\n    discount_value: null,\r\n    discount_key: null\r\n  };\r\n\r\n  const {\r\n    register,\r\n    handleSubmit,\r\n    formState: {\r\n      errors\r\n    },\r\n    setValue,\r\n    watch,\r\n    control,\r\n    reset\r\n  } = useForm<ActivityFormData>({\r\n    resolver: zodResolver(activitySchema),\r\n    defaultValues: getDefaultValues()\r\n  });\r\n\r\n  // Reset form when dialog opens or closes\r\n  const handleOpenChange = (newOpen: boolean) => {\r\n    if (newOpen) {\r\n      // Reset form to latest data when opening\r\n      reset(getDefaultValues());\r\n      setImageFile(null);\r\n      setImagePreview(activity?.image_url || null);\r\n      setVideoFile(null);\r\n      setVideoPreview(activity?.video_url || null);\r\n      setVideoDeleted(false);\r\n      setMediaType(activity?.media_type === \"video\" ? \"video\" : \"image\");\r\n      setIsUploadingVideo(false);\r\n      setShowCropDialog(false);\r\n      setTempImageFile(null);\r\n      setRestaurantSearch(\"\");\r\n    } else {\r\n      // Reset form to original values when closing\r\n      reset(getDefaultValues());\r\n      setImageFile(null);\r\n      setImagePreview(activity?.image_url || null);\r\n      setVideoFile(null);\r\n      setVideoPreview(activity?.video_url || null);\r\n      setVideoDeleted(false);\r\n      setMediaType(activity?.media_type === \"video\" ? \"video\" : \"image\");\r\n    }\r\n    setOpen(newOpen);\r\n  };\r\n  const startDate = watch(\"start_date\");\r\n  const endDate = watch(\"end_date\");\r\n  const pinned = watch(\"pinned\");\r\n  const visible = watch(\"visible\");\r\n  const status = watch(\"status\");\r\n\r\n  // Sync visible with status - draft always has visible=false\r\n  useEffect(() => {\r\n    if (status === \"draft\") {\r\n      setValue(\"visible\", false);\r\n      setValue(\"pinned\", false);\r\n    }\r\n  }, [status, setValue]);\r\n\r\n  // Load associated restaurants when editing\r\n  useEffect(() => {\r\n    const loadAssociatedRestaurants = async () => {\r\n      if (activity?.id) {\r\n        const {\r\n          data\r\n        } = await supabase.from(\"activity_restaurants\").select(\"restaurant_id\").eq(\"activity_id\", activity.id);\r\n        if (data) {\r\n          setSelectedRestaurants(data.map(ar => ar.restaurant_id));\r\n        }\r\n      }\r\n    };\r\n    loadAssociatedRestaurants();\r\n  }, [activity?.id]);\r\n  const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (file) {\r\n      // Check file size (max 10MB)\r\n      if (file.size > 10 * 1024 * 1024) {\r\n        toast.error(t(\"admin.imageTooBig\"));\r\n        return;\r\n      }\r\n      setTempImageFile(file);\r\n      setShowCropDialog(true);\r\n    }\r\n    // Reset input\r\n    e.target.value = \"\";\r\n  };\r\n\r\n  const handleCropComplete = (croppedFile: File, preview: string) => {\r\n    setImageFile(croppedFile);\r\n    setImagePreview(preview);\r\n  };\r\n\r\n  const handleVideoChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (file) {\r\n      // Check file size (max 100MB)\r\n      if (file.size > 100 * 1024 * 1024) {\r\n        toast.error(t(\"admin.videoTooBig\") || \"ËßÜÈ¢ëÊñá‰ª∂ËøáÂ§ßÔºàÊúÄÂ§ß100MBÔºâ\");\r\n        return;\r\n      }\r\n      // Check file type\r\n      if (!file.type.startsWith(\"video/\")) {\r\n        toast.error(t(\"admin.invalidVideoFormat\") || \"ËØ∑‰∏ä‰º†ËßÜÈ¢ëÊñá‰ª∂\");\r\n        return;\r\n      }\r\n      setVideoFile(file);\r\n      setVideoPreview(URL.createObjectURL(file));\r\n      setVideoDeleted(false); // Reset deleted flag when new video is uploaded\r\n    }\r\n    e.target.value = \"\";\r\n  };\r\n\r\n  const uploadImage = async (): Promise<string | null> => {\r\n    if (!imageFile) return activity?.image_url || null;\r\n    const fileExt = imageFile.name.split(\".\").pop();\r\n    const fileName = `${Math.random()}.${fileExt}`;\r\n    const filePath = `${fileName}`;\r\n    const {\r\n      error: uploadError\r\n    } = await supabase.storage.from(\"activity-images\").upload(filePath, imageFile);\r\n    if (uploadError) {\r\n      throw uploadError;\r\n    }\r\n    const {\r\n      data: {\r\n        publicUrl\r\n      }\r\n    } = supabase.storage.from(\"activity-images\").getPublicUrl(filePath);\r\n    return publicUrl;\r\n  };\r\n\r\n  const uploadVideo = async (): Promise<string | null> => {\r\n    // If user explicitly deleted video, return null\r\n    if (videoDeleted && !videoFile) return null;\r\n    if (!videoFile) return activity?.video_url || null;\r\n    setIsUploadingVideo(true);\r\n    try {\r\n      const fileExt = videoFile.name.split(\".\").pop();\r\n      const fileName = `video_${Date.now()}.${fileExt}`;\r\n      const { error: uploadError } = await supabase.storage\r\n        .from(\"activity-images\")\r\n        .upload(fileName, videoFile);\r\n      if (uploadError) throw uploadError;\r\n      const { data: { publicUrl } } = supabase.storage\r\n        .from(\"activity-images\")\r\n        .getPublicUrl(fileName);\r\n      return publicUrl;\r\n    } finally {\r\n      setIsUploadingVideo(false);\r\n    }\r\n  };\r\n  const onSubmit = async (data: ActivityFormData) => {\r\n    setIsSubmitting(true);\r\n    try {\r\n      // If publishing, validate with publishedSchema\r\n      if (data.status === \"published\") {\r\n        const publishedResult = publishedSchema.safeParse(data);\r\n        if (!publishedResult.success) {\r\n          // Map field names to readable labels\r\n          const fieldLabels: Record<string, string> = {\r\n            title_zh: t(\"admin.titleChinese\"),\r\n            title_en: t(\"admin.titleEnglish\"),\r\n            title_pt: t(\"admin.titlePortuguese\"),\r\n            content_zh: t(\"admin.contentChinese\"),\r\n            content_en: t(\"admin.contentEnglish\"),\r\n            content_pt: t(\"admin.contentPortuguese\"),\r\n            start_date: t(\"admin.startDate\"),\r\n            end_date: t(\"admin.endDate\"),\r\n            repeat_mode: t(\"admin.repeatMode\"),\r\n            service_type: t(\"admin.serviceType\")\r\n          };\r\n          \r\n          // Collect all missing fields\r\n          const missingFields = publishedResult.error.errors.map(err => {\r\n            const fieldPath = err.path.join(\".\");\r\n            return fieldLabels[fieldPath] || fieldPath;\r\n          });\r\n          \r\n          // Show all missing fields in toast\r\n          toast.error(`${t(\"admin.publishRequiresComplete\")}: ${missingFields.join(\", \")}`);\r\n          setIsSubmitting(false);\r\n          return;\r\n        }\r\n      }\r\n\r\n      const {\r\n        data: {\r\n          user\r\n        }\r\n      } = await supabase.auth.getUser();\r\n      if (!user) throw new Error(\"Not authenticated\");\r\n      // Upload image and video in parallel for better performance\r\n      const [imageUrl, videoUrl] = await Promise.all([\r\n        uploadImage(),\r\n        uploadVideo()\r\n      ]);\r\n\r\n      // Draft activities always have visible=false\r\n      const finalVisible = data.status === \"draft\" ? false : data.visible;\r\n\r\n      // Base activity data for both create and update\r\n      const baseActivityData = {\r\n        title_en: data.title_en || \"\",\r\n        title_zh: data.title_zh || \"\",\r\n        title_pt: data.title_pt || \"\",\r\n        intro_zh: data.intro_zh || null,\r\n        intro_en: data.intro_en || null,\r\n        intro_pt: data.intro_pt || null,\r\n        content_en: data.content_en || \"\",\r\n        content_zh: data.content_zh || \"\",\r\n        content_pt: data.content_pt || \"\",\r\n        usage_instructions_zh: data.usage_instructions_zh || null,\r\n        usage_instructions_en: data.usage_instructions_en || null,\r\n        usage_instructions_pt: data.usage_instructions_pt || null,\r\n        repeat_mode: data.repeat_mode || \"none\",\r\n        repeat_weekday: data.repeat_mode === 'weekly' ? data.repeat_weekday : null,\r\n        repeat_days_before: data.repeat_mode === 'days_before' ? data.repeat_days_before : null,\r\n        repeat_month_day: data.repeat_mode === 'monthly' ? data.repeat_month_day : null,\r\n        repeat_yearly_month: data.repeat_mode === 'yearly' ? data.repeat_yearly_month : null,\r\n        repeat_yearly_day: data.repeat_mode === 'yearly' ? data.repeat_yearly_day : null,\r\n        service_type: data.service_type || \"both\",\r\n        status: data.status,\r\n        pinned: data.status === \"draft\" ? false : data.pinned,\r\n        visible: finalVisible,\r\n        sort_order: data.sort_order,\r\n        image_url: imageUrl,\r\n        media_type: mediaType,\r\n        video_url: videoUrl,\r\n        start_date: data.start_date?.toISOString() || new Date().toISOString(),\r\n        end_date: data.end_date?.toISOString() || null,\r\n        badge_text_zh: data.badge_text_zh || data.title_zh || \"\",\r\n        badge_text_en: data.badge_text_en || data.title_en || \"\",\r\n        badge_text_pt: data.badge_text_pt || data.title_pt || \"\",\r\n        badge_color: data.badge_color || \"#9b87f5\",\r\n        discount_type: data.discount_type || null,\r\n        discount_value: data.discount_value || null,\r\n        discount_key: data.discount_key || null\r\n      };\r\n      if (activity) {\r\n        // Update activity - don't change creator_id\r\n        const {\r\n          error\r\n        } = await supabase.from(\"activities\").update(baseActivityData).eq(\"id\", activity.id);\r\n        if (error) throw error;\r\n\r\n        // Update restaurant associations\r\n        await supabase.from(\"activity_restaurants\").delete().eq(\"activity_id\", activity.id);\r\n        if (selectedRestaurants.length > 0) {\r\n          const associations = selectedRestaurants.map(restaurantId => ({\r\n            activity_id: activity.id,\r\n            restaurant_id: restaurantId\r\n          }));\r\n          const {\r\n            error: assocError\r\n          } = await supabase.from(\"activity_restaurants\").insert(associations);\r\n          if (assocError) throw assocError;\r\n        }\r\n        toast.success(t(\"admin.activityUpdated\"));\r\n        setOpen(false);\r\n      } else {\r\n        // Create activity - set creator_id for new activities\r\n        const activityDataWithCreator = {\r\n          ...baseActivityData,\r\n          creator_id: user.id\r\n        };\r\n        const {\r\n          data: newActivity,\r\n          error\r\n        } = await supabase.from(\"activities\").insert([activityDataWithCreator]).select().single();\r\n        if (error) throw error;\r\n\r\n        // Add restaurant associations\r\n        if (selectedRestaurants.length > 0) {\r\n          const associations = selectedRestaurants.map(restaurantId => ({\r\n            activity_id: newActivity.id,\r\n            restaurant_id: restaurantId\r\n          }));\r\n          const {\r\n            error: assocError\r\n          } = await supabase.from(\"activity_restaurants\").insert(associations);\r\n          if (assocError) throw assocError;\r\n        }\r\n\r\n        // Auto-link coupon templates with auto_link_activities enabled\r\n        const { data: autoLinkTemplates } = await supabase\r\n          .from(\"coupon_templates\")\r\n          .select(\"id\")\r\n          .eq(\"auto_link_activities\", true)\r\n          .eq(\"is_active\", true);\r\n\r\n        if (autoLinkTemplates && autoLinkTemplates.length > 0) {\r\n          const couponAssociations = autoLinkTemplates.map(template => ({\r\n            coupon_template_id: template.id,\r\n            activity_id: newActivity.id\r\n          }));\r\n          await supabase\r\n            .from(\"coupon_template_activities\")\r\n            .insert(couponAssociations);\r\n        }\r\n\r\n        toast.success(t(\"admin.activityCreated\"));\r\n        setOpen(false);\r\n      }\r\n      queryClient.invalidateQueries({\r\n        queryKey: [\"activities\"]\r\n      });\r\n      queryClient.invalidateQueries({\r\n        queryKey: [\"admin-activities\"]\r\n      });\r\n    } catch (error: any) {\r\n      toast.error(error.message || t(\"common.error\"));\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n  return <Dialog open={open} onOpenChange={handleOpenChange}>\r\n      <DialogTrigger asChild>{trigger}</DialogTrigger>\r\n      <DialogContent className=\"max-w-[95vw] sm:max-w-6xl max-h-[95vh] overflow-hidden flex flex-col p-0\">\r\n        <DialogHeader className=\"px-6 pt-6 pb-4 border-b bg-muted/30\">\r\n          <DialogTitle className=\"text-2xl flex items-center gap-2\">\r\n            <Globe className=\"w-6 h-6 text-primary\" />\r\n            {activity ? t(\"admin.editActivity\") : t(\"admin.addActivity\")}\r\n          </DialogTitle>\r\n          <DialogDescription className=\"text-base\">\r\n            {activity ? t(\"admin.editActivityDetails\") : t(\"admin.createActivityWithContent\")}\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        <ScrollArea className=\"px-6 h-[calc(95vh-220px)]\">\r\n          <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-6 py-6\">\r\n            {/* Media Upload */}\r\n            <Card className=\"border-primary/20 bg-gradient-to-br from-background to-muted/20\">\r\n              <CardContent className=\"p-6\">\r\n                <Label className=\"text-base font-semibold flex items-center gap-2 mb-4\">\r\n                  <Upload className=\"w-5 h-5 text-primary\" />\r\n                  {t(\"admin.activityMedia\") || \"Ê¥ªÂä®Â™í‰Ωì\"}\r\n                </Label>\r\n                \r\n                {/* Media Type Selector */}\r\n                <div className=\"flex gap-2 mb-4\">\r\n                  <Button\r\n                    type=\"button\"\r\n                    variant={mediaType === \"image\" ? \"default\" : \"outline\"}\r\n                    size=\"sm\"\r\n                    onClick={() => setMediaType(\"image\")}\r\n                    className=\"flex items-center gap-2\"\r\n                  >\r\n                    <Image className=\"w-4 h-4\" />\r\n                    {t(\"admin.image\") || \"ÂõæÁâá\"}\r\n                  </Button>\r\n                  <Button\r\n                    type=\"button\"\r\n                    variant={mediaType === \"video\" ? \"default\" : \"outline\"}\r\n                    size=\"sm\"\r\n                    onClick={() => setMediaType(\"video\")}\r\n                    className=\"flex items-center gap-2\"\r\n                  >\r\n                    <Video className=\"w-4 h-4\" />\r\n                    {t(\"admin.video\") || \"ËßÜÈ¢ë\"}\r\n                  </Button>\r\n                </div>\r\n\r\n                {/* Image Upload */}\r\n                {mediaType === \"image\" && (\r\n                  <div className=\"flex items-center gap-6\">\r\n                    {imagePreview && (\r\n                      <div className=\"relative group\">\r\n                        <img src={imagePreview} alt=\"Preview\" className=\"w-40 h-40 object-cover rounded-lg shadow-lg ring-2 ring-primary/20 transition-transform duration-200 group-hover:scale-105\" />\r\n                        <Button type=\"button\" variant=\"destructive\" size=\"icon\" className=\"absolute -top-2 -right-2 h-8 w-8 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity\" onClick={() => {\r\n                          setImageFile(null);\r\n                          setImagePreview(null);\r\n                        }}>\r\n                          <X className=\"h-4 w-4\" />\r\n                        </Button>\r\n                      </div>\r\n                    )}\r\n                    <Label htmlFor=\"image-upload\" className=\"cursor-pointer\">\r\n                      <div className=\"flex flex-col items-center gap-3 px-8 py-6 border-2 border-dashed border-primary/30 rounded-lg hover:border-primary hover:bg-primary/5 transition-all duration-200\">\r\n                        <Upload className=\"h-8 w-8 text-primary\" />\r\n                        <div className=\"text-center\">\r\n                          <p className=\"font-medium text-sm\">{t(\"admin.uploadImage\")}</p>\r\n                          <p className=\"text-xs text-muted-foreground mt-1\">{t(\"admin.imageMaxSize\")}</p>\r\n                        </div>\r\n                      </div>\r\n                      <Input id=\"image-upload\" type=\"file\" accept=\"image/*\" className=\"hidden\" onChange={handleImageChange} />\r\n                    </Label>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Video Upload */}\r\n                {mediaType === \"video\" && (\r\n                  <div className=\"space-y-4\">\r\n                    <div className=\"flex items-center gap-6\">\r\n                      {videoPreview && (\r\n                        <div className=\"relative group\">\r\n                          <video \r\n                            src={videoPreview} \r\n                            className=\"w-40 h-40 object-cover rounded-lg shadow-lg ring-2 ring-primary/20\"\r\n                            muted\r\n                            loop\r\n                            playsInline\r\n                            onMouseEnter={(e) => e.currentTarget.play()}\r\n                            onMouseLeave={(e) => {\r\n                              e.currentTarget.pause();\r\n                              e.currentTarget.currentTime = 0;\r\n                            }}\r\n                          />\r\n                          <Button type=\"button\" variant=\"destructive\" size=\"icon\" className=\"absolute -top-2 -right-2 h-8 w-8 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity\" onClick={() => {\r\n                            setVideoFile(null);\r\n                            setVideoPreview(null);\r\n                            setVideoDeleted(true);\r\n                          }}>\r\n                            <X className=\"h-4 w-4\" />\r\n                          </Button>\r\n                        </div>\r\n                      )}\r\n                      <Label htmlFor=\"video-upload\" className=\"cursor-pointer\">\r\n                        <div className=\"flex flex-col items-center gap-3 px-8 py-6 border-2 border-dashed border-primary/30 rounded-lg hover:border-primary hover:bg-primary/5 transition-all duration-200\">\r\n                          <Video className=\"h-8 w-8 text-primary\" />\r\n                          <div className=\"text-center\">\r\n                            <p className=\"font-medium text-sm\">{t(\"admin.uploadVideo\") || \"‰∏ä‰º†ËßÜÈ¢ë\"}</p>\r\n                            <p className=\"text-xs text-muted-foreground mt-1\">{t(\"admin.videoMaxSize\") || \"ÊúÄÂ§ß 50MB\"}</p>\r\n                          </div>\r\n                        </div>\r\n                        <Input id=\"video-upload\" type=\"file\" accept=\"video/*\" className=\"hidden\" onChange={handleVideoChange} />\r\n                      </Label>\r\n                    </div>\r\n                    \r\n                    {/* Fallback Image for Video */}\r\n                    <div className=\"pt-4 border-t\">\r\n                      <Label className=\"text-sm font-medium mb-2 block\">{t(\"admin.fallbackImage\") || \"Â∞ÅÈù¢ÂõæÁâáÔºàÂèØÈÄâÔºâ\"}</Label>\r\n                      <p className=\"text-xs text-muted-foreground mb-3\">{t(\"admin.fallbackImageDesc\") || \"ËßÜÈ¢ëÂä†ËΩΩÂâçÊòæÁ§∫ÁöÑÂ∞ÅÈù¢Âõæ\"}</p>\r\n                      <div className=\"flex items-center gap-4\">\r\n                        {imagePreview && (\r\n                          <div className=\"relative group\">\r\n                            <img src={imagePreview} alt=\"Fallback\" className=\"w-20 h-20 object-cover rounded-lg shadow ring-2 ring-primary/20\" />\r\n                            <Button type=\"button\" variant=\"destructive\" size=\"icon\" className=\"absolute -top-1 -right-1 h-6 w-6 shadow opacity-0 group-hover:opacity-100 transition-opacity\" onClick={() => {\r\n                              setImageFile(null);\r\n                              setImagePreview(null);\r\n                            }}>\r\n                              <X className=\"h-3 w-3\" />\r\n                            </Button>\r\n                          </div>\r\n                        )}\r\n                        <Label htmlFor=\"fallback-image-upload\" className=\"cursor-pointer\">\r\n                          <div className=\"flex items-center gap-2 px-4 py-2 border border-dashed border-primary/30 rounded-lg hover:border-primary hover:bg-primary/5 transition-all text-sm\">\r\n                            <Image className=\"h-4 w-4 text-primary\" />\r\n                            <span>{t(\"admin.uploadFallback\") || \"‰∏ä‰º†Â∞ÅÈù¢\"}</span>\r\n                          </div>\r\n                          <Input id=\"fallback-image-upload\" type=\"file\" accept=\"image/*\" className=\"hidden\" onChange={handleImageChange} />\r\n                        </Label>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Multi-language Content with Tabs */}\r\n            <Card className=\"border-primary/20\">\r\n              <CardContent className=\"p-6\">\r\n                <Label className=\"text-base font-semibold flex items-center gap-2 mb-4\">\r\n                  <Globe className=\"w-5 h-5 text-primary\" />\r\n                  {t(\"admin.multilingualContent\")}\r\n                </Label>\r\n                <Tabs defaultValue=\"zh\" className=\"w-full\">\r\n                  <TabsList className=\"grid w-full grid-cols-3 mb-6\">\r\n                    <TabsTrigger value=\"zh\" className=\"gap-2\">\r\n                      üá®üá≥ {t(\"admin.chinese\")}\r\n                    </TabsTrigger>\r\n                    <TabsTrigger value=\"en\" className=\"gap-2\">\r\n                      üá¨üáß {t(\"admin.english\")}\r\n                    </TabsTrigger>\r\n                    <TabsTrigger value=\"pt\" className=\"gap-2\">\r\n                      üáµüáπ {t(\"admin.portuguese\")}\r\n                    </TabsTrigger>\r\n                  </TabsList>\r\n                  \r\n                  <TabsContent value=\"zh\" className=\"space-y-4 mt-0\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"title_zh\" className=\"text-sm font-medium\">{t(\"admin.title\")}</Label>\r\n                      <Input id=\"title_zh\" {...register(\"title_zh\")} placeholder={t(\"admin.enterTitle\")} className=\"text-base\" />\r\n                      {errors.title_zh && <p className=\"text-sm text-destructive\">{errors.title_zh.message}</p>}\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"intro_zh\" className=\"text-sm font-medium\">Ê¥ªÂä®ÁÆÄ‰ªã</Label>\r\n                      <Input id=\"intro_zh\" {...register(\"intro_zh\")} placeholder=\"ÁÆÄÁü≠ÊèèËø∞Ê¥ªÂä®ÔºàÊòæÁ§∫Âú®È§êÂéÖËØ¶ÊÉÖÈ°µÔºâ\" className=\"text-base\" />\r\n                      <p className=\"text-xs text-muted-foreground\">Âú®È§êÂéÖËØ¶ÊÉÖÈ°µÊ¥ªÂä®Ê†áÁ≠æÂêéÊòæÁ§∫ÁöÑÁÆÄÁü≠ËØ¥Êòé</p>\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"content_zh\" className=\"text-sm font-medium\">{t(\"admin.content\")}</Label>\r\n                      <Controller name=\"content_zh\" control={control} render={({\r\n                      field\r\n                    }) => <RichTextEditor value={field.value} onChange={field.onChange} placeholder={t(\"admin.enterContent\")} />} />\r\n                      {errors.content_zh && <p className=\"text-sm text-destructive\">{errors.content_zh.message}</p>}\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"usage_instructions_zh\" className=\"text-sm font-medium\">Ê¥ªÂä®‰ΩøÁî®ÊñπÊ≥ï</Label>\r\n                      <Controller name=\"usage_instructions_zh\" control={control} render={({\r\n                      field\r\n                    }) => <RichTextEditor value={field.value || \"\"} onChange={field.onChange} placeholder=\"ÊèèËø∞Â¶Ç‰Ωï‰ΩøÁî®Ê≠§Ê¥ªÂä®ÔºàÂèØÈÄâÔºâ\" />} />\r\n                      <p className=\"text-xs text-muted-foreground\">ÂêëÁî®Êà∑ËØ¥ÊòéÂ¶Ç‰ΩïÂèÇ‰∏éÂíå‰ΩøÁî®Ê≠§Ê¥ªÂä®</p>\r\n                    </div>\r\n                  </TabsContent>\r\n                  \r\n                  <TabsContent value=\"en\" className=\"space-y-4 mt-0\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"title_en\" className=\"text-sm font-medium\">{t(\"admin.title\")}</Label>\r\n                      <Input id=\"title_en\" {...register(\"title_en\")} placeholder={t(\"admin.enterTitle\")} className=\"text-base\" />\r\n                      {errors.title_en && <p className=\"text-sm text-destructive\">{errors.title_en.message}</p>}\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"intro_en\" className=\"text-sm font-medium\">Activity Brief</Label>\r\n                      <Input id=\"intro_en\" {...register(\"intro_en\")} placeholder=\"Short description (shown on restaurant details)\" className=\"text-base\" />\r\n                      <p className=\"text-xs text-muted-foreground\">Brief description shown after activity badge on restaurant page</p>\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"content_en\" className=\"text-sm font-medium\">{t(\"admin.content\")}</Label>\r\n                      <Controller name=\"content_en\" control={control} render={({\r\n                      field\r\n                    }) => <RichTextEditor value={field.value} onChange={field.onChange} placeholder={t(\"admin.enterContent\")} />} />\r\n                      {errors.content_en && <p className=\"text-sm text-destructive\">{errors.content_en.message}</p>}\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"usage_instructions_en\" className=\"text-sm font-medium\">Usage Instructions</Label>\r\n                      <Controller name=\"usage_instructions_en\" control={control} render={({\r\n                      field\r\n                    }) => <RichTextEditor value={field.value || \"\"} onChange={field.onChange} placeholder=\"Describe how to use this activity (optional)\" />} />\r\n                      <p className=\"text-xs text-muted-foreground\">Explain to users how to participate and use this activity</p>\r\n                    </div>\r\n                  </TabsContent>\r\n                  \r\n                  <TabsContent value=\"pt\" className=\"space-y-4 mt-0\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"title_pt\" className=\"text-sm font-medium\">{t(\"admin.title\")}</Label>\r\n                      <Input id=\"title_pt\" {...register(\"title_pt\")} placeholder={t(\"admin.enterTitle\")} className=\"text-base\" />\r\n                      {errors.title_pt && <p className=\"text-sm text-destructive\">{errors.title_pt.message}</p>}\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"intro_pt\" className=\"text-sm font-medium\">Resumo da Atividade</Label>\r\n                      <Input id=\"intro_pt\" {...register(\"intro_pt\")} placeholder=\"Descri√ß√£o curta (exibida nos detalhes do restaurante)\" className=\"text-base\" />\r\n                      <p className=\"text-xs text-muted-foreground\">Breve descri√ß√£o exibida ap√≥s o distintivo da atividade na p√°gina do restaurante</p>\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"content_pt\" className=\"text-sm font-medium\">{t(\"admin.content\")}</Label>\r\n                      <Controller name=\"content_pt\" control={control} render={({\r\n                      field\r\n                    }) => <RichTextEditor value={field.value} onChange={field.onChange} placeholder={t(\"admin.enterContent\")} />} />\r\n                      {errors.content_pt && <p className=\"text-sm text-destructive\">{errors.content_pt.message}</p>}\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"usage_instructions_pt\" className=\"text-sm font-medium\">Instru√ß√µes de Uso</Label>\r\n                      <Controller name=\"usage_instructions_pt\" control={control} render={({\r\n                      field\r\n                    }) => <RichTextEditor value={field.value || \"\"} onChange={field.onChange} placeholder=\"Descreva como usar esta atividade (opcional)\" />} />\r\n                      <p className=\"text-xs text-muted-foreground\">Explique aos usu√°rios como participar e usar esta atividade</p>\r\n                    </div>\r\n                  </TabsContent>\r\n                </Tabs>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Date Range and Settings */}\r\n            <Card className=\"border-primary/20\">\r\n              <CardContent className=\"p-6 space-y-6\">\r\n                <div>\r\n                  <Label className=\"text-base font-semibold flex items-center gap-2 mb-4\">\r\n                    <CalendarIcon className=\"w-5 h-5 text-primary\" />\r\n                    {t(\"admin.dateSettings\")}\r\n                  </Label>\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label className=\"text-sm font-medium\">{t(\"admin.startDate\")}</Label>\r\n                      <Popover>\r\n                        <PopoverTrigger asChild>\r\n                          <Button variant=\"outline\" className={cn(\"w-full justify-start text-left font-normal h-11\", !startDate && \"text-muted-foreground\")}>\r\n                            <CalendarIcon className=\"mr-2 h-4 w-4\" />\r\n                            {startDate ? format(startDate, \"PPP\") : <span>{t(\"admin.selectDate\")}</span>}\r\n                          </Button>\r\n                        </PopoverTrigger>\r\n                        <PopoverContent className=\"w-auto p-0 z-[100]\" align=\"start\">\r\n                          <Calendar mode=\"single\" selected={startDate} onSelect={date => setValue(\"start_date\", date as Date)} initialFocus className=\"pointer-events-auto\" />\r\n                        </PopoverContent>\r\n                      </Popover>\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label className=\"text-sm font-medium\">{t(\"admin.endDate\")}</Label>\r\n                      <Popover>\r\n                        <PopoverTrigger asChild>\r\n                          <Button variant=\"outline\" className={cn(\"w-full justify-start text-left font-normal h-11\", !endDate && \"text-muted-foreground\")}>\r\n                            <CalendarIcon className=\"mr-2 h-4 w-4\" />\r\n                            {endDate ? format(endDate, \"PPP\") : <span>{t(\"admin.selectDate\")} ({t(\"admin.optional\")})</span>}\r\n                          </Button>\r\n                        </PopoverTrigger>\r\n                        <PopoverContent className=\"w-auto p-0 z-[100]\" align=\"start\">\r\n                          <Calendar mode=\"single\" selected={endDate} onSelect={date => setValue(\"end_date\", date)} initialFocus className=\"pointer-events-auto\" />\r\n                        </PopoverContent>\r\n                      </Popover>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"repeat_mode\" className=\"text-sm font-medium\">{t(\"admin.repeatMode\")}</Label>\r\n                  <Select onValueChange={value => setValue(\"repeat_mode\", value as any)} defaultValue={watch(\"repeat_mode\")}>\r\n                    <SelectTrigger className=\"h-11\">\r\n                      <SelectValue placeholder={t(\"admin.selectRepeatMode\")} />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"none\">{t(\"admin.repeatNone\")}</SelectItem>\r\n                      <SelectItem value=\"daily\">{t(\"admin.repeatDaily\")}</SelectItem>\r\n                      <SelectItem value=\"weekly\">{t(\"admin.repeatWeekly\")}</SelectItem>\r\n                      <SelectItem value=\"monthly\">{t(\"admin.repeatMonthly\")}</SelectItem>\r\n                      <SelectItem value=\"yearly\">{t(\"admin.repeatYearly\")}</SelectItem>\r\n                      <SelectItem value=\"days_before\">{t(\"admin.repeatDaysBefore\")}</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n                \r\n                {/* Weekday selector for weekly repeat mode */}\r\n                {watch(\"repeat_mode\") === \"weekly\" && (\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"repeat_weekday\" className=\"text-sm font-medium\">\r\n                      ÊØèÂë®ÈáçÂ§çÊó• / Weekly on\r\n                    </Label>\r\n                    <Controller\r\n                      name=\"repeat_weekday\"\r\n                      control={control}\r\n                      render={({ field }) => (\r\n                        <Select \r\n                          value={field.value?.toString() || \"\"} \r\n                          onValueChange={(value) => field.onChange(value ? parseInt(value) : null)}\r\n                        >\r\n                          <SelectTrigger className=\"h-11\">\r\n                            <SelectValue placeholder=\"ÈÄâÊã©ÊòüÊúüÂá† / Select day\" />\r\n                          </SelectTrigger>\r\n                          <SelectContent>\r\n                            <SelectItem value=\"1\">Âë®‰∏Ä / Monday</SelectItem>\r\n                            <SelectItem value=\"2\">Âë®‰∫å / Tuesday</SelectItem>\r\n                            <SelectItem value=\"3\">Âë®‰∏â / Wednesday</SelectItem>\r\n                            <SelectItem value=\"4\">Âë®Âõõ / Thursday</SelectItem>\r\n                            <SelectItem value=\"5\">Âë®‰∫î / Friday</SelectItem>\r\n                            <SelectItem value=\"6\">Âë®ÂÖ≠ / Saturday</SelectItem>\r\n                            <SelectItem value=\"0\">Âë®Êó• / Sunday</SelectItem>\r\n                          </SelectContent>\r\n                        </Select>\r\n                      )}\r\n                    />\r\n                    <p className=\"text-xs text-muted-foreground\">\r\n                      ÈÄâÊã©Ê¥ªÂä®ÊØèÂë®ÁîüÊïàÁöÑÊó•Êúü / Select which day this activity is valid each week\r\n                    </p>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Monthly day ranges selector for monthly repeat mode */}\r\n                {watch(\"repeat_mode\") === \"monthly\" && (\r\n                  <div className=\"space-y-3\">\r\n                    <Label className=\"text-sm font-medium\">\r\n                      {t(\"admin.repeatMonthDayLabel\")}\r\n                    </Label>\r\n                    <Controller\r\n                      name=\"repeat_month_day\"\r\n                      control={control}\r\n                      render={({ field }) => {\r\n                        const ranges = (field.value as DateRange[] | null) || [];\r\n                        \r\n                        const addRange = () => {\r\n                          const newRanges = [...ranges, { start: 1, end: 1 }];\r\n                          field.onChange(newRanges);\r\n                        };\r\n                        \r\n                        const removeRange = (index: number) => {\r\n                          const newRanges = ranges.filter((_, i) => i !== index);\r\n                          field.onChange(newRanges.length > 0 ? newRanges : null);\r\n                        };\r\n                        \r\n                        const updateRange = (index: number, key: 'start' | 'end', value: number) => {\r\n                          const newRanges = ranges.map((range, i) => \r\n                            i === index ? { ...range, [key]: value } : range\r\n                          );\r\n                          field.onChange(newRanges);\r\n                        };\r\n                        \r\n                        return (\r\n                          <div className=\"space-y-3\">\r\n                            {ranges.map((range, index) => (\r\n                              <div key={index} className=\"flex items-center gap-2\">\r\n                                <Select \r\n                                  value={range.start.toString()} \r\n                                  onValueChange={(value) => updateRange(index, 'start', parseInt(value))}\r\n                                >\r\n                                  <SelectTrigger className=\"h-10 w-24\">\r\n                                    <SelectValue />\r\n                                  </SelectTrigger>\r\n                                  <SelectContent>\r\n                                    {Array.from({length: 31}, (_, i) => i + 1).map(day => (\r\n                                      <SelectItem key={day} value={day.toString()}>\r\n                                        {day}Êó•\r\n                                      </SelectItem>\r\n                                    ))}\r\n                                  </SelectContent>\r\n                                </Select>\r\n                                <span className=\"text-muted-foreground\">‚Äî</span>\r\n                                <Select \r\n                                  value={range.end.toString()} \r\n                                  onValueChange={(value) => updateRange(index, 'end', parseInt(value))}\r\n                                >\r\n                                  <SelectTrigger className=\"h-10 w-24\">\r\n                                    <SelectValue />\r\n                                  </SelectTrigger>\r\n                                  <SelectContent>\r\n                                    {Array.from({length: 31}, (_, i) => i + 1).map(day => (\r\n                                      <SelectItem key={day} value={day.toString()}>\r\n                                        {day}Êó•\r\n                                      </SelectItem>\r\n                                    ))}\r\n                                  </SelectContent>\r\n                                </Select>\r\n                                <Button\r\n                                  type=\"button\"\r\n                                  variant=\"ghost\"\r\n                                  size=\"icon\"\r\n                                  className=\"h-10 w-10 text-destructive hover:text-destructive\"\r\n                                  onClick={() => removeRange(index)}\r\n                                >\r\n                                  <Trash2 className=\"h-4 w-4\" />\r\n                                </Button>\r\n                              </div>\r\n                            ))}\r\n                            <Button\r\n                              type=\"button\"\r\n                              variant=\"outline\"\r\n                              size=\"sm\"\r\n                              onClick={addRange}\r\n                              className=\"mt-2\"\r\n                            >\r\n                              <Plus className=\"h-4 w-4 mr-2\" />\r\n                              {t(\"admin.addDateRange\")}\r\n                            </Button>\r\n                          </div>\r\n                        );\r\n                      }}\r\n                    />\r\n                    <p className=\"text-xs text-muted-foreground\">\r\n                      {t(\"admin.repeatMonthDayHint\")}\r\n                    </p>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Yearly month and day selector for yearly repeat mode */}\r\n                {watch(\"repeat_mode\") === \"yearly\" && (\r\n                  <div className=\"grid grid-cols-2 gap-4\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"repeat_yearly_month\" className=\"text-sm font-medium\">\r\n                        {t(\"admin.repeatYearlyMonthLabel\")}\r\n                      </Label>\r\n                      <Controller\r\n                        name=\"repeat_yearly_month\"\r\n                        control={control}\r\n                        render={({ field }) => (\r\n                          <Select \r\n                            value={field.value?.toString() || \"\"} \r\n                            onValueChange={(value) => field.onChange(value ? parseInt(value) : null)}\r\n                          >\r\n                            <SelectTrigger className=\"h-11\">\r\n                              <SelectValue placeholder={t(\"admin.repeatYearlyMonthPlaceholder\")} />\r\n                            </SelectTrigger>\r\n                            <SelectContent>\r\n                              <SelectItem value=\"1\">1Êúà / January</SelectItem>\r\n                              <SelectItem value=\"2\">2Êúà / February</SelectItem>\r\n                              <SelectItem value=\"3\">3Êúà / March</SelectItem>\r\n                              <SelectItem value=\"4\">4Êúà / April</SelectItem>\r\n                              <SelectItem value=\"5\">5Êúà / May</SelectItem>\r\n                              <SelectItem value=\"6\">6Êúà / June</SelectItem>\r\n                              <SelectItem value=\"7\">7Êúà / July</SelectItem>\r\n                              <SelectItem value=\"8\">8Êúà / August</SelectItem>\r\n                              <SelectItem value=\"9\">9Êúà / September</SelectItem>\r\n                              <SelectItem value=\"10\">10Êúà / October</SelectItem>\r\n                              <SelectItem value=\"11\">11Êúà / November</SelectItem>\r\n                              <SelectItem value=\"12\">12Êúà / December</SelectItem>\r\n                            </SelectContent>\r\n                          </Select>\r\n                        )}\r\n                      />\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"repeat_yearly_day\" className=\"text-sm font-medium\">\r\n                        {t(\"admin.repeatYearlyDayLabel\")}\r\n                      </Label>\r\n                      <Controller\r\n                        name=\"repeat_yearly_day\"\r\n                        control={control}\r\n                        render={({ field }) => (\r\n                          <Select \r\n                            value={field.value?.toString() || \"\"} \r\n                            onValueChange={(value) => field.onChange(value ? parseInt(value) : null)}\r\n                          >\r\n                            <SelectTrigger className=\"h-11\">\r\n                              <SelectValue placeholder={t(\"admin.repeatYearlyDayPlaceholder\")} />\r\n                            </SelectTrigger>\r\n                            <SelectContent>\r\n                              {Array.from({length: 31}, (_, i) => i + 1).map(day => (\r\n                                <SelectItem key={day} value={day.toString()}>\r\n                                  {day}Êó• / Day {day}\r\n                                </SelectItem>\r\n                              ))}\r\n                            </SelectContent>\r\n                          </Select>\r\n                        )}\r\n                      />\r\n                    </div>\r\n                    <p className=\"text-xs text-muted-foreground col-span-2\">\r\n                      {t(\"admin.repeatYearlyHint\")}\r\n                    </p>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Days before selector for days_before repeat mode */}\r\n                {watch(\"repeat_mode\") === \"days_before\" && (\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"repeat_days_before\" className=\"text-sm font-medium\">\r\n                      {t(\"admin.daysBeforeLabel\")}\r\n                    </Label>\r\n                    <Controller\r\n                      name=\"repeat_days_before\"\r\n                      control={control}\r\n                      render={({ field }) => (\r\n                        <Input\r\n                          type=\"number\"\r\n                          min={1}\r\n                          max={30}\r\n                          className=\"h-11\"\r\n                          placeholder={t(\"admin.daysBeforePlaceholder\")}\r\n                          value={field.value ?? \"\"}\r\n                          onChange={(e) => field.onChange(e.target.value ? parseInt(e.target.value) : null)}\r\n                        />\r\n                      )}\r\n                    />\r\n                    <p className=\"text-xs text-muted-foreground\">\r\n                      {t(\"admin.daysBeforeHint\")}\r\n                    </p>\r\n                  </div>\r\n                )}\r\n\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"service_type\" className=\"text-sm font-medium\">{t(\"admin.serviceType\")}</Label>\r\n                  <Select onValueChange={value => setValue(\"service_type\", value as any)} defaultValue={watch(\"service_type\")}>\r\n                    <SelectTrigger className=\"h-11\">\r\n                      <SelectValue placeholder={t(\"admin.selectServiceType\")} />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"dine_in\">{t(\"activities.serviceType.dine_in\")}</SelectItem>\r\n                      <SelectItem value=\"takeaway\">{t(\"activities.serviceType.takeaway\")}</SelectItem>\r\n                      <SelectItem value=\"both\">{t(\"activities.serviceType.both\")}</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n                  {/* Status Selector */}\r\n                  <div className=\"space-y-2\">\r\n                    <Label className=\"text-sm font-medium flex items-center gap-2\">\r\n                      {watch(\"status\") === \"draft\" ? (\r\n                        <FileEdit className=\"w-4 h-4 text-yellow-500\" />\r\n                      ) : (\r\n                        <Send className=\"w-4 h-4 text-green-500\" />\r\n                      )}\r\n                      Ê¥ªÂä®Áä∂ÊÄÅ\r\n                    </Label>\r\n                    <Select onValueChange={value => setValue(\"status\", value as \"draft\" | \"published\")} value={status || \"draft\"}>\r\n                      <SelectTrigger className=\"h-11\">\r\n                        <SelectValue />\r\n                      </SelectTrigger>\r\n                      <SelectContent>\r\n                        <SelectItem value=\"draft\">\r\n                          <span className=\"flex items-center gap-2\">\r\n                            <FileEdit className=\"w-4 h-4 text-yellow-500\" />\r\n                            ËçâÁ®ø\r\n                          </span>\r\n                        </SelectItem>\r\n                        <SelectItem value=\"published\">\r\n                          <span className=\"flex items-center gap-2\">\r\n                            <Send className=\"w-4 h-4 text-green-500\" />\r\n                            Â∑≤ÂèëÂ∏É\r\n                          </span>\r\n                        </SelectItem>\r\n                      </SelectContent>\r\n                    </Select>\r\n                    <p className=\"text-xs text-muted-foreground\">\r\n                      {status === \"draft\" \r\n                        ? \"ËçâÁ®øÁä∂ÊÄÅÔºöÊó†ÂøÖÂ°´È°πÔºå‰∏çÊòæÁ§∫Âú®ÂâçÁ´ØÔºåÈ§êÂéÖ‰∏ç‰ºöÊî∂Âà∞ÈÄöÁü•\" \r\n                        : \"ÂèëÂ∏ÉÊó∂Â∞ÜÈ™åËØÅÂøÖÂ°´È°π\"}\r\n                    </p>\r\n                  </div>\r\n\r\n                  <div className={cn(\r\n                    \"flex items-center space-x-3 p-4 border rounded-lg transition-colors h-fit self-end\",\r\n                    status === \"draft\" ? \"opacity-50 cursor-not-allowed bg-muted/30\" : \"hover:bg-muted/50\"\r\n                  )}>\r\n                    <Checkbox \r\n                      id=\"pinned\" \r\n                      checked={pinned} \r\n                      onCheckedChange={(checked) => setValue(\"pinned\", checked === true)} \r\n                      className=\"data-[state=checked]:bg-primary\"\r\n                      disabled={status === \"draft\"}\r\n                    />\r\n                    <Label htmlFor=\"pinned\" className={cn(\r\n                      \"flex items-center gap-2 text-sm font-medium\",\r\n                      status === \"draft\" ? \"cursor-not-allowed\" : \"cursor-pointer\"\r\n                    )}>\r\n                      <Pin className=\"w-4 h-4 text-primary\" />\r\n                      {t(\"admin.pinToTop\")}\r\n                    </Label>\r\n                  </div>\r\n                  <div className={cn(\r\n                    \"flex items-center space-x-3 p-4 border rounded-lg transition-colors h-fit self-end\",\r\n                    status === \"draft\" ? \"opacity-50 cursor-not-allowed bg-muted/30\" : \"hover:bg-muted/50\"\r\n                  )}>\r\n                    <Checkbox \r\n                      id=\"visible\" \r\n                      checked={visible} \r\n                      onCheckedChange={(checked) => setValue(\"visible\", checked === true)} \r\n                      className=\"data-[state=checked]:bg-primary\"\r\n                      disabled={status === \"draft\"}\r\n                    />\r\n                    <Label htmlFor=\"visible\" className={cn(\r\n                      \"flex items-center gap-2 text-sm font-medium\",\r\n                      status === \"draft\" ? \"cursor-not-allowed\" : \"cursor-pointer\"\r\n                    )}>\r\n                      <Globe className=\"w-4 h-4 text-primary\" />\r\n                      ÊòæÁ§∫Ê¥ªÂä®\r\n                      {status === \"draft\" && <span className=\"text-xs text-muted-foreground\">(ËçâÁ®øÈªòËÆ§ÂÖ≥Èó≠)</span>}\r\n                    </Label>\r\n                  </div>\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"sort_order\" className=\"text-sm font-medium flex items-center gap-2\">\r\n                      <ArrowUpDown className=\"w-4 h-4 text-primary\" />\r\n                      {t(\"admin.sortOrder\")}\r\n                    </Label>\r\n                    <Input id=\"sort_order\" type=\"number\" {...register(\"sort_order\", {\r\n                    valueAsNumber: true\r\n                  })} className=\"h-11\" placeholder=\"0\" />\r\n                  </div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Badge Display Settings */}\r\n            <Card className=\"border-primary/20\">\r\n              <CardContent className=\"p-6\">\r\n                <Label className=\"text-base font-semibold flex items-center gap-2 mb-4\">\r\n                  <Badge className=\"w-5 h-5 text-primary\" />\r\n                  {t(\"admin.form.badgeSettings\")}\r\n                </Label>\r\n                <Tabs defaultValue=\"zh\" className=\"w-full\">\r\n                  <TabsList className=\"grid w-full grid-cols-3 mb-4\">\r\n                    <TabsTrigger value=\"zh\">üá®üá≥ {t(\"admin.chinese\")}</TabsTrigger>\r\n                    <TabsTrigger value=\"en\">üá¨üáß {t(\"admin.english\")}</TabsTrigger>\r\n                    <TabsTrigger value=\"pt\">üáµüáπ {t(\"admin.portuguese\")}</TabsTrigger>\r\n                  </TabsList>\r\n                  \r\n                  <TabsContent value=\"zh\" className=\"space-y-3\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"badge_text_zh\" className=\"text-sm\">{t(\"admin.form.badgeText\")} ({t(\"admin.chinese\")}) <span className=\"text-destructive\">*</span></Label>\r\n                      <Input id=\"badge_text_zh\" {...register(\"badge_text_zh\")} />\r\n                      {errors.badge_text_zh && <p className=\"text-sm text-destructive\">{errors.badge_text_zh.message}</p>}\r\n                      <p className=\"text-xs text-muted-foreground\">{t(\"admin.form.badgeHint\")}</p>\r\n                    </div>\r\n                  </TabsContent>\r\n                  \r\n                  <TabsContent value=\"en\" className=\"space-y-3\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"badge_text_en\" className=\"text-sm\">{t(\"admin.form.badgeText\")} ({t(\"admin.english\")}) <span className=\"text-destructive\">*</span></Label>\r\n                      <Input id=\"badge_text_en\" {...register(\"badge_text_en\")} />\r\n                      {errors.badge_text_en && <p className=\"text-sm text-destructive\">{errors.badge_text_en.message}</p>}\r\n                      <p className=\"text-xs text-muted-foreground\">{t(\"admin.form.badgeHint\")}</p>\r\n                    </div>\r\n                  </TabsContent>\r\n                  \r\n                  <TabsContent value=\"pt\" className=\"space-y-3\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"badge_text_pt\" className=\"text-sm\">{t(\"admin.form.badgeText\")} ({t(\"admin.portuguese\")}) <span className=\"text-destructive\">*</span></Label>\r\n                      <Input id=\"badge_text_pt\" {...register(\"badge_text_pt\")} />\r\n                      {errors.badge_text_pt && <p className=\"text-sm text-destructive\">{errors.badge_text_pt.message}</p>}\r\n                      <p className=\"text-xs text-muted-foreground\">{t(\"admin.form.badgeHint\")}</p>\r\n                    </div>\r\n                  </TabsContent>\r\n                </Tabs>\r\n                \r\n                <div className=\"space-y-2 mt-4\">\r\n                  <Label htmlFor=\"badge_color\" className=\"text-sm\">{t(\"admin.form.badgeColor\")}</Label>\r\n                  <Controller name=\"badge_color\" control={control} render={({\r\n                  field\r\n                }) => <div className=\"flex items-center gap-3\">\r\n                        <Input id=\"badge_color\" type=\"color\" value={field.value || \"#9b87f5\"} onChange={e => field.onChange(e.target.value)} className=\"w-20 h-11 cursor-pointer\" />\r\n                        <Input value={field.value || \"#9b87f5\"} onChange={e => field.onChange(e.target.value)} placeholder=\"#9b87f5\" className=\"flex-1\" />\r\n                      </div>} />\r\n                  <div className=\"flex items-center gap-2 mt-2\">\r\n                    <span className=\"text-xs text-muted-foreground\">{t(\"admin.form.preview\")}:</span>\r\n                    <Badge style={{\r\n                    backgroundColor: watch(\"badge_color\") || \"#9b87f5\"\r\n                  }} className=\"text-white\">\r\n                      {watch(\"badge_text_zh\") || watch(\"title_zh\") || \"Sample\"}\r\n                    </Badge>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Discount Settings */}\r\n                <div className=\"border-t pt-4 mt-4\">\r\n                  <Label className=\"text-sm font-medium flex items-center gap-2 mb-3\">\r\n                    üí∞ ‰ºòÊÉ†ËÆæÁΩÆ / Discount Settings\r\n                  </Label>\r\n                  <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"discount_type\" className=\"text-sm\">ÊäòÊâ£Á±ªÂûã / Discount Type</Label>\r\n                      <Controller \r\n                        name=\"discount_type\" \r\n                        control={control} \r\n                        render={({ field }) => (\r\n                          <Select \r\n                            value={field.value || \"none\"} \r\n                            onValueChange={(value) => field.onChange(value === \"none\" ? null : value)}\r\n                          >\r\n                            <SelectTrigger className=\"h-11\">\r\n                              <SelectValue placeholder=\"ÈÄâÊã©ÊäòÊâ£Á±ªÂûã\" />\r\n                            </SelectTrigger>\r\n                            <SelectContent>\r\n                              <SelectItem value=\"none\">Êó†‰ºòÊÉ† / No Discount</SelectItem>\r\n                              <SelectItem value=\"percentage\">ÁôæÂàÜÊØîÊäòÊâ£ / Percentage</SelectItem>\r\n                              <SelectItem value=\"fixed_amount\">Âõ∫ÂÆöÈáëÈ¢ù / Fixed Amount</SelectItem>\r\n                            </SelectContent>\r\n                          </Select>\r\n                        )} \r\n                      />\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"discount_value\" className=\"text-sm\">\r\n                        ÊäòÊâ£ÂÄº / Discount Value\r\n                        {watch(\"discount_type\") === \"percentage\" && \" (%)\"}\r\n                        {watch(\"discount_type\") === \"fixed_amount\" && \" (‚Ç¨)\"}\r\n                      </Label>\r\n                      <Input \r\n                        id=\"discount_value\" \r\n                        type=\"number\" \r\n                        step=\"0.01\"\r\n                        {...register(\"discount_value\", { valueAsNumber: true })} \r\n                        className=\"h-11\" \r\n                        placeholder={watch(\"discount_type\") === \"percentage\" ? \"‰æãÂ¶Ç: 20 (Ë°®Á§∫8Êäò)\" : \"‰æãÂ¶Ç: 5 (Ë°®Á§∫Âáè5‚Ç¨)\"}\r\n                        disabled={!watch(\"discount_type\")}\r\n                      />\r\n                      <p className=\"text-xs text-muted-foreground\">\r\n                        {watch(\"discount_type\") === \"percentage\" \r\n                          ? \"ËæìÂÖ•ÊäòÊâ£ÁôæÂàÜÊØîÔºåÂ¶Ç 20 Ë°®Á§∫Êâì8ÊäòÔºàÂáè20%Ôºâ\" \r\n                          : watch(\"discount_type\") === \"fixed_amount\"\r\n                          ? \"ËæìÂÖ•Âõ∫ÂÆöÂáèÂÖçÈáëÈ¢ùÔºàÊ¨ßÂÖÉÔºâ\"\r\n                          : \"ÂÖàÈÄâÊã©ÊäòÊâ£Á±ªÂûã\"}\r\n                      </p>\r\n                    </div>\r\n                    \r\n                    {/* Discount Key */}\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"discount_key\" className=\"text-sm\">ÊäòÊâ£Ê†áËØÜ / Discount Key</Label>\r\n                      <Input \r\n                        id=\"discount_key\"\r\n                        type=\"text\"\r\n                        {...register(\"discount_key\")} \r\n                        className=\"h-11\" \r\n                        placeholder=\"‰æãÂ¶Ç: SUMMER2025, VIP_DISCOUNT\"\r\n                        disabled={!watch(\"discount_type\")}\r\n                      />\r\n                      <p className=\"text-xs text-muted-foreground\">\r\n                        Áî®‰∫éÂ§ñÈÉ®Á≥ªÁªüËØÜÂà´ÁöÑÊäòÊâ£Ê†áËØÜÁ¨¶\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Associated Restaurants */}\r\n            <Card className=\"border-primary/20\">\r\n              <CardContent className=\"p-6\">\r\n                <Label className=\"text-base font-semibold flex items-center gap-2 mb-4\">\r\n                  <Store className=\"w-5 h-5 text-primary\" />\r\n                  {t(\"admin.associatedRestaurants\")}\r\n                </Label>\r\n                \r\n                {/* Search Input */}\r\n                <div className=\"relative mb-3\">\r\n                  <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\r\n                  <Input\r\n                    placeholder={t(\"admin.searchRestaurants\") || \"ÊêúÁ¥¢È§êÂéÖ...\"}\r\n                    value={restaurantSearch}\r\n                    onChange={(e) => setRestaurantSearch(e.target.value)}\r\n                    className=\"pl-9 h-10\"\r\n                  />\r\n                  {restaurantSearch && (\r\n                    <Button\r\n                      type=\"button\"\r\n                      variant=\"ghost\"\r\n                      size=\"icon\"\r\n                      className=\"absolute right-1 top-1/2 -translate-y-1/2 h-7 w-7\"\r\n                      onClick={() => setRestaurantSearch(\"\")}\r\n                    >\r\n                      <X className=\"h-3.5 w-3.5\" />\r\n                    </Button>\r\n                  )}\r\n                </div>\r\n                \r\n                <ScrollArea className=\"h-64 border rounded-lg p-4 bg-muted/20\">\r\n                  <div className=\"space-y-2\">\r\n                    {restaurants\r\n                      ?.filter(restaurant => {\r\n                        if (!restaurantSearch.trim()) return true;\r\n                        const search = restaurantSearch.toLowerCase();\r\n                        return (\r\n                          restaurant.name?.toLowerCase().includes(search) ||\r\n                          restaurant.name_en?.toLowerCase().includes(search) ||\r\n                          restaurant.name_pt?.toLowerCase().includes(search) ||\r\n                          restaurant.address?.toLowerCase().includes(search)\r\n                        );\r\n                      })\r\n                      .map(restaurant => (\r\n                        <div key={restaurant.id} className=\"flex items-center space-x-3 p-3 rounded-md hover:bg-background transition-colors border border-transparent hover:border-primary/30\">\r\n                          <Checkbox \r\n                            id={restaurant.id} \r\n                            checked={selectedRestaurants.includes(restaurant.id)} \r\n                            onCheckedChange={checked => {\r\n                              if (checked) {\r\n                                setSelectedRestaurants([...selectedRestaurants, restaurant.id]);\r\n                              } else {\r\n                                setSelectedRestaurants(selectedRestaurants.filter(id => id !== restaurant.id));\r\n                              }\r\n                            }} \r\n                            className=\"data-[state=checked]:bg-primary\" \r\n                          />\r\n                          <Label htmlFor={restaurant.id} className=\"cursor-pointer flex-1 font-normal\">\r\n                            {restaurant.name}\r\n                          </Label>\r\n                          {selectedRestaurants.includes(restaurant.id) && (\r\n                            <Badge variant=\"secondary\" className=\"text-xs\">Â∑≤ÈÄâ</Badge>\r\n                          )}\r\n                        </div>\r\n                      ))}\r\n                    {restaurants?.filter(restaurant => {\r\n                      if (!restaurantSearch.trim()) return true;\r\n                      const search = restaurantSearch.toLowerCase();\r\n                      return (\r\n                        restaurant.name?.toLowerCase().includes(search) ||\r\n                        restaurant.name_en?.toLowerCase().includes(search) ||\r\n                        restaurant.name_pt?.toLowerCase().includes(search) ||\r\n                        restaurant.address?.toLowerCase().includes(search)\r\n                      );\r\n                    }).length === 0 && (\r\n                      <p className=\"text-sm text-muted-foreground text-center py-4\">\r\n                        {t(\"common.noResults\") || \"Ê≤°ÊúâÊâæÂà∞ÂåπÈÖçÁöÑÈ§êÂéÖ\"}\r\n                      </p>\r\n                    )}\r\n                  </div>\r\n                </ScrollArea>\r\n                <p className=\"text-xs text-muted-foreground mt-2\">\r\n                  Â∑≤ÈÄâÊã© {selectedRestaurants.length} ‰∏™È§êÂéÖ\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Submit Buttons */}\r\n            <div className=\"flex justify-end gap-3 pt-4 border-t sticky bottom-0 bg-background pb-[16px]\">\r\n              <Button type=\"button\" variant=\"outline\" onClick={() => setOpen(false)} className=\"min-w-[100px]\">\r\n                {t(\"common.cancel\")}\r\n              </Button>\r\n              <Button type=\"submit\" disabled={isSubmitting} className=\"min-w-[100px] bg-primary hover:bg-primary/90\">\r\n                {isSubmitting ? <>\r\n                    <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2\" />\r\n                    {t(\"common.saving\")}\r\n                  </> : t(\"common.save\")}\r\n              </Button>\r\n            </div>\r\n          </form>\r\n        </ScrollArea>\r\n\r\n        {/* Image Crop Dialog */}\r\n        {tempImageFile && (\r\n          <ImageCropDialog\r\n            open={showCropDialog}\r\n            onOpenChange={setShowCropDialog}\r\n            imageFile={tempImageFile}\r\n            onCropComplete={handleCropComplete}\r\n          />\r\n        )}\r\n      </DialogContent>\r\n    </Dialog>;\r\n}","import { useState, useEffect } from \"react\";\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger, DialogFooter } from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\nimport { useActivityRules, useUpdateActivityRules } from \"@/hooks/useActivityRules\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Loader2, FileText, Save } from \"lucide-react\";\r\nimport { toast } from \"@/hooks/use-toast\";\r\nimport { RichTextEditor } from \"./RichTextEditor\";\r\n\r\ninterface ActivityRulesEditorDialogProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\nconst ActivityRulesEditorDialog = ({ children }: ActivityRulesEditorDialogProps) => {\r\n  const { t } = useTranslation();\r\n  const { data: rules, isLoading } = useActivityRules();\r\n  const updateRules = useUpdateActivityRules();\r\n  const [open, setOpen] = useState(false);\r\n  const [activeTab, setActiveTab] = useState(\"zh\");\r\n  \r\n  const [contentZh, setContentZh] = useState(\"\");\r\n  const [contentEn, setContentEn] = useState(\"\");\r\n  const [contentPt, setContentPt] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    if (rules) {\r\n      setContentZh(rules.content_zh);\r\n      setContentEn(rules.content_en);\r\n      setContentPt(rules.content_pt);\r\n    }\r\n  }, [rules]);\r\n\r\n  const handleSave = async () => {\r\n    if (!rules) return;\r\n    \r\n    try {\r\n      await updateRules.mutateAsync({\r\n        id: rules.id,\r\n        content_zh: contentZh,\r\n        content_en: contentEn,\r\n        content_pt: contentPt,\r\n      });\r\n      toast({\r\n        title: t(\"common.success\"),\r\n        description: t(\"admin.activityRules.updateSuccess\"),\r\n      });\r\n      setOpen(false);\r\n    } catch (error) {\r\n      toast({\r\n        title: t(\"common.error\"),\r\n        description: t(\"admin.activityRules.updateError\"),\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={setOpen}>\r\n      <DialogTrigger asChild>\r\n        {children}\r\n      </DialogTrigger>\r\n      <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto\">\r\n        <DialogHeader>\r\n          <DialogTitle className=\"flex items-center gap-2\">\r\n            <FileText className=\"w-5 h-5\" />\r\n            {t(\"admin.activityRules.editTitle\")}\r\n          </DialogTitle>\r\n        </DialogHeader>\r\n        \r\n        {isLoading ? (\r\n          <div className=\"flex justify-center py-8\">\r\n            <Loader2 className=\"w-6 h-6 animate-spin text-primary\" />\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-4\">\r\n            <Tabs value={activeTab} onValueChange={setActiveTab}>\r\n              <TabsList className=\"grid w-full grid-cols-3\">\r\n                <TabsTrigger value=\"zh\">{t(\"admin.chinese\")}</TabsTrigger>\r\n                <TabsTrigger value=\"en\">{t(\"admin.english\")}</TabsTrigger>\r\n                <TabsTrigger value=\"pt\">{t(\"admin.portuguese\")}</TabsTrigger>\r\n              </TabsList>\r\n              \r\n              <TabsContent value=\"zh\" className=\"mt-4\">\r\n                <RichTextEditor\r\n                  value={contentZh}\r\n                  onChange={setContentZh}\r\n                  placeholder={t(\"admin.enterContent\")}\r\n                />\r\n              </TabsContent>\r\n              \r\n              <TabsContent value=\"en\" className=\"mt-4\">\r\n                <RichTextEditor\r\n                  value={contentEn}\r\n                  onChange={setContentEn}\r\n                  placeholder=\"Enter English activity rules...\"\r\n                />\r\n              </TabsContent>\r\n              \r\n              <TabsContent value=\"pt\" className=\"mt-4\">\r\n                <RichTextEditor\r\n                  value={contentPt}\r\n                  onChange={setContentPt}\r\n                  placeholder=\"Digite as regras da atividade em portugu√™s...\"\r\n                />\r\n              </TabsContent>\r\n            </Tabs>\r\n          </div>\r\n        )}\r\n        \r\n        <DialogFooter>\r\n          <Button variant=\"outline\" onClick={() => setOpen(false)}>\r\n            {t(\"common.cancel\")}\r\n          </Button>\r\n          <Button onClick={handleSave} disabled={updateRules.isPending}>\r\n            {updateRules.isPending ? (\r\n              <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\r\n            ) : (\r\n              <Save className=\"w-4 h-4 mr-2\" />\r\n            )}\r\n            {t(\"common.save\")}\r\n          </Button>\r\n        </DialogFooter>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default ActivityRulesEditorDialog;\r\n","import { useState, useEffect } from \"react\";\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger, DialogFooter } from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\nimport { useGlobalHandbook, useUpdateGlobalHandbook } from \"@/hooks/useGlobalHandbook\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Loader2, BookOpen, Save } from \"lucide-react\";\r\nimport { toast } from \"@/hooks/use-toast\";\r\nimport { RichTextEditor } from \"./RichTextEditor\";\r\n\r\ninterface GlobalHandbookEditorDialogProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\nconst GlobalHandbookEditorDialog = ({ children }: GlobalHandbookEditorDialogProps) => {\r\n  const { t } = useTranslation();\r\n  const { data: handbook, isLoading } = useGlobalHandbook();\r\n  const updateHandbook = useUpdateGlobalHandbook();\r\n  const [open, setOpen] = useState(false);\r\n  const [activeTab, setActiveTab] = useState(\"zh\");\r\n  \r\n  const [contentZh, setContentZh] = useState(\"\");\r\n  const [contentEn, setContentEn] = useState(\"\");\r\n  const [contentPt, setContentPt] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    if (handbook) {\r\n      setContentZh(handbook.content_zh);\r\n      setContentEn(handbook.content_en);\r\n      setContentPt(handbook.content_pt);\r\n    }\r\n  }, [handbook]);\r\n\r\n  const handleSave = async () => {\r\n    if (!handbook) return;\r\n    \r\n    try {\r\n      await updateHandbook.mutateAsync({\r\n        id: handbook.id,\r\n        content_zh: contentZh,\r\n        content_en: contentEn,\r\n        content_pt: contentPt,\r\n      });\r\n      toast({\r\n        title: t(\"common.success\"),\r\n        description: t(\"activities.handbook.updateSuccess\"),\r\n      });\r\n      setOpen(false);\r\n    } catch (error) {\r\n      toast({\r\n        title: t(\"common.error\"),\r\n        description: t(\"activities.handbook.updateError\"),\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={setOpen}>\r\n      <DialogTrigger asChild>\r\n        {children}\r\n      </DialogTrigger>\r\n      <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto\">\r\n        <DialogHeader>\r\n          <DialogTitle className=\"flex items-center gap-2\">\r\n            <BookOpen className=\"w-5 h-5\" />\r\n            {t(\"admin.editActivityHandbook\")}\r\n          </DialogTitle>\r\n        </DialogHeader>\r\n        \r\n        {isLoading ? (\r\n          <div className=\"flex justify-center py-8\">\r\n            <Loader2 className=\"w-6 h-6 animate-spin text-primary\" />\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-4\">\r\n            <Tabs value={activeTab} onValueChange={setActiveTab}>\r\n              <TabsList className=\"grid w-full grid-cols-3\">\r\n                <TabsTrigger value=\"zh\">{t(\"admin.chinese\")}</TabsTrigger>\r\n                <TabsTrigger value=\"en\">{t(\"admin.english\")}</TabsTrigger>\r\n                <TabsTrigger value=\"pt\">{t(\"admin.portuguese\")}</TabsTrigger>\r\n              </TabsList>\r\n              \r\n              <TabsContent value=\"zh\" className=\"mt-4\">\r\n                <RichTextEditor\r\n                  value={contentZh}\r\n                  onChange={setContentZh}\r\n                  placeholder={t(\"admin.enterContent\")}\r\n                />\r\n              </TabsContent>\r\n              \r\n              <TabsContent value=\"en\" className=\"mt-4\">\r\n                <RichTextEditor\r\n                  value={contentEn}\r\n                  onChange={setContentEn}\r\n                  placeholder=\"Enter English activity handbook content...\"\r\n                />\r\n              </TabsContent>\r\n              \r\n              <TabsContent value=\"pt\" className=\"mt-4\">\r\n                <RichTextEditor\r\n                  value={contentPt}\r\n                  onChange={setContentPt}\r\n                  placeholder=\"Digite o conte√∫do do manual da atividade em portugu√™s...\"\r\n                />\r\n              </TabsContent>\r\n            </Tabs>\r\n          </div>\r\n        )}\r\n        \r\n        <DialogFooter>\r\n          <Button variant=\"outline\" onClick={() => setOpen(false)}>\r\n            {t(\"common.cancel\")}\r\n          </Button>\r\n          <Button onClick={handleSave} disabled={updateHandbook.isPending}>\r\n            {updateHandbook.isPending ? (\r\n              <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\r\n            ) : (\r\n              <Save className=\"w-4 h-4 mr-2\" />\r\n            )}\r\n            {t(\"common.save\")}\r\n          </Button>\r\n        </DialogFooter>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default GlobalHandbookEditorDialog;\r\n","import { useState, useMemo } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Checkbox } from \"@/components/ui/checkbox\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n  AlertDialogTrigger,\r\n} from \"@/components/ui/alert-dialog\";\r\nimport { useAdminActivities } from \"@/hooks/useActivities\";\r\nimport { useLocalizedContent } from \"@/hooks/useLocalizedContent\";\r\nimport { useDeleteActivity, useBatchDeleteActivities } from \"@/hooks/useAdmin\";\r\n\r\nimport { ActivityFormDialog } from \"@/components/admin/ActivityFormDialog\";\r\nimport ActivityRulesEditorDialog from \"@/components/admin/ActivityRulesEditorDialog\";\r\nimport GlobalHandbookEditorDialog from \"@/components/admin/GlobalHandbookEditorDialog\";\r\nimport { Calendar, Plus, Download, Trash2, Search, FileText, FileEdit, Send, BarChart3, BookOpen } from \"lucide-react\";\r\nimport { format } from \"date-fns\";\r\nimport { exportActivitiesToCSV } from \"@/lib/exportUtils\";\r\nimport { useToast } from \"@/hooks/use-toast\";\r\nconst AdminActivities = () => {\r\n  const { t } = useTranslation();\r\n  const { toast } = useToast();\r\n  const { data: activities, isLoading } = useAdminActivities();\r\n  const { getLocalizedField } = useLocalizedContent();\r\n  const deleteActivity = useDeleteActivity();\r\n  const batchDeleteActivities = useBatchDeleteActivities();\r\n  const [selectedActivities, setSelectedActivities] = useState<string[]>([]);\r\n  const [searchQuery, setSearchQuery] = useState(\"\");\r\n  const [statusFilter, setStatusFilter] = useState<string>(\"all\");\r\n  const [deleteConfirmText, setDeleteConfirmText] = useState<{ [key: string]: string }>({});\r\n  const [batchDeleteConfirmText, setBatchDeleteConfirmText] = useState(\"\");\r\n\r\n  // Filter activities based on search query and status filter\r\n  const filteredActivities = useMemo(() => {\r\n    if (!activities) return [];\r\n    \r\n    return activities.filter((activity) => {\r\n      const title = String(getLocalizedField(activity, \"title\") || \"\");\r\n      const content = String(getLocalizedField(activity, \"content\") || \"\");\r\n      const matchesSearch = searchQuery === \"\" || \r\n        title.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n        content.toLowerCase().includes(searchQuery.toLowerCase());\r\n      \r\n      const now = new Date();\r\n      const startDate = new Date(activity.start_date);\r\n      // If no end_date, activity is ongoing indefinitely\r\n      const endDate = activity.end_date ? new Date(activity.end_date) : null;\r\n      const isEnded = endDate ? endDate < now : false;\r\n      const isOngoing = !isEnded && startDate <= now;\r\n      \r\n      const activityStatus = (activity as any).status || \"published\";\r\n      const matchesStatus = \r\n        statusFilter === \"all\" ||\r\n        (statusFilter === \"active\" && isOngoing) ||\r\n        (statusFilter === \"ended\" && isEnded) ||\r\n        (statusFilter === \"pinned\" && activity.pinned) ||\r\n        (statusFilter === \"draft\" && activityStatus === \"draft\") ||\r\n        (statusFilter === \"published\" && activityStatus === \"published\");\r\n      \r\n      return matchesSearch && matchesStatus;\r\n    });\r\n  }, [activities, searchQuery, statusFilter, getLocalizedField]);\r\n\r\n  const handleExport = () => {\r\n    if (!activities || activities.length === 0) {\r\n      toast({\r\n        title: t(\"common.error\"),\r\n        description: t(\"admin.noDataToExport\"),\r\n        variant: \"destructive\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    exportActivitiesToCSV(activities);\r\n    toast({\r\n      title: t(\"common.success\"),\r\n      description: t(\"admin.exportSuccess\"),\r\n    });\r\n  };\r\n\r\n  const toggleSelectActivity = (activityId: string) => {\r\n    setSelectedActivities(prev =>\r\n      prev.includes(activityId)\r\n        ? prev.filter(id => id !== activityId)\r\n        : [...prev, activityId]\r\n    );\r\n  };\r\n\r\n  const toggleSelectAll = () => {\r\n    if (selectedActivities.length === filteredActivities?.length) {\r\n      setSelectedActivities([]);\r\n    } else {\r\n      setSelectedActivities(filteredActivities?.map(a => a.id) || []);\r\n    }\r\n  };\r\n\r\n  const handleBatchDelete = () => {\r\n    if (selectedActivities.length === 0) return;\r\n    batchDeleteActivities.mutate(selectedActivities);\r\n    setSelectedActivities([]);\r\n  };\r\n\r\n  if (isLoading) {\r\n    return <div className=\"text-center\">{t(\"common.loading\")}</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n        <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4\">\r\n          <div>\r\n            <h1 className=\"text-2xl md:text-3xl font-bold mb-2\">{t(\"admin.activityManagement\")}</h1>\r\n            <p className=\"text-muted-foreground\">{t(\"admin.manageActivities\")}</p>\r\n          </div>\r\n          <div className=\"flex gap-2 flex-wrap\">\r\n            <GlobalHandbookEditorDialog>\r\n              <Button variant=\"outline\" className=\"flex-1 sm:flex-initial\">\r\n                <BookOpen className=\"mr-2 h-4 w-4\" />\r\n                <span className=\"hidden sm:inline\">{t(\"admin.activityHandbook\")}</span>\r\n              </Button>\r\n            </GlobalHandbookEditorDialog>\r\n            <ActivityRulesEditorDialog>\r\n              <Button variant=\"outline\" className=\"flex-1 sm:flex-initial\">\r\n                <FileText className=\"mr-2 h-4 w-4\" />\r\n                <span className=\"hidden sm:inline\">{t(\"admin.activityRules\")}</span>\r\n              </Button>\r\n            </ActivityRulesEditorDialog>\r\n            <Button variant=\"outline\" onClick={handleExport} className=\"flex-1 sm:flex-initial\">\r\n              <Download className=\"mr-2 h-4 w-4\" />\r\n              <span className=\"hidden sm:inline\">{t(\"admin.exportCSV\")}</span>\r\n            </Button>\r\n            <ActivityFormDialog\r\n              trigger={\r\n                <Button className=\"flex-1 sm:flex-initial\">\r\n                  <Plus className=\"mr-2 h-4 w-4\" />\r\n                  {t(\"admin.addActivity\")}\r\n                </Button>\r\n              }\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Search and Filter */}\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"flex gap-4 flex-wrap\">\r\n              <div className=\"flex-1 min-w-[200px]\">\r\n                <div className=\"relative\">\r\n                  <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\r\n                  <Input\r\n                    placeholder={t(\"admin.searchActivities\")}\r\n                    value={searchQuery}\r\n                    onChange={(e) => setSearchQuery(e.target.value)}\r\n                    className=\"pl-9\"\r\n                  />\r\n                </div>\r\n              </div>\r\n              <Select value={statusFilter} onValueChange={setStatusFilter}>\r\n                <SelectTrigger className=\"w-[180px]\">\r\n                  <SelectValue placeholder={t(\"admin.filterByStatus\")} />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"all\">{t(\"admin.allStatus\")}</SelectItem>\r\n                  <SelectItem value=\"draft\">{t(\"admin.statusDraft\")}</SelectItem>\r\n                  <SelectItem value=\"published\">{t(\"admin.statusPublished\")}</SelectItem>\r\n                  <SelectItem value=\"active\">{t(\"admin.statusActive\")}</SelectItem>\r\n                  <SelectItem value=\"ended\">{t(\"admin.statusEnded\")}</SelectItem>\r\n                  <SelectItem value=\"pinned\">{t(\"admin.statusPinned\")}</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Batch Operations */}\r\n        {selectedActivities.length > 0 && (\r\n          <Card className=\"bg-muted/50\">\r\n            <CardContent className=\"pt-6\">\r\n              <div className=\"flex flex-col sm:flex-row items-start sm:items-center gap-4\">\r\n                <span className=\"font-medium\">\r\n                  {t(\"admin.selectedCount\", { count: selectedActivities.length })}\r\n                </span>\r\n\r\n                <div className=\"flex gap-2 flex-wrap w-full sm:w-auto\">\r\n                  <AlertDialog>\r\n                    <AlertDialogTrigger asChild>\r\n                      <Button variant=\"destructive\" size=\"sm\" className=\"flex-1 sm:flex-initial\">\r\n                        <Trash2 className=\"mr-2 h-4 w-4\" />\r\n                        {t(\"admin.batchDelete\")}\r\n                      </Button>\r\n                    </AlertDialogTrigger>\r\n                    <AlertDialogContent className=\"max-w-[90vw] sm:max-w-[425px]\">\r\n                      <AlertDialogHeader>\r\n                        <AlertDialogTitle>{t(\"admin.confirmBatchDelete\")}</AlertDialogTitle>\r\n                        <AlertDialogDescription className=\"space-y-3\">\r\n                          <p>{t(\"admin.batchDeleteWarning\", { count: selectedActivities.length })}</p>\r\n                          <p className=\"font-semibold text-destructive\">\r\n                            {t(\"admin.willDeleteActivities\", { count: selectedActivities.length })}\r\n                          </p>\r\n                          <div className=\"space-y-2\">\r\n                            <p className=\"text-sm\">{t(\"admin.typeDeleteToConfirmBatch\")}</p>\r\n                            <Input\r\n                              value={batchDeleteConfirmText}\r\n                              onChange={(e) => setBatchDeleteConfirmText(e.target.value)}\r\n                              placeholder=\"DELETE\"\r\n                              className=\"font-mono\"\r\n                            />\r\n                          </div>\r\n                        </AlertDialogDescription>\r\n                      </AlertDialogHeader>\r\n                      <AlertDialogFooter>\r\n                        <AlertDialogCancel onClick={() => setBatchDeleteConfirmText(\"\")}>\r\n                          {t(\"common.cancel\")}\r\n                        </AlertDialogCancel>\r\n                        <AlertDialogAction\r\n                          disabled={batchDeleteConfirmText !== \"DELETE\"}\r\n                          onClick={() => {\r\n                            handleBatchDelete();\r\n                            setBatchDeleteConfirmText(\"\");\r\n                          }}\r\n                          className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\r\n                        >\r\n                          {t(\"common.delete\")}\r\n                        </AlertDialogAction>\r\n                      </AlertDialogFooter>\r\n                    </AlertDialogContent>\r\n                  </AlertDialog>\r\n\r\n                  <Button variant=\"outline\" size=\"sm\" onClick={() => setSelectedActivities([])} className=\"flex-1 sm:flex-initial\">\r\n                    {t(\"admin.clearSelection\")}\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        )}\r\n\r\n        {/* Select All */}\r\n        <div className=\"flex items-center gap-2 pb-2 border-b\">\r\n          <Checkbox\r\n            checked={selectedActivities.length === filteredActivities?.length && filteredActivities.length > 0}\r\n            onCheckedChange={toggleSelectAll}\r\n          />\r\n          <span className=\"font-medium\">{t(\"admin.selectAll\")}</span>\r\n          <span className=\"text-sm text-muted-foreground ml-2\">\r\n            ({filteredActivities?.length} {t(\"admin.results\")})\r\n          </span>\r\n        </div>\r\n\r\n        <div className=\"grid gap-4\">\r\n          {filteredActivities?.map((activity) => (\r\n            <Card key={activity.id}>\r\n              <div className=\"flex flex-col md:flex-row md:items-center\">\r\n                <div className=\"p-4 flex items-start md:self-start\">\r\n                  <Checkbox\r\n                    checked={selectedActivities.includes(activity.id)}\r\n                    onCheckedChange={() => toggleSelectActivity(activity.id)}\r\n                    className=\"mt-1\"\r\n                  />\r\n                </div>\r\n                {activity.image_url && (\r\n                  <div className=\"w-full md:w-48 h-48 flex items-center justify-center overflow-hidden mx-auto md:mx-0 flex-shrink-0\">\r\n                    <img\r\n                      src={activity.image_url}\r\n                      alt={String(getLocalizedField(activity, \"title\"))}\r\n                      className=\"object-cover w-full h-full\"\r\n                    />\r\n                  </div>\r\n                )}\r\n                <div className=\"flex-1\">\r\n                  <CardHeader>\r\n                    <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-2\">\r\n                      <CardTitle className=\"text-lg md:text-xl\">{getLocalizedField(activity, \"title\")}</CardTitle>\r\n                      <div className=\"flex gap-2 flex-wrap\">\r\n                        {(activity as any).status === \"draft\" ? (\r\n                          <Badge variant=\"outline\" className=\"bg-yellow-500/10 text-yellow-600 border-yellow-500/30\">\r\n                            <FileEdit className=\"w-3 h-3 mr-1\" />\r\n                            ËçâÁ®ø\r\n                          </Badge>\r\n                        ) : (\r\n                          <Badge variant=\"outline\" className=\"bg-green-500/10 text-green-600 border-green-500/30\">\r\n                            <Send className=\"w-3 h-3 mr-1\" />\r\n                            Â∑≤ÂèëÂ∏É\r\n                          </Badge>\r\n                        )}\r\n                        {!activity.visible && <Badge variant=\"secondary\">{t(\"admin.hidden\")}</Badge>}\r\n                        {activity.pinned && <Badge>{t(\"activities.pinned\")}</Badge>}\r\n                        {(() => {\r\n                          const now = new Date();\r\n                          const startDate = new Date(activity.start_date);\r\n                          const endDate = activity.end_date ? new Date(activity.end_date) : null;\r\n                          const isEnded = endDate ? endDate < now : false;\r\n                          const isOngoing = !isEnded && startDate <= now;\r\n                          \r\n                          if (isEnded) {\r\n                            return <Badge variant=\"secondary\">{t(\"activities.ended\")}</Badge>;\r\n                          } else if (isOngoing) {\r\n                            return <Badge>{t(\"activities.ongoing\")}</Badge>;\r\n                          }\r\n                          return null;\r\n                        })()}\r\n                      </div>\r\n                    </div>\r\n                    <CardDescription className=\"line-clamp-2\">\r\n                      <div \r\n                        className=\"prose prose-sm max-w-none\r\n                          [&_p]:inline [&_p]:m-0\r\n                          [&_strong]:font-semibold [&_strong]:text-foreground\r\n                          [&_em]:italic\r\n                          [&_h1]:text-base [&_h2]:text-base [&_h3]:text-base\r\n                          [&_*]:text-muted-foreground\"\r\n                        dangerouslySetInnerHTML={{ __html: getLocalizedField(activity, \"content\") }}\r\n                      />\r\n                    </CardDescription>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <div className=\"flex items-center gap-4 text-sm text-muted-foreground mb-4 overflow-x-auto\">\r\n                      <div className=\"flex items-center gap-1 whitespace-nowrap\">\r\n                        <Calendar className=\"h-4 w-4 flex-shrink-0\" />\r\n                        <span className=\"text-xs sm:text-sm\">\r\n                          {format(new Date(activity.start_date), \"PPP\")}\r\n                          {activity.end_date &&\r\n                            ` - ${format(new Date(activity.end_date), \"PPP\")}`}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex gap-2 flex-wrap\">\r\n                      {(activity as any).status !== \"draft\" && (\r\n                        <Button variant=\"outline\" size=\"sm\" asChild className=\"flex-1 sm:flex-initial\">\r\n                          <Link to={`/admin/activity-stats/${activity.id}`}>\r\n                            <BarChart3 className=\"w-4 h-4 mr-1\" />\r\n                            {t(\"admin.stats\", \"ÁªüËÆ°\")}\r\n                          </Link>\r\n                        </Button>\r\n                      )}\r\n                      <Button variant=\"outline\" size=\"sm\" asChild className=\"flex-1 sm:flex-initial\">\r\n                        <Link to={`/activity/${activity.id}`} state={{ from: \"admin\" }}>{t(\"admin.view\")}</Link>\r\n                      </Button>\r\n                      <ActivityFormDialog\r\n                        activity={activity}\r\n                        trigger={\r\n                          <Button variant=\"outline\" size=\"sm\" className=\"flex-1 sm:flex-initial\">\r\n                            {t(\"common.edit\")}\r\n                          </Button>\r\n                        }\r\n                      />\r\n                      {(activity as any).status === \"draft\" ? (\r\n                        /* Draft activity: simple confirmation */\r\n                        <AlertDialog>\r\n                          <AlertDialogTrigger asChild>\r\n                            <Button variant=\"outline\" size=\"sm\" className=\"flex-1 sm:flex-initial\">\r\n                              {t(\"common.delete\")}\r\n                            </Button>\r\n                          </AlertDialogTrigger>\r\n                          <AlertDialogContent className=\"max-w-[90vw] sm:max-w-[425px]\">\r\n                            <AlertDialogHeader>\r\n                              <AlertDialogTitle>{t(\"admin.confirmDelete\")}</AlertDialogTitle>\r\n                              <AlertDialogDescription>\r\n                                <p>{t(\"admin.deleteActivityWarning\")}</p>\r\n                                <p className=\"font-semibold text-foreground mt-2\">\r\n                                  {getLocalizedField(activity, \"title\")}\r\n                                </p>\r\n                              </AlertDialogDescription>\r\n                            </AlertDialogHeader>\r\n                            <AlertDialogFooter>\r\n                              <AlertDialogCancel>{t(\"common.cancel\")}</AlertDialogCancel>\r\n                              <AlertDialogAction\r\n                                onClick={() => deleteActivity.mutate(activity.id)}\r\n                                className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\r\n                              >\r\n                                {t(\"common.delete\")}\r\n                              </AlertDialogAction>\r\n                            </AlertDialogFooter>\r\n                          </AlertDialogContent>\r\n                        </AlertDialog>\r\n                      ) : (\r\n                        /* Published activity: strict verification */\r\n                        <AlertDialog>\r\n                          <AlertDialogTrigger asChild>\r\n                            <Button variant=\"outline\" size=\"sm\" className=\"flex-1 sm:flex-initial\">\r\n                              {t(\"common.delete\")}\r\n                            </Button>\r\n                          </AlertDialogTrigger>\r\n                          <AlertDialogContent className=\"max-w-[90vw] sm:max-w-[425px]\">\r\n                            <AlertDialogHeader>\r\n                              <AlertDialogTitle>{t(\"admin.confirmDelete\")}</AlertDialogTitle>\r\n                              <AlertDialogDescription className=\"space-y-3\">\r\n                                <p>{t(\"admin.deleteActivityWarning\")}</p>\r\n                                <p className=\"font-semibold text-foreground\">\r\n                                  {getLocalizedField(activity, \"title\")}\r\n                                </p>\r\n                                <div className=\"space-y-2\">\r\n                                  <p className=\"text-sm\">{t(\"admin.typeDeleteToConfirmBatch\")}</p>\r\n                                  <Input\r\n                                    value={deleteConfirmText[activity.id] || \"\"}\r\n                                    onChange={(e) => setDeleteConfirmText({ ...deleteConfirmText, [activity.id]: e.target.value })}\r\n                                    placeholder=\"DELETE\"\r\n                                    className=\"font-mono\"\r\n                                  />\r\n                                </div>\r\n                              </AlertDialogDescription>\r\n                            </AlertDialogHeader>\r\n                            <AlertDialogFooter>\r\n                              <AlertDialogCancel onClick={() => setDeleteConfirmText({ ...deleteConfirmText, [activity.id]: \"\" })}>\r\n                                {t(\"common.cancel\")}\r\n                              </AlertDialogCancel>\r\n                              <AlertDialogAction\r\n                                disabled={deleteConfirmText[activity.id] !== \"DELETE\"}\r\n                                onClick={() => {\r\n                                  deleteActivity.mutate(activity.id);\r\n                                  setDeleteConfirmText({ ...deleteConfirmText, [activity.id]: \"\" });\r\n                                }}\r\n                                className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\r\n                              >\r\n                                {t(\"common.delete\")}\r\n                              </AlertDialogAction>\r\n                            </AlertDialogFooter>\r\n                          </AlertDialogContent>\r\n                        </AlertDialog>\r\n                      )}\r\n                    </div>\r\n                  </CardContent>\r\n                </div>\r\n              </div>\r\n            </Card>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  export default AdminActivities;\r\n"],"names":["RECOMMENDED_WIDTH","RECOMMENDED_HEIGHT","ASPECT_RATIO","centerAspectCrop","mediaWidth","mediaHeight","aspect","centerCrop","makeAspectCrop","ImageCropDialog","open","onOpenChange","imageFile","onCropComplete","t","useTranslation","imgSrc","setImgSrc","useState","crop","setCrop","completedCrop","setCompletedCrop","imgRef","useRef","isCropping","setIsCropping","useEffect","reader","onImageLoad","useCallback","e","width","height","getCroppedImg","image","canvas","ctx","scaleX","scaleY","resolve","reject","blob","handleCropConfirm","croppedBlob","croppedFile","previewUrl","error","Dialog","jsxs","DialogContent","DialogHeader","DialogTitle","jsx","CropIcon","DialogDescription","Alert","Info","AlertDescription","Badge","Maximize2","ReactCrop","c","DialogFooter","Button","draftSchema","z.object","z.string","z.date","z.enum","z.number","z.array","z.boolean","publishedSchema","i18n","activitySchema","ActivityFormDialog","activity","trigger","t$1","queryClient","useQueryClient","setOpen","setImageFile","imagePreview","setImagePreview","selectedRestaurants","setSelectedRestaurants","restaurantSearch","setRestaurantSearch","isSubmitting","setIsSubmitting","showCropDialog","setShowCropDialog","tempImageFile","setTempImageFile","mediaType","setMediaType","videoFile","setVideoFile","videoPreview","setVideoPreview","isUploadingVideo","setIsUploadingVideo","videoDeleted","setVideoDeleted","restaurants","useRestaurants","getDefaultValues","register","handleSubmit","errors","setValue","watch","control","reset","useForm","zodResolver","handleOpenChange","newOpen","startDate","endDate","pinned","visible","status","data","supabase","ar","handleImageChange","file","toast","handleCropComplete","preview","handleVideoChange","uploadImage","fileExt","filePath","uploadError","publicUrl","uploadVideo","fileName","onSubmit","publishedResult","fieldLabels","missingFields","err","fieldPath","user","imageUrl","videoUrl","finalVisible","baseActivityData","associations","restaurantId","assocError","activityDataWithCreator","newActivity","autoLinkTemplates","couponAssociations","template","DialogTrigger","Globe","ScrollArea","Card","CardContent","Label","Upload","Image","Video","X","Input","Tabs","TabsList","TabsTrigger","TabsContent","Controller","field","RichTextEditor","CalendarIcon","Popover","PopoverTrigger","cn","format","PopoverContent","Calendar","date","Select","value","SelectTrigger","SelectValue","SelectContent","SelectItem","ranges","addRange","newRanges","removeRange","index","_","i","updateRange","key","range","day","Trash2","Plus","FileEdit","Send","Checkbox","checked","Pin","ArrowUpDown","Store","Search","restaurant","search","id","Fragment","ActivityRulesEditorDialog","children","rules","isLoading","useActivityRules","updateRules","useUpdateActivityRules","activeTab","setActiveTab","contentZh","setContentZh","contentEn","setContentEn","contentPt","setContentPt","handleSave","FileText","Loader2","Save","GlobalHandbookEditorDialog","handbook","useGlobalHandbook","updateHandbook","useUpdateGlobalHandbook","BookOpen","AdminActivities","useToast","activities","useAdminActivities","getLocalizedField","useLocalizedContent","deleteActivity","useDeleteActivity","batchDeleteActivities","useBatchDeleteActivities","selectedActivities","setSelectedActivities","searchQuery","setSearchQuery","statusFilter","setStatusFilter","deleteConfirmText","setDeleteConfirmText","batchDeleteConfirmText","setBatchDeleteConfirmText","filteredActivities","useMemo","title","content","matchesSearch","now","isEnded","isOngoing","activityStatus","matchesStatus","handleExport","exportActivitiesToCSV","toggleSelectActivity","activityId","prev","toggleSelectAll","a","handleBatchDelete","Download","AlertDialog","AlertDialogTrigger","AlertDialogContent","AlertDialogHeader","AlertDialogTitle","AlertDialogDescription","AlertDialogFooter","AlertDialogCancel","AlertDialogAction","CardHeader","CardTitle","CardDescription","Link","BarChart3"],"mappings":"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"}