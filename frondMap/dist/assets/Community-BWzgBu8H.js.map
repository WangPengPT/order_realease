{"version":3,"file":"Community-BWzgBu8H.js","sources":["../../src/components/community/CreatePostDialog.tsx","../../src/pages/Community.tsx"],"sourcesContent":["import { useState, useRef } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Image, Video, X, Loader2, Calendar } from \"lucide-react\";\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogTrigger,\r\n} from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { useCreatePost } from \"@/hooks/useCommunityPosts\";\r\nimport { useActivities } from \"@/hooks/useActivities\";\r\nimport { useLocalizedContent } from \"@/hooks/useLocalizedContent\";\r\nimport { toast } from \"sonner\";\r\n\r\ninterface CreatePostDialogProps {\r\n  trigger?: React.ReactNode;\r\n}\r\n\r\nconst CreatePostDialog = ({ trigger }: CreatePostDialogProps) => {\r\n  const { t } = useTranslation();\r\n  const { getLocalizedField } = useLocalizedContent();\r\n  const createPost = useCreatePost();\r\n  const { data: activities } = useActivities();\r\n\r\n  const [open, setOpen] = useState(false);\r\n  const [content, setContent] = useState(\"\");\r\n  const [imageUrls, setImageUrls] = useState<string[]>([]);\r\n  const [videoUrl, setVideoUrl] = useState<string | null>(null);\r\n  const [activityId, setActivityId] = useState<string>(\"\");\r\n  const [uploading, setUploading] = useState(false);\r\n\r\n  const imageInputRef = useRef<HTMLInputElement>(null);\r\n  const videoInputRef = useRef<HTMLInputElement>(null);\r\n\r\n  const handleImageUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const files = e.target.files;\r\n    if (!files || files.length === 0) return;\r\n\r\n    if (imageUrls.length + files.length > 9) {\r\n      toast.error(t(\"community.maxImages\", \"最多上传9张图片\"));\r\n      return;\r\n    }\r\n\r\n    setUploading(true);\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (!user) throw new Error(\"Not authenticated\");\r\n\r\n      const uploadedUrls: string[] = [];\r\n\r\n      for (const file of Array.from(files)) {\r\n        const fileExt = file.name.split(\".\").pop();\r\n        const fileName = `${user.id}/${Date.now()}-${Math.random().toString(36).substring(7)}.${fileExt}`;\r\n\r\n        const { error: uploadError } = await supabase.storage\r\n          .from(\"community-posts\")\r\n          .upload(fileName, file);\r\n\r\n        if (uploadError) throw uploadError;\r\n\r\n        const { data: { publicUrl } } = supabase.storage\r\n          .from(\"community-posts\")\r\n          .getPublicUrl(fileName);\r\n\r\n        uploadedUrls.push(publicUrl);\r\n      }\r\n\r\n      setImageUrls((prev) => [...prev, ...uploadedUrls]);\r\n    } catch (error) {\r\n      console.error(\"Upload error:\", error);\r\n      toast.error(t(\"common.uploadError\", \"上传失败\"));\r\n    } finally {\r\n      setUploading(false);\r\n      if (imageInputRef.current) {\r\n        imageInputRef.current.value = \"\";\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleVideoUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (!file) return;\r\n\r\n    // Check file size (max 100MB)\r\n    if (file.size > 100 * 1024 * 1024) {\r\n      toast.error(t(\"community.videoTooLarge\", \"视频不能超过100MB\"));\r\n      return;\r\n    }\r\n\r\n    setUploading(true);\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (!user) throw new Error(\"Not authenticated\");\r\n\r\n      const fileExt = file.name.split(\".\").pop();\r\n      const fileName = `${user.id}/${Date.now()}.${fileExt}`;\r\n\r\n      const { error: uploadError } = await supabase.storage\r\n        .from(\"community-posts\")\r\n        .upload(fileName, file);\r\n\r\n      if (uploadError) throw uploadError;\r\n\r\n      const { data: { publicUrl } } = supabase.storage\r\n        .from(\"community-posts\")\r\n        .getPublicUrl(fileName);\r\n\r\n      setVideoUrl(publicUrl);\r\n    } catch (error) {\r\n      console.error(\"Upload error:\", error);\r\n      toast.error(t(\"common.uploadError\", \"上传失败\"));\r\n    } finally {\r\n      setUploading(false);\r\n      if (videoInputRef.current) {\r\n        videoInputRef.current.value = \"\";\r\n      }\r\n    }\r\n  };\r\n\r\n  const removeImage = (index: number) => {\r\n    setImageUrls((prev) => prev.filter((_, i) => i !== index));\r\n  };\r\n\r\n  const removeVideo = () => {\r\n    setVideoUrl(null);\r\n  };\r\n\r\n  const handleSubmit = async () => {\r\n    if (!content.trim()) {\r\n      toast.error(t(\"community.contentRequired\", \"请输入内容\"));\r\n      return;\r\n    }\r\n\r\n    await createPost.mutateAsync({\r\n      content,\r\n      image_urls: imageUrls,\r\n      video_url: videoUrl || undefined,\r\n      activity_id: activityId || undefined,\r\n    });\r\n\r\n    // Reset form\r\n    setContent(\"\");\r\n    setImageUrls([]);\r\n    setVideoUrl(null);\r\n    setActivityId(\"\");\r\n    setOpen(false);\r\n  };\r\n\r\n  const activeActivities = activities?.filter((a) => a.status === \"published\") || [];\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={setOpen}>\r\n      <DialogTrigger asChild>\r\n        {trigger || (\r\n          <Button>{t(\"community.createPost\", \"发布帖子\")}</Button>\r\n        )}\r\n      </DialogTrigger>\r\n      <DialogContent className=\"max-w-lg max-h-[90vh] overflow-y-auto\">\r\n        <DialogHeader>\r\n          <DialogTitle>{t(\"community.createPost\", \"发布帖子\")}</DialogTitle>\r\n        </DialogHeader>\r\n\r\n        <div className=\"space-y-4 mt-4\">\r\n          {/* Content */}\r\n          <div className=\"space-y-2\">\r\n            <Label>{t(\"community.content\", \"内容\")}</Label>\r\n            <Textarea\r\n              value={content}\r\n              onChange={(e) => setContent(e.target.value)}\r\n              placeholder={t(\"community.contentPlaceholder\", \"分享你的想法...\")}\r\n              rows={4}\r\n              className=\"resize-none\"\r\n            />\r\n          </div>\r\n\r\n          {/* Activity Selection */}\r\n          <div className=\"space-y-2\">\r\n            <Label className=\"flex items-center gap-2\">\r\n              <Calendar className=\"h-4 w-4\" />\r\n              {t(\"community.linkActivity\", \"关联活动\")}\r\n            </Label>\r\n            <Select value={activityId || \"none\"} onValueChange={(val) => setActivityId(val === \"none\" ? \"\" : val)}>\r\n              <SelectTrigger>\r\n                <SelectValue placeholder={t(\"community.selectActivity\", \"选择活动（可选）\")} />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"none\">\r\n                  {t(\"community.noActivity\", \"不关联活动\")}\r\n                </SelectItem>\r\n                {activeActivities.map((activity) => (\r\n                  <SelectItem key={activity.id} value={activity.id}>\r\n                    {getLocalizedField(activity, \"title\")}\r\n                  </SelectItem>\r\n                ))}\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n\r\n          {/* Image Preview */}\r\n          {imageUrls.length > 0 && (\r\n            <div className=\"grid grid-cols-3 gap-2\">\r\n              {imageUrls.map((url, index) => (\r\n                <div key={index} className=\"relative aspect-square rounded-lg overflow-hidden\">\r\n                  <img src={url} alt=\"\" className=\"w-full h-full object-cover\" />\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => removeImage(index)}\r\n                    className=\"absolute top-1 right-1 p-1 bg-black/50 rounded-full text-white hover:bg-black/70\"\r\n                  >\r\n                    <X className=\"h-3 w-3\" />\r\n                  </button>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n\r\n          {/* Video Preview */}\r\n          {videoUrl && (\r\n            <div className=\"relative rounded-lg overflow-hidden\">\r\n              <video src={videoUrl} controls className=\"w-full max-h-48\" preload=\"metadata\" />\r\n              <button\r\n                type=\"button\"\r\n                onClick={removeVideo}\r\n                className=\"absolute top-2 right-2 p-1 bg-black/50 rounded-full text-white hover:bg-black/70\"\r\n              >\r\n                <X className=\"h-4 w-4\" />\r\n              </button>\r\n            </div>\r\n          )}\r\n\r\n          {/* Upload Buttons */}\r\n          <div className=\"flex items-center gap-2\">\r\n            <input\r\n              ref={imageInputRef}\r\n              type=\"file\"\r\n              accept=\"image/*\"\r\n              multiple\r\n              className=\"hidden\"\r\n              onChange={handleImageUpload}\r\n            />\r\n            <input\r\n              ref={videoInputRef}\r\n              type=\"file\"\r\n              accept=\"video/*\"\r\n              className=\"hidden\"\r\n              onChange={handleVideoUpload}\r\n            />\r\n\r\n            <Button\r\n              type=\"button\"\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => imageInputRef.current?.click()}\r\n              disabled={uploading || imageUrls.length >= 9}\r\n            >\r\n              <Image className=\"h-4 w-4 mr-2\" />\r\n              {t(\"community.addImage\", \"添加图片\")}\r\n            </Button>\r\n\r\n            <Button\r\n              type=\"button\"\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => videoInputRef.current?.click()}\r\n              disabled={uploading || !!videoUrl}\r\n            >\r\n              <Video className=\"h-4 w-4 mr-2\" />\r\n              {t(\"community.addVideo\", \"添加视频\")}\r\n            </Button>\r\n\r\n            {uploading && <Loader2 className=\"h-4 w-4 animate-spin\" />}\r\n          </div>\r\n\r\n          {/* Submit */}\r\n          <div className=\"flex justify-end gap-2 pt-4\">\r\n            <Button variant=\"outline\" onClick={() => setOpen(false)}>\r\n              {t(\"common.cancel\", \"取消\")}\r\n            </Button>\r\n            <Button\r\n              onClick={handleSubmit}\r\n              disabled={createPost.isPending || !content.trim()}\r\n            >\r\n              {createPost.isPending && <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />}\r\n              {t(\"community.publish\", \"发布\")}\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default CreatePostDialog;\r\n","import { useCallback } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Plus } from \"lucide-react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Skeleton } from \"@/components/ui/skeleton\";\r\nimport PostCard from \"@/components/community/PostCard\";\r\nimport CreatePostDialog from \"@/components/community/CreatePostDialog\";\r\nimport { useCommunityPosts, useCanCreatePost } from \"@/hooks/useCommunityPosts\";\r\nimport { PullToRefresh } from \"@/components/PullToRefresh\";\r\nimport { useQueryClient } from \"@tanstack/react-query\";\r\n\r\nconst Community = () => {\r\n  const { t } = useTranslation();\r\n  const queryClient = useQueryClient();\r\n  const { data: posts, isLoading } = useCommunityPosts({ status: \"approved\" });\r\n  const { data: canPost } = useCanCreatePost();\r\n\r\n  const handleRefresh = useCallback(async () => {\r\n    await queryClient.invalidateQueries({ queryKey: ['community-posts'] });\r\n  }, [queryClient]);\r\n\r\n  return (\r\n    <PullToRefresh onRefresh={handleRefresh}>\r\n      <div className=\"container max-w-2xl mx-auto py-6 px-4\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between mb-6\">\r\n        <h1 className=\"text-2xl font-bold\">{t(\"nav.community\", \"社区\")}</h1>\r\n        {canPost && (\r\n          <CreatePostDialog\r\n            trigger={\r\n              <Button>\r\n                <Plus className=\"h-4 w-4 mr-2\" />\r\n                {t(\"community.createPost\", \"发布帖子\")}\r\n              </Button>\r\n            }\r\n          />\r\n        )}\r\n      </div>\r\n\r\n      {/* Posts List */}\r\n      <div className=\"space-y-4\">\r\n        {isLoading ? (\r\n          // Loading skeleton\r\n          Array.from({ length: 3 }).map((_, i) => (\r\n            <div key={i} className=\"rounded-lg border p-4 space-y-4\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <Skeleton className=\"h-10 w-10 rounded-full\" />\r\n                <div className=\"space-y-2\">\r\n                  <Skeleton className=\"h-4 w-24\" />\r\n                  <Skeleton className=\"h-3 w-16\" />\r\n                </div>\r\n              </div>\r\n              <Skeleton className=\"h-20 w-full\" />\r\n              <div className=\"flex gap-4\">\r\n                <Skeleton className=\"h-8 w-16\" />\r\n                <Skeleton className=\"h-8 w-16\" />\r\n                <Skeleton className=\"h-8 w-16\" />\r\n              </div>\r\n            </div>\r\n          ))\r\n        ) : posts && posts.length > 0 ? (\r\n          posts.map((post) => <PostCard key={post.id} post={post} />)\r\n        ) : (\r\n          <div className=\"text-center py-12 text-muted-foreground\">\r\n            <p>{t(\"community.noPosts\", \"暂无帖子\")}</p>\r\n            {canPost && (\r\n              <p className=\"mt-2\">\r\n                {t(\"community.beFirst\", \"成为第一个发帖的人吧！\")}\r\n              </p>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n    </PullToRefresh>\r\n  );\r\n};\r\n\r\nexport default Community;\r\n"],"names":["CreatePostDialog","trigger","t","useTranslation","getLocalizedField","useLocalizedContent","createPost","useCreatePost","activities","useActivities","open","setOpen","useState","content","setContent","imageUrls","setImageUrls","videoUrl","setVideoUrl","activityId","setActivityId","uploading","setUploading","imageInputRef","useRef","videoInputRef","handleImageUpload","e","files","toast","user","supabase","uploadedUrls","file","fileExt","fileName","uploadError","publicUrl","prev","error","handleVideoUpload","removeImage","index","_","i","removeVideo","handleSubmit","activeActivities","a","jsxs","Dialog","jsx","DialogTrigger","Button","DialogContent","DialogHeader","DialogTitle","Label","Textarea","Calendar","Select","val","SelectTrigger","SelectValue","SelectContent","SelectItem","activity","url","X","Image","Video","Loader2","Community","queryClient","useQueryClient","posts","isLoading","useCommunityPosts","canPost","useCanCreatePost","handleRefresh","useCallback","PullToRefresh","Plus","Skeleton","post","PostCard"],"mappings":"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"}