import{j as e}from"./vendor-ui-BO6fjm1h.js";import{r as c}from"./vendor-react-CrHRjzzo.js";import{D as $,c as G,d as ee,e as se,b7 as R,aA as ge,ax as O,ay as q,az as J,k as j,aN as pe,W as ae,p as ve,av as Ne,at as V,aB as Q,bb as W,aD as Y,B as x,X as te,L as B,aC as ne,cj as ie,by as H,bx as z,S as fe,K as r,q as o,P as m,aI as D,Y as I,bM as le,cO as we,cB as be,be as Z,O as Ce,Z as ye,w as ke,I as Se,aW as Re,aX as De,aY as _e,aZ as Ae,a_ as S,aQ as Le}from"./index-sgw1izSd.js";import{T as Ie,a as Te,b as K,c as N,d as Fe,e as f}from"./table-CVREUt4m.js";import{e as de,f as re,g as ce,h as Ue,i as Me,j as Pe,k as Be}from"./useInvitationCodes-Dw_jBvr8.js";import{S as oe}from"./separator-DjM-h3wE.js";import{u as E}from"./vendor-i18n-DWR4v88Y.js";import{f as T}from"./format-ReenjcUw.js";import"./vendor-charts-C50LysBY.js";import"./vendor-query-EnOED-MY.js";import"./vendor-supabase-QnE9GqXs.js";import"./startOfDay-CX5ZLMh9.js";const He=({open:a,onOpenChange:u,invitationCode:t})=>{const{t:n}=E(),l=de(),d=re(),g=ce(),[p,i]=c.useState(""),[w,v]=c.useState(""),[_,b]=c.useState(!1),[C,y]=c.useState(!1);if(!t)return null;const A=async()=>{await l.mutateAsync(t.id),u(!1)},F=async()=>{p.trim()&&(await d.mutateAsync({id:t.id,reason:p}),u(!1),i(""),b(!1))},L=async()=>{w.trim()&&(await g.mutateAsync({id:t.id,reason:w}),u(!1),v(""),y(!1))},U=t.status==="pending",M=t.status==="approved",h=l.isPending||d.isPending||g.isPending;return e.jsx($,{open:a,onOpenChange:u,children:e.jsxs(G,{className:"sm:max-w-lg",children:[e.jsxs(ee,{children:[e.jsxs(se,{className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-5 h-5 text-primary"}),n("admin.invitationCodes.reviewTitle","审核邀请码申请")]}),e.jsx(ge,{children:n("admin.invitationCodes.reviewDesc","查看申请详情并决定是否通过")})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-muted/50 rounded-lg",children:[e.jsxs(O,{className:"w-12 h-12",children:[e.jsx(q,{src:t.profiles?.avatar_url}),e.jsx(J,{children:t.full_name?.charAt(0)||"U"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold",children:t.full_name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.profiles?.display_name})]}),e.jsxs(j,{variant:t.status==="approved"?"default":t.status==="rejected"?"destructive":t.status==="revoked"?"outline":"secondary",className:t.status==="revoked"?"text-orange-600 border-orange-500":"",children:[t.status==="approved"&&n("admin.invitationCodes.approved","已通过"),t.status==="rejected"&&n("admin.invitationCodes.rejected","已拒绝"),t.status==="pending"&&n("admin.invitationCodes.pending","待审核"),t.status==="revoked"&&n("admin.invitationCodes.revoked","已收回")]})]}),e.jsx(oe,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(pe,{className:"w-4 h-4 text-muted-foreground mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:n("admin.invitationCodes.nif","NIF")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.nif})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ae,{className:"w-4 h-4 text-muted-foreground mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:n("admin.invitationCodes.contact","联系方式")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.contact||"-"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ve,{className:"w-4 h-4 text-muted-foreground mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:n("admin.invitationCodes.address","地址")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.address})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(R,{className:"w-4 h-4 text-muted-foreground mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:n("admin.invitationCodes.code","邀请码")}),e.jsx("code",{className:"text-sm font-mono bg-primary/10 text-primary px-2 py-1 rounded",children:t.code})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ne,{className:"w-4 h-4 text-muted-foreground mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:n("admin.invitationCodes.createdAt","申请时间")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:T(new Date(t.created_at),"yyyy-MM-dd HH:mm:ss")})]})]}),t.status==="approved"&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(V,{className:"w-4 h-4 text-muted-foreground mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:n("admin.invitationCodes.usageCount","使用次数")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.usage_count})]})]}),t.rejection_reason&&t.status==="rejected"&&e.jsxs("div",{className:"p-3 bg-destructive/10 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-destructive",children:n("admin.invitationCodes.rejectionReason","拒绝原因")}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:t.rejection_reason})]}),t.rejection_reason&&t.status==="revoked"&&e.jsxs("div",{className:"p-3 bg-orange-500/10 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-orange-600",children:n("admin.invitationCodes.revokeReason","收回原因")}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:t.rejection_reason})]})]}),_&&e.jsxs("div",{className:"space-y-2 p-4 border rounded-lg bg-destructive/5",children:[e.jsx(Q,{children:n("admin.invitationCodes.rejectionReason","拒绝原因")}),e.jsx(W,{value:p,onChange:k=>i(k.target.value),placeholder:n("admin.invitationCodes.rejectionReasonPlaceholder","请输入拒绝原因..."),className:"resize-none",rows:3})]}),C&&e.jsxs("div",{className:"space-y-2 p-4 border rounded-lg bg-orange-500/5 border-orange-200",children:[e.jsx(Q,{className:"text-orange-600",children:n("admin.invitationCodes.revokeReason","收回原因")}),e.jsx(W,{value:w,onChange:k=>v(k.target.value),placeholder:n("admin.invitationCodes.revokeReasonPlaceholder","请输入收回原因..."),className:"resize-none",rows:3})]})]}),U&&!C&&e.jsx(Y,{className:"gap-2 sm:gap-0",children:_?e.jsxs(e.Fragment,{children:[e.jsx(x,{variant:"outline",onClick:()=>{b(!1),i("")},disabled:h,children:n("common.cancel","取消")}),e.jsxs(x,{variant:"destructive",onClick:F,disabled:h||!p.trim(),children:[h&&e.jsx(B,{className:"w-4 h-4 mr-2 animate-spin"}),n("admin.invitationCodes.confirmReject","确认拒绝")]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(x,{variant:"outline",onClick:()=>b(!0),disabled:h,children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),n("admin.invitationCodes.reject","拒绝")]}),e.jsxs(x,{onClick:A,disabled:h,className:"bg-green-600 hover:bg-green-700",children:[h&&e.jsx(B,{className:"w-4 h-4 mr-2 animate-spin"}),e.jsx(ne,{className:"w-4 h-4 mr-2"}),n("admin.invitationCodes.approve","通过")]})]})}),M&&e.jsx(Y,{className:"gap-2 sm:gap-0",children:C?e.jsxs(e.Fragment,{children:[e.jsx(x,{variant:"outline",onClick:()=>{y(!1),v("")},disabled:h,children:n("common.cancel","取消")}),e.jsxs(x,{variant:"default",className:"bg-orange-600 hover:bg-orange-700",onClick:L,disabled:h||!w.trim(),children:[h&&e.jsx(B,{className:"w-4 h-4 mr-2 animate-spin"}),e.jsx(H,{className:"w-4 h-4 mr-2"}),n("admin.invitationCodes.confirmRevoke","确认收回")]})]}):e.jsxs(x,{variant:"outline",onClick:()=>y(!0),className:"text-orange-600 border-orange-300 hover:bg-orange-50",children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),n("admin.invitationCodes.revoke","收回邀请码")]})})]})})},ze=({open:a,onOpenChange:u,invitationCode:t,codeOwner:n})=>{const{t:l}=E(),{data:d,isLoading:g}=Ue(a?t:null),p=i=>{switch(i){case"completed":return e.jsxs(j,{variant:"outline",className:"text-green-600 border-green-500 bg-green-50 dark:bg-green-950/30",children:[e.jsx(D,{className:"w-3 h-3 mr-1"}),l("admin.invitationCodes.stats.completed","已完成")]});case"pending":case"received":return e.jsxs(j,{variant:"outline",className:"text-yellow-600 border-yellow-500 bg-yellow-50 dark:bg-yellow-950/30",children:[e.jsx(I,{className:"w-3 h-3 mr-1"}),l("admin.invitationCodes.stats.pending","进行中")]});default:return e.jsx(j,{variant:"secondary",children:i})}};return e.jsx($,{open:a,onOpenChange:u,children:e.jsxs(G,{className:"sm:max-w-2xl max-h-[85vh]",children:[e.jsxs(ee,{children:[e.jsxs(se,{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5 text-primary"}),l("admin.invitationCodes.statsTitle","邀请码统计详情")]}),t&&e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("code",{className:"px-2 py-1 bg-primary/10 text-primary rounded font-mono text-sm",children:t}),n&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:[l("admin.invitationCodes.stats.owner","所有者"),": ",n]})]})]}),e.jsx(fe,{className:"max-h-[calc(85vh-120px)]",children:g?e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[1,2,3,4].map(i=>e.jsx(r,{className:"h-20"},i))}),e.jsx(r,{className:"h-32"}),e.jsx(r,{className:"h-32"})]}):d?e.jsxs("div",{className:"space-y-6 p-1",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsx(o,{children:e.jsx(m,{className:"pt-4 pb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-primary/10",children:e.jsx(V,{className:"w-4 h-4 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold",children:d.stats.totalUsed}),e.jsx("p",{className:"text-xs text-muted-foreground",children:l("admin.invitationCodes.stats.totalUsed","总使用次数")})]})]})})}),e.jsx(o,{children:e.jsx(m,{className:"pt-4 pb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-green-500/10",children:e.jsx(D,{className:"w-4 h-4 text-green-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold",children:d.stats.completedJoinRequests}),e.jsx("p",{className:"text-xs text-muted-foreground",children:l("admin.invitationCodes.stats.completed","已完成")})]})]})})}),e.jsx(o,{children:e.jsx(m,{className:"pt-4 pb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-yellow-500/10",children:e.jsx(I,{className:"w-4 h-4 text-yellow-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold",children:d.stats.pendingJoinRequests}),e.jsx("p",{className:"text-xs text-muted-foreground",children:l("admin.invitationCodes.stats.inProgress","进行中")})]})]})})}),e.jsx(o,{children:e.jsx(m,{className:"pt-4 pb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 rounded-lg bg-blue-500/10",children:e.jsx(le,{className:"w-4 h-4 text-blue-500"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-xl font-bold",children:[d.stats.successRate,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:l("admin.invitationCodes.stats.successRate","成功率")})]})]})})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2 mb-3",children:[e.jsx(we,{className:"w-4 h-4"}),l("admin.invitationCodes.stats.joinRequests","商家加入申请"),e.jsx(j,{variant:"secondary",className:"ml-auto",children:d.joinRequests.length})]}),d.joinRequests.length===0?e.jsx("div",{className:"text-sm text-muted-foreground text-center py-6 bg-muted/30 rounded-lg",children:l("admin.invitationCodes.stats.noJoinRequests","暂无使用此邀请码的商家申请")}):e.jsx("div",{className:"space-y-2",children:d.joinRequests.map(i=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/30 rounded-lg",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:i.restaurant_name}),e.jsxs("p",{className:"text-xs text-muted-foreground truncate",children:[i.name," • ",i.email]})]}),e.jsxs("div",{className:"flex items-center gap-3 ml-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground hidden sm:block",children:T(new Date(i.created_at),"yyyy-MM-dd")}),p(i.status)]})]},i.id))})]}),e.jsx(oe,{}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2 mb-3",children:[e.jsx(be,{className:"w-4 h-4"}),l("admin.invitationCodes.stats.registeredUsers","已注册用户"),e.jsx(j,{variant:"secondary",className:"ml-auto",children:d.invitedUsers.length})]}),d.invitedUsers.length===0?e.jsx("div",{className:"text-sm text-muted-foreground text-center py-6 bg-muted/30 rounded-lg",children:l("admin.invitationCodes.stats.noUsers","暂无使用此邀请码注册的用户")}):e.jsx("div",{className:"space-y-2",children:d.invitedUsers.map(i=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted/30 rounded-lg",children:[e.jsxs(O,{className:"w-8 h-8",children:[e.jsx(q,{src:i.avatar_url}),e.jsx(J,{children:i.display_name?.charAt(0)||"U"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:i.display_name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[l("admin.invitationCodes.stats.registeredAt","注册时间"),": "," ",T(new Date(i.invited_at||i.created_at),"yyyy-MM-dd HH:mm")]})]}),e.jsxs(j,{variant:"outline",className:"text-green-600 border-green-500",children:[e.jsx(D,{className:"w-3 h-3 mr-1"}),l("admin.invitationCodes.stats.registered","已注册")]})]},i.id))})]})]}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:l("admin.invitationCodes.stats.noData","暂无数据")})})]})})},Ge=()=>{const{t:a}=E(),{data:u,isLoading:t}=Me(),{data:n,isLoading:l}=Pe(),{data:d,isLoading:g}=Be(),p=de();re(),ce();const[i,w]=c.useState(""),[v,_]=c.useState("all"),[b,C]=c.useState(null),[y,A]=c.useState(!1),[F,L]=c.useState(!1),[U,M]=c.useState(null),[h,k]=c.useState(void 0),X=c.useMemo(()=>u?u.filter(s=>{const je=s.code.toLowerCase().includes(i.toLowerCase())||s.full_name.toLowerCase().includes(i.toLowerCase())||s.nif.toLowerCase().includes(i.toLowerCase())||(s.contact||"").toLowerCase().includes(i.toLowerCase())||s.profiles?.display_name?.toLowerCase().includes(i.toLowerCase()),ue=v==="all"||s.status===v;return je&&ue}):[],[u,i,v]),me=async s=>{await p.mutateAsync(s)},P=s=>{C(s),A(!0)},xe=s=>{M(s.code),k(s.full_name),L(!0)},he=s=>{switch(s){case"pending":return e.jsxs(j,{variant:"outline",className:"text-yellow-600 border-yellow-500 bg-yellow-50 dark:bg-yellow-950/30",children:[e.jsx(I,{className:"w-3 h-3 mr-1"}),a("admin.invitationCodes.pending","待审核")]});case"approved":return e.jsxs(j,{variant:"outline",className:"text-green-600 border-green-500 bg-green-50 dark:bg-green-950/30",children:[e.jsx(D,{className:"w-3 h-3 mr-1"}),a("admin.invitationCodes.approved","已通过")]});case"rejected":return e.jsxs(j,{variant:"outline",className:"text-red-600 border-red-500 bg-red-50 dark:bg-red-950/30",children:[e.jsx(Z,{className:"w-3 h-3 mr-1"}),a("admin.invitationCodes.rejected","已拒绝")]});case"revoked":return e.jsxs(j,{variant:"outline",className:"text-orange-600 border-orange-500 bg-orange-50 dark:bg-orange-950/30",children:[e.jsx(H,{className:"w-3 h-3 mr-1"}),a("admin.invitationCodes.revoked","已收回")]});default:return null}};return e.jsxs("div",{className:"p-4 md:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(R,{className:"w-6 h-6 text-primary"}),a("admin.invitationCodes.title","邀请码管理")]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:a("admin.invitationCodes.description","审核用户的邀请码申请，管理邀请码使用情况")})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsx(o,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(R,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:l?e.jsx(r,{className:"h-8 w-12"}):n?.total||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a("admin.invitationCodes.totalApplications","总申请数")})]})]})})}),e.jsx(o,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-yellow-500/10",children:e.jsx(I,{className:"w-5 h-5 text-yellow-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:l?e.jsx(r,{className:"h-8 w-12"}):n?.pending||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a("admin.invitationCodes.pendingReview","待审核")})]})]})})}),e.jsx(o,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-green-500/10",children:e.jsx(D,{className:"w-5 h-5 text-green-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:l?e.jsx(r,{className:"h-8 w-12"}):n?.approved||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a("admin.invitationCodes.approvedCount","已通过")})]})]})})}),e.jsx(o,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-red-500/10",children:e.jsx(Z,{className:"w-5 h-5 text-red-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:l?e.jsx(r,{className:"h-8 w-12"}):n?.rejected||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a("admin.invitationCodes.rejectedCount","已拒绝")})]})]})})}),e.jsx(o,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-orange-500/10",children:e.jsx(H,{className:"w-5 h-5 text-orange-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:l?e.jsx(r,{className:"h-8 w-12"}):n?.revoked||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a("admin.invitationCodes.revokedCount","已收回")})]})]})})})]}),e.jsxs(o,{children:[e.jsx(Ce,{className:"pb-3",children:e.jsxs(ye,{className:"text-base flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4 text-primary"}),a("admin.invitationCodes.performanceStats","邀请码效果统计")]})}),e.jsx(m,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:g?e.jsx(r,{className:"h-8 w-12 mx-auto"}):d?.totalUsage||0}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:a("admin.invitationCodes.stats.totalUsage","总使用次数")})]}),e.jsxs("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:g?e.jsx(r,{className:"h-8 w-12 mx-auto"}):d?.activeCodesCount||0}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:a("admin.invitationCodes.stats.activeCodes","有效使用码")})]}),e.jsxs("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:g?e.jsx(r,{className:"h-8 w-12 mx-auto"}):d?.completedJoinRequests||0}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:a("admin.invitationCodes.stats.successfulInvites","成功邀请")})]}),e.jsxs("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(le,{className:"w-4 h-4 text-green-500"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:g?e.jsx(r,{className:"h-8 w-12"}):`${d?.overallSuccessRate||0}%`})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:a("admin.invitationCodes.stats.overallSuccessRate","整体成功率")})]})]})})]}),e.jsx(o,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ke,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(Se,{placeholder:a("admin.invitationCodes.searchPlaceholder","搜索邀请码、姓名、NIF..."),value:i,onChange:s=>w(s.target.value),className:"pl-10"})]}),e.jsxs(Re,{value:v,onValueChange:_,children:[e.jsx(De,{className:"w-full md:w-40",children:e.jsx(_e,{})}),e.jsxs(Ae,{children:[e.jsx(S,{value:"all",children:a("common.all","全部")}),e.jsx(S,{value:"pending",children:a("admin.invitationCodes.pending","待审核")}),e.jsx(S,{value:"approved",children:a("admin.invitationCodes.approved","已通过")}),e.jsx(S,{value:"rejected",children:a("admin.invitationCodes.rejected","已拒绝")}),e.jsx(S,{value:"revoked",children:a("admin.invitationCodes.revoked","已收回")})]})]})]})})}),e.jsx(o,{children:e.jsx(m,{className:"p-0",children:t?e.jsx("div",{className:"p-6 space-y-4",children:[1,2,3].map(s=>e.jsx(r,{className:"h-16 w-full"},s))}):X.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(R,{className:"w-12 h-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:a("admin.invitationCodes.noResults","没有找到邀请码申请")})]}):e.jsxs(Ie,{children:[e.jsx(Te,{children:e.jsxs(K,{children:[e.jsx(N,{children:a("admin.invitationCodes.applicant","申请人")}),e.jsx(N,{children:a("admin.invitationCodes.code","邀请码")}),e.jsx(N,{children:a("admin.invitationCodes.nif","NIF")}),e.jsx(N,{children:a("admin.invitationCodes.contact","联系方式")}),e.jsx(N,{children:a("admin.invitationCodes.status","状态")}),e.jsx(N,{children:a("admin.invitationCodes.usageCount","使用次数")}),e.jsx(N,{children:a("admin.invitationCodes.createdAt","申请时间")}),e.jsx(N,{className:"text-right",children:a("common.actions","操作")})]})}),e.jsx(Fe,{children:X.map(s=>e.jsxs(K,{children:[e.jsx(f,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(O,{className:"w-8 h-8",children:[e.jsx(q,{src:s.profiles?.avatar_url}),e.jsx(J,{children:s.full_name?.charAt(0)||"U"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.full_name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.profiles?.display_name})]})]})}),e.jsx(f,{children:e.jsx("code",{className:"px-2 py-1 bg-muted rounded text-sm font-mono",children:s.code})}),e.jsx(f,{children:s.nif}),e.jsx(f,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"w-3 h-3 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:s.contact||"-"})]})}),e.jsx(f,{children:he(s.status)}),e.jsx(f,{children:e.jsxs(x,{variant:"ghost",size:"sm",className:"h-auto p-1 gap-1",onClick:()=>xe(s),disabled:s.status!=="approved",children:[e.jsx(V,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{children:s.usage_count}),s.status==="approved"&&e.jsx(z,{className:"w-3 h-3 text-primary ml-1"})]})}),e.jsx(f,{children:T(new Date(s.created_at),"yyyy-MM-dd HH:mm")}),e.jsx(f,{children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(x,{variant:"ghost",size:"icon",onClick:()=>P(s),children:e.jsx(Le,{className:"w-4 h-4"})}),s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(x,{variant:"ghost",size:"icon",className:"text-green-600 hover:text-green-700 hover:bg-green-50",onClick:()=>me(s.id),disabled:p.isPending,children:e.jsx(ne,{className:"w-4 h-4"})}),e.jsx(x,{variant:"ghost",size:"icon",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>P(s),children:e.jsx(te,{className:"w-4 h-4"})})]}),s.status==="approved"&&e.jsx(x,{variant:"ghost",size:"icon",className:"text-orange-600 hover:text-orange-700 hover:bg-orange-50",onClick:()=>P(s),title:a("admin.invitationCodes.revoke","收回"),children:e.jsx(ie,{className:"w-4 h-4"})})]})})]},s.id))})]})})}),e.jsx(He,{open:y,onOpenChange:A,invitationCode:b}),e.jsx(ze,{open:F,onOpenChange:L,invitationCode:U,codeOwner:h})]})};export{Ge as default};
//# sourceMappingURL=AdminInvitationCodes-CC8tHL_U.js.map
