import{p as pe,u as Me,r as n,j as e,aV as je,al as xt,aL as Ee,aW as pt,aX as gt,aM as ft,aY as Oe,aZ as ke,a_ as bt,a$ as wt,b0 as yt,av as Ve,ax as Be,b1 as _e,b2 as Fe,b3 as vt,b4 as Ue,b5 as Ce,b6 as Je,b7 as Ke,b8 as jt,b9 as Pe,ba as Nt,q as kt,bb as _t,bc as St,L as Ct,bd as At}from"./vendor-react-BJ_Fufgb.js";import{a as Qe,u as Dt,b as Ye,l as Rt,D as Lt,c as Tt,d as It,e as zt,S as Ze,f as E,g as Mt,I as $t,B as Y,h as V,C as Ae,s as Et,A as Ot,i as Vt,j as Bt,k as Ft,m as Pt,n as Wt,o as Ht,p as qt,q as Xt,r as Ut,t as Le,v as Jt,H as Kt,w as Ge,x as et,y as Qt}from"./index-BSqTIOKh.js";import{c as Yt,g as Zt,m as tt}from"./geolocation-DRm3QMsJ.js";import{a as Gt,g as es}from"./app-store-badge-CyCtXXOt.js";import{u as st}from"./useHomepageTemplates-D8aE7Z5t.js";import{u as ts}from"./usePageView-Ba049OaE.js";import{L as at}from"./LocationPermissionDialog-CrVzHLB5.js";import{P as ss}from"./PullToRefresh-CI1Yan2w.js";import{P as as,a as rs,b as ns}from"./popover-B15O0qUn.js";import{u as os,a as is}from"./useRestaurants-DmbF1jrQ.js";import{u as ls,R as cs,l as ds}from"./xiaoxiong-logo-clean-Cp93B6lJ.js";import{u as rt}from"./useLocalizedContent-Bk4lYsHC.js";import{u as nt}from"./useActivities-DTcpAzU7.js";import{a as We,f as Te,K as ms,L as He,M as us,i as hs}from"./vendor-utils-Z4kpnli5.js";import"./vendor-i18n-jtdHZIRR.js";import"./vendor-editor-B1vH4T8i.js";import"./vendor-supabase-Dbipw1Nj.js";import"./vendor-map-CvE3ASYw.js";const xs=()=>!!(window.webkit?.messageHandlers?.VoiceBridge||window.VoiceBridge),qe={start:()=>{const s=JSON.stringify({action:"start"});window.webkit?.messageHandlers?.VoiceBridge?window.webkit.messageHandlers.VoiceBridge.postMessage(s):window.VoiceBridge&&window.VoiceBridge.postMessage(s)},stop:()=>{const s=JSON.stringify({action:"stop"});window.webkit?.messageHandlers?.VoiceBridge?window.webkit.messageHandlers.VoiceBridge.postMessage(s):window.VoiceBridge&&window.VoiceBridge.postMessage(s)}},Ie="https://tzdgqhwyzsxkxnncgzap.supabase.co",ye="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR6ZGdxaHd5enN4a3hubmNnemFwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM2NTg2ODgsImV4cCI6MjA3OTIzNDY4OH0.D76C4OkjQVWyMxtjjdOofpD8X_hEEoTtrXHqi4XSYUw",ps=["最近","附近","离我","距离","远近","近的","周边","周围","最近的","附近的","nearest","closest","nearby","near me","close to me","distance","around me","mais perto","próximo","perto de mim","distância","mais próximo"],gs=()=>{const s="xiaoxiong_anonymous_user_id";let a=localStorage.getItem(s);return a||(a=`anon_${Date.now()}_${Math.random().toString(36).substring(2,11)}`,localStorage.setItem(s,a)),a},fs=({open:s,onOpenChange:a,provider:l="ask-xiaoxiong"})=>{const{i18n:c}=pe(),i=Me(),{settings:p}=Qe(),{user:m}=Dt(),w=Ye(),u=p?.logo_url||Rt,[d,f]=n.useState(""),[y,v]=n.useState([]),[k,S]=n.useState(!1),[j,U]=n.useState(null),[J,O]=n.useState(!1),[z,F]=n.useState(null),[R,M]=n.useState(!1),[K,P]=n.useState(!1),[B,Z]=n.useState(!1),x=n.useRef(null),A=n.useRef(null),W=n.useRef(null),ge=n.useRef(null),re=()=>{if(!K&&!B)return!1;const t=typeof window<"u"?window.innerWidth:1024,r=t>=768&&t<1024,o=t>=1024;return w?p?.voice_input_mobile!==!1:r?p?.voice_input_tablet!==!1:o?p?.voice_input_desktop!==!1:!0},ne=()=>m?.id?m.id:gs();n.useEffect(()=>{const t=window.SpeechRecognition||window.webkitSpeechRecognition;return P(!!t),Z(xs()),window.onSpeechResult=r=>{f(r),M(!1)},()=>{window.onSpeechResult=void 0}},[]),n.useEffect(()=>{s&&!j&&navigator.geolocation?.getCurrentPosition(t=>{U({lat:t.coords.latitude,lng:t.coords.longitude})},t=>{console.log("Unable to get user location:",t.message)},{enableHighAccuracy:!1,timeout:5e3,maximumAge:3e5})},[s,j]),n.useEffect(()=>{!s&&W.current&&(W.current.stop(),M(!1))},[s]),n.useEffect(()=>{ge.current?.scrollIntoView({behavior:"smooth"})},[y]);const fe=async(t,r)=>{const o=await fetch(`${Ie}/functions/v1/ask-xiaoxiong`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ye}`,apikey:ye},body:JSON.stringify({text:t.content,stream:!0,lat:j?.lat,lng:j?.lng}),signal:x.current?.signal});if(!o.ok)throw new Error(`Request failed with status: ${o.status}`);if(!o.body)throw new Error("No response body");const g=o.body.getReader(),h=new TextDecoder;let N="";for(;;){const{done:C,value:$}=await g.read();if(C)break;const xe=h.decode($,{stream:!0});N+=xe;let I=N;I.startsWith('"')&&(I=I.slice(1)),I.endsWith('"')&&(I=I.slice(0,-1)),I=I.replace(/\\n/g,`
`),v(G=>G.map(X=>X.id===r?{...X,content:I}:X))}let _=N;_.startsWith('"')&&(_=_.slice(1)),_.endsWith('"')&&(_=_.slice(0,-1)),_=_.replace(/\\n/g,`
`),v(C=>C.map($=>$.id===r?{...$,content:_,isStreaming:!1}:$))},oe=async(t,r)=>{const o=ne(),g=Date.now();console.log(`[前端-Agent] ⏱️ 开始发送请求: ${new Date().toISOString()}`);const h=await fetch(`${Ie}/functions/v1/xiaoxiong-agent`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ye}`,apikey:ye},body:JSON.stringify({message:t.content,userId:o}),signal:x.current?.signal}),N=Date.now()-g;if(console.log(`[前端-Agent] ⏱️ 收到响应头: ${new Date().toISOString()}, 耗时: ${N}ms`),!h.ok)throw new Error(`Request failed with status: ${h.status}`);if(!h.body)throw new Error("No response body");const _=h.body.getReader(),C=new TextDecoder;let $="",xe=!1,I=0;for(;;){const{done:G,value:X}=await _.read();if(G){console.log(`[前端-Agent] ⏱️ 流结束: ${new Date().toISOString()}, 总耗时: ${Date.now()-g}ms, 共 ${I} 个数据块`);break}I++;const Q=C.decode(X,{stream:!0});if($+=Q,!xe){xe=!0;const ie=Date.now()-g;console.log(`[前端-Agent] ⏱️ 首个数据块 (TTFB): ${new Date().toISOString()}, 耗时: ${ie}ms, 大小: ${Q.length} 字符`)}Oe.flushSync(()=>{v(ie=>ie.map(Ne=>Ne.id===r?{...Ne,content:$}:Ne))}),await new Promise(ie=>requestAnimationFrame(ie))}v(G=>G.map(X=>X.id===r?{...X,isStreaming:!1}:X))},be=async(t,r)=>{const o=Date.now();console.log(`[前端-LovableAI] ⏱️ 开始发送请求: ${new Date().toISOString()}`);const g=await fetch(`${Ie}/functions/v1/lovable-chat`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ye}`,apikey:ye},body:JSON.stringify({message:t.content,lat:j?.lat,lng:j?.lng,language:c.language}),signal:x.current?.signal}),h=Date.now()-o;if(console.log(`[前端-LovableAI] ⏱️ 收到响应头: ${new Date().toISOString()}, 耗时: ${h}ms`),!g.ok){const I=await g.json().catch(()=>({}));throw new Error(I.error||`Request failed with status: ${g.status}`)}if(!g.body)throw new Error("No response body");const N=g.body.getReader(),_=new TextDecoder;let C="",$="",xe=!1;for(;;){const{done:I,value:G}=await N.read();if(I){console.log(`[前端-LovableAI] ⏱️ 流结束: ${new Date().toISOString()}, 总耗时: ${Date.now()-o}ms`);break}if($+=_.decode(G,{stream:!0}),!xe){xe=!0;const Q=Date.now()-o;console.log(`[前端-LovableAI] ⏱️ 首个数据块 (TTFB): ${new Date().toISOString()}, 耗时: ${Q}ms`)}let X;for(;(X=$.indexOf(`
`))!==-1;){let Q=$.slice(0,X);if($=$.slice(X+1),Q.endsWith("\r")&&(Q=Q.slice(0,-1)),Q.startsWith(":")||Q.trim()===""||!Q.startsWith("data: "))continue;const ie=Q.slice(6).trim();if(ie==="[DONE]")break;try{const $e=JSON.parse(ie).choices?.[0]?.delta?.content;$e&&(C+=$e,Oe.flushSync(()=>{v(De=>De.map(Re=>Re.id===r?{...Re,content:C}:Re))}),await new Promise(De=>requestAnimationFrame(De)))}catch{}}}v(I=>I.map(G=>G.id===r?{...G,isStreaming:!1}:G))},le=t=>{const r=t.toLowerCase();return ps.some(o=>r.includes(o))},ee=async t=>{const r={id:Date.now().toString(),role:"user",content:t},o=(Date.now()+1).toString(),g={id:o,role:"assistant",content:"",isStreaming:!0};v(h=>[...h,r,g]),f(""),S(!0),x.current&&x.current.abort(),x.current=new AbortController;try{l==="lovable-ai"?await be(r,o):l==="xiaoxiong-agent"?await oe(r,o):await fe(r,o)}catch(h){if(h instanceof Error&&h.name==="AbortError"){console.log("Request aborted");return}console.error("Ask API error:",h);const N=c.language==="zh"?"抱歉，暂时无法获取结果，请稍后再试":c.language==="pt"?"Desculpe, não foi possível obter resultados. Tente novamente mais tarde.":"Sorry, unable to get results. Please try again later.";v(_=>_.map(C=>C.id===o?{...C,content:N,isStreaming:!1}:C))}finally{S(!1)}},ce=()=>{O(!1),navigator.geolocation?.getCurrentPosition(t=>{U({lat:t.coords.latitude,lng:t.coords.longitude}),z&&setTimeout(()=>{ee(z),F(null)},100)},t=>{console.log("Location permission denied:",t.message),z&&(ee(z),F(null))},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},b=async()=>{if(!d.trim()||k)return;const t=d.trim();if(!j&&le(t)){F(t),O(!0),f("");return}await ee(t)},L=t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),b())},H=()=>{if(B){qe.start(),M(!0);return}const t=window.SpeechRecognition||window.webkitSpeechRecognition;if(!t){console.log("Speech recognition not supported");return}W.current&&W.current.stop();const r=new t;W.current=r;const o={zh:"zh-CN",en:"en-US",pt:"pt-BR"};r.lang=o[c.language]||"zh-CN",r.continuous=!1,r.interimResults=!0,r.onstart=()=>{M(!0)},r.onresult=g=>{const h=Array.from(g.results).map(N=>N[0].transcript).join("");f(h)},r.onerror=g=>{console.log("Speech recognition error:",g.error),M(!1)},r.onend=()=>{M(!1)},r.start()},D=()=>{if(B){qe.stop(),M(!1);return}W.current&&(W.current.stop(),M(!1))},de=()=>{R?D():H()},te=()=>{x.current&&x.current.abort(),a(!1)},me=t=>{te(),i(t)},T=t=>{const r=/\[([^\]]+)\]\(([^)]+)\)/g,o=[];let g=0,h,N=0;for(;(h=r.exec(t))!==null;){h.index>g&&o.push(e.jsx("span",{children:t.slice(g,h.index)},N++));const _=h[1],C=h[2];C.startsWith("/")?o.push(e.jsx("button",{onClick:()=>me(C),className:"text-primary hover:underline font-medium cursor-pointer",children:_},N++)):o.push(e.jsx("a",{href:C,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline font-medium",children:_},N++)),g=h.index+h[0].length}return g<t.length&&o.push(e.jsx("span",{children:t.slice(g)},N++)),o.length>0?o:[e.jsx("span",{children:t},"0")]},we=t=>t.replace(/\*\*(.*?)\*\*/g,"$1"),se=(t,r=20)=>t.length<=r?t:t.slice(0,r)+"...",ue=(t,r)=>{const o=N=>N.split("|").slice(1,-1).map(_=>we(_.trim())),g=o(t[0]),h=t.slice(2).map(o);return e.jsx("div",{className:"overflow-x-auto my-2 max-w-full",children:e.jsxs("table",{className:"w-full text-xs border border-border rounded-md overflow-hidden table-fixed",children:[e.jsx("thead",{className:"bg-muted/60",children:e.jsx("tr",{children:g.map((N,_)=>e.jsx("th",{className:"px-2 py-2 text-left font-semibold border-b border-border truncate max-w-[100px]",title:N,children:T(se(N,15))},_))})}),e.jsx("tbody",{children:h.map((N,_)=>e.jsx("tr",{className:"border-b border-border last:border-0 hover:bg-muted/30 transition-colors",children:N.map((C,$)=>e.jsx("td",{className:"px-2 py-2 truncate max-w-[100px]",title:C,children:T(se(C,18))},$))},_))})]})},r)},q=t=>{const r=t.split(`
`),o=[];let g=0;for(;g<r.length;){const h=r[g];if(h.trim().startsWith("|")&&h.split("|").length>2){const N=[];for(;g<r.length&&r[g].trim().startsWith("|");)N.push(r[g]),g++;N.length>=2&&o.push(ue(N,o.length));continue}if(h.startsWith("### "))o.push(e.jsx("h3",{className:"text-base font-semibold mt-3 mb-1",children:T(h.slice(4))},o.length));else if(h.startsWith("## "))o.push(e.jsx("h2",{className:"text-lg font-bold mt-4 mb-2",children:T(h.slice(3))},o.length));else if(h.startsWith("# "))o.push(e.jsx("h1",{className:"text-xl font-bold mt-4 mb-2",children:T(h.slice(2))},o.length));else if(h.includes("**")){const N=h.split(/\*\*(.*?)\*\*/g);o.push(e.jsx("p",{className:"mb-1 leading-relaxed",children:N.map((_,C)=>C%2===1?e.jsx("strong",{className:"font-semibold",children:T(_)},C):T(_))},o.length))}else h.startsWith("- ")||h.startsWith("* ")?o.push(e.jsx("li",{className:"ml-4 mb-0.5 list-disc",children:T(h.slice(2))},o.length)):/^\d+\.\s/.test(h)?o.push(e.jsx("li",{className:"ml-4 mb-0.5 list-decimal",children:T(h.replace(/^\d+\.\s/,""))},o.length)):h.match(/^[-*_]{3,}$/)?o.push(e.jsx("hr",{className:"my-3 border-border"},o.length)):h.trim()===""?o.push(e.jsx("div",{className:"h-1"},o.length)):o.push(e.jsx("p",{className:"mb-1 leading-relaxed",children:T(h)},o.length));g++}return o},he=()=>c.language==="zh"?"小熊AI助手":c.language==="pt"?"Assistente IA Xiaoxiong":"Xiaoxiong AI Assistant",ae=()=>c.language==="zh"?"告诉小熊，你想吃什么...":c.language==="pt"?"Diga ao Xiaoxiong o que você quer comer...":"Tell Xiaoxiong what you want to eat...",ve=()=>c.language==="zh"?"你好，我是小熊，我来帮你推荐餐厅；比如：「我附近的寿司餐厅」":c.language==="pt"?"Olá, eu sou o Xiaoxiong, vou te ajudar a encontrar restaurantes; por exemplo: 「restaurantes de sushi perto de mim」":`Hi, I'm Xiaoxiong, I'll help you find restaurants; for example: "sushi restaurants near me"`;return e.jsx(Lt,{open:s,onOpenChange:te,children:e.jsxs(Tt,{className:"w-full h-full max-w-full max-h-full sm:max-w-lg sm:h-[70vh] sm:max-h-[70vh] sm:rounded-lg rounded-none flex flex-col p-0 gap-0 overflow-hidden",children:[e.jsx(It,{className:"px-4 py-3 shrink-0 bg-white/60 dark:bg-gray-900/60 backdrop-blur-md border-b border-white/30 dark:border-white/20 shadow-[0_1px_3px_rgba(0,0,0,0.05)]",children:e.jsxs(zt,{className:"flex items-center gap-3 text-base font-semibold",children:[e.jsx("div",{className:"w-9 h-9 rounded-full bg-white dark:bg-gray-800 flex items-center justify-center overflow-hidden shadow-sm border border-white/50 dark:border-white/30",children:e.jsx("img",{src:u,alt:"Logo",className:"w-6 h-6 object-contain"})}),e.jsx("span",{className:"text-foreground",children:he()})]})}),e.jsx(Ze,{className:"flex-1 h-0",ref:A,children:e.jsxs("div",{className:"p-4 space-y-4",children:[y.length===0&&e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center shrink-0",children:e.jsx(je,{className:"w-4 h-4 text-primary"})}),e.jsx("div",{className:"flex-1 bg-muted/50 rounded-2xl rounded-tl-sm px-4 py-3 text-sm",children:ve()})]}),y.map(t=>e.jsxs("div",{className:E("flex gap-3",t.role==="user"&&"flex-row-reverse"),children:[e.jsx("div",{className:E("w-8 h-8 rounded-full flex items-center justify-center shrink-0",t.role==="user"?"bg-primary text-primary-foreground":"bg-primary/10"),children:t.role==="user"?e.jsx(xt,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})}),e.jsx("div",{className:E("flex-1 max-w-[85%] rounded-2xl px-4 py-3 text-sm",t.role==="user"?"bg-primary text-primary-foreground rounded-tr-sm":"bg-muted/50 rounded-tl-sm"),children:t.role==="assistant"?e.jsxs(e.Fragment,{children:[t.content?e.jsx("div",{className:"prose-sm",children:q(t.content)}):e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Ee,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:c.language==="zh"?"思考中...":c.language==="pt"?"Pensando...":"Thinking..."})]}),t.isStreaming&&t.content&&e.jsx("span",{className:"inline-block w-1.5 h-4 bg-primary/50 animate-pulse ml-0.5 align-middle"})]}):t.content})]},t.id)),e.jsx("div",{ref:ge})]})}),e.jsx("div",{className:"p-4 bg-background shrink-0",children:e.jsxs("div",{className:"group flex items-center gap-3 bg-secondary/50 backdrop-blur-sm px-5 py-3.5 rounded-full shadow-sm hover:shadow-md hover:bg-secondary/70 transition-all duration-300 border border-border/50",children:[re()&&e.jsx("button",{onClick:de,disabled:k,className:E("shrink-0 transition-all duration-200",R&&"text-destructive animate-pulse"),title:c.language==="zh"?R?"停止录音":"语音输入":c.language==="pt"?R?"Parar gravação":"Entrada de voz":R?"Stop recording":"Voice input",children:R?e.jsx(pt,{className:"h-5 w-5"}):e.jsx(gt,{className:"h-5 w-5 text-muted-foreground group-hover:text-foreground transition-colors"})}),e.jsx(je,{className:"w-5 h-5 text-primary group-hover:text-primary/80 transition-colors shrink-0"}),e.jsx("input",{value:d,onChange:t=>f(t.target.value),onKeyDown:L,placeholder:R?c.language==="zh"?"正在聆听...":c.language==="pt"?"Ouvindo...":"Listening...":ae(),disabled:k,className:"flex-1 bg-transparent border-0 outline-none text-sm text-foreground placeholder:text-muted-foreground group-hover:placeholder:text-foreground/60 transition-colors",autoFocus:!0}),e.jsx("button",{onClick:b,disabled:!d.trim()||k,className:E("shrink-0 transition-all duration-200",d.trim()&&!k?"text-primary hover:text-primary/80":"text-muted-foreground/60"),children:k?e.jsx(Ee,{className:"h-5 w-5 animate-spin"}):e.jsx(ft,{className:"h-5 w-5"})})]})}),e.jsx(at,{open:J,onOpenChange:t=>{O(t),!t&&z&&(ee(z),F(null))},onConfirm:ce})]})})},Xe=({restaurant:s,language:a})=>{const[l,c]=n.useState(999),i=n.useRef(null),p=s.type.slice(0,3).map((u,d)=>({key:`type-${d}`,label:u,variant:"secondary",color:void 0}));n.useEffect(()=>{const u=()=>{if(!i.current)return;const f=i.current,y=Array.from(f.querySelectorAll(".tag-badge"));if(y.length===0){setTimeout(u,50);return}const v=y[0]?.offsetTop;let k=y.length;for(let S=0;S<y.length;S++)if(y[S].offsetTop>v){k=S;break}k<y.length&&(k=Math.max(1,k-1)),c(k)};c(999);const d=setTimeout(u,100);return window.addEventListener("resize",u),()=>{clearTimeout(d),window.removeEventListener("resize",u)}},[p.length,s.id]);const m=p.slice(0,l),w=p.length>l;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{ref:i,className:"flex gap-1.5 flex-wrap flex-1",children:m.map(u=>e.jsx(V,{variant:u.variant,className:"text-xs font-medium whitespace-nowrap tag-badge",style:u.color?{backgroundColor:u.color,color:"white"}:void 0,children:u.label},u.key))}),w&&e.jsxs(as,{children:[e.jsx(rs,{asChild:!0,children:e.jsx(Y,{variant:"ghost",size:"sm",className:"h-6 px-2 text-muted-foreground hover:text-foreground flex-shrink-0",children:e.jsx(vt,{className:"h-4 w-4"})})}),e.jsx(ns,{className:"w-80",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:p.map(u=>e.jsx(V,{variant:u.variant,className:"text-xs font-medium",style:u.color?{backgroundColor:u.color,color:"white"}:void 0,children:u.label},u.key))})})]})]})},bs=()=>{const s=Me(),{t:a,i18n:l}=pe(),{toast:c}=Mt(),{localizeRestaurant:i}=rt(),[p,m]=n.useState(""),[w,u]=n.useState([]),[d,f]=n.useState(null),[y,v]=n.useState([]),[k,S]=n.useState(null),[j,U]=n.useState(null),[J,O]=n.useState(!1),[z,F]=n.useState(!1),[R,M]=n.useState(!1),K=n.useRef(null),P=n.useRef(null),B=n.useRef({}),[Z,x]=n.useState(null),[A,W]=n.useState(!1),[ge,re]=n.useState(!1),[ne,fe]=n.useState(!1),[oe,be]=n.useState(!1),le=4,{data:ee,isLoading:ce}=os(p,w.length>0?w.join(","):void 0),{data:b=[]}=is(),{data:L=[]}=nt(),{data:H={}}=ls(),D=L.filter(t=>(H[t.id]||0)>0),de=t=>{u(r=>r.includes(t)?r.filter(o=>o!==t):[...r,t])},te=()=>{re(!0)},me=async()=>{re(!1);try{const t=await Zt();U({lat:t.coords.latitude,lng:t.coords.longitude}),c({title:a("restaurants.locationEnabled"),description:a("restaurants.sortByDistance")})}catch(t){console.error("Location error:",t)}},T=t=>{S(t),t&&!j&&te()},we=async t=>{if(d===t)f(null),v([]);else{f(t);const{data:r,error:o}=await Et.from("activity_restaurants").select("restaurant_id").eq("activity_id",t);o?(console.error("Error fetching activity restaurants:",o),v([])):v(r.map(g=>g.restaurant_id))}},se=ee?.map(t=>{const r=i(t);if(j){const o=Yt(j.lat,j.lng,t.lat,t.lng);return{...r,distance:o}}return r})||[],ue=d?se.filter(t=>y.includes(t.id)):se,q=k&&j?ue.filter(t=>t.distance&&t.distance<=k).sort((t,r)=>(t.distance||0)-(r.distance||0)):j?ue.sort((t,r)=>(t.distance||0)-(r.distance||0)):ue.sort((t,r)=>(r.rating||0)-(t.rating||0)),he=t=>{s(`/restaurant/${t.id}`)},ae=t=>{x(t.id);const r=B.current[t.id];r&&r.scrollIntoView({behavior:"smooth",block:"center"})},ve=()=>{const t=document.getElementById("home-map-container");if(t)if(J)document.exitFullscreen&&document.exitFullscreen();else{if(K.current){const r=K.current.getCenter(),o=K.current.getZoom();P.current={center:[r.lng,r.lat],zoom:o}}t.requestFullscreen&&t.requestFullscreen()}};return n.useEffect(()=>{const t=()=>{const r=!!document.fullscreenElement;O(r),!r&&P.current&&K.current&&setTimeout(()=>{K.current?.jumpTo({center:P.current.center,zoom:P.current.zoom})},100)};return document.addEventListener("fullscreenchange",t),()=>{document.removeEventListener("fullscreenchange",t)}},[]),e.jsxs("div",{className:"animate-fade-in",children:[e.jsxs("div",{className:"text-left mb-8 sm:mb-10",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-primary mb-2 sm:mb-3",children:a("nav.mapView")}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:a("map.subtitle")})]}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[e.jsx("div",{className:"flex-1 max-w-md",children:e.jsx($t,{placeholder:a("restaurants.search"),value:p,onChange:t=>m(t.target.value),className:"h-11 bg-background/60 backdrop-blur-sm border-primary/20 focus:border-primary"})}),e.jsxs("div",{className:"flex gap-2 md:contents",children:[e.jsxs(Y,{variant:j?"default":"outline",onClick:j?void 0:te,className:"flex-1 md:flex-initial gap-2 h-11 md:px-6",children:[e.jsx(ke,{className:`w-4 h-4 ${j?"animate-pulse":""}`}),e.jsx("span",{className:"md:hidden",children:a("restaurants.getLocationMobile")}),e.jsx("span",{className:"hidden md:inline",children:a(j?"restaurants.locationEnabled":"restaurants.getLocation")})]}),e.jsxs(Y,{variant:A?"default":"outline",onClick:()=>W(!A),className:"flex-1 md:flex-initial gap-2 h-11 md:px-6",children:[e.jsx(bt,{className:"w-4 h-4"}),a("restaurants.filter")]})]})]}),A&&e.jsxs("div",{className:"space-y-3 bg-card/50 backdrop-blur-sm rounded-lg p-4 border border-border/50 animate-fade-in",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("span",{className:"text-sm font-semibold text-foreground",children:[a("restaurants.restaurantTypes"),":"]}),w.length>0&&e.jsx(V,{variant:"outline",className:"cursor-pointer hover:bg-destructive hover:text-destructive-foreground hover:scale-105 transition-all duration-200 px-2 py-0 text-xs h-5",onClick:()=>u([]),children:a("common.actions.clearFilter")}),b.length>8&&e.jsx(Y,{variant:"ghost",size:"sm",className:"h-5 px-2 text-xs text-primary hover:text-primary/80 ml-auto hidden sm:flex transition-all duration-200",onClick:()=>F(!z),children:a(z?"common.showLess":"common.showMore")})]}),e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx("div",{className:`hidden sm:flex gap-2 flex-wrap transition-all duration-300 ease-out ${z?"animate-expand-height":""}`,children:(z?b:b.slice(0,8)).map((t,r)=>e.jsx(V,{variant:w.includes(t)?"default":"secondary",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs whitespace-nowrap hover:scale-105 active:animate-tag-select ${w.includes(t)?"ring-2 ring-primary/30 shadow-sm":""}`,style:{animationDelay:`${r*30}ms`},onClick:()=>de(t),children:t},t))}),e.jsxs("div",{className:"sm:hidden relative -mx-1 px-1",children:[e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide snap-x snap-mandatory scroll-smooth",children:b.map((t,r)=>e.jsx(V,{variant:w.includes(t)?"default":"secondary",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs whitespace-nowrap flex-shrink-0 snap-start hover:scale-105 active:animate-tag-select ${w.includes(t)?"ring-2 ring-primary/30 shadow-sm":""}`,style:{animationDelay:`${r*30}ms`},onClick:()=>de(t),children:t},t))}),e.jsx("div",{className:"absolute left-0 top-0 bottom-2 w-4 bg-gradient-to-r from-card via-card/60 to-transparent pointer-events-none"}),e.jsx("div",{className:"absolute right-0 top-0 bottom-2 w-4 bg-gradient-to-l from-card via-card/60 to-transparent pointer-events-none"})]})]})]}),D.length>0&&e.jsxs("div",{className:"space-y-2 pt-1 border-t border-border/30",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("span",{className:"text-sm font-semibold text-foreground",children:[a("nav.activities"),":"]}),d&&e.jsx(V,{variant:"outline",className:"cursor-pointer hover:bg-destructive hover:text-destructive-foreground hover:scale-105 transition-all duration-200 px-2 py-0 text-xs h-5",onClick:()=>{f(null),v([])},children:a("common.actions.clearFilter")}),D.length>8&&e.jsx(Y,{variant:"ghost",size:"sm",className:"h-5 px-2 text-xs text-primary hover:text-primary/80 ml-auto hidden sm:flex transition-all duration-200",onClick:()=>M(!R),children:a(R?"common.showLess":"common.showMore")})]}),e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx("div",{className:`hidden sm:flex gap-2 flex-wrap transition-all duration-300 ease-out ${R?"animate-expand-height":""}`,children:(R?D:D.slice(0,8)).map((t,r)=>{const o=l.language==="zh"?t.badge_text_zh||t.title_zh:l.language==="pt"?t.badge_text_pt||t.title_pt:t.badge_text_en||t.title_en;return e.jsx(V,{variant:d===t.id?"default":"secondary",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs whitespace-nowrap hover:scale-105 active:animate-tag-select ${d===t.id?"ring-2 ring-primary/30 shadow-sm":""}`,style:{animationDelay:`${r*30}ms`},onClick:()=>we(t.id),children:o},t.id)})}),e.jsxs("div",{className:"sm:hidden relative -mx-1 px-1",children:[e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide snap-x snap-mandatory scroll-smooth",children:D.map((t,r)=>{const o=l.language==="zh"?t.badge_text_zh||t.title_zh:l.language==="pt"?t.badge_text_pt||t.title_pt:t.badge_text_en||t.title_en;return e.jsx(V,{variant:d===t.id?"default":"secondary",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs whitespace-nowrap flex-shrink-0 snap-start hover:scale-105 active:animate-tag-select ${d===t.id?"ring-2 ring-primary/30 shadow-sm":""}`,style:{animationDelay:`${r*30}ms`},onClick:()=>we(t.id),children:o},t.id)})}),e.jsx("div",{className:"absolute left-0 top-0 bottom-2 w-4 bg-gradient-to-r from-card via-card/60 to-transparent pointer-events-none"}),e.jsx("div",{className:"absolute right-0 top-0 bottom-2 w-4 bg-gradient-to-l from-card via-card/60 to-transparent pointer-events-none"})]})]})]})]}),j&&e.jsxs("div",{className:"flex gap-2 flex-wrap items-center bg-muted/30 backdrop-blur-sm rounded-lg p-3 border border-primary/10",children:[e.jsxs("span",{className:"text-sm font-semibold text-primary",children:[a("restaurants.radius"),":"]}),e.jsx(V,{variant:k===null?"default":"secondary",className:"cursor-pointer hover:scale-105 transition-transform",onClick:()=>T(null),children:a("restaurants.allRestaurants")}),e.jsx(V,{variant:k===5?"default":"secondary",className:"cursor-pointer hover:scale-105 transition-transform",onClick:()=>T(5),children:a("restaurants.radius5km")}),e.jsx(V,{variant:k===10?"default":"secondary",className:"cursor-pointer hover:scale-105 transition-transform",onClick:()=>T(10),children:a("restaurants.radius10km")}),e.jsx(V,{variant:k===20?"default":"secondary",className:"cursor-pointer hover:scale-105 transition-transform",onClick:()=>T(20),children:a("restaurants.radius20km")})]})]}),!ce&&q&&e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[e.jsx("div",{className:`w-full lg:flex-1 transition-all duration-300 ease-in-out ${ne?"h-0 overflow-hidden lg:h-[500px]":"h-[400px] lg:h-[500px]"}`,children:e.jsxs("div",{id:"home-map-container",className:`${J?"fixed inset-0 z-50 bg-background":"w-full h-full"} rounded-xl overflow-hidden shadow-2xl border border-primary/10 relative group`,children:[e.jsx(Y,{variant:"secondary",size:"icon",className:"absolute bottom-4 right-4 z-10 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity",onClick:ve,children:J?e.jsx(wt,{className:"w-5 h-5"}):e.jsx(yt,{className:"w-5 h-5"})}),e.jsxs("div",{className:"h-full relative",children:[e.jsx(cs,{restaurants:q,onRestaurantClick:he,userLocation:j,radiusFilter:k,onMarkerClick:ae,showViewDetailsButton:!0,onMapInit:t=>{K.current=t}}),e.jsxs("div",{className:"absolute bottom-4 left-4 z-10 pointer-events-none flex items-center gap-2 bg-background/80 backdrop-blur-sm px-3 py-2 rounded-full shadow-lg",children:[e.jsx("img",{src:ds,alt:"Xiaoxiong Market Logo",className:"h-6 w-6 object-contain"}),e.jsx("span",{className:"text-sm font-semibold text-foreground whitespace-nowrap",children:l.language==="zh"?"小熊市场":"Xiaoxiong Market"})]})]})]})}),e.jsx(Y,{variant:"outline",size:"sm",className:"lg:hidden flex items-center justify-center gap-2 -mt-3 mb-1",onClick:()=>fe(!ne),children:ne?e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"w-4 h-4"}),a("map.showMap")]}):e.jsxs(e.Fragment,{children:[e.jsx(Be,{className:"w-4 h-4"}),a("map.hideMap")]})}),e.jsxs("div",{className:"w-full lg:w-[420px] flex flex-col",children:[e.jsxs("div",{className:"mb-4 pb-4 border-b border-border",children:[e.jsxs("h2",{className:"text-2xl font-bold text-foreground flex items-center gap-2",children:[e.jsx(_e,{className:"w-6 h-6 text-primary"}),a("restaurants.title"),e.jsx(V,{variant:"secondary",className:"ml-2",children:q.length})]}),j&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-2 flex items-center gap-1.5",children:[e.jsx(ke,{className:"w-4 h-4"}),a("restaurants.sortedByDistance")]})]}),q.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(_e,{className:"w-16 h-16 text-muted-foreground/40 mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-foreground mb-2",children:a("restaurants.noResults")}),e.jsx("p",{className:"text-muted-foreground max-w-xs",children:a("restaurants.noResultsDesc")})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"lg:hidden space-y-3 pb-4",children:[(oe?q:q.slice(0,le)).map(t=>e.jsx(Ae,{ref:r=>B.current[t.id]=r,className:`p-5 cursor-pointer hover:shadow-xl transition-all duration-300 hover:scale-[1.02] hover:border-primary/40 border-2 bg-gradient-to-br from-card to-card/50 backdrop-blur-sm ${Z===t.id?"border-primary ring-2 ring-primary ring-offset-2":"border-transparent"}`,onClick:()=>he(t),children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h3",{className:"font-bold text-lg text-foreground line-clamp-1 flex-1",children:t.name}),t.distance!==void 0&&e.jsxs("div",{className:"flex items-center gap-1.5 bg-primary/10 px-2.5 py-1 rounded-full w-fit",children:[e.jsx(ke,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"font-bold text-sm text-primary",children:t.distance<1?`${(t.distance*1e3).toFixed(0)} m`:`${t.distance.toFixed(1)} km`})]})]}),t.rating>0&&e.jsxs("div",{className:"flex items-center gap-1.5 bg-primary/10 px-2.5 py-1 rounded-full flex-shrink-0",children:[e.jsx(Fe,{className:"w-4 h-4",style:{fill:"#016450",color:"#016450"}}),e.jsx("span",{className:"font-bold text-sm text-primary",children:t.rating})]})]}),t.type&&t.type.length>0&&e.jsx(Xe,{restaurant:t,language:l.language}),e.jsxs("div",{className:"flex items-start gap-2 text-sm text-muted-foreground",children:[e.jsx(_e,{className:"w-4 h-4 mt-0.5 flex-shrink-0 text-primary/60"}),e.jsx("span",{className:"line-clamp-2",children:t.address})]})]})},t.id)),q.length>le&&e.jsx(Y,{variant:"outline",className:"w-full mt-2 gap-2",onClick:()=>be(!oe),children:oe?e.jsxs(e.Fragment,{children:[e.jsx(Be,{className:"w-4 h-4"}),a("map.collapseList")]}):e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"w-4 h-4"}),a("map.showAllRestaurants",{count:q.length})]})})]}),e.jsx(Ze,{className:"hidden lg:block h-[420px] pr-4",children:e.jsx("div",{className:"space-y-3 pb-4",children:q.map(t=>e.jsx(Ae,{ref:r=>B.current[t.id]=r,className:`p-5 cursor-pointer hover:shadow-xl transition-all duration-300 hover:scale-[1.02] hover:border-primary/40 border-2 bg-gradient-to-br from-card to-card/50 backdrop-blur-sm ${Z===t.id?"border-primary ring-2 ring-primary ring-offset-2":"border-transparent"}`,onClick:()=>he(t),children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h3",{className:"font-bold text-lg text-foreground line-clamp-1 flex-1",children:t.name}),t.distance!==void 0&&e.jsxs("div",{className:"flex items-center gap-1.5 bg-primary/10 px-2.5 py-1 rounded-full w-fit",children:[e.jsx(ke,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"font-bold text-sm text-primary",children:t.distance<1?`${(t.distance*1e3).toFixed(0)} m`:`${t.distance.toFixed(1)} km`})]})]}),t.rating>0&&e.jsxs("div",{className:"flex items-center gap-1.5 bg-primary/10 px-2.5 py-1 rounded-full flex-shrink-0",children:[e.jsx(Fe,{className:"w-4 h-4",style:{fill:"#016450",color:"#016450"}}),e.jsx("span",{className:"font-bold text-sm text-primary",children:t.rating})]})]}),t.type&&t.type.length>0&&e.jsx(Xe,{restaurant:t,language:l.language}),e.jsxs("div",{className:"flex items-start gap-2 text-sm text-muted-foreground",children:[e.jsx(_e,{className:"w-4 h-4 mt-0.5 flex-shrink-0 text-primary/60"}),e.jsx("span",{className:"line-clamp-2",children:t.address})]})]})},t.id))})})]})]})]}),e.jsx(at,{open:ge,onOpenChange:re,onConfirm:me})]})},ws=({open:s,onOpenChange:a,onConfirm:l,siteName:c,url:i})=>{const{t:p}=pe();let m=c||"";if(i)try{m=new URL(i).hostname}catch{m=i}return e.jsx(Ot,{open:s,onOpenChange:a,children:e.jsxs(Vt,{className:"max-w-[320px] w-[calc(100%-2rem)] mx-auto border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-2xl shadow-2xl rounded-[28px] overflow-hidden p-6",children:[e.jsx("div",{className:"absolute inset-0 rounded-[28px] bg-gradient-to-b from-white/40 via-transparent to-transparent pointer-events-none"}),e.jsxs(Bt,{className:"relative text-center space-y-3",children:[e.jsx("div",{className:"mx-auto w-14 h-14 rounded-2xl bg-gradient-to-br from-primary/20 to-primary/10 dark:from-primary/30 dark:to-primary/20 flex items-center justify-center shadow-sm shrink-0",style:{transform:"translateZ(0)",willChange:"transform"},children:e.jsx(Ue,{className:"w-7 h-7 text-primary shrink-0",strokeWidth:1.5})}),e.jsxs("div",{className:"space-y-1.5 px-1",children:[e.jsx(Ft,{className:"text-base font-semibold tracking-tight text-foreground",children:p("externalLink.confirmTitle")}),e.jsx(Pt,{className:"text-sm text-muted-foreground/80 leading-relaxed break-words",children:p("externalLink.confirmDescription",{site:m})})]})]}),e.jsxs(Wt,{className:"relative flex-col sm:flex-col gap-2 pt-4 mt-1 sm:space-x-0",children:[e.jsx(Ht,{onClick:l,className:"w-full rounded-xl h-11 bg-primary hover:bg-primary/90 text-primary-foreground font-medium shadow-lg shadow-primary/20 transition-all duration-200",children:p("externalLink.continue")}),e.jsx(qt,{className:"w-full rounded-xl h-11 bg-black/5 dark:bg-white/10 hover:bg-black/10 dark:hover:bg-white/15 border-0 text-muted-foreground font-medium transition-all duration-200 mt-0",children:p("common.cancel")})]})]})})},ot=n.memo(({stats:s,onAskXiaoxiong:a})=>{const{t:l,i18n:c}=pe(),{data:i}=st(),{buttons:p}=Xt(),m=c.language,[w,u]=n.useState(!1),d=p?.find(O=>O.label_zh==="演示"||O.link?.includes("v.xiaoxiong.pt")),f=d&&d.enabled!==!1&&d.visible!==!1&&d.show_on_mobile!==!1,y=()=>d?m==="zh"?d.label_zh:m==="pt"?d.label_pt:d.label_en:l("home.hero.demo","前往演示"),v=O=>!i||i.length===0?"":i[0][`${O}${m==="zh"?"_zh":m==="pt"?"_pt":"_en"}`]||"",k=v("title")||l("home.hero.title"),S=v("description")||l("home.hero.description"),j=v("subtitle_button_text")||l("home.hero.subtitle"),U=()=>{u(!0)},J=()=>{d?.link&&Ut(d.link),u(!1)};return e.jsxs("section",{className:"min-h-[55vh] flex flex-col bg-secondary/20",children:[e.jsxs("div",{className:"pt-20 px-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl font-bold text-foreground",children:l("home.hero.brandName")}),e.jsx("img",{src:tt,alt:"map icon",width:28,height:28,loading:"eager",decoding:"async",className:"w-7 h-7 object-contain flex-shrink-0"})]}),f&&d&&e.jsxs(Y,{variant:"outline",size:"sm",className:"gap-1.5 text-xs",onClick:U,children:[e.jsx(Ue,{className:"w-3.5 h-3.5"}),y()]})]}),s&&e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Ce,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:l("home.stats.delivery")}),e.jsx("span",{className:"font-bold text-foreground text-sm",children:s.order_count})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Je,{className:"w-4 h-4 text-accent"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:l("home.stats.reservation")}),e.jsx("span",{className:"font-bold text-foreground text-sm",children:s.reserve_count})]})]})]}),e.jsx("div",{className:"flex-1 flex flex-col items-center justify-center px-4 py-8",children:e.jsxs("div",{className:"max-w-md mx-auto text-center space-y-4",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground leading-tight",children:k}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground max-w-sm mx-auto",children:S}),e.jsx("div",{className:"pt-4",children:e.jsxs("button",{onClick:a,className:"group flex items-center gap-3 bg-secondary/50 backdrop-blur-sm text-foreground px-5 py-3.5 rounded-full shadow-sm hover:shadow-md hover:bg-secondary/70 transition-all duration-300 cursor-text border border-border/50 mx-auto",children:[e.jsx(je,{className:"w-5 h-5 text-primary group-hover:text-primary/80 transition-colors"}),e.jsx("span",{className:"text-sm text-muted-foreground group-hover:text-foreground transition-colors",children:j}),e.jsx(Ke,{className:"w-4 h-4 text-muted-foreground/60 ml-2"})]})})]})}),e.jsx(ws,{open:w,onOpenChange:u,onConfirm:J,url:d?.link})]})});ot.displayName="MobileHeroSection";const ys=s=>!s||!Array.isArray(s)?!1:s.every(a=>typeof a=="object"&&a!==null&&"start"in a&&"end"in a&&typeof a.start=="number"&&typeof a.end=="number"),vs=(s,a)=>{const l=Te(new Date(s.start_date)),c=s.end_date?Te(new Date(s.end_date)):null,i=Te(a);if(i<l||c&&i>c)return!1;switch(s.repeat_mode||"none"){case"none":return hs(l,i);case"daily":return!0;case"weekly":const m=us(i);return s.repeat_weekday===m;case"monthly":const u=He(i),d=s.repeat_month_day;return ys(d)?d.some(S=>u>=S.start&&u<=S.end):!1;case"yearly":const f=ms(i)+1,y=He(i),v=s.repeat_yearly_month,k=s.repeat_yearly_day;return v===f&&k===y;default:return!1}},Se=s=>{switch(s.repeat_mode||"none"){case"none":return 0;case"weekly":return 1;case"monthly":return 2;case"yearly":return 3;case"daily":return 4;default:return 5}},js=()=>{const{data:s,isLoading:a}=nt(),l=n.useMemo(()=>{if(!s)return{today:[],tomorrow:[],dayAfterTomorrow:[]};const i=new Date,p=We(i,1),m=We(i,2),w=u=>s.filter(d=>d.visible&&d.status==="published").filter(d=>vs(d,u)).sort((d,f)=>{const y=Se(d)-Se(f);return y!==0?y:d.pinned!==f.pinned?d.pinned?-1:1:(d.sort_order||0)-(f.sort_order||0)});return{today:w(i),tomorrow:w(p),dayAfterTomorrow:w(m)}},[s]),c=n.useMemo(()=>{const i=new Set,p=[];return l.today.forEach(m=>{i.has(m.id)||(i.add(m.id),p.push({...m,dayLabel:"today"}))}),l.tomorrow.forEach(m=>{i.has(m.id)||(i.add(m.id),p.push({...m,dayLabel:"tomorrow"}))}),l.dayAfterTomorrow.forEach(m=>{i.has(m.id)||(i.add(m.id),p.push({...m,dayLabel:"dayAfterTomorrow"}))}),p.sort((m,w)=>{const u=Se(m)-Se(w);return u!==0?u:m.pinned!==w.pinned?m.pinned?-1:1:(m.sort_order||0)-(w.sort_order||0)})},[l]);return{recentActivities:l,allRecentActivities:c,isLoading:a,hasActivities:c.length>0}},it=()=>{const[s,a]=n.useState(4);return n.useEffect(()=>{const l=()=>{const c=window.innerWidth;c<640?a(2):c<1024?a(3):a(4)};return l(),window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[]),s},lt=n.memo(({activity:s,dayLabel:a})=>{const l=Me(),{t:c}=pe(),{getLocalizedField:i}=rt(),p=i(s,"title"),m=n.useMemo(()=>{switch(s.service_type){case"dine_in":return c("activities.serviceType.dine_in");case"takeaway":return c("activities.serviceType.takeaway");case"both":return c("activities.serviceType.both");default:return""}},[s.service_type,c]),w=()=>{l(`/activity/${s.id}`)};return e.jsxs(Ae,{className:"group cursor-pointer overflow-hidden hover:shadow-lg transition-all duration-300 border-border/50 bg-card",onClick:w,children:[e.jsxs("div",{className:"relative aspect-[16/10] overflow-hidden bg-muted",children:[s.image_url?e.jsx("img",{src:s.image_url,alt:p,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",loading:"lazy"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-primary/20 to-primary/5",children:e.jsx(jt,{className:"w-12 h-12 text-primary/40"})}),e.jsx(V,{className:E("absolute top-2 left-2 text-xs font-medium",a===c("home.recentActivities.today")?"bg-primary text-primary-foreground":"bg-secondary text-secondary-foreground"),children:a}),s.pinned&&e.jsx(V,{className:"absolute top-2 right-2 text-xs bg-accent text-accent-foreground",children:c("activities.pinned")})]}),e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx("h3",{className:"font-medium text-sm leading-tight line-clamp-2 text-foreground group-hover:text-primary transition-colors",children:p}),e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[s.service_type==="dine_in"&&e.jsx(Pe,{className:"w-3 h-3 flex-shrink-0"}),s.service_type==="takeaway"&&e.jsx(Ce,{className:"w-3 h-3 flex-shrink-0"}),s.service_type==="both"&&e.jsxs(e.Fragment,{children:[e.jsx(Pe,{className:"w-3 h-3 flex-shrink-0"}),e.jsx(Ce,{className:"w-3 h-3 flex-shrink-0"})]}),e.jsx("span",{className:"truncate",children:m})]})]})]})});lt.displayName="ActivityCard";const ct=n.memo(()=>{const s=it();return e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4",children:Array.from({length:s}).map((a,l)=>e.jsxs(Ae,{className:"overflow-hidden",children:[e.jsx(Le,{className:"aspect-[16/10] w-full"}),e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx(Le,{className:"h-4 w-full"}),e.jsx(Le,{className:"h-3 w-2/3"})]})]},l))})});ct.displayName="LoadingSkeleton";const dt=n.memo(()=>{const{t:s}=pe(),{allRecentActivities:a,isLoading:l,hasActivities:c}=js(),i=it(),[p,m]=n.useState(!1),w=f=>{switch(f){case"today":return s("home.recentActivities.today");case"tomorrow":return s("home.recentActivities.tomorrow");case"dayAfterTomorrow":return s("home.recentActivities.dayAfterTomorrow");default:return""}},u=n.useMemo(()=>p?a:a.slice(0,i),[a,i,p]),d=a.length>i;return!l&&!c?null:e.jsx("section",{className:"py-8 sm:py-12 px-4 bg-background",children:e.jsxs("div",{className:"container mx-auto max-w-7xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-foreground",children:s("home.recentActivities.title")}),d&&!p&&e.jsx(Y,{variant:"ghost",size:"sm",className:"text-primary hover:text-primary/80",onClick:()=>m(!0),children:e.jsxs("span",{className:"flex items-center gap-1",children:[s("home.recentActivities.viewAll"),e.jsx(Nt,{className:"w-4 h-4"})]})}),p&&e.jsx(Y,{variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-foreground",onClick:()=>m(!1),children:e.jsx("span",{className:"flex items-center gap-1",children:s("home.recentActivities.collapse")})})]}),l?e.jsx(ct,{}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4",children:u.map(f=>e.jsx(lt,{activity:f,dayLabel:w(f.dayLabel)},f.id))})]})})});dt.displayName="RecentActivitiesSection";const ze="/images/sushi-ramen-hero.jpg",mt="/images/sushi-ramen-mobile.jpg",ut=n.memo(({stats:s,t:a})=>e.jsx("div",{className:"absolute top-16 sm:top-20 left-3 z-20",children:e.jsxs("div",{className:"gap-4 w-fit flex-col flex items-start justify-start",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm text-white/90 drop-shadow-md",children:a("home.stats.delivery")}),e.jsx("span",{className:"font-bold text-white text-sm drop-shadow-md",children:s.order_count})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Je,{className:"w-4 h-4 text-accent"}),e.jsx("span",{className:"text-sm text-white/90 drop-shadow-md",children:a("home.stats.reservation")}),e.jsx("span",{className:"font-bold text-white text-sm drop-shadow-md",children:s.reserve_count})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl sm:text-2xl font-bold text-white drop-shadow-md",children:a("home.hero.brandName")}),e.jsx("img",{src:tt,alt:"map icon",width:32,height:32,loading:"eager",decoding:"async",className:"w-7 sm:w-8 h-7 sm:h-8 object-contain flex-shrink-0"})]})]})}));ut.displayName="StatsDisplay";const Ns=()=>{const s=window.innerWidth<640,a=window.innerWidth>=1024,l=navigator.connection,c=et(),i=Ge();return a?!!l?.saveData:!!(i&&!c||l&&(l.saveData||l.effectiveType==="2g"||l.effectiveType==="slow-2g")||s&&navigator.deviceMemory&&navigator.deviceMemory<2)},ht=n.memo(({template:s,isActive:a,currentLang:l,t:c,onContentReady:i,onAskXiaoxiong:p})=>{const[m,w]=n.useState({}),[u,d]=n.useState({}),[f,y]=n.useState({}),[v,k]=n.useState({mobile:!0,tablet:!0,desktop:!0}),[S,j]=n.useState(!1),U=Ns(),J=n.useRef(null),O=n.useRef(null),z=n.useRef(null),F=b=>s[`${b}${l==="zh"?"_zh":l==="pt"?"_pt":"_en"}`]||"",R=()=>window.innerWidth<640?"mobile":window.innerWidth<1024?"tablet":"desktop",M=()=>{const b=R();return b==="mobile"&&s.mobile_overlay_opacity!==null?s.mobile_overlay_opacity:b==="tablet"&&s.tablet_overlay_opacity!==null?s.tablet_overlay_opacity:b==="desktop"&&s.desktop_overlay_opacity!==null?s.desktop_overlay_opacity:s.overlay_opacity??30},K=()=>{const b=M(),L=s.overlay_gradient_direction||"to-b",H=(ae,ve)=>ae==null?ve/100:ae>1?ae/100:ae,D=b>1?b/100:b,de=H(s.overlay_gradient_from_opacity,30)*D,te=H(s.overlay_gradient_via_opacity,25)*D,me=H(s.overlay_gradient_to_opacity,40)*D,we={"to-t":"to top","to-b":"to bottom","to-l":"to left","to-r":"to right","to-tl":"to top left","to-tr":"to top right","to-bl":"to bottom left","to-br":"to bottom right"}[L]||"to bottom",se={black:"0, 0, 0",white:"255, 255, 255",background:"0, 0, 0",foreground:"255, 255, 255",primary:"1, 100, 80",secondary:"240, 240, 240"},ue=se[s.overlay_gradient_from||"black"]||"0, 0, 0",q=se[s.overlay_gradient_via||"black"]||"0, 0, 0",he=se[s.overlay_gradient_to||"black"]||"0, 0, 0";return{background:`linear-gradient(${we}, rgba(${ue}, ${de}), rgba(${q}, ${te}), rgba(${he}, ${me}))`}},P=s.mobile_image_url||mt,B=s.tablet_image_url||s.desktop_image_url||ze,Z=s.desktop_image_url||ze,x=s.background_blur||0,A=s.desktop_media_type||s.media_type||"image",W=s.tablet_media_type||s.media_type||"image",ge=s.mobile_media_type||s.media_type||"image",re=A==="video"&&!U,ne=W==="video"&&!U,fe=ge==="video"&&!U,oe=fe?s.mobile_video_url:null,be=ne?s.tablet_video_url||s.desktop_video_url:null,le=re?s.desktop_video_url:null;n.useEffect(()=>{const b=R(),L=b==="mobile"?P:b==="tablet"?B:Z;if(L){const H=new Image;H.onload=()=>{w(D=>({...D,[b]:!0})),k(D=>({...D,[b]:!0})),a&&(i?.(),setTimeout(()=>j(!0),100))},H.src=L}},[P,B,Z,a,i]),n.useEffect(()=>{a&&m[R()]&&j(!0)},[a,m]);const ee=b=>{d(L=>({...L,[b]:!0}))},ce=(b,L)=>{console.error(`[HeroSlide] Video error on ${b}:`,L),y(H=>({...H,[b]:!0}))};return n.useEffect(()=>{if(!S||!a||!Qt())return;const L=R(),D=(L==="mobile"?J:L==="tablet"?O:z).current;if(!D)return;const te=setTimeout(async()=>{try{D.muted=!0,D.playsInline=!0,D.setAttribute("webkit-playsinline","true"),await D.play(),console.log(`[HeroSlide] iOS video play successful on ${L}`)}catch(me){console.error(`[HeroSlide] iOS video play failed on ${L}:`,me),y(T=>({...T,[L]:!0}))}},150);return()=>clearTimeout(te)},[S,a]),e.jsxs("div",{className:E("absolute inset-0 w-full h-full transition-opacity duration-1000",a?"opacity-100 z-10":"opacity-0 z-0"),children:[e.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[e.jsxs("div",{className:"absolute inset-0 w-full h-full sm:hidden",children:[!v.mobile&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),fe&&oe?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:P,alt:"Background",className:E("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",u.mobile&&!f.mobile?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:x>0?`blur(${x}px)`:void 0}}),S&&!f.mobile&&e.jsx("video",{ref:J,src:oe,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>ee("mobile"),onError:b=>ce("mobile",b),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:x>0?`blur(${x}px)`:void 0}})]}):e.jsx("img",{src:P,alt:"Background",className:E("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",v.mobile?"opacity-100":"opacity-0"),style:{filter:x>0?`blur(${x}px)`:void 0}})]}),e.jsxs("div",{className:"absolute inset-0 w-full h-full hidden sm:block lg:hidden",children:[!v.tablet&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),ne&&be?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:B,alt:"Background",className:E("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",u.tablet&&!f.tablet?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:x>0?`blur(${x}px)`:void 0}}),S&&!f.tablet&&e.jsx("video",{ref:O,src:be,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>ee("tablet"),onError:b=>ce("tablet",b),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:x>0?`blur(${x}px)`:void 0}})]}):e.jsx("img",{src:B,alt:"Background",className:E("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",v.tablet?"opacity-100":"opacity-0"),style:{filter:x>0?`blur(${x}px)`:void 0}})]}),e.jsxs("div",{className:"absolute inset-0 w-full h-full hidden lg:block",children:[!v.desktop&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),re&&le?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:Z,alt:"Background",className:E("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",u.desktop&&!f.desktop?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:x>0?`blur(${x}px)`:void 0}}),S&&!f.desktop&&e.jsx("video",{ref:z,src:le,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>ee("desktop"),onError:b=>ce("desktop",b),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:x>0?`blur(${x}px)`:void 0}})]}):e.jsx("img",{src:Z,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:E("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",v.desktop?"opacity-100":"opacity-0"),style:{filter:x>0?`blur(${x}px)`:void 0}})]}),e.jsx("div",{className:"absolute inset-0 w-full h-full",style:K()})]}),e.jsx("div",{className:"relative z-10 container mx-auto px-4 sm:px-6 flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center space-y-4 sm:space-y-8 animate-fade-in w-full",children:[e.jsx("h1",{className:"text-3xl sm:text-5xl md:text-7xl font-bold text-white leading-tight px-4 drop-shadow-[0_2px_8px_rgba(0,0,0,0.8)]",children:F("title")||c("home.hero.title")}),e.jsx("p",{className:"text-sm sm:text-xl md:text-2xl text-white/95 max-w-2xl mx-auto px-4 drop-shadow-[0_2px_6px_rgba(0,0,0,0.7)]",children:F("description")||c("home.hero.description")}),s.subtitle_button_text_zh&&e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:p,className:"group flex items-center gap-3 bg-white/20 backdrop-blur-xl text-white px-5 sm:px-7 py-3.5 sm:py-4 rounded-full shadow-[0_8px_32px_rgba(0,0,0,0.12)] hover:shadow-[0_16px_48px_rgba(0,0,0,0.2)] hover:bg-white/30 transition-all duration-300 cursor-text border border-white/40",children:[e.jsx(je,{className:"w-5 h-5 text-white/90 group-hover:text-white transition-colors drop-shadow-sm"}),e.jsx("span",{className:"text-sm sm:text-base text-primary group-hover:text-primary/80 transition-colors drop-shadow-sm font-medium",children:F("subtitle_button_text")||c("home.hero.subtitle")}),e.jsx(Ke,{className:"w-4 h-4 text-white/60 ml-2 drop-shadow-sm"})]})})]})})]})});ht.displayName="HeroSlide";const Ps=()=>{const{t:s,i18n:a}=pe(),l=kt(),{settings:c}=Qe(),{data:i,isLoading:p,refetch:m}=st(),[w,u]=n.useState(0),[d,f]=n.useState(null),y=n.useRef(null),[v,k]=n.useState(!1),[S,j]=n.useState(!1),U=Ye(),{isWebView:J}=Jt(),O=U||J,z=c?.ai_assistant_enabled!==!1,F=c?.ai_provider||"ask-xiaoxiong",R=n.useCallback(()=>{k(!0)},[]);ts({pageType:"home"});const M=n.useCallback(async()=>{try{const A=await(await fetch("https://v.xiaoxiong.pt/api/get_info")).json();A&&f({order_count:A.order_count||0,reserve_count:A.reserve_count||0})}catch(x){console.error("Failed to fetch stats:",x)}},[]);n.useEffect(()=>{M()},[M]);const K=n.useCallback(async()=>{await Promise.all([m(),M(),l.invalidateQueries({queryKey:["restaurants"]}),l.invalidateQueries({queryKey:["activities"]})])},[m,M,l]);n.useEffect(()=>{if(!i||i.length<=1)return;const A=i[w]?.duration||5e3;return y.current=setTimeout(()=>{u(W=>(W+1)%i.length)},A),()=>{y.current&&clearTimeout(y.current)}},[i,w]);const P=n.useCallback(x=>{y.current&&clearTimeout(y.current),u(x)},[]);n.useCallback(()=>{i&&(y.current&&clearTimeout(y.current),u(x=>(x-1+i.length)%i.length))},[i]),n.useCallback(()=>{i&&(y.current&&clearTimeout(y.current),u(x=>(x+1)%i.length))},[i]);const B=a.language,Z=i&&i.length>1;return e.jsx(ss,{onRefresh:K,children:e.jsxs("div",{className:"min-h-screen",children:[O?e.jsx(ot,{stats:d,onAskXiaoxiong:()=>j(!0)}):e.jsxs("section",{className:"relative h-screen flex items-start overflow-hidden bg-background",children:[d&&e.jsx(ut,{stats:d,t:s}),e.jsx("div",{className:E("absolute inset-0 w-full h-full transition-opacity duration-500",v?"opacity-100":"opacity-0"),children:i?.map((x,A)=>e.jsx(ht,{template:x,isActive:A===w,currentLang:B,t:s,onContentReady:A===0?R:void 0,onAskXiaoxiong:()=>j(!0)},x.id))}),e.jsx("div",{className:E("absolute inset-0 w-full h-full z-20 transition-opacity duration-500",p||!v?"opacity-100":"opacity-0 pointer-events-none"),children:e.jsx(Kt,{})}),!p&&(!i||i.length===0)&&e.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[e.jsx("img",{src:mt,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:"absolute inset-0 w-full h-full object-cover object-center sm:hidden"}),e.jsx("img",{src:ze,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:"absolute inset-0 w-full h-full object-cover object-center hidden sm:block"}),e.jsx("div",{className:"absolute inset-0 w-full h-full bg-gradient-to-b from-black/30 via-black/25 to-black/40"}),e.jsx("div",{className:"relative z-10 container mx-auto px-4 sm:px-6 flex items-center min-h-screen",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center space-y-4 sm:space-y-8 animate-fade-in w-full",children:[e.jsx("h1",{className:"text-3xl sm:text-5xl md:text-7xl font-bold text-white leading-tight px-4 drop-shadow-[0_2px_8px_rgba(0,0,0,0.8)]",children:s("home.hero.title")}),e.jsx("p",{className:"text-sm sm:text-xl md:text-2xl text-white/95 max-w-2xl mx-auto px-4 drop-shadow-[0_2px_6px_rgba(0,0,0,0.7)]",children:s("home.hero.description")})]})})]}),Z&&e.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 z-30 flex gap-2",children:i.map((x,A)=>e.jsx("button",{onClick:()=>P(A),className:E("w-3 h-3 rounded-full transition-all duration-300",A===w?"bg-white w-8":"bg-white/50 hover:bg-white/70"),"aria-label":`Go to slide ${A+1}`},A))})]}),e.jsx(dt,{}),e.jsx("section",{className:"py-12 sm:py-20 px-4 bg-secondary/20",children:e.jsx("div",{className:"container mx-auto max-w-7xl",children:e.jsx(bs,{})})}),!Ge()&&!et()&&e.jsxs("section",{className:"py-16 sm:py-24 px-4 bg-gradient-to-br from-primary/5 via-background to-primary/10 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-1/4 w-72 h-72 bg-primary/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 right-1/4 w-96 h-96 bg-primary/5 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute top-1/2 left-0 w-32 h-32 bg-primary/20 rounded-full blur-2xl -translate-y-1/2"}),e.jsx("div",{className:"absolute top-1/2 right-0 w-32 h-32 bg-primary/20 rounded-full blur-2xl -translate-y-1/2"}),e.jsx("div",{className:"container mx-auto max-w-5xl relative z-10",children:e.jsx("div",{className:"flex flex-col items-center justify-center gap-8",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-primary/10 text-primary text-sm font-medium px-4 py-2 rounded-full mb-4",children:[e.jsx(_t,{className:"w-4 h-4"}),e.jsx("span",{children:"Mobile App"})]}),e.jsx("h3",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-foreground mb-4",children:s("home.app.title")}),e.jsx("p",{className:"text-base sm:text-lg text-muted-foreground mb-8 leading-relaxed",children:s("home.app.description")}),e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[e.jsxs("a",{href:"https://apps.apple.com/cn/app/xiaoxiong/id6755481369",target:"_blank",rel:"noopener noreferrer",className:"relative group",children:[e.jsx("div",{className:"absolute -inset-2 bg-gradient-to-r from-primary via-primary-glow to-primary rounded-2xl blur-lg opacity-40 group-hover:opacity-70 transition-opacity"}),e.jsx("div",{className:"relative bg-black hover:bg-gray-900 h-[52px] sm:h-[56px] w-[160px] sm:w-[180px] rounded-xl transition-all hover:scale-105 shadow-2xl hover:shadow-primary/30 border border-white/10 flex items-center justify-center",children:e.jsx("img",{src:Gt,alt:"Download on the App Store",className:"h-8 sm:h-9"})})]}),e.jsxs("a",{href:"https://play.google.com/store/apps/details?id=com.xiaoxiong.market",target:"_blank",rel:"noopener noreferrer",className:"relative group",children:[e.jsx("div",{className:"absolute -inset-2 bg-gradient-to-r from-primary via-primary-glow to-primary rounded-2xl blur-lg opacity-40 group-hover:opacity-70 transition-opacity"}),e.jsx("div",{className:"relative bg-black hover:bg-gray-900 h-[52px] sm:h-[56px] w-[160px] sm:w-[180px] rounded-xl transition-all hover:scale-105 shadow-2xl hover:shadow-primary/30 border border-white/10 flex items-center justify-center",children:e.jsx("img",{src:es,alt:"Get it on Google Play",className:"h-12 sm:h-14"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(St,{className:"w-4 h-4 animate-bounce"}),e.jsx("span",{children:s("home.app.downloadNow")})]})]})]})})})]}),e.jsxs("section",{className:"py-16 sm:py-20 px-4 bg-gradient-to-br from-primary via-primary-glow to-primary-light relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-grid-pattern opacity-10"}),e.jsx("div",{className:"absolute top-0 right-0 w-64 sm:w-96 h-64 sm:h-96 bg-white/5 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-64 sm:w-96 h-64 sm:h-96 bg-white/5 rounded-full blur-3xl"}),e.jsxs("div",{className:"container mx-auto max-w-4xl text-center relative z-10",children:[e.jsx("h2",{className:"text-3xl sm:text-4xl md:text-5xl font-bold text-primary-foreground mb-4 sm:mb-6 px-4",children:s("home.cta.title")}),e.jsx("p",{className:"text-base sm:text-xl text-primary-foreground/90 mb-6 sm:mb-8 max-w-2xl mx-auto px-4",children:s("home.cta.description")}),e.jsx("div",{className:"flex justify-center",children:e.jsx(Y,{size:"lg",variant:"secondary",asChild:!0,className:"text-base sm:text-lg shadow-xl hover:shadow-2xl",children:e.jsxs(Ct,{to:"/join-us",children:[e.jsx(At,{className:"mr-2 w-4 sm:w-5 h-4 sm:h-5"}),s("home.cta.button")]})})})]})]}),z&&e.jsx(fs,{open:S,onOpenChange:j,provider:F})]})})};export{Ps as default};
//# sourceMappingURL=Home-DkIMVJU4.js.map
