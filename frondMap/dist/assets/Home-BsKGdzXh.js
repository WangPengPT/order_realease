import{j as e}from"./vendor-ui-C5i6UHrb.js";import{u as ne,a as je,l as Ne,D as ke,b as _e,c as Se,d as Ce,S as Ie,M as se,e as I,U as Te,L as re,I as Re,B as F,f as ze,R as De,g as Ee,C as Ae,h as Oe,A as $e,i as oe,j as le,k as ce,H as Pe,m as Me,n as de,o as ue,p as Le,q as Be,r as Ve,s as me}from"./index-CJoJW5Rs.js";import{u as We,r,L as q}from"./vendor-react-iAJ0IrSD.js";import{m as Xe}from"./map-icon-DR07RZr_.js";import{u as He}from"./useHomepageTemplates-Csbfgm5u.js";import{u as Fe}from"./usePageView-CcqJ60BB.js";import{u as he}from"./vendor-i18n-DxKeo2S1.js";import{u as qe}from"./vendor-query-BqhVR-X_.js";import"./vendor-charts-Bz7hPIBd.js";import"./vendor-supabase-DEeLm6rS.js";const Ue="/assets/google-play-badge-new-BAXiFmDF.png",Ye="/assets/app-store-badge-C-eOGvqu.svg",ie="https://tzdgqhwyzsxkxnncgzap.supabase.co",G="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR6ZGdxaHd5enN4a3hubmNnemFwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM2NTg2ODgsImV4cCI6MjA3OTIzNDY4OH0.D76C4OkjQVWyMxtjjdOofpD8X_hEEoTtrXHqi4XSYUw",Je=()=>{const t="xiaoxiong_anonymous_user_id";let u=localStorage.getItem(t);return u||(u=`anon_${Date.now()}_${Math.random().toString(36).substring(2,11)}`,localStorage.setItem(t,u)),u},Ke=({open:t,onOpenChange:u,provider:b="ask-xiaoxiong"})=>{const{i18n:l}=he(),c=We(),{settings:g}=ne(),{user:N}=je(),_=g?.logo_url||Ne,[j,E]=r.useState(""),[T,f]=r.useState([]),[k,A]=r.useState(!1),[C,$]=r.useState(null),x=r.useRef(null),z=r.useRef(null),M=r.useRef(null),D=()=>N?.id?N.id:Je();r.useEffect(()=>{t&&!C&&navigator.geolocation?.getCurrentPosition(s=>{$({lat:s.coords.latitude,lng:s.coords.longitude})},s=>{console.log("Unable to get user location:",s.message)},{enableHighAccuracy:!1,timeout:5e3,maximumAge:3e5})},[t,C]),r.useEffect(()=>{M.current?.scrollIntoView({behavior:"smooth"})},[T]);const O=async(s,p)=>{const i=await fetch(`${ie}/functions/v1/ask-xiaoxiong`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${G}`,apikey:G},body:JSON.stringify({text:s.content,stream:!0,lat:C?.lat,lng:C?.lng}),signal:x.current?.signal});if(!i.ok)throw new Error(`Request failed with status: ${i.status}`);if(!i.body)throw new Error("No response body");const d=i.body.getReader(),n=new TextDecoder;let a="";for(;;){const{done:m,value:h}=await d.read();if(m)break;const V=n.decode(h,{stream:!0});a+=V;let R=a;R.startsWith('"')&&(R=R.slice(1)),R.endsWith('"')&&(R=R.slice(0,-1)),R=R.replace(/\\n/g,`
`),f(P=>P.map(W=>W.id===p?{...W,content:R}:W))}let o=a;o.startsWith('"')&&(o=o.slice(1)),o.endsWith('"')&&(o=o.slice(0,-1)),o=o.replace(/\\n/g,`
`),f(m=>m.map(h=>h.id===p?{...h,content:o,isStreaming:!1}:h))},L=async(s,p)=>{const i=D(),d=await fetch(`${ie}/functions/v1/xiaoxiong-agent`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${G}`,apikey:G},body:JSON.stringify({message:s.content,userId:i}),signal:x.current?.signal});if(!d.ok)throw new Error(`Request failed with status: ${d.status}`);if(!d.body)throw new Error("No response body");const n=d.body.getReader(),a=new TextDecoder;let o="";for(;;){const{done:m,value:h}=await n.read();if(m)break;const V=a.decode(h,{stream:!0});o+=V,f(R=>R.map(P=>P.id===p?{...P,content:o}:P))}f(m=>m.map(h=>h.id===p?{...h,isStreaming:!1}:h))},B=async()=>{if(!j.trim()||k)return;const s={id:Date.now().toString(),role:"user",content:j.trim()},p=(Date.now()+1).toString(),i={id:p,role:"assistant",content:"",isStreaming:!0};f(d=>[...d,s,i]),E(""),A(!0),x.current&&x.current.abort(),x.current=new AbortController;try{b==="xiaoxiong-agent"?await L(s,p):await O(s,p)}catch(d){if(d instanceof Error&&d.name==="AbortError"){console.log("Request aborted");return}console.error("Ask API error:",d);const n=l.language==="zh"?"抱歉，暂时无法获取结果，请稍后再试":l.language==="pt"?"Desculpe, não foi possível obter resultados. Tente novamente mais tarde.":"Sorry, unable to get results. Please try again later.";f(a=>a.map(o=>o.id===p?{...o,content:n,isStreaming:!1}:o))}finally{A(!1)}},X=s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),B())},y=()=>{x.current&&x.current.abort(),u(!1)},v=s=>{y(),c(s)},S=s=>{const p=/\[([^\]]+)\]\(([^)]+)\)/g,i=[];let d=0,n,a=0;for(;(n=p.exec(s))!==null;){n.index>d&&i.push(e.jsx("span",{children:s.slice(d,n.index)},a++));const o=n[1],m=n[2];m.startsWith("/")?i.push(e.jsx("button",{onClick:()=>v(m),className:"text-primary hover:underline font-medium cursor-pointer",children:o},a++)):i.push(e.jsx("a",{href:m,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline font-medium",children:o},a++)),d=n.index+n[0].length}return d<s.length&&i.push(e.jsx("span",{children:s.slice(d)},a++)),i.length>0?i:[e.jsx("span",{children:s},"0")]},w=s=>s.replace(/\*\*(.*?)\*\*/g,"$1"),U=(s,p=20)=>s.length<=p?s:s.slice(0,p)+"...",Z=(s,p)=>{const i=a=>a.split("|").slice(1,-1).map(o=>w(o.trim())),d=i(s[0]),n=s.slice(2).map(i);return e.jsx("div",{className:"overflow-x-auto my-2 max-w-full",children:e.jsxs("table",{className:"w-full text-xs border border-border rounded-md overflow-hidden table-fixed",children:[e.jsx("thead",{className:"bg-muted/60",children:e.jsx("tr",{children:d.map((a,o)=>e.jsx("th",{className:"px-2 py-2 text-left font-semibold border-b border-border truncate max-w-[100px]",title:a,children:S(U(a,15))},o))})}),e.jsx("tbody",{children:n.map((a,o)=>e.jsx("tr",{className:"border-b border-border last:border-0 hover:bg-muted/30 transition-colors",children:a.map((m,h)=>e.jsx("td",{className:"px-2 py-2 truncate max-w-[100px]",title:m,children:S(U(m,18))},h))},o))})]})},p)},ee=s=>{const p=s.split(`
`),i=[];let d=0;for(;d<p.length;){const n=p[d];if(n.trim().startsWith("|")&&n.split("|").length>2){const a=[];for(;d<p.length&&p[d].trim().startsWith("|");)a.push(p[d]),d++;a.length>=2&&i.push(Z(a,i.length));continue}if(n.startsWith("### "))i.push(e.jsx("h3",{className:"text-base font-semibold mt-3 mb-1",children:S(n.slice(4))},i.length));else if(n.startsWith("## "))i.push(e.jsx("h2",{className:"text-lg font-bold mt-4 mb-2",children:S(n.slice(3))},i.length));else if(n.startsWith("# "))i.push(e.jsx("h1",{className:"text-xl font-bold mt-4 mb-2",children:S(n.slice(2))},i.length));else if(n.includes("**")){const a=n.split(/\*\*(.*?)\*\*/g);i.push(e.jsx("p",{className:"mb-1 leading-relaxed",children:a.map((o,m)=>m%2===1?e.jsx("strong",{className:"font-semibold",children:S(o)},m):S(o))},i.length))}else n.startsWith("- ")||n.startsWith("* ")?i.push(e.jsx("li",{className:"ml-4 mb-0.5 list-disc",children:S(n.slice(2))},i.length)):/^\d+\.\s/.test(n)?i.push(e.jsx("li",{className:"ml-4 mb-0.5 list-decimal",children:S(n.replace(/^\d+\.\s/,""))},i.length)):n.match(/^[-*_]{3,}$/)?i.push(e.jsx("hr",{className:"my-3 border-border"},i.length)):n.trim()===""?i.push(e.jsx("div",{className:"h-1"},i.length)):i.push(e.jsx("p",{className:"mb-1 leading-relaxed",children:S(n)},i.length));d++}return i},Y=()=>l.language==="zh"?"小熊AI助手":l.language==="pt"?"Assistente IA Xiaoxiong":"Xiaoxiong AI Assistant",J=()=>l.language==="zh"?"告诉小熊，你想吃什么...":l.language==="pt"?"Diga ao Xiaoxiong o que você quer comer...":"Tell Xiaoxiong what you want to eat...",K=()=>l.language==="zh"?"你好，我是小熊，我来帮你推荐餐厅；比如：「我附近的寿司餐厅」":l.language==="pt"?"Olá, eu sou o Xiaoxiong, vou te ajudar a encontrar restaurantes; por exemplo: 「restaurantes de sushi perto de mim」":`Hi, I'm Xiaoxiong, I'll help you find restaurants; for example: "sushi restaurants near me"`;return e.jsx(ke,{open:t,onOpenChange:y,children:e.jsxs(_e,{className:"w-full h-full max-w-full max-h-full sm:max-w-lg sm:h-[70vh] sm:max-h-[70vh] sm:rounded-lg rounded-none flex flex-col p-0 gap-0 overflow-hidden",children:[e.jsx(Se,{className:"px-4 py-3 border-b shrink-0 bg-primary/5",children:e.jsxs(Ce,{className:"flex items-center gap-2 text-base",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:_,alt:"Logo",className:"w-6 h-6 object-contain"})}),Y()]})}),e.jsx(Ie,{className:"flex-1 h-0",ref:z,children:e.jsxs("div",{className:"p-4 space-y-4",children:[T.length===0&&e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center shrink-0",children:e.jsx(se,{className:"w-4 h-4 text-primary"})}),e.jsx("div",{className:"flex-1 bg-muted/50 rounded-2xl rounded-tl-sm px-4 py-3 text-sm",children:K()})]}),T.map(s=>e.jsxs("div",{className:I("flex gap-3",s.role==="user"&&"flex-row-reverse"),children:[e.jsx("div",{className:I("w-8 h-8 rounded-full flex items-center justify-center shrink-0",s.role==="user"?"bg-primary text-primary-foreground":"bg-primary/10"),children:s.role==="user"?e.jsx(Te,{className:"h-4 w-4"}):e.jsx(se,{className:"h-4 w-4"})}),e.jsx("div",{className:I("flex-1 max-w-[85%] rounded-2xl px-4 py-3 text-sm",s.role==="user"?"bg-primary text-primary-foreground rounded-tr-sm":"bg-muted/50 rounded-tl-sm"),children:s.role==="assistant"?e.jsxs(e.Fragment,{children:[s.content?e.jsx("div",{className:"prose-sm",children:ee(s.content)}):e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(re,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:l.language==="zh"?"思考中...":l.language==="pt"?"Pensando...":"Thinking..."})]}),s.isStreaming&&s.content&&e.jsx("span",{className:"inline-block w-1.5 h-4 bg-primary/50 animate-pulse ml-0.5 align-middle"})]}):s.content})]},s.id)),e.jsx("div",{ref:M})]})}),e.jsx("div",{className:"p-3 border-t bg-background shrink-0",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Re,{value:j,onChange:s=>E(s.target.value),onKeyDown:X,placeholder:J(),disabled:k,className:"flex-1 rounded-full bg-muted/50 border-0 focus-visible:ring-1",autoFocus:!0}),e.jsx(F,{onClick:B,disabled:!j.trim()||k,size:"icon",className:"shrink-0 rounded-full",children:k?e.jsx(re,{className:"h-4 w-4 animate-spin"}):e.jsx(ze,{className:"h-4 w-4"})})]})})]})})};function Ge({onRefresh:t,threshold:u=80,maxPull:b=120}){const[l,c]=r.useState(!1),[g,N]=r.useState(!1),[_,j]=r.useState(0),E=r.useRef(0),T=r.useRef(0),f=r.useRef(null),k=r.useCallback(x=>{(window.scrollY||document.documentElement.scrollTop)>5||(E.current=x.touches[0].clientY,c(!0))},[]),A=r.useCallback(x=>{if(!l||g)return;T.current=x.touches[0].clientY;const z=T.current-E.current;if(z<0){j(0);return}z>10&&x.preventDefault();const D=Math.min(z*.5,b);j(D)},[l,g,b]),C=r.useCallback(async()=>{if(l)if(c(!1),_>=u&&!g){N(!0),j(u);try{await t()}finally{N(!1),j(0)}}else j(0)},[l,_,u,g,t]);r.useEffect(()=>{const x=f.current;if(x)return x.addEventListener("touchstart",k,{passive:!0}),x.addEventListener("touchmove",A,{passive:!1}),x.addEventListener("touchend",C,{passive:!0}),()=>{x.removeEventListener("touchstart",k),x.removeEventListener("touchmove",A),x.removeEventListener("touchend",C)}},[k,A,C]);const $=Math.min(_/u,1);return{containerRef:f,isPulling:l,isRefreshing:g,pullDistance:_,progress:$}}function Qe({children:t,onRefresh:u,className:b}){const{containerRef:l,isRefreshing:c,pullDistance:g,progress:N}=Ge({onRefresh:u,threshold:80,maxPull:120});return e.jsxs("div",{ref:l,className:I("relative",b),children:[e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 z-50 flex items-center justify-center transition-opacity duration-200 pointer-events-none",style:{top:Math.max(g-50,8),opacity:g>20?1:0},children:e.jsx("div",{className:I("w-10 h-10 rounded-full bg-background/90 backdrop-blur-sm shadow-lg flex items-center justify-center border border-border/50",c&&"animate-pulse"),children:e.jsx(De,{className:I("w-5 h-5 text-primary transition-transform duration-200",c&&"animate-spin"),style:{transform:c?void 0:`rotate(${N*360}deg)`}})})}),e.jsx("div",{style:{transform:g>0?`translateY(${g}px)`:void 0,transition:g===0?"transform 0.3s ease-out":void 0},children:t})]})}const ae="/images/sushi-ramen-hero.jpg",xe="/images/sushi-ramen-mobile.jpg",pe=r.memo(({stats:t,t:u})=>e.jsx("div",{className:"absolute top-16 sm:top-20 left-3 z-20",children:e.jsxs("div",{className:"gap-4 w-fit flex-col flex items-start justify-start",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm text-white/90 drop-shadow-md",children:u("home.stats.delivery")}),e.jsx("span",{className:"font-bold text-white text-sm drop-shadow-md",children:t.order_count})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"w-4 h-4 text-accent"}),e.jsx("span",{className:"text-sm text-white/90 drop-shadow-md",children:u("home.stats.reservation")}),e.jsx("span",{className:"font-bold text-white text-sm drop-shadow-md",children:t.reserve_count})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl sm:text-2xl font-bold text-white drop-shadow-md",children:u("home.hero.brandName")}),e.jsx("img",{src:Xe,alt:"map icon",width:32,height:32,loading:"eager",decoding:"async",className:"w-7 sm:w-8 h-7 sm:h-8 object-contain flex-shrink-0"})]})]})}));pe.displayName="StatsDisplay";const Q=r.memo(({to:t,Icon:u,title:b,desc:l,iconBg:c,iconColor:g,hoverBorderColor:N})=>e.jsx(q,{to:t,children:e.jsxs(Oe,{className:`group p-6 sm:p-8 border-border/50 ${N} transition-all hover:shadow-large cursor-pointer h-full`,children:[e.jsx("div",{className:`w-14 sm:w-16 h-14 sm:h-16 rounded-2xl ${c} flex items-center justify-center mb-4 sm:mb-6 group-hover:scale-110 transition-transform`,children:e.jsx(u,{className:`w-7 sm:w-8 h-7 sm:h-8 ${g}`})}),e.jsx("h3",{className:"text-xl sm:text-2xl font-semibold mb-2 sm:mb-3 text-card-foreground",children:b}),e.jsxs("p",{className:"text-sm sm:text-base text-muted-foreground leading-relaxed flex items-center gap-2",children:[l,e.jsx($e,{className:"w-4 h-4 flex-shrink-0 group-hover:translate-x-1 transition-transform"})]})]})}));Q.displayName="FeatureCard";const Ze=()=>{const t=window.innerWidth<640,u=window.innerWidth>=1024,b=navigator.connection,l=window.Capacitor,c=ue(),g=de(),N=me(),_=navigator.userAgent;return console.log("[LightweightMode] Detection:",{isCapacitorApp:c,isInWebView:g,isIOSDevice:N,hasCapacitor:!!l,capacitorDetails:l?{isNativePlatform:l.isNativePlatform,isNative:l.isNative,platform:l.getPlatform?.()}:null,userAgent:_.substring(0,150),hasSafari:/Safari\//.test(_),hasVersion:/Version\/[\d.]+/.test(_),isStandalone:window.navigator.standalone===!0}),u?!!b?.saveData:g&&!c?(console.log("[LightweightMode] WebView detected (not Capacitor), using lightweight mode"),!0):b&&(b.saveData||b.effectiveType==="2g"||b.effectiveType==="slow-2g")||t&&navigator.deviceMemory&&navigator.deviceMemory<2?!0:(console.log("[LightweightMode] Normal mode, videos enabled for",N?"iOS":"non-iOS","device"),!1)},ge=r.memo(({template:t,isActive:u,currentLang:b,t:l,onContentReady:c,onAskXiaoxiong:g})=>{const[N,_]=r.useState({}),[j,E]=r.useState({}),[T,f]=r.useState({}),[k,A]=r.useState({mobile:!0,tablet:!0,desktop:!0}),[C,$]=r.useState(!1),x=Ze(),z=r.useRef(null),M=r.useRef(null),D=r.useRef(null),O=a=>t[`${a}${b==="zh"?"_zh":b==="pt"?"_pt":"_en"}`]||"",L=()=>window.innerWidth<640?"mobile":window.innerWidth<1024?"tablet":"desktop",B=()=>{const a=L();return a==="mobile"&&t.mobile_overlay_opacity!==null?t.mobile_overlay_opacity:a==="tablet"&&t.tablet_overlay_opacity!==null?t.tablet_overlay_opacity:a==="desktop"&&t.desktop_overlay_opacity!==null?t.desktop_overlay_opacity:t.overlay_opacity??30},X=()=>{const a=B(),o=t.overlay_gradient_direction||"to-b",m=(H,we)=>H==null?we/100:H>1?H/100:H,h=a>1?a/100:a,V=m(t.overlay_gradient_from_opacity,30)*h,R=m(t.overlay_gradient_via_opacity,25)*h,P=m(t.overlay_gradient_to_opacity,40)*h,fe={"to-t":"to top","to-b":"to bottom","to-l":"to left","to-r":"to right","to-tl":"to top left","to-tr":"to top right","to-bl":"to bottom left","to-br":"to bottom right"}[o]||"to bottom",te={black:"0, 0, 0",white:"255, 255, 255",background:"0, 0, 0",foreground:"255, 255, 255",primary:"1, 100, 80",secondary:"240, 240, 240"},be=te[t.overlay_gradient_from||"black"]||"0, 0, 0",ye=te[t.overlay_gradient_via||"black"]||"0, 0, 0",ve=te[t.overlay_gradient_to||"black"]||"0, 0, 0";return{background:`linear-gradient(${fe}, rgba(${be}, ${V}), rgba(${ye}, ${R}), rgba(${ve}, ${P}))`}},y=t.mobile_image_url||xe,v=t.tablet_image_url||t.desktop_image_url||ae,S=t.desktop_image_url||ae,w=t.background_blur||0,U=t.desktop_media_type||t.media_type||"image",Z=t.tablet_media_type||t.media_type||"image",ee=t.mobile_media_type||t.media_type||"image",Y=U==="video"&&!x,J=Z==="video"&&!x,K=ee==="video"&&!x,s=K?t.mobile_video_url:null,p=J?t.tablet_video_url||t.desktop_video_url:null,i=Y?t.desktop_video_url:null;r.useEffect(()=>{const a=L(),o=a==="mobile"?y:a==="tablet"?v:S;if(o){const m=new Image;m.onload=()=>{_(h=>({...h,[a]:!0})),A(h=>({...h,[a]:!0})),u&&(c?.(),setTimeout(()=>$(!0),100))},m.src=o}},[y,v,S,u,c]),r.useEffect(()=>{u&&N[L()]&&$(!0)},[u,N]);const d=a=>{E(o=>({...o,[a]:!0}))},n=(a,o)=>{console.error(`[HeroSlide] Video error on ${a}:`,o),f(m=>({...m,[a]:!0}))};return r.useEffect(()=>{if(!C||!u||!me())return;const o=L(),h=(o==="mobile"?z:o==="tablet"?M:D).current;if(!h)return;const R=setTimeout(async()=>{try{h.muted=!0,h.playsInline=!0,h.setAttribute("webkit-playsinline","true"),await h.play(),console.log(`[HeroSlide] iOS video play successful on ${o}`)}catch(P){console.error(`[HeroSlide] iOS video play failed on ${o}:`,P),f(W=>({...W,[o]:!0}))}},150);return()=>clearTimeout(R)},[C,u]),e.jsxs("div",{className:I("absolute inset-0 w-full h-full transition-opacity duration-1000",u?"opacity-100 z-10":"opacity-0 z-0"),children:[e.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[e.jsxs("div",{className:"absolute inset-0 w-full h-full sm:hidden",children:[!k.mobile&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),K&&s?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:y,alt:"Background",className:I("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",j.mobile&&!T.mobile?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:w>0?`blur(${w}px)`:void 0}}),C&&!T.mobile&&e.jsx("video",{ref:z,src:s,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>d("mobile"),onError:a=>n("mobile",a),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:w>0?`blur(${w}px)`:void 0}})]}):e.jsx("img",{src:y,alt:"Background",className:I("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",k.mobile?"opacity-100":"opacity-0"),style:{filter:w>0?`blur(${w}px)`:void 0}})]}),e.jsxs("div",{className:"absolute inset-0 w-full h-full hidden sm:block lg:hidden",children:[!k.tablet&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),J&&p?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:v,alt:"Background",className:I("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",j.tablet&&!T.tablet?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:w>0?`blur(${w}px)`:void 0}}),C&&!T.tablet&&e.jsx("video",{ref:M,src:p,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>d("tablet"),onError:a=>n("tablet",a),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:w>0?`blur(${w}px)`:void 0}})]}):e.jsx("img",{src:v,alt:"Background",className:I("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",k.tablet?"opacity-100":"opacity-0"),style:{filter:w>0?`blur(${w}px)`:void 0}})]}),e.jsxs("div",{className:"absolute inset-0 w-full h-full hidden lg:block",children:[!k.desktop&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),Y&&i?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:S,alt:"Background",className:I("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",j.desktop&&!T.desktop?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:w>0?`blur(${w}px)`:void 0}}),C&&!T.desktop&&e.jsx("video",{ref:D,src:i,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>d("desktop"),onError:a=>n("desktop",a),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:w>0?`blur(${w}px)`:void 0}})]}):e.jsx("img",{src:S,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:I("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",k.desktop?"opacity-100":"opacity-0"),style:{filter:w>0?`blur(${w}px)`:void 0}})]}),e.jsx("div",{className:"absolute inset-0 w-full h-full",style:X()})]}),e.jsx("div",{className:"relative z-10 container mx-auto px-4 sm:px-6 flex items-end sm:items-center min-h-screen pb-16 sm:pb-0",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center space-y-4 sm:space-y-8 animate-fade-in w-full",children:[t.subtitle_button_text_zh&&e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:g,className:"group flex items-center gap-3 bg-white/95 backdrop-blur-sm text-muted-foreground px-4 sm:px-6 py-3 sm:py-4 rounded-full shadow-lg hover:shadow-2xl hover:bg-white transition-all duration-300 cursor-text border border-border/20",children:[e.jsx(se,{className:"w-5 h-5 text-primary/70 group-hover:text-primary transition-colors"}),e.jsx("span",{className:"text-sm sm:text-base text-muted-foreground/80 group-hover:text-muted-foreground transition-colors",children:O("subtitle_button_text")||l("home.hero.subtitle")}),e.jsx(oe,{className:"w-4 h-4 text-muted-foreground/50 ml-2"})]})}),e.jsx("h1",{className:"text-3xl sm:text-5xl md:text-7xl font-bold text-white leading-tight px-4 drop-shadow-[0_2px_8px_rgba(0,0,0,0.8)]",children:O("title")||l("home.hero.title")}),e.jsx("p",{className:"text-sm sm:text-xl md:text-2xl text-white/95 max-w-2xl mx-auto px-4 drop-shadow-[0_2px_6px_rgba(0,0,0,0.7)]",children:O("description")||l("home.hero.description")}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4 justify-center pt-2 sm:pt-4 px-4",children:[e.jsx(F,{size:"lg",asChild:!0,className:"text-base sm:text-lg shadow-lg hover:shadow-2xl hover:scale-105 transition-all w-full sm:w-auto",children:e.jsxs(q,{to:t.primary_button_link||"/restaurants",children:[e.jsx(oe,{className:"mr-2 w-4 sm:w-5 h-4 sm:h-5"}),O("primary_button_text")||l("home.hero.exploreBtn")]})}),e.jsx(F,{size:"lg",variant:"outline",asChild:!0,className:"text-base sm:text-lg w-full sm:w-auto backdrop-blur-sm hover:border-transparent hover:scale-105 transition-all",children:e.jsxs(q,{to:t.secondary_button_link||"/activities",children:[e.jsx(le,{className:"mr-2 w-4 sm:w-5 h-4 sm:h-5"}),O("secondary_button_text")||l("home.hero.activitiesBtn")]})}),e.jsx(F,{size:"lg",asChild:!0,className:"text-base sm:text-lg w-full sm:w-auto bg-[#e8f5f0] text-[#3d9970] hover:bg-[#d4ede4] hover:scale-105 transition-all shadow-lg border border-[#3d9970]/30",children:e.jsxs(q,{to:t.map_button_link||"/map",children:[e.jsx(ce,{className:"mr-2 w-4 sm:w-5 h-4 sm:h-5"}),O("map_button_text")||l("home.hero.mapBtn")]})})]})]})})]})});ge.displayName="HeroSlide";const dt=()=>{const{t,i18n:u}=he(),b=qe(),{settings:l}=ne(),{data:c,isLoading:g,refetch:N}=He(),[_,j]=r.useState(0),[E,T]=r.useState(null),f=r.useRef(null),[k,A]=r.useState(!1),[C,$]=r.useState(!1),x=l?.ai_assistant_enabled!==!1,z=l?.ai_provider||"ask-xiaoxiong",M=r.useCallback(()=>{A(!0)},[]);Fe({pageType:"home"});const D=r.useCallback(async()=>{try{const v=await(await fetch("https://v.xiaoxiong.pt/api/get_info")).json();v&&T({order_count:v.order_count||0,reserve_count:v.reserve_count||0})}catch(y){console.error("Failed to fetch stats:",y)}},[]);r.useEffect(()=>{D()},[D]);const O=r.useCallback(async()=>{await Promise.all([N(),D(),b.invalidateQueries({queryKey:["restaurants"]}),b.invalidateQueries({queryKey:["activities"]})])},[N,D,b]);r.useEffect(()=>{if(!c||c.length<=1)return;const v=c[_]?.duration||5e3;return f.current=setTimeout(()=>{j(S=>(S+1)%c.length)},v),()=>{f.current&&clearTimeout(f.current)}},[c,_]);const L=r.useCallback(y=>{f.current&&clearTimeout(f.current),j(y)},[]);r.useCallback(()=>{c&&(f.current&&clearTimeout(f.current),j(y=>(y-1+c.length)%c.length))},[c]),r.useCallback(()=>{c&&(f.current&&clearTimeout(f.current),j(y=>(y+1)%c.length))},[c]);const B=u.language,X=c&&c.length>1;return e.jsx(Qe,{onRefresh:O,children:e.jsxs("div",{className:"min-h-screen",children:[e.jsxs("section",{className:"relative h-screen flex items-start overflow-hidden bg-background",children:[E&&e.jsx(pe,{stats:E,t}),e.jsx("div",{className:I("absolute inset-0 w-full h-full transition-opacity duration-500",k?"opacity-100":"opacity-0"),children:c?.map((y,v)=>e.jsx(ge,{template:y,isActive:v===_,currentLang:B,t,onContentReady:v===0?M:void 0,onAskXiaoxiong:()=>$(!0)},y.id))}),e.jsx("div",{className:I("absolute inset-0 w-full h-full z-20 transition-opacity duration-500",g||!k?"opacity-100":"opacity-0 pointer-events-none"),children:e.jsx(Pe,{})}),!g&&(!c||c.length===0)&&e.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[e.jsx("img",{src:xe,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:"absolute inset-0 w-full h-full object-cover object-center sm:hidden"}),e.jsx("img",{src:ae,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:"absolute inset-0 w-full h-full object-cover object-center hidden sm:block"}),e.jsx("div",{className:"absolute inset-0 w-full h-full bg-gradient-to-b from-black/30 via-black/25 to-black/40"}),e.jsx("div",{className:"relative z-10 container mx-auto px-4 sm:px-6 flex items-center min-h-screen",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center space-y-4 sm:space-y-8 animate-fade-in w-full",children:[e.jsx("h1",{className:"text-3xl sm:text-5xl md:text-7xl font-bold text-white leading-tight px-4 drop-shadow-[0_2px_8px_rgba(0,0,0,0.8)]",children:t("home.hero.title")}),e.jsx("p",{className:"text-sm sm:text-xl md:text-2xl text-white/95 max-w-2xl mx-auto px-4 drop-shadow-[0_2px_6px_rgba(0,0,0,0.7)]",children:t("home.hero.description")})]})})]}),X&&e.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 z-30 flex gap-2",children:c.map((y,v)=>e.jsx("button",{onClick:()=>L(v),className:I("w-3 h-3 rounded-full transition-all duration-300",v===_?"bg-white w-8":"bg-white/50 hover:bg-white/70"),"aria-label":`Go to slide ${v+1}`},v))})]}),e.jsx("section",{className:"py-16 sm:py-24 px-4 bg-secondary/20",children:e.jsxs("div",{className:"container mx-auto max-w-6xl",children:[e.jsxs("div",{className:"text-center mb-12 sm:mb-16",children:[e.jsx("h2",{className:"text-3xl sm:text-4xl md:text-5xl font-bold text-foreground mb-3 sm:mb-4",children:t("home.features.title")}),e.jsx("p",{className:"text-base sm:text-lg text-muted-foreground max-w-2xl mx-auto px-4",children:t("home.features.description")})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 sm:gap-8",children:[e.jsx(Q,{to:"/map",Icon:ce,title:t("home.features.map.title"),desc:t("home.features.map.desc"),iconBg:"bg-gradient-to-br from-primary to-primary-light",iconColor:"text-primary-foreground",hoverBorderColor:"hover:border-primary/50"}),e.jsx(Q,{to:"/restaurants",Icon:Me,title:t("home.features.reviews.title"),desc:t("home.features.reviews.desc"),iconBg:"bg-gradient-to-br from-accent to-warning",iconColor:"text-accent-foreground",hoverBorderColor:"hover:border-accent/50"}),e.jsx("div",{className:"sm:col-span-2 md:col-span-1",children:e.jsx(Q,{to:"/activities",Icon:le,title:t("home.features.events.title"),desc:t("home.features.events.desc"),iconBg:"bg-gradient-to-br from-success to-accent",iconColor:"text-white",hoverBorderColor:"hover:border-success/50"})})]})]})}),!de()&&!ue()&&e.jsxs("section",{className:"py-16 sm:py-24 px-4 bg-gradient-to-br from-primary/5 via-background to-primary/10 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-1/4 w-72 h-72 bg-primary/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 right-1/4 w-96 h-96 bg-primary/5 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute top-1/2 left-0 w-32 h-32 bg-primary/20 rounded-full blur-2xl -translate-y-1/2"}),e.jsx("div",{className:"absolute top-1/2 right-0 w-32 h-32 bg-primary/20 rounded-full blur-2xl -translate-y-1/2"}),e.jsx("div",{className:"container mx-auto max-w-5xl relative z-10",children:e.jsx("div",{className:"flex flex-col items-center justify-center gap-8",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-primary/10 text-primary text-sm font-medium px-4 py-2 rounded-full mb-4",children:[e.jsx(Le,{className:"w-4 h-4"}),e.jsx("span",{children:"Mobile App"})]}),e.jsx("h3",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-foreground mb-4",children:t("home.app.title")}),e.jsx("p",{className:"text-base sm:text-lg text-muted-foreground mb-8 leading-relaxed",children:t("home.app.description")}),e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[e.jsxs("a",{href:"https://apps.apple.com/cn/app/xiaoxiong/id6755481369",target:"_blank",rel:"noopener noreferrer",className:"relative group",children:[e.jsx("div",{className:"absolute -inset-2 bg-gradient-to-r from-primary via-primary-glow to-primary rounded-2xl blur-lg opacity-40 group-hover:opacity-70 transition-opacity"}),e.jsx("div",{className:"relative bg-black hover:bg-gray-900 h-[52px] sm:h-[56px] w-[160px] sm:w-[180px] rounded-xl transition-all hover:scale-105 shadow-2xl hover:shadow-primary/30 border border-white/10 flex items-center justify-center",children:e.jsx("img",{src:Ye,alt:"Download on the App Store",className:"h-8 sm:h-9"})})]}),e.jsxs("a",{href:"https://play.google.com/store/apps/details?id=com.xiaoxiong.market",target:"_blank",rel:"noopener noreferrer",className:"relative group",children:[e.jsx("div",{className:"absolute -inset-2 bg-gradient-to-r from-primary via-primary-glow to-primary rounded-2xl blur-lg opacity-40 group-hover:opacity-70 transition-opacity"}),e.jsx("div",{className:"relative bg-black hover:bg-gray-900 h-[52px] sm:h-[56px] w-[160px] sm:w-[180px] rounded-xl transition-all hover:scale-105 shadow-2xl hover:shadow-primary/30 border border-white/10 flex items-center justify-center",children:e.jsx("img",{src:Ue,alt:"Get it on Google Play",className:"h-12 sm:h-14"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Be,{className:"w-4 h-4 animate-bounce"}),e.jsx("span",{children:t("home.app.downloadNow")})]})]})]})})})]}),e.jsxs("section",{className:"py-16 sm:py-20 px-4 bg-gradient-to-br from-primary via-primary-glow to-primary-light relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-grid-pattern opacity-10"}),e.jsx("div",{className:"absolute top-0 right-0 w-64 sm:w-96 h-64 sm:h-96 bg-white/5 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-64 sm:w-96 h-64 sm:h-96 bg-white/5 rounded-full blur-3xl"}),e.jsxs("div",{className:"container mx-auto max-w-4xl text-center relative z-10",children:[e.jsx("h2",{className:"text-3xl sm:text-4xl md:text-5xl font-bold text-primary-foreground mb-4 sm:mb-6 px-4",children:t("home.cta.title")}),e.jsx("p",{className:"text-base sm:text-xl text-primary-foreground/90 mb-6 sm:mb-8 max-w-2xl mx-auto px-4",children:t("home.cta.description")}),e.jsx("div",{className:"flex justify-center",children:e.jsx(F,{size:"lg",variant:"secondary",asChild:!0,className:"text-base sm:text-lg shadow-xl hover:shadow-2xl",children:e.jsxs(q,{to:"/join-us",children:[e.jsx(Ve,{className:"mr-2 w-4 sm:w-5 h-4 sm:h-5"}),t("home.cta.button")]})})})]})]}),x&&e.jsx(Ke,{open:C,onOpenChange:$,provider:z})]})})};export{dt as default};
//# sourceMappingURL=Home-BsKGdzXh.js.map
