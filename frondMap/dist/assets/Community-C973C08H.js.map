{"version":3,"file":"Community-C973C08H.js","sources":["../../src/components/community/PostGridCard.tsx","../../src/components/community/PostPointsRulesDialog.tsx","../../src/components/community/MultiRestaurantSelectDrawer.tsx","../../src/components/ui/command.tsx","../../src/components/community/ActivitySelectDrawer.tsx","../../src/components/community/EmojiPicker.tsx","../../src/components/community/PostTypeSelector.tsx","../../src/components/community/recipe/RecipeTypes.ts","../../src/components/community/recipe/RecipeBasicStep.tsx","../../src/components/community/recipe/RecipeIngredientsStep.tsx","../../src/components/community/recipe/RecipeStepsStep.tsx","../../src/hooks/useCreateRecipe.ts","../../src/components/community/recipe/CreateRecipeWizard.tsx","../../src/components/community/CreatePostDialog.tsx","../../src/pages/Community.tsx"],"sourcesContent":["import { useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Heart, Images, Play, Store, Calendar, Clock, Users, Utensils } from \"lucide-react\";\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { CommunityPost, useLikePost } from \"@/hooks/useCommunityPosts\";\r\nimport { useAuth } from \"@/contexts/AuthContext\";\r\nimport { useLocalizedContent } from \"@/hooks/useLocalizedContent\";\r\n\r\ninterface PostGridCardProps {\r\n  post: CommunityPost;\r\n  showAssociations?: boolean;\r\n}\r\n\r\ninterface ExtendedPost extends CommunityPost {\r\n  post_type?: string;\r\n  recipe_name?: string;\r\n  cook_time?: number;\r\n  difficulty?: string;\r\n  servings?: number;\r\n}\r\n\r\nconst PostGridCard = ({ post, showAssociations = false }: PostGridCardProps) => {\r\n  const { t } = useTranslation();\r\n  const { user } = useAuth();\r\n  const navigate = useNavigate();\r\n  const { getLocalizedField } = useLocalizedContent();\r\n  const likePost = useLikePost();\r\n  const [imageError, setImageError] = useState(false);\r\n\r\n  const extendedPost = post as ExtendedPost;\r\n  const isRecipe = extendedPost.post_type === 'recipe';\r\n\r\n  const handleLike = (e: React.MouseEvent) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    if (!user) return;\r\n    likePost.mutate({ postId: post.id, liked: post.user_liked || false });\r\n  };\r\n\r\n  const handleCardClick = () => navigate(`/community/${post.id}`);\r\n  const handleRestaurantClick = (e: React.MouseEvent, id: string) => { e.preventDefault(); e.stopPropagation(); navigate(`/restaurant/${id}`); };\r\n  const handleActivityClick = (e: React.MouseEvent) => { e.preventDefault(); e.stopPropagation(); if (post.activity?.id) navigate(`/activity/${post.activity.id}`); };\r\n\r\n  const getPlainTextContent = (html: string) => new DOMParser().parseFromString(html, \"text/html\").body.textContent || \"\";\r\n\r\n  const content = getLocalizedField(post, \"content\");\r\n  const plainContent = getPlainTextContent(content);\r\n  const hasImages = post.image_urls && post.image_urls.length > 0;\r\n  const hasVideo = !!post.video_url;\r\n  const hasMedia = hasImages || hasVideo;\r\n  const imageCount = post.image_urls?.length || 0;\r\n\r\n  const allRestaurants = [...(post.restaurants || []), ...(post.restaurant && !post.restaurants?.find(r => r.id === post.restaurant?.id) ? [post.restaurant] : [])];\r\n  const activityTitle = post.activity ? getLocalizedField(post.activity, \"title\") : null;\r\n  const maxVisibleRestaurants = 2;\r\n\r\n  const getDifficultyColor = (d: string) => {\r\n    switch (d) {\r\n      case 'easy': return 'bg-green-500/20 text-green-700 dark:text-green-400';\r\n      case 'medium': return 'bg-yellow-500/20 text-yellow-700 dark:text-yellow-400';\r\n      case 'hard': return 'bg-red-500/20 text-red-700 dark:text-red-400';\r\n      default: return 'bg-muted text-muted-foreground';\r\n    }\r\n  };\r\n\r\n  const getDifficultyLabel = (d: string) => {\r\n    switch (d) {\r\n      case 'easy': return t(\"recipe.difficulty.easy\", \"ç®€å•\");\r\n      case 'medium': return t(\"recipe.difficulty.medium\", \"ä¸­ç­‰\");\r\n      case 'hard': return t(\"recipe.difficulty.hard\", \"å›°éš¾\");\r\n      default: return d;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"group cursor-pointer rounded-lg overflow-hidden bg-card border border-border/50 hover:shadow-lg transition-all duration-300 hover:-translate-y-1\" onClick={handleCardClick}>\r\n      {/* Media Section */}\r\n      {hasMedia && (\r\n        <div className={`relative ${isRecipe ? 'aspect-[4/3]' : 'aspect-[4/5]'} overflow-hidden`}>\r\n          {hasImages ? (!imageError ? (\r\n            <img src={post.image_urls![0]} alt=\"\" className=\"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500\" onError={() => setImageError(true)} />\r\n          ) : (\r\n            <div className=\"w-full h-full bg-muted flex items-center justify-center\"><span className=\"text-xs text-muted-foreground\">{t(\"common.imageLoadError\", \"å›¾ç‰‡åŠ è½½å¤±è´¥\")}</span></div>\r\n          )) : hasVideo ? (\r\n            <video src={post.video_url} className=\"w-full h-full object-cover\" preload=\"metadata\" muted playsInline />\r\n          ) : null}\r\n          \r\n          {isRecipe && <Badge className=\"absolute top-2 left-2 bg-primary text-primary-foreground gap-1\"><Utensils className=\"h-3 w-3\" />{t(\"recipe.badge\", \"é£Ÿè°±\")}</Badge>}\r\n          {hasVideo && !isRecipe && <div className=\"absolute inset-0 flex items-center justify-center pointer-events-none\"><div className=\"w-12 h-12 rounded-full bg-black/50 backdrop-blur-sm flex items-center justify-center\"><Play className=\"h-5 w-5 text-white fill-white ml-0.5\" /></div></div>}\r\n          {!hasVideo && imageCount > 1 && !isRecipe && <div className=\"absolute top-2 right-2 bg-black/60 text-white text-xs px-2 py-0.5 rounded-full z-10 flex items-center gap-1\"><Images className=\"h-3 w-3\" /><span>{imageCount}</span></div>}\r\n        </div>\r\n      )}\r\n\r\n      {!hasMedia && isRecipe && (\r\n        <div className=\"relative aspect-[4/3] overflow-hidden bg-gradient-to-br from-primary/20 to-primary/5 flex items-center justify-center\">\r\n          <Utensils className=\"h-12 w-12 text-primary/40\" />\r\n          <Badge className=\"absolute top-2 left-2 bg-primary text-primary-foreground gap-1\"><Utensils className=\"h-3 w-3\" />{t(\"recipe.badge\", \"é£Ÿè°±\")}</Badge>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"p-3\">\r\n        {isRecipe && (\r\n          <div className=\"flex items-center gap-3 text-xs text-muted-foreground mb-2\">\r\n            {extendedPost.cook_time && <div className=\"flex items-center gap-1\"><Clock className=\"h-3.5 w-3.5\" /><span>{extendedPost.cook_time}{t(\"recipe.min\", \"åˆ†\")}</span></div>}\r\n            {extendedPost.servings && <div className=\"flex items-center gap-1\"><Users className=\"h-3.5 w-3.5\" /><span>{extendedPost.servings}{t(\"recipe.servingsShort\", \"äºº\")}</span></div>}\r\n            {extendedPost.difficulty && <Badge variant=\"secondary\" className={`text-xs px-1.5 py-0 h-5 ${getDifficultyColor(extendedPost.difficulty)}`}>{getDifficultyLabel(extendedPost.difficulty)}</Badge>}\r\n          </div>\r\n        )}\r\n\r\n        {showAssociations && (allRestaurants.length > 0 || activityTitle) && (\r\n          <div className=\"flex flex-wrap gap-1.5 mb-2\">\r\n            {allRestaurants.slice(0, maxVisibleRestaurants).map((restaurant) => (\r\n              <Badge key={restaurant.id} variant=\"secondary\" className=\"text-xs cursor-pointer hover:bg-secondary/80 gap-1\" onClick={(e) => handleRestaurantClick(e, restaurant.id)}>\r\n                <Store className=\"h-3 w-3\" /><span className=\"truncate max-w-[120px]\">{getLocalizedField(restaurant, \"name\")}</span>\r\n              </Badge>\r\n            ))}\r\n            {allRestaurants.length > maxVisibleRestaurants && <Badge variant=\"secondary\" className=\"text-xs gap-1\">+{allRestaurants.length - maxVisibleRestaurants}</Badge>}\r\n            {activityTitle && <Badge variant=\"secondary\" className=\"text-xs cursor-pointer hover:bg-secondary/80 gap-1\" onClick={handleActivityClick}><Calendar className=\"h-3 w-3\" /><span className=\"truncate max-w-[120px]\">{activityTitle}</span></Badge>}\r\n          </div>\r\n        )}\r\n\r\n        <p className={`text-sm font-medium line-clamp-2 leading-relaxed ${hasMedia ? '' : 'min-h-[60px]'}`}>{isRecipe ? extendedPost.recipe_name : plainContent}</p>\r\n\r\n        <div className=\"flex items-center justify-between mt-3\">\r\n          <div className=\"flex items-center gap-2 min-w-0 flex-1\">\r\n            <Avatar className=\"h-5 w-5 flex-shrink-0\"><AvatarImage src={post.author?.avatar_url || undefined} /><AvatarFallback className=\"text-[10px]\">{post.author?.display_name?.charAt(0) || \"?\"}</AvatarFallback></Avatar>\r\n            <span className=\"text-xs text-muted-foreground truncate\">{post.author?.display_name}</span>\r\n          </div>\r\n          <button className={`flex items-center gap-1 text-xs ${post.user_liked ? \"text-red-500\" : \"text-muted-foreground\"} hover:text-red-500 transition-colors`} onClick={handleLike} disabled={!user}>\r\n            <Heart className={`h-4 w-4 ${post.user_liked ? \"fill-current\" : \"\"}`} /><span>{post.likes_count || 0}</span>\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PostGridCard;\r\n","import { useTranslation } from \"react-i18next\";\r\nimport { Gift, CheckCircle, Clock, Shield } from \"lucide-react\";\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogTrigger,\r\n} from \"@/components/ui/dialog\";\r\nimport { usePointsSettings } from \"@/hooks/usePoints\";\r\n\r\nconst PostPointsRulesDialog = () => {\r\n  const { t } = useTranslation();\r\n  const { data: settings } = usePointsSettings();\r\n\r\n  // ä»è®¾ç½®ä¸­æå–å€¼\r\n  const postPoints = settings?.find(s => s.key === 'post_points')?.value || '5';\r\n  const minLength = settings?.find(s => s.key === 'min_post_length')?.value || '10';\r\n  const requireMedia = settings?.find(s => s.key === 'post_require_media')?.value === 'true';\r\n\r\n  return (\r\n    <Dialog>\r\n      <DialogTrigger asChild>\r\n        <button className=\"text-primary hover:underline text-sm whitespace-nowrap\">\r\n          {t(\"community.viewPointsRules\", \"æŸ¥çœ‹è¯¦ç»†è§„åˆ™\")}\r\n        </button>\r\n      </DialogTrigger>\r\n      <DialogContent className=\"max-w-md\">\r\n        <DialogHeader>\r\n          <DialogTitle className=\"flex items-center gap-2\">\r\n            <Gift className=\"h-5 w-5 text-primary\" />\r\n            {t(\"community.pointsRulesTitle\", \"å‘å¸–ç§¯åˆ†è§„åˆ™\")}\r\n          </DialogTitle>\r\n        </DialogHeader>\r\n        <div className=\"space-y-4 pt-2\">\r\n          <p className=\"text-muted-foreground text-sm\">\r\n            {t(\"community.pointsRulesIntro\", \"é€šè¿‡å‘å¸ƒç¤¾åŒºå¸–å­è·å¾—ç§¯åˆ†ï¼Œå…·ä½“è§„åˆ™å¦‚ä¸‹ï¼š\")}\r\n          </p>\r\n          <ul className=\"space-y-3\">\r\n            {/* ç§¯åˆ†æ•°é‡ */}\r\n            <li className=\"flex items-start gap-2 text-sm\">\r\n              <CheckCircle className=\"h-4 w-4 text-green-500 mt-0.5 shrink-0\" />\r\n              <span>{t(\"community.rulePostPoints\", { points: postPoints })}</span>\r\n            </li>\r\n            {/* æœ€å°é•¿åº¦ */}\r\n            <li className=\"flex items-start gap-2 text-sm\">\r\n              <CheckCircle className=\"h-4 w-4 text-green-500 mt-0.5 shrink-0\" />\r\n              <span>{t(\"community.ruleMinLength\", { length: minLength })}</span>\r\n            </li>\r\n            {/* åª’ä½“è¦æ±‚ */}\r\n            {requireMedia && (\r\n              <li className=\"flex items-start gap-2 text-sm\">\r\n                <CheckCircle className=\"h-4 w-4 text-green-500 mt-0.5 shrink-0\" />\r\n                <span>{t(\"community.ruleRequireMedia\", \"å¸–å­å¿…é¡»åŒ…å«è‡³å°‘ä¸€å¼ å›¾ç‰‡æˆ–ä¸€ä¸ªè§†é¢‘\")}</span>\r\n              </li>\r\n            )}\r\n            {/* æ¯æ—¥é™åˆ¶ */}\r\n            <li className=\"flex items-start gap-2 text-sm\">\r\n              <Clock className=\"h-4 w-4 text-blue-500 mt-0.5 shrink-0\" />\r\n              <span>{t(\"community.ruleDailyLimit\", \"æ¯å¤©ä»…å¯é€šè¿‡å‘å¸–è·å¾—ä¸€æ¬¡ç§¯åˆ†å¥–åŠ±\")}</span>\r\n            </li>\r\n            {/* å®¡æ ¸è¦æ±‚ */}\r\n            <li className=\"flex items-start gap-2 text-sm\">\r\n              <Shield className=\"h-4 w-4 text-purple-500 mt-0.5 shrink-0\" />\r\n              <span>{t(\"community.ruleModerationRequired\", \"å¸–å­éœ€é€šè¿‡å®¡æ ¸åæ‰èƒ½è·å¾—ç§¯åˆ†\")}</span>\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default PostPointsRulesDialog;\r\n","import { useState, useEffect } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Check, ChevronsUpDown, MapPin, Search, X } from \"lucide-react\";\r\nimport { useIsMobile } from \"@/hooks/use-mobile\";\r\nimport { useLocalizedContent } from \"@/hooks/useLocalizedContent\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport {\r\n  Drawer,\r\n  DrawerContent,\r\n  DrawerHeader,\r\n  DrawerTitle,\r\n  DrawerFooter,\r\n} from \"@/components/ui/drawer\";\r\nimport {\r\n  Popover,\r\n  PopoverContent,\r\n  PopoverTrigger,\r\n} from \"@/components/ui/popover\";\r\n\r\ninterface Restaurant {\r\n  id: string;\r\n  name?: string;\r\n  name_zh?: string;\r\n  name_en?: string;\r\n  name_pt?: string;\r\n  address?: string;\r\n  type?: string | string[];\r\n}\r\n\r\ninterface MultiRestaurantSelectDrawerProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  value: string[];\r\n  onSelect: (restaurantIds: string[]) => void;\r\n  restaurants: Restaurant[];\r\n  required?: boolean;\r\n  maxDisplay?: number;\r\n}\r\n\r\nconst MultiRestaurantSelectDrawer = ({\r\n  open,\r\n  onOpenChange,\r\n  value,\r\n  onSelect,\r\n  restaurants,\r\n  required = false,\r\n  maxDisplay = 2,\r\n}: MultiRestaurantSelectDrawerProps) => {\r\n  const { t } = useTranslation();\r\n  const { getLocalizedField } = useLocalizedContent();\r\n  const isMobile = useIsMobile();\r\n  const [search, setSearch] = useState(\"\");\r\n  const [pendingValue, setPendingValue] = useState<string[]>(value);\r\n  const [drawerHeight, setDrawerHeight] = useState<string>('85vh');\r\n\r\n  // Monitor visualViewport to dynamically adjust drawer height\r\n  useEffect(() => {\r\n    if (!open || !isMobile) return;\r\n    \r\n    const viewport = window.visualViewport;\r\n    if (!viewport) {\r\n      setDrawerHeight('85vh');\r\n      return;\r\n    }\r\n    \r\n    const updateHeight = () => {\r\n      const availableHeight = viewport.height;\r\n      const targetHeight = Math.min(availableHeight * 0.85, availableHeight - 50);\r\n      setDrawerHeight(`${targetHeight}px`);\r\n    };\r\n    \r\n    updateHeight();\r\n    viewport.addEventListener('resize', updateHeight);\r\n    \r\n    return () => {\r\n      viewport.removeEventListener('resize', updateHeight);\r\n    };\r\n  }, [open, isMobile]);\r\n\r\n  // Reset pending value when drawer opens\r\n  const handleOpenChange = (newOpen: boolean) => {\r\n    if (newOpen) {\r\n      setPendingValue(value);\r\n      setSearch(\"\");\r\n    }\r\n    onOpenChange(newOpen);\r\n  };\r\n\r\n  // Filter restaurants based on search\r\n  const filteredRestaurants = restaurants?.filter((r) => {\r\n    if (!search) return true;\r\n    const name = getLocalizedField(r, \"name\")?.toLowerCase() || \"\";\r\n    const address = r.address?.toLowerCase() || \"\";\r\n    const searchLower = search.toLowerCase();\r\n    return name.includes(searchLower) || address.includes(searchLower);\r\n  }) || [];\r\n\r\n  // Toggle restaurant selection\r\n  const toggleRestaurant = (restaurantId: string) => {\r\n    setPendingValue((prev) => {\r\n      if (prev.includes(restaurantId)) {\r\n        return prev.filter((id) => id !== restaurantId);\r\n      }\r\n      return [...prev, restaurantId];\r\n    });\r\n  };\r\n\r\n  // Handle confirm (mobile only)\r\n  const handleConfirm = () => {\r\n    onSelect(pendingValue);\r\n    onOpenChange(false);\r\n    setSearch(\"\");\r\n  };\r\n\r\n  // Handle toggle (desktop - immediate)\r\n  const handleDesktopToggle = (restaurantId: string) => {\r\n    const newValue = value.includes(restaurantId)\r\n      ? value.filter((id) => id !== restaurantId)\r\n      : [...value, restaurantId];\r\n    onSelect(newValue);\r\n  };\r\n\r\n  // Get selected restaurant names\r\n  const getSelectedNames = () => {\r\n    return value\r\n      .map((id) => {\r\n        const restaurant = restaurants?.find((r) => r.id === id);\r\n        return restaurant ? getLocalizedField(restaurant, \"name\") : null;\r\n      })\r\n      .filter(Boolean) as string[];\r\n  };\r\n\r\n  const selectedNames = getSelectedNames();\r\n\r\n  // Trigger button content\r\n  const TriggerContent = () => {\r\n    if (selectedNames.length === 0) {\r\n      return (\r\n        <span className=\"text-muted-foreground\">\r\n          {t(\"community.linkRestaurants\", \"å…³è”é¤å…\")}\r\n          {required && <span className=\"text-destructive ml-1\">*</span>}\r\n        </span>\r\n      );\r\n    }\r\n\r\n    const displayNames = selectedNames.slice(0, maxDisplay);\r\n    const remaining = selectedNames.length - maxDisplay;\r\n\r\n    return (\r\n      <span className=\"text-primary flex items-center gap-1 flex-wrap\">\r\n        {displayNames.map((name, i) => (\r\n          <span key={i}>\r\n            {name}{i < displayNames.length - 1 ? \"ã€\" : \"\"}\r\n          </span>\r\n        ))}\r\n        {remaining > 0 && (\r\n          <Badge variant=\"secondary\" className=\"text-xs px-1.5 py-0\">\r\n            +{remaining}\r\n          </Badge>\r\n        )}\r\n      </span>\r\n    );\r\n  };\r\n\r\n  // Trigger button\r\n  const triggerButton = (\r\n    <button\r\n      type=\"button\"\r\n      className=\"flex items-center gap-1 text-sm hover:text-primary transition-colors text-left\"\r\n      onClick={() => handleOpenChange(true)}\r\n    >\r\n      <TriggerContent />\r\n      <ChevronsUpDown className=\"h-4 w-4 opacity-50 shrink-0\" />\r\n    </button>\r\n  );\r\n\r\n  // Restaurant item component\r\n  const RestaurantItem = ({\r\n    restaurant,\r\n    isSelected,\r\n    onToggle,\r\n  }: {\r\n    restaurant: Restaurant;\r\n    isSelected: boolean;\r\n    onToggle: () => void;\r\n  }) => (\r\n    <div\r\n      className={cn(\r\n        \"flex items-start gap-3 py-3 px-3 rounded-lg cursor-pointer transition-colors\",\r\n        isSelected ? \"bg-primary/10\" : \"hover:bg-muted\"\r\n      )}\r\n      onClick={onToggle}\r\n    >\r\n      <div className={cn(\r\n        \"h-5 w-5 shrink-0 mt-0.5 rounded border flex items-center justify-center transition-colors\",\r\n        isSelected ? \"bg-primary border-primary\" : \"border-muted-foreground/30\"\r\n      )}>\r\n        {isSelected && <Check className=\"h-3 w-3 text-primary-foreground\" />}\r\n      </div>\r\n      <div className=\"flex-1 min-w-0\">\r\n        <p className=\"font-medium truncate\">\r\n          {getLocalizedField(restaurant, \"name\")}\r\n        </p>\r\n        {restaurant.address && (\r\n          <p className=\"text-sm text-muted-foreground truncate flex items-center gap-1 mt-0.5\">\r\n            <MapPin className=\"h-3 w-3 shrink-0\" />\r\n            {restaurant.address}\r\n          </p>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  // Mobile: Full-screen Drawer\r\n  if (isMobile) {\r\n    return (\r\n      <>\r\n        {triggerButton}\r\n        <Drawer open={open} onOpenChange={handleOpenChange}>\r\n          <DrawerContent \r\n            className=\"flex flex-col\"\r\n            style={{ \r\n              height: drawerHeight,\r\n              maxHeight: drawerHeight,\r\n              transition: 'height 0.15s ease-out, max-height 0.15s ease-out'\r\n            }}\r\n          >\r\n            <DrawerHeader className=\"pb-2 shrink-0\">\r\n              <DrawerTitle>\r\n                {t(\"community.selectRestaurants\", \"é€‰æ‹©é¤å…\")}\r\n                {pendingValue.length > 0 && (\r\n                  <Badge variant=\"secondary\" className=\"ml-2\">\r\n                    {pendingValue.length}\r\n                  </Badge>\r\n                )}\r\n              </DrawerTitle>\r\n            </DrawerHeader>\r\n\r\n            {/* Search Input */}\r\n            <div className=\"px-4 pb-3 shrink-0\">\r\n              <div className=\"relative\">\r\n                <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\r\n                <Input\r\n                  placeholder={t(\"community.searchRestaurant\", \"æœç´¢é¤å…...\")}\r\n                  value={search}\r\n                  onChange={(e) => setSearch(e.target.value)}\r\n                  className=\"pl-9\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Selected Preview */}\r\n            {pendingValue.length > 0 && (\r\n              <div className=\"px-4 pb-3 shrink-0\">\r\n                <div className=\"flex flex-wrap gap-1.5\">\r\n                  {pendingValue.map((id) => {\r\n                    const restaurant = restaurants?.find((r) => r.id === id);\r\n                    if (!restaurant) return null;\r\n                    return (\r\n                      <Badge\r\n                        key={id}\r\n                        variant=\"secondary\"\r\n                        className=\"gap-1 pr-1\"\r\n                      >\r\n                        <span className=\"truncate max-w-[120px]\">\r\n                          {getLocalizedField(restaurant, \"name\")}\r\n                        </span>\r\n                        <button\r\n                          type=\"button\"\r\n                          className=\"hover:bg-muted-foreground/20 rounded-full p-0.5\"\r\n                          onClick={(e) => {\r\n                            e.stopPropagation();\r\n                            setPendingValue((prev) => prev.filter((i) => i !== id));\r\n                          }}\r\n                        >\r\n                          <X className=\"h-3 w-3\" />\r\n                        </button>\r\n                      </Badge>\r\n                    );\r\n                  })}\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Restaurant List */}\r\n            <div className=\"flex-1 overflow-y-auto px-4 min-h-0\">\r\n              <div className=\"space-y-1 pb-4\">\r\n                {filteredRestaurants.map((restaurant) => (\r\n                  <RestaurantItem\r\n                    key={restaurant.id}\r\n                    restaurant={restaurant}\r\n                    isSelected={pendingValue.includes(restaurant.id)}\r\n                    onToggle={() => toggleRestaurant(restaurant.id)}\r\n                  />\r\n                ))}\r\n\r\n                {filteredRestaurants.length === 0 && search && (\r\n                  <div className=\"py-6 text-center text-muted-foreground\">\r\n                    {t(\"community.noRestaurantFound\", \"æœªæ‰¾åˆ°åŒ¹é…çš„é¤å…\")}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Footer Buttons */}\r\n            <DrawerFooter className=\"pt-2\">\r\n              <div className=\"flex gap-3\">\r\n                <Button\r\n                  variant=\"outline\"\r\n                  className=\"flex-1\"\r\n                  onClick={() => handleOpenChange(false)}\r\n                >\r\n                  {t(\"common.cancel\", \"å–æ¶ˆ\")}\r\n                </Button>\r\n                <Button className=\"flex-1\" onClick={handleConfirm}>\r\n                  {t(\"community.confirmSelection\", \"ç¡®è®¤é€‰æ‹©\")}\r\n                  {pendingValue.length > 0 && ` (${pendingValue.length})`}\r\n                </Button>\r\n              </div>\r\n            </DrawerFooter>\r\n          </DrawerContent>\r\n        </Drawer>\r\n      </>\r\n    );\r\n  }\r\n\r\n  // Desktop: Popover\r\n  return (\r\n    <Popover open={open} onOpenChange={handleOpenChange}>\r\n      <PopoverTrigger asChild>{triggerButton}</PopoverTrigger>\r\n      <PopoverContent className=\"w-80 p-0\" align=\"start\">\r\n        <div className=\"p-3 border-b\">\r\n          <div className=\"relative\">\r\n            <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\r\n            <Input\r\n              placeholder={t(\"community.searchRestaurant\", \"æœç´¢é¤å…...\")}\r\n              value={search}\r\n              onChange={(e) => setSearch(e.target.value)}\r\n              className=\"pl-9\"\r\n            />\r\n          </div>\r\n        </div>\r\n        \r\n        {/* Selected Preview */}\r\n        {value.length > 0 && (\r\n          <div className=\"p-3 border-b\">\r\n            <div className=\"flex flex-wrap gap-1.5\">\r\n              {value.map((id) => {\r\n                const restaurant = restaurants?.find((r) => r.id === id);\r\n                if (!restaurant) return null;\r\n                return (\r\n                  <Badge\r\n                    key={id}\r\n                    variant=\"secondary\"\r\n                    className=\"gap-1 pr-1\"\r\n                  >\r\n                    <span className=\"truncate max-w-[100px]\">\r\n                      {getLocalizedField(restaurant, \"name\")}\r\n                    </span>\r\n                    <button\r\n                      type=\"button\"\r\n                      className=\"hover:bg-muted-foreground/20 rounded-full p-0.5\"\r\n                      onClick={(e) => {\r\n                        e.stopPropagation();\r\n                        handleDesktopToggle(id);\r\n                      }}\r\n                    >\r\n                      <X className=\"h-3 w-3\" />\r\n                    </button>\r\n                  </Badge>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"max-h-64 overflow-y-auto p-2\">\r\n          {filteredRestaurants.map((restaurant) => (\r\n            <RestaurantItem\r\n              key={restaurant.id}\r\n              restaurant={restaurant}\r\n              isSelected={value.includes(restaurant.id)}\r\n              onToggle={() => handleDesktopToggle(restaurant.id)}\r\n            />\r\n          ))}\r\n          \r\n          {filteredRestaurants.length === 0 && search && (\r\n            <div className=\"py-4 text-center text-muted-foreground text-sm\">\r\n              {t(\"community.noRestaurantFound\", \"æœªæ‰¾åˆ°åŒ¹é…çš„é¤å…\")}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </PopoverContent>\r\n    </Popover>\r\n  );\r\n};\r\n\r\nexport default MultiRestaurantSelectDrawer;\r\n","import * as React from \"react\";\r\nimport { type DialogProps } from \"@radix-ui/react-dialog\";\r\nimport { Command as CommandPrimitive } from \"cmdk\";\r\nimport { Search } from \"lucide-react\";\r\n\r\nimport { cn } from \"@/lib/utils\";\r\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\";\r\n\r\nconst Command = React.forwardRef<\r\n  React.ElementRef<typeof CommandPrimitive>,\r\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\r\n>(({ className, ...props }, ref) => (\r\n  <CommandPrimitive\r\n    ref={ref}\r\n    className={cn(\r\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\r\n      className,\r\n    )}\r\n    {...props}\r\n  />\r\n));\r\nCommand.displayName = CommandPrimitive.displayName;\r\n\r\ninterface CommandDialogProps extends DialogProps {}\r\n\r\nconst CommandDialog = ({ children, ...props }: CommandDialogProps) => {\r\n  return (\r\n    <Dialog {...props}>\r\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\r\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\r\n          {children}\r\n        </Command>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nconst CommandInput = React.forwardRef<\r\n  React.ElementRef<typeof CommandPrimitive.Input>,\r\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\r\n>(({ className, ...props }, ref) => (\r\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\r\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\r\n    <CommandPrimitive.Input\r\n      ref={ref}\r\n      className={cn(\r\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  </div>\r\n));\r\n\r\nCommandInput.displayName = CommandPrimitive.Input.displayName;\r\n\r\nconst CommandList = React.forwardRef<\r\n  React.ElementRef<typeof CommandPrimitive.List>,\r\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\r\n>(({ className, ...props }, ref) => (\r\n  <CommandPrimitive.List\r\n    ref={ref}\r\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\r\n    {...props}\r\n  />\r\n));\r\n\r\nCommandList.displayName = CommandPrimitive.List.displayName;\r\n\r\nconst CommandEmpty = React.forwardRef<\r\n  React.ElementRef<typeof CommandPrimitive.Empty>,\r\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\r\n>((props, ref) => <CommandPrimitive.Empty ref={ref} className=\"py-6 text-center text-sm\" {...props} />);\r\n\r\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName;\r\n\r\nconst CommandGroup = React.forwardRef<\r\n  React.ElementRef<typeof CommandPrimitive.Group>,\r\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\r\n>(({ className, ...props }, ref) => (\r\n  <CommandPrimitive.Group\r\n    ref={ref}\r\n    className={cn(\r\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\r\n      className,\r\n    )}\r\n    {...props}\r\n  />\r\n));\r\n\r\nCommandGroup.displayName = CommandPrimitive.Group.displayName;\r\n\r\nconst CommandSeparator = React.forwardRef<\r\n  React.ElementRef<typeof CommandPrimitive.Separator>,\r\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\r\n>(({ className, ...props }, ref) => (\r\n  <CommandPrimitive.Separator ref={ref} className={cn(\"-mx-1 h-px bg-border\", className)} {...props} />\r\n));\r\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName;\r\n\r\nconst CommandItem = React.forwardRef<\r\n  React.ElementRef<typeof CommandPrimitive.Item>,\r\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\r\n>(({ className, ...props }, ref) => (\r\n  <CommandPrimitive.Item\r\n    ref={ref}\r\n    className={cn(\r\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50\",\r\n      className,\r\n    )}\r\n    {...props}\r\n  />\r\n));\r\n\r\nCommandItem.displayName = CommandPrimitive.Item.displayName;\r\n\r\nconst CommandShortcut = ({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) => {\r\n  return <span className={cn(\"ml-auto text-xs tracking-widest text-muted-foreground\", className)} {...props} />;\r\n};\r\nCommandShortcut.displayName = \"CommandShortcut\";\r\n\r\nexport {\r\n  Command,\r\n  CommandDialog,\r\n  CommandInput,\r\n  CommandList,\r\n  CommandEmpty,\r\n  CommandGroup,\r\n  CommandItem,\r\n  CommandShortcut,\r\n  CommandSeparator,\r\n};\r\n","import { useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Check, ChevronsUpDown, Calendar } from \"lucide-react\";\r\nimport { useIsMobile } from \"@/hooks/use-mobile\";\r\nimport { useLocalizedContent } from \"@/hooks/useLocalizedContent\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\r\nimport {\r\n  Drawer,\r\n  DrawerContent,\r\n  DrawerHeader,\r\n  DrawerTitle,\r\n  DrawerFooter,\r\n} from \"@/components/ui/drawer\";\r\nimport {\r\n  Popover,\r\n  PopoverContent,\r\n  PopoverTrigger,\r\n} from \"@/components/ui/popover\";\r\nimport {\r\n  Command,\r\n  CommandGroup,\r\n  CommandItem,\r\n  CommandList,\r\n} from \"@/components/ui/command\";\r\n\r\ninterface Activity {\r\n  id: string;\r\n  title_zh?: string;\r\n  title_en?: string;\r\n  title_pt?: string;\r\n  status?: string;\r\n}\r\n\r\ninterface ActivitySelectDrawerProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  value: string;\r\n  onSelect: (activityId: string) => void;\r\n  activities: Activity[];\r\n}\r\n\r\nconst ActivitySelectDrawer = ({\r\n  open,\r\n  onOpenChange,\r\n  value,\r\n  onSelect,\r\n  activities,\r\n}: ActivitySelectDrawerProps) => {\r\n  const { t } = useTranslation();\r\n  const { getLocalizedField } = useLocalizedContent();\r\n  const isMobile = useIsMobile();\r\n  const [pendingValue, setPendingValue] = useState(value);\r\n\r\n  // Reset pending value when drawer opens\r\n  const handleOpenChange = (newOpen: boolean) => {\r\n    if (newOpen) {\r\n      setPendingValue(value);\r\n    }\r\n    onOpenChange(newOpen);\r\n  };\r\n\r\n  // Get selected activity name\r\n  const getSelectedName = () => {\r\n    if (!value) return \"\";\r\n    const selected = activities?.find((a) => a.id === value);\r\n    return selected ? getLocalizedField(selected, \"title\") : \"\";\r\n  };\r\n\r\n  // Handle confirm (mobile only)\r\n  const handleConfirm = () => {\r\n    onSelect(pendingValue);\r\n    onOpenChange(false);\r\n  };\r\n\r\n  // Handle select (desktop - immediate)\r\n  const handleDesktopSelect = (activityId: string) => {\r\n    onSelect(activityId);\r\n    onOpenChange(false);\r\n  };\r\n\r\n  // Trigger button\r\n  const triggerButton = (\r\n    <button\r\n      type=\"button\"\r\n      className=\"flex items-center gap-1 text-sm hover:text-primary transition-colors\"\r\n      onClick={() => handleOpenChange(true)}\r\n    >\r\n      {value ? (\r\n        <span className=\"text-primary\">{getSelectedName()}</span>\r\n      ) : (\r\n        <span className=\"text-muted-foreground\">\r\n          {t(\"community.linkActivity\", \"å…³è”æ´»åŠ¨\")}\r\n        </span>\r\n      )}\r\n      <ChevronsUpDown className=\"h-4 w-4 opacity-50\" />\r\n    </button>\r\n  );\r\n\r\n  // Mobile: Full-screen Drawer\r\n  if (isMobile) {\r\n    return (\r\n      <>\r\n        {triggerButton}\r\n        <Drawer open={open} onOpenChange={handleOpenChange}>\r\n          <DrawerContent className=\"max-h-[85vh] flex flex-col\">\r\n            <DrawerHeader className=\"pb-2\">\r\n              <DrawerTitle>{t(\"community.selectActivity\", \"é€‰æ‹©æ´»åŠ¨\")}</DrawerTitle>\r\n            </DrawerHeader>\r\n\r\n            {/* Activity List */}\r\n            <ScrollArea className=\"flex-1 px-4\">\r\n              <div className=\"space-y-1 pb-4\">\r\n                {/* None option */}\r\n                <div\r\n                  className={cn(\r\n                    \"flex items-center gap-3 py-3 px-3 rounded-lg cursor-pointer transition-colors\",\r\n                    pendingValue === \"\" ? \"bg-primary/10\" : \"hover:bg-muted\"\r\n                  )}\r\n                  onClick={() => setPendingValue(\"\")}\r\n                >\r\n                  <Check\r\n                    className={cn(\r\n                      \"h-4 w-4 shrink-0\",\r\n                      pendingValue === \"\" ? \"opacity-100 text-primary\" : \"opacity-0\"\r\n                    )}\r\n                  />\r\n                  <span className=\"text-muted-foreground\">\r\n                    {t(\"community.noActivity\", \"ä¸å…³è”æ´»åŠ¨\")}\r\n                  </span>\r\n                </div>\r\n\r\n                {/* Activity items */}\r\n                {activities.map((activity) => (\r\n                  <div\r\n                    key={activity.id}\r\n                    className={cn(\r\n                      \"flex items-center gap-3 py-3 px-3 rounded-lg cursor-pointer transition-colors\",\r\n                      pendingValue === activity.id ? \"bg-primary/10\" : \"hover:bg-muted\"\r\n                    )}\r\n                    onClick={() => setPendingValue(activity.id)}\r\n                  >\r\n                    <Check\r\n                      className={cn(\r\n                        \"h-4 w-4 shrink-0\",\r\n                        pendingValue === activity.id ? \"opacity-100 text-primary\" : \"opacity-0\"\r\n                      )}\r\n                    />\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <Calendar className=\"h-4 w-4 text-muted-foreground shrink-0\" />\r\n                      <span className=\"font-medium\">\r\n                        {getLocalizedField(activity, \"title\")}\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n\r\n                {activities.length === 0 && (\r\n                  <div className=\"py-6 text-center text-muted-foreground\">\r\n                    {t(\"activities.noActivities\", \"æš‚æ— å¯ç”¨æ´»åŠ¨\")}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </ScrollArea>\r\n\r\n            {/* Footer Buttons */}\r\n            <DrawerFooter className=\"pt-2\">\r\n              <div className=\"flex gap-3\">\r\n                <Button\r\n                  variant=\"outline\"\r\n                  className=\"flex-1\"\r\n                  onClick={() => handleOpenChange(false)}\r\n                >\r\n                  {t(\"common.cancel\", \"å–æ¶ˆ\")}\r\n                </Button>\r\n                <Button className=\"flex-1\" onClick={handleConfirm}>\r\n                  {t(\"community.confirmSelection\", \"ç¡®è®¤é€‰æ‹©\")}\r\n                </Button>\r\n              </div>\r\n            </DrawerFooter>\r\n          </DrawerContent>\r\n        </Drawer>\r\n      </>\r\n    );\r\n  }\r\n\r\n  // Desktop: Popover with Command\r\n  return (\r\n    <Popover open={open} onOpenChange={handleOpenChange}>\r\n      <PopoverTrigger asChild>{triggerButton}</PopoverTrigger>\r\n      <PopoverContent className=\"w-72 p-0\" align=\"start\">\r\n        <Command>\r\n          <CommandList>\r\n            <CommandGroup>\r\n              <CommandItem\r\n                value=\"none\"\r\n                onSelect={() => handleDesktopSelect(\"\")}\r\n              >\r\n                <Check\r\n                  className={cn(\r\n                    \"mr-2 h-4 w-4\",\r\n                    !value ? \"opacity-100\" : \"opacity-0\"\r\n                  )}\r\n                />\r\n                {t(\"community.noActivity\", \"ä¸å…³è”æ´»åŠ¨\")}\r\n              </CommandItem>\r\n              {activities.map((activity) => (\r\n                <CommandItem\r\n                  key={activity.id}\r\n                  value={activity.id}\r\n                  onSelect={() => handleDesktopSelect(activity.id)}\r\n                >\r\n                  <Check\r\n                    className={cn(\r\n                      \"mr-2 h-4 w-4\",\r\n                      value === activity.id ? \"opacity-100\" : \"opacity-0\"\r\n                    )}\r\n                  />\r\n                  {getLocalizedField(activity, \"title\")}\r\n                </CommandItem>\r\n              ))}\r\n            </CommandGroup>\r\n          </CommandList>\r\n        </Command>\r\n      </PopoverContent>\r\n    </Popover>\r\n  );\r\n};\r\n\r\nexport default ActivitySelectDrawer;\r\n","import { useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Smile } from \"lucide-react\";\r\nimport { useIsMobile } from \"@/hooks/use-mobile\";\r\nimport {\r\n  Popover,\r\n  PopoverContent,\r\n  PopoverTrigger,\r\n} from \"@/components/ui/popover\";\r\nimport {\r\n  Drawer,\r\n  DrawerContent,\r\n  DrawerHeader,\r\n  DrawerTitle,\r\n} from \"@/components/ui/drawer\";\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\r\n\r\ninterface EmojiPickerProps {\r\n  onSelect: (emoji: string) => void;\r\n}\r\n\r\n// Common emoji categories\r\nconst emojiCategories = [\r\n  {\r\n    name: \"smileys\",\r\n    emojis: [\"ğŸ˜€\", \"ğŸ˜ƒ\", \"ğŸ˜„\", \"ğŸ˜\", \"ğŸ˜†\", \"ğŸ˜…\", \"ğŸ¤£\", \"ğŸ˜‚\", \"ğŸ™‚\", \"ğŸ˜Š\", \"ğŸ˜‡\", \"ğŸ¥°\", \"ğŸ˜\", \"ğŸ¤©\", \"ğŸ˜˜\", \"ğŸ˜—\", \"ğŸ˜š\", \"ğŸ˜‹\", \"ğŸ˜›\", \"ğŸ˜œ\", \"ğŸ¤ª\", \"ğŸ˜\", \"ğŸ¤‘\", \"ğŸ¤—\", \"ğŸ¤­\", \"ğŸ¤«\", \"ğŸ¤”\", \"ğŸ¤\", \"ğŸ¤¨\", \"ğŸ˜\", \"ğŸ˜‘\", \"ğŸ˜¶\", \"ğŸ˜\", \"ğŸ˜’\", \"ğŸ™„\", \"ğŸ˜¬\", \"ğŸ¤¥\", \"ğŸ˜Œ\", \"ğŸ˜”\", \"ğŸ˜ª\", \"ğŸ¤¤\", \"ğŸ˜´\", \"ğŸ˜·\", \"ğŸ¤’\", \"ğŸ¤•\", \"ğŸ¤¢\", \"ğŸ¤®\", \"ğŸ¥µ\", \"ğŸ¥¶\", \"ğŸ¥´\", \"ğŸ˜µ\", \"ğŸ¤¯\", \"ğŸ¤ \", \"ğŸ¥³\", \"ğŸ˜\", \"ğŸ¤“\", \"ğŸ§\"],\r\n  },\r\n  {\r\n    name: \"gestures\",\r\n    emojis: [\"ğŸ‘\", \"ğŸ‘\", \"ğŸ‘Œ\", \"ğŸ¤Œ\", \"âœŒï¸\", \"ğŸ¤\", \"ğŸ¤Ÿ\", \"ğŸ¤˜\", \"ğŸ¤™\", \"ğŸ‘ˆ\", \"ğŸ‘‰\", \"ğŸ‘†\", \"ğŸ‘‡\", \"â˜ï¸\", \"âœ‹\", \"ğŸ¤š\", \"ğŸ–ï¸\", \"ğŸ––\", \"ğŸ‘‹\", \"ğŸ¤\", \"ğŸ™\", \"ğŸ’ª\", \"ğŸ¦¾\", \"ğŸ¦¿\", \"ğŸ¦µ\", \"ğŸ¦¶\", \"ğŸ‘‚\", \"ğŸ¦»\", \"ğŸ‘ƒ\", \"ğŸ§ \", \"ğŸ‘€\", \"ğŸ‘ï¸\", \"ğŸ‘…\", \"ğŸ‘„\"],\r\n  },\r\n  {\r\n    name: \"food\",\r\n    emojis: [\"ğŸ\", \"ğŸ\", \"ğŸ\", \"ğŸŠ\", \"ğŸ‹\", \"ğŸŒ\", \"ğŸ‰\", \"ğŸ‡\", \"ğŸ“\", \"ğŸ«\", \"ğŸˆ\", \"ğŸ’\", \"ğŸ‘\", \"ğŸ¥­\", \"ğŸ\", \"ğŸ¥¥\", \"ğŸ¥\", \"ğŸ…\", \"ğŸ†\", \"ğŸ¥‘\", \"ğŸ¥¦\", \"ğŸ¥¬\", \"ğŸ¥’\", \"ğŸŒ¶ï¸\", \"ğŸ«‘\", \"ğŸŒ½\", \"ğŸ¥•\", \"ğŸ§„\", \"ğŸ§…\", \"ğŸ¥”\", \"ğŸ \", \"ğŸ¥\", \"ğŸ¥¯\", \"ğŸ\", \"ğŸ¥–\", \"ğŸ¥¨\", \"ğŸ§€\", \"ğŸ¥š\", \"ğŸ³\", \"ğŸ§ˆ\", \"ğŸ¥\", \"ğŸ§‡\", \"ğŸ¥“\", \"ğŸ¥©\", \"ğŸ—\", \"ğŸ–\", \"ğŸ¦´\", \"ğŸŒ­\", \"ğŸ”\", \"ğŸŸ\", \"ğŸ•\", \"ğŸ«“\", \"ğŸ¥ª\", \"ğŸ¥™\", \"ğŸ§†\", \"ğŸŒ®\", \"ğŸŒ¯\", \"ğŸ«”\", \"ğŸ¥—\", \"ğŸ¥˜\", \"ğŸ«•\", \"ğŸ¥«\", \"ğŸ\", \"ğŸœ\", \"ğŸ²\", \"ğŸ›\", \"ğŸ£\", \"ğŸ±\", \"ğŸ¥Ÿ\", \"ğŸ¦ª\", \"ğŸ¤\", \"ğŸ™\", \"ğŸš\", \"ğŸ˜\", \"ğŸ¥\", \"ğŸ¥ \", \"ğŸ¥®\", \"ğŸ¢\", \"ğŸ¡\", \"ğŸ§\", \"ğŸ¨\", \"ğŸ¦\", \"ğŸ¥§\", \"ğŸ§\", \"ğŸ°\", \"ğŸ‚\", \"ğŸ®\", \"ğŸ­\", \"ğŸ¬\", \"ğŸ«\", \"ğŸ¿\", \"ğŸ©\", \"ğŸª\"],\r\n  },\r\n  {\r\n    name: \"hearts\",\r\n    emojis: [\"â¤ï¸\", \"ğŸ§¡\", \"ğŸ’›\", \"ğŸ’š\", \"ğŸ’™\", \"ğŸ’œ\", \"ğŸ–¤\", \"ğŸ¤\", \"ğŸ¤\", \"ğŸ’”\", \"â£ï¸\", \"ğŸ’•\", \"ğŸ’\", \"ğŸ’“\", \"ğŸ’—\", \"ğŸ’–\", \"ğŸ’˜\", \"ğŸ’\", \"ğŸ’Ÿ\", \"â™¥ï¸\"],\r\n  },\r\n  {\r\n    name: \"objects\",\r\n    emojis: [\"â­\", \"ğŸŒŸ\", \"âœ¨\", \"ğŸ’«\", \"ğŸ”¥\", \"ğŸ’¯\", \"ğŸ‰\", \"ğŸŠ\", \"ğŸˆ\", \"ğŸ\", \"ğŸ†\", \"ğŸ¥‡\", \"ğŸ¥ˆ\", \"ğŸ¥‰\", \"âš½\", \"ğŸ€\", \"ğŸˆ\", \"âš¾\", \"ğŸ¾\", \"ğŸ\", \"ğŸ±\", \"ğŸ“\", \"ğŸ®\", \"ğŸ²\", \"ğŸ§©\", \"ğŸ­\", \"ğŸ¨\", \"ğŸ¬\", \"ğŸ¤\", \"ğŸ§\", \"ğŸµ\", \"ğŸ¶\", \"ğŸ¹\", \"ğŸ¸\", \"ğŸº\", \"ğŸ»\", \"ğŸ“·\", \"ğŸ“¸\", \"ğŸ“¹\", \"ğŸ¥\", \"ğŸ“±\", \"ğŸ’»\", \"âŒ¨ï¸\", \"ğŸ–¥ï¸\", \"ğŸ“º\", \"ğŸ“»\", \"â°\", \"âŒš\", \"ğŸ’¡\", \"ğŸ”¦\", \"ğŸ“š\", \"ğŸ“–\", \"âœï¸\", \"ğŸ“\", \"ğŸ’°\", \"ğŸ’µ\", \"ğŸ’´\", \"ğŸ’¶\", \"ğŸ’·\", \"ğŸ’³\", \"ğŸ›’\", \"ğŸ€\", \"ğŸ—ï¸\"],\r\n  },\r\n  {\r\n    name: \"nature\",\r\n    emojis: [\"ğŸŒ¸\", \"ğŸ’®\", \"ğŸµï¸\", \"ğŸŒ¹\", \"ğŸ¥€\", \"ğŸŒº\", \"ğŸŒ»\", \"ğŸŒ¼\", \"ğŸŒ·\", \"ğŸŒ±\", \"ğŸª´\", \"ğŸŒ²\", \"ğŸŒ³\", \"ğŸŒ´\", \"ğŸŒµ\", \"ğŸŒ¾\", \"ğŸŒ¿\", \"â˜˜ï¸\", \"ğŸ€\", \"ğŸ\", \"ğŸ‚\", \"ğŸƒ\", \"ğŸŒ\", \"ğŸŒ\", \"ğŸŒ\", \"ğŸŒ™\", \"â­\", \"â˜€ï¸\", \"ğŸŒ¤ï¸\", \"â›…\", \"ğŸŒ¥ï¸\", \"â˜ï¸\", \"ğŸŒ¦ï¸\", \"ğŸŒ§ï¸\", \"â›ˆï¸\", \"ğŸŒ©ï¸\", \"ğŸŒ¨ï¸\", \"â„ï¸\", \"â˜ƒï¸\", \"â›„\", \"ğŸŒ¬ï¸\", \"ğŸ’¨\", \"ğŸŒŠ\", \"ğŸ’§\", \"ğŸ’¦\", \"â˜”\", \"ğŸŒˆ\"],\r\n  },\r\n];\r\n\r\nconst EmojiPicker = ({ onSelect }: EmojiPickerProps) => {\r\n  const { t } = useTranslation();\r\n  const isMobile = useIsMobile();\r\n  const [open, setOpen] = useState(false);\r\n  const [activeCategory, setActiveCategory] = useState(0);\r\n\r\n  const handleSelect = (emoji: string) => {\r\n    onSelect(emoji);\r\n    if (!isMobile) {\r\n      setOpen(false);\r\n    }\r\n  };\r\n\r\n  const categoryLabels: Record<string, string> = {\r\n    smileys: t(\"emoji.smileys\", \"è¡¨æƒ…\"),\r\n    gestures: t(\"emoji.gestures\", \"æ‰‹åŠ¿\"),\r\n    food: t(\"emoji.food\", \"ç¾é£Ÿ\"),\r\n    hearts: t(\"emoji.hearts\", \"çˆ±å¿ƒ\"),\r\n    objects: t(\"emoji.objects\", \"ç‰©å“\"),\r\n    nature: t(\"emoji.nature\", \"è‡ªç„¶\"),\r\n  };\r\n\r\n  const emojiGrid = (\r\n    <div className=\"space-y-3\">\r\n      {/* Category tabs */}\r\n      <div className=\"flex gap-1 overflow-x-auto pb-2 border-b\">\r\n        {emojiCategories.map((category, index) => (\r\n          <button\r\n            key={category.name}\r\n            type=\"button\"\r\n            onClick={() => setActiveCategory(index)}\r\n            className={`px-3 py-1.5 text-sm rounded-full whitespace-nowrap transition-colors ${\r\n              activeCategory === index\r\n                ? \"bg-primary text-primary-foreground\"\r\n                : \"bg-muted hover:bg-muted/80 text-muted-foreground\"\r\n            }`}\r\n          >\r\n            {categoryLabels[category.name]}\r\n          </button>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Emoji grid */}\r\n      <div className=\"grid grid-cols-8 gap-1\">\r\n        {emojiCategories[activeCategory].emojis.map((emoji, index) => (\r\n          <button\r\n            key={index}\r\n            type=\"button\"\r\n            onClick={() => handleSelect(emoji)}\r\n            className=\"w-9 h-9 flex items-center justify-center text-xl hover:bg-muted rounded-md transition-colors\"\r\n          >\r\n            {emoji}\r\n          </button>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const triggerButton = (\r\n    <button\r\n      type=\"button\"\r\n      onClick={() => setOpen(true)}\r\n      className=\"flex items-center gap-1.5 text-muted-foreground hover:text-foreground transition-colors\"\r\n    >\r\n      <Smile className=\"h-5 w-5\" />\r\n      <span className=\"text-sm\">{t(\"community.emoji\", \"è¡¨æƒ…\")}</span>\r\n    </button>\r\n  );\r\n\r\n  // Mobile: Drawer\r\n  if (isMobile) {\r\n    return (\r\n      <>\r\n        {triggerButton}\r\n        <Drawer open={open} onOpenChange={setOpen}>\r\n          <DrawerContent className=\"h-[50vh]\">\r\n            <DrawerHeader className=\"pb-2\">\r\n              <DrawerTitle>{t(\"emoji.title\", \"é€‰æ‹©è¡¨æƒ…\")}</DrawerTitle>\r\n            </DrawerHeader>\r\n            <ScrollArea className=\"flex-1 px-4 pb-4\">\r\n              {emojiGrid}\r\n            </ScrollArea>\r\n          </DrawerContent>\r\n        </Drawer>\r\n      </>\r\n    );\r\n  }\r\n\r\n  // Desktop: Popover\r\n  return (\r\n    <Popover open={open} onOpenChange={setOpen}>\r\n      <PopoverTrigger asChild>{triggerButton}</PopoverTrigger>\r\n      <PopoverContent className=\"w-80 p-3\" align=\"start\" side=\"top\">\r\n        {emojiGrid}\r\n      </PopoverContent>\r\n    </Popover>\r\n  );\r\n};\r\n\r\nexport default EmojiPicker;\r\n","import { useTranslation } from \"react-i18next\";\r\nimport { FileText, Utensils } from \"lucide-react\";\r\n\r\ninterface PostTypeSelectorProps {\r\n  onSelect: (type: 'post' | 'recipe') => void;\r\n}\r\n\r\nconst PostTypeSelector = ({ onSelect }: PostTypeSelectorProps) => {\r\n  const { t } = useTranslation();\r\n\r\n  return (\r\n    <div className=\"h-full flex flex-col items-center justify-center p-6\">\r\n      <h2 className=\"text-xl font-semibold mb-2\">\r\n        {t(\"community.selectPostType\", \"é€‰æ‹©å‘å¸ƒç±»å‹\")}\r\n      </h2>\r\n      <p className=\"text-muted-foreground text-sm mb-8 text-center\">\r\n        {t(\"community.selectPostTypeDesc\", \"é€‰æ‹©æ‚¨æƒ³è¦å‘å¸ƒçš„å†…å®¹ç±»å‹\")}\r\n      </p>\r\n\r\n      <div className=\"grid grid-cols-2 gap-4 w-full max-w-sm\">\r\n        {/* Regular Post */}\r\n        <button\r\n          onClick={() => onSelect('post')}\r\n          className=\"flex flex-col items-center gap-3 p-6 rounded-xl border-2 border-border hover:border-primary hover:bg-primary/5 transition-all duration-200 group\"\r\n        >\r\n          <div className=\"w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center group-hover:bg-primary/20 transition-colors\">\r\n            <FileText className=\"h-8 w-8 text-primary\" />\r\n          </div>\r\n          <div className=\"text-center\">\r\n            <h3 className=\"font-medium\">\r\n              {t(\"community.postType.post\", \"å‘å¸ƒå¸–å­\")}\r\n            </h3>\r\n            <p className=\"text-xs text-muted-foreground mt-1\">\r\n              {t(\"community.postType.postDesc\", \"åˆ†äº«ç¾é£Ÿä½“éªŒå’Œæƒ³æ³•\")}\r\n            </p>\r\n          </div>\r\n        </button>\r\n\r\n        {/* Recipe */}\r\n        <button\r\n          onClick={() => onSelect('recipe')}\r\n          className=\"flex flex-col items-center gap-3 p-6 rounded-xl border-2 border-border hover:border-primary hover:bg-primary/5 transition-all duration-200 group\"\r\n        >\r\n          <div className=\"w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center group-hover:bg-primary/20 transition-colors\">\r\n            <Utensils className=\"h-8 w-8 text-primary\" />\r\n          </div>\r\n          <div className=\"text-center\">\r\n            <h3 className=\"font-medium\">\r\n              {t(\"community.postType.recipe\", \"å‘å¸ƒé£Ÿè°±\")}\r\n            </h3>\r\n            <p className=\"text-xs text-muted-foreground mt-1\">\r\n              {t(\"community.postType.recipeDesc\", \"åˆ†äº«çƒ¹é¥ªæ•™ç¨‹å’Œèœè°±\")}\r\n            </p>\r\n          </div>\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PostTypeSelector;\r\n","// Recipe types and interfaces\r\n\r\nexport interface Ingredient {\r\n  name: string;\r\n  amount: string;\r\n  unit: string;\r\n}\r\n\r\nexport interface RecipeStep {\r\n  order: number;\r\n  description: string;\r\n  image_url?: string;\r\n  image_urls?: string[];\r\n}\r\n\r\nexport interface NutritionInfo {\r\n  calories?: number;\r\n  protein?: number;\r\n  carbs?: number;\r\n  fat?: number;\r\n}\r\n\r\nexport type RecipeDifficulty = 'easy' | 'medium' | 'hard';\r\n\r\nexport interface RecipeData {\r\n  recipe_name: string;\r\n  recipe_name_en?: string;\r\n  recipe_name_pt?: string;\r\n  cook_time: number; // in minutes\r\n  difficulty: RecipeDifficulty;\r\n  servings: number;\r\n  ingredients: Ingredient[];\r\n  steps: RecipeStep[];\r\n  // Optional fields (user can choose to add)\r\n  nutrition?: NutritionInfo;\r\n  recipe_tags?: string[];\r\n  recipe_category?: string;\r\n}\r\n\r\nexport const DIFFICULTY_OPTIONS: { value: RecipeDifficulty; labelKey: string }[] = [\r\n  { value: 'easy', labelKey: 'recipe.difficulty.easy' },\r\n  { value: 'medium', labelKey: 'recipe.difficulty.medium' },\r\n  { value: 'hard', labelKey: 'recipe.difficulty.hard' },\r\n];\r\n\r\nexport const RECIPE_CATEGORIES = [\r\n  'breakfast',\r\n  'lunch', \r\n  'dinner',\r\n  'dessert',\r\n  'snack',\r\n  'drink',\r\n  'appetizer',\r\n  'main',\r\n  'side',\r\n  'soup',\r\n] as const;\r\n\r\nexport const COMMON_UNITS = [\r\n  'g', 'kg', 'ml', 'L', 'tsp', 'tbsp', 'cup', 'piece', 'slice', 'clove', 'pinch'\r\n] as const;\r\n","import { useTranslation } from \"react-i18next\";\r\nimport { Clock, Users, ChefHat, Image, X, Loader2, Flame, ChevronDown, ChevronUp, FileText } from \"lucide-react\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { Collapsible, CollapsibleContent, CollapsibleTrigger } from \"@/components/ui/collapsible\";\r\nimport { RecipeData, DIFFICULTY_OPTIONS, RecipeDifficulty, NutritionInfo } from \"./RecipeTypes\";\r\nimport { useRef, useState } from \"react\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { toast } from \"sonner\";\r\n\r\ninterface RecipeBasicStepProps {\r\n  data: Partial<RecipeData>;\r\n  coverImage: string | null;\r\n  nutrition: NutritionInfo;\r\n  introduction: string;\r\n  onDataChange: (data: Partial<RecipeData>) => void;\r\n  onCoverImageChange: (url: string | null) => void;\r\n  onNutritionChange: (nutrition: NutritionInfo) => void;\r\n  onIntroductionChange: (introduction: string) => void;\r\n}\r\n\r\nconst RecipeBasicStep = ({ data, coverImage, nutrition, introduction, onDataChange, onCoverImageChange, onNutritionChange, onIntroductionChange }: RecipeBasicStepProps) => {\r\n  const { t } = useTranslation();\r\n  const imageInputRef = useRef<HTMLInputElement>(null);\r\n  const [showNutrition, setShowNutrition] = useState(\r\n    !!(nutrition.calories || nutrition.protein || nutrition.carbs || nutrition.fat)\r\n  );\r\n  const [uploading, setUploading] = useState(false);\r\n\r\n  const handleImageUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (!file) return;\r\n\r\n    if (file.size > 5 * 1024 * 1024) {\r\n      toast.error(t(\"common.imageTooLarge\", \"å›¾ç‰‡ä¸èƒ½è¶…è¿‡5MB\"));\r\n      return;\r\n    }\r\n\r\n    setUploading(true);\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (!user) throw new Error(\"Not authenticated\");\r\n\r\n      const fileExt = file.name.split(\".\").pop();\r\n      const fileName = `${user.id}/${Date.now()}-recipe-cover.${fileExt}`;\r\n\r\n      const { error: uploadError } = await supabase.storage\r\n        .from(\"community-posts\")\r\n        .upload(fileName, file);\r\n\r\n      if (uploadError) throw uploadError;\r\n\r\n      const { data: { publicUrl } } = supabase.storage\r\n        .from(\"community-posts\")\r\n        .getPublicUrl(fileName);\r\n\r\n      onCoverImageChange(publicUrl);\r\n    } catch (error) {\r\n      console.error(\"Upload error:\", error);\r\n      toast.error(t(\"common.uploadError\", \"ä¸Šä¼ å¤±è´¥\"));\r\n    } finally {\r\n      setUploading(false);\r\n      if (imageInputRef.current) {\r\n        imageInputRef.current.value = \"\";\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Cover Image */}\r\n      <div className=\"space-y-2\">\r\n        <Label>{t(\"recipe.coverImage\", \"å°é¢å›¾ç‰‡\")}</Label>\r\n        <input\r\n          ref={imageInputRef}\r\n          type=\"file\"\r\n          accept=\"image/*\"\r\n          className=\"hidden\"\r\n          onChange={handleImageUpload}\r\n        />\r\n        {coverImage ? (\r\n          <div className=\"relative aspect-video rounded-lg overflow-hidden bg-muted\">\r\n            <img src={coverImage} alt=\"\" className=\"w-full h-full object-cover\" />\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => onCoverImageChange(null)}\r\n              className=\"absolute top-2 right-2 p-1 bg-black/50 rounded-full text-white hover:bg-black/70\"\r\n            >\r\n              <X className=\"h-4 w-4\" />\r\n            </button>\r\n          </div>\r\n        ) : (\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => imageInputRef.current?.click()}\r\n            disabled={uploading}\r\n            className=\"w-full aspect-video rounded-lg border-2 border-dashed border-muted-foreground/30 flex flex-col items-center justify-center gap-2 text-muted-foreground hover:border-primary hover:text-primary transition-colors\"\r\n          >\r\n            {uploading ? (\r\n              <Loader2 className=\"h-8 w-8 animate-spin\" />\r\n            ) : (\r\n              <>\r\n                <Image className=\"h-8 w-8\" />\r\n                <span className=\"text-sm\">{t(\"recipe.addCoverImage\", \"æ·»åŠ å°é¢å›¾ç‰‡\")}</span>\r\n              </>\r\n            )}\r\n          </button>\r\n        )}\r\n      </div>\r\n\r\n      {/* Recipe Name */}\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"recipe-name\">{t(\"recipe.name\", \"é£Ÿè°±åç§°\")} *</Label>\r\n        <Input\r\n          id=\"recipe-name\"\r\n          value={data.recipe_name || \"\"}\r\n          onChange={(e) => onDataChange({ ...data, recipe_name: e.target.value })}\r\n          placeholder={t(\"recipe.namePlaceholder\", \"å¦‚ï¼šçº¢çƒ§è‚‰ã€ç•ªèŒ„ç‚’è›‹\")}\r\n        />\r\n      </div>\r\n\r\n      {/* Food Introduction */}\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"introduction\">\r\n          <FileText className=\"h-4 w-4 inline mr-1\" />\r\n          {t(\"recipe.introduction\", \"ç¾é£Ÿä»‹ç»\")}\r\n        </Label>\r\n        <Textarea\r\n          id=\"introduction\"\r\n          value={introduction}\r\n          onChange={(e) => onIntroductionChange(e.target.value)}\r\n          placeholder={t(\"recipe.introductionPlaceholder\", \"ä»‹ç»è¿™é“ç¾é£Ÿçš„ç‰¹è‰²ã€å£æ„Ÿã€æ¥æºæ•…äº‹ç­‰...\")}\r\n          rows={3}\r\n          className=\"resize-none\"\r\n        />\r\n      </div>\r\n\r\n      {/* Cook Time */}\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"cook-time\">\r\n          <Clock className=\"h-4 w-4 inline mr-1\" />\r\n          {t(\"recipe.cookTime\", \"çƒ¹é¥ªæ—¶é—´\")} *\r\n        </Label>\r\n        <div className=\"flex items-center gap-2\">\r\n          <Input\r\n            id=\"cook-time\"\r\n            type=\"number\"\r\n            min={1}\r\n            value={data.cook_time || \"\"}\r\n            onChange={(e) => onDataChange({ ...data, cook_time: parseInt(e.target.value) || 0 })}\r\n            placeholder=\"30\"\r\n            className=\"w-24\"\r\n          />\r\n          <span className=\"text-sm text-muted-foreground\">{t(\"recipe.minutes\", \"åˆ†é’Ÿ\")}</span>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Difficulty */}\r\n      <div className=\"space-y-2\">\r\n        <Label>\r\n          <ChefHat className=\"h-4 w-4 inline mr-1\" />\r\n          {t(\"recipe.difficulty\", \"éš¾åº¦\")} *\r\n        </Label>\r\n        <Select\r\n          value={data.difficulty || \"\"}\r\n          onValueChange={(value) => onDataChange({ ...data, difficulty: value as RecipeDifficulty })}\r\n        >\r\n          <SelectTrigger>\r\n            <SelectValue placeholder={t(\"recipe.selectDifficulty\", \"é€‰æ‹©éš¾åº¦\")} />\r\n          </SelectTrigger>\r\n          <SelectContent>\r\n            {DIFFICULTY_OPTIONS.map((option) => (\r\n              <SelectItem key={option.value} value={option.value}>\r\n                {t(option.labelKey, option.value)}\r\n              </SelectItem>\r\n            ))}\r\n          </SelectContent>\r\n        </Select>\r\n      </div>\r\n\r\n      {/* Servings */}\r\n      <div className=\"space-y-2\">\r\n        <Label htmlFor=\"servings\">\r\n          <Users className=\"h-4 w-4 inline mr-1\" />\r\n          {t(\"recipe.servings\", \"ä»½é‡\")} *\r\n        </Label>\r\n        <div className=\"flex items-center gap-2\">\r\n          <Input\r\n            id=\"servings\"\r\n            type=\"number\"\r\n            min={1}\r\n            value={data.servings || \"\"}\r\n            onChange={(e) => onDataChange({ ...data, servings: parseInt(e.target.value) || 0 })}\r\n            placeholder=\"2\"\r\n            className=\"w-24\"\r\n          />\r\n          <span className=\"text-sm text-muted-foreground\">{t(\"recipe.people\", \"äººä»½\")}</span>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Optional Nutrition Info */}\r\n      <Collapsible open={showNutrition} onOpenChange={setShowNutrition}>\r\n        <CollapsibleTrigger asChild>\r\n          <Button variant=\"ghost\" type=\"button\" className=\"w-full justify-between px-0 hover:bg-transparent\">\r\n            <span className=\"flex items-center gap-2 text-sm font-medium\">\r\n              <Flame className=\"h-4 w-4\" />\r\n              {t(\"recipe.nutritionInfo\", \"è¥å…»ä¿¡æ¯\")}\r\n              <span className=\"text-xs text-muted-foreground font-normal\">\r\n                ({t(\"common.optional\", \"å¯é€‰\")})\r\n              </span>\r\n            </span>\r\n            {showNutrition ? <ChevronUp className=\"h-4 w-4\" /> : <ChevronDown className=\"h-4 w-4\" />}\r\n          </Button>\r\n        </CollapsibleTrigger>\r\n        <CollapsibleContent className=\"space-y-4 pt-2\">\r\n          <div className=\"grid grid-cols-2 gap-4\">\r\n            {/* Calories */}\r\n            <div className=\"space-y-1\">\r\n              <Label htmlFor=\"calories\" className=\"text-xs\">\r\n                {t(\"recipe.calories\", \"å¡è·¯é‡Œ\")}\r\n              </Label>\r\n              <div className=\"flex items-center gap-1\">\r\n                <Input\r\n                  id=\"calories\"\r\n                  type=\"number\"\r\n                  min={0}\r\n                  value={nutrition.calories || \"\"}\r\n                  onChange={(e) => onNutritionChange({ ...nutrition, calories: parseInt(e.target.value) || undefined })}\r\n                  placeholder=\"300\"\r\n                  className=\"h-8\"\r\n                />\r\n                <span className=\"text-xs text-muted-foreground\">kcal</span>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Protein */}\r\n            <div className=\"space-y-1\">\r\n              <Label htmlFor=\"protein\" className=\"text-xs\">\r\n                {t(\"recipe.protein\", \"è›‹ç™½è´¨\")}\r\n              </Label>\r\n              <div className=\"flex items-center gap-1\">\r\n                <Input\r\n                  id=\"protein\"\r\n                  type=\"number\"\r\n                  min={0}\r\n                  value={nutrition.protein || \"\"}\r\n                  onChange={(e) => onNutritionChange({ ...nutrition, protein: parseInt(e.target.value) || undefined })}\r\n                  placeholder=\"20\"\r\n                  className=\"h-8\"\r\n                />\r\n                <span className=\"text-xs text-muted-foreground\">g</span>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Carbs */}\r\n            <div className=\"space-y-1\">\r\n              <Label htmlFor=\"carbs\" className=\"text-xs\">\r\n                {t(\"recipe.carbs\", \"ç¢³æ°´\")}\r\n              </Label>\r\n              <div className=\"flex items-center gap-1\">\r\n                <Input\r\n                  id=\"carbs\"\r\n                  type=\"number\"\r\n                  min={0}\r\n                  value={nutrition.carbs || \"\"}\r\n                  onChange={(e) => onNutritionChange({ ...nutrition, carbs: parseInt(e.target.value) || undefined })}\r\n                  placeholder=\"30\"\r\n                  className=\"h-8\"\r\n                />\r\n                <span className=\"text-xs text-muted-foreground\">g</span>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Fat */}\r\n            <div className=\"space-y-1\">\r\n              <Label htmlFor=\"fat\" className=\"text-xs\">\r\n                {t(\"recipe.fat\", \"è„‚è‚ª\")}\r\n              </Label>\r\n              <div className=\"flex items-center gap-1\">\r\n                <Input\r\n                  id=\"fat\"\r\n                  type=\"number\"\r\n                  min={0}\r\n                  value={nutrition.fat || \"\"}\r\n                  onChange={(e) => onNutritionChange({ ...nutrition, fat: parseInt(e.target.value) || undefined })}\r\n                  placeholder=\"10\"\r\n                  className=\"h-8\"\r\n                />\r\n                <span className=\"text-xs text-muted-foreground\">g</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CollapsibleContent>\r\n      </Collapsible>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default RecipeBasicStep;\r\n","import { useTranslation } from \"react-i18next\";\r\nimport { Plus, Trash2 } from \"lucide-react\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Ingredient, COMMON_UNITS } from \"./RecipeTypes\";\r\n\r\ninterface RecipeIngredientsStepProps {\r\n  ingredients: Ingredient[];\r\n  onChange: (ingredients: Ingredient[]) => void;\r\n}\r\n\r\nconst RecipeIngredientsStep = ({ ingredients, onChange }: RecipeIngredientsStepProps) => {\r\n  const { t } = useTranslation();\r\n\r\n  const addIngredient = () => {\r\n    onChange([...ingredients, { name: \"\", amount: \"\", unit: \"\" }]);\r\n  };\r\n\r\n  const updateIngredient = (index: number, field: keyof Ingredient, value: string) => {\r\n    const updated = [...ingredients];\r\n    updated[index] = { ...updated[index], [field]: value };\r\n    onChange(updated);\r\n  };\r\n\r\n  const removeIngredient = (index: number) => {\r\n    onChange(ingredients.filter((_, i) => i !== index));\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <Label className=\"text-base font-medium\">{t(\"recipe.ingredients\", \"é…æ–™\")} *</Label>\r\n        <span className=\"text-sm text-muted-foreground\">\r\n          {ingredients.filter(i => i.name).length} {t(\"recipe.items\", \"é¡¹\")}\r\n        </span>\r\n      </div>\r\n\r\n      <div className=\"space-y-3\">\r\n        {ingredients.map((ingredient, index) => (\r\n          <div key={index} className=\"flex items-center gap-2\">\r\n            <div className=\"flex-1\">\r\n              <Input\r\n                value={ingredient.name}\r\n                onChange={(e) => updateIngredient(index, \"name\", e.target.value)}\r\n                placeholder={t(\"recipe.ingredientName\", \"é…æ–™åç§°\")}\r\n              />\r\n            </div>\r\n            <div className=\"w-20\">\r\n              <Input\r\n                value={ingredient.amount}\r\n                onChange={(e) => updateIngredient(index, \"amount\", e.target.value)}\r\n                placeholder={t(\"recipe.amount\", \"é‡\")}\r\n              />\r\n            </div>\r\n            <div className=\"w-20\">\r\n              <Input\r\n                value={ingredient.unit}\r\n                onChange={(e) => updateIngredient(index, \"unit\", e.target.value)}\r\n                placeholder={t(\"recipe.unit\", \"å•ä½\")}\r\n                list=\"common-units\"\r\n              />\r\n              <datalist id=\"common-units\">\r\n                {COMMON_UNITS.map((unit) => (\r\n                  <option key={unit} value={unit} />\r\n                ))}\r\n              </datalist>\r\n            </div>\r\n            <Button\r\n              type=\"button\"\r\n              variant=\"ghost\"\r\n              size=\"icon\"\r\n              onClick={() => removeIngredient(index)}\r\n              disabled={ingredients.length === 1}\r\n              className=\"shrink-0\"\r\n            >\r\n              <Trash2 className=\"h-4 w-4 text-destructive\" />\r\n            </Button>\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      <Button\r\n        type=\"button\"\r\n        variant=\"outline\"\r\n        onClick={addIngredient}\r\n        className=\"w-full\"\r\n      >\r\n        <Plus className=\"h-4 w-4 mr-2\" />\r\n        {t(\"recipe.addIngredient\", \"æ·»åŠ é…æ–™\")}\r\n      </Button>\r\n\r\n      {/* Common units hint */}\r\n      <p className=\"text-xs text-muted-foreground\">\r\n        {t(\"recipe.unitsHint\", \"å¸¸ç”¨å•ä½ï¼šg, kg, ml, L, å‹º, æ¯, ä¸ª, ç‰‡, é€‚é‡\")}\r\n      </p>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default RecipeIngredientsStep;\r\n","import { useTranslation } from \"react-i18next\";\r\nimport { Plus, Trash2, Image, X, Loader2, GripVertical } from \"lucide-react\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { RecipeStep } from \"./RecipeTypes\";\r\nimport { useRef, useState } from \"react\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { toast } from \"sonner\";\r\n\r\nconst MAX_STEP_IMAGES = 3;\r\n\r\ninterface RecipeStepsStepProps {\r\n  steps: RecipeStep[];\r\n  onChange: (steps: RecipeStep[]) => void;\r\n}\r\n\r\nconst RecipeStepsStep = ({ steps, onChange }: RecipeStepsStepProps) => {\r\n  const { t } = useTranslation();\r\n  const [uploadingIndex, setUploadingIndex] = useState<number | null>(null);\r\n  const imageInputRefs = useRef<(HTMLInputElement | null)[]>([]);\r\n\r\n  const getStepImages = (step: RecipeStep): string[] => {\r\n    if (step.image_urls && step.image_urls.length > 0) return step.image_urls;\r\n    if (step.image_url) return [step.image_url];\r\n    return [];\r\n  };\r\n\r\n  const addStep = () => {\r\n    const newOrder = steps.length + 1;\r\n    onChange([...steps, { order: newOrder, description: \"\", image_urls: [] }]);\r\n  };\r\n\r\n  const updateStep = (index: number, field: keyof RecipeStep, value: any) => {\r\n    const updated = [...steps];\r\n    updated[index] = { ...updated[index], [field]: value };\r\n    onChange(updated);\r\n  };\r\n\r\n  const removeStep = (index: number) => {\r\n    const updated = steps\r\n      .filter((_, i) => i !== index)\r\n      .map((step, i) => ({ ...step, order: i + 1 }));\r\n    onChange(updated);\r\n  };\r\n\r\n  const removeImage = (stepIndex: number, imageIndex: number) => {\r\n    const images = getStepImages(steps[stepIndex]);\r\n    const newImages = images.filter((_, i) => i !== imageIndex);\r\n    updateStep(stepIndex, \"image_urls\", newImages);\r\n    // Clear legacy field\r\n    updateStep(stepIndex, \"image_url\", undefined);\r\n  };\r\n\r\n  const handleImageUpload = async (index: number, e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (!file) return;\r\n\r\n    const currentImages = getStepImages(steps[index]);\r\n    if (currentImages.length >= MAX_STEP_IMAGES) {\r\n      toast.error(t(\"recipe.maxStepImages\", \"æ¯ä¸ªæ­¥éª¤æœ€å¤šä¸Šä¼ {{max}}å¼ å›¾ç‰‡\", { max: MAX_STEP_IMAGES }));\r\n      return;\r\n    }\r\n\r\n    if (file.size > 5 * 1024 * 1024) {\r\n      toast.error(t(\"common.imageTooLarge\", \"å›¾ç‰‡ä¸èƒ½è¶…è¿‡5MB\"));\r\n      return;\r\n    }\r\n\r\n    setUploadingIndex(index);\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (!user) throw new Error(\"Not authenticated\");\r\n\r\n      const fileExt = file.name.split(\".\").pop();\r\n      const fileName = `${user.id}/${Date.now()}-step-${index}.${fileExt}`;\r\n\r\n      const { error: uploadError } = await supabase.storage\r\n        .from(\"community-posts\")\r\n        .upload(fileName, file);\r\n\r\n      if (uploadError) throw uploadError;\r\n\r\n      const { data: { publicUrl } } = supabase.storage\r\n        .from(\"community-posts\")\r\n        .getPublicUrl(fileName);\r\n\r\n      const newImages = [...currentImages, publicUrl];\r\n      const updated = [...steps];\r\n      updated[index] = { ...updated[index], image_urls: newImages, image_url: undefined };\r\n      onChange(updated);\r\n    } catch (error) {\r\n      console.error(\"Upload error:\", error);\r\n      toast.error(t(\"common.uploadError\", \"ä¸Šä¼ å¤±è´¥\"));\r\n    } finally {\r\n      setUploadingIndex(null);\r\n      if (imageInputRefs.current[index]) {\r\n        imageInputRefs.current[index]!.value = \"\";\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <Label className=\"text-base font-medium\">{t(\"recipe.steps\", \"çƒ¹é¥ªæ­¥éª¤\")} *</Label>\r\n        <span className=\"text-sm text-muted-foreground\">\r\n          {steps.filter(s => s.description).length} {t(\"recipe.stepsCount\", \"æ­¥\")}\r\n        </span>\r\n      </div>\r\n\r\n      <div className=\"space-y-4\">\r\n        {steps.map((step, index) => {\r\n          const images = getStepImages(step);\r\n          return (\r\n            <div key={index} className=\"p-4 border rounded-lg space-y-3 bg-card\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <GripVertical className=\"h-4 w-4 text-muted-foreground\" />\r\n                  <span className=\"font-medium text-primary\">\r\n                    {t(\"recipe.stepNumber\", \"ç¬¬{{n}}æ­¥\", { n: index + 1 })}\r\n                  </span>\r\n                </div>\r\n                <Button\r\n                  type=\"button\"\r\n                  variant=\"ghost\"\r\n                  size=\"icon\"\r\n                  onClick={() => removeStep(index)}\r\n                  disabled={steps.length === 1}\r\n                >\r\n                  <Trash2 className=\"h-4 w-4 text-destructive\" />\r\n                </Button>\r\n              </div>\r\n\r\n              <Textarea\r\n                value={step.description}\r\n                onChange={(e) => updateStep(index, \"description\", e.target.value)}\r\n                placeholder={t(\"recipe.stepDescriptionPlaceholder\", \"æè¿°è¿™ä¸€æ­¥çš„æ“ä½œ...\")}\r\n                className=\"min-h-[80px]\"\r\n              />\r\n\r\n              {/* Step Images */}\r\n              <div>\r\n                <input\r\n                  ref={(el) => (imageInputRefs.current[index] = el)}\r\n                  type=\"file\"\r\n                  accept=\"image/*\"\r\n                  className=\"hidden\"\r\n                  onChange={(e) => handleImageUpload(index, e)}\r\n                />\r\n                \r\n                {images.length > 0 && (\r\n                  <div className=\"flex flex-wrap gap-2 mb-2\">\r\n                    {images.map((url, imgIdx) => (\r\n                      <div key={imgIdx} className=\"relative w-24 h-20 rounded-lg overflow-hidden bg-muted\">\r\n                        <img src={url} alt=\"\" className=\"w-full h-full object-cover\" />\r\n                        <button\r\n                          type=\"button\"\r\n                          onClick={() => removeImage(index, imgIdx)}\r\n                          className=\"absolute top-1 right-1 p-1 bg-black/50 rounded-full text-white hover:bg-black/70\"\r\n                        >\r\n                          <X className=\"h-3 w-3\" />\r\n                        </button>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n\r\n                {images.length < MAX_STEP_IMAGES && (\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => imageInputRefs.current[index]?.click()}\r\n                    disabled={uploadingIndex === index}\r\n                    className=\"flex items-center gap-2 text-sm text-muted-foreground hover:text-primary transition-colors\"\r\n                  >\r\n                    {uploadingIndex === index ? (\r\n                      <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n                    ) : (\r\n                      <Image className=\"h-4 w-4\" />\r\n                    )}\r\n                    <span>\r\n                      {images.length === 0\r\n                        ? t(\"recipe.addStepImage\", \"æ·»åŠ æ­¥éª¤å›¾ç‰‡ï¼ˆå¯é€‰ï¼‰\")\r\n                        : t(\"recipe.addMoreImages\", \"ç»§ç»­æ·»åŠ  ({{current}}/{{max}})\", { current: images.length, max: MAX_STEP_IMAGES })}\r\n                    </span>\r\n                  </button>\r\n                )}\r\n              </div>\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n\r\n      <Button\r\n        type=\"button\"\r\n        variant=\"outline\"\r\n        onClick={addStep}\r\n        className=\"w-full\"\r\n      >\r\n        <Plus className=\"h-4 w-4 mr-2\" />\r\n        {t(\"recipe.addStep\", \"æ·»åŠ æ­¥éª¤\")}\r\n      </Button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default RecipeStepsStep;\r\n","import { useMutation, useQueryClient } from \"@tanstack/react-query\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { toast } from \"sonner\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Ingredient, RecipeStep, RecipeDifficulty } from \"@/components/community/recipe/RecipeTypes\";\r\n\r\ninterface CreateRecipeParams {\r\n  recipe_name: string;\r\n  cook_time: number;\r\n  difficulty: RecipeDifficulty;\r\n  servings: number;\r\n  ingredients: Ingredient[];\r\n  steps: RecipeStep[];\r\n  cover_image?: string | null;\r\n  introduction?: string;\r\n  // Optional fields\r\n  nutrition?: {\r\n    calories?: number;\r\n    protein?: number;\r\n    carbs?: number;\r\n    fat?: number;\r\n  };\r\n  recipe_tags?: string[];\r\n  recipe_category?: string;\r\n}\r\n\r\nexport const useCreateRecipe = () => {\r\n  const queryClient = useQueryClient();\r\n  const { t } = useTranslation();\r\n\r\n  return useMutation({\r\n    mutationFn: async (params: CreateRecipeParams) => {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (!user) throw new Error(\"Not authenticated\");\r\n\r\n      // Use custom introduction if provided, otherwise leave content empty\r\n      // The recipe name is already displayed separately, no need to duplicate\r\n      let content: string;\r\n      if (params.introduction) {\r\n        content = params.introduction;\r\n      } else {\r\n        // Empty content - the recipe detail will show ingredients in the dedicated section\r\n        content = \"\";\r\n      }\r\n\r\n      // Prepare image_urls (cover image first if present)\r\n      const imageUrls: string[] = [];\r\n      if (params.cover_image) {\r\n        imageUrls.push(params.cover_image);\r\n      }\r\n      // Add step images (support both image_urls array and legacy image_url)\r\n      params.steps.forEach(step => {\r\n        if (step.image_urls && step.image_urls.length > 0) {\r\n          step.image_urls.forEach(url => imageUrls.push(url));\r\n        } else if (step.image_url) {\r\n          imageUrls.push(step.image_url);\r\n        }\r\n      });\r\n\r\n      // Insert the recipe post\r\n      const { data, error } = await supabase\r\n        .from(\"community_posts\")\r\n        .insert({\r\n          author_id: user.id,\r\n          post_type: \"recipe\",\r\n          content,\r\n          image_urls: imageUrls,\r\n          recipe_name: params.recipe_name,\r\n          cook_time: params.cook_time,\r\n          difficulty: params.difficulty,\r\n          servings: params.servings,\r\n          ingredients: params.ingredients as unknown as any,\r\n          steps: params.steps as unknown as any,\r\n          nutrition: params.nutrition ? (params.nutrition as unknown as any) : null,\r\n          recipe_tags: params.recipe_tags || null,\r\n          recipe_category: params.recipe_category || null,\r\n          status: \"pending\",\r\n          moderation_status: \"pending\",\r\n        } as any)\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n\r\n      // Call moderation function\r\n      try {\r\n        await supabase.functions.invoke(\"moderate-post\", {\r\n          body: {\r\n            post_id: data.id,\r\n            content,\r\n            user_id: user.id,\r\n            image_urls: imageUrls,\r\n          },\r\n        });\r\n      } catch (err) {\r\n        console.error(\"Moderation call failed:\", err);\r\n      }\r\n\r\n      return data;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: [\"community-posts\"] });\r\n      queryClient.invalidateQueries({ queryKey: [\"has-posted-today\"] });\r\n      toast.success(t(\"recipe.publishSuccess\", \"é£Ÿè°±å‘å¸ƒæˆåŠŸ\"));\r\n    },\r\n    onError: (error) => {\r\n      console.error(\"Create recipe error:\", error);\r\n      toast.error(t(\"recipe.publishError\", \"å‘å¸ƒå¤±è´¥\"));\r\n    },\r\n  });\r\n};\r\n","import { useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { ArrowLeft, ArrowRight, Loader2, Check } from \"lucide-react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Progress } from \"@/components/ui/progress\";\r\nimport RecipeBasicStep from \"./RecipeBasicStep\";\r\nimport RecipeIngredientsStep from \"./RecipeIngredientsStep\";\r\nimport RecipeStepsStep from \"./RecipeStepsStep\";\r\nimport { RecipeData, Ingredient, RecipeStep, NutritionInfo } from \"./RecipeTypes\";\r\nimport { useCreateRecipe } from \"@/hooks/useCreateRecipe\";\r\nimport { toast } from \"sonner\";\r\n\r\ninterface CreateRecipeWizardProps {\r\n  onClose: () => void;\r\n  onSuccess: () => void;\r\n}\r\n\r\nconst CreateRecipeWizard = ({ onClose, onSuccess }: CreateRecipeWizardProps) => {\r\n  const { t } = useTranslation();\r\n  const createRecipe = useCreateRecipe();\r\n\r\n  const [currentStep, setCurrentStep] = useState(0);\r\n  const [coverImage, setCoverImage] = useState<string | null>(null);\r\n  const [recipeData, setRecipeData] = useState<Partial<RecipeData>>({\r\n    recipe_name: \"\",\r\n    cook_time: undefined,\r\n    difficulty: undefined,\r\n    servings: undefined,\r\n  });\r\n  const [ingredients, setIngredients] = useState<Ingredient[]>([\r\n    { name: \"\", amount: \"\", unit: \"\" }\r\n  ]);\r\n  const [steps, setSteps] = useState<RecipeStep[]>([\r\n    { order: 1, description: \"\" }\r\n  ]);\r\n  const [nutrition, setNutrition] = useState<NutritionInfo>({});\r\n  const [introduction, setIntroduction] = useState(\"\");\r\n\r\n  const STEPS = [\r\n    { key: \"basic\", title: t(\"recipe.step.basic\", \"åŸºæœ¬ä¿¡æ¯\") },\r\n    { key: \"ingredients\", title: t(\"recipe.step.ingredients\", \"é…æ–™\") },\r\n    { key: \"steps\", title: t(\"recipe.step.steps\", \"æ­¥éª¤\") },\r\n  ];\r\n\r\n  const progress = ((currentStep + 1) / STEPS.length) * 100;\r\n\r\n  const validateBasicStep = () => {\r\n    if (!recipeData.recipe_name?.trim()) {\r\n      toast.error(t(\"recipe.nameRequired\", \"è¯·è¾“å…¥é£Ÿè°±åç§°\"));\r\n      return false;\r\n    }\r\n    if (!recipeData.cook_time || recipeData.cook_time < 1) {\r\n      toast.error(t(\"recipe.cookTimeRequired\", \"è¯·è¾“å…¥çƒ¹é¥ªæ—¶é—´\"));\r\n      return false;\r\n    }\r\n    if (!recipeData.difficulty) {\r\n      toast.error(t(\"recipe.difficultyRequired\", \"è¯·é€‰æ‹©éš¾åº¦\"));\r\n      return false;\r\n    }\r\n    if (!recipeData.servings || recipeData.servings < 1) {\r\n      toast.error(t(\"recipe.servingsRequired\", \"è¯·è¾“å…¥ä»½é‡\"));\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n\r\n  const validateIngredientsStep = () => {\r\n    const validIngredients = ingredients.filter(i => i.name.trim());\r\n    if (validIngredients.length === 0) {\r\n      toast.error(t(\"recipe.ingredientsRequired\", \"è¯·è‡³å°‘æ·»åŠ ä¸€ç§é…æ–™\"));\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n\r\n  const validateStepsStep = () => {\r\n    const validSteps = steps.filter(s => s.description.trim());\r\n    if (validSteps.length === 0) {\r\n      toast.error(t(\"recipe.stepsRequired\", \"è¯·è‡³å°‘æ·»åŠ ä¸€ä¸ªæ­¥éª¤\"));\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n\r\n  const handleNext = () => {\r\n    if (currentStep === 0 && !validateBasicStep()) return;\r\n    if (currentStep === 1 && !validateIngredientsStep()) return;\r\n    setCurrentStep((prev) => Math.min(prev + 1, STEPS.length - 1));\r\n  };\r\n\r\n  const handleBack = () => {\r\n    setCurrentStep((prev) => Math.max(prev - 1, 0));\r\n  };\r\n\r\n  const handleSubmit = async () => {\r\n    if (!validateStepsStep()) return;\r\n\r\n    const validIngredients = ingredients.filter(i => i.name.trim());\r\n    const validSteps = steps\r\n      .filter(s => s.description.trim())\r\n      .map((s, i) => ({ ...s, order: i + 1 }));\r\n\r\n    // Only include nutrition if at least one field has a value\r\n    const hasNutrition = nutrition.calories || nutrition.protein || nutrition.carbs || nutrition.fat;\r\n\r\n    try {\r\n      await createRecipe.mutateAsync({\r\n        recipe_name: recipeData.recipe_name!,\r\n        cook_time: recipeData.cook_time!,\r\n        difficulty: recipeData.difficulty!,\r\n        servings: recipeData.servings!,\r\n        ingredients: validIngredients,\r\n        steps: validSteps,\r\n        cover_image: coverImage,\r\n        nutrition: hasNutrition ? nutrition : undefined,\r\n        introduction: introduction.trim() || undefined,\r\n      });\r\n      onSuccess();\r\n    } catch (error) {\r\n      // Error handled in hook\r\n    }\r\n  };\r\n\r\n  const renderStepContent = () => {\r\n    switch (currentStep) {\r\n      case 0:\r\n        return (\r\n          <RecipeBasicStep\r\n            data={recipeData}\r\n            coverImage={coverImage}\r\n            nutrition={nutrition}\r\n            introduction={introduction}\r\n            onDataChange={setRecipeData}\r\n            onCoverImageChange={setCoverImage}\r\n            onNutritionChange={setNutrition}\r\n            onIntroductionChange={setIntroduction}\r\n          />\r\n        );\r\n      case 1:\r\n        return (\r\n          <RecipeIngredientsStep\r\n            ingredients={ingredients}\r\n            onChange={setIngredients}\r\n          />\r\n        );\r\n      case 2:\r\n        return (\r\n          <RecipeStepsStep\r\n            steps={steps}\r\n            onChange={setSteps}\r\n          />\r\n        );\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"h-full flex flex-col\">\r\n      {/* Header */}\r\n      <div className=\"px-4 py-3 border-b bg-background shrink-0\">\r\n        <div className=\"flex items-center justify-between mb-3\">\r\n          <button\r\n            type=\"button\"\r\n            onClick={onClose}\r\n            className=\"p-1 -ml-1 hover:bg-muted rounded-md transition-colors\"\r\n          >\r\n            <ArrowLeft className=\"h-5 w-5\" />\r\n          </button>\r\n          <h2 className=\"font-medium\">{t(\"recipe.createTitle\", \"åˆ›å»ºé£Ÿè°±\")}</h2>\r\n          <div className=\"w-6\" /> {/* Spacer */}\r\n        </div>\r\n\r\n        {/* Step Progress */}\r\n        <div className=\"space-y-2\">\r\n          <Progress value={progress} className=\"h-1\" />\r\n          <div className=\"flex justify-between text-xs text-muted-foreground\">\r\n            {STEPS.map((step, index) => (\r\n              <span\r\n                key={step.key}\r\n                className={index === currentStep ? \"text-primary font-medium\" : \"\"}\r\n              >\r\n                {step.title}\r\n              </span>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Content */}\r\n      <div className=\"flex-1 overflow-y-auto p-4\">\r\n        {renderStepContent()}\r\n      </div>\r\n\r\n      {/* Footer */}\r\n      <div className=\"px-4 py-3 pb-[max(1rem,env(safe-area-inset-bottom))] border-t bg-background shrink-0\">\r\n        <div className=\"flex gap-3\">\r\n          {currentStep > 0 && (\r\n            <Button\r\n              type=\"button\"\r\n              variant=\"outline\"\r\n              onClick={handleBack}\r\n              className=\"flex-1\"\r\n            >\r\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\r\n              {t(\"common.back\", \"ä¸Šä¸€æ­¥\")}\r\n            </Button>\r\n          )}\r\n          \r\n          {currentStep < STEPS.length - 1 ? (\r\n            <Button\r\n              type=\"button\"\r\n              onClick={handleNext}\r\n              className=\"flex-1\"\r\n            >\r\n              {t(\"common.next\", \"ä¸‹ä¸€æ­¥\")}\r\n              <ArrowRight className=\"h-4 w-4 ml-2\" />\r\n            </Button>\r\n          ) : (\r\n            <Button\r\n              type=\"button\"\r\n              onClick={handleSubmit}\r\n              disabled={createRecipe.isPending}\r\n              className=\"flex-1\"\r\n            >\r\n              {createRecipe.isPending ? (\r\n                <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />\r\n              ) : (\r\n                <Check className=\"h-4 w-4 mr-2\" />\r\n              )}\r\n              {t(\"recipe.publish\", \"å‘å¸ƒé£Ÿè°±\")}\r\n            </Button>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CreateRecipeWizard;\r\n","import { useState, useRef, useEffect } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Image, Video, X, Loader2, Calendar, MapPin, Gift, ArrowLeft } from \"lucide-react\";\r\nimport PostPointsRulesDialog from \"./PostPointsRulesDialog\";\r\nimport MultiRestaurantSelectDrawer from \"./MultiRestaurantSelectDrawer\";\r\nimport ActivitySelectDrawer from \"./ActivitySelectDrawer\";\r\nimport EmojiPicker from \"./EmojiPicker\";\r\nimport PostTypeSelector from \"./PostTypeSelector\";\r\nimport CreateRecipeWizard from \"./recipe/CreateRecipeWizard\";\r\nimport {\r\n  Sheet,\r\n  SheetContent,\r\n  SheetTitle,\r\n  SheetTrigger,\r\n} from \"@/components/ui/sheet\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { useCreatePost, useMerchantRestaurant, useHasPostedToday } from \"@/hooks/useCommunityPosts\";\r\nimport { useActivities } from \"@/hooks/useActivities\";\r\nimport { useRestaurants } from \"@/hooks/useRestaurants\";\r\nimport { useUserRole } from \"@/hooks/useUserRole\";\r\nimport { useLocalizedContent } from \"@/hooks/useLocalizedContent\";\r\nimport { toast } from \"sonner\";\r\nimport * as VisuallyHidden from \"@radix-ui/react-visually-hidden\";\r\n\r\ninterface CreatePostDialogProps {\r\n  trigger?: React.ReactNode;\r\n}\r\n\r\nconst CreatePostDialog = ({ trigger }: CreatePostDialogProps) => {\r\n  const { t } = useTranslation();\r\n  const { getLocalizedField } = useLocalizedContent();\r\n  const createPost = useCreatePost();\r\n  const { data: activities } = useActivities();\r\n  const { data: restaurants } = useRestaurants();\r\n  const { role, isMerchant, isAdmin, isSupervisor } = useUserRole();\r\n  const { data: merchantRestaurant } = useMerchantRestaurant();\r\n  const { data: hasPostedToday, isLoading: checkingPost } = useHasPostedToday();\r\n\r\n  const [open, setOpen] = useState(false);\r\n  const [postType, setPostType] = useState<'selecting' | 'post' | 'recipe'>('selecting');\r\n  const [content, setContent] = useState(\"\");\r\n  const [imageUrls, setImageUrls] = useState<string[]>([]);\r\n  const [videoUrl, setVideoUrl] = useState<string | null>(null);\r\n  const [activityId, setActivityId] = useState<string>(\"\");\r\n  const [restaurantIds, setRestaurantIds] = useState<string[]>([]);\r\n  const [uploading, setUploading] = useState(false);\r\n  const [restaurantOpen, setRestaurantOpen] = useState(false);\r\n  const [activityOpen, setActivityOpen] = useState(false);\r\n  const [showRestaurantError, setShowRestaurantError] = useState(false);\r\n\r\n  const imageInputRef = useRef<HTMLInputElement>(null);\r\n  const videoInputRef = useRef<HTMLInputElement>(null);\r\n\r\n  // æ™®é€šç”¨æˆ· = æ—¢ä¸æ˜¯å•†å®¶ã€ç£å¯¼ä¹Ÿä¸æ˜¯ç®¡ç†å‘˜\r\n  const isRegularUser = !isMerchant && !isSupervisor && !isAdmin;\r\n  \r\n  // æ˜¯å¦å¯ä»¥åˆ›å»ºé£Ÿè°±ï¼ˆåªæœ‰ç®¡ç†å‘˜ã€ç£å¯¼ã€å•†å®¶å¯ä»¥ï¼‰\r\n  const canCreateRecipe = isAdmin || isSupervisor || isMerchant;\r\n\r\n  // å•†å®¶è‡ªåŠ¨è®¾ç½®é¤å…\r\n  useEffect(() => {\r\n    if (isMerchant && merchantRestaurant && open) {\r\n      setRestaurantIds([merchantRestaurant.id]);\r\n    }\r\n  }, [isMerchant, merchantRestaurant, open]);\r\n\r\n  // é‡ç½®è¡¨å•\r\n  const resetForm = () => {\r\n    // æ™®é€šç”¨æˆ·ç›´æ¥è¿›å…¥å‘å¸–æ¨¡å¼ï¼Œå…¶ä»–ç”¨æˆ·è¿›å…¥é€‰æ‹©æ¨¡å¼\r\n    setPostType(canCreateRecipe ? 'selecting' : 'post');\r\n    setContent(\"\");\r\n    setImageUrls([]);\r\n    setVideoUrl(null);\r\n    setActivityId(\"\");\r\n    setRestaurantIds([]);\r\n    setRestaurantOpen(false);\r\n    setActivityOpen(false);\r\n    setShowRestaurantError(false);\r\n  };\r\n\r\n  // åˆå§‹åŒ–æ—¶è®¾ç½®æ­£ç¡®çš„ postType\r\n  useEffect(() => {\r\n    if (open) {\r\n      setPostType(canCreateRecipe ? 'selecting' : 'post');\r\n    }\r\n  }, [open, canCreateRecipe]);\r\n\r\n  const handleOpenChange = (newOpen: boolean) => {\r\n    setOpen(newOpen);\r\n    if (!newOpen) {\r\n      resetForm();\r\n    }\r\n  };\r\n\r\n  // Get active activities\r\n  const activeActivities = activities?.filter((a) => a.status === \"published\") || [];\r\n\r\n  const handleImageUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const files = e.target.files;\r\n    if (!files || files.length === 0) return;\r\n\r\n    if (imageUrls.length + files.length > 9) {\r\n      toast.error(t(\"community.maxImages\", \"æœ€å¤šä¸Šä¼ 9å¼ å›¾ç‰‡\"));\r\n      return;\r\n    }\r\n\r\n    setUploading(true);\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (!user) throw new Error(\"Not authenticated\");\r\n\r\n      const uploadedUrls: string[] = [];\r\n\r\n      for (const file of Array.from(files)) {\r\n        const fileExt = file.name.split(\".\").pop();\r\n        const fileName = `${user.id}/${Date.now()}-${Math.random().toString(36).substring(7)}.${fileExt}`;\r\n\r\n        const { error: uploadError } = await supabase.storage\r\n          .from(\"community-posts\")\r\n          .upload(fileName, file);\r\n\r\n        if (uploadError) throw uploadError;\r\n\r\n        const { data: { publicUrl } } = supabase.storage\r\n          .from(\"community-posts\")\r\n          .getPublicUrl(fileName);\r\n\r\n        uploadedUrls.push(publicUrl);\r\n      }\r\n\r\n      setImageUrls((prev) => [...prev, ...uploadedUrls]);\r\n    } catch (error) {\r\n      console.error(\"Upload error:\", error);\r\n      toast.error(t(\"common.uploadError\", \"ä¸Šä¼ å¤±è´¥\"));\r\n    } finally {\r\n      setUploading(false);\r\n      if (imageInputRef.current) {\r\n        imageInputRef.current.value = \"\";\r\n      }\r\n    }\r\n  };\r\n\r\n  // Extract first frame from video file\r\n  const extractVideoFirstFrame = (videoFile: File): Promise<Blob> => {\r\n    return new Promise((resolve, reject) => {\r\n      const video = document.createElement('video');\r\n      const canvas = document.createElement('canvas');\r\n      const ctx = canvas.getContext('2d');\r\n      \r\n      video.preload = 'auto';\r\n      video.muted = true;\r\n      video.playsInline = true;\r\n      \r\n      let hasResolved = false;\r\n      \r\n      const captureFrame = () => {\r\n        if (hasResolved) return;\r\n        if (video.videoWidth === 0 || video.videoHeight === 0) return;\r\n        \r\n        canvas.width = video.videoWidth;\r\n        canvas.height = video.videoHeight;\r\n        \r\n        if (ctx) {\r\n          ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\r\n          canvas.toBlob((blob) => {\r\n            if (blob && blob.size > 0) {\r\n              hasResolved = true;\r\n              video.pause();\r\n              URL.revokeObjectURL(video.src);\r\n              resolve(blob);\r\n            } else {\r\n              reject(new Error('Failed to create blob'));\r\n            }\r\n          }, 'image/jpeg', 0.85);\r\n        }\r\n      };\r\n      \r\n      video.onloadedmetadata = () => {\r\n        canvas.width = video.videoWidth;\r\n        canvas.height = video.videoHeight;\r\n        video.currentTime = 0.1; // Jump to 0.1s to ensure frame is available\r\n      };\r\n      \r\n      video.onseeked = () => {\r\n        setTimeout(captureFrame, 100);\r\n      };\r\n      \r\n      video.onerror = () => {\r\n        URL.revokeObjectURL(video.src);\r\n        reject(new Error('Failed to load video'));\r\n      };\r\n      \r\n      // Timeout handling\r\n      setTimeout(() => {\r\n        if (!hasResolved) {\r\n          URL.revokeObjectURL(video.src);\r\n          reject(new Error('Timeout'));\r\n        }\r\n      }, 10000);\r\n      \r\n      video.src = URL.createObjectURL(videoFile);\r\n      video.load();\r\n    });\r\n  };\r\n\r\n  const handleVideoUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (!file) return;\r\n\r\n    // Check file size (max 100MB)\r\n    if (file.size > 100 * 1024 * 1024) {\r\n      toast.error(t(\"community.videoTooLarge\", \"è§†é¢‘ä¸èƒ½è¶…è¿‡100MB\"));\r\n      return;\r\n    }\r\n\r\n    setUploading(true);\r\n    try {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (!user) throw new Error(\"Not authenticated\");\r\n\r\n      // 1. Upload video\r\n      const videoExt = file.name.split(\".\").pop();\r\n      const videoFileName = `${user.id}/${Date.now()}.${videoExt}`;\r\n\r\n      const { error: videoError } = await supabase.storage\r\n        .from(\"community-posts\")\r\n        .upload(videoFileName, file);\r\n\r\n      if (videoError) throw videoError;\r\n\r\n      const { data: { publicUrl: videoPublicUrl } } = supabase.storage\r\n        .from(\"community-posts\")\r\n        .getPublicUrl(videoFileName);\r\n\r\n      setVideoUrl(videoPublicUrl);\r\n\r\n      // 2. Extract and upload cover image\r\n      try {\r\n        toast.info(t(\"community.extractingCover\", \"æ­£åœ¨æå–è§†é¢‘å°é¢...\"));\r\n        const coverBlob = await extractVideoFirstFrame(file);\r\n        const coverFileName = `${user.id}/${Date.now()}-cover.jpg`;\r\n        \r\n        const { error: coverError } = await supabase.storage\r\n          .from(\"community-posts\")\r\n          .upload(coverFileName, coverBlob);\r\n        \r\n        if (!coverError) {\r\n          const { data: { publicUrl: coverUrl } } = supabase.storage\r\n            .from(\"community-posts\")\r\n            .getPublicUrl(coverFileName);\r\n          \r\n          // Add cover image to the beginning of imageUrls\r\n          setImageUrls(prev => [coverUrl, ...prev]);\r\n          toast.success(t(\"community.coverExtracted\", \"å°é¢å·²è‡ªåŠ¨ç”Ÿæˆ\"));\r\n        }\r\n      } catch (coverError) {\r\n        console.warn(\"Cover extraction failed:\", coverError);\r\n        // Cover extraction failure should not block video upload\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error(\"Upload error:\", error);\r\n      toast.error(t(\"common.uploadError\", \"ä¸Šä¼ å¤±è´¥\"));\r\n    } finally {\r\n      setUploading(false);\r\n      if (videoInputRef.current) {\r\n        videoInputRef.current.value = \"\";\r\n      }\r\n    }\r\n  };\r\n\r\n  const removeImage = (index: number) => {\r\n    setImageUrls((prev) => prev.filter((_, i) => i !== index));\r\n  };\r\n\r\n  const removeVideo = () => {\r\n    setVideoUrl(null);\r\n    // Remove auto-generated cover image (URL contains -cover.jpg)\r\n    setImageUrls(prev => {\r\n      if (prev.length > 0 && prev[0].includes('-cover.jpg')) {\r\n        return prev.slice(1);\r\n      }\r\n      return prev;\r\n    });\r\n  };\r\n\r\n  const handleSubmit = async () => {\r\n    // é‡ç½®é”™è¯¯çŠ¶æ€\r\n    setShowRestaurantError(false);\r\n\r\n    if (!content.trim()) {\r\n      toast.error(t(\"community.contentRequired\", \"è¯·è¾“å…¥å†…å®¹\"));\r\n      return;\r\n    }\r\n\r\n    // æ™®é€šç”¨æˆ·å¿…é¡»é€‰æ‹©é¤å…\r\n    if (isRegularUser && restaurantIds.length === 0) {\r\n      setShowRestaurantError(true);\r\n      toast.error(t(\"community.restaurantRequired\", \"è¯·é€‰æ‹©é¤å…\"));\r\n      return;\r\n    }\r\n\r\n    await createPost.mutateAsync({\r\n      content,\r\n      image_urls: imageUrls,\r\n      video_url: videoUrl || undefined,\r\n      activity_id: activityId || undefined,\r\n      restaurant_ids: restaurantIds.length > 0 ? restaurantIds : undefined,\r\n    });\r\n\r\n    resetForm();\r\n    setOpen(false);\r\n  };\r\n\r\n\r\n  // è·å–å•†å®¶é¤å…åç§°\r\n  const getMerchantRestaurantName = () => {\r\n    if (!merchantRestaurant) return t(\"community.noRestaurant\", \"æœªå…³è”é¤å…\");\r\n    return getLocalizedField(merchantRestaurant, \"name\");\r\n  };\r\n\r\n  // Handle recipe creation success\r\n  const handleRecipeSuccess = () => {\r\n    resetForm();\r\n    setOpen(false);\r\n  };\r\n\r\n  return (\r\n    <Sheet open={open} onOpenChange={handleOpenChange}>\r\n      <SheetTrigger asChild>\r\n        {trigger || (\r\n          <Button>{t(\"community.createPost\", \"å‘å¸ƒå¸–å­\")}</Button>\r\n        )}\r\n      </SheetTrigger>\r\n      <SheetContent \r\n        side=\"bottom\" \r\n        className=\"h-full flex flex-col p-0 rounded-none border-0 [&>button]:hidden\"\r\n      >\r\n        <VisuallyHidden.Root>\r\n          <SheetTitle>{t(\"community.createPost\", \"å‘å¸ƒå¸–å­\")}</SheetTitle>\r\n        </VisuallyHidden.Root>\r\n\r\n        {/* Post Type Selection */}\r\n        {postType === 'selecting' && (\r\n          <div className=\"h-full flex flex-col\">\r\n            <div className=\"flex items-center justify-between px-4 py-3 border-b bg-background shrink-0\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => setOpen(false)}\r\n                className=\"p-1 -ml-1 hover:bg-muted rounded-md transition-colors\"\r\n              >\r\n                <ArrowLeft className=\"h-5 w-5\" />\r\n              </button>\r\n              <span className=\"font-medium\">{t(\"community.create\", \"å‘å¸ƒ\")}</span>\r\n              <div className=\"w-6\" />\r\n            </div>\r\n            <PostTypeSelector onSelect={setPostType} />\r\n          </div>\r\n        )}\r\n\r\n        {/* Recipe Creation Wizard */}\r\n        {postType === 'recipe' && (\r\n          <CreateRecipeWizard \r\n            onClose={() => setPostType('selecting')} \r\n            onSuccess={handleRecipeSuccess}\r\n          />\r\n        )}\r\n\r\n        {/* Regular Post Creation */}\r\n        {postType === 'post' && (\r\n          <>\r\n\r\n        {/* Top Navigation - for regular post */}\r\n        <div className=\"flex items-center justify-between px-4 py-3 border-b bg-background shrink-0\">\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => canCreateRecipe ? setPostType('selecting') : setOpen(false)}\r\n            className=\"p-1 -ml-1 hover:bg-muted rounded-md transition-colors\"\r\n          >\r\n            <ArrowLeft className=\"h-5 w-5\" />\r\n          </button>\r\n          <Button\r\n            size=\"sm\"\r\n            onClick={handleSubmit}\r\n            disabled={createPost.isPending || !content.trim()}\r\n            className=\"rounded-full px-6\"\r\n          >\r\n            {createPost.isPending && <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />}\r\n            {t(\"community.publish\", \"å‘å¸ƒ\")}\r\n          </Button>\r\n        </div>\r\n\r\n        {/* å¯æ»šåŠ¨å†…å®¹åŒº */}\r\n        <div className=\"flex-1 overflow-y-auto\">\r\n          <div className=\"px-4 py-4 space-y-4\">\r\n            {/* Points Hint - Only show if user hasn't posted today */}\r\n            {!checkingPost && !hasPostedToday && (\r\n              <div className=\"flex items-center justify-between gap-2 px-3 py-2 bg-primary/10 dark:bg-primary/20 border border-primary/30 dark:border-primary/40 rounded-md text-sm text-primary dark:text-primary\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <Gift className=\"h-4 w-4 shrink-0\" />\r\n                  <span>{t(\"community.dailyPointsHint\", \"æ¯æ—¥å‘å¸ƒé¦–ä¸ªå¸–å­å¯è·å¾—5ç§¯åˆ†ï¼\")}</span>\r\n                </div>\r\n                <PostPointsRulesDialog />\r\n              </div>\r\n            )}\r\n\r\n            {/* å†…å®¹è¾“å…¥åŒº */}\r\n            <Textarea\r\n              value={content}\r\n              onChange={(e) => setContent(e.target.value)}\r\n              placeholder={t(\"community.contentPlaceholder\", \"åˆ†äº«ä½ çš„æƒ³æ³•...\")}\r\n              className=\"min-h-[150px] border-none shadow-none resize-none focus-visible:ring-0 p-0 text-base whitespace-pre-wrap\"\r\n            />\r\n\r\n            {/* å›¾ç‰‡é¢„è§ˆ */}\r\n            {imageUrls.length > 0 && (\r\n              <div className=\"grid grid-cols-3 gap-2\">\r\n                {imageUrls.map((url, index) => (\r\n                  <div key={index} className=\"relative aspect-square rounded-lg overflow-hidden bg-muted\">\r\n                    <img \r\n                      src={url} \r\n                      alt=\"\" \r\n                      className=\"w-full h-full object-cover\" \r\n                    />\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={() => removeImage(index)}\r\n                      className=\"absolute top-1 right-1 p-1 bg-black/50 rounded-full text-white hover:bg-black/70\"\r\n                    >\r\n                      <X className=\"h-3 w-3\" />\r\n                    </button>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n\r\n            {/* è§†é¢‘é¢„è§ˆ */}\r\n            {videoUrl && (\r\n              <div className=\"relative rounded-lg overflow-hidden\">\r\n                <video src={videoUrl} controls className=\"w-full max-h-48\" preload=\"metadata\" />\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={removeVideo}\r\n                  className=\"absolute top-2 right-2 p-1 bg-black/50 rounded-full text-white hover:bg-black/70\"\r\n                >\r\n                  <X className=\"h-4 w-4\" />\r\n                </button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* å…³è”ä¿¡æ¯åŒº */}\r\n        <div className=\"px-4 py-2 pb-0 bg-background shrink-0 space-y-2\">\r\n          <div className=\"flex items-center gap-6\">\r\n            {/* é¤å…é€‰æ‹© */}\r\n            <div className={`flex items-center gap-3 ${showRestaurantError && isRegularUser && restaurantIds.length === 0 ? 'text-destructive' : ''}`}>\r\n              <MapPin className={`h-5 w-5 shrink-0 ${showRestaurantError && isRegularUser && restaurantIds.length === 0 ? 'text-destructive' : 'text-muted-foreground'}`} />\r\n              {isMerchant ? (\r\n                <span className=\"text-sm text-muted-foreground\">\r\n                  {getMerchantRestaurantName()}\r\n                </span>\r\n              ) : (\r\n                <MultiRestaurantSelectDrawer\r\n                  open={restaurantOpen}\r\n                  onOpenChange={(open) => {\r\n                    setRestaurantOpen(open);\r\n                    if (open) setShowRestaurantError(false);\r\n                  }}\r\n                  value={restaurantIds}\r\n                  onSelect={(ids) => {\r\n                    setRestaurantIds(ids);\r\n                    setShowRestaurantError(false);\r\n                  }}\r\n                  restaurants={restaurants || []}\r\n                  required={isRegularUser}\r\n                />\r\n              )}\r\n            </div>\r\n\r\n            {/* æ´»åŠ¨é€‰æ‹© */}\r\n            <div className=\"flex items-center gap-3\">\r\n              <Calendar className=\"h-5 w-5 text-muted-foreground shrink-0\" />\r\n              <ActivitySelectDrawer\r\n                open={activityOpen}\r\n                onOpenChange={setActivityOpen}\r\n                value={activityId}\r\n                onSelect={setActivityId}\r\n                activities={activeActivities}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {/* é”™è¯¯æç¤º */}\r\n          {showRestaurantError && isRegularUser && restaurantIds.length === 0 && (\r\n            <p className=\"text-xs text-destructive pl-8\">\r\n              {t(\"community.restaurantRequired\", \"è¯·é€‰æ‹©é¤å…\")}\r\n            </p>\r\n          )}\r\n        </div>\r\n\r\n        {/* åº•éƒ¨åª’ä½“å·¥å…·æ  - å›ºå®š */}\r\n        <div className=\"flex items-center gap-6 px-4 pt-0 py-2 pb-[max(2rem,calc(env(safe-area-inset-bottom)+1rem))] bg-background shrink-0\">\r\n          <input\r\n            ref={imageInputRef}\r\n            type=\"file\"\r\n            accept=\"image/*\"\r\n            multiple\r\n            className=\"hidden\"\r\n            onChange={handleImageUpload}\r\n          />\r\n          <input\r\n            ref={videoInputRef}\r\n            type=\"file\"\r\n            accept=\"video/*\"\r\n            className=\"hidden\"\r\n            onChange={handleVideoUpload}\r\n          />\r\n\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => imageInputRef.current?.click()}\r\n            disabled={uploading || imageUrls.length >= 9}\r\n            className=\"flex items-center gap-1.5 text-muted-foreground hover:text-foreground disabled:opacity-50 transition-colors\"\r\n          >\r\n            <Image className=\"h-5 w-5\" />\r\n            <span className=\"text-sm\">{t(\"community.photo\", \"ç…§ç‰‡\")}</span>\r\n          </button>\r\n\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => videoInputRef.current?.click()}\r\n            disabled={uploading || !!videoUrl}\r\n            className=\"flex items-center gap-1.5 text-muted-foreground hover:text-foreground disabled:opacity-50 transition-colors\"\r\n          >\r\n            <Video className=\"h-5 w-5\" />\r\n            <span className=\"text-sm\">{t(\"community.video\", \"è§†é¢‘\")}</span>\r\n          </button>\r\n\r\n          <EmojiPicker\r\n            onSelect={(emoji) => setContent((prev) => prev + emoji)}\r\n          />\r\n\r\n        {uploading && <Loader2 className=\"h-5 w-5 animate-spin ml-auto\" />}\r\n        </div>\r\n        </>\r\n        )}\r\n      </SheetContent>\r\n    </Sheet>\r\n  );\r\n};\r\n\r\nexport default CreatePostDialog;\r\n","import { useCallback, useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Plus, LayoutGrid, List, Clock, Flame, LayoutList, FileText, Utensils } from \"lucide-react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Skeleton } from \"@/components/ui/skeleton\";\r\nimport PostGridCard from \"@/components/community/PostGridCard\";\r\nimport CreatePostDialog from \"@/components/community/CreatePostDialog\";\r\nimport { useCommunityPosts, useCanCreatePost, SortOption, PostTypeFilter } from \"@/hooks/useCommunityPosts\";\r\nimport { PullToRefresh } from \"@/components/PullToRefresh\";\r\nimport { useQueryClient } from \"@tanstack/react-query\";\r\nimport { useIsMobile } from \"@/hooks/use-mobile\";\r\n\r\n// Skeleton for grid card\r\nconst PostGridSkeleton = () => (\r\n  <div className=\"rounded-xl overflow-hidden bg-card border border-border/50\">\r\n    <Skeleton className=\"aspect-[4/5] w-full\" />\r\n    <div className=\"p-3 space-y-3\">\r\n      <div className=\"space-y-2\">\r\n        <Skeleton className=\"h-4 w-full\" />\r\n        <Skeleton className=\"h-4 w-3/4\" />\r\n      </div>\r\n      <div className=\"flex items-center justify-between\">\r\n        <div className=\"flex items-center gap-2\">\r\n          <Skeleton className=\"h-5 w-5 rounded-full\" />\r\n          <Skeleton className=\"h-3 w-16\" />\r\n        </div>\r\n        <Skeleton className=\"h-4 w-10\" />\r\n      </div>\r\n    </div>\r\n  </div>\r\n);\r\n\r\nconst Community = () => {\r\n  const { t } = useTranslation();\r\n  const queryClient = useQueryClient();\r\n  const isMobile = useIsMobile();\r\n  \r\n  // Layout state: 'double' for 2 columns, 'single' for 1 column (mobile only)\r\n  const [mobileLayout, setMobileLayout] = useState<'double' | 'single'>(() => {\r\n    const saved = localStorage.getItem('community-mobile-layout');\r\n    return (saved === 'single' ? 'single' : 'double') as 'double' | 'single';\r\n  });\r\n\r\n  // Sort state\r\n  const [sortBy, setSortBy] = useState<SortOption>(() => {\r\n    const saved = localStorage.getItem('community-sort');\r\n    return (saved === 'popular' ? 'popular' : 'latest') as SortOption;\r\n  });\r\n\r\n  // Post type filter state\r\n  const [postType, setPostType] = useState<PostTypeFilter>(() => {\r\n    const saved = localStorage.getItem('community-post-type');\r\n    return (['all', 'post', 'recipe'].includes(saved || '') ? saved : 'all') as PostTypeFilter;\r\n  });\r\n  \r\n  const { data: posts, isLoading } = useCommunityPosts({\r\n    status: \"approved\",\r\n    sortBy,\r\n    postType\r\n  });\r\n  const { data: canPost } = useCanCreatePost();\r\n  \r\n  // Pull-to-refresh handler - clears cache and forces fresh data\r\n  const handleRefresh = useCallback(async () => {\r\n    // Clear caches first to ensure fresh data\r\n    queryClient.removeQueries({ queryKey: ['community-posts'] });\r\n    queryClient.removeQueries({ queryKey: ['can-create-post'] });\r\n    queryClient.removeQueries({ queryKey: ['has-posted-today'] });\r\n    \r\n    // Refetch with fresh data\r\n    await Promise.all([\r\n      queryClient.invalidateQueries({ queryKey: ['community-posts'] }),\r\n      queryClient.invalidateQueries({ queryKey: ['can-create-post'] }),\r\n      queryClient.invalidateQueries({ queryKey: ['has-posted-today'] }),\r\n    ]);\r\n  }, [queryClient]);\r\n\r\n  const toggleMobileLayout = () => {\r\n    const newLayout = mobileLayout === 'double' ? 'single' : 'double';\r\n    setMobileLayout(newLayout);\r\n    localStorage.setItem('community-mobile-layout', newLayout);\r\n  };\r\n\r\n  const handleSortChange = (value: string) => {\r\n    const newSort = value as SortOption;\r\n    setSortBy(newSort);\r\n    localStorage.setItem('community-sort', newSort);\r\n  };\r\n\r\n  const handlePostTypeChange = (value: PostTypeFilter) => {\r\n    setPostType(value);\r\n    localStorage.setItem('community-post-type', value);\r\n  };\r\n\r\n  // Grid classes based on layout\r\n  // Desktop (lg+): 4 columns, Tablet (md): 3 columns, Mobile: 1 or 2 based on toggle\r\n  const getGridClasses = () => {\r\n    if (isMobile) {\r\n      return mobileLayout === 'single' \r\n        ? 'columns-1 gap-4' \r\n        : 'columns-2 gap-3';\r\n    }\r\n    // Tablet: 3 columns, Desktop: 4 columns\r\n    return 'columns-3 lg:columns-4 gap-4';\r\n  };\r\n\r\n  return (\r\n    <PullToRefresh onRefresh={handleRefresh}>\r\n      <div className=\"min-h-screen bg-secondary/20 py-8 px-4 animate-fade-in\">\r\n        <div className=\"container mx-auto max-w-5xl\">\r\n          {/* Header */}\r\n          <div className=\"flex items-center justify-between mb-4\">\r\n            <div>\r\n              <h1 className=\"text-3xl sm:text-4xl mb-2 text-primary font-medium\">\r\n                {t(\"community.title\", \"ç¤¾åŒº\")}\r\n              </h1>\r\n              <p className=\"text-muted-foreground text-base sm:text-lg\">\r\n                {t(\"community.description\", \"åˆ†äº«ç¾é£Ÿä½“éªŒï¼Œå‘ç°æ›´å¤šç²¾å½©\")}\r\n              </p>\r\n            </div>\r\n            {canPost && (\r\n              <CreatePostDialog\r\n                trigger={\r\n                  <Button size=\"sm\" className=\"gap-1.5\">\r\n                    <Plus className=\"h-4 w-4\" />\r\n                    <span className=\"hidden sm:inline\">{t(\"community.createPost\", \"å‘å¸ƒ\")}</span>\r\n                  </Button>\r\n                }\r\n              />\r\n            )}\r\n          </div>\r\n          \r\n          {/* Sort, Filter and Layout controls */}\r\n          <div className=\"flex items-center gap-2 mb-4\">\r\n            {/* Sort tabs */}\r\n            <div className=\"inline-flex h-9 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\">\r\n              <button\r\n                onClick={() => handleSortChange('latest')}\r\n                className={`inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 gap-1.5 ${\r\n                  sortBy === 'latest' \r\n                    ? 'bg-background text-foreground shadow-sm' \r\n                    : ''\r\n                }`}\r\n              >\r\n                <Clock className=\"h-3.5 w-3.5\" />\r\n                <span className=\"hidden sm:inline\">{t(\"community.sortLatest\", \"æœ€æ–°\")}</span>\r\n              </button>\r\n              <button\r\n                onClick={() => handleSortChange('popular')}\r\n                className={`inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 gap-1.5 ${\r\n                  sortBy === 'popular' \r\n                    ? 'bg-background text-foreground shadow-sm' \r\n                    : ''\r\n                }`}\r\n              >\r\n                <Flame className=\"h-3.5 w-3.5\" />\r\n                <span className=\"hidden sm:inline\">{t(\"community.sortPopular\", \"çƒ­é—¨\")}</span>\r\n              </button>\r\n            </div>\r\n\r\n            {/* Post type filter tabs */}\r\n            <div className=\"inline-flex h-9 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\">\r\n              <button\r\n                onClick={() => handlePostTypeChange('all')}\r\n                className={`inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 gap-1.5 ${\r\n                  postType === 'all' \r\n                    ? 'bg-background text-foreground shadow-sm' \r\n                    : ''\r\n                }`}\r\n              >\r\n                <LayoutList className=\"h-3.5 w-3.5\" />\r\n                <span className=\"hidden sm:inline\">{t(\"community.filterAll\", \"å…¨éƒ¨\")}</span>\r\n              </button>\r\n              <button\r\n                onClick={() => handlePostTypeChange('post')}\r\n                className={`inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 gap-1.5 ${\r\n                  postType === 'post' \r\n                    ? 'bg-background text-foreground shadow-sm' \r\n                    : ''\r\n                }`}\r\n              >\r\n                <FileText className=\"h-3.5 w-3.5\" />\r\n                <span className=\"hidden sm:inline\">{t(\"community.filterPost\", \"å¸–å­\")}</span>\r\n              </button>\r\n              <button\r\n                onClick={() => handlePostTypeChange('recipe')}\r\n                className={`inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 gap-1.5 ${\r\n                  postType === 'recipe' \r\n                    ? 'bg-background text-foreground shadow-sm' \r\n                    : ''\r\n                }`}\r\n              >\r\n                <Utensils className=\"h-3.5 w-3.5\" />\r\n                <span className=\"hidden sm:inline\">{t(\"community.filterRecipe\", \"é£Ÿè°±\")}</span>\r\n              </button>\r\n            </div>\r\n\r\n            {/* Layout toggle - only show on mobile, always on the right */}\r\n            {isMobile && (\r\n              <button\r\n                onClick={toggleMobileLayout}\r\n                className=\"ml-auto inline-flex h-9 items-center justify-center whitespace-nowrap rounded-md bg-muted px-2.5 py-1.5 text-sm font-medium text-muted-foreground ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\"\r\n                title={mobileLayout === 'double' \r\n                  ? t(\"community.singleColumn\", \"å•åˆ—å¸ƒå±€\") \r\n                  : t(\"community.doubleColumn\", \"åŒåˆ—å¸ƒå±€\")}\r\n              >\r\n                {mobileLayout === 'double' ? (\r\n                  <List className=\"h-3.5 w-3.5\" />\r\n                ) : (\r\n                  <LayoutGrid className=\"h-3.5 w-3.5\" />\r\n                )}\r\n              </button>\r\n            )}\r\n          </div>\r\n\r\n          {/* Content */}\r\n          {isLoading ? (\r\n            // Loading skeleton\r\n            <div className={getGridClasses()}>\r\n              {Array.from({ length: 8 }).map((_, i) => (\r\n                <div key={i} className=\"break-inside-avoid mb-3 sm:mb-4\">\r\n                  <PostGridSkeleton />\r\n                </div>\r\n              ))}\r\n            </div>\r\n          ) : posts && posts.length > 0 ? (\r\n            // Masonry Grid\r\n            <div className={getGridClasses()}>\r\n              {posts.map(post => (\r\n                <div key={post.id} className=\"break-inside-avoid mb-3 sm:mb-4\">\r\n                  <PostGridCard \r\n                    post={post} \r\n                    showAssociations={isMobile && mobileLayout === 'single'}\r\n                  />\r\n                </div>\r\n              ))}\r\n            </div>\r\n          ) : (\r\n            // Empty state\r\n            <div className=\"flex flex-col items-center justify-center min-h-[60vh] text-center px-4\">\r\n              <div className=\"w-20 h-20 rounded-full bg-muted/50 flex items-center justify-center mb-4\">\r\n                <Plus className=\"w-8 h-8 text-muted-foreground/50\" />\r\n              </div>\r\n              <p className=\"text-muted-foreground text-lg\">\r\n                {t(\"community.noPosts\", \"æš‚æ— å¸–å­\")}\r\n              </p>\r\n              {canPost && (\r\n                <p className=\"mt-2 text-sm text-muted-foreground/70\">\r\n                  {t(\"community.beFirst\", \"æˆä¸ºç¬¬ä¸€ä¸ªå‘å¸–çš„äººå§ï¼\")}\r\n                </p>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </PullToRefresh>\r\n  );\r\n};\r\n\r\nexport default Community;\r\n"],"names":["PostGridCard","post","showAssociations","t","useTranslation","user","useAuth","navigate","useNavigate","getLocalizedField","useLocalizedContent","likePost","useLikePost","imageError","setImageError","useState","extendedPost","isRecipe","handleLike","e","handleCardClick","handleRestaurantClick","id","handleActivityClick","getPlainTextContent","html","content","plainContent","hasImages","hasVideo","hasMedia","imageCount","allRestaurants","r","activityTitle","maxVisibleRestaurants","getDifficultyColor","d","getDifficultyLabel","jsxs","jsx","Badge","Utensils","Play","Images","Clock","Users","restaurant","Store","Calendar","Avatar","AvatarImage","AvatarFallback","Heart","PostPointsRulesDialog","settings","usePointsSettings","postPoints","s","minLength","requireMedia","Dialog","DialogTrigger","DialogContent","DialogHeader","DialogTitle","Gift","CheckCircle","Shield","MultiRestaurantSelectDrawer","open","onOpenChange","value","onSelect","restaurants","required","maxDisplay","isMobile","useIsMobile","search","setSearch","pendingValue","setPendingValue","drawerHeight","setDrawerHeight","useEffect","viewport","updateHeight","availableHeight","targetHeight","handleOpenChange","newOpen","filteredRestaurants","name","address","searchLower","toggleRestaurant","restaurantId","prev","handleConfirm","handleDesktopToggle","newValue","selectedNames","TriggerContent","displayNames","remaining","i","triggerButton","ChevronsUpDown","RestaurantItem","isSelected","onToggle","cn","Check","MapPin","Fragment","Drawer","DrawerContent","DrawerHeader","DrawerTitle","Search","Input","X","DrawerFooter","Button","Popover","PopoverTrigger","PopoverContent","Command","React.forwardRef","className","props","ref","CommandPrimitive","CommandInput","CommandList","CommandEmpty","CommandGroup","CommandSeparator","CommandItem","ActivitySelectDrawer","activities","getSelectedName","selected","a","handleDesktopSelect","activityId","ScrollArea","activity","emojiCategories","EmojiPicker","setOpen","activeCategory","setActiveCategory","handleSelect","emoji","categoryLabels","emojiGrid","category","index","Smile","PostTypeSelector","FileText","DIFFICULTY_OPTIONS","COMMON_UNITS","RecipeBasicStep","data","coverImage","nutrition","introduction","onDataChange","onCoverImageChange","onNutritionChange","onIntroductionChange","imageInputRef","useRef","showNutrition","setShowNutrition","uploading","setUploading","handleImageUpload","file","toast","supabase","fileExt","fileName","uploadError","publicUrl","error","Label","Loader2","Image","Textarea","ChefHat","Select","SelectTrigger","SelectValue","SelectContent","option","SelectItem","Collapsible","CollapsibleTrigger","Flame","ChevronUp","ChevronDown","CollapsibleContent","RecipeIngredientsStep","ingredients","onChange","addIngredient","updateIngredient","field","updated","removeIngredient","_","ingredient","unit","Trash2","Plus","MAX_STEP_IMAGES","RecipeStepsStep","steps","uploadingIndex","setUploadingIndex","imageInputRefs","getStepImages","step","addStep","newOrder","updateStep","removeStep","removeImage","stepIndex","imageIndex","newImages","currentImages","images","GripVertical","el","url","imgIdx","useCreateRecipe","queryClient","useQueryClient","useMutation","params","imageUrls","err","CreateRecipeWizard","onClose","onSuccess","createRecipe","currentStep","setCurrentStep","setCoverImage","recipeData","setRecipeData","setIngredients","setSteps","setNutrition","setIntroduction","STEPS","progress","validateBasicStep","validateIngredientsStep","validateStepsStep","handleNext","handleBack","handleSubmit","validIngredients","validSteps","hasNutrition","renderStepContent","ArrowLeft","Progress","ArrowRight","CreatePostDialog","trigger","createPost","useCreatePost","useActivities","useRestaurants","role","isMerchant","isAdmin","isSupervisor","useUserRole","merchantRestaurant","useMerchantRestaurant","hasPostedToday","checkingPost","useHasPostedToday","postType","setPostType","setContent","setImageUrls","videoUrl","setVideoUrl","setActivityId","restaurantIds","setRestaurantIds","restaurantOpen","setRestaurantOpen","activityOpen","setActivityOpen","showRestaurantError","setShowRestaurantError","videoInputRef","isRegularUser","canCreateRecipe","resetForm","activeActivities","files","uploadedUrls","extractVideoFirstFrame","videoFile","resolve","reject","video","canvas","ctx","hasResolved","captureFrame","blob","handleVideoUpload","videoExt","videoFileName","videoError","videoPublicUrl","coverBlob","coverFileName","coverError","coverUrl","removeVideo","getMerchantRestaurantName","handleRecipeSuccess","Sheet","SheetTrigger","SheetContent","VisuallyHidden.Root","SheetTitle","ids","Video","PostGridSkeleton","Skeleton","Community","mobileLayout","setMobileLayout","sortBy","setSortBy","saved","posts","isLoading","useCommunityPosts","canPost","useCanCreatePost","handleRefresh","useCallback","toggleMobileLayout","newLayout","handleSortChange","newSort","handlePostTypeChange","getGridClasses","PullToRefresh","LayoutList","List","LayoutGrid"],"mappings":"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"}