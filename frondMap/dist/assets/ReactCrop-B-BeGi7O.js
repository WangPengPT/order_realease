import{r as k,R as p}from"./vendor-react-CrHRjzzo.js";var X=Object.defineProperty,_=(s,t,e)=>t in s?X(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,u=(s,t,e)=>_(s,typeof t!="symbol"?t+"":t,e);const E={x:0,y:0,width:0,height:0,unit:"px"},R=(s,t,e)=>Math.min(Math.max(s,t),e),$=(...s)=>s.filter(t=>t&&typeof t=="string").join(" "),Y=(s,t)=>s===t||s.width===t.width&&s.height===t.height&&s.x===t.x&&s.y===t.y&&s.unit===t.unit;function I(s,t,e,r){const i=C(s,e,r);return s.width&&(i.height=i.width/t),s.height&&(i.width=i.height*t),i.y+i.height>r&&(i.height=r-i.y,i.width=i.height*t),i.x+i.width>e&&(i.width=e-i.x,i.height=i.width/t),s.unit==="%"?f(i,e,r):i}function N(s,t,e){const r=C(s,t,e);return r.x=(t-r.width)/2,r.y=(e-r.height)/2,s.unit==="%"?f(r,t,e):r}function f(s,t,e){return s.unit==="%"?{...E,...s,unit:"%"}:{unit:"%",x:s.x?s.x/t*100:0,y:s.y?s.y/e*100:0,width:s.width?s.width/t*100:0,height:s.height?s.height/e*100:0}}function C(s,t,e){return s.unit?s.unit==="px"?{...E,...s,unit:"px"}:{unit:"px",x:s.x?s.x*t/100:0,y:s.y?s.y*e/100:0,width:s.width?s.width*t/100:0,height:s.height?s.height*e/100:0}:{...E,...s,unit:"px"}}function H(s,t,e,r,i,n=0,a=0,l=r,h=i){const o={...s};let c=Math.min(n,r),w=Math.min(a,i),g=Math.min(l,r),d=Math.min(h,i);t&&(t>1?(c=a?a*t:c,w=c/t,g=l*t):(w=n?n/t:w,c=w*t,d=h/t)),o.y<0&&(o.height=Math.max(o.height+o.y,w),o.y=0),o.x<0&&(o.width=Math.max(o.width+o.x,c),o.x=0);const m=r-(o.x+o.width);m<0&&(o.x=Math.min(o.x,r-c),o.width+=m);const x=i-(o.y+o.height);if(x<0&&(o.y=Math.min(o.y,i-w),o.height+=x),o.width<c&&((e==="sw"||e=="nw")&&(o.x-=c-o.width),o.width=c),o.height<w&&((e==="nw"||e=="ne")&&(o.y-=w-o.height),o.height=w),o.width>g&&((e==="sw"||e=="nw")&&(o.x-=g-o.width),o.width=g),o.height>d&&((e==="nw"||e=="ne")&&(o.y-=d-o.height),o.height=d),t){const b=o.width/o.height;if(b<t){const D=Math.max(o.width/t,w);(e==="nw"||e=="ne")&&(o.y-=D-o.height),o.height=D}else if(b>t){const D=Math.max(o.height*t,c);(e==="sw"||e=="nw")&&(o.x-=D-o.width),o.width=D}}return o}function P(s,t,e,r){const i={...s};return t==="ArrowLeft"?r==="nw"?(i.x-=e,i.y-=e,i.width+=e,i.height+=e):r==="w"?(i.x-=e,i.width+=e):r==="sw"?(i.x-=e,i.width+=e,i.height+=e):r==="ne"?(i.y+=e,i.width-=e,i.height-=e):r==="e"?i.width-=e:r==="se"&&(i.width-=e,i.height-=e):t==="ArrowRight"&&(r==="nw"?(i.x+=e,i.y+=e,i.width-=e,i.height-=e):r==="w"?(i.x+=e,i.width-=e):r==="sw"?(i.x+=e,i.width-=e,i.height-=e):r==="ne"?(i.y-=e,i.width+=e,i.height+=e):r==="e"?i.width+=e:r==="se"&&(i.width+=e,i.height+=e)),t==="ArrowUp"?r==="nw"?(i.x-=e,i.y-=e,i.width+=e,i.height+=e):r==="n"?(i.y-=e,i.height+=e):r==="ne"?(i.y-=e,i.width+=e,i.height+=e):r==="sw"?(i.x+=e,i.width-=e,i.height-=e):r==="s"?i.height-=e:r==="se"&&(i.width-=e,i.height-=e):t==="ArrowDown"&&(r==="nw"?(i.x+=e,i.y+=e,i.width-=e,i.height-=e):r==="n"?(i.y+=e,i.height-=e):r==="ne"?(i.y+=e,i.width-=e,i.height-=e):r==="sw"?(i.x-=e,i.width+=e,i.height+=e):r==="s"?i.height+=e:r==="se"&&(i.width+=e,i.height+=e)),i}const M={capture:!0,passive:!1};let S=0;const v=class y extends k.PureComponent{constructor(){super(...arguments),u(this,"docMoveBound",!1),u(this,"mouseDownOnCrop",!1),u(this,"dragStarted",!1),u(this,"evData",{startClientX:0,startClientY:0,startCropX:0,startCropY:0,clientX:0,clientY:0,isResize:!0}),u(this,"componentRef",k.createRef()),u(this,"mediaRef",k.createRef()),u(this,"resizeObserver"),u(this,"initChangeCalled",!1),u(this,"instanceId",`rc-${S++}`),u(this,"state",{cropIsActive:!1,newCropIsBeingDrawn:!1}),u(this,"onCropPointerDown",t=>{const{crop:e,disabled:r}=this.props,i=this.getBox();if(!e)return;const n=C(e,i.width,i.height);if(r)return;t.cancelable&&t.preventDefault(),this.bindDocMove(),this.componentRef.current.focus({preventScroll:!0});const a=t.target.dataset.ord,l=!!a;let h=t.clientX,o=t.clientY,c=n.x,w=n.y;if(a){const g=t.clientX-i.x,d=t.clientY-i.y;let m=0,x=0;a==="ne"||a=="e"?(m=g-(n.x+n.width),x=d-n.y,c=n.x,w=n.y+n.height):a==="se"||a==="s"?(m=g-(n.x+n.width),x=d-(n.y+n.height),c=n.x,w=n.y):a==="sw"||a=="w"?(m=g-n.x,x=d-(n.y+n.height),c=n.x+n.width,w=n.y):(a==="nw"||a=="n")&&(m=g-n.x,x=d-n.y,c=n.x+n.width,w=n.y+n.height),h=c+i.x+m,o=w+i.y+x}this.evData={startClientX:h,startClientY:o,startCropX:c,startCropY:w,clientX:t.clientX,clientY:t.clientY,isResize:l,ord:a},this.mouseDownOnCrop=!0,this.setState({cropIsActive:!0})}),u(this,"onComponentPointerDown",t=>{const{crop:e,disabled:r,locked:i,keepSelection:n,onChange:a}=this.props,l=this.getBox();if(r||i||n&&e)return;t.cancelable&&t.preventDefault(),this.bindDocMove(),this.componentRef.current.focus({preventScroll:!0});const h=t.clientX-l.x,o=t.clientY-l.y,c={unit:"px",x:h,y:o,width:0,height:0};this.evData={startClientX:t.clientX,startClientY:t.clientY,startCropX:h,startCropY:o,clientX:t.clientX,clientY:t.clientY,isResize:!0},this.mouseDownOnCrop=!0,a(C(c,l.width,l.height),f(c,l.width,l.height)),this.setState({cropIsActive:!0,newCropIsBeingDrawn:!0})}),u(this,"onDocPointerMove",t=>{const{crop:e,disabled:r,onChange:i,onDragStart:n}=this.props,a=this.getBox();if(r||!e||!this.mouseDownOnCrop)return;t.cancelable&&t.preventDefault(),this.dragStarted||(this.dragStarted=!0,n&&n(t));const{evData:l}=this;l.clientX=t.clientX,l.clientY=t.clientY;let h;l.isResize?h=this.resizeCrop():h=this.dragCrop(),Y(e,h)||i(C(h,a.width,a.height),f(h,a.width,a.height))}),u(this,"onComponentKeyDown",t=>{const{crop:e,disabled:r,onChange:i,onComplete:n}=this.props;if(r)return;const a=t.key;let l=!1;if(!e)return;const h=this.getBox(),o=this.makePixelCrop(h),c=(navigator.platform.match("Mac")?t.metaKey:t.ctrlKey)?y.nudgeStepLarge:t.shiftKey?y.nudgeStepMedium:y.nudgeStep;if(a==="ArrowLeft"?(o.x-=c,l=!0):a==="ArrowRight"?(o.x+=c,l=!0):a==="ArrowUp"?(o.y-=c,l=!0):a==="ArrowDown"&&(o.y+=c,l=!0),l){t.cancelable&&t.preventDefault(),o.x=R(o.x,0,h.width-o.width),o.y=R(o.y,0,h.height-o.height);const w=C(o,h.width,h.height),g=f(o,h.width,h.height);i(w,g),n&&n(w,g)}}),u(this,"onHandlerKeyDown",(t,e)=>{const{aspect:r=0,crop:i,disabled:n,minWidth:a=0,minHeight:l=0,maxWidth:h,maxHeight:o,onChange:c,onComplete:w}=this.props,g=this.getBox();if(n||!i)return;if(t.key==="ArrowUp"||t.key==="ArrowDown"||t.key==="ArrowLeft"||t.key==="ArrowRight")t.stopPropagation(),t.preventDefault();else return;const d=(navigator.platform.match("Mac")?t.metaKey:t.ctrlKey)?y.nudgeStepLarge:t.shiftKey?y.nudgeStepMedium:y.nudgeStep,m=C(i,g.width,g.height),x=P(m,t.key,d,e),b=H(x,r,e,g.width,g.height,a,l,h,o);if(!Y(i,b)){const D=f(b,g.width,g.height);c(b,D),w&&w(b,D)}}),u(this,"onDocPointerDone",t=>{const{crop:e,disabled:r,onComplete:i,onDragEnd:n}=this.props,a=this.getBox();this.unbindDocMove(),!(r||!e)&&this.mouseDownOnCrop&&(this.mouseDownOnCrop=!1,this.dragStarted=!1,n&&n(t),i&&i(C(e,a.width,a.height),f(e,a.width,a.height)),this.setState({cropIsActive:!1,newCropIsBeingDrawn:!1}))}),u(this,"onDragFocus",()=>{var t;(t=this.componentRef.current)==null||t.scrollTo(0,0)})}get document(){return document}getBox(){const t=this.mediaRef.current;if(!t)return{x:0,y:0,width:0,height:0};const{x:e,y:r,width:i,height:n}=t.getBoundingClientRect();return{x:e,y:r,width:i,height:n}}componentDidUpdate(t){const{crop:e,onComplete:r}=this.props;if(r&&!t.crop&&e){const{width:i,height:n}=this.getBox();i&&n&&r(C(e,i,n),f(e,i,n))}}componentWillUnmount(){this.resizeObserver&&this.resizeObserver.disconnect(),this.unbindDocMove()}bindDocMove(){this.docMoveBound||(this.document.addEventListener("pointermove",this.onDocPointerMove,M),this.document.addEventListener("pointerup",this.onDocPointerDone,M),this.document.addEventListener("pointercancel",this.onDocPointerDone,M),this.docMoveBound=!0)}unbindDocMove(){this.docMoveBound&&(this.document.removeEventListener("pointermove",this.onDocPointerMove,M),this.document.removeEventListener("pointerup",this.onDocPointerDone,M),this.document.removeEventListener("pointercancel",this.onDocPointerDone,M),this.docMoveBound=!1)}getCropStyle(){const{crop:t}=this.props;if(t)return{top:`${t.y}${t.unit}`,left:`${t.x}${t.unit}`,width:`${t.width}${t.unit}`,height:`${t.height}${t.unit}`}}dragCrop(){const{evData:t}=this,e=this.getBox(),r=this.makePixelCrop(e),i=t.clientX-t.startClientX,n=t.clientY-t.startClientY;return r.x=R(t.startCropX+i,0,e.width-r.width),r.y=R(t.startCropY+n,0,e.height-r.height),r}getPointRegion(t,e,r,i){const{evData:n}=this,a=n.clientX-t.x,l=n.clientY-t.y;let h;i&&e?h=e==="nw"||e==="n"||e==="ne":h=l<n.startCropY;let o;return r&&e?o=e==="nw"||e==="w"||e==="sw":o=a<n.startCropX,o?h?"nw":"sw":h?"ne":"se"}resolveMinDimensions(t,e,r=0,i=0){const n=Math.min(r,t.width),a=Math.min(i,t.height);return!e||!n&&!a?[n,a]:e>1?n?[n,n/e]:[a*e,a]:a?[a*e,a]:[n,n/e]}resizeCrop(){const{evData:t}=this,{aspect:e=0,maxWidth:r,maxHeight:i}=this.props,n=this.getBox(),[a,l]=this.resolveMinDimensions(n,e,this.props.minWidth,this.props.minHeight);let h=this.makePixelCrop(n);const o=this.getPointRegion(n,t.ord,a,l),c=t.ord||o;let w=t.clientX-t.startClientX,g=t.clientY-t.startClientY;(a&&c==="nw"||c==="w"||c==="sw")&&(w=Math.min(w,-a)),(l&&c==="nw"||c==="n"||c==="ne")&&(g=Math.min(g,-l));const d={unit:"px",x:0,y:0,width:0,height:0};o==="ne"?(d.x=t.startCropX,d.width=w,e?(d.height=d.width/e,d.y=t.startCropY-d.height):(d.height=Math.abs(g),d.y=t.startCropY-d.height)):o==="se"?(d.x=t.startCropX,d.y=t.startCropY,d.width=w,e?d.height=d.width/e:d.height=g):o==="sw"?(d.x=t.startCropX+w,d.y=t.startCropY,d.width=Math.abs(w),e?d.height=d.width/e:d.height=g):o==="nw"&&(d.x=t.startCropX+w,d.width=Math.abs(w),e?(d.height=d.width/e,d.y=t.startCropY-d.height):(d.height=Math.abs(g),d.y=t.startCropY+g));const m=H(d,e,o,n.width,n.height,a,l,r,i);return e||y.xyOrds.indexOf(c)>-1?h=m:y.xOrds.indexOf(c)>-1?(h.x=m.x,h.width=m.width):y.yOrds.indexOf(c)>-1&&(h.y=m.y,h.height=m.height),h.x=R(h.x,0,n.width-h.width),h.y=R(h.y,0,n.height-h.height),h}renderCropSelection(){const{ariaLabels:t=y.defaultProps.ariaLabels,disabled:e,locked:r,renderSelectionAddon:i,ruleOfThirds:n,crop:a}=this.props,l=this.getCropStyle();if(a)return p.createElement("div",{style:l,className:"ReactCrop__crop-selection",onPointerDown:this.onCropPointerDown,"aria-label":t.cropArea,tabIndex:0,onKeyDown:this.onComponentKeyDown,role:"group"},!e&&!r&&p.createElement("div",{className:"ReactCrop__drag-elements",onFocus:this.onDragFocus},p.createElement("div",{className:"ReactCrop__drag-bar ord-n","data-ord":"n"}),p.createElement("div",{className:"ReactCrop__drag-bar ord-e","data-ord":"e"}),p.createElement("div",{className:"ReactCrop__drag-bar ord-s","data-ord":"s"}),p.createElement("div",{className:"ReactCrop__drag-bar ord-w","data-ord":"w"}),p.createElement("div",{className:"ReactCrop__drag-handle ord-nw","data-ord":"nw",tabIndex:0,"aria-label":t.nwDragHandle,onKeyDown:h=>this.onHandlerKeyDown(h,"nw"),role:"button"}),p.createElement("div",{className:"ReactCrop__drag-handle ord-n","data-ord":"n",tabIndex:0,"aria-label":t.nDragHandle,onKeyDown:h=>this.onHandlerKeyDown(h,"n"),role:"button"}),p.createElement("div",{className:"ReactCrop__drag-handle ord-ne","data-ord":"ne",tabIndex:0,"aria-label":t.neDragHandle,onKeyDown:h=>this.onHandlerKeyDown(h,"ne"),role:"button"}),p.createElement("div",{className:"ReactCrop__drag-handle ord-e","data-ord":"e",tabIndex:0,"aria-label":t.eDragHandle,onKeyDown:h=>this.onHandlerKeyDown(h,"e"),role:"button"}),p.createElement("div",{className:"ReactCrop__drag-handle ord-se","data-ord":"se",tabIndex:0,"aria-label":t.seDragHandle,onKeyDown:h=>this.onHandlerKeyDown(h,"se"),role:"button"}),p.createElement("div",{className:"ReactCrop__drag-handle ord-s","data-ord":"s",tabIndex:0,"aria-label":t.sDragHandle,onKeyDown:h=>this.onHandlerKeyDown(h,"s"),role:"button"}),p.createElement("div",{className:"ReactCrop__drag-handle ord-sw","data-ord":"sw",tabIndex:0,"aria-label":t.swDragHandle,onKeyDown:h=>this.onHandlerKeyDown(h,"sw"),role:"button"}),p.createElement("div",{className:"ReactCrop__drag-handle ord-w","data-ord":"w",tabIndex:0,"aria-label":t.wDragHandle,onKeyDown:h=>this.onHandlerKeyDown(h,"w"),role:"button"})),i&&p.createElement("div",{className:"ReactCrop__selection-addon",onPointerDown:h=>h.stopPropagation()},i(this.state)),n&&p.createElement(p.Fragment,null,p.createElement("div",{className:"ReactCrop__rule-of-thirds-hz"}),p.createElement("div",{className:"ReactCrop__rule-of-thirds-vt"})))}makePixelCrop(t){const e={...E,...this.props.crop||{}};return C(e,t.width,t.height)}render(){const{aspect:t,children:e,circularCrop:r,className:i,crop:n,disabled:a,locked:l,style:h,ruleOfThirds:o}=this.props,{cropIsActive:c,newCropIsBeingDrawn:w}=this.state,g=n?this.renderCropSelection():null,d=$("ReactCrop",i,c&&"ReactCrop--active",a&&"ReactCrop--disabled",l&&"ReactCrop--locked",w&&"ReactCrop--new-crop",n&&t&&"ReactCrop--fixed-aspect",n&&r&&"ReactCrop--circular-crop",n&&o&&"ReactCrop--rule-of-thirds",!this.dragStarted&&n&&!n.width&&!n.height&&"ReactCrop--invisible-crop",r&&"ReactCrop--no-animate");return p.createElement("div",{ref:this.componentRef,className:d,style:h},p.createElement("div",{ref:this.mediaRef,className:"ReactCrop__child-wrapper",onPointerDown:this.onComponentPointerDown},e),n?p.createElement("svg",{className:"ReactCrop__crop-mask",width:"100%",height:"100%"},p.createElement("defs",null,p.createElement("mask",{id:`hole-${this.instanceId}`},p.createElement("rect",{width:"100%",height:"100%",fill:"white"}),r?p.createElement("ellipse",{cx:`${n.x+n.width/2}${n.unit}`,cy:`${n.y+n.height/2}${n.unit}`,rx:`${n.width/2}${n.unit}`,ry:`${n.height/2}${n.unit}`,fill:"black"}):p.createElement("rect",{x:`${n.x}${n.unit}`,y:`${n.y}${n.unit}`,width:`${n.width}${n.unit}`,height:`${n.height}${n.unit}`,fill:"black"}))),p.createElement("rect",{fill:"black",fillOpacity:.5,width:"100%",height:"100%",mask:`url(#hole-${this.instanceId})`})):void 0,g)}};u(v,"xOrds",["e","w"]),u(v,"yOrds",["n","s"]),u(v,"xyOrds",["nw","ne","se","sw"]),u(v,"nudgeStep",1),u(v,"nudgeStepMedium",10),u(v,"nudgeStepLarge",100),u(v,"defaultProps",{ariaLabels:{cropArea:"Use the arrow keys to move the crop selection area",nwDragHandle:"Use the arrow keys to move the north west drag handle to change the crop selection area",nDragHandle:"Use the up and down arrow keys to move the north drag handle to change the crop selection area",neDragHandle:"Use the arrow keys to move the north east drag handle to change the crop selection area",eDragHandle:"Use the up and down arrow keys to move the east drag handle to change the crop selection area",seDragHandle:"Use the arrow keys to move the south east drag handle to change the crop selection area",sDragHandle:"Use the up and down arrow keys to move the south drag handle to change the crop selection area",swDragHandle:"Use the arrow keys to move the south west drag handle to change the crop selection area",wDragHandle:"Use the up and down arrow keys to move the west drag handle to change the crop selection area"}});let O=v;export{I as B,N as L,O as S};
//# sourceMappingURL=ReactCrop-B-BeGi7O.js.map
