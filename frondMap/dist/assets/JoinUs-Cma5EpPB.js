import{r as p,j as e}from"./vendor-react-core-BErlw7p5.js";import{o as z,s as j,a as E,e as L,u as I,t as D}from"./vendor-forms-6GCG0Z6m.js";import{L as N}from"./vendor-router-CLK0c9aH.js";import{u as $,C as y,j as v,B as C,h as q,p as A,a2 as B,I as x,s as O,V as f}from"./index-CEqKPgls.js";import{C as V}from"./checkbox-C7r0zTfD.js";import{F as H,a as i,b as o,c,d as l,e as m,f as J}from"./form-D7KQkOcz.js";import{u as R}from"./vendor-i18n-CqcxoxDo.js";import{at as G,P as K,M as Q,w as W,o as X}from"./vendor-icons-C2Bicc1E.js";import"./vendor-editor-BdQcs4B3.js";import"./vendor-misc-DH4LiFnZ.js";import"./vendor-date-fYlqblcl.js";import"./vendor-ui-other-CPTlx-W2.js";import"./vendor-query-BS0wY7WL.js";import"./vendor-supabase-Clrw0GhO.js";import"./vendor-ui-dialog-Sv_VEL0d.js";import"./vendor-ui-dropdown-DwTcg2UT.js";const S=["booking","delivery","qrcode"],ue=()=>{const{t:s,i18n:u}=R(),[_,g]=p.useState(!1),[w,b]=p.useState(!1),{settings:n}=$(),M=p.useMemo(()=>z({name:j().min(2,{message:s("joinUs.nameMin")}),email:j().email({message:s("joinUs.emailInvalid")}),phone:j().min(6,{message:s("joinUs.phoneMin")}),restaurant_name:j().min(2,{message:s("joinUs.restaurantNameMin")}),restaurant_address:j().min(2,{message:s("joinUs.addressMin")}),features_selected:E(L(S)).min(1,{message:s("joinUs.featuresMin")})}),[s]),t=I({resolver:D(M),defaultValues:{name:"",email:"",phone:"",restaurant_name:"",restaurant_address:"",features_selected:[]}}),F=async r=>{g(!0);try{const a=u.language||"en",{error:d}=await O.functions.invoke("send-join-request-email",{body:{...r,language:a}});if(d){if(d.message.includes("rate_limit_exceeded"))f({title:s("joinUs.rateLimitError"),description:s("joinUs.rateLimitErrorDesc"),variant:"destructive"});else throw d;return}b(!0),t.reset(),f({title:s("joinUs.successTitle"),description:s("joinUs.successDescription")})}catch(a){console.error("Error submitting join request:",a),f({title:s("common.error"),description:s("joinUs.submitError"),variant:"destructive"})}finally{g(!1)}},T=()=>{const r=u.language;return r==="zh"&&n?.join_success_title_zh?n.join_success_title_zh:r==="pt"&&n?.join_success_title_pt?n.join_success_title_pt:n?.join_success_title_en?n.join_success_title_en:s("joinUs.successTitle")},P=()=>{const r=u.language;return r==="zh"&&n?.join_success_message_zh?n.join_success_message_zh:r==="pt"&&n?.join_success_message_pt?n.join_success_message_pt:n?.join_success_message_en?n.join_success_message_en:s("joinUs.successMessage")},U=n?.join_contact_phone||"968815050",h=n?.contact_email;return w?e.jsx("div",{className:"min-h-screen pt-20 pb-12 px-4 bg-secondary/20",children:e.jsx("div",{className:"container mx-auto max-w-2xl",children:e.jsx(y,{className:"border-primary",children:e.jsxs(v,{className:"pt-12 pb-12 text-center",children:[e.jsx(G,{className:"w-16 h-16 text-primary mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-4",children:T()}),e.jsx("p",{className:"text-muted-foreground mb-4 max-w-md mx-auto",children:P()}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4 mb-6",children:[e.jsxs("a",{href:`tel:${U}`,className:"flex items-center gap-2 text-primary font-semibold hover:underline",children:[e.jsx(K,{className:"w-5 h-5"}),e.jsx("span",{children:U})]}),h&&e.jsxs("a",{href:`mailto:${h}`,className:"flex items-center gap-2 text-primary font-semibold hover:underline",children:[e.jsx(Q,{className:"w-5 h-5"}),e.jsx("span",{children:h})]})]}),e.jsx(C,{onClick:()=>b(!1),children:s("joinUs.submitAnother")})]})})})}):e.jsx("div",{className:"min-h-screen pt-4 pb-12 px-4 bg-secondary/20",children:e.jsx("div",{className:"container mx-auto max-w-3xl",children:e.jsxs(y,{children:[e.jsxs(q,{className:"text-center space-y-2",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(W,{className:"w-12 h-12 text-primary"})}),e.jsx(A,{className:"text-3xl font-bold",children:s("joinUs.title")}),e.jsx(B,{className:"text-base",children:s("joinUs.description")})]}),e.jsx(v,{children:e.jsx(H,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(F),className:"space-y-6",children:[e.jsx(i,{control:t.control,name:"name",render:({field:r})=>e.jsxs(o,{children:[e.jsx(c,{children:s("joinUs.name")}),e.jsx(l,{children:e.jsx(x,{placeholder:s("joinUs.namePlaceholder"),...r})}),e.jsx(m,{})]})}),e.jsx(i,{control:t.control,name:"email",render:({field:r})=>e.jsxs(o,{children:[e.jsx(c,{children:s("joinUs.email")}),e.jsx(l,{children:e.jsx(x,{type:"email",placeholder:s("joinUs.emailPlaceholder"),...r})}),e.jsx(m,{})]})}),e.jsx(i,{control:t.control,name:"phone",render:({field:r})=>e.jsxs(o,{children:[e.jsx(c,{children:s("joinUs.phone")}),e.jsx(l,{children:e.jsx(x,{type:"tel",placeholder:s("joinUs.phonePlaceholder"),...r})}),e.jsx(m,{})]})}),e.jsx(i,{control:t.control,name:"restaurant_name",render:({field:r})=>e.jsxs(o,{children:[e.jsx(c,{children:s("joinUs.restaurantName")}),e.jsx(l,{children:e.jsx(x,{placeholder:s("joinUs.restaurantNamePlaceholder"),...r})}),e.jsx(m,{})]})}),e.jsx(i,{control:t.control,name:"restaurant_address",render:({field:r})=>e.jsxs(o,{children:[e.jsx(c,{children:s("joinUs.restaurantAddress")}),e.jsx(l,{children:e.jsx(x,{placeholder:s("joinUs.restaurantAddressPlaceholder"),...r})}),e.jsx(m,{})]})}),e.jsx(i,{control:t.control,name:"features_selected",render:()=>e.jsxs(o,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(c,{children:s("joinUs.featuresNeeded")}),e.jsx(J,{children:s("joinUs.featuresDescription")})]}),S.map(r=>e.jsx(i,{control:t.control,name:"features_selected",render:({field:a})=>e.jsxs(o,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(l,{children:e.jsx(V,{checked:a.value?.includes(r),onCheckedChange:d=>d?a.onChange([...a.value,r]):a.onChange(a.value?.filter(k=>k!==r))})}),e.jsx(c,{className:"font-normal cursor-pointer",children:s(`joinUs.feature.${r}`)})]},r)},r)),e.jsx(m,{})]})}),e.jsxs("div",{className:"text-xs text-muted-foreground text-center pb-4",children:[s("joinUs.consentText")," ",e.jsx(N,{to:"/privacy-policy",className:"text-primary hover:underline",children:s("joinUs.privacyPolicy")})," ",s("joinUs.and")," ",e.jsx(N,{to:"/terms-of-service",className:"text-primary hover:underline",children:s("joinUs.termsOfService")})]}),e.jsxs(C,{type:"submit",className:"w-full",size:"lg",disabled:_,children:[_&&e.jsx(X,{className:"mr-2 h-4 w-4 animate-spin"}),s("joinUs.submit")]})]})})})]})})})};export{ue as default};
//# sourceMappingURL=JoinUs-Cma5EpPB.js.map
