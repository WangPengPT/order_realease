import{p as F,r as x,j as e,ea as J,bf as Q,bD as X,eb as K,ec as Y,ee as W,X as ce,bj as de,a4 as me,W as oe,bc as H,be as U,b3 as V,bq as q}from"./vendor-react-3frukg7q.js";import{C as L,g as b,p as Z,P as ee,Q as se,R as te,q as G,B as D}from"./index-DBl0LkXN.js";import{S as O}from"./separator-BdVmvCyt.js";import{u as ne}from"./useLocalizedContent-CqXl0rku.js";import{T as B}from"./TranslateButton-C6gyvyhH.js";import{H as re,p as ae,I as ie,J as le}from"./vendor-utils-vwQGbBim.js";import{P as xe}from"./progress-CNQkUshi.js";const ue=({post:s,onStartCooking:S})=>{const{t,i18n:d}=F(),{getLocalizedField:p}=ne(),[v,u]=x.useState(null),[f,h]=x.useState(null),[g,j]=x.useState({}),N=f||(()=>{const o={zh:"content_zh",en:"content_en",pt:"content_pt"}[d.language]||"content",c=s[o];return c&&typeof c=="string"&&c.trim()?c:s.content})(),y=v||p(s,"recipe_name")||s.recipe_name,w=()=>{const r=[];if(s.recipe_name&&r.push(`[NAME]${s.recipe_name}`),s.content&&s.content.trim()&&!s.content.includes("主要配料：")&&r.push(`[CONTENT]${s.content}`),s.ingredients&&s.ingredients.length>0){const o=s.ingredients.map(c=>c.name).join("|");r.push(`[INGREDIENTS]${o}`)}return r.join(`
---
`)},k=r=>{if(!r){u(null),h(null),j({});return}r.split(`
---
`).forEach(c=>{if(c.startsWith("[NAME]"))u(c.replace("[NAME]",""));else if(c.startsWith("[CONTENT]"))h(c.replace("[CONTENT]",""));else if(c.startsWith("[INGREDIENTS]")){const R=c.replace("[INGREDIENTS]","").split("|"),M={};R.forEach((A,n)=>{M[n]=A.trim()}),j(M)}})},i=()=>{switch(d.language){case"zh":return le;case"pt":return ie;default:return ae}},m=r=>{switch(r){case"easy":return"bg-green-500/20 text-green-700 dark:text-green-400 border-green-500/30";case"medium":return"bg-yellow-500/20 text-yellow-700 dark:text-yellow-400 border-yellow-500/30";case"hard":return"bg-red-500/20 text-red-700 dark:text-red-400 border-red-500/30";default:return"bg-muted text-muted-foreground"}},C=r=>{switch(r){case"easy":return t("recipe.difficulty.easy","简单");case"medium":return t("recipe.difficulty.medium","中等");case"hard":return t("recipe.difficulty.hard","困难");default:return r}},_=s.image_urls&&s.image_urls.length>0,E=s.steps&&s.steps.length>0;return e.jsxs(L,{className:"overflow-hidden",children:[_&&e.jsxs("div",{className:"relative aspect-video overflow-hidden",children:[e.jsx("img",{src:s.image_urls[0],alt:y||"",className:"w-full h-full object-cover"}),e.jsxs(b,{className:"absolute top-3 left-3 bg-primary text-primary-foreground gap-1",children:[e.jsx(J,{className:"h-3 w-3"}),t("recipe.badge","食谱")]})]}),e.jsxs(Z,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsxs(ee,{className:"h-10 w-10",children:[e.jsx(se,{src:s.author?.avatar_url||void 0}),e.jsx(te,{children:s.author?.display_name?.charAt(0)||"?"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:s.author?.display_name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:re(new Date(s.created_at),{addSuffix:!0,locale:i()})})]})]}),e.jsx("div",{className:"mb-2",children:e.jsx(B,{text:w(),onTranslation:k,label:t("recipe.translateAll")})}),e.jsx("h2",{className:"text-xl font-bold",children:y}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-3",children:[s.cook_time&&e.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-muted-foreground",children:[e.jsx(Q,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.cook_time," ",t("recipe.minutes","分钟")]})]}),s.servings&&e.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-muted-foreground",children:[e.jsx(X,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.servings," ",t("recipe.servings","人份")]})]}),s.difficulty&&e.jsxs(b,{variant:"outline",className:m(s.difficulty),children:[e.jsx(K,{className:"h-3 w-3 mr-1"}),C(s.difficulty)]})]})]}),e.jsxs(G,{className:"space-y-6",children:[s.content&&s.content.trim()&&!s.content.includes("主要配料：")&&e.jsx("div",{children:e.jsx("p",{className:"text-sm text-muted-foreground whitespace-pre-line",children:N})}),s.nutrition&&(s.nutrition.calories||s.nutrition.protein||s.nutrition.carbs||s.nutrition.fat)&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-sm mb-3 flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4 text-orange-500"}),t("recipe.nutrition","营养信息")]}),e.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[s.nutrition.calories&&e.jsxs("div",{className:"text-center p-2 bg-muted/50 rounded-lg",children:[e.jsx("p",{className:"text-lg font-bold text-primary",children:s.nutrition.calories}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t("recipe.kcal","千卡")})]}),s.nutrition.protein&&e.jsxs("div",{className:"text-center p-2 bg-muted/50 rounded-lg",children:[e.jsxs("p",{className:"text-lg font-bold text-primary",children:[s.nutrition.protein,"g"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t("recipe.protein","蛋白质")})]}),s.nutrition.carbs&&e.jsxs("div",{className:"text-center p-2 bg-muted/50 rounded-lg",children:[e.jsxs("p",{className:"text-lg font-bold text-primary",children:[s.nutrition.carbs,"g"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t("recipe.carbs","碳水")})]}),s.nutrition.fat&&e.jsxs("div",{className:"text-center p-2 bg-muted/50 rounded-lg",children:[e.jsxs("p",{className:"text-lg font-bold text-primary",children:[s.nutrition.fat,"g"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t("recipe.fat","脂肪")})]})]})]}),e.jsx(O,{}),s.ingredients&&s.ingredients.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-sm mb-3",children:[t("recipe.ingredients","食材")," (",s.ingredients.length,")"]}),e.jsx("ul",{className:"space-y-2",children:s.ingredients.map((r,o)=>e.jsxs("li",{className:"flex items-center justify-between text-sm py-1.5 border-b border-border/50 last:border-0",children:[e.jsx("span",{children:g[o]||r.name}),e.jsxs("span",{className:"text-muted-foreground ml-2 shrink-0",children:[r.amount," ",r.unit]})]},o))})]}),s.recipe_tags&&s.recipe_tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 pt-2",children:s.recipe_tags.map((r,o)=>e.jsxs(b,{variant:"secondary",className:"text-xs",children:["#",r]},o))}),E&&e.jsxs(D,{size:"lg",className:"w-full gap-2 h-14 text-lg",onClick:S,children:[e.jsx(W,{className:"h-6 w-6"}),t("recipe.startCooking","开始烹饪"),e.jsxs(b,{variant:"secondary",className:"ml-2",children:[s.steps.length," ",t("recipe.stepsCount","步")]})]})]})]})},he=({steps:s,onExit:S})=>{const{t}=F(),[d,p]=x.useState(0),[v,u]=x.useState({}),f=[...s].sort((i,m)=>i.order-m.order),h=f.length,g=f[d],j=(d+1)/h*100,T=d===h-1,N=d===0,y=()=>{T||p(i=>i+1)},w=()=>{N||p(i=>i-1)},k=()=>{S()};return e.jsxs("div",{className:"flex flex-col h-full min-h-[60vh]",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b bg-background sticky top-0 z-10",children:[e.jsx(D,{variant:"ghost",size:"icon",onClick:S,children:e.jsx(ce,{className:"h-5 w-5"})}),e.jsx("span",{className:"font-medium",children:t("recipe.stepProgress","步骤 {{current}} / {{total}}",{current:d+1,total:h})}),e.jsx(B,{text:f.map(i=>i.description).join(`
---
`),onTranslation:i=>{if(i){const m=i.split(`
---
`),C={};m.forEach((_,E)=>{C[E]=_}),u(C)}else u({})}})]}),e.jsx(xe,{value:j,className:"h-1 rounded-none"}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[e.jsx("div",{className:"flex items-center justify-center mb-6",children:e.jsx("div",{className:"w-16 h-16 rounded-full bg-primary text-primary-foreground flex items-center justify-center text-2xl font-bold shadow-lg",children:g.order})}),g.image_url&&e.jsx("div",{className:"mb-6 rounded-xl overflow-hidden",children:e.jsx("img",{src:g.image_url,alt:`Step ${g.order}`,className:"w-full h-auto max-h-64 object-cover"})}),e.jsx("p",{className:"text-lg leading-relaxed text-center",children:v[d]||g.description})]}),e.jsx("div",{className:"flex justify-center gap-1.5 py-3",children:f.map((i,m)=>e.jsx("button",{className:`w-2 h-2 rounded-full transition-all ${m===d?"bg-primary w-6":m<d?"bg-primary/50":"bg-muted-foreground/30"}`,onClick:()=>p(m)},m))}),e.jsxs("div",{className:"flex items-center justify-between p-4 border-t bg-background",children:[e.jsxs(D,{variant:"outline",size:"lg",onClick:w,disabled:N,className:"gap-2",children:[e.jsx(de,{className:"h-5 w-5"}),t("recipe.prevStep","上一步")]}),T?e.jsxs(D,{size:"lg",onClick:k,className:"gap-2",variant:"default",children:[e.jsx(me,{className:"h-5 w-5"}),t("recipe.complete","完成")]}):e.jsxs(D,{size:"lg",onClick:y,className:"gap-2",children:[t("recipe.nextStep","下一步"),e.jsx(oe,{className:"h-5 w-5"})]})]})]})},ye=({post:s,showActions:S=!1})=>{const{t,i18n:d}=F(),{getLocalizedField:p}=ne(),[v,u]=x.useState("guided"),[f,h]=x.useState("overview"),[g,j]=x.useState(null),[T,N]=x.useState(null),[y,w]=x.useState({}),[k,i]=x.useState({}),C=T||(()=>{const l={zh:"content_zh",en:"content_en",pt:"content_pt"}[d.language]||"content",a=s[l];return a&&typeof a=="string"&&a.trim()?a:s.content})(),_=g||p(s,"recipe_name")||s.recipe_name,E=()=>{const n=[];if(s.recipe_name&&n.push(`[NAME]${s.recipe_name}`),s.content&&s.content.trim()&&!s.content.includes("主要配料：")&&n.push(`[CONTENT]${s.content}`),s.ingredients&&s.ingredients.length>0){const l=s.ingredients.map(a=>a.name).join("|");n.push(`[INGREDIENTS]${l}`)}if(s.steps&&s.steps.length>0){const l=s.steps.sort((a,z)=>a.order-z.order).map(a=>a.description).join("|");n.push(`[STEPS]${l}`)}return n.join(`
---
`)},r=n=>{if(!n){j(null),N(null),w({}),i({});return}n.split(`
---
`).forEach(a=>{if(a.startsWith("[NAME]"))j(a.replace("[NAME]",""));else if(a.startsWith("[CONTENT]"))N(a.replace("[CONTENT]",""));else if(a.startsWith("[INGREDIENTS]")){const z=a.replace("[INGREDIENTS]","").split("|"),I={};z.forEach((P,$)=>{I[$]=P.trim()}),w(I)}else if(a.startsWith("[STEPS]")){const z=a.replace("[STEPS]","").split("|"),I={};z.forEach((P,$)=>{I[$]=P.trim()}),i(I)}})},o=()=>{switch(d.language){case"zh":return le;case"pt":return ie;default:return ae}},c=n=>{switch(n){case"easy":return"bg-green-500/20 text-green-700 dark:text-green-400 border-green-500/30";case"medium":return"bg-yellow-500/20 text-yellow-700 dark:text-yellow-400 border-yellow-500/30";case"hard":return"bg-red-500/20 text-red-700 dark:text-red-400 border-red-500/30";default:return"bg-muted text-muted-foreground"}},R=n=>{switch(n){case"easy":return t("recipe.difficulty.easy","简单");case"medium":return t("recipe.difficulty.medium","中等");case"hard":return t("recipe.difficulty.hard","困难");default:return n}},M=s.image_urls&&s.image_urls.length>0,A=s.steps&&s.steps.length>0;return v==="guided"&&f==="cooking"&&A?e.jsx(L,{className:"overflow-hidden",children:e.jsx(he,{steps:s.steps,onExit:()=>h("overview")})}):v==="guided"?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("div",{className:"inline-flex h-9 items-center rounded-md bg-muted p-1 text-muted-foreground",children:[e.jsxs("button",{onClick:()=>u("guided"),className:"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium transition-all gap-1.5 bg-background text-foreground shadow-sm",children:[e.jsx(W,{className:"h-4 w-4"}),t("recipe.guidedMode","流程模式")]}),e.jsxs("button",{onClick:()=>u("full"),className:"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium transition-all gap-1.5",children:[e.jsx(H,{className:"h-4 w-4"}),t("recipe.fullMode","完整模式")]})]})}),e.jsx(ue,{post:s,onStartCooking:()=>h("cooking")}),e.jsx(L,{children:e.jsx(G,{className:"py-4",children:e.jsxs("div",{className:"flex items-center gap-6 text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1.5 text-sm",children:[e.jsx(U,{className:"h-4 w-4"}),s.likes_count||0]}),e.jsxs("span",{className:"flex items-center gap-1.5 text-sm",children:[e.jsx(V,{className:"h-4 w-4"}),s.comments_count||0]}),e.jsxs("span",{className:"flex items-center gap-1.5 text-sm",children:[e.jsx(q,{className:"h-4 w-4"}),s.shares_count||0]})]})})})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("div",{className:"inline-flex h-9 items-center rounded-md bg-muted p-1 text-muted-foreground",children:[e.jsxs("button",{onClick:()=>{u("guided"),h("overview")},className:"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium transition-all gap-1.5",children:[e.jsx(W,{className:"h-4 w-4"}),t("recipe.guidedMode","流程模式")]}),e.jsxs("button",{onClick:()=>u("full"),className:"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium transition-all gap-1.5 bg-background text-foreground shadow-sm",children:[e.jsx(H,{className:"h-4 w-4"}),t("recipe.fullMode","完整模式")]})]})}),e.jsxs(L,{className:"overflow-hidden",children:[M&&e.jsxs("div",{className:"relative aspect-video overflow-hidden",children:[e.jsx("img",{src:s.image_urls[0],alt:_||"",className:"w-full h-full object-cover"}),e.jsxs(b,{className:"absolute top-3 left-3 bg-primary text-primary-foreground gap-1",children:[e.jsx(J,{className:"h-3 w-3"}),t("recipe.badge","食谱")]})]}),e.jsxs(Z,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsxs(ee,{className:"h-10 w-10",children:[e.jsx(se,{src:s.author?.avatar_url||void 0}),e.jsx(te,{children:s.author?.display_name?.charAt(0)||"?"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:s.author?.display_name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:re(new Date(s.created_at),{addSuffix:!0,locale:o()})})]})]}),e.jsx("div",{className:"mb-2",children:e.jsx(B,{text:E(),onTranslation:r,label:t("recipe.translateAllFull")})}),e.jsx("h2",{className:"text-xl font-bold",children:_}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-3",children:[s.cook_time&&e.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-muted-foreground",children:[e.jsx(Q,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.cook_time," ",t("recipe.minutes","分钟")]})]}),s.servings&&e.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-muted-foreground",children:[e.jsx(X,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.servings," ",t("recipe.servings","人份")]})]}),s.difficulty&&e.jsxs(b,{variant:"outline",className:c(s.difficulty),children:[e.jsx(K,{className:"h-3 w-3 mr-1"}),R(s.difficulty)]})]})]}),e.jsxs(G,{className:"space-y-6",children:[s.content&&s.content.trim()&&!s.content.includes("主要配料：")&&e.jsx("div",{children:e.jsx("p",{className:"text-sm text-muted-foreground whitespace-pre-line",children:C})}),s.nutrition&&(s.nutrition.calories||s.nutrition.protein||s.nutrition.carbs||s.nutrition.fat)&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-sm mb-3 flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4 text-primary"}),t("recipe.nutrition","营养信息")]}),e.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[s.nutrition.calories&&e.jsxs("div",{className:"text-center p-2 bg-muted/50 rounded-lg",children:[e.jsx("p",{className:"text-lg font-bold text-primary",children:s.nutrition.calories}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t("recipe.kcal","千卡")})]}),s.nutrition.protein&&e.jsxs("div",{className:"text-center p-2 bg-muted/50 rounded-lg",children:[e.jsxs("p",{className:"text-lg font-bold text-primary",children:[s.nutrition.protein,"g"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t("recipe.protein","蛋白质")})]}),s.nutrition.carbs&&e.jsxs("div",{className:"text-center p-2 bg-muted/50 rounded-lg",children:[e.jsxs("p",{className:"text-lg font-bold text-primary",children:[s.nutrition.carbs,"g"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t("recipe.carbs","碳水")})]}),s.nutrition.fat&&e.jsxs("div",{className:"text-center p-2 bg-muted/50 rounded-lg",children:[e.jsxs("p",{className:"text-lg font-bold text-primary",children:[s.nutrition.fat,"g"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t("recipe.fat","脂肪")})]})]})]}),e.jsx(O,{}),s.ingredients&&s.ingredients.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-sm mb-3",children:[t("recipe.ingredients","食材")," (",s.ingredients.length,")"]}),e.jsx("ul",{className:"space-y-2",children:s.ingredients.map((n,l)=>e.jsxs("li",{className:"flex items-center justify-between text-sm py-1.5 border-b border-border/50 last:border-0",children:[e.jsx("span",{children:y[l]||n.name}),e.jsxs("span",{className:"text-muted-foreground ml-2 shrink-0",children:[n.amount," ",n.unit]})]},l))})]}),e.jsx(O,{}),A&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-sm mb-3",children:[t("recipe.steps","步骤")," (",s.steps.length,")"]}),e.jsx("ol",{className:"space-y-4",children:s.steps.sort((n,l)=>n.order-l.order).map((n,l)=>e.jsxs("li",{className:"flex gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-primary text-primary-foreground flex items-center justify-center text-xs font-bold",children:n.order}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("p",{className:"text-sm",children:k[l]||n.description}),n.image_url&&e.jsx("img",{src:n.image_url,alt:`Step ${n.order}`,className:"w-full rounded-lg max-h-48 object-cover"})]})]},l))})]}),s.recipe_tags&&s.recipe_tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 pt-2",children:s.recipe_tags.map((n,l)=>e.jsxs(b,{variant:"secondary",className:"text-xs",children:["#",n]},l))}),e.jsxs("div",{className:"flex items-center gap-6 pt-4 border-t text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1.5 text-sm",children:[e.jsx(U,{className:"h-4 w-4"}),s.likes_count||0]}),e.jsxs("span",{className:"flex items-center gap-1.5 text-sm",children:[e.jsx(V,{className:"h-4 w-4"}),s.comments_count||0]}),e.jsxs("span",{className:"flex items-center gap-1.5 text-sm",children:[e.jsx(q,{className:"h-4 w-4"}),s.shares_count||0]})]})]})]})]})};export{ye as R};
//# sourceMappingURL=RecipeDetailContent-Da5BJo5H.js.map
