import{s as ve,q as te,v as he,w as V,p as we,r as g,d1 as qe,d2 as je,j as e,bj as pe,aL as ne,d3 as ze,d4 as Pe,d5 as Me,d6 as Le,bM as ue,d7 as $e,d8 as Ue,cS as He,X as se,d9 as Ke,da as Be,db as Oe,dc as Ge,a4 as Ve,bG as Qe,bK as We,bd as Ne,ab as ye,b0 as J,y as Ze,dd as Xe,b4 as Ye,b9 as Je,bh as es}from"./vendor-react-5CWRUXey.js";import{m as ie}from"./vendor-map-CvE3ASYw.js";import{s as S,u as ss,C as H,v as ts,M as as,$ as ns,w as K,B as M,y as is,z as rs,E as ls,F as os,G as cs,J as ds,I as h,g as ms,j as ps,N as us,D as hs,Y as xs,d as gs,e as fs,f as js,V as Ns,S as ys,W as r,a8 as re}from"./index-ffVqEBGu.js";import{C as O}from"./checkbox-DmbPAP2Y.js";import{S as _s}from"./switch-sI2mqXPz.js";import{T as bs,a as vs,b as le,c as oe}from"./tabs-ujzz8D5s.js";import{i as E}from"./vendor-i18n-jtdHZIRR.js";import{R as ce}from"./RichTextEditor-C9t1pcni.js";import{N as ws,O as I,P as de,T as _e,U as ee}from"./vendor-utils-Z4kpnli5.js";const Cs=a=>ve({queryKey:["dish-images",a],queryFn:async()=>{const{data:c,error:t}=await S.from("restaurant_dish_images").select("*").eq("restaurant_id",a).order("sort_order",{ascending:!0});if(t)throw t;return c},enabled:!!a}),ks=()=>{const{user:a}=ss(),c=te();return he({mutationFn:async({restaurantId:t,file:f})=>{if(!a)throw new Error("Must be logged in");const{data:j,error:x}=await S.from("restaurant_dish_images").select("id").eq("restaurant_id",t);if(x)throw x;if(j&&j.length>=10)throw new Error("MAX_IMAGES_REACHED");const m=f.name.split(".").pop(),_=`${t}/${Date.now()}-${Math.random().toString(36).substring(7)}.${m}`,{error:N}=await S.storage.from("dish-images").upload(_,f);if(N)throw N;const{data:{publicUrl:y}}=S.storage.from("dish-images").getPublicUrl(_),k=j?j.length:0,{data:w,error:v}=await S.from("restaurant_dish_images").insert({restaurant_id:t,image_url:y,sort_order:k,created_by:a.id}).select().single();if(v)throw v;return w},onSuccess:(t,f)=>{c.invalidateQueries({queryKey:["dish-images",f.restaurantId]}),V.success(E.t("dishImages.uploadSuccess"))},onError:t=>{t.message==="MAX_IMAGES_REACHED"?V.error(E.t("dishImages.maxImagesReached")):V.error(E.t("dishImages.uploadFailed"))}})},Is=()=>{const a=te();return he({mutationFn:async({imageId:c,restaurantId:t,imageUrl:f})=>{const j=f.split("/dish-images/");j[1]&&await S.storage.from("dish-images").remove([j[1]]);const{error:x}=await S.from("restaurant_dish_images").delete().eq("id",c);if(x)throw x;return{restaurantId:t}},onSuccess:c=>{a.invalidateQueries({queryKey:["dish-images",c.restaurantId]}),V.success(E.t("dishImages.deleteSuccess"))},onError:()=>{V.error(E.t("dishImages.deleteFailed"))}})},Ss=()=>{const a=te();return he({mutationFn:async({images:c,restaurantId:t})=>{const f=c.map(j=>S.from("restaurant_dish_images").update({sort_order:j.sort_order}).eq("id",j.id));return await Promise.all(f),{restaurantId:t}},onSuccess:c=>{a.invalidateQueries({queryKey:["dish-images",c.restaurantId]})}})};function Ds({image:a,index:c,onDelete:t}){const{attributes:f,listeners:j,setNodeRef:x,transform:m,transition:_,isDragging:N}=$e({id:a.id}),y={transform:Ue.Transform.toString(m),transition:_,zIndex:N?10:1,opacity:N?.8:1};return e.jsxs("div",{ref:x,style:y,className:`relative group aspect-square rounded-lg overflow-hidden border ${N?"ring-2 ring-primary shadow-lg":""}`,children:[e.jsx("div",{...f,...j,className:"absolute top-1 left-1 z-10 p-1 bg-black/60 rounded cursor-grab active:cursor-grabbing opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(He,{className:"w-4 h-4 text-white"})}),e.jsx("img",{src:a.image_url,alt:`Dish ${c+1}`,className:"w-full h-full object-cover",draggable:!1}),e.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:e.jsx(M,{type:"button",variant:"destructive",size:"icon",className:"h-8 w-8",onClick:k=>{k.preventDefault(),k.stopPropagation(),t(a.id,a.image_url)},children:e.jsx(se,{className:"w-4 h-4"})})}),e.jsx("div",{className:"absolute bottom-1 right-1 bg-black/60 text-white text-xs px-1.5 py-0.5 rounded",children:c+1})]})}function Ts({restaurantId:a}){const{t:c}=we(),t=g.useRef(null),{data:f=[],isLoading:j}=Cs(a),x=ks(),m=Is(),_=Ss(),[N,y]=g.useState(null),[k,w]=g.useState([]),[v,q]=g.useState(!1),o=k.length>0?k:f,R=qe(je(Oe,{activationConstraint:{distance:8}}),je(Be,{coordinateGetter:Ke})),Q=l=>{const{active:i,over:u}=l;if(u&&i.id!==u.id){const F=o.findIndex(p=>p.id===i.id),G=o.findIndex(p=>p.id===u.id),D=Ge(o,F,G);w(D);const X=D.map((p,T)=>({id:p.id,sort_order:T}));_.mutate({images:X,restaurantId:a},{onSuccess:()=>{w([])},onError:()=>{w([])}})}},W=async l=>{const i=l.target.files?.[0];i&&(i.size>5*1024*1024||i.type.startsWith("image/")&&(await x.mutateAsync({restaurantId:a,file:i}),t.current&&(t.current.value="")))},Z=async()=>{if(!N||v)return;const{id:l,url:i}=N;q(!0);try{await m.mutateAsync({imageId:l,restaurantId:a,imageUrl:i}),y(null)}catch(u){console.error("Delete failed:",u)}finally{q(!1)}},B=l=>{!l&&!v&&y(null)},b=o.length<10;return e.jsxs(H,{children:[e.jsxs(ts,{className:"pb-3",children:[e.jsxs(as,{className:"text-lg flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5"}),c("dishImages.title")]}),e.jsxs(ns,{children:[c("dishImages.description",{current:o.length,max:10}),o.length>1&&e.jsx("span",{className:"block mt-1 text-xs",children:c("dishImages.dragToReorder")})]})]}),e.jsxs(K,{children:[j?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(ne,{className:"w-6 h-6 animate-spin"})}):e.jsxs("div",{className:"space-y-4",children:[o.length>0&&e.jsx(ze,{sensors:R,collisionDetection:Pe,onDragEnd:Q,children:e.jsx(Me,{items:o.map(l=>l.id),strategy:Le,children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:o.map((l,i)=>e.jsx(Ds,{image:l,index:i,onDelete:(u,F)=>y({id:u,url:F})},l.id))})})}),b&&e.jsxs("div",{children:[e.jsx("input",{ref:t,type:"file",accept:"image/*",className:"hidden",onChange:W,disabled:x.isPending}),e.jsxs(M,{type:"button",variant:"outline",className:"w-full",onClick:()=>t.current?.click(),disabled:x.isPending,children:[x.isPending?e.jsx(ne,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(ue,{className:"w-4 h-4 mr-2"}),c("dishImages.upload")]})]}),!b&&e.jsx("p",{className:"text-sm text-muted-foreground text-center",children:c("dishImages.maxReached")})]}),e.jsx(is,{open:!!N,onOpenChange:B,children:e.jsx(rs,{onClick:l=>l.stopPropagation(),onKeyDown:l=>{l.key==="Enter"&&(l.preventDefault(),l.stopPropagation())},children:e.jsxs("form",{onSubmit:l=>l.preventDefault(),children:[e.jsxs(ls,{children:[e.jsx(os,{children:c("dishImages.deleteConfirmTitle")}),e.jsx(cs,{children:c("dishImages.deleteConfirmDescription")})]}),e.jsxs(ds,{className:"mt-4",children:[e.jsx(M,{type:"button",variant:"outline",onClick:l=>{l.preventDefault(),l.stopPropagation(),v||y(null)},disabled:v,children:c("common.cancel")}),e.jsxs(M,{type:"button",variant:"destructive",onClick:l=>{l.preventDefault(),l.stopPropagation(),Z()},disabled:v,children:[v?e.jsx(ne,{className:"w-4 h-4 mr-2 animate-spin"}):null,c("common.delete")]})]})]})})})]})]})}function me({value:a,onChange:c,suggestions:t,placeholder:f,className:j}){const[x,m]=g.useState(!1),[_,N]=g.useState(a),y=g.useRef(null),k=g.useRef(null),w=t.filter(o=>o.toLowerCase().includes(_.toLowerCase()));g.useEffect(()=>{N(a)},[a]),g.useEffect(()=>{const o=R=>{k.current&&!k.current.contains(R.target)&&y.current&&!y.current.contains(R.target)&&m(!1)};return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[]);const v=o=>{const R=o.target.value;N(R),c(R),m(!0)},q=o=>{N(o),c(o),m(!1),y.current?.focus()};return e.jsxs("div",{className:"relative",children:[e.jsx(h,{ref:y,value:_,onChange:v,onFocus:()=>m(!0),placeholder:f,className:j}),x&&w.length>0&&e.jsx("div",{ref:k,className:"absolute z-50 mt-1 w-full max-h-48 overflow-auto rounded-md border bg-popover p-1 shadow-md",children:w.map(o=>e.jsxs("div",{onClick:()=>q(o),className:ms("relative flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none hover:bg-accent hover:text-accent-foreground",o===_&&"bg-accent"),children:[o===_&&e.jsx(Ve,{className:"mr-2 h-4 w-4"}),e.jsx("span",{className:o===_?"":"pl-6",children:o})]},o))})]})}const Es=()=>ve({queryKey:["all-restaurant-types"],queryFn:async()=>{const{data:a,error:c}=await S.from("restaurants").select("type, type_en, type_pt");if(c)throw c;const t=new Map;a.forEach(m=>{const _=m.type||[],N=m.type_en||[],y=m.type_pt||[],k=Math.max(_.length,N.length,y.length);for(let w=0;w<k;w++){const v=_[w]||"",q=N[w]||"",o=y[w]||"",R=`${v}|${q}|${o}`;(v||q||o)&&(t.has(R)||t.set(R,{zh:v,en:q,pt:o}))}});const f=new Set,j=new Set,x=new Set;return t.forEach(m=>{m.zh&&f.add(m.zh),m.en&&j.add(m.en),m.pt&&x.add(m.pt)}),{typeSets:Array.from(t.values()),uniqueZh:Array.from(f).sort(),uniqueEn:Array.from(j).sort(),uniquePt:Array.from(x).sort()}}}),Fs=ws({name:I().min(1,E.t("validation.nameRequired")),name_en:I().min(1,E.t("validation.nameRequired")),name_pt:I().min(1,E.t("validation.nameRequired")),key_id:I().optional(),type:de(I()).min(1,E.t("validation.typeRequired")).max(3,E.t("validation.typeMaximum")),type_en:de(I()).min(1,E.t("validation.typeRequired")).max(3,E.t("validation.typeMaximum")),type_pt:de(I()).min(1,E.t("validation.typeRequired")).max(3,E.t("validation.typeMaximum")),description:I().optional(),description_en:I().optional(),description_pt:I().optional(),announcement_zh:I().optional(),announcement_en:I().optional(),announcement_pt:I().optional(),address:I().min(1,E.t("validation.addressRequired")),lat:_e(),lng:_e(),phone:I().optional(),website_url:I().optional(),show_website_button:ee().default(!0),show_takeaway_button:ee().default(!0),show_booking_button:ee().default(!0),show_dish_gallery:ee().default(!0)}),be=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];function Ks({restaurant:a,trigger:c}){const{t}=we(),{toast:f}=ps(),j=te(),{isAdmin:x}=us(),{data:m}=Es(),[_,N]=g.useState(!1),[y,k]=g.useState(null),[w,v]=g.useState(a?.image_url||null),[q,o]=g.useState(null),[R,Q]=g.useState(a?.cover_image_url||null),[W,Z]=g.useState(!1),B=g.useRef(null),b=g.useRef(null),l=g.useRef(null),[i,u]=g.useState(()=>{const s={};return be.forEach(n=>{s[n]={open:"12:00",close:"23:00",closed:!1,splitShift:!1,open2:"19:00",close2:"23:00"}}),a?.opening_hours?{...s,...a.opening_hours}:s}),[F,G]=g.useState(()=>a?.type&&Array.isArray(a.type)?a.type.map((s,n)=>({zh:s,en:a.type_en?.[n]||"",pt:a.type_pt?.[n]||""})):[{zh:"",en:"",pt:""}]),{register:D,handleSubmit:X,formState:{errors:p},setValue:T,watch:L,trigger:As}=Qe({resolver:We(Fs),defaultValues:a?{name:a.name,name_en:a.name_en||"",name_pt:a.name_pt||"",key_id:a.key_id||"",type:Array.isArray(a.type)?a.type:[a.type],type_en:Array.isArray(a.type_en)?a.type_en:a.type_en?[a.type_en]:[""],type_pt:Array.isArray(a.type_pt)?a.type_pt:a.type_pt?[a.type_pt]:[""],description:a.description||"",description_en:a.description_en||"",description_pt:a.description_pt||"",announcement_zh:a.announcement_zh||"",announcement_en:a.announcement_en||"",announcement_pt:a.announcement_pt||"",address:a.address,lat:typeof a.lat=="number"&&!isNaN(a.lat)?a.lat:38.7223,lng:typeof a.lng=="number"&&!isNaN(a.lng)?a.lng:-9.1393,phone:a.phone||"",website_url:a.website_url||"",show_website_button:a.show_website_button??!0,show_takeaway_button:a.show_takeaway_button??!0,show_booking_button:a.show_booking_button??!0,show_dish_gallery:a.show_dish_gallery??!0}:{name:"",name_en:"",name_pt:"",key_id:"",type:[""],type_en:[""],type_pt:[""],description:"",description_en:"",description_pt:"",announcement_zh:"",announcement_en:"",announcement_pt:"",address:"",lat:38.7223,lng:-9.1393,phone:"",website_url:"",show_website_button:!0,show_takeaway_button:!0,show_booking_button:!0,show_dish_gallery:!0}}),Ce=()=>{const s=[];p.name&&s.push(t("admin.fieldName")+" (ä¸­æ–‡)"),p.name_en&&s.push(t("admin.fieldName")+" (EN)"),p.name_pt&&s.push(t("admin.fieldName")+" (PT)"),p.type&&s.push(t("admin.fieldType")+" (ä¸­æ–‡)"),p.type_en&&s.push(t("admin.fieldType")+" (EN)"),p.type_pt&&s.push(t("admin.fieldType")+" (PT)"),p.address&&s.push(t("admin.fieldAddress")),(p.lat||p.lng)&&s.push(t("admin.fieldLocation")),s.length>0&&f({title:t("admin.validationFailed"),description:t("admin.missingFields")+": "+s.join(", "),variant:"destructive"})},ke=()=>{F.length<3&&G([...F,{zh:"",en:"",pt:""}])},Ie=s=>{F.length>1&&G(F.filter((n,d)=>d!==s))},ae=(s,n,d)=>{const C=[...F];C[s][n]=d,G(C),T("type",C.map(A=>A.zh).filter(Boolean)),T("type_en",C.map(A=>A.en).filter(Boolean)),T("type_pt",C.map(A=>A.pt).filter(Boolean))},z=L("lat"),P=L("lng");L("show_website_button");const Se=L("show_takeaway_button"),De=L("show_booking_button"),Te=L("show_dish_gallery"),Y=(s,n)=>typeof s=="number"&&typeof n=="number"&&!isNaN(s)&&!isNaN(n)&&isFinite(s)&&isFinite(n);g.useEffect(()=>{if(!_){b.current&&(b.current.remove(),b.current=null,l.current=null);return}if(b.current)return;const s="pk.eyJ1IjoieGlhb3hpb25nMTIzIiwiYSI6ImNtNTFjOXliYjF1Y2IyaXM4bnNzMGxvdnkifQ.mPcWqH7ndIrjEqlWIJVk8g",d=setTimeout(()=>{if(!B.current){console.error("Map container not found");return}try{ie.accessToken=s;const C=Y(z,P)?P:-9.1393,A=Y(z,P)?z:38.7223;b.current=new ie.Map({container:B.current,style:"mapbox://styles/mapbox/light-v11",center:[C,A],zoom:15}),b.current.scrollZoom.disable(),b.current.on("load",()=>{b.current&&(Y(z,P)&&(l.current=new ie.Marker({draggable:!0}).setLngLat([P,z]).addTo(b.current)),l.current.on("dragend",()=>{const $=l.current.getLngLat();T("lng",$.lng),T("lat",$.lat)}),setTimeout(()=>{b.current?.resize()},100))});const U=$=>{$.ctrlKey||$.metaKey?b.current?.scrollZoom.enable():b.current?.scrollZoom.disable()};B.current.addEventListener("wheel",U),b.current.on("click",$=>{const{lng:ge,lat:fe}=$.lngLat;T("lng",ge),T("lat",fe),l.current?.setLngLat([ge,fe])}),b.current.on("error",$=>{console.error("Map error:",$)})}catch(C){console.error("Failed to initialize map:",C)}},500);return()=>{clearTimeout(d)}},[_,z,P]),g.useEffect(()=>{l.current&&b.current&&Y(z,P)&&(l.current.setLngLat([P,z]),b.current.setCenter([P,z]))},[z,P]);const Ee=s=>{const n=s.target.files?.[0];if(n){k(n);const d=new FileReader;d.onloadend=()=>{v(d.result)},d.readAsDataURL(n)}},Fe=s=>{const n=s.target.files?.[0];if(n){o(n);const d=new FileReader;d.onloadend=()=>{Q(d.result)},d.readAsDataURL(n)}},Ae=async()=>{if(!y)return a?.image_url||null;const s=y.name.split(".").pop(),d=`${`${Math.random()}.${s}`}`,{error:C}=await S.storage.from("restaurant-images").upload(d,y);if(C)throw C;const{data:{publicUrl:A}}=S.storage.from("restaurant-images").getPublicUrl(d);return A},Re=async()=>{if(!q)return a?.cover_image_url||null;const s=q.name.split(".").pop(),d=`${`cover_${Math.random()}.${s}`}`,{error:C}=await S.storage.from("restaurant-images").upload(d,q);if(C)throw C;const{data:{publicUrl:A}}=S.storage.from("restaurant-images").getPublicUrl(d);return A},xe=async s=>{Z(!0);try{const{data:{user:n}}=await S.auth.getUser();if(!n)throw new Error("Not authenticated");const d=await Ae(),C=await Re(),A={name:s.name,name_en:s.name_en,name_pt:s.name_pt,key_id:s.key_id||null,type:s.type,type_en:s.type_en,type_pt:s.type_pt,description:s.description||null,description_en:s.description_en||null,description_pt:s.description_pt||null,announcement_zh:s.announcement_zh||null,announcement_en:s.announcement_en||null,announcement_pt:s.announcement_pt||null,address:s.address,lat:s.lat,lng:s.lng,phone:s.phone||null,website_url:s.website_url||null,show_website_button:s.show_website_button,show_takeaway_button:s.show_takeaway_button,show_booking_button:s.show_booking_button,show_dish_gallery:s.show_dish_gallery,image_url:d,cover_image_url:C,opening_hours:i};if(a){const{error:U}=await S.from("restaurants").update({...A,updated_by:n.id}).eq("id",a.id);if(U)throw U;f({title:t("common.success"),description:t("admin.restaurantUpdated")})}else{const{error:U}=await S.from("restaurants").insert([{...A,created_by:n.id}]);if(U)throw U;f({title:t("common.success"),description:t("admin.restaurantCreated")})}j.invalidateQueries({queryKey:["restaurants"]}),N(!1)}catch(n){f({title:t("common.error"),description:n.message,variant:"destructive"})}finally{Z(!1)}};return e.jsxs(hs,{open:_,onOpenChange:N,children:[e.jsx(xs,{asChild:!0,children:c}),e.jsxs(gs,{className:"max-w-[95vw] sm:max-w-6xl max-h-[95vh] overflow-hidden flex flex-col p-0",children:[e.jsxs(fs,{className:"px-6 pt-6 pb-4 border-b bg-muted/30",children:[e.jsxs(js,{className:"text-2xl flex items-center gap-2",children:[e.jsx(Ne,{className:"w-6 h-6 text-primary"}),t(a?"admin.editRestaurant":"admin.addRestaurant")]}),e.jsx(Ns,{className:"text-base",children:t(a?"admin.editRestaurantDetails":"admin.createRestaurantWithInfo")})]}),e.jsx(ys,{className:"px-6 h-[calc(95vh-220px)]",children:e.jsxs("form",{onSubmit:X(xe,Ce),className:"space-y-6 py-6",children:[e.jsx(H,{className:"border-primary/20 bg-gradient-to-br from-background to-muted/20",children:e.jsxs(K,{className:"p-6",children:[e.jsxs(r,{className:"text-base font-semibold flex items-center gap-2 mb-4",children:[e.jsx(ue,{className:"w-5 h-5 text-primary"}),t("admin.restaurantImages")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:t("admin.cardImage")}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",t("admin.cardImageHint"),")"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[w&&e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:w,alt:"Card Preview",className:"w-32 h-32 object-cover rounded-lg shadow-lg ring-2 ring-primary/20 transition-transform duration-200 group-hover:scale-105"}),e.jsx(M,{type:"button",variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>{k(null),v(null)},children:e.jsx(se,{className:"h-3 w-3"})})]}),e.jsxs(r,{htmlFor:"image-upload",className:"cursor-pointer",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2 px-6 py-4 border-2 border-dashed border-primary/30 rounded-lg hover:border-primary hover:bg-primary/5 transition-all duration-200",children:[e.jsx(ue,{className:"h-6 w-6 text-primary"}),e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"font-medium text-xs",children:t("admin.uploadImage")})})]}),e.jsx(h,{id:"image-upload",type:"file",accept:"image/*",className:"hidden",onChange:Ee})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:t("admin.coverImage")}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",t("admin.coverImageHint"),")"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[R&&e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:R,alt:"Cover Preview",className:"w-32 h-32 object-cover rounded-lg shadow-lg ring-2 ring-accent/20 transition-transform duration-200 group-hover:scale-105"}),e.jsx(M,{type:"button",variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>{o(null),Q(null)},children:e.jsx(se,{className:"h-3 w-3"})})]}),e.jsxs(r,{htmlFor:"cover-image-upload",className:"cursor-pointer",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2 px-6 py-4 border-2 border-dashed border-accent/30 rounded-lg hover:border-accent hover:bg-accent/5 transition-all duration-200",children:[e.jsx(pe,{className:"h-6 w-6 text-accent"}),e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"font-medium text-xs",children:t("admin.uploadImage")})})]}),e.jsx(h,{id:"cover-image-upload",type:"file",accept:"image/*",className:"hidden",onChange:Fe})]})]})]})]})]})}),a?.id&&e.jsx(H,{className:"border-primary/20",children:e.jsxs(K,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs(r,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5 text-primary"}),t("admin.dishGallery")]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(r,{htmlFor:"show-dish-gallery",className:"text-sm text-muted-foreground",children:t("admin.showDishGallery")}),e.jsx(_s,{id:"show-dish-gallery",checked:Te,onCheckedChange:s=>T("show_dish_gallery",s)})]})]}),e.jsx(Ts,{restaurantId:a.id})]})}),e.jsx(H,{className:"border-primary/20",children:e.jsxs(K,{className:"p-6",children:[e.jsxs(r,{className:"text-base font-semibold flex items-center gap-2 mb-4",children:[e.jsx(ye,{className:"w-5 h-5 text-primary"}),t("admin.multilingualContent")]}),e.jsxs(bs,{defaultValue:"zh",className:"w-full",children:[e.jsxs(vs,{className:"grid w-full grid-cols-3 mb-6",children:[e.jsxs(le,{value:"zh",className:"gap-2",children:["ðŸ‡¨ðŸ‡³ ",t("admin.chinese")]}),e.jsxs(le,{value:"en",className:"gap-2",children:["ðŸ‡¬ðŸ‡§ ",t("admin.english")]}),e.jsxs(le,{value:"pt",className:"gap-2",children:["ðŸ‡µðŸ‡¹ ",t("admin.portuguese")]})]}),e.jsxs(oe,{value:"zh",className:"space-y-4 mt-0",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"name",className:"text-sm font-medium",children:t("admin.restaurantName")}),e.jsx(h,{id:"name",...D("name"),placeholder:t("admin.enterRestaurantName"),className:"text-base"}),p.name&&e.jsx("p",{className:"text-sm text-destructive",children:p.name.message})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(r,{className:"text-sm font-medium",children:t("admin.restaurantType")}),F.length<3&&e.jsx(M,{type:"button",variant:"outline",size:"sm",onClick:ke,children:t("admin.addType")})]}),F.map((s,n)=>e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(me,{placeholder:t("admin.typeExample"),value:s.zh,onChange:d=>ae(n,"zh",d),suggestions:m?.uniqueZh||[]}),e.jsx(M,{type:"button",variant:"ghost",size:"icon",onClick:()=>Ie(n),disabled:F.length===1,children:e.jsx(se,{className:"h-4 w-4"})})]},n)),p.type&&e.jsx("p",{className:"text-sm text-destructive",children:p.type.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"description",className:"text-sm font-medium",children:t("admin.description")}),e.jsx(ce,{value:L("description")||"",onChange:s=>T("description",s),placeholder:t("admin.enterDescription")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"announcement_zh",className:"text-sm font-medium",children:t("admin.announcement")}),e.jsx(re,{id:"announcement_zh",...D("announcement_zh"),rows:2,placeholder:t("admin.enterAnnouncement")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t("admin.announcementHint")})]})]}),e.jsxs(oe,{value:"en",className:"space-y-4 mt-0",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"name_en",className:"text-sm font-medium",children:"Restaurant Name"}),e.jsx(h,{id:"name_en",...D("name_en"),placeholder:"Enter restaurant name...",className:"text-base"}),p.name_en&&e.jsx("p",{className:"text-sm text-destructive",children:p.name_en.message})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(r,{className:"text-sm font-medium",children:"Restaurant Types (1-3 tags)"}),F.map((s,n)=>e.jsx("div",{className:"flex gap-2 items-center",children:e.jsx(me,{placeholder:"e.g. Cantonese",value:s.en,onChange:d=>ae(n,"en",d),suggestions:m?.uniqueEn||[]})},n))]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"description_en",className:"text-sm font-medium",children:"Description"}),e.jsx(ce,{value:L("description_en")||"",onChange:s=>T("description_en",s),placeholder:"Enter restaurant description..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"announcement_en",className:"text-sm font-medium",children:"Announcement"}),e.jsx(re,{id:"announcement_en",...D("announcement_en"),rows:2,placeholder:"Enter announcement (optional)..."}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Display important notices at top of restaurant page"})]})]}),e.jsxs(oe,{value:"pt",className:"space-y-4 mt-0",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"name_pt",className:"text-sm font-medium",children:"Nome do Restaurante"}),e.jsx(h,{id:"name_pt",...D("name_pt"),placeholder:"Digite o nome do restaurante...",className:"text-base"}),p.name_pt&&e.jsx("p",{className:"text-sm text-destructive",children:p.name_pt.message})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(r,{className:"text-sm font-medium",children:"Tipos de Restaurante (1-3 tags)"}),F.map((s,n)=>e.jsx("div",{className:"flex gap-2 items-center",children:e.jsx(me,{placeholder:"ex: Cantonesa",value:s.pt,onChange:d=>ae(n,"pt",d),suggestions:m?.uniquePt||[]})},n))]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"description_pt",className:"text-sm font-medium",children:"DescriÃ§Ã£o"}),e.jsx(ce,{value:L("description_pt")||"",onChange:s=>T("description_pt",s),placeholder:"Digite a descriÃ§Ã£o do restaurante..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"announcement_pt",className:"text-sm font-medium",children:"AnÃºncio"}),e.jsx(re,{id:"announcement_pt",...D("announcement_pt"),rows:2,placeholder:"Digite o anÃºncio (opcional)..."}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Exibir avisos importantes no topo da pÃ¡gina do restaurante"})]})]})]})]})}),e.jsx(H,{className:"border-primary/20",children:e.jsxs(K,{className:"p-6 space-y-4",children:[e.jsxs(r,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5 text-primary"}),t("admin.locationAndContact")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(r,{htmlFor:"address",className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(J,{className:"w-4 h-4"}),t("admin.address")]}),e.jsx(h,{id:"address",...D("address"),placeholder:t("admin.enterAddress")}),p.address&&e.jsx("p",{className:"text-sm text-destructive",children:p.address.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(r,{htmlFor:"phone",className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ze,{className:"w-4 h-4"}),t("admin.phone")]}),e.jsx(h,{id:"phone",...D("phone"),placeholder:"+351..."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(r,{htmlFor:"website_url",className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ye,{className:"w-4 h-4"}),t("admin.websiteBaseUrl")]}),e.jsx(h,{id:"website_url",...D("website_url"),placeholder:"https://sushi.xiaoxiong.pt:6000",readOnly:!x,disabled:!x,className:x?"":"bg-muted cursor-not-allowed"}),!x&&e.jsx("p",{className:"text-xs text-muted-foreground",children:t("admin.websiteReadOnly")})]}),x&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(r,{htmlFor:"key_id",className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Xe,{className:"w-4 h-4"}),"Key ID (API)"]}),e.jsx(h,{id:"key_id",...D("key_id"),placeholder:"ä¾‹å¦‚: saldanha01"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 p-3 rounded-lg border bg-muted/30",children:[e.jsx(O,{id:"show_takeaway_button",checked:Se,onCheckedChange:s=>T("show_takeaway_button",s)}),e.jsxs(r,{htmlFor:"show_takeaway_button",className:"cursor-pointer text-sm flex items-center gap-2",children:[e.jsx(Ye,{className:"w-4 h-4"}),t("admin.showTakeawayButton")]})]}),e.jsxs("div",{className:"flex items-center space-x-2 p-3 rounded-lg border bg-muted/30",children:[e.jsx(O,{id:"show_booking_button",checked:De,onCheckedChange:s=>T("show_booking_button",s)}),e.jsxs(r,{htmlFor:"show_booking_button",className:"cursor-pointer text-sm flex items-center gap-2",children:[e.jsx(Je,{className:"w-4 h-4"}),t("admin.showBookingButton")]})]})]})]})}),e.jsx(H,{className:"border-primary/20",children:e.jsxs(K,{className:"p-6 space-y-4",children:[e.jsxs(r,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5 text-primary"}),t("admin.location")]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"lat",className:"text-sm font-medium",children:t("admin.latitude")}),e.jsx(h,{id:"lat",type:"number",step:"any",...D("lat",{valueAsNumber:!0})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"lng",className:"text-sm font-medium",children:t("admin.longitude")}),e.jsx(h,{id:"lng",type:"number",step:"any",...D("lng",{valueAsNumber:!0})})]})]}),e.jsx("div",{ref:B,className:"h-96 w-full rounded-lg border-2 border-primary/20 shadow-sm",style:{minHeight:"384px"}}),e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[e.jsx(J,{className:"w-4 h-4"}),t("admin.clickOrDragToSetLocation")]})]})}),e.jsx(H,{className:"border-primary/20 overflow-hidden",children:e.jsxs(K,{className:"p-3 md:p-6 space-y-4",children:[e.jsxs(r,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(es,{className:"w-5 h-5 text-primary"}),t("admin.openingHours")]}),e.jsx("div",{className:"space-y-2",children:be.map(s=>e.jsxs("div",{className:"space-y-2 p-2 md:p-3 rounded-lg hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"md:hidden space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r,{className:"capitalize font-semibold text-sm",children:t(`admin.day.${s}`)}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(O,{id:`split-mobile-${s}`,checked:i[s].splitShift,onCheckedChange:n=>u({...i,[s]:{...i[s],splitShift:n}}),disabled:i[s].closed,className:"h-4 w-4"}),e.jsx(r,{htmlFor:`split-mobile-${s}`,className:"cursor-pointer text-xs",children:"åˆ†æ®µ"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(O,{id:`closed-mobile-${s}`,checked:i[s].closed,onCheckedChange:n=>u({...i,[s]:{...i[s],closed:n}}),className:"h-4 w-4"}),e.jsx(r,{htmlFor:`closed-mobile-${s}`,className:"cursor-pointer text-xs",children:t("admin.closed")})]})]})]}),!i[s].closed&&e.jsx("div",{className:"space-y-1.5",children:i[s].splitShift?e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"grid grid-cols-[32px_1fr_12px_1fr] gap-1 items-center",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"åˆé¤"}),e.jsx(h,{type:"time",value:i[s].open,onChange:n=>u({...i,[s]:{...i[s],open:n.target.value}}),className:"h-8 text-xs px-2 min-w-0"}),e.jsx("span",{className:"text-muted-foreground text-xs text-center",children:"-"}),e.jsx(h,{type:"time",value:i[s].close,onChange:n=>u({...i,[s]:{...i[s],close:n.target.value}}),className:"h-8 text-xs px-2 min-w-0"})]}),e.jsxs("div",{className:"grid grid-cols-[32px_1fr_12px_1fr] gap-1 items-center",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"æ™šé¤"}),e.jsx(h,{type:"time",value:i[s].open2||"19:00",onChange:n=>u({...i,[s]:{...i[s],open2:n.target.value}}),className:"h-8 text-xs px-2 min-w-0"}),e.jsx("span",{className:"text-muted-foreground text-xs text-center",children:"-"}),e.jsx(h,{type:"time",value:i[s].close2||"23:00",onChange:n=>u({...i,[s]:{...i[s],close2:n.target.value}}),className:"h-8 text-xs px-2 min-w-0"})]})]}):e.jsxs("div",{className:"grid grid-cols-[1fr_12px_1fr] gap-1 items-center",children:[e.jsx(h,{type:"time",value:i[s].open,onChange:n=>u({...i,[s]:{...i[s],open:n.target.value}}),className:"h-8 text-xs px-2 min-w-0"}),e.jsx("span",{className:"text-muted-foreground text-xs text-center",children:"-"}),e.jsx(h,{type:"time",value:i[s].close,onChange:n=>u({...i,[s]:{...i[s],close:n.target.value}}),className:"h-8 text-xs px-2 min-w-0"})]})})]}),e.jsxs("div",{className:"hidden md:block",children:[e.jsxs("div",{className:"grid grid-cols-[120px_1fr_auto] gap-4 items-center",children:[e.jsx(r,{className:"capitalize font-semibold",children:t(`admin.day.${s}`)}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{id:`split-${s}`,checked:i[s].splitShift,onCheckedChange:n=>u({...i,[s]:{...i[s],splitShift:n}}),disabled:i[s].closed}),e.jsx(r,{htmlFor:`split-${s}`,className:"cursor-pointer text-sm",children:"åˆ†æ®µè¥ä¸š"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{id:`closed-${s}`,checked:i[s].closed,onCheckedChange:n=>u({...i,[s]:{...i[s],closed:n}})}),e.jsx(r,{htmlFor:`closed-${s}`,className:"cursor-pointer",children:t("admin.closed")})]})]}),!i[s].closed&&e.jsx("div",{className:"ml-[120px] space-y-2 mt-2",children:i[s].splitShift?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground w-12",children:"åˆé¤"}),e.jsx(h,{type:"time",value:i[s].open,onChange:n=>u({...i,[s]:{...i[s],open:n.target.value}}),className:"w-32"}),e.jsx("span",{className:"text-muted-foreground",children:"-"}),e.jsx(h,{type:"time",value:i[s].close,onChange:n=>u({...i,[s]:{...i[s],close:n.target.value}}),className:"w-32"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground w-12",children:"æ™šé¤"}),e.jsx(h,{type:"time",value:i[s].open2||"19:00",onChange:n=>u({...i,[s]:{...i[s],open2:n.target.value}}),className:"w-32"}),e.jsx("span",{className:"text-muted-foreground",children:"-"}),e.jsx(h,{type:"time",value:i[s].close2||"23:00",onChange:n=>u({...i,[s]:{...i[s],close2:n.target.value}}),className:"w-32"})]})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{type:"time",value:i[s].open,onChange:n=>u({...i,[s]:{...i[s],open:n.target.value}}),className:"w-32"}),e.jsx("span",{className:"text-muted-foreground",children:"-"}),e.jsx(h,{type:"time",value:i[s].close,onChange:n=>u({...i,[s]:{...i[s],close:n.target.value}}),className:"w-32"})]})})]})]},s))})]})})]})}),e.jsxs("div",{className:"flex justify-end gap-2 px-6 py-4 border-t bg-muted/30",children:[e.jsx(M,{type:"button",variant:"outline",onClick:()=>N(!1),children:t("common.cancel")}),e.jsxs(M,{type:"submit",disabled:W,onClick:X(xe),className:"gap-2",children:[e.jsx(Ne,{className:"w-4 h-4"}),t(W?"common.saving":"common.save")]})]})]})]})}export{Ks as R,Cs as u};
//# sourceMappingURL=RestaurantFormDialog-DFDBDJm3.js.map
