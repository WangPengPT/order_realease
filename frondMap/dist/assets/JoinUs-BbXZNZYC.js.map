{"version":3,"file":"JoinUs-BbXZNZYC.js","sources":["../../src/pages/JoinUs.tsx"],"sourcesContent":["import { useState, useMemo, useEffect } from \"react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { zodResolver } from \"@hookform/resolvers/zod\";\r\nimport * as z from \"zod\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Link, useSearchParams } from \"react-router-dom\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Checkbox } from \"@/components/ui/checkbox\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Form, FormControl, FormDescription, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { toast } from \"@/hooks/use-toast\";\r\nimport { CheckCircle2, Loader2, Store, Phone, Mail, Ticket, Check, X, ExternalLink } from \"lucide-react\";\r\nimport { useSiteSettings } from \"@/hooks/useSiteSettings\";\r\nimport { useValidateInvitationCode } from \"@/hooks/useInvitationCodes\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { openExternalUrl } from \"@/lib/externalLinks\";\r\nimport { cn } from \"@/lib/utils\";\r\nconst featureOptions = [\"booking\", \"delivery\", \"qrcode\"] as const;\r\n\r\ntype FormValues = {\r\n  name: string;\r\n  email: string;\r\n  phone: string;\r\n  restaurant_name: string;\r\n  restaurant_address: string;\r\n  features_selected: typeof featureOptions[number][];\r\n  invitation_code: string;\r\n};\r\n\r\nconst JoinUs = () => {\r\n  const { t, i18n } = useTranslation();\r\n  const [searchParams] = useSearchParams();\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [isSuccess, setIsSuccess] = useState(false);\r\n  const { settings } = useSiteSettings();\r\n  const validateCodeMutation = useValidateInvitationCode();\r\n  const [codeValidation, setCodeValidation] = useState<{\r\n    isValidating: boolean;\r\n    isValid: boolean | null;\r\n    inviterUserId: string | null;\r\n  }>({ isValidating: false, isValid: null, inviterUserId: null });\r\n\r\n  const formSchema = useMemo(() => z.object({\r\n    name: z.string().min(2, { message: t(\"joinUs.nameMin\") }),\r\n    email: z.string().email({ message: t(\"joinUs.emailInvalid\") }),\r\n    phone: z.string().min(6, { message: t(\"joinUs.phoneMin\") }),\r\n    restaurant_name: z.string().min(2, { message: t(\"joinUs.restaurantNameMin\") }),\r\n    restaurant_address: z.string().min(2, { message: t(\"joinUs.addressMin\") }),\r\n    features_selected: z.array(z.enum(featureOptions)).min(1, { message: t(\"joinUs.featuresMin\") }),\r\n    invitation_code: z.string().optional(),\r\n  }), [t]);\r\n\r\n  const form = useForm<FormValues>({\r\n    resolver: zodResolver(formSchema),\r\n    defaultValues: {\r\n      name: \"\",\r\n      email: \"\",\r\n      phone: \"\",\r\n      restaurant_name: \"\",\r\n      restaurant_address: \"\",\r\n      features_selected: [],\r\n      invitation_code: searchParams.get(\"code\") || \"\",\r\n    },\r\n  });\r\n\r\n  // Watch features_selected to determine if qrcode is selected\r\n  const featuresSelected = form.watch(\"features_selected\");\r\n  const isQrcodeSelected = featuresSelected?.includes(\"qrcode\");\r\n\r\n  // Validate invitation code from URL on mount\r\n  useEffect(() => {\r\n    const codeFromUrl = searchParams.get(\"code\");\r\n    if (codeFromUrl && isQrcodeSelected) {\r\n      handleValidateCode(codeFromUrl);\r\n    }\r\n  }, [searchParams, isQrcodeSelected]);\r\n\r\n  // Clear invitation code when qrcode is deselected\r\n  useEffect(() => {\r\n    if (!isQrcodeSelected) {\r\n      form.setValue(\"invitation_code\", \"\");\r\n      setCodeValidation({ isValidating: false, isValid: null, inviterUserId: null });\r\n    }\r\n  }, [isQrcodeSelected, form]);\r\n\r\n  const handleValidateCode = async (code: string) => {\r\n    if (!code || code.length < 6) {\r\n      setCodeValidation({ isValidating: false, isValid: null, inviterUserId: null });\r\n      return;\r\n    }\r\n\r\n    setCodeValidation({ isValidating: true, isValid: null, inviterUserId: null });\r\n    \r\n    try {\r\n      const result = await validateCodeMutation.mutateAsync(code);\r\n      if (result) {\r\n        setCodeValidation({ \r\n          isValidating: false, \r\n          isValid: true, \r\n          inviterUserId: result.user_id \r\n        });\r\n      } else {\r\n        setCodeValidation({ isValidating: false, isValid: false, inviterUserId: null });\r\n      }\r\n    } catch {\r\n      setCodeValidation({ isValidating: false, isValid: false, inviterUserId: null });\r\n    }\r\n  };\r\n\r\n  const onSubmit = async (data: FormValues) => {\r\n    setIsSubmitting(true);\r\n    try {\r\n      // Get current language from i18n\r\n      const currentLanguage = i18n.language || 'en';\r\n      const { error } = await supabase.functions.invoke(\"send-join-request-email\", {\r\n        body: { \r\n          ...data, \r\n          language: currentLanguage,\r\n          invitation_code: codeValidation.isValid ? data.invitation_code : null,\r\n          invited_by_user_id: codeValidation.inviterUserId,\r\n        },\r\n      });\r\n\r\n      if (error) {\r\n        if (error.message.includes(\"rate_limit_exceeded\")) {\r\n          toast({\r\n            title: t(\"joinUs.rateLimitError\"),\r\n            description: t(\"joinUs.rateLimitErrorDesc\"),\r\n            variant: \"destructive\",\r\n          });\r\n        } else {\r\n          throw error;\r\n        }\r\n        return;\r\n      }\r\n\r\n      setIsSuccess(true);\r\n      form.reset();\r\n      toast({\r\n        title: t(\"joinUs.successTitle\"),\r\n        description: t(\"joinUs.successDescription\"),\r\n      });\r\n    } catch (error: any) {\r\n      console.error(\"Error submitting join request:\", error);\r\n      toast({\r\n        title: t(\"common.error\"),\r\n        description: t(\"joinUs.submitError\"),\r\n        variant: \"destructive\",\r\n      });\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  // Get localized success content from settings\r\n  const getSuccessTitle = () => {\r\n    const lang = i18n.language;\r\n    if (lang === 'zh' && settings?.join_success_title_zh) return settings.join_success_title_zh;\r\n    if (lang === 'pt' && settings?.join_success_title_pt) return settings.join_success_title_pt;\r\n    if (settings?.join_success_title_en) return settings.join_success_title_en;\r\n    return t(\"joinUs.successTitle\");\r\n  };\r\n\r\n  const getSuccessMessage = () => {\r\n    const lang = i18n.language;\r\n    if (lang === 'zh' && settings?.join_success_message_zh) return settings.join_success_message_zh;\r\n    if (lang === 'pt' && settings?.join_success_message_pt) return settings.join_success_message_pt;\r\n    if (settings?.join_success_message_en) return settings.join_success_message_en;\r\n    return t(\"joinUs.successMessage\");\r\n  };\r\n\r\n  const contactPhone = settings?.join_contact_phone || '968815050';\r\n  const contactEmail = settings?.contact_email;\r\n\r\n  if (isSuccess) {\r\n    return (\r\n      <div className=\"min-h-screen pt-20 pb-12 px-4 bg-secondary/20\">\r\n        <div className=\"container mx-auto max-w-2xl\">\r\n          <Card className=\"border-primary\">\r\n            <CardContent className=\"pt-12 pb-12 text-center\">\r\n              <CheckCircle2 className=\"w-16 h-16 text-primary mx-auto mb-4\" />\r\n              <h2 className=\"text-2xl font-bold text-foreground mb-4\">\r\n                {getSuccessTitle()}\r\n              </h2>\r\n              <p className=\"text-muted-foreground mb-4 max-w-md mx-auto\">\r\n                {getSuccessMessage()}\r\n              </p>\r\n              <div className=\"flex flex-col sm:flex-row items-center justify-center gap-4 mb-6\">\r\n                <a href={`tel:${contactPhone}`} className=\"flex items-center gap-2 text-primary font-semibold hover:underline\">\r\n                  <Phone className=\"w-5 h-5\" />\r\n                  <span>{contactPhone}</span>\r\n                </a>\r\n                {contactEmail && (\r\n                  <a href={`mailto:${contactEmail}`} className=\"flex items-center gap-2 text-primary font-semibold hover:underline\">\r\n                    <Mail className=\"w-5 h-5\" />\r\n                    <span>{contactEmail}</span>\r\n                  </a>\r\n                )}\r\n              </div>\r\n              <Button onClick={() => setIsSuccess(false)}>\r\n                {t(\"joinUs.submitAnother\")}\r\n              </Button>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen pt-4 pb-12 px-4 bg-secondary/20\">\r\n      <div className=\"container mx-auto max-w-3xl\">\r\n        <Card>\r\n          <CardHeader className=\"text-center space-y-2\">\r\n            <div className=\"flex justify-center mb-4\">\r\n              <Store className=\"w-12 h-12 text-primary\" />\r\n            </div>\r\n            <CardTitle className=\"text-3xl font-bold\">{t(\"joinUs.title\")}</CardTitle>\r\n            <CardDescription className=\"text-base\">\r\n              {t(\"joinUs.description\")}\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <Form {...form}>\r\n              <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\r\n                <FormField\r\n                  control={form.control}\r\n                  name=\"name\"\r\n                  render={({ field }) => (\r\n                    <FormItem>\r\n                      <FormLabel>{t(\"joinUs.name\")}</FormLabel>\r\n                      <FormControl>\r\n                        <Input placeholder={t(\"joinUs.namePlaceholder\")} {...field} />\r\n                      </FormControl>\r\n                      <FormMessage />\r\n                    </FormItem>\r\n                  )}\r\n                />\r\n\r\n                <FormField\r\n                  control={form.control}\r\n                  name=\"email\"\r\n                  render={({ field }) => (\r\n                    <FormItem>\r\n                      <FormLabel>{t(\"joinUs.email\")}</FormLabel>\r\n                      <FormControl>\r\n                        <Input type=\"email\" placeholder={t(\"joinUs.emailPlaceholder\")} {...field} />\r\n                      </FormControl>\r\n                      <FormMessage />\r\n                    </FormItem>\r\n                  )}\r\n                />\r\n\r\n                <FormField\r\n                  control={form.control}\r\n                  name=\"phone\"\r\n                  render={({ field }) => (\r\n                    <FormItem>\r\n                      <FormLabel>{t(\"joinUs.phone\")}</FormLabel>\r\n                      <FormControl>\r\n                        <Input type=\"tel\" placeholder={t(\"joinUs.phonePlaceholder\")} {...field} />\r\n                      </FormControl>\r\n                      <FormMessage />\r\n                    </FormItem>\r\n                  )}\r\n                />\r\n\r\n                <FormField\r\n                  control={form.control}\r\n                  name=\"restaurant_name\"\r\n                  render={({ field }) => (\r\n                    <FormItem>\r\n                      <FormLabel>{t(\"joinUs.restaurantName\")}</FormLabel>\r\n                      <FormControl>\r\n                        <Input placeholder={t(\"joinUs.restaurantNamePlaceholder\")} {...field} />\r\n                      </FormControl>\r\n                      <FormMessage />\r\n                    </FormItem>\r\n                  )}\r\n                />\r\n\r\n                <FormField\r\n                  control={form.control}\r\n                  name=\"restaurant_address\"\r\n                  render={({ field }) => (\r\n                    <FormItem>\r\n                      <FormLabel>{t(\"joinUs.restaurantAddress\")}</FormLabel>\r\n                      <FormControl>\r\n                        <Input placeholder={t(\"joinUs.restaurantAddressPlaceholder\")} {...field} />\r\n                      </FormControl>\r\n                      <FormMessage />\r\n                    </FormItem>\r\n                  )}\r\n                />\r\n\r\n                {/* Features Selection - moved before invitation code */}\r\n                <FormField\r\n                  control={form.control}\r\n                  name=\"features_selected\"\r\n                  render={() => (\r\n                    <FormItem>\r\n                      <div className=\"mb-4\">\r\n                        <FormLabel>{t(\"joinUs.featuresNeeded\")}</FormLabel>\r\n                        <FormDescription>\r\n                          {t(\"joinUs.featuresDescription\")}\r\n                        </FormDescription>\r\n                      </div>\r\n                      {featureOptions.map((feature) => (\r\n                        <FormField\r\n                          key={feature}\r\n                          control={form.control}\r\n                          name=\"features_selected\"\r\n                          render={({ field }) => {\r\n                            return (\r\n                              <FormItem\r\n                                key={feature}\r\n                                className=\"flex flex-row items-start space-x-3 space-y-0\"\r\n                              >\r\n                                <FormControl>\r\n                                  <Checkbox\r\n                                    checked={field.value?.includes(feature)}\r\n                                    onCheckedChange={(checked) => {\r\n                                      return checked\r\n                                        ? field.onChange([...field.value, feature])\r\n                                        : field.onChange(\r\n                                            field.value?.filter((value) => value !== feature)\r\n                                          );\r\n                                    }}\r\n                                  />\r\n                                </FormControl>\r\n                                <FormLabel className=\"font-normal cursor-pointer\">\r\n                                  {t(`joinUs.feature.${feature}`)}\r\n                                </FormLabel>\r\n                              </FormItem>\r\n                            );\r\n                          }}\r\n                        />\r\n                      ))}\r\n                      <FormMessage />\r\n                    </FormItem>\r\n                  )}\r\n                />\r\n\r\n                {/* Invitation Code Field */}\r\n                <FormField\r\n                  control={form.control}\r\n                  name=\"invitation_code\"\r\n                  render={({ field }) => (\r\n                    <FormItem>\r\n                      <FormLabel className=\"flex items-center gap-2\">\r\n                        <Ticket className=\"w-4 h-4\" />\r\n                        {t(\"joinUs.invitationCode\")}\r\n                        <span className=\"text-muted-foreground font-normal text-xs\">\r\n                          ({t(\"joinUs.optional\")})\r\n                        </span>\r\n                      </FormLabel>\r\n                      <FormControl>\r\n                        <div className=\"relative\">\r\n                          <Input \r\n                            placeholder={t(\"joinUs.invitationCodePlaceholder\", \"如有邀请码请输入\")} \r\n                            {...field}\r\n                            disabled={!isQrcodeSelected}\r\n                            onChange={(e) => {\r\n                              field.onChange(e);\r\n                              if (isQrcodeSelected) {\r\n                                handleValidateCode(e.target.value);\r\n                              }\r\n                            }}\r\n                            onFocus={() => {\r\n                              if (!isQrcodeSelected) {\r\n                                toast({\r\n                                  title: t(\"joinUs.qrcodeRequired\", \"请先勾选扫码点餐\"),\r\n                                  description: t(\"joinUs.qrcodeRequiredDesc\", \"只有选择扫码点餐功能后才能使用邀请码\"),\r\n                                });\r\n                              }\r\n                            }}\r\n                            className={cn(\"pr-10\", !isQrcodeSelected && \"cursor-not-allowed opacity-50\")}\r\n                          />\r\n                          {isQrcodeSelected && codeValidation.isValidating && (\r\n                            <Loader2 className=\"w-4 h-4 absolute right-3 top-1/2 -translate-y-1/2 animate-spin text-muted-foreground\" />\r\n                          )}\r\n                          {isQrcodeSelected && !codeValidation.isValidating && codeValidation.isValid === true && (\r\n                            <Check className=\"w-4 h-4 absolute right-3 top-1/2 -translate-y-1/2 text-green-500\" />\r\n                          )}\r\n                          {isQrcodeSelected && !codeValidation.isValidating && codeValidation.isValid === false && field.value && (\r\n                            <X className=\"w-4 h-4 absolute right-3 top-1/2 -translate-y-1/2 text-red-500\" />\r\n                          )}\r\n                        </div>\r\n                      </FormControl>\r\n                      {!isQrcodeSelected && (\r\n                        <p className=\"text-xs text-muted-foreground\">{t(\"joinUs.qrcodeRequiredHint\", \"需要勾选扫码点餐功能后才能填写邀请码\")}</p>\r\n                      )}\r\n                      {isQrcodeSelected && codeValidation.isValid === true && (\r\n                        <p className=\"text-xs text-green-600\">{t(\"joinUs.invitationCodeValid\", \"邀请码有效\")}</p>\r\n                      )}\r\n                      {isQrcodeSelected && codeValidation.isValid === false && field.value && (\r\n                        <p className=\"text-xs text-red-600\">{t(\"joinUs.invitationCodeInvalid\", \"邀请码无效\")}</p>\r\n                      )}\r\n                      <FormMessage />\r\n                    </FormItem>\r\n                  )}\r\n                />\r\n\r\n\r\n                <div className=\"text-xs text-muted-foreground text-center pb-4\">\r\n                  {t(\"joinUs.consentText\")}{\" \"}\r\n                  <Link to=\"/privacy-policy\" className=\"text-primary hover:underline\">\r\n                    {t(\"joinUs.privacyPolicy\")}\r\n                  </Link>{\" \"}\r\n                  {t(\"joinUs.and\")}{\" \"}\r\n                  <Link to=\"/terms-of-service\" className=\"text-primary hover:underline\">\r\n                    {t(\"joinUs.termsOfService\")}\r\n                  </Link>\r\n                </div>\r\n\r\n                <Button type=\"submit\" className=\"w-full\" size=\"lg\" disabled={isSubmitting}>\r\n                  {isSubmitting && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\r\n                  {t(\"joinUs.submit\")}\r\n                </Button>\r\n\r\n                {/* Official website link */}\r\n                <div className=\"text-center pt-4\">\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => openExternalUrl(\"https://xiaoxiong.pt/en/pages/subscription\")}\r\n                    className=\"inline-flex items-center gap-1 text-sm text-primary hover:underline\"\r\n                  >\r\n                    {t(\"joinUs.visitOurWebsite\", \"访问我们的官网查看详细信息\")}\r\n                    <ExternalLink className=\"w-3 h-3\" />\r\n                  </button>\r\n                </div>\r\n              </form>\r\n            </Form>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default JoinUs;\r\n"],"names":["featureOptions","JoinUs","t","i18n","useTranslation","searchParams","useSearchParams","isSubmitting","setIsSubmitting","useState","isSuccess","setIsSuccess","settings","useSiteSettings","validateCodeMutation","useValidateInvitationCode","codeValidation","setCodeValidation","formSchema","useMemo","z.object","z.string","z.array","z.enum","form","useForm","zodResolver","isQrcodeSelected","useEffect","codeFromUrl","handleValidateCode","code","result","onSubmit","data","currentLanguage","error","supabase","toast","getSuccessTitle","lang","getSuccessMessage","contactPhone","contactEmail","jsx","Card","jsxs","CardContent","CheckCircle2","Phone","Mail","Button","CardHeader","Store","CardTitle","CardDescription","Form","FormField","field","FormItem","FormLabel","FormControl","Input","FormMessage","FormDescription","feature","Checkbox","checked","value","Ticket","e","cn","Loader2","Check","X","Link","openExternalUrl","ExternalLink"],"mappings":"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"}