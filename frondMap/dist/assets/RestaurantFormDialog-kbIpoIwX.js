import{s as as,q as fe,v as Re,w as de,p as $e,r as u,da as Cs,db as Xe,j as e,bh as se,aM as we,dc as ks,dd as Ss,de as Is,df as Ds,bU as me,dg as Fs,dh as Ps,d0 as Ts,X as O,di as As,dj as Es,dk as zs,dl as Rs,a4 as $s,bt as Us,bm as _e,ak as qs,bW as Ms,bO as Vs,bS as Bs,ba as Ce,ab as ke,bv as Ze,a_ as xe,y as Ls,dm as Os,b1 as Hs,b6 as Se,am as Ye,bf as Gs}from"./vendor-react-Dx9aTW_3.js";import{m as Ie}from"./vendor-map-CvE3ASYw.js";import{s as k,u as Ks,C as $,p as Qs,F as Ws,$ as Xs,q as U,B as D,A as Zs,t as Ys,v as Js,w as ea,x as sa,y as aa,I as h,i as ta,f as ts,U as i,G as ra,D as na,W as ia,c as la,d as oa,e as ca,T as da,S as ma,a2 as ua,a3 as pa,a4 as ha,a5 as xa,a6 as ga,a8 as oe}from"./index-YQstMq3Q.js";import{C as ce}from"./checkbox-BkkxO9x1.js";import{S as Je}from"./switch--7xe53rn.js";import{R as rs,a as ge}from"./radio-group-CPtkC5wM.js";import{T as Ee,a as ze,b as X,c as Z}from"./tabs-BXJg-F5o.js";import{i as R}from"./vendor-i18n-jtdHZIRR.js";import{R as De}from"./RichTextEditor-Da_m1dBp.js";import{a as fa}from"./useBrands-DshegnHO.js";import{N as ja,O as E,Q as Fe,T as es,U as Pe}from"./vendor-utils-vwQGbBim.js";const Na=t=>as({queryKey:["dish-images",t],queryFn:async()=>{const{data:x,error:a}=await k.from("restaurant_dish_images").select("*").eq("restaurant_id",t).order("sort_order",{ascending:!0});if(a)throw a;return x},enabled:!!t}),va=()=>{const{user:t}=Ks(),x=fe();return Re({mutationFn:async({restaurantId:a,file:N})=>{if(!t)throw new Error("Must be logged in");const{data:b,error:f}=await k.from("restaurant_dish_images").select("id").eq("restaurant_id",a);if(f)throw f;if(b&&b.length>=10)throw new Error("MAX_IMAGES_REACHED");const g=N.name.split(".").pop(),S=`${a}/${Date.now()}-${Math.random().toString(36).substring(7)}.${g}`,{error:o}=await k.storage.from("dish-images").upload(S,N);if(o)throw o;const{data:{publicUrl:j}}=k.storage.from("dish-images").getPublicUrl(S),w=b?b.length:0,{data:v,error:_}=await k.from("restaurant_dish_images").insert({restaurant_id:a,image_url:j,sort_order:w,created_by:t.id}).select().single();if(_)throw _;return v},onSuccess:(a,N)=>{x.invalidateQueries({queryKey:["dish-images",N.restaurantId]}),de.success(R.t("dishImages.uploadSuccess"))},onError:a=>{a.message==="MAX_IMAGES_REACHED"?de.error(R.t("dishImages.maxImagesReached")):de.error(R.t("dishImages.uploadFailed"))}})},ba=()=>{const t=fe();return Re({mutationFn:async({imageId:x,restaurantId:a,imageUrl:N})=>{const b=N.split("/dish-images/");b[1]&&await k.storage.from("dish-images").remove([b[1]]);const{error:f}=await k.from("restaurant_dish_images").delete().eq("id",x);if(f)throw f;return{restaurantId:a}},onSuccess:x=>{t.invalidateQueries({queryKey:["dish-images",x.restaurantId]}),de.success(R.t("dishImages.deleteSuccess"))},onError:()=>{de.error(R.t("dishImages.deleteFailed"))}})},ya=()=>{const t=fe();return Re({mutationFn:async({images:x,restaurantId:a})=>{const N=x.map(b=>k.from("restaurant_dish_images").update({sort_order:b.sort_order}).eq("id",b.id));return await Promise.all(N),{restaurantId:a}},onSuccess:x=>{t.invalidateQueries({queryKey:["dish-images",x.restaurantId]})}})};function wa({image:t,index:x,onDelete:a}){const{attributes:N,listeners:b,setNodeRef:f,transform:g,transition:S,isDragging:o}=Fs({id:t.id}),j={transform:Ps.Transform.toString(g),transition:S,zIndex:o?10:1,opacity:o?.8:1};return e.jsxs("div",{ref:f,style:j,className:`relative group aspect-square rounded-lg overflow-hidden border ${o?"ring-2 ring-primary shadow-lg":""}`,children:[e.jsx("div",{...N,...b,className:"absolute top-1 left-1 z-10 p-1 bg-black/60 rounded cursor-grab active:cursor-grabbing opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(Ts,{className:"w-4 h-4 text-white"})}),e.jsx("img",{src:t.image_url,alt:`Dish ${x+1}`,className:"w-full h-full object-cover",draggable:!1}),e.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:e.jsx(D,{type:"button",variant:"destructive",size:"icon",className:"h-8 w-8",onClick:w=>{w.preventDefault(),w.stopPropagation(),a(t.id,t.image_url)},children:e.jsx(O,{className:"w-4 h-4"})})}),e.jsx("div",{className:"absolute bottom-1 right-1 bg-black/60 text-white text-xs px-1.5 py-0.5 rounded",children:x+1})]})}function _a({restaurantId:t}){const{t:x}=$e(),a=u.useRef(null),{data:N=[],isLoading:b}=Na(t),f=va(),g=ba(),S=ya(),[o,j]=u.useState(null),[w,v]=u.useState([]),[_,q]=u.useState(!1),p=w.length>0?w:N,z=Cs(Xe(zs,{activationConstraint:{distance:8}}),Xe(Es,{coordinateGetter:As})),ie=n=>{const{active:c,over:y}=n;if(y&&c.id!==y.id){const Q=p.findIndex(Y=>Y.id===c.id),re=p.findIndex(Y=>Y.id===y.id),W=Rs(p,Q,re);v(W);const le=W.map((Y,ue)=>({id:Y.id,sort_order:ue}));S.mutate({images:le,restaurantId:t},{onSuccess:()=>{v([])},onError:()=>{v([])}})}},M=async n=>{const c=n.target.files?.[0];c&&(c.size>5*1024*1024||c.type.startsWith("image/")&&(await f.mutateAsync({restaurantId:t,file:c}),a.current&&(a.current.value="")))},ae=async()=>{if(!o||_)return;const{id:n,url:c}=o;q(!0);try{await g.mutateAsync({imageId:n,restaurantId:t,imageUrl:c}),j(null)}catch(y){console.error("Delete failed:",y)}finally{q(!1)}},te=n=>{!n&&!_&&j(null)},d=p.length<10;return e.jsxs($,{children:[e.jsxs(Qs,{className:"pb-3",children:[e.jsxs(Ws,{className:"text-lg flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5"}),x("dishImages.title")]}),e.jsxs(Xs,{children:[x("dishImages.description",{current:p.length,max:10}),p.length>1&&e.jsx("span",{className:"block mt-1 text-xs",children:x("dishImages.dragToReorder")})]})]}),e.jsxs(U,{children:[b?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(we,{className:"w-6 h-6 animate-spin"})}):e.jsxs("div",{className:"space-y-4",children:[p.length>0&&e.jsx(ks,{sensors:z,collisionDetection:Ss,onDragEnd:ie,children:e.jsx(Is,{items:p.map(n=>n.id),strategy:Ds,children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:p.map((n,c)=>e.jsx(wa,{image:n,index:c,onDelete:(y,Q)=>j({id:y,url:Q})},n.id))})})}),d&&e.jsxs("div",{children:[e.jsx("input",{ref:a,type:"file",accept:"image/*",className:"hidden",onChange:M,disabled:f.isPending}),e.jsxs(D,{type:"button",variant:"outline",className:"w-full",onClick:()=>a.current?.click(),disabled:f.isPending,children:[f.isPending?e.jsx(we,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(me,{className:"w-4 h-4 mr-2"}),x("dishImages.upload")]})]}),!d&&e.jsx("p",{className:"text-sm text-muted-foreground text-center",children:x("dishImages.maxReached")})]}),e.jsx(Zs,{open:!!o,onOpenChange:te,children:e.jsx(Ys,{onClick:n=>n.stopPropagation(),onKeyDown:n=>{n.key==="Enter"&&(n.preventDefault(),n.stopPropagation())},children:e.jsxs("form",{onSubmit:n=>n.preventDefault(),children:[e.jsxs(Js,{children:[e.jsx(ea,{children:x("dishImages.deleteConfirmTitle")}),e.jsx(sa,{children:x("dishImages.deleteConfirmDescription")})]}),e.jsxs(aa,{className:"mt-4",children:[e.jsx(D,{type:"button",variant:"outline",onClick:n=>{n.preventDefault(),n.stopPropagation(),_||j(null)},disabled:_,children:x("common.cancel")}),e.jsxs(D,{type:"button",variant:"destructive",onClick:n=>{n.preventDefault(),n.stopPropagation(),ae()},disabled:_,children:[_?e.jsx(we,{className:"w-4 h-4 mr-2 animate-spin"}):null,x("common.delete")]})]})]})})})]})]})}function Te({value:t,onChange:x,suggestions:a,placeholder:N,className:b}){const[f,g]=u.useState(!1),[S,o]=u.useState(t),j=u.useRef(null),w=u.useRef(null),v=a.filter(p=>p.toLowerCase().includes(S.toLowerCase()));u.useEffect(()=>{o(t)},[t]),u.useEffect(()=>{const p=z=>{w.current&&!w.current.contains(z.target)&&j.current&&!j.current.contains(z.target)&&g(!1)};return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[]);const _=p=>{const z=p.target.value;o(z),x(z),g(!0)},q=p=>{o(p),x(p),g(!1),j.current?.focus()};return e.jsxs("div",{className:"relative",children:[e.jsx(h,{ref:j,value:S,onChange:_,onFocus:()=>g(!0),placeholder:N,className:b}),f&&v.length>0&&e.jsx("div",{ref:w,className:"absolute z-50 mt-1 w-full max-h-48 overflow-auto rounded-md border bg-popover p-1 shadow-md",children:v.map(p=>e.jsxs("div",{onClick:()=>q(p),className:ta("relative flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none hover:bg-accent hover:text-accent-foreground",p===S&&"bg-accent"),children:[p===S&&e.jsx($s,{className:"mr-2 h-4 w-4"}),e.jsx("span",{className:p===S?"":"pl-6",children:p})]},p))})]})}const Ca=()=>as({queryKey:["all-restaurant-types"],queryFn:async()=>{const{data:t,error:x}=await k.from("restaurants").select("type, type_en, type_pt");if(x)throw x;const a=new Map;t.forEach(g=>{const S=g.type||[],o=g.type_en||[],j=g.type_pt||[],w=Math.max(S.length,o.length,j.length);for(let v=0;v<w;v++){const _=S[v]||"",q=o[v]||"",p=j[v]||"",z=`${_}|${q}|${p}`;(_||q||p)&&(a.has(z)||a.set(z,{zh:_,en:q,pt:p}))}});const N=new Set,b=new Set,f=new Set;return a.forEach(g=>{g.zh&&N.add(g.zh),g.en&&b.add(g.en),g.pt&&f.add(g.pt)}),{typeSets:Array.from(a.values()),uniqueZh:Array.from(N).sort(),uniqueEn:Array.from(b).sort(),uniquePt:Array.from(f).sort()}}}),Ae=5;function ka({bannerMediaType:t,onBannerMediaTypeChange:x,promoVideoUrl:a,onPromoVideoUrlChange:N,promoVideoPoster:b,onPromoVideoPosterChange:f,videos:g,onVideosChange:S}){const{t:o}=$e(),{toast:j}=ts(),[w,v]=u.useState(!1),_=async(d,n,c=!1)=>{const y=d.name.split(".").pop(),Q=`${n}_${Math.random()}.${y}`,re=c?"restaurant-videos":"restaurant-images",{error:W}=await k.storage.from(re).upload(Q,d);if(W)throw W;const{data:{publicUrl:le}}=k.storage.from(re).getPublicUrl(Q);return le},q=async d=>{const n=d.target.files?.[0];if(n){v(!0);try{const c=await _(n,"promo_video",!0);N(c),j({title:o("common.success"),description:o("admin.videoUploaded","è§†é¢‘ä¸Šä¼ æˆåŠŸ")})}catch(c){j({title:o("common.error"),description:c.message,variant:"destructive"})}finally{v(!1)}}},p=async d=>{const n=d.target.files?.[0];if(n){v(!0);try{const c=await _(n,"promo_poster");f(c)}catch(c){j({title:o("common.error"),description:c.message,variant:"destructive"})}finally{v(!1)}}},z=()=>{g.length>=Ae||S([...g,{url:"",title_zh:"",title_en:"",title_pt:"",poster_url:""}])},ie=d=>{S(g.filter((n,c)=>c!==d))},M=(d,n,c)=>{const y=[...g];y[d]={...y[d],[n]:c},S(y)},ae=async(d,n)=>{const c=n.target.files?.[0];if(c){v(!0);try{const y=await _(c,`video_${d}`,!0);M(d,"url",y),j({title:o("common.success"),description:o("admin.videoUploaded","è§†é¢‘ä¸Šä¼ æˆåŠŸ")})}catch(y){j({title:o("common.error"),description:y.message,variant:"destructive"})}finally{v(!1)}}},te=async(d,n)=>{const c=n.target.files?.[0];if(c){v(!0);try{const y=await _(c,`video_poster_${d}`);M(d,"poster_url",y)}catch(y){j({title:o("common.error"),description:y.message,variant:"destructive"})}finally{v(!1)}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx($,{className:"border-primary/20",children:e.jsxs(U,{className:"p-4 space-y-4",children:[e.jsxs(i,{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(Us,{className:"w-4 h-4 text-primary"}),o("restaurants.bannerType","æ¨ªå¹…ç±»åž‹")]}),e.jsxs(rs,{value:t,onValueChange:d=>x(d),className:"flex gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ge,{value:"image",id:"banner-image"}),e.jsx(i,{htmlFor:"banner-image",className:"cursor-pointer text-sm",children:o("restaurants.bannerImage","å›¾ç‰‡")})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ge,{value:"video",id:"banner-video"}),e.jsx(i,{htmlFor:"banner-video",className:"cursor-pointer text-sm",children:o("restaurants.bannerVideo","è§†é¢‘")})]})]}),t==="video"&&e.jsxs("div",{className:"space-y-4 pt-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:o("restaurants.promoVideoHint","å®£ä¼ è§†é¢‘å°†åœ¨é¡¶éƒ¨æ¨ªå¹…ä½ç½®è‡ªåŠ¨é™éŸ³å¾ªçŽ¯æ’­æ”¾")}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-sm",children:o("restaurants.promoVideo","å®£ä¼ è§†é¢‘")}),e.jsx("div",{className:"flex items-center gap-3",children:a?e.jsxs("div",{className:"relative group",children:[e.jsxs("div",{className:"w-40 h-24 bg-muted rounded-lg flex items-center justify-center overflow-hidden",children:[e.jsx("video",{src:a,className:"w-full h-full object-cover",muted:!0}),e.jsx("div",{className:"absolute inset-0 bg-black/30 flex items-center justify-center",children:e.jsx(_e,{className:"w-8 h-8 text-white",fill:"white"})})]}),e.jsx(D,{type:"button",variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity rounded-full",onClick:()=>N(""),children:e.jsx(O,{className:"h-3 w-3"})})]}):e.jsxs(i,{htmlFor:"promo-video-upload",className:"cursor-pointer",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2 px-6 py-4 border-2 border-dashed border-primary/30 rounded-lg hover:border-primary hover:bg-primary/5 transition-all",children:[e.jsx(me,{className:"h-6 w-6 text-primary"}),e.jsx("p",{className:"font-medium text-xs",children:o("admin.uploadVideo","ä¸Šä¼ è§†é¢‘")})]}),e.jsx(h,{id:"promo-video-upload",type:"file",accept:"video/*",className:"hidden",onChange:q,disabled:w})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-sm",children:o("restaurants.videoPoster","è§†é¢‘å°é¢")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:o("restaurants.videoPosterHint","è§†é¢‘åŠ è½½æ—¶æ˜¾ç¤ºçš„å°é¢å›¾")}),e.jsx("div",{className:"flex items-center gap-3",children:b?e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:b,alt:"Video Poster",className:"w-32 h-20 object-cover rounded-lg shadow ring-2 ring-primary/20"}),e.jsx(D,{type:"button",variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity rounded-full",onClick:()=>f(""),children:e.jsx(O,{className:"h-3 w-3"})})]}):e.jsxs(i,{htmlFor:"promo-poster-upload",className:"cursor-pointer",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2 px-4 py-3 border-2 border-dashed border-muted-foreground/30 rounded-lg hover:border-primary/50 transition-all",children:[e.jsx(se,{className:"h-5 w-5 text-muted-foreground"}),e.jsx("p",{className:"font-medium text-xs text-muted-foreground",children:o("admin.uploadImage")})]}),e.jsx(h,{id:"promo-poster-upload",type:"file",accept:"image/*",className:"hidden",onChange:p,disabled:w})]})})]})]})]})}),e.jsx($,{className:"border-primary/20",children:e.jsxs(U,{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(i,{className:"text-sm font-semibold flex items-center gap-2",children:[e.jsx(_e,{className:"w-4 h-4 text-primary"}),o("restaurants.videoGallery","è§†é¢‘åˆ—è¡¨")]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:o("restaurants.maxVideos",{count:Ae})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:o("restaurants.videoGalleryHint","æ·»åŠ ç¾Žé£Ÿåˆ¶ä½œè¿‡ç¨‹ã€å“ç‰Œæ•…äº‹ç­‰è§†é¢‘")}),e.jsx("div",{className:"space-y-4",children:g.map((d,n)=>e.jsxs("div",{className:"p-4 border rounded-lg space-y-3 bg-muted/30",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[o("common.video","è§†é¢‘")," #",n+1]}),e.jsx(D,{type:"button",variant:"ghost",size:"sm",onClick:()=>ie(n),className:"text-destructive hover:text-destructive",children:e.jsx(qs,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[d.url?e.jsxs("div",{className:"relative group",children:[e.jsxs("div",{className:"w-32 h-20 bg-muted rounded-lg flex items-center justify-center overflow-hidden",children:[e.jsx("video",{src:d.url,className:"w-full h-full object-cover",muted:!0}),e.jsx("div",{className:"absolute inset-0 bg-black/30 flex items-center justify-center",children:e.jsx(_e,{className:"w-6 h-6 text-white",fill:"white"})})]}),e.jsx(D,{type:"button",variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 opacity-0 group-hover:opacity-100 transition-opacity rounded-full",onClick:()=>M(n,"url",""),children:e.jsx(O,{className:"h-3 w-3"})})]}):e.jsxs(i,{htmlFor:`video-upload-${n}`,className:"cursor-pointer",children:[e.jsxs("div",{className:"flex flex-col items-center gap-1 px-4 py-3 border-2 border-dashed border-primary/30 rounded-lg hover:border-primary hover:bg-primary/5 transition-all",children:[e.jsx(me,{className:"h-5 w-5 text-primary"}),e.jsx("p",{className:"font-medium text-xs",children:o("admin.uploadVideo","ä¸Šä¼ è§†é¢‘")})]}),e.jsx(h,{id:`video-upload-${n}`,type:"file",accept:"video/*",className:"hidden",onChange:c=>ae(n,c),disabled:w})]}),d.poster_url?e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:d.poster_url,alt:"Poster",className:"w-20 h-20 object-cover rounded-lg ring-2 ring-primary/20"}),e.jsx(D,{type:"button",variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 opacity-0 group-hover:opacity-100 transition-opacity rounded-full",onClick:()=>M(n,"poster_url",""),children:e.jsx(O,{className:"h-3 w-3"})})]}):e.jsxs(i,{htmlFor:`poster-upload-${n}`,className:"cursor-pointer",children:[e.jsxs("div",{className:`flex flex-col items-center gap-1 px-3 py-2 border-2 border-dashed rounded-lg transition-all ${d.url?"border-destructive/50 bg-destructive/5":"border-muted-foreground/30 hover:border-primary/50"}`,children:[e.jsx(se,{className:`h-4 w-4 ${d.url?"text-destructive":"text-muted-foreground"}`}),e.jsxs("p",{className:`text-xs ${d.url?"text-destructive font-medium":"text-muted-foreground"}`,children:[o("restaurants.videoPoster","å°é¢"),d.url&&e.jsx("span",{className:"text-destructive",children:"*"})]})]}),e.jsx(h,{id:`poster-upload-${n}`,type:"file",accept:"image/*",className:"hidden",onChange:c=>te(n,c),disabled:w})]})]}),d.url&&!d.poster_url&&e.jsxs("p",{className:"text-xs text-destructive flex items-center gap-1",children:[e.jsx("span",{children:"âš ï¸"}),o("restaurants.posterRequired","è¯·ä¸Šä¼ è§†é¢‘å°é¢å›¾ï¼Œç”¨äºŽåœ¨åˆ—è¡¨ä¸­å±•ç¤º")]})]}),e.jsxs(Ee,{defaultValue:"zh",className:"w-full",children:[e.jsxs(ze,{className:"grid w-full grid-cols-3 h-8",children:[e.jsx(X,{value:"zh",className:"text-xs",children:"ðŸ‡¨ðŸ‡³"}),e.jsx(X,{value:"en",className:"text-xs",children:"ðŸ‡¬ðŸ‡§"}),e.jsx(X,{value:"pt",className:"text-xs",children:"ðŸ‡µðŸ‡¹"})]}),e.jsx(Z,{value:"zh",className:"mt-2",children:e.jsx(h,{value:d.title_zh||"",onChange:c=>M(n,"title_zh",c.target.value),placeholder:o("restaurants.videoTitle","è§†é¢‘æ ‡é¢˜")+" (ä¸­æ–‡)",className:"text-sm"})}),e.jsx(Z,{value:"en",className:"mt-2",children:e.jsx(h,{value:d.title_en||"",onChange:c=>M(n,"title_en",c.target.value),placeholder:"Video Title (English)",className:"text-sm"})}),e.jsx(Z,{value:"pt",className:"mt-2",children:e.jsx(h,{value:d.title_pt||"",onChange:c=>M(n,"title_pt",c.target.value),placeholder:"TÃ­tulo do VÃ­deo (PortuguÃªs)",className:"text-sm"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(i,{className:"text-xs text-muted-foreground",children:[o("common.duration","æ—¶é•¿")," (s):"]}),e.jsx(h,{type:"number",value:d.duration||"",onChange:c=>M(n,"duration",parseInt(c.target.value)||0),placeholder:"90",className:"w-20 h-8 text-sm"})]})]},n))}),g.length<Ae&&e.jsxs(D,{type:"button",variant:"outline",onClick:z,className:"w-full gap-2",children:[e.jsx(Ms,{className:"w-4 h-4"}),o("restaurants.addVideo","æ·»åŠ è§†é¢‘")]})]})})]})}const Sa=ja({name:E().min(1,R.t("validation.nameRequired")),name_en:E().min(1,R.t("validation.nameRequired")),name_pt:E().min(1,R.t("validation.nameRequired")),key_id:E().optional(),type:Fe(E()).min(1,R.t("validation.typeRequired")).max(3,R.t("validation.typeMaximum")),type_en:Fe(E()).min(1,R.t("validation.typeRequired")).max(3,R.t("validation.typeMaximum")),type_pt:Fe(E()).min(1,R.t("validation.typeRequired")).max(3,R.t("validation.typeMaximum")),description:E().optional(),description_en:E().optional(),description_pt:E().optional(),announcement_zh:E().optional(),announcement_en:E().optional(),announcement_pt:E().optional(),address:E().min(1,R.t("validation.addressRequired")),lat:es(),lng:es(),phone:E().optional(),website_url:E().optional(),visible:Pe().default(!0),show_takeaway_button:Pe().default(!0),show_booking_button:Pe().default(!0)}),ss=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];function Ma({restaurant:t,trigger:x}){const{t:a}=$e(),{toast:N}=ts(),b=fe(),{isAdmin:f}=ra(),{data:g}=Ca(),{data:S}=fa(),[o,j]=u.useState(!1),[w,v]=u.useState(t?.is_chain||!1),[_,q]=u.useState(t?.brand_id||null),[p,z]=u.useState(null),[ie,M]=u.useState(t?.image_url||null),[ae,te]=u.useState(null),[d,n]=u.useState(t?.cover_image_url||null),[c,y]=u.useState(null),[Q,re]=u.useState(t?.owner_avatar_url||null),[W,le]=u.useState(null),[Y,ue]=u.useState(t?.banner_url||null),[Ue,ns]=u.useState(t?.owner_bio||""),[qe,is]=u.useState(t?.owner_bio_en||""),[Me,ls]=u.useState(t?.owner_bio_pt||""),[Ve,Be]=u.useState(!1),[je,os]=u.useState(t?.banner_media_type||"image"),[Le,cs]=u.useState(t?.promo_video_url||""),[Oe,ds]=u.useState(t?.promo_video_poster||""),[He,ms]=u.useState(()=>t?.videos&&Array.isArray(t.videos)?t.videos:[]),pe=u.useRef(null),P=u.useRef(null),ne=u.useRef(null),[l,T]=u.useState(()=>{const s={};return ss.forEach(r=>{s[r]={open:"12:00",close:"23:00",closed:!1,splitShift:!1,open2:"19:00",close2:"23:00"}}),t?.opening_hours?{...s,...t.opening_hours}:s}),[A,Ne]=u.useState(t?.template||"default"),[H,ve]=u.useState(()=>t?.type&&Array.isArray(t.type)?t.type.map((s,r)=>({zh:s,en:t.type_en?.[r]||"",pt:t.type_pt?.[r]||""})):[{zh:"",en:"",pt:""}]),{register:B,handleSubmit:Ge,formState:{errors:I},setValue:V,watch:J,trigger:Ia}=Vs({resolver:Bs(Sa),defaultValues:t?{name:t.name,name_en:t.name_en||"",name_pt:t.name_pt||"",key_id:t.key_id||"",type:Array.isArray(t.type)?t.type:[t.type],type_en:Array.isArray(t.type_en)?t.type_en:t.type_en?[t.type_en]:[""],type_pt:Array.isArray(t.type_pt)?t.type_pt:t.type_pt?[t.type_pt]:[""],description:t.description||"",description_en:t.description_en||"",description_pt:t.description_pt||"",announcement_zh:t.announcement_zh||"",announcement_en:t.announcement_en||"",announcement_pt:t.announcement_pt||"",address:t.address,lat:typeof t.lat=="number"&&!isNaN(t.lat)?t.lat:38.7223,lng:typeof t.lng=="number"&&!isNaN(t.lng)?t.lng:-9.1393,phone:t.phone||"",website_url:t.website_url||"",visible:t.visible??!0,show_takeaway_button:t.show_takeaway_button??!0,show_booking_button:t.show_booking_button??!0}:{name:"",name_en:"",name_pt:"",key_id:"",type:[""],type_en:[""],type_pt:[""],description:"",description_en:"",description_pt:"",announcement_zh:"",announcement_en:"",announcement_pt:"",address:"",lat:38.7223,lng:-9.1393,phone:"",website_url:"",visible:!0,show_takeaway_button:!0,show_booking_button:!0}}),us=()=>{const s=[];I.name&&s.push(a("admin.fieldName")+" (ä¸­æ–‡)"),I.name_en&&s.push(a("admin.fieldName")+" (EN)"),I.name_pt&&s.push(a("admin.fieldName")+" (PT)"),I.type&&s.push(a("admin.fieldType")+" (ä¸­æ–‡)"),I.type_en&&s.push(a("admin.fieldType")+" (EN)"),I.type_pt&&s.push(a("admin.fieldType")+" (PT)"),I.address&&s.push(a("admin.fieldAddress")),(I.lat||I.lng)&&s.push(a("admin.fieldLocation")),s.length>0&&N({title:a("admin.validationFailed"),description:a("admin.missingFields")+": "+s.join(", "),variant:"destructive"})},ps=()=>{H.length<3&&ve([...H,{zh:"",en:"",pt:""}])},hs=s=>{H.length>1&&ve(H.filter((r,m)=>m!==s))},be=(s,r,m)=>{const C=[...H];C[s][r]=m,ve(C),V("type",C.map(F=>F.zh).filter(Boolean)),V("type_en",C.map(F=>F.en).filter(Boolean)),V("type_pt",C.map(F=>F.pt).filter(Boolean))},G=J("lat"),K=J("lng"),xs=J("visible"),gs=J("show_takeaway_button"),fs=J("show_booking_button"),he=(s,r)=>typeof s=="number"&&typeof r=="number"&&!isNaN(s)&&!isNaN(r)&&isFinite(s)&&isFinite(r);u.useEffect(()=>{if(!o){P.current&&(P.current.remove(),P.current=null,ne.current=null);return}if(P.current)return;const s="pk.eyJ1IjoieGlhb3hpb25nMTIzIiwiYSI6ImNtNTFjOXliYjF1Y2IyaXM4bnNzMGxvdnkifQ.mPcWqH7ndIrjEqlWIJVk8g",m=setTimeout(()=>{if(!pe.current){console.error("Map container not found");return}try{Ie.accessToken=s;const C=he(G,K)?K:-9.1393,F=he(G,K)?G:38.7223;P.current=new Ie.Map({container:pe.current,style:"mapbox://styles/mapbox/light-v11",center:[C,F],zoom:15}),P.current.scrollZoom.disable(),P.current.on("load",()=>{P.current&&(he(G,K)&&(ne.current=new Ie.Marker({draggable:!0}).setLngLat([K,G]).addTo(P.current)),ne.current.on("dragend",()=>{const L=ne.current.getLngLat();V("lng",L.lng),V("lat",L.lat)}),setTimeout(()=>{P.current?.resize()},100))});const ye=L=>{L.ctrlKey||L.metaKey?P.current?.scrollZoom.enable():P.current?.scrollZoom.disable()};pe.current.addEventListener("wheel",ye),P.current.on("click",L=>{const{lng:ee,lat:We}=L.lngLat;V("lng",ee),V("lat",We),ne.current?.setLngLat([ee,We])}),P.current.on("error",L=>{console.error("Map error:",L)})}catch(C){console.error("Failed to initialize map:",C)}},500);return()=>{clearTimeout(m)}},[o,G,K]),u.useEffect(()=>{ne.current&&P.current&&he(G,K)&&(ne.current.setLngLat([K,G]),P.current.setCenter([K,G]))},[G,K]);const js=s=>{const r=s.target.files?.[0];if(r){z(r);const m=new FileReader;m.onloadend=()=>{M(m.result)},m.readAsDataURL(r)}},Ke=s=>{const r=s.target.files?.[0];if(r){te(r);const m=new FileReader;m.onloadend=()=>{n(m.result)},m.readAsDataURL(r)}},Ns=s=>{const r=s.target.files?.[0];if(r){y(r);const m=new FileReader;m.onloadend=()=>{re(m.result)},m.readAsDataURL(r)}},vs=s=>{const r=s.target.files?.[0];if(r){le(r);const m=new FileReader;m.onloadend=()=>{ue(m.result)},m.readAsDataURL(r)}},bs=async()=>{if(!p)return t?.image_url||null;const s=p.name.split(".").pop(),m=`${`${Math.random()}.${s}`}`,{error:C}=await k.storage.from("restaurant-images").upload(m,p);if(C)throw C;const{data:{publicUrl:F}}=k.storage.from("restaurant-images").getPublicUrl(m);return F},ys=async()=>{if(!ae)return t?.cover_image_url||null;const s=ae.name.split(".").pop(),m=`${`cover_${Math.random()}.${s}`}`,{error:C}=await k.storage.from("restaurant-images").upload(m,ae);if(C)throw C;const{data:{publicUrl:F}}=k.storage.from("restaurant-images").getPublicUrl(m);return F},ws=async()=>{if(!c)return t?.owner_avatar_url||null;const s=c.name.split(".").pop(),m=`${`owner_${Math.random()}.${s}`}`,{error:C}=await k.storage.from("restaurant-images").upload(m,c);if(C)throw C;const{data:{publicUrl:F}}=k.storage.from("restaurant-images").getPublicUrl(m);return F},_s=async()=>{if(!W)return t?.banner_url||null;const s=W.name.split(".").pop(),m=`${`banner_${Math.random()}.${s}`}`,{error:C}=await k.storage.from("restaurant-images").upload(m,W);if(C)throw C;const{data:{publicUrl:F}}=k.storage.from("restaurant-images").getPublicUrl(m);return F},Qe=async s=>{Be(!0);try{const{data:{user:r}}=await k.auth.getUser();if(!r)throw new Error("Not authenticated");const m=await bs(),C=await ys(),F=await ws(),ye=await _s(),L={name:s.name,name_en:s.name_en,name_pt:s.name_pt,key_id:s.key_id||null,type:s.type,type_en:s.type_en,type_pt:s.type_pt,description:s.description||null,description_en:s.description_en||null,description_pt:s.description_pt||null,announcement_zh:s.announcement_zh||null,announcement_en:s.announcement_en||null,announcement_pt:s.announcement_pt||null,address:s.address,lat:A==="ghost"?s.lat||38.7223:s.lat,lng:A==="ghost"?s.lng||-9.1393:s.lng,phone:s.phone||null,website_url:s.website_url||null,visible:s.visible,show_takeaway_button:s.show_takeaway_button,show_booking_button:A==="ghost"?!1:s.show_booking_button,image_url:m,cover_image_url:C,opening_hours:A==="ghost"?null:l,template:A,owner_avatar_url:F,banner_url:ye,owner_bio:Ue||null,owner_bio_en:qe||null,owner_bio_pt:Me||null,is_chain:w,brand_id:w?_:null,banner_media_type:A==="ghost"?je:"image",promo_video_url:A==="ghost"&&Le||null,promo_video_poster:A==="ghost"&&Oe||null,videos:A==="ghost"?He:[]};if(t){const{error:ee}=await k.from("restaurants").update({...L,updated_by:r.id}).eq("id",t.id);if(ee)throw ee;N({title:a("common.success"),description:a("admin.restaurantUpdated")})}else{const{error:ee}=await k.from("restaurants").insert([{...L,created_by:r.id}]);if(ee)throw ee;N({title:a("common.success"),description:a("admin.restaurantCreated")})}b.invalidateQueries({queryKey:["restaurants"]}),j(!1)}catch(r){N({title:a("common.error"),description:r.message,variant:"destructive"})}finally{Be(!1)}};return e.jsxs(na,{open:o,onOpenChange:j,children:[e.jsx(ia,{asChild:!0,children:x}),e.jsxs(la,{className:"max-w-[95vw] sm:max-w-6xl max-h-[95vh] overflow-hidden flex flex-col p-0",children:[e.jsxs(oa,{className:"px-6 pt-6 pb-4 border-b bg-muted/30",children:[e.jsxs(ca,{className:"text-2xl flex items-center gap-2",children:[e.jsx(Ce,{className:"w-6 h-6 text-primary"}),a(t?"admin.editRestaurant":"admin.addRestaurant")]}),e.jsx(da,{className:"text-base",children:a(t?"admin.editRestaurantDetails":"admin.createRestaurantWithInfo")})]}),e.jsx(ma,{className:"px-6 h-[calc(95vh-220px)]",children:e.jsxs("form",{onSubmit:Ge(Qe,us),className:"space-y-6 py-6",children:[e.jsx($,{className:"border-primary/20 bg-gradient-to-br from-primary/5 to-background",children:e.jsx(U,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(ke,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsx(i,{className:"text-base font-semibold",children:a("admin.frontendDisplay")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a("admin.frontendDisplayDesc")})]})]}),e.jsx(Je,{checked:xs,onCheckedChange:s=>V("visible",s)})]})})}),f&&e.jsx($,{className:"border-primary/20 bg-gradient-to-br from-background to-muted/20",children:e.jsxs(U,{className:"p-6",children:[e.jsxs(i,{className:"text-base font-semibold flex items-center gap-2 mb-4",children:[e.jsx(Ce,{className:"w-5 h-5 text-primary"}),a("admin.restaurantTemplate")]}),e.jsxs(rs,{value:A,onValueChange:Ne,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-start space-x-3 p-4 rounded-lg border border-border hover:border-primary/50 transition-colors cursor-pointer",onClick:()=>Ne("default"),children:[e.jsx(ge,{value:"default",id:"template-default",className:"mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(i,{htmlFor:"template-default",className:"text-sm font-medium cursor-pointer",children:a("admin.templateDefault")}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:a("admin.templateDefaultDesc")})]})]}),e.jsxs("div",{className:"flex items-start space-x-3 p-4 rounded-lg border border-border hover:border-primary/50 transition-colors cursor-pointer",onClick:()=>Ne("ghost"),children:[e.jsx(ge,{value:"ghost",id:"template-ghost",className:"mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(i,{htmlFor:"template-ghost",className:"text-sm font-medium cursor-pointer",children:a("admin.templateGhost")}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:a("admin.templateGhostDesc")})]})]})]})]})}),e.jsx($,{className:"border-primary/20 bg-gradient-to-br from-background to-muted/20",children:e.jsxs(U,{className:"p-6",children:[e.jsxs(i,{className:"text-base font-semibold flex items-center gap-2 mb-4",children:[e.jsx(Ze,{className:"w-5 h-5 text-primary"}),a("admin.restaurant.isChain")]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(i,{className:"text-sm font-medium",children:a("admin.restaurant.isChain")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a("admin.restaurant.isChainDesc")})]}),e.jsx(Je,{checked:w,onCheckedChange:s=>{v(s),s||q(null)}})]}),w&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-sm font-medium",children:a("admin.restaurant.selectBrand")}),e.jsxs(ua,{value:_||"",onValueChange:s=>q(s||null),children:[e.jsx(pa,{children:e.jsx(ha,{placeholder:a("admin.restaurant.selectBrandPlaceholder")})}),e.jsx(xa,{children:S?.map(s=>e.jsx(ga,{value:s.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[s.logo_url?e.jsx("img",{src:s.logo_url,alt:"",className:"w-5 h-5 object-contain rounded"}):e.jsx(Ze,{className:"w-4 h-4 text-muted-foreground"}),s.name]})},s.id))})]})]})]})]})}),e.jsx($,{className:"border-primary/20 bg-gradient-to-br from-background to-muted/20",children:e.jsxs(U,{className:"p-6",children:[e.jsxs(i,{className:"text-base font-semibold flex items-center gap-2 mb-4",children:[e.jsx(me,{className:"w-5 h-5 text-primary"}),a("admin.restaurantImages")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:a("admin.cardImage")}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",a("admin.cardImageHint"),")"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[ie&&e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:ie,alt:"Card Preview",className:"w-32 h-32 object-cover rounded-lg shadow-lg ring-2 ring-primary/20 transition-transform duration-200 group-hover:scale-105"}),e.jsx(D,{type:"button",variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>{z(null),M(null)},children:e.jsx(O,{className:"h-3 w-3"})})]}),e.jsxs(i,{htmlFor:"image-upload",className:"cursor-pointer",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2 px-6 py-4 border-2 border-dashed border-primary/30 rounded-lg hover:border-primary hover:bg-primary/5 transition-all duration-200",children:[e.jsx(me,{className:"h-6 w-6 text-primary"}),e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"font-medium text-xs",children:a("admin.uploadImage")})})]}),e.jsx(h,{id:"image-upload",type:"file",accept:"image/*",className:"hidden",onChange:js})]})]})]}),A!=="ghost"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:a("admin.coverImage")}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",a("admin.coverImageHint"),")"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[d&&e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:d,alt:"Cover Preview",className:"w-32 h-32 object-cover rounded-lg shadow-lg ring-2 ring-accent/20 transition-transform duration-200 group-hover:scale-105"}),e.jsx(D,{type:"button",variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>{te(null),n(null)},children:e.jsx(O,{className:"h-3 w-3"})})]}),e.jsxs(i,{htmlFor:"cover-image-upload",className:"cursor-pointer",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2 px-6 py-4 border-2 border-dashed border-accent/30 rounded-lg hover:border-accent hover:bg-accent/5 transition-all duration-200",children:[e.jsx(se,{className:"h-6 w-6 text-accent"}),e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"font-medium text-xs",children:a("admin.uploadImage")})})]}),e.jsx(h,{id:"cover-image-upload",type:"file",accept:"image/*",className:"hidden",onChange:Ke})]})]})]})]})]})}),t?.id&&e.jsx($,{className:"border-primary/20",children:e.jsxs(U,{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs(i,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5 text-primary"}),a("admin.dishGallery")]})}),e.jsx(_a,{restaurantId:t.id})]})}),e.jsx($,{className:"border-primary/20",children:e.jsxs(U,{className:"p-6",children:[e.jsxs(i,{className:"text-base font-semibold flex items-center gap-2 mb-4",children:[e.jsx(ke,{className:"w-5 h-5 text-primary"}),a("admin.multilingualContent")]}),e.jsxs(Ee,{defaultValue:"zh",className:"w-full",children:[e.jsxs(ze,{className:"grid w-full grid-cols-3 mb-6",children:[e.jsxs(X,{value:"zh",className:"gap-2",children:["ðŸ‡¨ðŸ‡³ ",a("admin.chinese")]}),e.jsxs(X,{value:"en",className:"gap-2",children:["ðŸ‡¬ðŸ‡§ ",a("admin.english")]}),e.jsxs(X,{value:"pt",className:"gap-2",children:["ðŸ‡µðŸ‡¹ ",a("admin.portuguese")]})]}),e.jsxs(Z,{value:"zh",className:"space-y-4 mt-0",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"name",className:"text-sm font-medium",children:a("admin.restaurantName")}),e.jsx(h,{id:"name",...B("name"),placeholder:a("admin.enterRestaurantName"),className:"text-base"}),I.name&&e.jsx("p",{className:"text-sm text-destructive",children:I.name.message})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(i,{className:"text-sm font-medium",children:a("admin.restaurantType")}),H.length<3&&e.jsx(D,{type:"button",variant:"outline",size:"sm",onClick:ps,children:a("admin.addType")})]}),H.map((s,r)=>e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(Te,{placeholder:a("admin.typeExample"),value:s.zh,onChange:m=>be(r,"zh",m),suggestions:g?.uniqueZh||[]}),e.jsx(D,{type:"button",variant:"ghost",size:"icon",onClick:()=>hs(r),disabled:H.length===1,children:e.jsx(O,{className:"h-4 w-4"})})]},r)),I.type&&e.jsx("p",{className:"text-sm text-destructive",children:I.type.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"description",className:"text-sm font-medium",children:a("admin.description")}),e.jsx(De,{value:J("description")||"",onChange:s=>V("description",s),placeholder:a("admin.enterDescription")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"announcement_zh",className:"text-sm font-medium",children:a("admin.announcement")}),e.jsx(oe,{id:"announcement_zh",...B("announcement_zh"),rows:2,placeholder:a("admin.enterAnnouncement")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a("admin.announcementHint")})]})]}),e.jsxs(Z,{value:"en",className:"space-y-4 mt-0",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"name_en",className:"text-sm font-medium",children:"Restaurant Name"}),e.jsx(h,{id:"name_en",...B("name_en"),placeholder:"Enter restaurant name...",className:"text-base"}),I.name_en&&e.jsx("p",{className:"text-sm text-destructive",children:I.name_en.message})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(i,{className:"text-sm font-medium",children:"Restaurant Types (1-3 tags)"}),H.map((s,r)=>e.jsx("div",{className:"flex gap-2 items-center",children:e.jsx(Te,{placeholder:"e.g. Cantonese",value:s.en,onChange:m=>be(r,"en",m),suggestions:g?.uniqueEn||[]})},r))]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"description_en",className:"text-sm font-medium",children:"Description"}),e.jsx(De,{value:J("description_en")||"",onChange:s=>V("description_en",s),placeholder:"Enter restaurant description..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"announcement_en",className:"text-sm font-medium",children:"Announcement"}),e.jsx(oe,{id:"announcement_en",...B("announcement_en"),rows:2,placeholder:"Enter announcement (optional)..."}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Display important notices at top of restaurant page"})]})]}),e.jsxs(Z,{value:"pt",className:"space-y-4 mt-0",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"name_pt",className:"text-sm font-medium",children:"Nome do Restaurante"}),e.jsx(h,{id:"name_pt",...B("name_pt"),placeholder:"Digite o nome do restaurante...",className:"text-base"}),I.name_pt&&e.jsx("p",{className:"text-sm text-destructive",children:I.name_pt.message})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(i,{className:"text-sm font-medium",children:"Tipos de Restaurante (1-3 tags)"}),H.map((s,r)=>e.jsx("div",{className:"flex gap-2 items-center",children:e.jsx(Te,{placeholder:"ex: Cantonesa",value:s.pt,onChange:m=>be(r,"pt",m),suggestions:g?.uniquePt||[]})},r))]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"description_pt",className:"text-sm font-medium",children:"DescriÃ§Ã£o"}),e.jsx(De,{value:J("description_pt")||"",onChange:s=>V("description_pt",s),placeholder:"Digite a descriÃ§Ã£o do restaurante..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"announcement_pt",className:"text-sm font-medium",children:"AnÃºncio"}),e.jsx(oe,{id:"announcement_pt",...B("announcement_pt"),rows:2,placeholder:"Digite o anÃºncio (opcional)..."}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Exibir avisos importantes no topo da pÃ¡gina do restaurante"})]})]})]})]})}),e.jsx($,{className:"border-primary/20",children:e.jsxs(U,{className:"p-6 space-y-4",children:[e.jsxs(i,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(xe,{className:"w-5 h-5 text-primary"}),a("admin.locationAndContact")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"address",className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(xe,{className:"w-4 h-4"}),a("admin.address")]}),e.jsx(h,{id:"address",...B("address"),placeholder:a("admin.enterAddress")}),I.address&&e.jsx("p",{className:"text-sm text-destructive",children:I.address.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"phone",className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ls,{className:"w-4 h-4"}),a("admin.phone")]}),e.jsx(h,{id:"phone",...B("phone"),placeholder:"+351..."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"website_url",className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ke,{className:"w-4 h-4"}),a("admin.websiteBaseUrl")]}),e.jsx(h,{id:"website_url",...B("website_url"),placeholder:"https://sushi.xiaoxiong.pt:6000",readOnly:!f,disabled:!f,className:f?"":"bg-muted cursor-not-allowed"}),!f&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a("admin.websiteReadOnly")})]}),f&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"key_id",className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Os,{className:"w-4 h-4"}),"Key ID (API)"]}),e.jsx(h,{id:"key_id",...B("key_id"),placeholder:"ä¾‹å¦‚: saldanha01"})]})]}),e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsx(i,{className:"text-sm font-medium text-muted-foreground",children:a("admin.displaySettings")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 p-3 rounded-lg border bg-muted/30",children:[e.jsx(ce,{id:"show_takeaway_button",checked:gs,onCheckedChange:s=>V("show_takeaway_button",s)}),e.jsxs(i,{htmlFor:"show_takeaway_button",className:"cursor-pointer text-sm flex items-center gap-2",children:[e.jsx(Hs,{className:"w-4 h-4"}),a("admin.showTakeawayButton")]})]}),A!=="ghost"&&e.jsxs("div",{className:"flex items-center space-x-2 p-3 rounded-lg border bg-muted/30",children:[e.jsx(ce,{id:"show_booking_button",checked:fs,onCheckedChange:s=>V("show_booking_button",s)}),e.jsxs(i,{htmlFor:"show_booking_button",className:"cursor-pointer text-sm flex items-center gap-2",children:[e.jsx(Se,{className:"w-4 h-4"}),a("admin.showBookingButton")]})]})]})]})]})}),A==="ghost"&&e.jsx($,{className:"border-primary/20 bg-gradient-to-br from-background to-muted/20",children:e.jsxs(U,{className:"p-6",children:[e.jsxs(i,{className:"text-base font-semibold flex items-center gap-2 mb-4",children:[e.jsx(se,{className:"w-5 h-5 text-primary"}),a("admin.visualAssets","è§†è§‰ç´ æ")]}),e.jsx("div",{className:"mb-6",children:e.jsx(ka,{bannerMediaType:je,onBannerMediaTypeChange:os,promoVideoUrl:Le,onPromoVideoUrlChange:cs,promoVideoPoster:Oe,onPromoVideoPosterChange:ds,videos:He,onVideosChange:ms})}),je==="image"&&e.jsxs("div",{className:"space-y-4 mb-6 p-4 border rounded-lg bg-muted/20",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:a("admin.backgroundImage","èƒŒæ™¯å›¾")})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a("admin.backgroundImageDesc","æ­¤å›¾ç‰‡å°†æ˜¾ç¤ºåœ¨è¯¦æƒ…é¡µé¡¶éƒ¨ä½œä¸ºèƒŒæ™¯æ¨ªå¹…")}),e.jsxs("div",{className:"flex items-start gap-4",children:[Y&&e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:Y,alt:"Background Banner Preview",className:"w-40 h-20 object-cover rounded-lg shadow-lg ring-2 ring-primary/20 transition-transform duration-200 group-hover:scale-105"}),e.jsx(D,{type:"button",variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity rounded-full",onClick:()=>{le(null),ue(null)},children:e.jsx(O,{className:"h-3 w-3"})})]}),e.jsxs(i,{htmlFor:"ghost-banner-upload",className:"cursor-pointer",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2 px-6 py-4 border-2 border-dashed border-primary/30 rounded-lg hover:border-primary hover:bg-primary/5 transition-all duration-200",children:[e.jsx(se,{className:"h-6 w-6 text-primary"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-medium text-xs",children:a("admin.uploadImage")}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["16:9 ",a("admin.recommended","æŽ¨è")]})]})]}),e.jsx(h,{id:"ghost-banner-upload",type:"file",accept:"image/*",className:"hidden",onChange:vs})]})]})]}),e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-muted/20",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm font-medium",children:a("admin.signatureDish","æ‹›ç‰Œç¾Žé£Ÿ")})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a("admin.signatureDishDesc","æ­¤å›¾ç‰‡å°†æ˜¾ç¤ºåœ¨è¯¦æƒ…é¡µç¾Žé£Ÿå±•ç¤ºåŒº")}),e.jsxs("div",{className:"flex items-start gap-4",children:[d&&e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:d,alt:"Food Image Preview",className:"w-32 h-32 object-cover rounded-lg shadow-lg ring-2 ring-primary/20 transition-transform duration-200 group-hover:scale-105"}),e.jsx(D,{type:"button",variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity rounded-full",onClick:()=>{te(null),n(null)},children:e.jsx(O,{className:"h-3 w-3"})})]}),e.jsxs(i,{htmlFor:"ghost-cover-image-upload",className:"cursor-pointer",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2 px-6 py-4 border-2 border-dashed border-primary/30 rounded-lg hover:border-primary hover:bg-primary/5 transition-all duration-200",children:[e.jsx(Se,{className:"h-6 w-6 text-primary"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-medium text-xs",children:a("admin.uploadImage")}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["1:1 ",a("admin.recommended","æŽ¨è")]})]})]}),e.jsx(h,{id:"ghost-cover-image-upload",type:"file",accept:"image/*",className:"hidden",onChange:Ke})]})]})]})]})}),A==="ghost"&&e.jsx($,{className:"border-primary/20 bg-gradient-to-br from-background to-muted/20",children:e.jsxs(U,{className:"p-6",children:[e.jsxs(i,{className:"text-base font-semibold flex items-center gap-2 mb-4",children:[e.jsx(Ye,{className:"w-5 h-5 text-primary"}),a("admin.chefProfile","å¤§åŽ¨æ¡£æ¡ˆ")]}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"text-sm font-medium",children:a("admin.ownerAvatar")})}),e.jsxs("div",{className:"flex items-center gap-4",children:[Q&&e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:Q,alt:"Owner Avatar Preview",className:"w-20 h-20 object-cover rounded-full shadow-lg ring-2 ring-primary/20 transition-transform duration-200 group-hover:scale-105"}),e.jsx(D,{type:"button",variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity rounded-full",onClick:()=>{y(null),re(null)},children:e.jsx(O,{className:"h-3 w-3"})})]}),e.jsxs(i,{htmlFor:"owner-avatar-upload",className:"cursor-pointer",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2 px-6 py-4 border-2 border-dashed border-primary/30 rounded-lg hover:border-primary hover:bg-primary/5 transition-all duration-200",children:[e.jsx(Ye,{className:"h-6 w-6 text-primary"}),e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"font-medium text-xs",children:a("admin.uploadImage")})})]}),e.jsx(h,{id:"owner-avatar-upload",type:"file",accept:"image/*",className:"hidden",onChange:Ns})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(i,{className:"text-sm font-medium",children:a("admin.ownerBio")}),e.jsxs(Ee,{defaultValue:"zh",className:"w-full",children:[e.jsxs(ze,{className:"grid w-full grid-cols-3 mb-4",children:[e.jsxs(X,{value:"zh",className:"gap-2 text-xs",children:["ðŸ‡¨ðŸ‡³ ",a("admin.chinese")]}),e.jsxs(X,{value:"en",className:"gap-2 text-xs",children:["ðŸ‡¬ðŸ‡§ ",a("admin.english")]}),e.jsxs(X,{value:"pt",className:"gap-2 text-xs",children:["ðŸ‡µðŸ‡¹ ",a("admin.portuguese")]})]}),e.jsx(Z,{value:"zh",children:e.jsx(oe,{value:Ue,onChange:s=>ns(s.target.value),rows:4,placeholder:a("admin.ownerBioPlaceholder")})}),e.jsx(Z,{value:"en",children:e.jsx(oe,{value:qe,onChange:s=>is(s.target.value),rows:4,placeholder:"Share your story, philosophy and culinary passion..."})}),e.jsx(Z,{value:"pt",children:e.jsx(oe,{value:Me,onChange:s=>ls(s.target.value),rows:4,placeholder:"Compartilhe sua histÃ³ria, filosofia e paixÃ£o culinÃ¡ria..."})})]})]})]})}),A!=="ghost"&&e.jsx($,{className:"border-primary/20",children:e.jsxs(U,{className:"p-6 space-y-4",children:[e.jsxs(i,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(xe,{className:"w-5 h-5 text-primary"}),a("admin.location")]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"lat",className:"text-sm font-medium",children:a("admin.latitude")}),e.jsx(h,{id:"lat",type:"number",step:"any",...B("lat",{valueAsNumber:!0})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"lng",className:"text-sm font-medium",children:a("admin.longitude")}),e.jsx(h,{id:"lng",type:"number",step:"any",...B("lng",{valueAsNumber:!0})})]})]}),e.jsx("div",{ref:pe,className:"h-96 w-full rounded-lg border-2 border-primary/20 shadow-sm",style:{minHeight:"384px"}}),e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[e.jsx(xe,{className:"w-4 h-4"}),a("admin.clickOrDragToSetLocation")]})]})}),A!=="ghost"&&e.jsx($,{className:"border-primary/20 overflow-hidden",children:e.jsxs(U,{className:"p-3 md:p-6 space-y-4",children:[e.jsxs(i,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(Gs,{className:"w-5 h-5 text-primary"}),a("admin.openingHours")]}),e.jsx("div",{className:"space-y-2",children:ss.map(s=>e.jsxs("div",{className:"space-y-2 p-2 md:p-3 rounded-lg hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"md:hidden space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{className:"capitalize font-semibold text-sm",children:a(`admin.day.${s}`)}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ce,{id:`split-mobile-${s}`,checked:l[s].splitShift,onCheckedChange:r=>T({...l,[s]:{...l[s],splitShift:r}}),disabled:l[s].closed,className:"h-4 w-4"}),e.jsx(i,{htmlFor:`split-mobile-${s}`,className:"cursor-pointer text-xs",children:"åˆ†æ®µ"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ce,{id:`closed-mobile-${s}`,checked:l[s].closed,onCheckedChange:r=>T({...l,[s]:{...l[s],closed:r}}),className:"h-4 w-4"}),e.jsx(i,{htmlFor:`closed-mobile-${s}`,className:"cursor-pointer text-xs",children:a("admin.closed")})]})]})]}),!l[s].closed&&e.jsx("div",{className:"space-y-1.5",children:l[s].splitShift?e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"grid grid-cols-[32px_1fr_12px_1fr] gap-1 items-center",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"åˆé¤"}),e.jsx(h,{type:"time",value:l[s].open,onChange:r=>T({...l,[s]:{...l[s],open:r.target.value}}),className:"h-8 text-xs px-2 min-w-0"}),e.jsx("span",{className:"text-muted-foreground text-xs text-center",children:"-"}),e.jsx(h,{type:"time",value:l[s].close,onChange:r=>T({...l,[s]:{...l[s],close:r.target.value}}),className:"h-8 text-xs px-2 min-w-0"})]}),e.jsxs("div",{className:"grid grid-cols-[32px_1fr_12px_1fr] gap-1 items-center",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"æ™šé¤"}),e.jsx(h,{type:"time",value:l[s].open2||"19:00",onChange:r=>T({...l,[s]:{...l[s],open2:r.target.value}}),className:"h-8 text-xs px-2 min-w-0"}),e.jsx("span",{className:"text-muted-foreground text-xs text-center",children:"-"}),e.jsx(h,{type:"time",value:l[s].close2||"23:00",onChange:r=>T({...l,[s]:{...l[s],close2:r.target.value}}),className:"h-8 text-xs px-2 min-w-0"})]})]}):e.jsxs("div",{className:"grid grid-cols-[1fr_12px_1fr] gap-1 items-center",children:[e.jsx(h,{type:"time",value:l[s].open,onChange:r=>T({...l,[s]:{...l[s],open:r.target.value}}),className:"h-8 text-xs px-2 min-w-0"}),e.jsx("span",{className:"text-muted-foreground text-xs text-center",children:"-"}),e.jsx(h,{type:"time",value:l[s].close,onChange:r=>T({...l,[s]:{...l[s],close:r.target.value}}),className:"h-8 text-xs px-2 min-w-0"})]})})]}),e.jsxs("div",{className:"hidden md:block",children:[e.jsxs("div",{className:"grid grid-cols-[120px_1fr_auto] gap-4 items-center",children:[e.jsx(i,{className:"capitalize font-semibold",children:a(`admin.day.${s}`)}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{id:`split-${s}`,checked:l[s].splitShift,onCheckedChange:r=>T({...l,[s]:{...l[s],splitShift:r}}),disabled:l[s].closed}),e.jsx(i,{htmlFor:`split-${s}`,className:"cursor-pointer text-sm",children:"åˆ†æ®µè¥ä¸š"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ce,{id:`closed-${s}`,checked:l[s].closed,onCheckedChange:r=>T({...l,[s]:{...l[s],closed:r}})}),e.jsx(i,{htmlFor:`closed-${s}`,className:"cursor-pointer",children:a("admin.closed")})]})]}),!l[s].closed&&e.jsx("div",{className:"ml-[120px] space-y-2 mt-2",children:l[s].splitShift?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground w-12",children:"åˆé¤"}),e.jsx(h,{type:"time",value:l[s].open,onChange:r=>T({...l,[s]:{...l[s],open:r.target.value}}),className:"w-32"}),e.jsx("span",{className:"text-muted-foreground",children:"-"}),e.jsx(h,{type:"time",value:l[s].close,onChange:r=>T({...l,[s]:{...l[s],close:r.target.value}}),className:"w-32"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground w-12",children:"æ™šé¤"}),e.jsx(h,{type:"time",value:l[s].open2||"19:00",onChange:r=>T({...l,[s]:{...l[s],open2:r.target.value}}),className:"w-32"}),e.jsx("span",{className:"text-muted-foreground",children:"-"}),e.jsx(h,{type:"time",value:l[s].close2||"23:00",onChange:r=>T({...l,[s]:{...l[s],close2:r.target.value}}),className:"w-32"})]})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{type:"time",value:l[s].open,onChange:r=>T({...l,[s]:{...l[s],open:r.target.value}}),className:"w-32"}),e.jsx("span",{className:"text-muted-foreground",children:"-"}),e.jsx(h,{type:"time",value:l[s].close,onChange:r=>T({...l,[s]:{...l[s],close:r.target.value}}),className:"w-32"})]})})]})]},s))})]})})]})}),e.jsxs("div",{className:"flex justify-end gap-2 px-6 py-4 border-t bg-muted/30",children:[e.jsx(D,{type:"button",variant:"outline",onClick:()=>j(!1),children:a("common.cancel")}),e.jsxs(D,{type:"submit",disabled:Ve,onClick:Ge(Qe),className:"gap-2",children:[e.jsx(Ce,{className:"w-4 h-4"}),a(Ve?"common.saving":"common.save")]})]})]})]})}export{Ma as R,Na as u};
//# sourceMappingURL=RestaurantFormDialog-kbIpoIwX.js.map
