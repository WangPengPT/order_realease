import{q as M,a as k,u as P,G as L,j as e,L as d,B as t,h as i,C as g,n as v,m as T,x as $,i as z,T as B,au as H,at as S,V as E,W as F,Y as G,Z as U,$ as V,a0 as W,a1 as Y,v as l}from"./index-Ga7ov3Y-.js";import{d as Z,e as I,c as J}from"./useActivityRequests-DzZQMwQH.js";import{u as K}from"./useLocalizedContent-_OgE7_A3.js";import{P as p}from"./plus-OfcrrL7p.js";import{C as O}from"./clock-IUUuEGhK.js";import{E as Q}from"./external-link-D5MDGrhG.js";import{S as m}from"./square-pen-C3A5fRkz.js";import{R as N}from"./refresh-cw-DEovioOt.js";import{T as X}from"./triangle-alert-DzM90nvF.js";import{f as o}from"./format-Dyk5jgbb.js";import"./startOfDay-DpMPS_Sq.js";const me=()=>{M();const y=k(),{t:a}=P(),{isMerchant:w,isSupervisor:b,isLoading:h}=L(),{data:x=[],isLoading:C}=Z(),{localizeActivity:A}=K(),r=I(),D=J();if(!h&&!w&&!b)return y("/"),null;if(C||h)return e.jsx("div",{className:"flex justify-center items-center min-h-[50vh]",children:e.jsx(d,{className:"w-8 h-8 animate-spin text-primary"})});const R=s=>{if(s.status==="approved"&&s.activity_deleted)return e.jsxs(l,{variant:"outline",className:"border-orange-500 text-orange-500 flex items-center gap-1",children:[e.jsx(X,{className:"w-3 h-3"}),a("merchant.activityDeleted")]});switch(s.status){case"approved":return e.jsx(l,{className:"bg-green-500",children:a("merchant.statusApproved")});case"rejected":return e.jsx(l,{variant:"destructive",children:a("merchant.statusRejected")});default:return e.jsx(l,{variant:"secondary",children:a("merchant.statusPending")})}},j=s=>{r.mutate(s)},_=s=>{D.mutate(s)};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:a("merchant.myActivityRequests")}),e.jsx("p",{className:"text-muted-foreground",children:a("merchant.viewManageRequests")})]}),e.jsx(t,{asChild:!0,children:e.jsxs(i,{to:"/merchant/activity-request-form",children:[e.jsx(p,{className:"w-4 h-4 mr-2"}),a("merchant.createRequest")]})})]}),x.length===0?e.jsx(g,{children:e.jsxs(v,{className:"py-12 text-center",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:a("merchant.noRequests")}),e.jsx(t,{asChild:!0,children:e.jsxs(i,{to:"/merchant/activity-request-form",children:[e.jsx(p,{className:"w-4 h-4 mr-2"}),a("merchant.createRequest")]})})]})}):e.jsx("div",{className:"grid grid-cols-1 gap-6",children:x.map(s=>{const n=A(s),c=s.status==="approved"&&s.activity_deleted,u=s.status==="pending",f=s.status==="rejected";return e.jsxs(g,{className:c?"border-orange-200 bg-orange-50/50 dark:border-orange-900 dark:bg-orange-950/20":"",children:[e.jsx(T,{children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsx($,{className:"flex-1",children:n.title}),R(s)]})}),e.jsxs(v,{className:"space-y-4",children:[s.image_url&&e.jsx("div",{className:"relative h-48 rounded-lg overflow-hidden",children:e.jsx("img",{src:s.image_url,alt:n.title,className:"w-full h-full object-cover"})}),n.intro&&e.jsx("p",{className:"text-muted-foreground",children:n.intro}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4"}),e.jsxs("span",{children:[o(new Date(s.start_date),"yyyy-MM-dd"),s.end_date&&` - ${o(new Date(s.end_date),"yyyy-MM-dd")}`]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4"}),e.jsxs("span",{children:[a("merchant.submittedAt")," ",o(new Date(s.created_at),"yyyy-MM-dd HH:mm")]})]})]}),s.admin_notes&&e.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:a("merchant.adminNotes")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.admin_notes})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 pt-2",children:[s.status==="approved"&&!s.activity_deleted&&s.created_activity_id&&e.jsx(t,{asChild:!0,variant:"outline",className:"flex-1 sm:flex-none",children:e.jsxs(i,{to:`/activity/${s.created_activity_id}`,children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),a("merchant.viewCreatedActivity")]})}),c&&e.jsxs(e.Fragment,{children:[e.jsx(t,{asChild:!0,variant:"outline",className:"flex-1 sm:flex-none",children:e.jsxs(i,{to:`/merchant/activity-request-form?edit=${s.id}`,children:[e.jsx(m,{className:"w-4 h-4 mr-2"}),a("merchant.edit")]})}),e.jsxs(t,{variant:"default",className:"flex-1 sm:flex-none",onClick:()=>j(s.id),disabled:r.isPending,children:[r.isPending?e.jsx(d,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(N,{className:"w-4 h-4 mr-2"}),a("merchant.resubmit")]})]}),u&&e.jsx(t,{asChild:!0,variant:"outline",className:"flex-1 sm:flex-none",children:e.jsxs(i,{to:`/merchant/activity-request-form?edit=${s.id}`,children:[e.jsx(m,{className:"w-4 h-4 mr-2"}),a("merchant.edit")]})}),f&&e.jsxs(e.Fragment,{children:[e.jsx(t,{asChild:!0,variant:"outline",className:"flex-1 sm:flex-none",children:e.jsxs(i,{to:`/merchant/activity-request-form?edit=${s.id}`,children:[e.jsx(m,{className:"w-4 h-4 mr-2"}),a("merchant.edit")]})}),e.jsxs(t,{variant:"default",className:"flex-1 sm:flex-none",onClick:()=>j(s.id),disabled:r.isPending,children:[r.isPending?e.jsx(d,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(N,{className:"w-4 h-4 mr-2"}),a("merchant.resubmit")]})]}),(u||f||c)&&e.jsxs(B,{children:[e.jsx(H,{asChild:!0,children:e.jsx(t,{variant:"destructive",size:"icon",className:"shrink-0",children:e.jsx(S,{className:"w-4 h-4"})})}),e.jsxs(E,{children:[e.jsxs(F,{children:[e.jsx(G,{children:a("merchant.confirmDelete")}),e.jsx(U,{children:a("merchant.confirmDeleteDesc")})]}),e.jsxs(V,{children:[e.jsx(W,{children:a("common.cancel")}),e.jsx(Y,{onClick:()=>_(s.id),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:a("merchant.delete")})]})]})]})]})]})]},s.id)})})]})};export{me as default};
