import{j as i}from"./vendor-ui-BO6fjm1h.js";import{r as n}from"./vendor-react-CrHRjzzo.js";import{f as y,bj as S}from"./index-Bjy07DNZ.js";function L({onRefresh:u,threshold:c=80,maxPull:f=120}){const[r,o]=n.useState(!1),[t,d]=n.useState(!1),[a,l]=n.useState(0),g=n.useRef(0),E=n.useRef(0),m=n.useRef(null),p=n.useCallback(e=>{const s=m.current,w=window.scrollY||window.pageYOffset||0,x=document.documentElement.scrollTop||0,T=document.body.scrollTop||0,j=s?.scrollTop||0;Math.max(w,x,T,j)>5||(g.current=e.touches[0].clientY,o(!0))},[]),h=n.useCallback(e=>{if(!r||t)return;E.current=e.touches[0].clientY;const s=E.current-g.current;if(s<0){l(0);return}s>5&&(e.preventDefault(),e.stopPropagation());const x=Math.min(s*.6,f);l(x)},[r,t,f]),v=n.useCallback(async()=>{if(r)if(o(!1),a>=c&&!t){d(!0),l(c);try{await u()}finally{d(!1),l(0)}}else l(0)},[r,a,c,t,u]),b=n.useCallback(()=>{o(!1),l(0)},[]);n.useEffect(()=>{const e=m.current;if(!e)return;const s={passive:!1};return e.addEventListener("touchstart",p,s),e.addEventListener("touchmove",h,s),e.addEventListener("touchend",v,{passive:!0}),e.addEventListener("touchcancel",b,{passive:!0}),()=>{e.removeEventListener("touchstart",p),e.removeEventListener("touchmove",h),e.removeEventListener("touchend",v),e.removeEventListener("touchcancel",b)}},[p,h,v,b]);const R=Math.min(a/c,1);return{containerRef:m,isPulling:r,isRefreshing:t,pullDistance:a,progress:R}}function M({children:u,onRefresh:c,className:f}){const{containerRef:r,isRefreshing:o,pullDistance:t,progress:d}=L({onRefresh:c,threshold:80,maxPull:120}),a={overscrollBehavior:"none",WebkitOverflowScrolling:"touch"};return i.jsxs("div",{ref:r,className:y("relative",f),style:a,children:[i.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 z-50 flex items-center justify-center transition-opacity duration-200 pointer-events-none",style:{top:Math.max(t-50,8),opacity:t>20?1:0},children:i.jsx("div",{className:y("w-10 h-10 rounded-full bg-background/90 backdrop-blur-sm shadow-lg flex items-center justify-center border border-border/50",o&&"animate-pulse"),children:i.jsx(S,{className:y("w-5 h-5 text-primary transition-transform duration-200",o&&"animate-spin"),style:{transform:o?void 0:`rotate(${d*360}deg)`}})})}),i.jsx("div",{style:{transform:t>0?`translateY(${t}px)`:void 0,transition:t===0?"transform 0.3s ease-out":void 0},children:u})]})}export{M as P};
//# sourceMappingURL=PullToRefresh-DIuS7mwV.js.map
