import{p,ad as m,ae as l,s as o,z as a}from"./index-DVul3rRI.js";const g=()=>p({queryKey:["homepage-templates"],queryFn:async()=>{const{data:e,error:r}=await o.from("homepage_templates").select("*").order("sort_order",{ascending:!0});if(r)throw r;return e}}),f=()=>p({queryKey:["homepage-templates","active"],queryFn:async()=>{const{data:e,error:r}=await o.from("homepage_templates").select("*").eq("is_active",!0).order("sort_order",{ascending:!0});if(r)throw r;return e}}),h=()=>{const e=m();return l({mutationFn:async r=>{const{data:t,error:s}=await o.from("homepage_templates").insert(r).select().single();if(s)throw s;return t},onSuccess:()=>{e.invalidateQueries({queryKey:["homepage-templates"]}),a.success("模板创建成功")},onError:r=>{console.error("Failed to create template:",r),a.error("创建失败")}})},y=()=>{const e=m();return l({mutationFn:async({id:r,...t})=>{const{data:s,error:c}=await o.from("homepage_templates").update(t).eq("id",r).select().single();if(c)throw c;return s},onSuccess:()=>{e.invalidateQueries({queryKey:["homepage-templates"]}),a.success("模板更新成功")},onError:r=>{console.error("Failed to update template:",r),a.error("更新失败")}})},w=()=>{const e=m();return l({mutationFn:async r=>{const{error:t}=await o.from("homepage_templates").delete().eq("id",r);if(t)throw t},onSuccess:()=>{e.invalidateQueries({queryKey:["homepage-templates"]}),a.success("模板删除成功")},onError:r=>{console.error("Failed to delete template:",r),a.error("删除失败")}})},q=()=>l({mutationFn:async({file:e,type:r,templateId:t})=>{const s=e.name.split(".").pop(),n=`template-${t}-${r}-${Date.now()}.${s}`,{error:u}=await o.storage.from("homepage-images").upload(n,e,{upsert:!0});if(u)throw u;const{data:{publicUrl:i}}=o.storage.from("homepage-images").getPublicUrl(n);return{type:r,url:i}},onSuccess:({type:e})=>{a.success(`${e}图片上传成功`)},onError:e=>{console.error("Failed to upload image:",e),a.error("图片上传失败")}}),F=()=>l({mutationFn:async({file:e,type:r,templateId:t})=>{const s=e.name.split(".").pop(),n=`template-${t}-${r}-video-${Date.now()}.${s}`,{error:u}=await o.storage.from("homepage-images").upload(n,e,{upsert:!0});if(u)throw u;const{data:{publicUrl:i}}=o.storage.from("homepage-images").getPublicUrl(n);return{type:r,url:i}},onSuccess:({type:e})=>{a.success(`${e}视频上传成功`)},onError:e=>{console.error("Failed to upload video:",e),a.error("视频上传失败")}});export{g as a,h as b,y as c,w as d,q as e,F as f,f as u};
