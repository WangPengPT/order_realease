import{j as e,p as ee,b4 as M,u as $e,q as Le,r as i,b5 as De,b6 as ze,b7 as Fe,b8 as Me,X as F,b9 as Pe,ba as qe,bb as _e,y as Qe,bc as Ie,L as Ke,bd as Be}from"./vendor-react-DanJ59UG.js";import{f as Ee}from"./textFormatting-uD-tGOpv.js";import{C as se,S as l,m as ae,n as te,p as le,A as Ve,q as We,r as Oe,t as Ge,v as He,w as Xe,x as Ue,y as Je,z as Ye,a as Ze,u as es,I as ss,h as m,B as w,s as as}from"./index-Dac7evyM.js";import{P as re,a as ie,b as ne}from"./popover-BxYTEecG.js";import{u as ts,a as ls,b as rs,c as is}from"./useRestaurants-Fi2lJTpa.js";import{c as ns,o as os,g as cs}from"./geolocation-YPf7LJYy.js";import{u as ds,R as ms,l as us}from"./xiaoxiong-logo-clean-nXt_WRVS.js";import{u as xs}from"./useLocalizedContent-Brt5DvN3.js";import{f as hs}from"./timeUtils-pgRxO0UB.js";import{u as fs}from"./useActivities-CvQPw828.js";import{u as gs}from"./useInfiniteScroll-ZzA9__DI.js";import{L as ps}from"./LocationPermissionDialog-B_LVYQ_e.js";import{P as vs}from"./PullToRefresh-BUyE_PUK.js";import{T as js,a as Ns,b as E}from"./tabs-BYCQAXef.js";import"./vendor-i18n-jtdHZIRR.js";import"./vendor-editor-B1vH4T8i.js";import"./vendor-utils-vwQGbBim.js";import"./vendor-supabase-BVVOWwEK.js";import"./vendor-map-CvE3ASYw.js";import"./map-icon-DR07RZr_.js";const ws=({count:x=6})=>e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:x}).map((o,a)=>e.jsxs(se,{className:"overflow-hidden flex flex-col h-full",style:{animationDelay:`${a*100}ms`},children:[e.jsxs("div",{className:"relative h-48 overflow-hidden",children:[e.jsx(l,{className:"w-full h-full rounded-none"}),e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx(l,{className:"h-9 w-9 rounded-md"})})]}),e.jsx(ae,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(l,{className:"h-6 w-40"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(l,{className:"h-4 w-4 rounded-full"}),e.jsx(l,{className:"h-4 w-16"})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(l,{className:"h-5 w-5 rounded-full"}),e.jsx(l,{className:"h-5 w-8"})]})]})}),e.jsxs(te,{className:"space-y-3 flex-grow",children:[e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(l,{className:"h-5 w-16 rounded-full"}),e.jsx(l,{className:"h-5 w-20 rounded-full"}),e.jsx(l,{className:"h-5 w-14 rounded-full"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{className:"h-4 w-4 rounded-full flex-shrink-0"}),e.jsx(l,{className:"h-4 w-full"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{className:"h-4 w-4 rounded-full flex-shrink-0"}),e.jsx(l,{className:"h-4 w-32"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{className:"h-4 w-4 rounded-full flex-shrink-0"}),e.jsx(l,{className:"h-4 w-40"})]})]}),e.jsxs(le,{className:"gap-2 mt-auto",children:[e.jsx(l,{className:"h-10 flex-1 rounded-md"}),e.jsx(l,{className:"h-10 w-10 rounded-md"})]})]},a))}),bs=()=>e.jsxs("div",{className:"relative flex-1 min-h-[300px] sm:min-h-[400px] lg:mx-4 lg:mb-4 lg:rounded-lg overflow-hidden lg:shadow-lg bg-muted",children:[e.jsx(l,{className:"absolute inset-0 w-full h-full rounded-none"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:e.jsx(l,{className:"h-8 w-8 rounded-full"})}),e.jsx("div",{className:"absolute top-1/4 left-1/3",children:e.jsx(l,{className:"h-6 w-6 rounded-full"})}),e.jsx("div",{className:"absolute top-1/3 right-1/4",children:e.jsx(l,{className:"h-6 w-6 rounded-full"})}),e.jsx("div",{className:"absolute bottom-1/3 left-1/4",children:e.jsx(l,{className:"h-6 w-6 rounded-full"})}),e.jsx("div",{className:"absolute bottom-1/4 right-1/3",children:e.jsx(l,{className:"h-6 w-6 rounded-full"})})]})}),e.jsx("div",{className:"absolute bottom-4 left-4 z-10",children:e.jsx(l,{className:"h-10 w-36 rounded-full"})}),e.jsxs("div",{className:"absolute top-4 right-4 z-10 flex flex-col gap-2",children:[e.jsx(l,{className:"h-8 w-8 rounded-md"}),e.jsx(l,{className:"h-8 w-8 rounded-md"})]})]}),ys=()=>{const x=/iPad|iPhone|iPod/.test(navigator.userAgent),o=/Android/.test(navigator.userAgent);return x?"Apple Maps":"Google Maps"},ks=({open:x,onOpenChange:o,onConfirm:a,destinationName:h})=>{const{t:f}=ee(),R=ys();return e.jsx(Ve,{open:x,onOpenChange:o,children:e.jsxs(We,{className:"max-w-md",children:[e.jsxs(Oe,{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 rounded-full bg-primary/10",children:e.jsx(M,{className:"w-5 h-5 text-primary"})}),e.jsx(Ge,{children:f("navigation.confirmTitle")})]}),e.jsx(He,{className:"text-left",children:f("navigation.confirmDescription",{appName:R,destination:h})})]}),e.jsxs(Xe,{className:"flex-col sm:flex-row gap-2",children:[e.jsx(Ue,{className:"w-full sm:w-auto",children:f("common.cancel")}),e.jsx(Je,{onClick:a,className:"w-full sm:w-auto",children:f("navigation.openApp",{appName:R})})]})]})})},Cs=({restaurant:x,language:o})=>{const[a,h]=i.useState(999),f=i.useRef(null),j=x.type.map((r,d)=>({key:`type-${d}`,label:r,variant:"secondary",color:void 0}));i.useEffect(()=>{const r=()=>{if(!f.current)return;const C=f.current,n=Array.from(C.querySelectorAll(".tag-badge"));if(n.length===0){setTimeout(r,50);return}const T=n[0]?.offsetTop;let b=n.length;for(let g=0;g<n.length;g++)if(n[g].offsetTop>T){b=g;break}if(b===n.length){h(n.length);return}const y=C.offsetWidth,c=40;let $=0,N=b;for(let g=0;g<b;g++)$+=n[g].offsetWidth+8;$+c>y&&(N=Math.max(1,b-1)),h(N)};h(999);const d=setTimeout(r,100);return window.addEventListener("resize",r),()=>{clearTimeout(d),window.removeEventListener("resize",r)}},[j.length,x.id]);const A=j.slice(0,a),D=j.slice(a),k=D.length>0;return e.jsxs("div",{className:"flex items-center gap-2 -mt-1",children:[e.jsx("div",{ref:f,className:"flex gap-2 flex-wrap flex-1",children:A.map(r=>e.jsx(w,{variant:r.variant,className:"text-xs whitespace-nowrap tag-badge",style:r.color?{backgroundColor:r.color,color:"white"}:void 0,children:r.label},r.key))}),k&&e.jsxs(re,{children:[e.jsx(ie,{asChild:!0,children:e.jsx(m,{variant:"ghost",size:"sm",className:"h-6 px-2 text-muted-foreground hover:text-foreground flex-shrink-0",children:e.jsx(Be,{className:"h-4 w-4"})})}),e.jsx(ne,{className:"w-auto max-w-80",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:D.map(r=>e.jsx(w,{variant:r.variant,className:"text-xs",style:r.color?{backgroundColor:r.color,color:"white"}:void 0,children:r.label},r.key))})})]})]})},Os=()=>{const x=$e(),o=Le(),{t:a,i18n:h}=ee(),{toast:f}=Ye(),{localizeRestaurant:R}=xs(),j=Ze(),[A,D]=i.useState(""),[k,r]=i.useState("all"),[d,C]=i.useState([]),[n,T]=i.useState(null),[b,y]=i.useState([]),[c,$]=i.useState("list"),[N,g]=i.useState(()=>localStorage.getItem("restaurant-list-columns")==="1"?1:2),[u,P]=i.useState(null),[v,oe]=i.useState(null),[ce,de]=i.useState(!1),[q,me]=i.useState(!1),[_,ue]=i.useState(!1),[xe,Q]=i.useState(!1),[he,I]=i.useState(!1),[L,fe]=i.useState(null),{user:V}=es(),{data:W,isLoading:ge}=ts(A,d.length>0?d.join(","):void 0),{data:pe=[]}=ls(),{data:K=[]}=rs(),{data:ve=[]}=fs(),{data:je={}}=ds(),Ne=i.useCallback(async()=>{o.removeQueries({queryKey:["restaurants"]}),o.removeQueries({queryKey:["activities"]}),o.removeQueries({queryKey:["restaurantTypes"]}),o.removeQueries({queryKey:["favorites"]}),o.removeQueries({queryKey:["favorite-ids"]}),await Promise.all([o.invalidateQueries({queryKey:["restaurants"]}),o.invalidateQueries({queryKey:["activities"]}),o.invalidateQueries({queryKey:["restaurantTypes"]}),o.invalidateQueries({queryKey:["favorites"]}),o.invalidateQueries({queryKey:["favorite-ids"]})])},[o]),z=ve.filter(s=>(je[s.id]||0)>0),we=is(),be=(s,t)=>{t.preventDefault(),t.stopPropagation(),V&&we.mutate(s)},ye=s=>{C(t=>t.includes(s)?t.filter(p=>p!==s):[...t,s])},ke=()=>{I(!0)},O=async()=>{I(!1);try{const s=await cs();oe({lat:s.coords.latitude,lng:s.coords.longitude}),de(!0),f({title:a("restaurants.locationEnabled"),description:a("restaurants.sortByDistance")})}catch(s){console.error("Location error:",s)}},Ce=s=>{P(s),s&&!v&&O()},Te=async s=>{if(n===s)T(null),y([]);else{T(s);const{data:t,error:p}=await as.from("activity_restaurants").select("restaurant_id").eq("activity_id",s);p?(console.error("Error fetching activity restaurants:",p),y([])):y(t.map(B=>B.restaurant_id))}},G=W?.map(s=>{const t=R(s);if(v){const p=ns(v.lat,v.lng,s.lat,s.lng);return{...t,distance:p}}return t})||[],H=k==="all"?G:G.filter(s=>(s.template||"default")===k),X=n?H.filter(s=>b.includes(s.id)):H,U=u&&v?X.filter(s=>s.distance&&s.distance<=u):X,S=v?[...U].sort((s,t)=>(s.distance||0)-(t.distance||0)):[...U].sort((s,t)=>(t.rating||0)-(s.rating||0)),{displayedData:J,hasMore:Se,loadMore:Re,reset:Y}=gs({data:S,initialItemsPerPage:12,incrementPerPage:12});i.useEffect(()=>{Y()},[A,d,n,u,ce,k,Y]);const Ae=s=>{x(`/restaurant/${s.id}`)},Z=e.jsx("div",{className:`bg-secondary/20 animate-fade-in ${c==="map"?"h-screen flex flex-col overflow-hidden":"min-h-screen py-8 px-4"}`,children:e.jsxs("div",{className:`${c==="map"?"flex flex-col h-full":"container mx-auto max-w-7xl"}`,children:[e.jsxs("div",{className:`${c==="map"?"px-4 pt-4 pb-2 flex-shrink-0":"mb-8"}`,children:[e.jsx("h1",{className:`text-3xl sm:text-4xl font-medium text-primary ${c==="map"?"hidden md:block md:mb-4":"mb-4"}`,children:a("restaurants.title")}),e.jsx(js,{value:k,onValueChange:s=>r(s),className:"mb-4",children:e.jsxs(Ns,{className:"w-full sm:w-auto",children:[e.jsx(E,{value:"all",className:"flex-1 sm:flex-auto",children:a("restaurants.tabAll")}),e.jsx(E,{value:"default",className:"flex-1 sm:flex-auto",children:a("restaurants.tabPhysical")}),e.jsx(E,{value:"ghost",className:"flex-1 sm:flex-auto",children:a("restaurants.tabGhost")})]})}),e.jsx("div",{className:"flex flex-col gap-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:items-center",children:[e.jsx(ss,{placeholder:a("restaurants.search"),value:A,onChange:s=>D(s.target.value),className:"w-full md:max-w-md"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(m,{variant:v?"default":"outline",size:"sm",onClick:ke,className:"gap-1.5",children:[e.jsx(M,{className:"h-4 w-4"}),e.jsx("span",{children:a("restaurants.getLocation")})]}),e.jsxs("div",{className:"inline-flex h-9 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",children:[e.jsx("button",{onClick:()=>{if(c==="list"){if(j){const s=N===2?1:2;g(s),localStorage.setItem("restaurant-list-columns",String(s))}}else $("list")},title:c==="list"&&j?N===2?a("restaurants.singleColumn","单列布局"):a("restaurants.doubleColumn","双列布局"):a("restaurants.listView"),className:`inline-flex items-center justify-center whitespace-nowrap rounded-sm px-2.5 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 ${c==="list"?"bg-background text-foreground shadow-sm":""}`,children:c==="list"&&j&&N===1?e.jsx(De,{className:"h-3.5 w-3.5"}):e.jsx(ze,{className:"h-3.5 w-3.5"})}),e.jsx("button",{onClick:()=>$("map"),title:a("restaurants.mapView"),className:`inline-flex items-center justify-center whitespace-nowrap rounded-sm px-2.5 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 ${c==="map"?"bg-background text-foreground shadow-sm":""}`,children:e.jsx(Fe,{className:"h-3.5 w-3.5"})}),e.jsxs(re,{children:[e.jsx(ie,{asChild:!0,children:e.jsxs("button",{title:a("restaurants.filter"),className:`inline-flex items-center justify-center whitespace-nowrap rounded-sm px-2.5 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 relative ${d.length>0||n||u?"bg-background text-foreground shadow-sm":""}`,children:[e.jsx(Me,{className:"h-3.5 w-3.5"}),(d.length>0||n||u)&&e.jsx(w,{variant:"secondary",className:"absolute -top-1 -right-1 h-4 w-4 p-0 flex items-center justify-center text-[10px]",children:(d.length>0?1:0)+(n?1:0)+(u?1:0)})]})}),e.jsx(ne,{className:"w-[90vw] max-w-sm p-0",align:"start",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border/50 bg-muted/30",children:[e.jsx("span",{className:"font-semibold text-foreground text-base",children:a("restaurants.filter")}),(d.length>0||n||u)&&e.jsxs(m,{variant:"ghost",size:"sm",className:"h-7 px-2 text-xs text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>{C([]),T(null),y([]),P(null)},children:[e.jsx(F,{className:"w-3 h-3 mr-1"}),a("common.actions.clearFilter")]})]}),e.jsxs("div",{className:"p-4 space-y-5",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:a("restaurants.restaurantTypes")}),e.jsxs("div",{className:"flex items-center gap-2",children:[d.length>0&&e.jsxs(m,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>C([]),children:[e.jsx(F,{className:"w-3 h-3 mr-1"}),a("common.actions.clear")]}),K.length>8&&e.jsx(m,{variant:"link",size:"sm",className:"h-auto p-0 text-xs text-primary hover:text-primary/80",onClick:()=>me(!q),children:a(q?"common.showLess":"common.showMore")})]})]}),e.jsx("div",{className:"flex gap-2 flex-wrap max-h-36 overflow-y-auto pr-1",children:(q?K:K.slice(0,8)).map(s=>e.jsx(w,{variant:d.includes(s)?"default":"outline",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs font-normal whitespace-nowrap hover:bg-primary/10 ${d.includes(s)?"bg-primary text-primary-foreground shadow-sm":"bg-background hover:border-primary/50"}`,onClick:()=>ye(s),children:s},s))})]}),z.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:a("nav.activities")}),e.jsxs("div",{className:"flex items-center gap-2",children:[n&&e.jsxs(m,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>{T(null),y([])},children:[e.jsx(F,{className:"w-3 h-3 mr-1"}),a("common.actions.clear")]}),z.length>8&&e.jsx(m,{variant:"link",size:"sm",className:"h-auto p-0 text-xs text-primary hover:text-primary/80",onClick:()=>ue(!_),children:a(_?"common.showLess":"common.showMore")})]})]}),e.jsx("div",{className:"flex gap-2 flex-wrap max-h-36 overflow-y-auto pr-1",children:(_?z:z.slice(0,8)).map(s=>{const t=h.language==="zh"?s.badge_text_zh||s.title_zh:h.language==="pt"?s.badge_text_pt||s.title_pt:s.badge_text_en||s.title_en;return e.jsx(w,{variant:n===s.id?"default":"outline",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs font-normal whitespace-nowrap hover:bg-primary/10 ${n===s.id?"bg-primary text-primary-foreground shadow-sm":"bg-background hover:border-primary/50"}`,onClick:()=>Te(s.id),children:t},s.id)})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:a("restaurants.radius")}),u&&e.jsxs(m,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>P(null),children:[e.jsx(F,{className:"w-3 h-3 mr-1"}),a("common.actions.clear")]})]}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:[{value:null,label:a("restaurants.allRestaurants")},{value:5,label:a("restaurants.radius5km")},{value:10,label:a("restaurants.radius10km")},{value:20,label:a("restaurants.radius20km")}].map(s=>e.jsx(w,{variant:u===s.value?"default":"outline",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs font-normal whitespace-nowrap hover:bg-primary/10 ${u===s.value?"bg-primary text-primary-foreground shadow-sm":"bg-background hover:border-primary/50"}`,onClick:()=>Ce(s.value),children:s.label},s.value??"all"))})]})]})]})})]})]})]})]})})]}),ge||!W?c==="map"?e.jsx(bs,{}):e.jsx(ws,{count:6}):S.length===0?e.jsxs("div",{className:`text-center ${c==="map"?"flex-1 flex flex-col justify-center px-4":"py-20"}`,children:[e.jsx("p",{className:"text-xl text-muted-foreground",children:a("restaurants.noResults")}),e.jsx("p",{className:"text-muted-foreground mt-2",children:a("restaurants.noResultsDesc")})]}):e.jsxs(e.Fragment,{children:[c==="map"&&S.length>0&&e.jsxs("div",{className:"relative flex-1 min-h-[300px] sm:min-h-[400px] lg:mx-4 lg:mb-4 lg:rounded-lg overflow-hidden lg:shadow-lg",children:[e.jsx(ms,{restaurants:S,onRestaurantClick:Ae,userLocation:v,radiusFilter:u,showViewDetailsButton:!0}),e.jsxs("div",{className:"absolute bottom-4 left-4 z-10 pointer-events-none flex items-center gap-2 bg-background/80 backdrop-blur-sm px-3 py-2 rounded-full shadow-lg",children:[e.jsx("img",{src:us,alt:"Xiaoxiong Market Logo",className:"h-6 w-6 object-contain"}),e.jsx("span",{className:"text-sm font-semibold text-foreground whitespace-nowrap",children:h.language==="zh"?"小熊市场":"Xiaoxiong Market"})]})]}),c==="list"&&S.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`grid gap-6 ${N===1?"grid-cols-1":"grid-cols-2"} md:grid-cols-2 lg:grid-cols-3`,children:J.map(s=>{const t=j&&N===2;return e.jsxs(se,{className:`overflow-hidden hover:shadow-large transition-shadow flex flex-col h-full ${t?"gap-0":""}`,children:[e.jsxs("div",{className:`relative overflow-hidden ${t?"h-28":"h-48"}`,children:[e.jsx("img",{src:s.image_url||"https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=600&q=80",alt:s.name,className:"w-full h-full object-cover transition-transform hover:scale-105"}),V&&e.jsx(m,{size:"icon",variant:"secondary",className:`absolute ${t?"top-1.5 right-1.5 h-7 w-7":"top-3 right-3"}`,onClick:p=>be(s.id,p),children:e.jsx(Pe,{className:`${t?"w-3.5 h-3.5":"w-5 h-5"} ${pe.includes(s.id)?"fill-destructive text-destructive":""}`})})]}),e.jsx(ae,{className:t?"p-2 pb-1":"mb-px pb-[15px]",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:`flex flex-col ${t?"gap-0.5":"gap-2"}`,children:[e.jsx("h3",{className:`font-semibold text-card-foreground ${t?"text-sm line-clamp-2":"text-xl"}`,children:Ee(s.name)}),s.distance!==void 0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(M,{className:`text-primary ${t?"w-3 h-3":"w-4 h-4"}`}),e.jsxs("span",{className:`font-semibold text-foreground ${t?"text-xs":"text-sm"}`,children:[s.distance.toFixed(1)," km"]})]})]}),e.jsxs("div",{className:"flex items-center gap-0.5",children:[e.jsx(qe,{className:`${t?"w-3.5 h-3.5":"w-5 h-5"} ${s.rating?"fill-accent text-accent":"text-muted-foreground"}`}),s.rating?e.jsx("span",{className:`font-semibold text-card-foreground ${t?"text-xs":""}`,children:s.rating.toFixed(1)}):!t&&e.jsxs("span",{className:"text-xs text-muted-foreground text-center whitespace-nowrap",children:[a("restaurant.noRatingLine1"),e.jsx("br",{}),a("restaurant.noRatingLine2")]})]})]})}),e.jsxs(te,{className:`flex-grow ${t?"p-2 pt-0 space-y-1":"space-y-2"}`,children:[e.jsx("div",{className:`flex items-center flex-wrap ${t?"gap-1":"gap-2"}`,children:t?s.type.slice(0,2).map((p,B)=>e.jsx(w,{variant:"secondary",className:"text-xs px-1.5 py-0.5",children:p},`type-${B}`)):e.jsxs(e.Fragment,{children:[e.jsx(Cs,{restaurant:s,language:h.language}),s.template==="ghost"&&e.jsx(w,{variant:"outline",className:"text-xs",children:a("restaurants.ghostKitchen")})]})}),!t&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm",children:[e.jsx(_e,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:"line-clamp-1",children:s.address})]}),!t&&s.phone&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm",children:[e.jsx(Qe,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:s.phone})]}),!t&&s.opening_hours&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm",children:[e.jsx(Ie,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:hs(s.opening_hours)})]})]}),e.jsxs(le,{className:`mt-auto ${t?"p-2 pt-0":"gap-2"}`,children:[e.jsx(m,{asChild:!0,className:`flex-1 ${t?"h-7 text-xs":""}`,size:t?"sm":"default",children:e.jsx(Ke,{to:`/restaurant/${s.id}`,children:a("restaurants.viewDetails")})}),!t&&v&&e.jsx(m,{variant:"outline",size:"icon",onClick:()=>{fe({lat:s.lat,lng:s.lng,name:s.name}),Q(!0)},title:a("restaurants.directions"),children:e.jsx(M,{className:"w-4 h-4"})})]})]},s.id)})}),Se&&e.jsx("div",{className:"flex justify-center mt-8",children:e.jsxs(m,{onClick:Re,size:"lg",variant:"outline",children:[a("common.loadMore")," (",J.length," / ",S.length,")"]})})]})]}),e.jsx(ks,{open:xe,onOpenChange:Q,onConfirm:()=>{L&&os(L.lat,L.lng,L.name),Q(!1)},destinationName:L?.name||""}),e.jsx(ps,{open:he,onOpenChange:I,onConfirm:O})]})});return c==="list"?e.jsx(vs,{onRefresh:Ne,children:Z}):Z};export{Os as default};
//# sourceMappingURL=Restaurants-CR8UhcXU.js.map
