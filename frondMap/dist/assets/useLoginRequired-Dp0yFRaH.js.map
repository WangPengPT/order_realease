{"version":3,"file":"useLoginRequired-Dp0yFRaH.js","sources":["../../src/hooks/useLoginRequired.ts"],"sourcesContent":["import { useCallback } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { useAuth } from \"@/contexts/AuthContext\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { toast } from \"sonner\";\r\n\r\n/**\r\n * Hook that provides a guard function for actions requiring login.\r\n * Shows a toast with a login button if the user is not authenticated.\r\n * \r\n * Usage:\r\n *   const { requireLogin } = useLoginRequired();\r\n *   const handleLike = () => {\r\n *     if (!requireLogin()) return;\r\n *     // ... do the action\r\n *   };\r\n */\r\nexport const useLoginRequired = () => {\r\n  const { user } = useAuth();\r\n  const { t } = useTranslation();\r\n  const navigate = useNavigate();\r\n\r\n  const requireLogin = useCallback((): boolean => {\r\n    if (user) return true;\r\n\r\n    toast.error(t(\"activities.loginRequired\", \"需要登录\"), {\r\n      description: t(\"activities.loginRequiredMessage\", \"请先登录后再使用此功能\"),\r\n      action: {\r\n        label: t(\"activities.goToLogin\", \"去登录\"),\r\n        onClick: () => navigate(\"/auth\"),\r\n      },\r\n      duration: 4000,\r\n    });\r\n\r\n    return false;\r\n  }, [user, t, navigate]);\r\n\r\n  return { requireLogin, isLoggedIn: !!user };\r\n};\r\n"],"names":["useLoginRequired","user","useAuth","t","useTranslation","navigate","useNavigate","useCallback","toast"],"mappings":"4GAiBO,MAAMA,EAAmB,IAAM,CAC9B,KAAA,CAAE,KAAAC,GAASC,IACX,CAAE,EAAAC,GAAMC,IACRC,EAAWC,IAiBjB,MAAO,CAAE,aAfYC,EAAAA,YAAY,IAC3BN,EAAa,IAEjBO,EAAM,MAAML,EAAE,2BAA4B,MAAM,EAAG,CACjD,YAAaA,EAAE,kCAAmC,aAAa,EAC/D,OAAQ,CACN,MAAOA,EAAE,uBAAwB,KAAK,EACtC,QAAS,IAAME,EAAS,OAAO,CACjC,EACA,SAAU,GAAA,CACX,EAEM,IACN,CAACJ,EAAME,EAAGE,CAAQ,CAAC,EAEC,WAAY,CAAC,CAACJ,CAAK,CAC5C"}