import{p as ke,u as Oe,r,j as e,al as Nt,aL as Fe,aV as kt,aW as _t,aM as St,aX as Be,aY as Se,aZ as Ct,a_ as At,a$ as Lt,av as We,ax as He,b0 as Ce,b1 as qe,b2 as Rt,L as Qe,b3 as Tt,b4 as Le,b5 as Ze,b6 as Ge,b7 as et,b8 as Dt,b9 as Ue,ba as Et,q as It,bb as zt,bc as Mt,bd as $t}from"./vendor-react-Hsdnn-sD.js";import{a as Ve,u as Ot,b as tt,c as Vt,l as Pt,D as Ft,d as Bt,e as P,f as Wt,g as Ht,S as st,A as qt,h as Ut,i as Xt,o as at,j as Jt,I as Kt,B as se,k as B,C as Re,s as Yt,m as Qt,n as Ie,p as Zt,H as Gt,q as rt,r as ot,t as es}from"./index-DNQsNrYF.js";import{c as ts,g as ss,m as nt}from"./geolocation-DRm3QMsJ.js";import{a as as,g as rs}from"./app-store-badge-CyCtXXOt.js";import{u as it}from"./useHomepageTemplates-CxapBenW.js";import{u as os}from"./usePageView-DMkTcRKf.js";import{L as lt}from"./LocationPermissionDialog-BlorIIIX.js";import{E as ct}from"./ExternalLinkConfirmDialog-DKXR_iPv.js";import{P as ns}from"./PullToRefresh-CEVUE0a-.js";import{P as is,a as ls,b as cs}from"./popover-QyTsgTwL.js";import{u as ds,a as ms}from"./useRestaurants-CAoMVwdD.js";import{u as us,R as hs,l as xs}from"./xiaoxiong-logo-clean-CQFPbOkv.js";import{u as dt}from"./useLocalizedContent-D-CDxH29.js";import{u as mt}from"./useActivities-BHjirLn3.js";import{a as Xe,f as ze,K as ps,L as Je,M as gs,i as fs}from"./vendor-utils-Z4kpnli5.js";import"./vendor-i18n-jtdHZIRR.js";import"./vendor-editor-B1vH4T8i.js";import"./vendor-supabase-BVdpxhZP.js";import"./vendor-map-CvE3ASYw.js";const bs=()=>!!(window.webkit?.messageHandlers?.VoiceBridge||window.VoiceBridge),Ke={start:()=>{const s=JSON.stringify({action:"start"});window.webkit?.messageHandlers?.VoiceBridge?window.webkit.messageHandlers.VoiceBridge.postMessage(s):window.VoiceBridge&&window.VoiceBridge.postMessage(s)},stop:()=>{const s=JSON.stringify({action:"stop"});window.webkit?.messageHandlers?.VoiceBridge?window.webkit.messageHandlers.VoiceBridge.postMessage(s):window.VoiceBridge&&window.VoiceBridge.postMessage(s)}},Me="https://tzdgqhwyzsxkxnncgzap.supabase.co",Ne="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR6ZGdxaHd5enN4a3hubmNnemFwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM2NTg2ODgsImV4cCI6MjA3OTIzNDY4OH0.D76C4OkjQVWyMxtjjdOofpD8X_hEEoTtrXHqi4XSYUw",ws=["最近","附近","离我","距离","远近","近的","周边","周围","最近的","附近的","nearest","closest","nearby","near me","close to me","distance","around me","mais perto","próximo","perto de mim","distância","mais próximo"],vs=()=>{const s="xiaoxiong_anonymous_user_id";let a=localStorage.getItem(s);return a||(a=`anon_${Date.now()}_${Math.random().toString(36).substring(2,11)}`,localStorage.setItem(s,a)),a},ys=({open:s,onOpenChange:a,provider:l="ask-xiaoxiong"})=>{const{i18n:c}=ke(),n=Oe(),{settings:v}=Ve(),{user:x}=Ot(),g=tt(),{data:m}=Vt(),f=v?.logo_url||Pt,[y,p]=r.useState(""),[C,_]=r.useState([]),[A,L]=r.useState(!1),[M,$]=r.useState(null),[ae,W]=r.useState(!1),[H,O]=r.useState(null),[V,D]=r.useState(!1),[J,G]=r.useState(!1),[K,w]=r.useState(!1),[T,re]=r.useState(!1),[he,oe]=r.useState(null),F=r.useRef(null),ye=r.useRef(null),q=r.useRef(null),xe=r.useRef(null),pe=()=>{if(!J&&!K)return!1;const o=typeof window<"u"?window.innerWidth:1024,u=o>=768&&o<1024,i=o>=1024;return g?v?.voice_input_mobile!==!1:u?v?.voice_input_tablet!==!1:i?v?.voice_input_desktop!==!1:!0},ge=()=>x?.id?x.id:vs();r.useEffect(()=>{const o=window.SpeechRecognition||window.webkitSpeechRecognition;return G(!!o),w(bs()),window.onSpeechResult=u=>{p(u),D(!1)},()=>{window.onSpeechResult=void 0}},[]),r.useEffect(()=>{if(!s||!g)return;const o=window.scrollY,u=window.scrollX,i=document.body.style.overflow;document.body.style.overflow="hidden";const h=()=>{requestAnimationFrame(()=>{const d=window.visualViewport;if(d){const N=d.height,k=d.offsetTop||0;document.documentElement.style.setProperty("--visual-viewport-height",`${N}px`),document.documentElement.style.setProperty("--visual-viewport-offset-top",`${k}px`)}else document.documentElement.style.setProperty("--visual-viewport-height",`${window.innerHeight}px`),document.documentElement.style.setProperty("--visual-viewport-offset-top","0px")})};return h(),window.visualViewport?.addEventListener("resize",h),window.visualViewport?.addEventListener("scroll",h),window.addEventListener("resize",h),window.addEventListener("orientationchange",h),()=>{document.body.style.overflow=i,window.scrollTo(u,o),window.visualViewport?.removeEventListener("resize",h),window.visualViewport?.removeEventListener("scroll",h),window.removeEventListener("resize",h),window.removeEventListener("orientationchange",h),document.documentElement.style.removeProperty("--visual-viewport-height"),document.documentElement.style.removeProperty("--visual-viewport-offset-top")}},[s,g]),r.useEffect(()=>{s&&!M&&navigator.geolocation?.getCurrentPosition(o=>{$({lat:o.coords.latitude,lng:o.coords.longitude})},o=>{console.log("Unable to get user location:",o.message)},{enableHighAccuracy:!1,timeout:5e3,maximumAge:3e5})},[s,M]),r.useEffect(()=>{!s&&q.current&&(q.current.stop(),D(!1))},[s]),r.useEffect(()=>{xe.current?.scrollIntoView({behavior:"smooth"})},[C]);const fe=async(o,u)=>{const i=await fetch(`${Me}/functions/v1/ask-xiaoxiong`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Ne}`,apikey:Ne},body:JSON.stringify({text:o.content,stream:!0,lat:M?.lat,lng:M?.lng}),signal:F.current?.signal});if(!i.ok)throw new Error(`Request failed with status: ${i.status}`);if(!i.body)throw new Error("No response body");const h=i.body.getReader(),d=new TextDecoder;let N="";for(;;){const{done:S,value:I}=await h.read();if(S)break;const ve=d.decode(I,{stream:!0});N+=ve;let z=N;z.startsWith('"')&&(z=z.slice(1)),z.endsWith('"')&&(z=z.slice(0,-1)),z=z.replace(/\\n/g,`
`),_(te=>te.map(Z=>Z.id===u?{...Z,content:z}:Z))}let k=N;k.startsWith('"')&&(k=k.slice(1)),k.endsWith('"')&&(k=k.slice(0,-1)),k=k.replace(/\\n/g,`
`),_(S=>S.map(I=>I.id===u?{...I,content:k,isStreaming:!1}:I))},j=async(o,u)=>{const i=ge(),h=Date.now();console.log(`[前端-Agent] ⏱️ 开始发送请求: ${new Date().toISOString()}`);const d=await fetch(`${Me}/functions/v1/xiaoxiong-agent`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Ne}`,apikey:Ne},body:JSON.stringify({message:o.content,userId:i}),signal:F.current?.signal}),N=Date.now()-h;if(console.log(`[前端-Agent] ⏱️ 收到响应头: ${new Date().toISOString()}, 耗时: ${N}ms`),!d.ok)throw new Error(`Request failed with status: ${d.status}`);if(!d.body)throw new Error("No response body");const k=d.body.getReader(),S=new TextDecoder;let I="",ve=!1,z=0;for(;;){const{done:te,value:Z}=await k.read();if(te){console.log(`[前端-Agent] ⏱️ 流结束: ${new Date().toISOString()}, 总耗时: ${Date.now()-h}ms, 共 ${z} 个数据块`);break}z++;const ee=S.decode(Z,{stream:!0});if(I+=ee,!ve){ve=!0;const ue=Date.now()-h;console.log(`[前端-Agent] ⏱️ 首个数据块 (TTFB): ${new Date().toISOString()}, 耗时: ${ue}ms, 大小: ${ee.length} 字符`)}Be.flushSync(()=>{_(ue=>ue.map(_e=>_e.id===u?{..._e,content:I}:_e))}),await new Promise(ue=>requestAnimationFrame(ue))}_(te=>te.map(Z=>Z.id===u?{...Z,isStreaming:!1}:Z))},E=async(o,u)=>{const i=Date.now();console.log(`[前端-LovableAI] ⏱️ 开始发送请求: ${new Date().toISOString()}`);const h=await fetch(`${Me}/functions/v1/lovable-chat`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Ne}`,apikey:Ne},body:JSON.stringify({message:o.content,lat:M?.lat,lng:M?.lng,language:c.language}),signal:F.current?.signal}),d=Date.now()-i;if(console.log(`[前端-LovableAI] ⏱️ 收到响应头: ${new Date().toISOString()}, 耗时: ${d}ms`),!h.ok){const z=await h.json().catch(()=>({}));throw new Error(z.error||`Request failed with status: ${h.status}`)}if(!h.body)throw new Error("No response body");const N=h.body.getReader(),k=new TextDecoder;let S="",I="",ve=!1;for(;;){const{done:z,value:te}=await N.read();if(z){console.log(`[前端-LovableAI] ⏱️ 流结束: ${new Date().toISOString()}, 总耗时: ${Date.now()-i}ms`);break}if(I+=k.decode(te,{stream:!0}),!ve){ve=!0;const ee=Date.now()-i;console.log(`[前端-LovableAI] ⏱️ 首个数据块 (TTFB): ${new Date().toISOString()}, 耗时: ${ee}ms`)}let Z;for(;(Z=I.indexOf(`
`))!==-1;){let ee=I.slice(0,Z);if(I=I.slice(Z+1),ee.endsWith("\r")&&(ee=ee.slice(0,-1)),ee.startsWith(":")||ee.trim()===""||!ee.startsWith("data: "))continue;const ue=ee.slice(6).trim();if(ue==="[DONE]")break;try{const Pe=JSON.parse(ue).choices?.[0]?.delta?.content;Pe&&(S+=Pe,Be.flushSync(()=>{_(De=>De.map(Ee=>Ee.id===u?{...Ee,content:S}:Ee))}),await new Promise(De=>requestAnimationFrame(De)))}catch{}}}_(z=>z.map(te=>te.id===u?{...te,isStreaming:!1}:te))},Y=o=>{const u=o.toLowerCase();return ws.some(i=>u.includes(i))},R=async o=>{const u={id:Date.now().toString(),role:"user",content:o},i=(Date.now()+1).toString(),h={id:i,role:"assistant",content:"",isStreaming:!0};_(d=>[...d,u,h]),p(""),L(!0),F.current&&F.current.abort(),F.current=new AbortController;try{l==="lovable-ai"?await E(u,i):l==="xiaoxiong-agent"?await j(u,i):await fe(u,i)}catch(d){if(d instanceof Error&&d.name==="AbortError"){console.log("Request aborted");return}console.error("Ask API error:",d);const N=c.language==="zh"?"抱歉，暂时无法获取结果，请稍后再试":c.language==="pt"?"Desculpe, não foi possível obter resultados. Tente novamente mais tarde.":"Sorry, unable to get results. Please try again later.";_(k=>k.map(S=>S.id===i?{...S,content:N,isStreaming:!1}:S))}finally{L(!1)}},be=()=>{W(!1),navigator.geolocation?.getCurrentPosition(o=>{$({lat:o.coords.latitude,lng:o.coords.longitude}),H&&setTimeout(()=>{R(H),O(null)},100)},o=>{console.log("Location permission denied:",o.message),H&&(R(H),O(null))},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},ne=async()=>{if(!y.trim()||A)return;const o=y.trim();if(!M&&Y(o)){O(o),W(!0),p("");return}await R(o)},we=o=>{o.key==="Enter"&&!o.shiftKey&&(o.preventDefault(),ne())},ie=()=>{if(K){Ke.start(),D(!0);return}const o=window.SpeechRecognition||window.webkitSpeechRecognition;if(!o){console.log("Speech recognition not supported");return}q.current&&q.current.stop();const u=new o;q.current=u;const i={zh:"zh-CN",en:"en-US",pt:"pt-BR"};u.lang=i[c.language]||"zh-CN",u.continuous=!1,u.interimResults=!0,u.onstart=()=>{D(!0)},u.onresult=h=>{const d=Array.from(h.results).map(N=>N[0].transcript).join("");p(d)},u.onerror=h=>{console.log("Speech recognition error:",h.error),D(!1)},u.onend=()=>{D(!1)},u.start()},je=()=>{if(K){Ke.stop(),D(!1);return}q.current&&(q.current.stop(),D(!1))},ce=()=>{V?je():ie()},de=()=>{F.current&&F.current.abort(),a(!1)},Q=o=>{de(),n(o)},me=o=>{oe(o),re(!0)},le=()=>{he&&at(he),re(!1),oe(null)},U=o=>{const u=/\[([^\]]+)\]\(([^)]+)\)/g,i=[];let h=0,d,N=0;for(;(d=u.exec(o))!==null;){d.index>h&&i.push(e.jsx("span",{children:o.slice(h,d.index)},N++));const k=d[1],S=d[2];if(S.startsWith("/"))i.push(e.jsx("button",{onClick:()=>Q(S),className:"text-primary hover:underline font-medium cursor-pointer",children:k},N++));else if(S.startsWith("!external:")){const I=S.slice(10);i.push(e.jsx("button",{onClick:()=>me(I),className:"text-primary hover:underline font-medium cursor-pointer",children:k},N++))}else S.startsWith("http://")||S.startsWith("https://")?i.push(e.jsx("button",{onClick:()=>me(S),className:"text-primary hover:underline font-medium cursor-pointer",children:k},N++)):i.push(e.jsx("a",{href:S,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline font-medium",children:k},N++));h=d.index+d[0].length}return h<o.length&&i.push(e.jsx("span",{children:o.slice(h)},N++)),i.length>0?i:[e.jsx("span",{children:o},"0")]},t=o=>o.replace(/\*\*(.*?)\*\*/g,"$1"),b=(o,u=20)=>o.length<=u?o:o.slice(0,u)+"...",X=(o,u)=>{const i=N=>N.split("|").slice(1,-1).map(k=>t(k.trim())),h=i(o[0]),d=o.slice(2).map(i);return e.jsx("div",{className:"overflow-x-auto my-2 max-w-full",children:e.jsxs("table",{className:"w-full text-xs border border-border rounded-md overflow-hidden table-fixed",children:[e.jsx("thead",{className:"bg-muted/60",children:e.jsx("tr",{children:h.map((N,k)=>e.jsx("th",{className:"px-2 py-2 text-left font-semibold border-b border-border truncate max-w-[100px]",title:N,children:U(b(N,15))},k))})}),e.jsx("tbody",{children:d.map((N,k)=>e.jsx("tr",{className:"border-b border-border last:border-0 hover:bg-muted/30 transition-colors",children:N.map((S,I)=>e.jsx("td",{className:"px-2 py-2 truncate max-w-[100px]",title:S,children:U(b(S,18))},I))},k))})]})},u)},Te=o=>{const u=o.split(`
`),i=[];let h=0;for(;h<u.length;){const d=u[h];if(d.trim().startsWith("|")&&d.split("|").length>2){const N=[];for(;h<u.length&&u[h].trim().startsWith("|");)N.push(u[h]),h++;N.length>=2&&i.push(X(N,i.length));continue}if(d.startsWith("### "))i.push(e.jsx("h3",{className:"text-base font-semibold mt-3 mb-1",children:U(d.slice(4))},i.length));else if(d.startsWith("## "))i.push(e.jsx("h2",{className:"text-lg font-bold mt-4 mb-2",children:U(d.slice(3))},i.length));else if(d.startsWith("# "))i.push(e.jsx("h1",{className:"text-xl font-bold mt-4 mb-2",children:U(d.slice(2))},i.length));else if(d.includes("**")){const N=d.split(/\*\*(.*?)\*\*/g);i.push(e.jsx("p",{className:"mb-1 leading-relaxed",children:N.map((k,S)=>S%2===1?e.jsx("strong",{className:"font-semibold",children:U(k)},S):U(k))},i.length))}else d.startsWith("- ")||d.startsWith("* ")?i.push(e.jsx("li",{className:"ml-4 mb-0.5 list-disc",children:U(d.slice(2))},i.length)):/^\d+\.\s/.test(d)?i.push(e.jsx("li",{className:"ml-4 mb-0.5 list-decimal",children:U(d.replace(/^\d+\.\s/,""))},i.length)):d.match(/^[-*_]{3,}$/)?i.push(e.jsx("hr",{className:"my-3 border-border"},i.length)):d.trim()===""?i.push(e.jsx("div",{className:"h-1"},i.length)):i.push(e.jsx("p",{className:"mb-1 leading-relaxed",children:U(d)},i.length));h++}return i},vt=()=>c.language==="zh"?"小熊AI助手":c.language==="pt"?"Assistente IA Xiaoxiong":"Xiaoxiong AI Assistant",yt=()=>c.language==="zh"?"告诉小熊，你想吃什么...":c.language==="pt"?"Diga ao Xiaoxiong o que você quer comer...":"Tell Xiaoxiong what you want to eat...",jt=()=>c.language==="zh"?"你好，我是小熊，我来帮你推荐餐厅；比如：「我附近的寿司餐厅」":c.language==="pt"?"Olá, eu sou o Xiaoxiong, vou te ajudar a encontrar restaurantes; por exemplo: 「restaurantes de sushi perto de mim」":`Hi, I'm Xiaoxiong, I'll help you find restaurants; for example: "sushi restaurants near me"`;return e.jsx(Ft,{open:s,onOpenChange:de,children:e.jsx(Bt,{className:P("flex flex-col p-0 gap-0 overflow-hidden bg-background",g?"fixed inset-0 w-full max-w-full rounded-none":"sm:max-w-lg sm:h-[70vh] sm:max-h-[70vh] sm:rounded-lg"),style:g?{transform:"none",top:0,left:0,right:0,bottom:0,height:"100%",maxHeight:"100%"}:void 0,children:e.jsxs("div",{className:"flex flex-col flex-1 min-h-0",style:g?{height:"var(--visual-viewport-height, 100%)",maxHeight:"var(--visual-viewport-height, 100%)",marginTop:"var(--visual-viewport-offset-top, 0px)",transition:"height 0.15s ease-out, margin-top 0.15s ease-out"}:void 0,children:[e.jsx(Wt,{className:"px-4 py-3 shrink-0 bg-white/60 dark:bg-gray-900/60 backdrop-blur-md border-b border-white/30 dark:border-white/20 shadow-[0_1px_3px_rgba(0,0,0,0.05)]",children:e.jsxs(Ht,{className:"flex items-center gap-3 text-base font-semibold",children:[e.jsx("div",{className:"w-11 h-11 rounded-full bg-white dark:bg-gray-800 flex items-center justify-center overflow-hidden shadow-sm border border-white/50 dark:border-white/30",children:e.jsx("img",{src:f,alt:"Logo",className:"w-8 h-8 object-contain"})}),e.jsx("span",{className:"text-foreground",children:vt()})]})}),e.jsx(st,{className:"flex-1 min-h-0 overflow-hidden",ref:ye,children:e.jsxs("div",{className:"p-4 space-y-4",children:[C.length===0&&e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center shrink-0",children:e.jsx("img",{src:f,alt:"AI",className:"w-5 h-5 object-contain"})}),e.jsx("div",{className:"flex-1 bg-muted/50 rounded-2xl rounded-tl-sm px-4 py-3 text-sm",children:jt()})]}),C.map(o=>e.jsxs("div",{className:P("flex gap-3",o.role==="user"&&"flex-row-reverse"),children:[o.role==="user"?e.jsxs(qt,{className:"w-8 h-8 shrink-0",children:[m?.avatar_url?e.jsx(Ut,{src:m.avatar_url,alt:"User avatar"}):null,e.jsx(Xt,{className:"bg-secondary/50 text-foreground",children:e.jsx(Nt,{className:"h-4 w-4"})})]}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center shrink-0",children:e.jsx("img",{src:f,alt:"AI",className:"w-7 h-7 object-contain"})}),e.jsx("div",{className:P("flex-1 max-w-[85%] rounded-2xl px-4 py-3 text-sm",o.role==="user"?"bg-secondary/50 text-foreground rounded-tr-sm border border-border/50":"bg-muted/50 rounded-tl-sm"),children:o.role==="assistant"?e.jsxs(e.Fragment,{children:[o.content?e.jsx("div",{className:"prose-sm",children:Te(o.content)}):e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Fe,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:c.language==="zh"?"思考中...":c.language==="pt"?"Pensando...":"Thinking..."})]}),o.isStreaming&&o.content&&e.jsx("span",{className:"inline-block w-1.5 h-4 bg-primary/50 animate-pulse ml-0.5 align-middle"})]}):o.content})]},o.id)),e.jsx("div",{ref:xe})]})}),e.jsx("div",{className:"p-4 pb-[max(1rem,env(safe-area-inset-bottom))] bg-background shrink-0",children:e.jsxs("div",{className:"group flex items-center gap-3 bg-secondary/50 backdrop-blur-sm px-5 py-3.5 rounded-full shadow-sm hover:shadow-md hover:bg-secondary/70 transition-all duration-300 border border-border/50",children:[pe()&&e.jsx("button",{onClick:ce,disabled:A,className:P("shrink-0 transition-all duration-200",V&&"text-destructive animate-pulse"),title:c.language==="zh"?V?"停止录音":"语音输入":c.language==="pt"?V?"Parar gravação":"Entrada de voz":V?"Stop recording":"Voice input",children:V?e.jsx(kt,{className:"h-5 w-5"}):e.jsx(_t,{className:"h-5 w-5 text-muted-foreground group-hover:text-foreground transition-colors"})}),e.jsx("input",{value:y,onChange:o=>p(o.target.value),onKeyDown:we,placeholder:V?c.language==="zh"?"正在聆听...":c.language==="pt"?"Ouvindo...":"Listening...":yt(),disabled:A,className:"flex-1 bg-transparent border-0 outline-none text-sm text-foreground placeholder:text-muted-foreground group-hover:placeholder:text-foreground/60 transition-colors",autoFocus:!0}),e.jsx("button",{onClick:ne,disabled:!y.trim()||A,className:P("shrink-0 transition-all duration-200",y.trim()&&!A?"text-primary hover:text-primary/80":"text-muted-foreground/60"),children:A?e.jsx(Fe,{className:"h-5 w-5 animate-spin"}):e.jsx(St,{className:"h-5 w-5"})})]})}),e.jsx(lt,{open:ae,onOpenChange:o=>{W(o),!o&&H&&(R(H),O(null))},onConfirm:be}),e.jsx(ct,{open:T,onOpenChange:re,onConfirm:le,url:he||void 0})]})})})},Ye=({restaurant:s,language:a})=>{const[l,c]=r.useState(999),n=r.useRef(null),v=s.type.slice(0,3).map((m,f)=>({key:`type-${f}`,label:m,variant:"secondary",color:void 0}));r.useEffect(()=>{const m=()=>{if(!n.current)return;const y=n.current,p=Array.from(y.querySelectorAll(".tag-badge"));if(p.length===0){setTimeout(m,50);return}const C=p[0]?.offsetTop;let _=p.length;for(let A=0;A<p.length;A++)if(p[A].offsetTop>C){_=A;break}_<p.length&&(_=Math.max(1,_-1)),c(_)};c(999);const f=setTimeout(m,100);return window.addEventListener("resize",m),()=>{clearTimeout(f),window.removeEventListener("resize",m)}},[v.length,s.id]);const x=v.slice(0,l),g=v.length>l;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{ref:n,className:"flex gap-1.5 flex-wrap flex-1",children:x.map(m=>e.jsx(B,{variant:m.variant,className:"text-xs font-medium whitespace-nowrap tag-badge",style:m.color?{backgroundColor:m.color,color:"white"}:void 0,children:m.label},m.key))}),g&&e.jsxs(is,{children:[e.jsx(ls,{asChild:!0,children:e.jsx(se,{variant:"ghost",size:"sm",className:"h-6 px-2 text-muted-foreground hover:text-foreground flex-shrink-0",children:e.jsx(Rt,{className:"h-4 w-4"})})}),e.jsx(cs,{className:"w-80",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:v.map(m=>e.jsx(B,{variant:m.variant,className:"text-xs font-medium",style:m.color?{backgroundColor:m.color,color:"white"}:void 0,children:m.label},m.key))})})]})]})},js=()=>{const s=Oe(),{t:a,i18n:l}=ke(),{toast:c}=Jt(),{localizeRestaurant:n}=dt(),[v,x]=r.useState(""),[g,m]=r.useState([]),[f,y]=r.useState(null),[p,C]=r.useState([]),[_,A]=r.useState(null),[L,M]=r.useState(null),[$,ae]=r.useState(!1),[W,H]=r.useState(!1),[O,V]=r.useState(!1),D=r.useRef(null),J=r.useRef(null),G=r.useRef({}),[K,w]=r.useState(null),[T,re]=r.useState(!1),[he,oe]=r.useState(!1),[F,ye]=r.useState(!1),[q,xe]=r.useState(!1),pe=4,{data:ge,isLoading:fe}=ds(v,g.length>0?g.join(","):void 0),{data:j=[]}=ms(),{data:E=[]}=mt(),{data:Y={}}=us(),R=E.filter(t=>(Y[t.id]||0)>0),be=t=>{m(b=>b.includes(t)?b.filter(X=>X!==t):[...b,t])},ne=()=>{oe(!0)},we=async()=>{oe(!1);try{const t=await ss();M({lat:t.coords.latitude,lng:t.coords.longitude}),c({title:a("restaurants.locationEnabled"),description:a("restaurants.sortByDistance")})}catch(t){console.error("Location error:",t)}},ie=t=>{A(t),t&&!L&&ne()},je=async t=>{if(f===t)y(null),C([]);else{y(t);const{data:b,error:X}=await Yt.from("activity_restaurants").select("restaurant_id").eq("activity_id",t);X?(console.error("Error fetching activity restaurants:",X),C([])):C(b.map(Te=>Te.restaurant_id))}},ce=ge?.map(t=>{const b=n(t);if(L){const X=ts(L.lat,L.lng,t.lat,t.lng);return{...b,distance:X}}return b})||[],de=f?ce.filter(t=>p.includes(t.id)):ce,Q=_&&L?de.filter(t=>t.distance&&t.distance<=_).sort((t,b)=>(t.distance||0)-(b.distance||0)):L?de.sort((t,b)=>(t.distance||0)-(b.distance||0)):de.sort((t,b)=>(b.rating||0)-(t.rating||0)),me=t=>{s(`/restaurant/${t.id}`)},le=t=>{w(t.id);const b=G.current[t.id];b&&b.scrollIntoView({behavior:"smooth",block:"center"})},U=()=>{const t=document.getElementById("home-map-container");if(t)if($)document.exitFullscreen&&document.exitFullscreen();else{if(D.current){const b=D.current.getCenter(),X=D.current.getZoom();J.current={center:[b.lng,b.lat],zoom:X}}t.requestFullscreen&&t.requestFullscreen()}};return r.useEffect(()=>{const t=()=>{const b=!!document.fullscreenElement;ae(b),!b&&J.current&&D.current&&setTimeout(()=>{D.current?.jumpTo({center:J.current.center,zoom:J.current.zoom})},100)};return document.addEventListener("fullscreenchange",t),()=>{document.removeEventListener("fullscreenchange",t)}},[]),e.jsxs("div",{className:"animate-fade-in",children:[e.jsxs("div",{className:"text-left mb-6",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-foreground mb-2 sm:mb-3",children:a("nav.mapView")}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:a("map.subtitle")})]}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[e.jsx("div",{className:"flex-1 max-w-md",children:e.jsx(Kt,{placeholder:a("restaurants.search"),value:v,onChange:t=>x(t.target.value),className:"h-11 bg-background/60 backdrop-blur-sm border-primary/20 focus:border-primary"})}),e.jsxs("div",{className:"flex gap-2 md:contents",children:[e.jsxs(se,{variant:L?"default":"outline",onClick:L?void 0:ne,className:"flex-1 md:flex-initial gap-2 h-11 md:px-6",children:[e.jsx(Se,{className:`w-4 h-4 ${L?"animate-pulse":""}`}),e.jsx("span",{className:"md:hidden",children:a("restaurants.getLocationMobile")}),e.jsx("span",{className:"hidden md:inline",children:a(L?"restaurants.locationEnabled":"restaurants.getLocation")})]}),e.jsxs(se,{variant:T?"default":"outline",onClick:()=>re(!T),className:"flex-1 md:flex-initial gap-2 h-11 md:px-6",children:[e.jsx(Ct,{className:"w-4 h-4"}),a("restaurants.filter")]})]})]}),T&&e.jsxs("div",{className:"space-y-3 bg-card/50 backdrop-blur-sm rounded-lg p-4 border border-border/50 animate-fade-in",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("span",{className:"text-sm font-semibold text-foreground",children:[a("restaurants.restaurantTypes"),":"]}),g.length>0&&e.jsx(B,{variant:"outline",className:"cursor-pointer hover:bg-destructive hover:text-destructive-foreground hover:scale-105 transition-all duration-200 px-2 py-0 text-xs h-5",onClick:()=>m([]),children:a("common.actions.clearFilter")}),j.length>8&&e.jsx(se,{variant:"ghost",size:"sm",className:"h-5 px-2 text-xs text-primary hover:text-primary/80 ml-auto hidden sm:flex transition-all duration-200",onClick:()=>H(!W),children:a(W?"common.showLess":"common.showMore")})]}),e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx("div",{className:`hidden sm:flex gap-2 flex-wrap transition-all duration-300 ease-out ${W?"animate-expand-height":""}`,children:(W?j:j.slice(0,8)).map((t,b)=>e.jsx(B,{variant:g.includes(t)?"default":"secondary",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs whitespace-nowrap hover:scale-105 active:animate-tag-select ${g.includes(t)?"ring-2 ring-primary/30 shadow-sm":""}`,style:{animationDelay:`${b*30}ms`},onClick:()=>be(t),children:t},t))}),e.jsxs("div",{className:"sm:hidden relative -mx-1 px-1",children:[e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide snap-x snap-mandatory scroll-smooth",children:j.map((t,b)=>e.jsx(B,{variant:g.includes(t)?"default":"secondary",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs whitespace-nowrap flex-shrink-0 snap-start hover:scale-105 active:animate-tag-select ${g.includes(t)?"ring-2 ring-primary/30 shadow-sm":""}`,style:{animationDelay:`${b*30}ms`},onClick:()=>be(t),children:t},t))}),e.jsx("div",{className:"absolute left-0 top-0 bottom-2 w-4 bg-gradient-to-r from-card via-card/60 to-transparent pointer-events-none"}),e.jsx("div",{className:"absolute right-0 top-0 bottom-2 w-4 bg-gradient-to-l from-card via-card/60 to-transparent pointer-events-none"})]})]})]}),R.length>0&&e.jsxs("div",{className:"space-y-2 pt-1 border-t border-border/30",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("span",{className:"text-sm font-semibold text-foreground",children:[a("nav.activities"),":"]}),f&&e.jsx(B,{variant:"outline",className:"cursor-pointer hover:bg-destructive hover:text-destructive-foreground hover:scale-105 transition-all duration-200 px-2 py-0 text-xs h-5",onClick:()=>{y(null),C([])},children:a("common.actions.clearFilter")}),R.length>8&&e.jsx(se,{variant:"ghost",size:"sm",className:"h-5 px-2 text-xs text-primary hover:text-primary/80 ml-auto hidden sm:flex transition-all duration-200",onClick:()=>V(!O),children:a(O?"common.showLess":"common.showMore")})]}),e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx("div",{className:`hidden sm:flex gap-2 flex-wrap transition-all duration-300 ease-out ${O?"animate-expand-height":""}`,children:(O?R:R.slice(0,8)).map((t,b)=>{const X=l.language==="zh"?t.badge_text_zh||t.title_zh:l.language==="pt"?t.badge_text_pt||t.title_pt:t.badge_text_en||t.title_en;return e.jsx(B,{variant:f===t.id?"default":"secondary",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs whitespace-nowrap hover:scale-105 active:animate-tag-select ${f===t.id?"ring-2 ring-primary/30 shadow-sm":""}`,style:{animationDelay:`${b*30}ms`},onClick:()=>je(t.id),children:X},t.id)})}),e.jsxs("div",{className:"sm:hidden relative -mx-1 px-1",children:[e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide snap-x snap-mandatory scroll-smooth",children:R.map((t,b)=>{const X=l.language==="zh"?t.badge_text_zh||t.title_zh:l.language==="pt"?t.badge_text_pt||t.title_pt:t.badge_text_en||t.title_en;return e.jsx(B,{variant:f===t.id?"default":"secondary",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs whitespace-nowrap flex-shrink-0 snap-start hover:scale-105 active:animate-tag-select ${f===t.id?"ring-2 ring-primary/30 shadow-sm":""}`,style:{animationDelay:`${b*30}ms`},onClick:()=>je(t.id),children:X},t.id)})}),e.jsx("div",{className:"absolute left-0 top-0 bottom-2 w-4 bg-gradient-to-r from-card via-card/60 to-transparent pointer-events-none"}),e.jsx("div",{className:"absolute right-0 top-0 bottom-2 w-4 bg-gradient-to-l from-card via-card/60 to-transparent pointer-events-none"})]})]})]})]}),L&&e.jsxs("div",{className:"flex gap-2 flex-wrap items-center bg-muted/30 backdrop-blur-sm rounded-lg p-3 border border-primary/10",children:[e.jsxs("span",{className:"text-sm font-semibold text-primary",children:[a("restaurants.radius"),":"]}),e.jsx(B,{variant:_===null?"default":"secondary",className:"cursor-pointer hover:scale-105 transition-transform",onClick:()=>ie(null),children:a("restaurants.allRestaurants")}),e.jsx(B,{variant:_===5?"default":"secondary",className:"cursor-pointer hover:scale-105 transition-transform",onClick:()=>ie(5),children:a("restaurants.radius5km")}),e.jsx(B,{variant:_===10?"default":"secondary",className:"cursor-pointer hover:scale-105 transition-transform",onClick:()=>ie(10),children:a("restaurants.radius10km")}),e.jsx(B,{variant:_===20?"default":"secondary",className:"cursor-pointer hover:scale-105 transition-transform",onClick:()=>ie(20),children:a("restaurants.radius20km")})]})]}),!fe&&Q&&e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[e.jsx("div",{className:`w-full lg:flex-1 transition-all duration-300 ease-in-out ${F?"h-0 overflow-hidden lg:h-[500px]":"h-[400px] lg:h-[500px]"}`,children:e.jsxs("div",{id:"home-map-container",className:`${$?"fixed inset-0 z-50 bg-background":"w-full h-full"} rounded-xl overflow-hidden shadow-2xl border border-primary/10 relative group`,children:[e.jsx(se,{variant:"secondary",size:"icon",className:"absolute bottom-4 right-4 z-10 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity",onClick:U,children:$?e.jsx(At,{className:"w-5 h-5"}):e.jsx(Lt,{className:"w-5 h-5"})}),e.jsxs("div",{className:"h-full relative",children:[e.jsx(hs,{restaurants:Q,onRestaurantClick:me,userLocation:L,radiusFilter:_,onMarkerClick:le,showViewDetailsButton:!0,onMapInit:t=>{D.current=t}}),e.jsxs("div",{className:"absolute bottom-4 left-4 z-10 pointer-events-none flex items-center gap-2 bg-background/80 backdrop-blur-sm px-3 py-2 rounded-full shadow-lg",children:[e.jsx("img",{src:xs,alt:"Xiaoxiong Market Logo",className:"h-6 w-6 object-contain"}),e.jsx("span",{className:"text-sm font-semibold text-foreground whitespace-nowrap",children:l.language==="zh"?"小熊市场":"Xiaoxiong Market"})]})]})]})}),e.jsx(se,{variant:"outline",size:"sm",className:"lg:hidden flex items-center justify-center gap-2 -mt-3 mb-1",onClick:()=>ye(!F),children:F?e.jsxs(e.Fragment,{children:[e.jsx(We,{className:"w-4 h-4"}),a("map.showMap")]}):e.jsxs(e.Fragment,{children:[e.jsx(He,{className:"w-4 h-4"}),a("map.hideMap")]})}),e.jsxs("div",{className:"w-full lg:w-[420px] flex flex-col",children:[e.jsxs("div",{className:"mb-4 pb-4 border-b border-border",children:[e.jsxs("h2",{className:"text-xl sm:text-2xl font-bold text-foreground flex items-center gap-2",children:[e.jsx(Ce,{className:"w-6 h-6 text-primary"}),a("restaurants.title"),e.jsx(B,{variant:"secondary",className:"ml-2",children:Q.length})]}),L&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-2 flex items-center gap-1.5",children:[e.jsx(Se,{className:"w-4 h-4"}),a("restaurants.sortedByDistance")]})]}),Q.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(Ce,{className:"w-16 h-16 text-muted-foreground/40 mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-foreground mb-2",children:a("restaurants.noResults")}),e.jsx("p",{className:"text-muted-foreground max-w-xs",children:a("restaurants.noResultsDesc")})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"lg:hidden space-y-3 pb-4",children:[(q?Q:Q.slice(0,pe)).map(t=>e.jsx(Re,{ref:b=>G.current[t.id]=b,className:`p-5 cursor-pointer hover:shadow-xl transition-all duration-300 hover:scale-[1.02] hover:border-primary/40 border-2 bg-gradient-to-br from-card to-card/50 backdrop-blur-sm ${K===t.id?"border-primary ring-2 ring-primary ring-offset-2":"border-transparent"}`,onClick:()=>me(t),children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h3",{className:"font-bold text-lg text-foreground line-clamp-1 flex-1",children:t.name}),t.distance!==void 0&&e.jsxs("div",{className:"flex items-center gap-1.5 bg-primary/10 px-2.5 py-1 rounded-full w-fit",children:[e.jsx(Se,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"font-bold text-sm text-primary",children:t.distance<1?`${(t.distance*1e3).toFixed(0)} m`:`${t.distance.toFixed(1)} km`})]})]}),t.rating>0&&e.jsxs("div",{className:"flex items-center gap-1.5 bg-primary/10 px-2.5 py-1 rounded-full flex-shrink-0",children:[e.jsx(qe,{className:"w-4 h-4",style:{fill:"#016450",color:"#016450"}}),e.jsx("span",{className:"font-bold text-sm text-primary",children:t.rating})]})]}),t.type&&t.type.length>0&&e.jsx(Ye,{restaurant:t,language:l.language}),e.jsxs("div",{className:"flex items-start gap-2 text-sm text-muted-foreground",children:[e.jsx(Ce,{className:"w-4 h-4 mt-0.5 flex-shrink-0 text-primary/60"}),e.jsx("span",{className:"line-clamp-2",children:t.address})]})]})},t.id)),Q.length>pe&&e.jsx(se,{variant:"outline",className:"w-full mt-2 gap-2",onClick:()=>xe(!q),children:q?e.jsxs(e.Fragment,{children:[e.jsx(He,{className:"w-4 h-4"}),a("map.collapseList")]}):e.jsxs(e.Fragment,{children:[e.jsx(We,{className:"w-4 h-4"}),a("map.showAllRestaurants",{count:Q.length})]})})]}),e.jsx(st,{className:"hidden lg:block h-[420px] pr-4",children:e.jsx("div",{className:"space-y-3 pb-4",children:Q.map(t=>e.jsx(Re,{ref:b=>G.current[t.id]=b,className:`p-5 cursor-pointer hover:shadow-xl transition-all duration-300 hover:scale-[1.02] hover:border-primary/40 border-2 bg-gradient-to-br from-card to-card/50 backdrop-blur-sm ${K===t.id?"border-primary ring-2 ring-primary ring-offset-2":"border-transparent"}`,onClick:()=>me(t),children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h3",{className:"font-bold text-lg text-foreground line-clamp-1 flex-1",children:t.name}),t.distance!==void 0&&e.jsxs("div",{className:"flex items-center gap-1.5 bg-primary/10 px-2.5 py-1 rounded-full w-fit",children:[e.jsx(Se,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"font-bold text-sm text-primary",children:t.distance<1?`${(t.distance*1e3).toFixed(0)} m`:`${t.distance.toFixed(1)} km`})]})]}),t.rating>0&&e.jsxs("div",{className:"flex items-center gap-1.5 bg-primary/10 px-2.5 py-1 rounded-full flex-shrink-0",children:[e.jsx(qe,{className:"w-4 h-4",style:{fill:"#016450",color:"#016450"}}),e.jsx("span",{className:"font-bold text-sm text-primary",children:t.rating})]})]}),t.type&&t.type.length>0&&e.jsx(Ye,{restaurant:t,language:l.language}),e.jsxs("div",{className:"flex items-start gap-2 text-sm text-muted-foreground",children:[e.jsx(Ce,{className:"w-4 h-4 mt-0.5 flex-shrink-0 text-primary/60"}),e.jsx("span",{className:"line-clamp-2",children:t.address})]})]})},t.id))})})]})]})]}),e.jsx(lt,{open:he,onOpenChange:oe,onConfirm:we})]})},ut=r.memo(({stats:s,onAskXiaoxiong:a})=>{const{t:l,i18n:c}=ke(),{data:n}=it(),{buttons:v}=Qt(),{settings:x}=Ve(),g=c.language,[m,f]=r.useState(!1),y=x?.about_us_button_mobile!==!1,p=v?.find($=>$.label_zh==="演示"||$.link?.includes("v.xiaoxiong.pt"));p&&p.enabled!==!1&&p.visible!==!1&&p.show_on_mobile;const C=$=>!n||n.length===0?"":n[0][`${$}${g==="zh"?"_zh":g==="pt"?"_pt":"_en"}`]||"",_=C("title")||l("home.hero.title"),A=C("description")||l("home.hero.description"),L=C("subtitle_button_text")||l("home.hero.subtitle"),M=()=>{p?.link&&at(p.link),f(!1)};return e.jsxs("section",{className:"min-h-[55vh] flex flex-col bg-secondary/20",children:[e.jsxs("div",{className:"pt-20 px-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl font-bold text-foreground",children:l("home.hero.brandName")}),e.jsx("img",{src:nt,alt:"map icon",width:28,height:28,loading:"eager",decoding:"async",className:"w-7 h-7 object-contain flex-shrink-0"})]}),y&&e.jsxs(Qe,{to:"/about-us",className:"flex items-center gap-1.5 px-3 py-1.5 text-sm bg-background/80 backdrop-blur-sm rounded-full border border-border/50 shadow-sm hover:bg-background transition-colors",children:[e.jsx(Tt,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-foreground/80",children:l("nav.aboutUs","关于我们")})]})]}),s&&e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Le,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:l("home.stats.delivery")}),e.jsx("span",{className:"font-bold text-foreground text-sm",children:s.order_count})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Ze,{className:"w-4 h-4 text-accent"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:l("home.stats.reservation")}),e.jsx("span",{className:"font-bold text-foreground text-sm",children:s.reserve_count})]})]})]}),e.jsx("div",{className:"flex-1 flex flex-col items-center justify-center px-4 py-8",children:e.jsxs("div",{className:"max-w-md mx-auto text-center space-y-4",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground leading-tight",children:_}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground max-w-sm mx-auto",children:A}),e.jsx("div",{className:"pt-4",children:e.jsxs("button",{onClick:a,className:"group flex items-center gap-3 bg-secondary/50 backdrop-blur-sm text-foreground px-5 py-3.5 rounded-full shadow-sm hover:shadow-md hover:bg-secondary/70 transition-all duration-300 cursor-text border border-border/50 mx-auto",children:[e.jsx(Ge,{className:"w-5 h-5 text-primary group-hover:text-primary/80 transition-colors"}),e.jsx("span",{className:"text-sm text-muted-foreground group-hover:text-foreground transition-colors",children:L}),e.jsx(et,{className:"w-4 h-4 text-muted-foreground/60 ml-2"})]})})]})}),e.jsx(ct,{open:m,onOpenChange:f,onConfirm:M,url:p?.link})]})});ut.displayName="MobileHeroSection";const Ns=s=>!s||!Array.isArray(s)?!1:s.every(a=>typeof a=="object"&&a!==null&&"start"in a&&"end"in a&&typeof a.start=="number"&&typeof a.end=="number"),ks=(s,a)=>{const l=ze(new Date(s.start_date)),c=s.end_date?ze(new Date(s.end_date)):null,n=ze(a);if(n<l||c&&n>c)return!1;switch(s.repeat_mode||"none"){case"none":return fs(l,n);case"daily":return!0;case"weekly":const x=gs(n);return s.repeat_weekday===x;case"monthly":const m=Je(n),f=s.repeat_month_day;return Ns(f)?f.some(A=>m>=A.start&&m<=A.end):!1;case"yearly":const y=ps(n)+1,p=Je(n),C=s.repeat_yearly_month,_=s.repeat_yearly_day;return C===y&&_===p;default:return!1}},Ae=s=>{switch(s.repeat_mode||"none"){case"none":return 0;case"weekly":return 1;case"monthly":return 2;case"yearly":return 3;case"daily":return 4;default:return 5}},_s=()=>{const{data:s,isLoading:a}=mt(),l=r.useMemo(()=>{if(!s)return{today:[],tomorrow:[],dayAfterTomorrow:[]};const n=new Date,v=Xe(n,1),x=Xe(n,2),g=m=>s.filter(f=>f.visible&&f.status==="published").filter(f=>ks(f,m)).sort((f,y)=>{const p=Ae(f)-Ae(y);return p!==0?p:f.pinned!==y.pinned?f.pinned?-1:1:(f.sort_order||0)-(y.sort_order||0)});return{today:g(n),tomorrow:g(v),dayAfterTomorrow:g(x)}},[s]),c=r.useMemo(()=>{const n=new Set,v=[];return l.today.forEach(x=>{n.has(x.id)||(n.add(x.id),v.push({...x,dayLabel:"today"}))}),l.tomorrow.forEach(x=>{n.has(x.id)||(n.add(x.id),v.push({...x,dayLabel:"tomorrow"}))}),l.dayAfterTomorrow.forEach(x=>{n.has(x.id)||(n.add(x.id),v.push({...x,dayLabel:"dayAfterTomorrow"}))}),v.sort((x,g)=>{const m=Ae(x)-Ae(g);return m!==0?m:x.pinned!==g.pinned?x.pinned?-1:1:(x.sort_order||0)-(g.sort_order||0)})},[l]);return{recentActivities:l,allRecentActivities:c,isLoading:a,hasActivities:c.length>0}},ht=()=>{const[s,a]=r.useState(4);return r.useEffect(()=>{const l=()=>{const c=window.innerWidth;c<640?a(2):c<1024?a(3):a(4)};return l(),window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[]),s},xt=r.memo(({activity:s,dayLabel:a})=>{const l=Oe(),{t:c}=ke(),{getLocalizedField:n}=dt(),v=n(s,"title"),x=r.useMemo(()=>{switch(s.service_type){case"dine_in":return c("activities.serviceType.dine_in");case"takeaway":return c("activities.serviceType.takeaway");case"both":return c("activities.serviceType.both");default:return""}},[s.service_type,c]),g=()=>{l(`/activity/${s.id}`)};return e.jsxs(Re,{className:"group cursor-pointer overflow-hidden hover:shadow-lg transition-all duration-300 border-border/50 bg-card",onClick:g,children:[e.jsxs("div",{className:"relative aspect-[16/10] overflow-hidden bg-muted",children:[s.image_url?e.jsx("img",{src:s.image_url,alt:v,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",loading:"lazy"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-primary/20 to-primary/5",children:e.jsx(Dt,{className:"w-12 h-12 text-primary/40"})}),e.jsx(B,{className:P("absolute top-2 left-2 text-xs font-medium",a===c("home.recentActivities.today")?"bg-primary text-primary-foreground":"bg-secondary text-secondary-foreground"),children:a}),s.pinned&&e.jsx(B,{className:"absolute top-2 right-2 text-xs bg-accent text-accent-foreground",children:c("activities.pinned")})]}),e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx("h3",{className:"font-medium text-sm leading-tight line-clamp-2 text-foreground group-hover:text-primary transition-colors",children:v}),e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[s.service_type==="dine_in"&&e.jsx(Ue,{className:"w-3 h-3 flex-shrink-0"}),s.service_type==="takeaway"&&e.jsx(Le,{className:"w-3 h-3 flex-shrink-0"}),s.service_type==="both"&&e.jsxs(e.Fragment,{children:[e.jsx(Ue,{className:"w-3 h-3 flex-shrink-0"}),e.jsx(Le,{className:"w-3 h-3 flex-shrink-0"})]}),e.jsx("span",{className:"truncate",children:x})]})]})]})});xt.displayName="ActivityCard";const pt=r.memo(()=>{const s=ht();return e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4",children:Array.from({length:s}).map((a,l)=>e.jsxs(Re,{className:"overflow-hidden",children:[e.jsx(Ie,{className:"aspect-[16/10] w-full"}),e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx(Ie,{className:"h-4 w-full"}),e.jsx(Ie,{className:"h-3 w-2/3"})]})]},l))})});pt.displayName="LoadingSkeleton";const gt=r.memo(()=>{const{t:s}=ke(),{allRecentActivities:a,isLoading:l,hasActivities:c}=_s(),n=ht(),[v,x]=r.useState(!1),g=y=>{switch(y){case"today":return s("home.recentActivities.today");case"tomorrow":return s("home.recentActivities.tomorrow");case"dayAfterTomorrow":return s("home.recentActivities.dayAfterTomorrow");default:return""}},m=r.useMemo(()=>v?a:a.slice(0,n),[a,n,v]),f=a.length>n;return!l&&!c?null:e.jsx("section",{className:"py-8 sm:py-12 px-4 bg-secondary/20",children:e.jsxs("div",{className:"container mx-auto max-w-7xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-foreground",children:s("home.recentActivities.title")}),f&&!v&&e.jsx(se,{variant:"ghost",size:"sm",className:"text-primary hover:text-primary/80",onClick:()=>x(!0),children:e.jsxs("span",{className:"flex items-center gap-1",children:[s("home.recentActivities.viewAll"),e.jsx(Et,{className:"w-4 h-4"})]})}),v&&e.jsx(se,{variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-foreground",onClick:()=>x(!1),children:e.jsx("span",{className:"flex items-center gap-1",children:s("home.recentActivities.collapse")})})]}),l?e.jsx(pt,{}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4",children:m.map(y=>e.jsx(xt,{activity:y,dayLabel:g(y.dayLabel)},y.id))})]})})});gt.displayName="RecentActivitiesSection";const $e="/images/sushi-ramen-hero.jpg",ft="/images/sushi-ramen-mobile.jpg",bt=r.memo(({stats:s,t:a})=>e.jsx("div",{className:"absolute top-16 sm:top-20 left-3 z-20",children:e.jsxs("div",{className:"gap-4 w-fit flex-col flex items-start justify-start",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm text-white/90 drop-shadow-md",children:a("home.stats.delivery")}),e.jsx("span",{className:"font-bold text-white text-sm drop-shadow-md",children:s.order_count})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ze,{className:"w-4 h-4 text-accent"}),e.jsx("span",{className:"text-sm text-white/90 drop-shadow-md",children:a("home.stats.reservation")}),e.jsx("span",{className:"font-bold text-white text-sm drop-shadow-md",children:s.reserve_count})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl sm:text-2xl font-bold text-white drop-shadow-md",children:a("home.hero.brandName")}),e.jsx("img",{src:nt,alt:"map icon",width:32,height:32,loading:"eager",decoding:"async",className:"w-7 sm:w-8 h-7 sm:h-8 object-contain flex-shrink-0"})]})]})}));bt.displayName="StatsDisplay";const Ss=()=>{const s=window.innerWidth<640,a=window.innerWidth>=1024,l=navigator.connection,c=ot(),n=rt();return a?!!l?.saveData:!!(n&&!c||l&&(l.saveData||l.effectiveType==="2g"||l.effectiveType==="slow-2g")||s&&navigator.deviceMemory&&navigator.deviceMemory<2)},wt=r.memo(({template:s,isActive:a,currentLang:l,t:c,onContentReady:n,onAskXiaoxiong:v})=>{const[x,g]=r.useState({}),[m,f]=r.useState({}),[y,p]=r.useState({}),[C,_]=r.useState({mobile:!0,tablet:!0,desktop:!0}),[A,L]=r.useState(!1),M=Ss(),$=r.useRef(null),ae=r.useRef(null),W=r.useRef(null),H=j=>s[`${j}${l==="zh"?"_zh":l==="pt"?"_pt":"_en"}`]||"",O=()=>window.innerWidth<640?"mobile":window.innerWidth<1024?"tablet":"desktop",V=()=>{const j=O();return j==="mobile"&&s.mobile_overlay_opacity!==null?s.mobile_overlay_opacity:j==="tablet"&&s.tablet_overlay_opacity!==null?s.tablet_overlay_opacity:j==="desktop"&&s.desktop_overlay_opacity!==null?s.desktop_overlay_opacity:s.overlay_opacity??30},D=()=>{const j=V(),E=s.overlay_gradient_direction||"to-b",Y=(le,U)=>le==null?U/100:le>1?le/100:le,R=j>1?j/100:j,be=Y(s.overlay_gradient_from_opacity,30)*R,ne=Y(s.overlay_gradient_via_opacity,25)*R,we=Y(s.overlay_gradient_to_opacity,40)*R,je={"to-t":"to top","to-b":"to bottom","to-l":"to left","to-r":"to right","to-tl":"to top left","to-tr":"to top right","to-bl":"to bottom left","to-br":"to bottom right"}[E]||"to bottom",ce={black:"0, 0, 0",white:"255, 255, 255",background:"0, 0, 0",foreground:"255, 255, 255",primary:"1, 100, 80",secondary:"240, 240, 240"},de=ce[s.overlay_gradient_from||"black"]||"0, 0, 0",Q=ce[s.overlay_gradient_via||"black"]||"0, 0, 0",me=ce[s.overlay_gradient_to||"black"]||"0, 0, 0";return{background:`linear-gradient(${je}, rgba(${de}, ${be}), rgba(${Q}, ${ne}), rgba(${me}, ${we}))`}},J=s.mobile_image_url||ft,G=s.tablet_image_url||s.desktop_image_url||$e,K=s.desktop_image_url||$e,w=s.background_blur||0,T=s.desktop_media_type||s.media_type||"image",re=s.tablet_media_type||s.media_type||"image",he=s.mobile_media_type||s.media_type||"image",oe=T==="video"&&!M,F=re==="video"&&!M,ye=he==="video"&&!M,q=ye?s.mobile_video_url:null,xe=F?s.tablet_video_url||s.desktop_video_url:null,pe=oe?s.desktop_video_url:null;r.useEffect(()=>{const j=O(),E=j==="mobile"?J:j==="tablet"?G:K;if(E){const Y=new Image;Y.onload=()=>{g(R=>({...R,[j]:!0})),_(R=>({...R,[j]:!0})),a&&(n?.(),setTimeout(()=>L(!0),100))},Y.src=E}},[J,G,K,a,n]),r.useEffect(()=>{a&&x[O()]&&L(!0)},[a,x]);const ge=j=>{f(E=>({...E,[j]:!0}))},fe=(j,E)=>{console.error(`[HeroSlide] Video error on ${j}:`,E),p(Y=>({...Y,[j]:!0}))};return r.useEffect(()=>{if(!A||!a||!es())return;const E=O(),R=(E==="mobile"?$:E==="tablet"?ae:W).current;if(!R)return;const ne=setTimeout(async()=>{try{R.muted=!0,R.playsInline=!0,R.setAttribute("webkit-playsinline","true"),await R.play(),console.log(`[HeroSlide] iOS video play successful on ${E}`)}catch(we){console.error(`[HeroSlide] iOS video play failed on ${E}:`,we),p(ie=>({...ie,[E]:!0}))}},150);return()=>clearTimeout(ne)},[A,a]),e.jsxs("div",{className:P("absolute inset-0 w-full h-full transition-opacity duration-1000",a?"opacity-100 z-10":"opacity-0 z-0"),children:[e.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[e.jsxs("div",{className:"absolute inset-0 w-full h-full sm:hidden",children:[!C.mobile&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),ye&&q?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:J,alt:"Background",className:P("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",m.mobile&&!y.mobile?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:w>0?`blur(${w}px)`:void 0}}),A&&!y.mobile&&e.jsx("video",{ref:$,src:q,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>ge("mobile"),onError:j=>fe("mobile",j),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:w>0?`blur(${w}px)`:void 0}})]}):e.jsx("img",{src:J,alt:"Background",className:P("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",C.mobile?"opacity-100":"opacity-0"),style:{filter:w>0?`blur(${w}px)`:void 0}})]}),e.jsxs("div",{className:"absolute inset-0 w-full h-full hidden sm:block lg:hidden",children:[!C.tablet&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),F&&xe?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:G,alt:"Background",className:P("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",m.tablet&&!y.tablet?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:w>0?`blur(${w}px)`:void 0}}),A&&!y.tablet&&e.jsx("video",{ref:ae,src:xe,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>ge("tablet"),onError:j=>fe("tablet",j),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:w>0?`blur(${w}px)`:void 0}})]}):e.jsx("img",{src:G,alt:"Background",className:P("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",C.tablet?"opacity-100":"opacity-0"),style:{filter:w>0?`blur(${w}px)`:void 0}})]}),e.jsxs("div",{className:"absolute inset-0 w-full h-full hidden lg:block",children:[!C.desktop&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),oe&&pe?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:K,alt:"Background",className:P("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",m.desktop&&!y.desktop?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:w>0?`blur(${w}px)`:void 0}}),A&&!y.desktop&&e.jsx("video",{ref:W,src:pe,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>ge("desktop"),onError:j=>fe("desktop",j),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:w>0?`blur(${w}px)`:void 0}})]}):e.jsx("img",{src:K,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:P("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",C.desktop?"opacity-100":"opacity-0"),style:{filter:w>0?`blur(${w}px)`:void 0}})]}),e.jsx("div",{className:"absolute inset-0 w-full h-full",style:D()})]}),e.jsx("div",{className:"relative z-10 container mx-auto px-4 sm:px-6 flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center space-y-4 sm:space-y-8 animate-fade-in w-full",children:[e.jsx("h1",{className:"text-3xl sm:text-5xl md:text-7xl font-bold text-white leading-tight px-4 drop-shadow-[0_2px_8px_rgba(0,0,0,0.8)]",children:H("title")||c("home.hero.title")}),e.jsx("p",{className:"text-sm sm:text-xl md:text-2xl text-white/95 max-w-2xl mx-auto px-4 drop-shadow-[0_2px_6px_rgba(0,0,0,0.7)]",children:H("description")||c("home.hero.description")}),s.subtitle_button_text_zh&&e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:v,className:"group flex items-center gap-3 bg-white/20 backdrop-blur-xl text-white px-5 sm:px-7 py-3.5 sm:py-4 rounded-full shadow-[0_8px_32px_rgba(0,0,0,0.12)] hover:shadow-[0_16px_48px_rgba(0,0,0,0.2)] hover:bg-white/30 transition-all duration-300 cursor-text border border-white/40",children:[e.jsx(Ge,{className:"w-5 h-5 text-white/90 group-hover:text-white transition-colors drop-shadow-sm"}),e.jsx("span",{className:"text-sm sm:text-base text-primary group-hover:text-primary/80 transition-colors drop-shadow-sm font-medium",children:H("subtitle_button_text")||c("home.hero.subtitle")}),e.jsx(et,{className:"w-4 h-4 text-white/60 ml-2 drop-shadow-sm"})]})})]})})]})});wt.displayName="HeroSlide";const Us=()=>{const{t:s,i18n:a}=ke(),l=It(),{settings:c}=Ve(),{data:n,isLoading:v,refetch:x}=it(),[g,m]=r.useState(0),[f,y]=r.useState(null),p=r.useRef(null),[C,_]=r.useState(!1),[A,L]=r.useState(!1),M=tt(),{isWebView:$}=Zt(),ae=M||$,W=c?.ai_assistant_enabled!==!1,H=c?.ai_provider||"ask-xiaoxiong",O=r.useCallback(()=>{_(!0)},[]);os({pageType:"home"});const V=r.useCallback(async()=>{try{const T=await(await fetch("https://v.xiaoxiong.pt/api/get_info")).json();T&&y({order_count:T.order_count||0,reserve_count:T.reserve_count||0})}catch(w){console.error("Failed to fetch stats:",w)}},[]);r.useEffect(()=>{V()},[V]);const D=r.useCallback(async()=>{await Promise.all([x(),V(),l.invalidateQueries({queryKey:["restaurants"]}),l.invalidateQueries({queryKey:["activities"]})])},[x,V,l]);r.useEffect(()=>{if(!n||n.length<=1)return;const T=n[g]?.duration||5e3;return p.current=setTimeout(()=>{m(re=>(re+1)%n.length)},T),()=>{p.current&&clearTimeout(p.current)}},[n,g]);const J=r.useCallback(w=>{p.current&&clearTimeout(p.current),m(w)},[]);r.useCallback(()=>{n&&(p.current&&clearTimeout(p.current),m(w=>(w-1+n.length)%n.length))},[n]),r.useCallback(()=>{n&&(p.current&&clearTimeout(p.current),m(w=>(w+1)%n.length))},[n]);const G=a.language,K=n&&n.length>1;return e.jsx(ns,{onRefresh:D,children:e.jsxs("div",{className:"min-h-screen",children:[ae?e.jsx(ut,{stats:f,onAskXiaoxiong:()=>L(!0)}):e.jsxs("section",{className:"relative h-screen flex items-start overflow-hidden bg-background",children:[f&&e.jsx(bt,{stats:f,t:s}),e.jsx("div",{className:P("absolute inset-0 w-full h-full transition-opacity duration-500",C?"opacity-100":"opacity-0"),children:n?.map((w,T)=>e.jsx(wt,{template:w,isActive:T===g,currentLang:G,t:s,onContentReady:T===0?O:void 0,onAskXiaoxiong:()=>L(!0)},w.id))}),e.jsx("div",{className:P("absolute inset-0 w-full h-full z-20 transition-opacity duration-500",v||!C?"opacity-100":"opacity-0 pointer-events-none"),children:e.jsx(Gt,{})}),!v&&(!n||n.length===0)&&e.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[e.jsx("img",{src:ft,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:"absolute inset-0 w-full h-full object-cover object-center sm:hidden"}),e.jsx("img",{src:$e,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:"absolute inset-0 w-full h-full object-cover object-center hidden sm:block"}),e.jsx("div",{className:"absolute inset-0 w-full h-full bg-gradient-to-b from-black/30 via-black/25 to-black/40"}),e.jsx("div",{className:"relative z-10 container mx-auto px-4 sm:px-6 flex items-center min-h-screen",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center space-y-4 sm:space-y-8 animate-fade-in w-full",children:[e.jsx("h1",{className:"text-3xl sm:text-5xl md:text-7xl font-bold text-white leading-tight px-4 drop-shadow-[0_2px_8px_rgba(0,0,0,0.8)]",children:s("home.hero.title")}),e.jsx("p",{className:"text-sm sm:text-xl md:text-2xl text-white/95 max-w-2xl mx-auto px-4 drop-shadow-[0_2px_6px_rgba(0,0,0,0.7)]",children:s("home.hero.description")})]})})]}),K&&e.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 z-30 flex gap-2",children:n.map((w,T)=>e.jsx("button",{onClick:()=>J(T),className:P("w-3 h-3 rounded-full transition-all duration-300",T===g?"bg-white w-8":"bg-white/50 hover:bg-white/70"),"aria-label":`Go to slide ${T+1}`},T))})]}),e.jsx(gt,{}),e.jsx("section",{className:"py-12 sm:py-20 px-4 bg-secondary/20",children:e.jsx("div",{className:"container mx-auto max-w-7xl",children:e.jsx(js,{})})}),!rt()&&!ot()&&e.jsxs("section",{className:"py-16 sm:py-24 px-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 via-primary/3 to-primary/8",style:{maskImage:"radial-gradient(ellipse 80% 70% at 50% 50%, black 40%, transparent 100%)",WebkitMaskImage:"radial-gradient(ellipse 80% 70% at 50% 50%, black 40%, transparent 100%)"}}),e.jsx("div",{className:"absolute top-1/4 left-1/4 w-72 h-72 bg-primary/8 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-primary/5 rounded-full blur-3xl"}),e.jsx("div",{className:"container mx-auto max-w-5xl relative z-10",children:e.jsx("div",{className:"flex flex-col items-center justify-center gap-8",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-primary/10 text-primary text-sm font-medium px-4 py-2 rounded-full mb-4",children:[e.jsx(zt,{className:"w-4 h-4"}),e.jsx("span",{children:"Mobile App"})]}),e.jsx("h3",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-foreground mb-4",children:s("home.app.title")}),e.jsx("p",{className:"text-base sm:text-lg text-muted-foreground mb-8 leading-relaxed",children:s("home.app.description")}),e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[e.jsxs("a",{href:"https://apps.apple.com/cn/app/xiaoxiong/id6755481369",target:"_blank",rel:"noopener noreferrer",className:"relative group",children:[e.jsx("div",{className:"absolute -inset-2 bg-gradient-to-r from-primary via-primary-glow to-primary rounded-2xl blur-lg opacity-40 group-hover:opacity-70 transition-opacity"}),e.jsx("div",{className:"relative bg-black hover:bg-gray-900 h-[52px] sm:h-[56px] w-[160px] sm:w-[180px] rounded-xl transition-all hover:scale-105 shadow-2xl hover:shadow-primary/30 border border-white/10 flex items-center justify-center",children:e.jsx("img",{src:as,alt:"Download on the App Store",className:"h-8 sm:h-9"})})]}),e.jsxs("a",{href:"https://play.google.com/store/apps/details?id=com.xiaoxiong.market",target:"_blank",rel:"noopener noreferrer",className:"relative group",children:[e.jsx("div",{className:"absolute -inset-2 bg-gradient-to-r from-primary via-primary-glow to-primary rounded-2xl blur-lg opacity-40 group-hover:opacity-70 transition-opacity"}),e.jsx("div",{className:"relative bg-black hover:bg-gray-900 h-[52px] sm:h-[56px] w-[160px] sm:w-[180px] rounded-xl transition-all hover:scale-105 shadow-2xl hover:shadow-primary/30 border border-white/10 flex items-center justify-center",children:e.jsx("img",{src:rs,alt:"Get it on Google Play",className:"h-12 sm:h-14"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Mt,{className:"w-4 h-4 animate-bounce"}),e.jsx("span",{children:s("home.app.downloadNow")})]})]})]})})})]}),e.jsxs("section",{className:"py-16 sm:py-20 px-4 bg-gradient-to-r from-primary/90 to-primary relative overflow-hidden rounded-3xl mx-4 sm:mx-8 lg:mx-16 mb-8",children:[e.jsx("div",{className:"absolute inset-0 bg-grid-pattern opacity-10"}),e.jsx("div",{className:"absolute top-0 right-0 w-64 sm:w-96 h-64 sm:h-96 bg-white/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-64 sm:w-96 h-64 sm:h-96 bg-white/10 rounded-full blur-3xl"}),e.jsxs("div",{className:"container mx-auto max-w-4xl text-center relative z-10",children:[e.jsx("h2",{className:"text-3xl sm:text-4xl md:text-5xl font-bold text-primary-foreground mb-4 sm:mb-6 px-4",children:s("home.cta.title")}),e.jsx("p",{className:"text-base sm:text-xl text-primary-foreground/90 mb-6 sm:mb-8 max-w-2xl mx-auto px-4",children:s("home.cta.description")}),e.jsx("div",{className:"flex justify-center",children:e.jsx(se,{size:"lg",variant:"secondary",asChild:!0,className:"text-base sm:text-lg shadow-xl hover:shadow-2xl",children:e.jsxs(Qe,{to:"/join-us",children:[e.jsx($t,{className:"mr-2 w-4 sm:w-5 h-4 sm:h-5"}),s("home.cta.button")]})})})]})]}),W&&e.jsx(ys,{open:A,onOpenChange:L,provider:H})]})})};export{Us as default};
//# sourceMappingURL=Home-DLn9g41c.js.map
