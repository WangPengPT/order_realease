import{d as te,b1 as ie,b2 as re,b3 as ne,b4 as le,b5 as oe,b6 as ce,r as b,j as e,J as S,B as j,C as f,b as N,K as de,au as me,N as he,O as pe,Q as ue,R as xe,T as ge,U as ve,V as je,D as _e,q as ye,a6 as be,a7 as fe,a9 as Ne,aa as r,I as c,ai as Te,aj as we,ak as Ce,al as ke,am as y,an as U,a as L,m as O,z as g}from"./index-BFidtWYN.js";import{S as $}from"./slider-BE9Qx2j_.js";import{T as De,a as Fe,b as w,c as C}from"./tabs-V42ZnOFF.js";import{P as Ee}from"./plus-Do2rl3FN.js";import{G as ze}from"./grip-vertical-CG_DxDWp.js";import{C as Ae}from"./clock-CoSDiFhL.js";import{E as Ie}from"./eye-DCnXgP8e.js";import{E as Re}from"./eye-off-2QHNcKaO.js";import{S as Se}from"./square-pen-BhohwWi8.js";import{T as Ue}from"./trash-2-CsnJWyJn.js";import{S as Le}from"./save-DlcS52x2.js";import{I as Oe}from"./image-B8hIdkwh.js";import{V as He}from"./video-MY2qwdHW.js";import{R as Be}from"./refresh-cw-Bhv6ZqNi.js";const aa=()=>{const{t:s}=te(),{data:_,isLoading:V}=ie(),k=re(),T=ne(),W=le(),D=oe(),M=ce(),[p,F]=b.useState(null),[q,E]=b.useState(!1),[t,v]=b.useState({}),[G,z]=b.useState("images"),J=()=>{v({sort_order:(_==null?void 0:_.length)||0,is_active:!0,media_type:"image",duration:5e3,overlay_opacity:40,overlay_gradient_direction:"to-b",overlay_gradient_from:"background",overlay_gradient_from_opacity:30,overlay_gradient_via:"background",overlay_gradient_via_opacity:25,overlay_gradient_to:"background",overlay_gradient_to_opacity:40,background_blur:0,title_zh:"发现您的亚洲美食之旅",title_en:"Discover Your Asian Food Journey",title_pt:"Descubra Sua Jornada Gastronômica Asiática",subtitle_zh:"您的美食之旅从这里开始",subtitle_en:"Your culinary journey starts here",subtitle_pt:"Sua jornada culinária começa aqui",description_zh:"探索里斯本地区最好的亚洲美食",description_en:"Explore the best Asian cuisine in the Lisbon area",description_pt:"Explore a melhor cozinha asiática na área de Lisboa",primary_button_text_zh:"探索餐厅",primary_button_text_en:"Explore Restaurants",primary_button_text_pt:"Explorar Restaurantes",primary_button_link:"/restaurants",primary_button_variant:"default",secondary_button_text_zh:"活动",secondary_button_text_en:"Activities",secondary_button_text_pt:"Atividades",secondary_button_link:"/activities",secondary_button_variant:"outline"}),E(!0),z("media")},Y=a=>{v(a),F(a),z("media")},K=async()=>{try{p?(await T.mutateAsync({id:p.id,...t}),F(null)):(await k.mutateAsync(t),E(!1)),v({})}catch(a){console.error("Save failed:",a)}},Q=async a=>{try{await W.mutateAsync(a)}catch(d){console.error("Delete failed:",d)}},X=async a=>{try{await T.mutateAsync({id:a.id,is_active:!a.is_active})}catch(d){console.error("Toggle failed:",d)}},A=async(a,d)=>{var i;const o=(i=a.target.files)==null?void 0:i[0];if(o){if(!o.type.startsWith("image/")){g.error(s("admin.homepageTemplates.selectImageFile"));return}try{const n=(p==null?void 0:p.id)||"new",u=await D.mutateAsync({file:o,type:d,templateId:n});v(m=>({...m,[`${d}_image_url`]:u.url}))}catch(n){console.error("Upload failed:",n)}}},Z=a=>new Promise((d,o)=>{const i=document.createElement("video"),n=document.createElement("canvas"),u=n.getContext("2d");i.preload="auto",i.muted=!0,i.playsInline=!0,i.crossOrigin="anonymous";let m=!1;const x=()=>{m||i.videoWidth===0||i.videoHeight===0||(n.width=i.videoWidth,n.height=i.videoHeight,u?(u.drawImage(i,0,0,n.width,n.height),n.toBlob(h=>{h&&h.size>0?(m=!0,i.pause(),URL.revokeObjectURL(i.src),d(h)):o(new Error("Failed to create blob from canvas"))},"image/jpeg",.95)):o(new Error("Failed to get canvas context")))};i.onloadedmetadata=()=>{n.width=i.videoWidth,n.height=i.videoHeight,i.currentTime=.1},i.onseeked=()=>{setTimeout(x,100)},i.oncanplay=()=>{!m&&i.currentTime>=.1&&setTimeout(x,100)},i.onerror=h=>{URL.revokeObjectURL(i.src),o(new Error("Failed to load video: "+(h==null?void 0:h.message)||"Unknown error"))},setTimeout(()=>{m||(URL.revokeObjectURL(i.src),o(new Error("Timeout while extracting video frame")))},1e4),i.src=URL.createObjectURL(a),i.load()}),ee=a=>new Promise((d,o)=>{const i=document.createElement("video"),n=document.createElement("canvas"),u=n.getContext("2d");i.preload="auto",i.muted=!0,i.playsInline=!0,i.crossOrigin="anonymous";let m=!1;const x=()=>{m||i.videoWidth===0||i.videoHeight===0||(n.width=i.videoWidth,n.height=i.videoHeight,u?(u.drawImage(i,0,0,n.width,n.height),n.toBlob(h=>{h&&h.size>0?(m=!0,i.pause(),d(h)):o(new Error("Failed to create blob from canvas"))},"image/jpeg",.95)):o(new Error("Failed to get canvas context")))};i.onloadedmetadata=()=>{n.width=i.videoWidth,n.height=i.videoHeight,i.currentTime=.1},i.onseeked=()=>{setTimeout(x,100)},i.oncanplay=()=>{!m&&i.currentTime>=.1&&setTimeout(x,100)},i.onerror=()=>{o(new Error("Failed to load video from URL"))},setTimeout(()=>{m||o(new Error("Timeout while extracting video frame from URL"))},15e3),i.src=a,i.load()}),[H,B]=b.useState(!1),ae=async()=>{const a=["desktop","tablet","mobile"],d=(p==null?void 0:p.id)||"new";B(!0);let o=0,i=0;for(const n of a){const u=t[`${n}_video_url`];if(u)try{g.info(`正在提取${n==="desktop"?"桌面端":n==="tablet"?"平板端":"移动端"}视频第一帧...`);const m=await ee(u),x=new File([m],`${n}-poster-${Date.now()}.jpg`,{type:"image/jpeg"}),h=await D.mutateAsync({file:x,type:n,templateId:d});v(R=>({...R,[`${n}_image_url`]:h.url})),o++}catch(m){console.error(`Failed to regenerate ${n} poster:`,m),i++}}B(!1),o>0&&g.success(`成功重新生成 ${o} 个备用图片`),i>0&&g.warning(`${i} 个视频提取失败，可能是跨域限制`),o===0&&i===0&&g.info("没有找到需要处理的视频")},I=async(a,d)=>{var i;const o=(i=a.target.files)==null?void 0:i[0];if(o){if(!o.type.startsWith("video/")){g.error("请选择视频文件");return}if(o.size>100*1024*1024){g.error("视频文件大小不能超过100MB");return}try{const n=(p==null?void 0:p.id)||"new",u=await M.mutateAsync({file:o,type:d,templateId:n});try{g.info("正在提取视频第一帧作为备用图片...");const m=await Z(o),x=new File([m],`${d}-poster-${Date.now()}.jpg`,{type:"image/jpeg"}),h=await D.mutateAsync({file:x,type:d,templateId:n});v(R=>({...R,[`${d}_video_url`]:u.url,[`${d}_image_url`]:h.url})),g.success("视频和备用图片已自动生成")}catch(m){console.error("Failed to extract first frame:",m),v(x=>({...x,[`${d}_video_url`]:u.url})),g.warning("视频已上传，但无法自动提取第一帧，请手动上传备用图片")}}catch(n){console.error("Upload failed:",n)}}},l=(a,d)=>{v(o=>({...o,[a]:d}))},P=()=>{F(null),E(!1),v({})};if(V)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(S,{className:"w-8 h-8 animate-spin"})});const se=()=>e.jsxs(De,{value:G,onValueChange:z,className:"w-full",children:[e.jsxs(Fe,{className:"grid w-full grid-cols-4",children:[e.jsx(w,{value:"media",children:"媒体"}),e.jsx(w,{value:"overlay",children:s("admin.homepageTemplates.tabs.overlay")}),e.jsx(w,{value:"content",children:s("admin.homepageTemplates.tabs.content")}),e.jsx(w,{value:"buttons",children:s("admin.homepageTemplates.tabs.buttons")})]}),e.jsxs(C,{value:"media",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"媒体类型"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(j,{type:"button",variant:t.media_type==="image"?"default":"outline",onClick:()=>l("media_type","image"),className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"w-4 h-4"}),"图片"]}),e.jsxs(j,{type:"button",variant:t.media_type==="video"?"default":"outline",onClick:()=>l("media_type","video"),className:"flex items-center gap-2",children:[e.jsx(He,{className:"w-4 h-4"}),"视频"]})]})]}),t.media_type==="image"&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:s("admin.homepageTemplates.desktopImage")}),e.jsxs("div",{className:"flex items-center gap-4",children:[t.desktop_image_url&&e.jsx("img",{src:t.desktop_image_url,alt:"Desktop",className:"w-32 h-20 object-cover rounded border"}),e.jsx(c,{type:"file",accept:"image/*",onChange:a=>A(a,"desktop")})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:s("admin.homepageTemplates.tabletImage")}),e.jsxs("div",{className:"flex items-center gap-4",children:[t.tablet_image_url&&e.jsx("img",{src:t.tablet_image_url,alt:"Tablet",className:"w-32 h-20 object-cover rounded border"}),e.jsx(c,{type:"file",accept:"image/*",onChange:a=>A(a,"tablet")})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:s("admin.homepageTemplates.mobileImage")}),e.jsxs("div",{className:"flex items-center gap-4",children:[t.mobile_image_url&&e.jsx("img",{src:t.mobile_image_url,alt:"Mobile",className:"w-32 h-20 object-cover rounded border"}),e.jsx(c,{type:"file",accept:"image/*",onChange:a=>A(a,"mobile")})]})]})]})}),t.media_type==="video"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"支持 MP4, WebM 格式，建议大小不超过100MB"}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"桌面端视频"}),e.jsxs("div",{className:"flex items-center gap-4",children:[t.desktop_video_url&&e.jsx("video",{src:t.desktop_video_url,className:"w-32 h-20 object-cover rounded border",muted:!0}),e.jsx(c,{type:"file",accept:"video/mp4,video/webm",onChange:a=>I(a,"desktop")})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"平板端视频"}),e.jsxs("div",{className:"flex items-center gap-4",children:[t.tablet_video_url&&e.jsx("video",{src:t.tablet_video_url,className:"w-32 h-20 object-cover rounded border",muted:!0}),e.jsx(c,{type:"file",accept:"video/mp4,video/webm",onChange:a=>I(a,"tablet")})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"移动端视频"}),e.jsxs("div",{className:"flex items-center gap-4",children:[t.mobile_video_url&&e.jsx("video",{src:t.mobile_video_url,className:"w-32 h-20 object-cover rounded border",muted:!0}),e.jsx(c,{type:"file",accept:"video/mp4,video/webm",onChange:a=>I(a,"mobile")})]})]})]}),e.jsxs("div",{className:"pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx(r,{className:"text-sm font-medium",children:"备用图片（自动从视频第一帧生成）"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"上传视频时会自动截取第一帧作为备用图片"})]}),(t.desktop_video_url||t.tablet_video_url||t.mobile_video_url)&&e.jsxs(j,{type:"button",variant:"outline",size:"sm",onClick:ae,disabled:H,children:[H?e.jsx(S,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(Be,{className:"w-4 h-4 mr-2"}),"重新生成第一帧"]})]}),t.desktop_image_url||t.tablet_image_url||t.mobile_image_url?e.jsxs("div",{className:"flex gap-4 mt-2",children:[t.desktop_image_url&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(r,{className:"text-xs text-muted-foreground",children:"桌面端"}),e.jsx("img",{src:t.desktop_image_url,alt:"Desktop poster",className:"w-32 h-20 object-cover rounded border"})]}),t.tablet_image_url&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(r,{className:"text-xs text-muted-foreground",children:"平板端"}),e.jsx("img",{src:t.tablet_image_url,alt:"Tablet poster",className:"w-32 h-20 object-cover rounded border"})]}),t.mobile_image_url&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(r,{className:"text-xs text-muted-foreground",children:"移动端"}),e.jsx("img",{src:t.mobile_image_url,alt:"Mobile poster",className:"w-32 h-20 object-cover rounded border"})]})]}):e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:'暂无备用图片，请点击"重新生成第一帧"按钮'})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:s("admin.homepageTemplates.duration")}),e.jsx(c,{type:"number",value:t.duration||5e3,onChange:a=>l("duration",parseInt(a.target.value)||5e3),min:1e3,max:3e4}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s("admin.homepageTemplates.durationHint")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:s("admin.homepageTemplates.sortOrder")}),e.jsx(c,{type:"number",value:t.sort_order||0,onChange:a=>l("sort_order",parseInt(a.target.value)||0)})]})]})]}),e.jsx(C,{value:"overlay",className:"space-y-4 mt-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(r,{children:[s("admin.homepageTemplates.baseOverlayOpacity"),": ",t.overlay_opacity||40,"%"]}),e.jsx($,{value:[t.overlay_opacity||40],onValueChange:([a])=>l("overlay_opacity",a),max:100,step:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:s("admin.homepageTemplates.gradientDirection")}),e.jsxs(Te,{value:t.overlay_gradient_direction||"to-b",onValueChange:a=>l("overlay_gradient_direction",a),children:[e.jsx(we,{children:e.jsx(Ce,{})}),e.jsxs(ke,{children:[e.jsx(y,{value:"to-b",children:s("admin.homepageTemplates.gradientDirection.toBottom")}),e.jsx(y,{value:"to-t",children:s("admin.homepageTemplates.gradientDirection.toTop")}),e.jsx(y,{value:"to-r",children:s("admin.homepageTemplates.gradientDirection.toRight")}),e.jsx(y,{value:"to-l",children:s("admin.homepageTemplates.gradientDirection.toLeft")}),e.jsx(y,{value:"to-br",children:s("admin.homepageTemplates.gradientDirection.toBottomRight")}),e.jsx(y,{value:"to-tr",children:s("admin.homepageTemplates.gradientDirection.toTopRight")})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:s("admin.homepageTemplates.startOpacity")}),e.jsx(c,{type:"number",min:"0",max:"100",value:t.overlay_gradient_from_opacity||30,onChange:a=>l("overlay_gradient_from_opacity",parseInt(a.target.value)||0)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:s("admin.homepageTemplates.middleOpacity")}),e.jsx(c,{type:"number",min:"0",max:"100",value:t.overlay_gradient_via_opacity||25,onChange:a=>l("overlay_gradient_via_opacity",parseInt(a.target.value)||0)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:s("admin.homepageTemplates.endOpacity")}),e.jsx(c,{type:"number",min:"0",max:"100",value:t.overlay_gradient_to_opacity||40,onChange:a=>l("overlay_gradient_to_opacity",parseInt(a.target.value)||0)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(r,{children:[s("admin.homepageTemplates.backgroundBlur"),": ",t.background_blur||0,"px"]}),e.jsx($,{value:[t.background_blur||0],onValueChange:([a])=>l("background_blur",a),max:50,step:1})]})]})}),e.jsx(C,{value:"content",className:"space-y-4 mt-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:s("admin.homepageTemplates.titleChinese")}),e.jsx(c,{value:t.title_zh||"",onChange:a=>l("title_zh",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:s("admin.homepageTemplates.titleEnglish")}),e.jsx(c,{value:t.title_en||"",onChange:a=>l("title_en",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:s("admin.homepageTemplates.titlePortuguese")}),e.jsx(c,{value:t.title_pt||"",onChange:a=>l("title_pt",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:s("admin.homepageTemplates.descriptionChinese")}),e.jsx(U,{value:t.description_zh||"",onChange:a=>l("description_zh",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:s("admin.homepageTemplates.descriptionEnglish")}),e.jsx(U,{value:t.description_en||"",onChange:a=>l("description_en",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:s("admin.homepageTemplates.descriptionPortuguese")}),e.jsx(U,{value:t.description_pt||"",onChange:a=>l("description_pt",a.target.value)})]})]})}),e.jsxs(C,{value:"buttons",className:"space-y-4 mt-4",children:[e.jsxs(f,{children:[e.jsx(L,{className:"py-3",children:e.jsx(O,{className:"text-lg",children:s("admin.homepageTemplates.primaryButton")})}),e.jsxs(N,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:s("admin.homepageTemplates.chinese")}),e.jsx(c,{value:t.primary_button_text_zh||"",onChange:a=>l("primary_button_text_zh",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:s("admin.homepageTemplates.english")}),e.jsx(c,{value:t.primary_button_text_en||"",onChange:a=>l("primary_button_text_en",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:s("admin.homepageTemplates.portuguese")}),e.jsx(c,{value:t.primary_button_text_pt||"",onChange:a=>l("primary_button_text_pt",a.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:s("admin.homepageTemplates.link")}),e.jsx(c,{value:t.primary_button_link||"",onChange:a=>l("primary_button_link",a.target.value)})]})]})]}),e.jsxs(f,{children:[e.jsx(L,{className:"py-3",children:e.jsx(O,{className:"text-lg",children:s("admin.homepageTemplates.secondaryButton")})}),e.jsxs(N,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:s("admin.homepageTemplates.chinese")}),e.jsx(c,{value:t.secondary_button_text_zh||"",onChange:a=>l("secondary_button_text_zh",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:s("admin.homepageTemplates.english")}),e.jsx(c,{value:t.secondary_button_text_en||"",onChange:a=>l("secondary_button_text_en",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:s("admin.homepageTemplates.portuguese")}),e.jsx(c,{value:t.secondary_button_text_pt||"",onChange:a=>l("secondary_button_text_pt",a.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:s("admin.homepageTemplates.link")}),e.jsx(c,{value:t.secondary_button_link||"",onChange:a=>l("secondary_button_link",a.target.value)})]})]})]}),e.jsxs(f,{children:[e.jsx(L,{className:"py-3",children:e.jsx(O,{className:"text-lg",children:s("admin.homepageTemplates.subtitleButton")})}),e.jsxs(N,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:s("admin.homepageTemplates.chinese")}),e.jsx(c,{value:t.subtitle_button_text_zh||"",onChange:a=>l("subtitle_button_text_zh",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:s("admin.homepageTemplates.english")}),e.jsx(c,{value:t.subtitle_button_text_en||"",onChange:a=>l("subtitle_button_text_en",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:s("admin.homepageTemplates.portuguese")}),e.jsx(c,{value:t.subtitle_button_text_pt||"",onChange:a=>l("subtitle_button_text_pt",a.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:s("admin.homepageTemplates.link")}),e.jsx(c,{value:t.subtitle_button_link||"",onChange:a=>l("subtitle_button_link",a.target.value)})]})]})]})]})]});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:s("admin.homepageTemplates")}),e.jsx("p",{className:"text-muted-foreground mt-2",children:s("admin.homepageTemplatesDescription")})]}),e.jsxs(j,{onClick:J,children:[e.jsx(Ee,{className:"w-4 h-4 mr-2"}),s("admin.homepageTemplates.createTemplate")]})]}),e.jsxs("div",{className:"grid gap-4",children:[_==null?void 0:_.map(a=>e.jsx(f,{className:a.is_active?"":"opacity-60",children:e.jsx(N,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(ze,{className:"w-5 h-5"}),e.jsxs("span",{className:"text-sm font-medium",children:["#",a.sort_order]})]}),a.desktop_image_url&&e.jsx("img",{src:a.desktop_image_url,alt:"Preview",className:"w-24 h-16 object-cover rounded border"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold truncate",children:a.title_zh}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:a.description_zh}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(Ae,{className:"w-3 h-3 text-muted-foreground"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[a.duration/1e3,s("admin.homepageTemplates.seconds")]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>X(a),title:a.is_active?s("admin.homepageTemplates.hide"):s("admin.homepageTemplates.show"),children:a.is_active?e.jsx(Ie,{className:"w-4 h-4"}):e.jsx(Re,{className:"w-4 h-4"})}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>Y(a),children:e.jsx(Se,{className:"w-4 h-4"})}),e.jsxs(de,{children:[e.jsx(me,{asChild:!0,children:e.jsx(j,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive",children:e.jsx(Ue,{className:"w-4 h-4"})})}),e.jsxs(he,{children:[e.jsxs(pe,{children:[e.jsx(ue,{children:s("admin.confirmDelete")}),e.jsx(xe,{children:s("admin.homepageTemplates.deleteTemplateConfirm")})]}),e.jsxs(ge,{children:[e.jsx(ve,{children:s("common.cancel")}),e.jsx(je,{onClick:()=>Q(a.id),children:s("common.delete")})]})]})]})]})]})})},a.id)),(!_||_.length===0)&&e.jsx(f,{children:e.jsx(N,{className:"p-8 text-center text-muted-foreground",children:s("admin.homepageTemplates.noTemplates")})})]}),e.jsx(_e,{open:!!p||q,onOpenChange:P,children:e.jsxs(ye,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(be,{children:[e.jsx(fe,{children:s(p?"admin.homepageTemplates.editTemplate":"admin.homepageTemplates.createTemplate")}),e.jsx(Ne,{children:s("admin.homepageTemplates.configureTemplate")})]}),se(),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(j,{variant:"outline",onClick:P,children:s("common.cancel")}),e.jsxs(j,{onClick:K,disabled:k.isPending||T.isPending,children:[(k.isPending||T.isPending)&&e.jsx(S,{className:"w-4 h-4 mr-2 animate-spin"}),e.jsx(Le,{className:"w-4 h-4 mr-2"}),s("common.save")]})]})]})})]})};export{aa as default};
