{"version":3,"file":"AdminBrands-BPpeDRE1.js","sources":["../../src/components/admin/BrandContentBlocksEditor.tsx","../../src/components/ui/toggle.tsx","../../src/components/ui/toggle-group.tsx","../../src/components/admin/BrandLogoCropDialog.tsx","../../src/components/admin/BrandFormDialog.tsx","../../src/pages/admin/AdminBrands.tsx"],"sourcesContent":["import { useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Card, CardContent } from \"@/components/ui/card\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\nimport { \r\n  Plus, \r\n  Trash2, \r\n  GripVertical, \r\n  Image as ImageIcon, \r\n  Type,\r\n  ChevronUp,\r\n  ChevronDown,\r\n  Upload\r\n} from \"lucide-react\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { toast } from \"sonner\";\r\nimport ReactQuill from \"react-quill\";\r\nimport \"react-quill/dist/quill.snow.css\";\r\n\r\nexport interface ContentBlock {\r\n  id: string;\r\n  type: \"text\" | \"image\";\r\n  content_zh?: string;\r\n  content_en?: string;\r\n  content_pt?: string;\r\n  url?: string;\r\n  alt?: string;\r\n}\r\n\r\ninterface BrandContentBlocksEditorProps {\r\n  blocks: ContentBlock[];\r\n  onChange: (blocks: ContentBlock[]) => void;\r\n}\r\n\r\nconst generateId = () => Math.random().toString(36).substring(2, 9);\r\n\r\nconst quillModules = {\r\n  toolbar: [\r\n    [{ header: [1, 2, 3, false] }],\r\n    [\"bold\", \"italic\", \"underline\"],\r\n    [{ list: \"ordered\" }, { list: \"bullet\" }],\r\n    [\"link\"],\r\n    [\"clean\"],\r\n  ],\r\n};\r\n\r\nexport const BrandContentBlocksEditor = ({ blocks, onChange }: BrandContentBlocksEditorProps) => {\r\n  const { t, i18n } = useTranslation();\r\n  const [uploadingId, setUploadingId] = useState<string | null>(null);\r\n\r\n  const addBlock = (type: \"text\" | \"image\") => {\r\n    const newBlock: ContentBlock = {\r\n      id: generateId(),\r\n      type,\r\n      ...(type === \"text\" ? { content_zh: \"\", content_en: \"\", content_pt: \"\" } : { url: \"\", alt: \"\" }),\r\n    };\r\n    onChange([...blocks, newBlock]);\r\n  };\r\n\r\n  const removeBlock = (id: string) => {\r\n    onChange(blocks.filter((b) => b.id !== id));\r\n  };\r\n\r\n  const moveBlock = (index: number, direction: \"up\" | \"down\") => {\r\n    const newBlocks = [...blocks];\r\n    const targetIndex = direction === \"up\" ? index - 1 : index + 1;\r\n    if (targetIndex < 0 || targetIndex >= blocks.length) return;\r\n    [newBlocks[index], newBlocks[targetIndex]] = [newBlocks[targetIndex], newBlocks[index]];\r\n    onChange(newBlocks);\r\n  };\r\n\r\n  const updateBlock = (id: string, updates: Partial<ContentBlock>) => {\r\n    onChange(blocks.map((b) => (b.id === id ? { ...b, ...updates } : b)));\r\n  };\r\n\r\n  const handleImageUpload = async (id: string, file: File) => {\r\n    if (!file.type.startsWith(\"image/\")) {\r\n      toast.error(t(\"admin.brand.invalidImageType\"));\r\n      return;\r\n    }\r\n\r\n    setUploadingId(id);\r\n    try {\r\n      const fileExt = file.name.split(\".\").pop();\r\n      const fileName = `brand-content-${Date.now()}.${fileExt}`;\r\n\r\n      const { error: uploadError } = await supabase.storage\r\n        .from(\"restaurant-images\")\r\n        .upload(fileName, file);\r\n\r\n      if (uploadError) throw uploadError;\r\n\r\n      const { data: { publicUrl } } = supabase.storage\r\n        .from(\"restaurant-images\")\r\n        .getPublicUrl(fileName);\r\n\r\n      updateBlock(id, { url: publicUrl });\r\n      toast.success(t(\"admin.brand.imageUploaded\"));\r\n    } catch (error: any) {\r\n      console.error(\"Upload error:\", error);\r\n      toast.error(error.message || t(\"admin.brand.uploadError\"));\r\n    } finally {\r\n      setUploadingId(null);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <Label>{t(\"admin.brand.contentBlocks\")}</Label>\r\n        <div className=\"flex gap-2\">\r\n          <Button\r\n            type=\"button\"\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={() => addBlock(\"text\")}\r\n          >\r\n            <Type className=\"h-4 w-4 mr-1\" />\r\n            {t(\"admin.brand.addText\")}\r\n          </Button>\r\n          <Button\r\n            type=\"button\"\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={() => addBlock(\"image\")}\r\n          >\r\n            <ImageIcon className=\"h-4 w-4 mr-1\" />\r\n            {t(\"admin.brand.addImage\")}\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {blocks.length === 0 && (\r\n        <Card className=\"border-dashed\">\r\n          <CardContent className=\"py-8 text-center text-muted-foreground\">\r\n            <p>{t(\"admin.brand.noBlocks\")}</p>\r\n            <p className=\"text-sm mt-1\">{t(\"admin.brand.addBlockHint\")}</p>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      <div className=\"space-y-3\">\r\n        {blocks.map((block, index) => (\r\n          <Card key={block.id} className=\"relative\">\r\n            <CardContent className=\"pt-4\">\r\n              <div className=\"flex items-start gap-2\">\r\n                {/* Move buttons */}\r\n                <div className=\"flex flex-col gap-1 pt-2\">\r\n                  <Button\r\n                    type=\"button\"\r\n                    variant=\"ghost\"\r\n                    size=\"icon\"\r\n                    className=\"h-6 w-6\"\r\n                    disabled={index === 0}\r\n                    onClick={() => moveBlock(index, \"up\")}\r\n                  >\r\n                    <ChevronUp className=\"h-4 w-4\" />\r\n                  </Button>\r\n                  <div className=\"flex items-center justify-center h-6 w-6 text-muted-foreground\">\r\n                    <GripVertical className=\"h-4 w-4\" />\r\n                  </div>\r\n                  <Button\r\n                    type=\"button\"\r\n                    variant=\"ghost\"\r\n                    size=\"icon\"\r\n                    className=\"h-6 w-6\"\r\n                    disabled={index === blocks.length - 1}\r\n                    onClick={() => moveBlock(index, \"down\")}\r\n                  >\r\n                    <ChevronDown className=\"h-4 w-4\" />\r\n                  </Button>\r\n                </div>\r\n\r\n                {/* Block content */}\r\n                <div className=\"flex-1 min-w-0\">\r\n                  {block.type === \"text\" ? (\r\n                    <Tabs defaultValue=\"zh\" className=\"w-full\">\r\n                      <TabsList className=\"mb-2\">\r\n                        <TabsTrigger value=\"zh\">{t(\"admin.chinese\")}</TabsTrigger>\r\n                        <TabsTrigger value=\"en\">{t(\"admin.english\")}</TabsTrigger>\r\n                        <TabsTrigger value=\"pt\">{t(\"admin.portuguese\")}</TabsTrigger>\r\n                      </TabsList>\r\n                      <TabsContent value=\"zh\">\r\n                        <ReactQuill\r\n                          theme=\"snow\"\r\n                          value={block.content_zh || \"\"}\r\n                          onChange={(val) => updateBlock(block.id, { content_zh: val })}\r\n                          modules={quillModules}\r\n                          placeholder={t(\"admin.brand.textPlaceholder\")}\r\n                        />\r\n                      </TabsContent>\r\n                      <TabsContent value=\"en\">\r\n                        <ReactQuill\r\n                          theme=\"snow\"\r\n                          value={block.content_en || \"\"}\r\n                          onChange={(val) => updateBlock(block.id, { content_en: val })}\r\n                          modules={quillModules}\r\n                          placeholder={t(\"admin.brand.textPlaceholder\")}\r\n                        />\r\n                      </TabsContent>\r\n                      <TabsContent value=\"pt\">\r\n                        <ReactQuill\r\n                          theme=\"snow\"\r\n                          value={block.content_pt || \"\"}\r\n                          onChange={(val) => updateBlock(block.id, { content_pt: val })}\r\n                          modules={quillModules}\r\n                          placeholder={t(\"admin.brand.textPlaceholder\")}\r\n                        />\r\n                      </TabsContent>\r\n                    </Tabs>\r\n                  ) : (\r\n                    <div className=\"space-y-3\">\r\n                      {block.url ? (\r\n                        <div className=\"relative group\">\r\n                          <img\r\n                            src={block.url}\r\n                            alt={block.alt || \"\"}\r\n                            className=\"w-full max-h-48 object-contain rounded-lg bg-muted\"\r\n                          />\r\n                          <div className=\"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center rounded-lg\">\r\n                            <label className=\"cursor-pointer\">\r\n                              <Input\r\n                                type=\"file\"\r\n                                accept=\"image/*\"\r\n                                className=\"hidden\"\r\n                                onChange={(e) => {\r\n                                  const file = e.target.files?.[0];\r\n                                  if (file) handleImageUpload(block.id, file);\r\n                                }}\r\n                              />\r\n                              <Button type=\"button\" variant=\"secondary\" size=\"sm\">\r\n                                {t(\"common.replace\")}\r\n                              </Button>\r\n                            </label>\r\n                          </div>\r\n                        </div>\r\n                      ) : (\r\n                        <label className=\"cursor-pointer\">\r\n                          <Input\r\n                            type=\"file\"\r\n                            accept=\"image/*\"\r\n                            className=\"hidden\"\r\n                            onChange={(e) => {\r\n                              const file = e.target.files?.[0];\r\n                              if (file) handleImageUpload(block.id, file);\r\n                            }}\r\n                          />\r\n                          <div className=\"border-2 border-dashed rounded-lg p-8 text-center hover:border-primary transition-colors\">\r\n                            {uploadingId === block.id ? (\r\n                              <div className=\"animate-pulse text-muted-foreground\">\r\n                                {t(\"common.uploading\")}...\r\n                              </div>\r\n                            ) : (\r\n                              <>\r\n                                <Upload className=\"h-8 w-8 mx-auto text-muted-foreground mb-2\" />\r\n                                <p className=\"text-sm text-muted-foreground\">\r\n                                  {t(\"admin.brand.clickToUpload\")}\r\n                                </p>\r\n                              </>\r\n                            )}\r\n                          </div>\r\n                        </label>\r\n                      )}\r\n                      <Input\r\n                        placeholder={t(\"admin.brand.imageAlt\")}\r\n                        value={block.alt || \"\"}\r\n                        onChange={(e) => updateBlock(block.id, { alt: e.target.value })}\r\n                      />\r\n                    </div>\r\n                  )}\r\n                </div>\r\n\r\n                {/* Delete button */}\r\n                <Button\r\n                  type=\"button\"\r\n                  variant=\"ghost\"\r\n                  size=\"icon\"\r\n                  className=\"h-8 w-8 text-destructive hover:text-destructive\"\r\n                  onClick={() => removeBlock(block.id)}\r\n                >\r\n                  <Trash2 className=\"h-4 w-4\" />\r\n                </Button>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import * as React from \"react\";\r\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\";\r\nimport { cva, type VariantProps } from \"class-variance-authority\";\r\n\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nconst toggleVariants = cva(\r\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default: \"bg-transparent\",\r\n        outline: \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\r\n      },\r\n      size: {\r\n        default: \"h-10 px-3\",\r\n        sm: \"h-9 px-2.5\",\r\n        lg: \"h-11 px-5\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n      size: \"default\",\r\n    },\r\n  },\r\n);\r\n\r\nconst Toggle = React.forwardRef<\r\n  React.ElementRef<typeof TogglePrimitive.Root>,\r\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> & VariantProps<typeof toggleVariants>\r\n>(({ className, variant, size, ...props }, ref) => (\r\n  <TogglePrimitive.Root ref={ref} className={cn(toggleVariants({ variant, size, className }))} {...props} />\r\n));\r\n\r\nToggle.displayName = TogglePrimitive.Root.displayName;\r\n\r\nexport { Toggle, toggleVariants };\r\n","import * as React from \"react\";\r\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\";\r\nimport { type VariantProps } from \"class-variance-authority\";\r\n\r\nimport { cn } from \"@/lib/utils\";\r\nimport { toggleVariants } from \"@/components/ui/toggle\";\r\n\r\nconst ToggleGroupContext = React.createContext<VariantProps<typeof toggleVariants>>({\r\n  size: \"default\",\r\n  variant: \"default\",\r\n});\r\n\r\nconst ToggleGroup = React.forwardRef<\r\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\r\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> & VariantProps<typeof toggleVariants>\r\n>(({ className, variant, size, children, ...props }, ref) => (\r\n  <ToggleGroupPrimitive.Root ref={ref} className={cn(\"flex items-center justify-center gap-1\", className)} {...props}>\r\n    <ToggleGroupContext.Provider value={{ variant, size }}>{children}</ToggleGroupContext.Provider>\r\n  </ToggleGroupPrimitive.Root>\r\n));\r\n\r\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName;\r\n\r\nconst ToggleGroupItem = React.forwardRef<\r\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\r\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> & VariantProps<typeof toggleVariants>\r\n>(({ className, children, variant, size, ...props }, ref) => {\r\n  const context = React.useContext(ToggleGroupContext);\r\n\r\n  return (\r\n    <ToggleGroupPrimitive.Item\r\n      ref={ref}\r\n      className={cn(\r\n        toggleVariants({\r\n          variant: context.variant || variant,\r\n          size: context.size || size,\r\n        }),\r\n        className,\r\n      )}\r\n      {...props}\r\n    >\r\n      {children}\r\n    </ToggleGroupPrimitive.Item>\r\n  );\r\n});\r\n\r\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName;\r\n\r\nexport { ToggleGroup, ToggleGroupItem };\r\n","import { useState, useRef, useCallback, useEffect } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport ReactCrop, { Crop, PixelCrop, centerCrop, makeAspectCrop } from \"react-image-crop\";\r\nimport \"react-image-crop/dist/ReactCrop.css\";\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Crop as CropIcon, Square, RectangleHorizontal } from \"lucide-react\";\r\nimport { ToggleGroup, ToggleGroupItem } from \"@/components/ui/toggle-group\";\r\n\r\ninterface BrandLogoCropDialogProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  imageFile: File;\r\n  onCropComplete: (croppedFile: File, preview: string) => void;\r\n}\r\n\r\ntype AspectMode = \"free\" | \"1:1\" | \"4:3\";\r\n\r\nexport function BrandLogoCropDialog({\r\n  open,\r\n  onOpenChange,\r\n  imageFile,\r\n  onCropComplete,\r\n}: BrandLogoCropDialogProps) {\r\n  const { t } = useTranslation();\r\n  const [imgSrc, setImgSrc] = useState(\"\");\r\n  const [crop, setCrop] = useState<Crop>();\r\n  const [completedCrop, setCompletedCrop] = useState<PixelCrop>();\r\n  const [aspectMode, setAspectMode] = useState<AspectMode>(\"free\");\r\n  const imgRef = useRef<HTMLImageElement>(null);\r\n  const [isCropping, setIsCropping] = useState(false);\r\n\r\n  const aspectMap: Record<AspectMode, number | undefined> = {\r\n    free: undefined,\r\n    \"1:1\": 1,\r\n    \"4:3\": 4 / 3,\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (open && imageFile) {\r\n      const reader = new FileReader();\r\n      reader.addEventListener(\"load\", () => {\r\n        setImgSrc(reader.result?.toString() || \"\");\r\n      });\r\n      reader.readAsDataURL(imageFile);\r\n    }\r\n  }, [open, imageFile]);\r\n\r\n  const onImageLoad = useCallback(\r\n    (e: React.SyntheticEvent<HTMLImageElement>) => {\r\n      const { width, height } = e.currentTarget;\r\n      const aspect = aspectMap[aspectMode];\r\n      if (aspect) {\r\n        setCrop(\r\n          centerCrop(\r\n            makeAspectCrop({ unit: \"%\", width: 80 }, aspect, width, height),\r\n            width,\r\n            height\r\n          )\r\n        );\r\n      } else {\r\n        setCrop({ unit: \"%\", x: 10, y: 10, width: 80, height: 80 });\r\n      }\r\n    },\r\n    [aspectMode]\r\n  );\r\n\r\n  // Reset crop when aspect mode changes\r\n  useEffect(() => {\r\n    if (!imgRef.current || !imgSrc) return;\r\n    const { width, height } = imgRef.current;\r\n    if (width === 0) return;\r\n    const aspect = aspectMap[aspectMode];\r\n    if (aspect) {\r\n      setCrop(\r\n        centerCrop(\r\n          makeAspectCrop({ unit: \"%\", width: 80 }, aspect, width, height),\r\n          width,\r\n          height\r\n        )\r\n      );\r\n    }\r\n    // For free mode, keep current crop\r\n  }, [aspectMode]);\r\n\r\n  const getCroppedImg = useCallback(\r\n    async (image: HTMLImageElement, crop: PixelCrop): Promise<Blob> => {\r\n      const canvas = document.createElement(\"canvas\");\r\n      const ctx = canvas.getContext(\"2d\");\r\n      if (!ctx) throw new Error(\"No 2d context\");\r\n\r\n      const scaleX = image.naturalWidth / image.width;\r\n      const scaleY = image.naturalHeight / image.height;\r\n\r\n      canvas.width = crop.width * scaleX;\r\n      canvas.height = crop.height * scaleY;\r\n      ctx.imageSmoothingQuality = \"high\";\r\n\r\n      ctx.drawImage(\r\n        image,\r\n        crop.x * scaleX,\r\n        crop.y * scaleY,\r\n        crop.width * scaleX,\r\n        crop.height * scaleY,\r\n        0,\r\n        0,\r\n        canvas.width,\r\n        canvas.height\r\n      );\r\n\r\n      return new Promise((resolve, reject) => {\r\n        canvas.toBlob(\r\n          (blob) => {\r\n            if (!blob) { reject(new Error(\"Canvas is empty\")); return; }\r\n            resolve(blob);\r\n          },\r\n          \"image/png\",\r\n          1\r\n        );\r\n      });\r\n    },\r\n    []\r\n  );\r\n\r\n  const handleCropConfirm = useCallback(async () => {\r\n    if (!completedCrop || !imgRef.current) return;\r\n    setIsCropping(true);\r\n    try {\r\n      const croppedBlob = await getCroppedImg(imgRef.current, completedCrop);\r\n      const croppedFile = new File([croppedBlob], imageFile.name, { type: \"image/png\" });\r\n      const previewUrl = URL.createObjectURL(croppedBlob);\r\n      onCropComplete(croppedFile, previewUrl);\r\n      onOpenChange(false);\r\n    } catch (error) {\r\n      console.error(\"Error cropping image:\", error);\r\n    } finally {\r\n      setIsCropping(false);\r\n    }\r\n  }, [completedCrop, imageFile, onCropComplete, onOpenChange, getCroppedImg]);\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={onOpenChange}>\r\n      <DialogContent className=\"max-w-[95vw] sm:max-w-3xl max-h-[95vh] overflow-hidden flex flex-col p-0\">\r\n        <DialogHeader className=\"px-4 sm:px-6 pt-4 sm:pt-6 pb-4 border-b\">\r\n          <DialogTitle className=\"text-lg sm:text-xl flex items-center gap-2\">\r\n            <CropIcon className=\"w-5 h-5 text-primary\" />\r\n            {t(\"admin.cropImage\", \"裁剪图片\")}\r\n          </DialogTitle>\r\n          <DialogDescription className=\"text-xs sm:text-sm\">\r\n            {t(\"admin.cropLogoDescription\", \"自由裁剪品牌Logo大小\")}\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        <div className=\"px-4 sm:px-6 py-4 space-y-4 overflow-y-auto\">\r\n          {/* Aspect ratio toggle */}\r\n          <div className=\"flex items-center gap-3\">\r\n            <span className=\"text-sm font-medium text-muted-foreground\">\r\n              {t(\"admin.aspectRatio\", \"比例\")}:\r\n            </span>\r\n            <ToggleGroup\r\n              type=\"single\"\r\n              value={aspectMode}\r\n              onValueChange={(v) => v && setAspectMode(v as AspectMode)}\r\n              className=\"gap-1\"\r\n            >\r\n              <ToggleGroupItem value=\"free\" size=\"sm\" className=\"text-xs px-3\">\r\n                {t(\"admin.freeAspect\", \"自由\")}\r\n              </ToggleGroupItem>\r\n              <ToggleGroupItem value=\"1:1\" size=\"sm\" className=\"text-xs px-3 gap-1\">\r\n                <Square className=\"w-3 h-3\" /> 1:1\r\n              </ToggleGroupItem>\r\n              <ToggleGroupItem value=\"4:3\" size=\"sm\" className=\"text-xs px-3 gap-1\">\r\n                <RectangleHorizontal className=\"w-3 h-3\" /> 4:3\r\n              </ToggleGroupItem>\r\n            </ToggleGroup>\r\n          </div>\r\n\r\n          <div className=\"relative w-full overflow-hidden rounded-lg border\">\r\n            {imgSrc && (\r\n              <ReactCrop\r\n                crop={crop}\r\n                onChange={(c) => setCrop(c)}\r\n                onComplete={(c) => setCompletedCrop(c)}\r\n                aspect={aspectMap[aspectMode]}\r\n                className=\"max-h-[50vh] sm:max-h-[60vh]\"\r\n              >\r\n                <img\r\n                  ref={imgRef}\r\n                  src={imgSrc}\r\n                  alt=\"Crop preview\"\r\n                  onLoad={onImageLoad}\r\n                  className=\"max-w-full h-auto\"\r\n                />\r\n              </ReactCrop>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        <DialogFooter className=\"px-4 sm:px-6 pb-4 sm:pb-6 pt-4 border-t gap-2 sm:gap-0\">\r\n          <Button type=\"button\" variant=\"outline\" onClick={() => onOpenChange(false)} disabled={isCropping} className=\"w-full sm:w-auto\">\r\n            {t(\"common.cancel\")}\r\n          </Button>\r\n          <Button type=\"button\" onClick={handleCropConfirm} disabled={!completedCrop || isCropping} className=\"w-full sm:w-auto\">\r\n            {isCropping ? t(\"common.processing\", \"处理中...\") : t(\"admin.confirmCrop\", \"确认裁剪\")}\r\n          </Button>\r\n        </DialogFooter>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}\r\n","import { useState, useEffect } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\r\nimport { Card, CardContent } from \"@/components/ui/card\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\nimport { Upload, X, Building2, Globe } from \"lucide-react\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { useToast } from \"@/hooks/use-toast\";\r\nimport { useCreateBrand, useUpdateBrand, Brand } from \"@/hooks/useBrands\";\r\nimport { BrandContentBlocksEditor, ContentBlock } from \"@/components/admin/BrandContentBlocksEditor\";\r\nimport { BrandLogoCropDialog } from \"@/components/admin/BrandLogoCropDialog\";\r\n\r\ninterface BrandFormDialogProps {\r\n  brand?: Brand;\r\n  trigger: React.ReactNode;\r\n}\r\n\r\nexport function BrandFormDialog({ brand, trigger }: BrandFormDialogProps) {\r\n  const { t } = useTranslation();\r\n  const { toast } = useToast();\r\n  const createBrand = useCreateBrand();\r\n  const updateBrand = useUpdateBrand();\r\n  \r\n  const [open, setOpen] = useState(false);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  \r\n  // Form fields\r\n  const [name, setName] = useState(brand?.name || \"\");\r\n  const [nameEn, setNameEn] = useState(brand?.name_en || \"\");\r\n  const [namePt, setNamePt] = useState(brand?.name_pt || \"\");\r\n  \r\n  // Content blocks for flexible content ordering\r\n  const [contentBlocks, setContentBlocks] = useState<ContentBlock[]>([]);\r\n  \r\n  // Logo upload\r\n  const [logoFile, setLogoFile] = useState<File | null>(null);\r\n  const [logoPreview, setLogoPreview] = useState<string | null>(brand?.logo_url || null);\r\n  const [showCropDialog, setShowCropDialog] = useState(false);\r\n  const [pendingLogoFile, setPendingLogoFile] = useState<File | null>(null);\r\n\r\n  // Reset form when dialog opens with brand data\r\n  useEffect(() => {\r\n    if (open && brand) {\r\n      setName(brand.name || \"\");\r\n      setNameEn(brand.name_en || \"\");\r\n      setNamePt(brand.name_pt || \"\");\r\n      setLogoPreview(brand.logo_url || null);\r\n      // Parse content blocks from brand data\r\n      const blocks = (brand.content_blocks as ContentBlock[]) || [];\r\n      setContentBlocks(blocks);\r\n    } else if (open && !brand) {\r\n      // Reset for new brand\r\n      setName(\"\");\r\n      setNameEn(\"\");\r\n      setNamePt(\"\");\r\n      setLogoPreview(null);\r\n      setLogoFile(null);\r\n      setContentBlocks([]);\r\n    }\r\n  }, [open, brand]);\r\n\r\n  const handleLogoChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (file) {\r\n      setPendingLogoFile(file);\r\n      setShowCropDialog(true);\r\n    }\r\n    // Reset input so same file can be re-selected\r\n    e.target.value = '';\r\n  };\r\n\r\n  const handleCropComplete = (croppedFile: File, preview: string) => {\r\n    setLogoFile(croppedFile);\r\n    setLogoPreview(preview);\r\n    setPendingLogoFile(null);\r\n  };\r\n\r\n\r\n  const uploadFile = async (file: File, prefix: string): Promise<string | null> => {\r\n    const fileExt = file.name.split(\".\").pop();\r\n    const fileName = `${prefix}_${Math.random()}.${fileExt}`;\r\n    \r\n    const { error: uploadError } = await supabase.storage\r\n      .from(\"restaurant-images\")\r\n      .upload(fileName, file);\r\n\r\n    if (uploadError) throw uploadError;\r\n\r\n    const { data: { publicUrl } } = supabase.storage\r\n      .from(\"restaurant-images\")\r\n      .getPublicUrl(fileName);\r\n\r\n    return publicUrl;\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    if (!name.trim()) {\r\n      toast({\r\n        title: t(\"common.error\"),\r\n        description: t(\"admin.brand.nameRequired\"),\r\n        variant: \"destructive\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    setIsSubmitting(true);\r\n    try {\r\n      let logoUrl = brand?.logo_url || null;\r\n\r\n      if (logoFile) {\r\n        logoUrl = await uploadFile(logoFile, \"brand_logo\");\r\n      }\r\n\r\n      const brandData = {\r\n        name,\r\n        name_en: nameEn || null,\r\n        name_pt: namePt || null,\r\n        logo_url: logoUrl,\r\n        content_blocks: contentBlocks,\r\n      };\r\n\r\n      if (brand) {\r\n        await updateBrand.mutateAsync({ id: brand.id, ...brandData });\r\n      } else {\r\n        await createBrand.mutateAsync(brandData);\r\n      }\r\n\r\n      setOpen(false);\r\n    } catch (error: any) {\r\n      toast({\r\n        title: t(\"common.error\"),\r\n        description: error.message,\r\n        variant: \"destructive\",\r\n      });\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n    <Dialog open={open} onOpenChange={setOpen}>\r\n      <DialogTrigger asChild>{trigger}</DialogTrigger>\r\n      <DialogContent className=\"max-w-[95vw] sm:max-w-4xl max-h-[95vh] overflow-hidden flex flex-col p-0\">\r\n        <DialogHeader className=\"px-6 pt-6 pb-4 border-b bg-muted/30\">\r\n          <DialogTitle className=\"text-2xl flex items-center gap-2\">\r\n            <Building2 className=\"w-6 h-6 text-primary\" />\r\n            {brand ? t(\"admin.brand.edit\") : t(\"admin.brand.create\")}\r\n          </DialogTitle>\r\n          <DialogDescription className=\"text-base\">\r\n            {brand ? t(\"admin.brand.editDesc\") : t(\"admin.brand.createDesc\")}\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        <ScrollArea className=\"px-6 h-[calc(95vh-220px)]\">\r\n          <form onSubmit={handleSubmit} className=\"space-y-6 py-6\">\r\n            {/* Brand Name */}\r\n            <Card className=\"border-primary/20 bg-gradient-to-br from-background to-muted/20\">\r\n              <CardContent className=\"p-6\">\r\n                <Label className=\"text-base font-semibold flex items-center gap-2 mb-4\">\r\n                  <Globe className=\"w-5 h-5 text-primary\" />\r\n                  {t(\"admin.brand.name\")}\r\n                </Label>\r\n                <Tabs defaultValue=\"zh\" className=\"w-full\">\r\n                  <TabsList className=\"grid w-full grid-cols-3\">\r\n                    <TabsTrigger value=\"zh\">{t(\"admin.chinese\")}</TabsTrigger>\r\n                    <TabsTrigger value=\"en\">{t(\"admin.english\")}</TabsTrigger>\r\n                    <TabsTrigger value=\"pt\">{t(\"admin.portuguese\")}</TabsTrigger>\r\n                  </TabsList>\r\n                  <TabsContent value=\"zh\" className=\"mt-4\">\r\n                    <Input\r\n                      value={name}\r\n                      onChange={(e) => setName(e.target.value)}\r\n                      placeholder={t(\"admin.brand.namePlaceholder\")}\r\n                    />\r\n                  </TabsContent>\r\n                  <TabsContent value=\"en\" className=\"mt-4\">\r\n                    <Input\r\n                      value={nameEn}\r\n                      onChange={(e) => setNameEn(e.target.value)}\r\n                      placeholder={t(\"admin.brand.namePlaceholderEn\")}\r\n                    />\r\n                  </TabsContent>\r\n                  <TabsContent value=\"pt\" className=\"mt-4\">\r\n                    <Input\r\n                      value={namePt}\r\n                      onChange={(e) => setNamePt(e.target.value)}\r\n                      placeholder={t(\"admin.brand.namePlaceholderPt\")}\r\n                    />\r\n                  </TabsContent>\r\n                </Tabs>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Logo */}\r\n            <Card className=\"border-primary/20 bg-gradient-to-br from-background to-muted/20\">\r\n              <CardContent className=\"p-6\">\r\n                <Label className=\"text-base font-semibold flex items-center gap-2 mb-4\">\r\n                  <Upload className=\"w-5 h-5 text-primary\" />\r\n                  {t(\"admin.brand.logo\")}\r\n                </Label>\r\n                <div className=\"flex items-center gap-4\">\r\n                  {logoPreview && (\r\n                    <div className=\"relative group\">\r\n                      <img\r\n                        src={logoPreview}\r\n                        alt=\"Logo Preview\"\r\n                        className=\"w-24 h-24 object-contain rounded-lg shadow-lg ring-2 ring-primary/20 bg-muted\"\r\n                      />\r\n                      <Button\r\n                        type=\"button\"\r\n                        variant=\"destructive\"\r\n                        size=\"icon\"\r\n                        className=\"absolute -top-2 -right-2 h-6 w-6 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity\"\r\n                        onClick={() => {\r\n                          setLogoFile(null);\r\n                          setLogoPreview(null);\r\n                        }}\r\n                      >\r\n                        <X className=\"h-3 w-3\" />\r\n                      </Button>\r\n                    </div>\r\n                  )}\r\n                  <Label htmlFor=\"logo-upload\" className=\"cursor-pointer\">\r\n                    <div className=\"flex flex-col items-center gap-2 px-6 py-4 border-2 border-dashed border-primary/30 rounded-lg hover:border-primary hover:bg-primary/5 transition-all duration-200\">\r\n                      <Upload className=\"h-6 w-6 text-primary\" />\r\n                      <p className=\"font-medium text-xs\">{t(\"admin.uploadImage\")}</p>\r\n                    </div>\r\n                    <Input\r\n                      id=\"logo-upload\"\r\n                      type=\"file\"\r\n                      accept=\"image/*\"\r\n                      className=\"hidden\"\r\n                      onChange={handleLogoChange}\r\n                    />\r\n                  </Label>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Brand Content Blocks */}\r\n            <Card className=\"border-primary/20 bg-gradient-to-br from-background to-muted/20\">\r\n              <CardContent className=\"p-6\">\r\n                <BrandContentBlocksEditor\r\n                  blocks={contentBlocks}\r\n                  onChange={setContentBlocks}\r\n                />\r\n              </CardContent>\r\n            </Card>\r\n          </form>\r\n        </ScrollArea>\r\n\r\n        <div className=\"flex justify-end gap-3 p-6 border-t bg-muted/30\">\r\n          <Button type=\"button\" variant=\"outline\" onClick={() => setOpen(false)}>\r\n            {t(\"common.cancel\")}\r\n          </Button>\r\n          <Button onClick={handleSubmit} disabled={isSubmitting}>\r\n            {isSubmitting ? t(\"common.saving\") : (brand ? t(\"common.save\") : t(\"common.create\"))}\r\n          </Button>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n\r\n      {pendingLogoFile && (\r\n        <BrandLogoCropDialog\r\n          open={showCropDialog}\r\n          onOpenChange={(open) => {\r\n            setShowCropDialog(open);\r\n            if (!open) setPendingLogoFile(null);\r\n          }}\r\n          imageFile={pendingLogoFile}\r\n          onCropComplete={handleCropComplete}\r\n        />\r\n      )}\r\n    </>\r\n  );\r\n}\r\n","import { useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n  AlertDialogTrigger,\r\n} from \"@/components/ui/alert-dialog\";\r\nimport { Plus, Search, Building2, Trash2, Edit } from \"lucide-react\";\r\nimport { useBrands, useDeleteBrand } from \"@/hooks/useBrands\";\r\nimport { BrandFormDialog } from \"@/components/admin/BrandFormDialog\";\r\nimport { useLocalizedContent } from \"@/hooks/useLocalizedContent\";\r\n\r\nconst AdminBrands = () => {\r\n  const { t } = useTranslation();\r\n  const { data: brands, isLoading } = useBrands();\r\n  const deleteBrand = useDeleteBrand();\r\n  const { getLocalizedField } = useLocalizedContent();\r\n  const [searchQuery, setSearchQuery] = useState(\"\");\r\n\r\n  const filteredBrands = brands?.filter((brand) =>\r\n    brand.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n    brand.name_en?.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n    brand.name_pt?.toLowerCase().includes(searchQuery.toLowerCase())\r\n  );\r\n\r\n  if (isLoading) {\r\n    return <div className=\"text-center\">{t(\"common.loading\")}</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4\">\r\n        <div>\r\n          <h1 className=\"text-2xl md:text-3xl font-bold mb-2\">{t(\"admin.brand.title\")}</h1>\r\n          <p className=\"text-muted-foreground\">{t(\"admin.brand.subtitle\")}</p>\r\n        </div>\r\n        <BrandFormDialog\r\n          trigger={\r\n            <Button>\r\n              <Plus className=\"mr-2 h-4 w-4\" />\r\n              {t(\"admin.brand.create\")}\r\n            </Button>\r\n          }\r\n        />\r\n      </div>\r\n\r\n      {/* Search */}\r\n      <Card>\r\n        <CardContent className=\"pt-6\">\r\n          <div className=\"relative\">\r\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\r\n            <Input\r\n              placeholder={t(\"admin.brand.search\")}\r\n              value={searchQuery}\r\n              onChange={(e) => setSearchQuery(e.target.value)}\r\n              className=\"pl-9\"\r\n            />\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Brand List */}\r\n      <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\r\n        {filteredBrands?.map((brand) => (\r\n          <Card key={brand.id} className=\"overflow-hidden\">\r\n            {brand.image_url && (\r\n              <div className=\"aspect-video overflow-hidden\">\r\n                <img\r\n                  src={brand.image_url}\r\n                  alt={brand.name}\r\n                  className=\"w-full h-full object-cover\"\r\n                />\r\n              </div>\r\n            )}\r\n            <CardHeader className=\"pb-2\">\r\n              <div className=\"flex items-start justify-between gap-2\">\r\n                <div className=\"flex items-center gap-3\">\r\n                  {brand.logo_url ? (\r\n                    <img\r\n                      src={brand.logo_url}\r\n                      alt={`${brand.name} logo`}\r\n                      className=\"w-10 h-10 object-contain rounded-lg bg-muted p-1\"\r\n                    />\r\n                  ) : (\r\n                    <div className=\"w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center\">\r\n                      <Building2 className=\"w-5 h-5 text-primary\" />\r\n                    </div>\r\n                  )}\r\n                  <div>\r\n                    <CardTitle className=\"text-lg\">{getLocalizedField(brand, \"name\")}</CardTitle>\r\n                    <CardDescription className=\"text-xs\">\r\n                      {brand.name !== brand.name_en && brand.name_en && (\r\n                        <span className=\"mr-2\">{brand.name_en}</span>\r\n                      )}\r\n                    </CardDescription>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </CardHeader>\r\n            <CardContent className=\"pt-0\">\r\n              {(brand.intro_zh || brand.intro_en || brand.intro_pt) && (\r\n                <div \r\n                  className=\"text-sm text-muted-foreground line-clamp-2 mb-4 prose prose-sm max-w-none\r\n                    [&_p]:m-0 [&_*]:text-muted-foreground\"\r\n                  dangerouslySetInnerHTML={{ \r\n                    __html: getLocalizedField(brand, \"intro\") || \"\" \r\n                  }}\r\n                />\r\n              )}\r\n              <div className=\"flex gap-2\">\r\n                <BrandFormDialog\r\n                  brand={brand}\r\n                  trigger={\r\n                    <Button variant=\"outline\" size=\"sm\" className=\"flex-1\">\r\n                      <Edit className=\"mr-2 h-4 w-4\" />\r\n                      {t(\"common.edit\")}\r\n                    </Button>\r\n                  }\r\n                />\r\n                <AlertDialog>\r\n                  <AlertDialogTrigger asChild>\r\n                    <Button variant=\"outline\" size=\"sm\">\r\n                      <Trash2 className=\"h-4 w-4\" />\r\n                    </Button>\r\n                  </AlertDialogTrigger>\r\n                  <AlertDialogContent>\r\n                    <AlertDialogHeader>\r\n                      <AlertDialogTitle>{t(\"admin.brand.deleteConfirm\")}</AlertDialogTitle>\r\n                      <AlertDialogDescription>\r\n                        {t(\"admin.brand.deleteWarning\")}\r\n                      </AlertDialogDescription>\r\n                    </AlertDialogHeader>\r\n                    <AlertDialogFooter>\r\n                      <AlertDialogCancel>{t(\"common.cancel\")}</AlertDialogCancel>\r\n                      <AlertDialogAction onClick={() => deleteBrand.mutate(brand.id)}>\r\n                        {t(\"common.delete\")}\r\n                      </AlertDialogAction>\r\n                    </AlertDialogFooter>\r\n                  </AlertDialogContent>\r\n                </AlertDialog>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        ))}\r\n      </div>\r\n\r\n      {filteredBrands?.length === 0 && (\r\n        <Card>\r\n          <CardContent className=\"py-12 text-center\">\r\n            <Building2 className=\"mx-auto h-12 w-12 text-muted-foreground/50 mb-4\" />\r\n            <p className=\"text-muted-foreground\">{t(\"admin.brand.empty\")}</p>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdminBrands;\r\n"],"names":["generateId","quillModules","BrandContentBlocksEditor","blocks","onChange","t","i18n","useTranslation","uploadingId","setUploadingId","useState","addBlock","type","newBlock","removeBlock","id","b","moveBlock","index","direction","newBlocks","targetIndex","updateBlock","updates","handleImageUpload","file","toast","fileExt","fileName","uploadError","supabase","publicUrl","error","jsxs","jsx","Label","Button","Type","ImageIcon","Card","CardContent","block","ChevronUp","GripVertical","ChevronDown","Tabs","TabsList","TabsTrigger","TabsContent","ReactQuill","val","Input","e","Fragment","Upload","Trash2","toggleVariants","cva","Toggle","React.forwardRef","className","variant","size","props","ref","TogglePrimitive.Root","cn","ToggleGroupContext","React.createContext","ToggleGroup","children","ToggleGroupPrimitive.Root","ToggleGroupItem","context","React.useContext","ToggleGroupPrimitive.Item","BrandLogoCropDialog","open","onOpenChange","imageFile","onCropComplete","imgSrc","setImgSrc","crop","setCrop","completedCrop","setCompletedCrop","aspectMode","setAspectMode","imgRef","useRef","isCropping","setIsCropping","aspectMap","useEffect","reader","onImageLoad","useCallback","width","height","aspect","centerCrop","makeAspectCrop","getCroppedImg","image","canvas","ctx","scaleX","scaleY","resolve","reject","blob","handleCropConfirm","croppedBlob","croppedFile","previewUrl","Dialog","DialogContent","DialogHeader","DialogTitle","CropIcon","DialogDescription","v","Square","RectangleHorizontal","ReactCrop","c","DialogFooter","BrandFormDialog","brand","trigger","useToast","createBrand","useCreateBrand","updateBrand","useUpdateBrand","setOpen","isSubmitting","setIsSubmitting","name","setName","nameEn","setNameEn","namePt","setNamePt","contentBlocks","setContentBlocks","logoFile","setLogoFile","logoPreview","setLogoPreview","showCropDialog","setShowCropDialog","pendingLogoFile","setPendingLogoFile","handleLogoChange","handleCropComplete","preview","uploadFile","prefix","handleSubmit","logoUrl","brandData","DialogTrigger","Building2","ScrollArea","Globe","X","AdminBrands","brands","isLoading","useBrands","deleteBrand","useDeleteBrand","getLocalizedField","useLocalizedContent","searchQuery","setSearchQuery","filteredBrands","Plus","Search","CardHeader","CardTitle","CardDescription","Edit","AlertDialog","AlertDialogTrigger","AlertDialogContent","AlertDialogHeader","AlertDialogTitle","AlertDialogDescription","AlertDialogFooter","AlertDialogCancel","AlertDialogAction"],"mappings":"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"}