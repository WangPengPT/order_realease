import{a as p,u as c,b as m}from"./vendor-query-BS0wY7WL.js";import{s as o}from"./index-CEqKPgls.js";import{ah as a}from"./vendor-misc-DH4LiFnZ.js";const h=()=>p({queryKey:["homepage-templates"],queryFn:async()=>{const{data:e,error:r}=await o.from("homepage_templates").select("*").order("sort_order",{ascending:!0});if(r)throw r;return e},staleTime:1e3*60*5,gcTime:1e3*60*30}),y=()=>p({queryKey:["homepage-templates","active"],queryFn:async()=>{const{data:e,error:r}=await o.from("homepage_templates").select("*").eq("is_active",!0).order("sort_order",{ascending:!0});if(r)throw r;return e},staleTime:1e3*60*5,gcTime:1e3*60*30}),w=()=>{const e=c();return m({mutationFn:async r=>{const{data:t,error:s}=await o.from("homepage_templates").insert(r).select().single();if(s)throw s;return t},onSuccess:()=>{e.invalidateQueries({queryKey:["homepage-templates"]}),a.success("模板创建成功")},onError:r=>{console.error("Failed to create template:",r),a.error("创建失败")}})},q=()=>{const e=c();return m({mutationFn:async({id:r,...t})=>{const{data:s,error:i}=await o.from("homepage_templates").update(t).eq("id",r).select().single();if(i)throw i;return s},onSuccess:()=>{e.invalidateQueries({queryKey:["homepage-templates"]}),a.success("模板更新成功")},onError:r=>{console.error("Failed to update template:",r),a.error("更新失败")}})},F=()=>{const e=c();return m({mutationFn:async r=>{const{error:t}=await o.from("homepage_templates").delete().eq("id",r);if(t)throw t},onSuccess:()=>{e.invalidateQueries({queryKey:["homepage-templates"]}),a.success("模板删除成功")},onError:r=>{console.error("Failed to delete template:",r),a.error("删除失败")}})},T=()=>m({mutationFn:async({file:e,type:r,templateId:t})=>{const s=e.name.split(".").pop(),n=`template-${t}-${r}-${Date.now()}.${s}`,{error:u}=await o.storage.from("homepage-images").upload(n,e,{upsert:!0});if(u)throw u;const{data:{publicUrl:l}}=o.storage.from("homepage-images").getPublicUrl(n);return{type:r,url:l}},onSuccess:({type:e})=>{a.success(`${e}图片上传成功`)},onError:e=>{console.error("Failed to upload image:",e),a.error("图片上传失败")}}),$=()=>m({mutationFn:async({file:e,type:r,templateId:t})=>{const s=e.name.split(".").pop(),n=`template-${t}-${r}-video-${Date.now()}.${s}`,{error:u}=await o.storage.from("homepage-images").upload(n,e,{upsert:!0});if(u)throw u;const{data:{publicUrl:l}}=o.storage.from("homepage-images").getPublicUrl(n);return{type:r,url:l}},onSuccess:({type:e})=>{a.success(`${e}视频上传成功`)},onError:e=>{console.error("Failed to upload video:",e),a.error("视频上传失败")}});export{h as a,w as b,q as c,F as d,T as e,$ as f,y as u};
//# sourceMappingURL=useHomepageTemplates-CSGE_Si7.js.map
