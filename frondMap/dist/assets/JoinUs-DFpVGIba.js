import{u as L,r as p,b as I,j as e,C as N,p as v,P as D,as as $,B as C,o as q,m as A,z as B,ap as O,I as j,i as S,L as H,y as J,ae as f}from"./index-tBrG_sQo.js";import{u as R}from"./index.esm-elYa_6fy.js";import{o as V,s as x,a as G,e as K,t as Q}from"./types-DVL29xX1.js";import{C as W}from"./checkbox-Bp8vb7M1.js";import{F as X,a as i,b as o,c,d as m,e as d,f as Y}from"./form-CCDQbWtC.js";import{C as Z}from"./circle-check--4qO3VK5.js";const w=["booking","delivery","qrcode"],ie=()=>{const{t:s,i18n:u}=L(),[_,b]=p.useState(!1),[F,U]=p.useState(!1),{settings:r}=I(),M=p.useMemo(()=>V({name:x().min(2,{message:s("joinUs.nameMin")}),email:x().email({message:s("joinUs.emailInvalid")}),phone:x().min(6,{message:s("joinUs.phoneMin")}),restaurant_name:x().min(2,{message:s("joinUs.restaurantNameMin")}),restaurant_address:x().min(2,{message:s("joinUs.addressMin")}),features_selected:G(K(w)).min(1,{message:s("joinUs.featuresMin")})}),[s]),a=R({resolver:Q(M),defaultValues:{name:"",email:"",phone:"",restaurant_name:"",restaurant_address:"",features_selected:[]}}),T=async n=>{b(!0);try{const t=u.language||"en",{error:l}=await J.functions.invoke("send-join-request-email",{body:{...n,language:t}});if(l){if(l.message.includes("rate_limit_exceeded"))f({title:s("joinUs.rateLimitError"),description:s("joinUs.rateLimitErrorDesc"),variant:"destructive"});else throw l;return}U(!0),a.reset(),f({title:s("joinUs.successTitle"),description:s("joinUs.successDescription")})}catch(t){console.error("Error submitting join request:",t),f({title:s("common.error"),description:s("joinUs.submitError"),variant:"destructive"})}finally{b(!1)}},P=()=>{const n=u.language;return n==="zh"&&(r!=null&&r.join_success_title_zh)?r.join_success_title_zh:n==="pt"&&(r!=null&&r.join_success_title_pt)?r.join_success_title_pt:r!=null&&r.join_success_title_en?r.join_success_title_en:s("joinUs.successTitle")},k=()=>{const n=u.language;return n==="zh"&&(r!=null&&r.join_success_message_zh)?r.join_success_message_zh:n==="pt"&&(r!=null&&r.join_success_message_pt)?r.join_success_message_pt:r!=null&&r.join_success_message_en?r.join_success_message_en:s("joinUs.successMessage")},g=(r==null?void 0:r.join_contact_phone)||"968815050",h=r==null?void 0:r.contact_email;return F?e.jsx("div",{className:"min-h-screen pt-20 pb-12 px-4 bg-secondary/20",children:e.jsx("div",{className:"container mx-auto max-w-2xl",children:e.jsx(N,{className:"border-primary",children:e.jsxs(v,{className:"pt-12 pb-12 text-center",children:[e.jsx(Z,{className:"w-16 h-16 text-primary mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-4",children:P()}),e.jsx("p",{className:"text-muted-foreground mb-4 max-w-md mx-auto",children:k()}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4 mb-6",children:[e.jsxs("a",{href:`tel:${g}`,className:"flex items-center gap-2 text-primary font-semibold hover:underline",children:[e.jsx(D,{className:"w-5 h-5"}),e.jsx("span",{children:g})]}),h&&e.jsxs("a",{href:`mailto:${h}`,className:"flex items-center gap-2 text-primary font-semibold hover:underline",children:[e.jsx($,{className:"w-5 h-5"}),e.jsx("span",{children:h})]})]}),e.jsx(C,{onClick:()=>U(!1),children:s("joinUs.submitAnother")})]})})})}):e.jsx("div",{className:"min-h-screen pt-4 pb-12 px-4 bg-secondary/20",children:e.jsx("div",{className:"container mx-auto max-w-3xl",children:e.jsxs(N,{children:[e.jsxs(q,{className:"text-center space-y-2",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(A,{className:"w-12 h-12 text-primary"})}),e.jsx(B,{className:"text-3xl font-bold",children:s("joinUs.title")}),e.jsx(O,{className:"text-base",children:s("joinUs.description")})]}),e.jsx(v,{children:e.jsx(X,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(T),className:"space-y-6",children:[e.jsx(i,{control:a.control,name:"name",render:({field:n})=>e.jsxs(o,{children:[e.jsx(c,{children:s("joinUs.name")}),e.jsx(m,{children:e.jsx(j,{placeholder:s("joinUs.namePlaceholder"),...n})}),e.jsx(d,{})]})}),e.jsx(i,{control:a.control,name:"email",render:({field:n})=>e.jsxs(o,{children:[e.jsx(c,{children:s("joinUs.email")}),e.jsx(m,{children:e.jsx(j,{type:"email",placeholder:s("joinUs.emailPlaceholder"),...n})}),e.jsx(d,{})]})}),e.jsx(i,{control:a.control,name:"phone",render:({field:n})=>e.jsxs(o,{children:[e.jsx(c,{children:s("joinUs.phone")}),e.jsx(m,{children:e.jsx(j,{type:"tel",placeholder:s("joinUs.phonePlaceholder"),...n})}),e.jsx(d,{})]})}),e.jsx(i,{control:a.control,name:"restaurant_name",render:({field:n})=>e.jsxs(o,{children:[e.jsx(c,{children:s("joinUs.restaurantName")}),e.jsx(m,{children:e.jsx(j,{placeholder:s("joinUs.restaurantNamePlaceholder"),...n})}),e.jsx(d,{})]})}),e.jsx(i,{control:a.control,name:"restaurant_address",render:({field:n})=>e.jsxs(o,{children:[e.jsx(c,{children:s("joinUs.restaurantAddress")}),e.jsx(m,{children:e.jsx(j,{placeholder:s("joinUs.restaurantAddressPlaceholder"),...n})}),e.jsx(d,{})]})}),e.jsx(i,{control:a.control,name:"features_selected",render:()=>e.jsxs(o,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(c,{children:s("joinUs.featuresNeeded")}),e.jsx(Y,{children:s("joinUs.featuresDescription")})]}),w.map(n=>e.jsx(i,{control:a.control,name:"features_selected",render:({field:t})=>{var l;return e.jsxs(o,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(m,{children:e.jsx(W,{checked:(l=t.value)==null?void 0:l.includes(n),onCheckedChange:z=>{var y;return z?t.onChange([...t.value,n]):t.onChange((y=t.value)==null?void 0:y.filter(E=>E!==n))}})}),e.jsx(c,{className:"font-normal cursor-pointer",children:s(`joinUs.feature.${n}`)})]},n)}},n)),e.jsx(d,{})]})}),e.jsxs("div",{className:"text-xs text-muted-foreground text-center pb-4",children:[s("joinUs.consentText")," ",e.jsx(S,{to:"/privacy-policy",className:"text-primary hover:underline",children:s("joinUs.privacyPolicy")})," ",s("joinUs.and")," ",e.jsx(S,{to:"/terms-of-service",className:"text-primary hover:underline",children:s("joinUs.termsOfService")})]}),e.jsxs(C,{type:"submit",className:"w-full",size:"lg",disabled:_,children:[_&&e.jsx(H,{className:"mr-2 h-4 w-4 animate-spin"}),s("joinUs.submit")]})]})})})]})})})};export{ie as default};
