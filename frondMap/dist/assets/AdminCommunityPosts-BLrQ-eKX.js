import{p as re,r as n,j as e,bl as ne,be as ie,b7 as de,a_ as ce,c4 as k,bh as c,bH as _,bZ as T,a4 as F,bu as z,bj as me,ak as I,cG as oe,bp as xe,bg as he,aV as ue,bo as je,bF as ge,bI as pe,c8 as Ne,c1 as M}from"./vendor-react-BJ_Fufgb.js";import{B as i,C as g,E as p,I as fe,a2 as L,a3 as V,a4 as E,a5 as H,a6 as l,f as m,A as ve,i as be,j as we,k as ye,m as Ce,n as ke,p as Pe,o as Se,Q as Ae,R as De,T as _e,ab as o,ac as x,ad as h,ae as u,h as B,t as r}from"./index-BSqTIOKh.js";import{u as Te,a as Fe,b as ze}from"./useCommunityPosts-MVlSi4zz.js";import{u as Ie}from"./useLocalizedContent-Bk4lYsHC.js";import{P as Me}from"./PostManagementDialog-DePqy0o3.js";import{H as Le,p as Ve,I as Ee,J as He}from"./vendor-utils-Z4kpnli5.js";import"./vendor-i18n-jtdHZIRR.js";import"./vendor-editor-B1vH4T8i.js";import"./vendor-supabase-Dbipw1Nj.js";import"./separator-BXg5PdTN.js";import"./useActivities-DTcpAzU7.js";const Ke=()=>{const{t:a,i18n:O}=re(),{getLocalizedField:G}=Ie(),[P,Q]=n.useState(""),[N,R]=n.useState("all"),[f,U]=n.useState("all"),[S,A]=n.useState(null),[v,b]=n.useState(null),[j,D]=n.useState("grid"),{data:d,isLoading:J}=Te({status:N!=="all"?N:void 0,moderation_status:f!=="all"?f:void 0,search:P||void 0}),w=Fe(),W=ze(),X=()=>{switch(O.language){case"zh":return He;case"pt":return Ee;default:return Ve}},Z=s=>{switch(s){case"approved":return{label:a("admin.status.approved","已发布"),icon:k,className:"bg-emerald-500/10 text-emerald-600 border-emerald-500/20"};case"pending":return{label:a("admin.status.pending","待审核"),icon:c,className:"bg-amber-500/10 text-amber-600 border-amber-500/20"};case"rejected":return{label:a("admin.status.rejected","已拒绝"),icon:T,className:"bg-red-500/10 text-red-600 border-red-500/20"};case"hidden":return{label:a("admin.status.hidden","已隐藏"),icon:_,className:"bg-gray-500/10 text-gray-600 border-gray-500/20"};default:return{label:s,icon:M,className:"bg-gray-500/10 text-gray-600 border-gray-500/20"}}},q=s=>{switch(s){case"approved":return{label:a("admin.moderation.approved","通过"),icon:F,className:"text-emerald-600"};case"flagged":return{label:a("admin.moderation.flagged","标记"),icon:z,className:"text-orange-500"};case"pending":return{label:a("admin.moderation.pending","待审"),icon:c,className:"text-muted-foreground"};default:return{label:s,icon:M,className:"text-muted-foreground"}}},y=(s,t)=>{switch(t){case"approve":w.mutate({id:s.id,status:"approved"});break;case"hide":w.mutate({id:s.id,status:"hidden"});break;case"unhide":w.mutate({id:s.id,status:"approved"});break;case"delete":b(s);break}},K=()=>{v&&(W.mutate(v.id),b(null))},Y=s=>{const t=document.createElement("div");return t.innerHTML=s,t.textContent||t.innerText||""},$=({post:s})=>{const t=Z(s.status),C=q(s.moderation_status),se=t.icon,ae=C.icon;return e.jsx(g,{className:"group overflow-hidden hover:shadow-md transition-all duration-200 border-border/60",children:e.jsxs(p,{className:"p-0",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border/40",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(Ae,{className:"h-10 w-10 ring-2 ring-background shadow-sm",children:[e.jsx(De,{src:s.author?.avatar_url||void 0}),e.jsx(_e,{className:"bg-primary/10 text-primary font-medium",children:s.author?.display_name?.charAt(0)||"?"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:s.author?.display_name}),e.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(c,{className:"h-3 w-3"}),Le(new Date(s.created_at),{addSuffix:!0,locale:X()})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(o,{children:e.jsxs(x,{children:[e.jsx(h,{asChild:!0,children:e.jsx("div",{className:m("p-1.5 rounded-full",C.className),children:e.jsx(ae,{className:"h-3.5 w-3.5"})})}),e.jsx(u,{side:"left",children:e.jsx("p",{children:C.label})})]})})})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx("p",{className:"text-sm line-clamp-3 text-foreground/90",children:Y(s.content)}),(s.image_urls?.length>0||s.video_url)&&e.jsxs("div",{className:"flex items-center gap-3",children:[s.image_urls&&s.image_urls.length>0&&e.jsxs("div",{className:"flex -space-x-2",children:[s.image_urls.slice(0,3).map((te,le)=>e.jsx("div",{className:"h-12 w-12 rounded-lg overflow-hidden border-2 border-background shadow-sm",children:e.jsx("img",{src:te,alt:"",className:"w-full h-full object-cover"})},le)),s.image_urls.length>3&&e.jsx("div",{className:"h-12 w-12 rounded-lg bg-muted/80 border-2 border-background flex items-center justify-center shadow-sm",children:e.jsxs("span",{className:"text-xs font-medium text-muted-foreground",children:["+",s.image_urls.length-3]})})]}),s.video_url&&e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground bg-muted/50 px-2 py-1 rounded-full",children:[e.jsx(oe,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:a("admin.communityPosts.hasVideo","视频")})]})]}),s.activity&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(xe,{className:"h-3.5 w-3.5 text-primary"}),e.jsx(B,{variant:"secondary",className:"text-xs font-normal",children:G(s.activity,"title")})]})]}),e.jsx("div",{className:"px-4 py-3 bg-muted/30 border-t border-border/40",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1 text-xs",children:[e.jsx(he,{className:"h-3.5 w-3.5"}),s.likes_count]}),e.jsxs("span",{className:"flex items-center gap-1 text-xs",children:[e.jsx(ue,{className:"h-3.5 w-3.5"}),s.comments_count]}),e.jsxs("span",{className:"flex items-center gap-1 text-xs",children:[e.jsx(je,{className:"h-3.5 w-3.5"}),s.shares_count]})]}),e.jsxs(B,{variant:"outline",className:m("text-xs border",t.className),children:[e.jsx(se,{className:"h-3 w-3 mr-1"}),t.label]})]})}),e.jsxs("div",{className:"flex items-center gap-1 p-2 border-t border-border/40 bg-background",children:[e.jsx(o,{children:e.jsxs(x,{children:[e.jsx(h,{asChild:!0,children:e.jsxs(i,{variant:"ghost",size:"sm",className:"flex-1 h-8 text-blue-600 hover:text-blue-700 hover:bg-blue-50",onClick:()=>A(s),children:[e.jsx(ge,{className:"h-4 w-4"}),e.jsx("span",{className:"ml-1.5 text-xs hidden sm:inline",children:a("common.details","详情")})]})}),e.jsx(u,{children:e.jsx("p",{children:a("common.viewDetails","查看详情")})})]})}),s.status==="pending"||s.status==="flagged"?e.jsx(o,{children:e.jsxs(x,{children:[e.jsx(h,{asChild:!0,children:e.jsxs(i,{variant:"ghost",size:"sm",className:"flex-1 h-8 text-emerald-600 hover:text-emerald-700 hover:bg-emerald-50",onClick:()=>y(s,"approve"),children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{className:"ml-1.5 text-xs hidden sm:inline",children:a("admin.action.approve","发布")})]})}),e.jsx(u,{children:e.jsx("p",{children:a("admin.action.approve","发布")})})]})}):null,e.jsx(o,{children:e.jsxs(x,{children:[e.jsx(h,{asChild:!0,children:e.jsx(i,{variant:"ghost",size:"sm",className:m("flex-1 h-8",s.status==="hidden"?"text-emerald-600 hover:text-emerald-700 hover:bg-emerald-50":"text-amber-600 hover:text-amber-700 hover:bg-amber-50"),onClick:()=>y(s,s.status==="hidden"?"unhide":"hide"),children:s.status==="hidden"?e.jsxs(e.Fragment,{children:[e.jsx(pe,{className:"h-4 w-4"}),e.jsx("span",{className:"ml-1.5 text-xs hidden sm:inline",children:a("admin.action.unhide","显示")})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"h-4 w-4"}),e.jsx("span",{className:"ml-1.5 text-xs hidden sm:inline",children:a("admin.action.hide","隐藏")})]})})}),e.jsx(u,{children:e.jsx("p",{children:s.status==="hidden"?a("admin.action.unhide","显示"):a("admin.action.hide","隐藏")})})]})}),e.jsx(o,{children:e.jsxs(x,{children:[e.jsx(h,{asChild:!0,children:e.jsx(i,{variant:"ghost",size:"sm",className:"flex-1 h-8 text-destructive hover:text-destructive hover:bg-destructive/10",onClick:()=>y(s,"delete"),children:e.jsx(I,{className:"h-4 w-4"})})}),e.jsx(u,{children:e.jsx("p",{children:a("common.delete","删除")})})]})})]})]})})},ee=()=>e.jsx(g,{className:"overflow-hidden",children:e.jsxs(p,{className:"p-0",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 border-b",children:[e.jsx(r,{className:"h-10 w-10 rounded-full"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{className:"h-4 w-24"}),e.jsx(r,{className:"h-3 w-16"})]})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx(r,{className:"h-4 w-full"}),e.jsx(r,{className:"h-4 w-3/4"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(r,{className:"h-12 w-12 rounded-lg"}),e.jsx(r,{className:"h-12 w-12 rounded-lg"})]})]}),e.jsx("div",{className:"px-4 py-3 bg-muted/30 border-t",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx(r,{className:"h-4 w-24"}),e.jsx(r,{className:"h-5 w-16 rounded-full"})]})})]})});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:a("admin.communityPosts.title","帖子管理")}),e.jsx("p",{className:"text-muted-foreground text-sm mt-1",children:a("admin.communityPosts.subtitle","管理和审核社区帖子")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{variant:j==="grid"?"secondary":"ghost",size:"icon",className:"h-9 w-9",onClick:()=>D("grid"),children:e.jsx(ne,{className:"h-4 w-4"})}),e.jsx(i,{variant:j==="list"?"secondary":"ghost",size:"icon",className:"h-9 w-9",onClick:()=>D("list"),children:e.jsx(ie,{className:"h-4 w-4"})})]})]}),e.jsx(g,{className:"border-border/60",children:e.jsx(p,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(de,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(fe,{placeholder:a("admin.communityPosts.searchPlaceholder","搜索内容..."),value:P,onChange:s=>Q(s.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4 text-muted-foreground hidden sm:block"}),e.jsxs(L,{value:N,onValueChange:R,children:[e.jsx(V,{className:"w-[140px]",children:e.jsx(E,{placeholder:a("admin.status.all","所有状态")})}),e.jsxs(H,{children:[e.jsx(l,{value:"all",children:a("admin.status.all","所有状态")}),e.jsx(l,{value:"approved",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-3.5 w-3.5 text-emerald-600"}),a("admin.status.approved","已发布")]})}),e.jsx(l,{value:"pending",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(c,{className:"h-3.5 w-3.5 text-amber-600"}),a("admin.status.pending","待审核")]})}),e.jsx(l,{value:"hidden",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-3.5 w-3.5 text-gray-500"}),a("admin.status.hidden","已隐藏")]})}),e.jsx(l,{value:"rejected",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-3.5 w-3.5 text-red-600"}),a("admin.status.rejected","已拒绝")]})})]})]}),e.jsxs(L,{value:f,onValueChange:U,children:[e.jsx(V,{className:"w-[130px]",children:e.jsx(E,{placeholder:a("admin.moderation.all","所有审核")})}),e.jsxs(H,{children:[e.jsx(l,{value:"all",children:a("admin.moderation.all","所有审核")}),e.jsx(l,{value:"pending",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(c,{className:"h-3.5 w-3.5 text-gray-500"}),a("admin.moderation.pending","待审")]})}),e.jsx(l,{value:"approved",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-3.5 w-3.5 text-emerald-600"}),a("admin.moderation.approved","通过")]})}),e.jsx(l,{value:"flagged",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-3.5 w-3.5 text-orange-500"}),a("admin.moderation.flagged","标记")]})})]})]})]})]})})}),d&&e.jsx("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:e.jsxs("span",{children:[a("admin.communityPosts.total","共")," ",d.length," ",a("admin.communityPosts.posts","篇帖子")]})}),J?e.jsx("div",{className:m("grid gap-4",j==="grid"?"grid-cols-1 md:grid-cols-2 lg:grid-cols-3":"grid-cols-1"),children:Array.from({length:6}).map((s,t)=>e.jsx(ee,{},t))}):d&&d.length>0?e.jsx("div",{className:m("grid gap-4",j==="grid"?"grid-cols-1 md:grid-cols-2 lg:grid-cols-3":"grid-cols-1"),children:d.map(s=>e.jsx($,{post:s},s.id))}):e.jsx(g,{className:"border-dashed",children:e.jsxs(p,{className:"py-16 text-center",children:[e.jsx("div",{className:"mx-auto w-16 h-16 rounded-full bg-muted flex items-center justify-center mb-4",children:e.jsx(me,{className:"h-8 w-8 text-muted-foreground"})}),e.jsx("h3",{className:"font-medium text-lg mb-1",children:a("admin.communityPosts.noPosts","暂无帖子")}),e.jsx("p",{className:"text-muted-foreground text-sm",children:a("admin.communityPosts.noPostsDesc","当前筛选条件下没有帖子")})]})}),e.jsx(Me,{post:S,open:!!S,onOpenChange:s=>!s&&A(null)}),e.jsx(ve,{open:!!v,onOpenChange:s=>!s&&b(null),children:e.jsxs(be,{children:[e.jsxs(we,{children:[e.jsxs(ye,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-5 w-5 text-destructive"}),a("common.confirmDelete","确认删除")]}),e.jsx(Ce,{children:a("admin.communityPosts.deleteWarning","删除后无法恢复，确定要删除这篇帖子吗？")})]}),e.jsxs(ke,{children:[e.jsx(Pe,{children:a("common.cancel","取消")}),e.jsx(Se,{onClick:K,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:a("common.delete","删除")})]})]})})]})};export{Ke as default};
//# sourceMappingURL=AdminCommunityPosts-BLrQ-eKX.js.map
