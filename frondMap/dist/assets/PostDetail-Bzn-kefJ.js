import{bA as d,p as y,u as f,q as h,r as o,j as e,aM as j,bT as c}from"./vendor-react-87iFmKFJ.js";import{s as v,h as p}from"./index-CH4FpCej.js";import{R as N,P as w}from"./RecipeDetailContent-CUySloKa.js";import C from"./RestaurantComments-9Mh7sxAt.js";import{k as P}from"./useCommunityPosts-Hwex2FMK.js";import{P as g}from"./PullToRefresh-BOMISILW.js";import"./vendor-i18n-AOdgFpXS.js";import"./vendor-editor-B1vH4T8i.js";import"./vendor-utils-vwQGbBim.js";import"./vendor-supabase-CQWbleDe.js";import"./carousel-DS7H_fh7.js";import"./useLocalizedContent-CFh79NZC.js";import"./TranslateButton-n7ikl_oX.js";import"./ShareDrawer-BdsC_cKT.js";import"./drawer-C6HbxCKk.js";import"./EditRecipeDialog-BvttCogK.js";import"./popover-pxVAyhDa.js";import"./useActivities-Cx4MTjAu.js";import"./useRestaurants-CuLkQhYp.js";import"./progress-Ud7m7MPX.js";import"./collapsible-DE4DVYv9.js";import"./useLoginRequired-NoLR-dKx.js";import"./separator-2WV3a7KV.js";import"./ImagePreviewModal-BqCHox3o.js";import"./ExternalLinkConfirmDialog-C5LyO7qi.js";import"./RecipeCookingMode-Brf7h4xI.js";import"./ReportDialog-DGTct1q2.js";import"./input-otp-uTF1jlLx.js";import"./useSensitiveWords-83Imo2zE.js";const ee=()=>{const{id:t}=d(),{t:i}=y(),a=f(),r=h(),{data:s,isLoading:u,error:l}=P(t||""),m=o.useRef(!1);o.useEffect(()=>{t&&s&&!m.current&&(m.current=!0,v.rpc("increment_post_views",{post_id:t}).then(({error:n})=>{n&&console.error("Failed to increment views:",n)}))},[t,s]);const x=o.useCallback(async()=>{r.removeQueries({queryKey:["community-post",t]}),r.removeQueries({queryKey:["comments",t]}),await Promise.all([r.invalidateQueries({queryKey:["community-post",t]}),r.invalidateQueries({queryKey:["comments",t]})])},[r,t]);return u?e.jsx("div",{className:"container max-w-2xl mx-auto py-6 px-4 flex justify-center",children:e.jsx(j,{className:"h-8 w-8 animate-spin"})}):l||!s?e.jsx("div",{className:"container max-w-2xl mx-auto py-6 px-4",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-muted-foreground",children:i("community.postNotFound","帖子不存在或已被删除")}),e.jsxs(p,{variant:"outline",className:"mt-4",onClick:()=>a("/community"),children:[e.jsx(c,{className:"h-4 w-4 mr-2"}),i("community.backToList","返回社区")]})]})}):e.jsx(g,{onRefresh:x,children:e.jsxs("div",{className:"container max-w-2xl mx-auto py-6 px-4",children:[e.jsxs(p,{variant:"ghost",size:"sm",className:"mb-4",onClick:()=>a("/community"),children:[e.jsx(c,{className:"h-4 w-4 mr-2"}),i("community.backToList","返回社区")]}),s.post_type==="recipe"?e.jsx(N,{post:s}):e.jsx(w,{post:s,showActions:!0,isDetailPage:!0}),e.jsx("div",{className:"mt-6",children:e.jsx(C,{targetId:s.id,targetType:"post"})})]})})};export{ee as default};
//# sourceMappingURL=PostDetail-Bzn-kefJ.js.map
