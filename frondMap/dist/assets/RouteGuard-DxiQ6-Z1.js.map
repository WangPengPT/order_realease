{"version":3,"file":"RouteGuard-DxiQ6-Z1.js","sources":["../../src/components/FeatureDisabledPage.tsx","../../src/components/RouteGuard.tsx"],"sourcesContent":["import { Link } from \"react-router-dom\";\r\nimport { Lock } from \"lucide-react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\nconst FeatureDisabledPage = () => {\r\n  const { t } = useTranslation();\r\n\r\n  return (\r\n    <div className=\"flex flex-col items-center justify-center min-h-[60vh] px-4 text-center\">\r\n      <div className=\"w-20 h-20 rounded-full bg-muted flex items-center justify-center mb-6\">\r\n        <Lock className=\"w-10 h-10 text-muted-foreground\" />\r\n      </div>\r\n      <h1 className=\"text-2xl font-bold mb-2\">\r\n        {t(\"common.featureDisabledTitle\", \"功能暂时关闭\")}\r\n      </h1>\r\n      <p className=\"text-muted-foreground mb-6 max-w-md\">\r\n        {t(\"common.featureDisabledDescription\", \"此功能目前不可用，请稍后再试或联系管理员了解更多信息。\")}\r\n      </p>\r\n      <Button asChild>\r\n        <Link to=\"/\">{t(\"common.backToHome\", \"返回首页\")}</Link>\r\n      </Button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FeatureDisabledPage;","import { ReactNode } from \"react\";\r\nimport { useLocation } from \"react-router-dom\";\r\nimport { useUserRole } from \"@/hooks/useUserRole\";\r\nimport { useNavigationSettings } from \"@/hooks/useNavigationSettings\";\r\nimport FeatureDisabledPage from \"./FeatureDisabledPage\";\r\n\r\ninterface RouteGuardProps {\r\n  children: ReactNode;\r\n}\r\n\r\nconst RouteGuard = ({ children }: RouteGuardProps) => {\r\n  const location = useLocation();\r\n  const { isAdmin } = useUserRole();\r\n  const { buttons, isLoading } = useNavigationSettings();\r\n\r\n  // Skip guard while loading to avoid flash\r\n  if (isLoading) {\r\n    return <>{children}</>;\r\n  }\r\n\r\n  // Check if current path matches a disabled button\r\n  const matchingButton = buttons?.find((btn) => {\r\n    // Exact match\r\n    if (btn.link === location.pathname) return true;\r\n    // Check for path prefix match (e.g., /community matches /community/123)\r\n    if (location.pathname.startsWith(btn.link + \"/\")) return true;\r\n    return false;\r\n  });\r\n\r\n  // If found a matching button that is disabled, and user is not admin\r\n  if (matchingButton && matchingButton.enabled === false && !isAdmin) {\r\n    return <FeatureDisabledPage />;\r\n  }\r\n\r\n  return <>{children}</>;\r\n};\r\n\r\nexport default RouteGuard;"],"names":["FeatureDisabledPage","useTranslation","jsxs","jsx","Lock","Button","Link","RouteGuard","children","location","useLocation","isAdmin","useUserRole","buttons","isLoading","useNavigationSettings","matchingButton","btn"],"mappings":"wTAKA,MAAMA,EAAsB,IAAM,CAC1B,KAAA,CAAE,GAAMC,IAGZ,OAAAC,EAAA,KAAC,MAAI,CAAA,UAAU,0EACb,SAAA,CAAAC,EAAAA,IAAC,OAAI,UAAU,wEACb,eAACC,EAAK,CAAA,UAAU,kCAAkC,CACpD,CAAA,QACC,KAAG,CAAA,UAAU,0BACX,SAAE,EAAA,8BAA+B,QAAQ,EAC5C,QACC,IAAE,CAAA,UAAU,sCACV,SAAE,EAAA,oCAAqC,6BAA6B,EACvE,EACCD,EAAA,IAAAE,EAAA,CAAO,QAAO,GACb,SAACF,EAAAA,IAAAG,EAAA,CAAK,GAAG,IAAK,SAAE,EAAA,oBAAqB,MAAM,CAAE,CAAA,EAC/C,CACF,CAAA,CAAA,CAEJ,ECdMC,EAAa,CAAC,CAAE,SAAAC,KAAgC,CACpD,MAAMC,EAAWC,IACX,CAAE,QAAAC,GAAYC,IACd,CAAE,QAAAC,EAAS,UAAAC,CAAU,EAAIC,EAAsB,EAGrD,GAAID,EACF,yBAAU,SAAAN,CAAS,CAAA,EAIrB,MAAMQ,EAAiBH,GAAS,KAAMI,GAEhC,GAAAA,EAAI,OAASR,EAAS,UAEtBA,EAAS,SAAS,WAAWQ,EAAI,KAAO,GAAG,EAEhD,EAGD,OAAID,GAAkBA,EAAe,UAAY,IAAS,CAACL,QACjDX,EAAoB,CAAA,CAAA,oBAGpB,SAAAQ,CAAS,CAAA,CACrB"}