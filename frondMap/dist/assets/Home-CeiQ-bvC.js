import{j as e}from"./vendor-ui-DAmPMpEA.js";import{u as ge,l as be,D as ye,a as ve,b as je,c as we,S as Ne,d as T,U as ke,L as se,I as _e,B as q,e as Se,C as Ce,f as oe,H as Ie,M as Te,g as Re}from"./index-BcrfGQEh.js";import{u as De,r,L as U}from"./vendor-react-iAJ0IrSD.js";import{m as ze,i as Ee,a as Me,b as le}from"./externalLinks-DoJcn4fI.js";import{u as Oe,S as Pe}from"./useHomepageTemplates-CF-EaV3W.js";import{u as Le}from"./usePageView-CqD0tuwr.js";import{u as ie}from"./vendor-i18n-DxKeo2S1.js";import{M as ne}from"./message-circle-C4oJUb2D.js";import{R as $e}from"./refresh-cw-BI_CDHcK.js";import{u as Be}from"./vendor-query-BlSVl3IQ.js";import{S as Ve}from"./shopping-bag-C9l5MTo_.js";import{C as Ae}from"./calendar-check-iX4yTU-_.js";import{A as We}from"./arrow-right-D-aBf8aw.js";import{S as re}from"./search-DYCHfSrp.js";import{S as He}from"./star-DqKRai6M.js";import{D as Fe}from"./download-cx2oDCVf.js";import"./vendor-charts-Bz7hPIBd.js";import"./vendor-supabase-KNAP0qdW.js";const Xe="/assets/google-play-badge-new-BAXiFmDF.png",Ye="/assets/app-store-badge-C-eOGvqu.svg",qe="https://tzdgqhwyzsxkxnncgzap.supabase.co",ae="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR6ZGdxaHd5enN4a3hubmNnemFwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM2NTg2ODgsImV4cCI6MjA3OTIzNDY4OH0.D76C4OkjQVWyMxtjjdOofpD8X_hEEoTtrXHqi4XSYUw",Ue=({open:t,onOpenChange:u})=>{const{i18n:i}=ie(),a=De(),{settings:j}=ge(),h=j?.logo_url||be,[g,k]=r.useState(""),[I,D]=r.useState([]),[x,z]=r.useState(!1),[_,M]=r.useState(null),w=r.useRef(null),B=r.useRef(null),p=r.useRef(null);r.useEffect(()=>{t&&!_&&navigator.geolocation?.getCurrentPosition(s=>{M({lat:s.coords.latitude,lng:s.coords.longitude})},s=>{console.log("Unable to get user location:",s.message)},{enableHighAccuracy:!1,timeout:5e3,maximumAge:3e5})},[t,_]),r.useEffect(()=>{p.current?.scrollIntoView({behavior:"smooth"})},[I]);const R=async()=>{if(!g.trim()||x)return;const s={id:Date.now().toString(),role:"user",content:g.trim()},N=(Date.now()+1).toString(),o={id:N,role:"assistant",content:"",isStreaming:!0};D(c=>[...c,s,o]),k(""),z(!0),w.current&&w.current.abort(),w.current=new AbortController;try{const c=await fetch(`${qe}/functions/v1/ask-xiaoxiong`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ae}`,apikey:ae},body:JSON.stringify({text:s.content,stream:!0,lat:_?.lat,lng:_?.lng}),signal:w.current.signal});if(!c.ok)throw new Error(`Request failed with status: ${c.status}`);if(!c.body)throw new Error("No response body");const l=c.body.getReader(),f=new TextDecoder;let b="";for(;;){const{done:L,value:$}=await l.read();if(L)break;const d=f.decode($,{stream:!0});b+=d;let m=b;m.startsWith('"')&&(m=m.slice(1)),m.endsWith('"')&&(m=m.slice(0,-1)),m=m.replace(/\\n/g,`
`),D(E=>E.map(C=>C.id===N?{...C,content:m}:C))}let y=b;y.startsWith('"')&&(y=y.slice(1)),y.endsWith('"')&&(y=y.slice(0,-1)),y=y.replace(/\\n/g,`
`),D(L=>L.map($=>$.id===N?{...$,content:y,isStreaming:!1}:$))}catch(c){if(c instanceof Error&&c.name==="AbortError"){console.log("Request aborted");return}console.error("Ask API error:",c);const l=i.language==="zh"?"抱歉，暂时无法获取结果，请稍后再试":i.language==="pt"?"Desculpe, não foi possível obter resultados. Tente novamente mais tarde.":"Sorry, unable to get results. Please try again later.";D(f=>f.map(b=>b.id===N?{...b,content:l,isStreaming:!1}:b))}finally{z(!1)}},V=s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),R())},O=()=>{w.current&&w.current.abort(),u(!1)},P=s=>{O(),a(s)},n=s=>{const N=/\[([^\]]+)\]\(([^)]+)\)/g,o=[];let c=0,l,f=0;for(;(l=N.exec(s))!==null;){l.index>c&&o.push(e.jsx("span",{children:s.slice(c,l.index)},f++));const b=l[1],y=l[2];y.startsWith("/")?o.push(e.jsx("button",{onClick:()=>P(y),className:"text-primary hover:underline font-medium cursor-pointer",children:b},f++)):o.push(e.jsx("a",{href:y,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline font-medium",children:b},f++)),c=l.index+l[0].length}return c<s.length&&o.push(e.jsx("span",{children:s.slice(c)},f++)),o.length>0?o:[e.jsx("span",{children:s},"0")]},S=s=>s.replace(/\*\*(.*?)\*\*/g,"$1"),A=(s,N=20)=>s.length<=N?s:s.slice(0,N)+"...",W=(s,N)=>{const o=f=>f.split("|").slice(1,-1).map(b=>S(b.trim())),c=o(s[0]),l=s.slice(2).map(o);return e.jsx("div",{className:"overflow-x-auto my-2 max-w-full",children:e.jsxs("table",{className:"w-full text-xs border border-border rounded-md overflow-hidden table-fixed",children:[e.jsx("thead",{className:"bg-muted/60",children:e.jsx("tr",{children:c.map((f,b)=>e.jsx("th",{className:"px-2 py-2 text-left font-semibold border-b border-border truncate max-w-[100px]",title:f,children:n(A(f,15))},b))})}),e.jsx("tbody",{children:l.map((f,b)=>e.jsx("tr",{className:"border-b border-border last:border-0 hover:bg-muted/30 transition-colors",children:f.map((y,L)=>e.jsx("td",{className:"px-2 py-2 truncate max-w-[100px]",title:y,children:n(A(y,18))},L))},b))})]})},N)},H=s=>{const N=s.split(`
`),o=[];let c=0;for(;c<N.length;){const l=N[c];if(l.trim().startsWith("|")&&l.split("|").length>2){const f=[];for(;c<N.length&&N[c].trim().startsWith("|");)f.push(N[c]),c++;f.length>=2&&o.push(W(f,o.length));continue}if(l.startsWith("### "))o.push(e.jsx("h3",{className:"text-base font-semibold mt-3 mb-1",children:n(l.slice(4))},o.length));else if(l.startsWith("## "))o.push(e.jsx("h2",{className:"text-lg font-bold mt-4 mb-2",children:n(l.slice(3))},o.length));else if(l.startsWith("# "))o.push(e.jsx("h1",{className:"text-xl font-bold mt-4 mb-2",children:n(l.slice(2))},o.length));else if(l.includes("**")){const f=l.split(/\*\*(.*?)\*\*/g);o.push(e.jsx("p",{className:"mb-1 leading-relaxed",children:f.map((b,y)=>y%2===1?e.jsx("strong",{className:"font-semibold",children:n(b)},y):n(b))},o.length))}else l.startsWith("- ")||l.startsWith("* ")?o.push(e.jsx("li",{className:"ml-4 mb-0.5 list-disc",children:n(l.slice(2))},o.length)):/^\d+\.\s/.test(l)?o.push(e.jsx("li",{className:"ml-4 mb-0.5 list-decimal",children:n(l.replace(/^\d+\.\s/,""))},o.length)):l.match(/^[-*_]{3,}$/)?o.push(e.jsx("hr",{className:"my-3 border-border"},o.length)):l.trim()===""?o.push(e.jsx("div",{className:"h-1"},o.length)):o.push(e.jsx("p",{className:"mb-1 leading-relaxed",children:n(l)},o.length));c++}return o},F=()=>i.language==="zh"?"和小熊聊聊":i.language==="pt"?"Converse com Xiaoxiong":"Chat with Xiaoxiong",v=()=>i.language==="zh"?"输入你的想法...":i.language==="pt"?"Digite sua ideia...":"Type your idea...",J=()=>i.language==="zh"?"你好！我是小熊，告诉我你想吃什么，我来帮你推荐餐厅！":i.language==="pt"?"Olá! Eu sou o Xiaoxiong, me diga o que você quer comer e eu vou te ajudar a encontrar restaurantes!":"Hi! I'm Xiaoxiong, tell me what you want to eat and I'll help you find restaurants!";return e.jsx(ye,{open:t,onOpenChange:O,children:e.jsxs(ve,{className:"w-full h-full max-w-full max-h-full sm:max-w-lg sm:h-[70vh] sm:max-h-[70vh] sm:rounded-lg rounded-none flex flex-col p-0 gap-0 overflow-hidden",children:[e.jsx(je,{className:"px-4 py-3 border-b shrink-0 bg-primary/5",children:e.jsxs(we,{className:"flex items-center gap-2 text-base",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:h,alt:"Logo",className:"w-6 h-6 object-contain"})}),F()]})}),e.jsx(Ne,{className:"flex-1 h-0",ref:B,children:e.jsxs("div",{className:"p-4 space-y-4",children:[I.length===0&&e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center shrink-0",children:e.jsx(ne,{className:"w-4 h-4 text-primary"})}),e.jsx("div",{className:"flex-1 bg-muted/50 rounded-2xl rounded-tl-sm px-4 py-3 text-sm",children:J()})]}),I.map(s=>e.jsxs("div",{className:T("flex gap-3",s.role==="user"&&"flex-row-reverse"),children:[e.jsx("div",{className:T("w-8 h-8 rounded-full flex items-center justify-center shrink-0",s.role==="user"?"bg-primary text-primary-foreground":"bg-primary/10"),children:s.role==="user"?e.jsx(ke,{className:"h-4 w-4"}):e.jsx("img",{src:h,alt:"Logo",className:"w-6 h-6 object-contain"})}),e.jsx("div",{className:T("flex-1 max-w-[85%] rounded-2xl px-4 py-3 text-sm",s.role==="user"?"bg-primary text-primary-foreground rounded-tr-sm":"bg-muted/50 rounded-tl-sm"),children:s.role==="assistant"?e.jsxs(e.Fragment,{children:[s.content?e.jsx("div",{className:"prose-sm",children:H(s.content)}):e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(se,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:i.language==="zh"?"思考中...":i.language==="pt"?"Pensando...":"Thinking..."})]}),s.isStreaming&&s.content&&e.jsx("span",{className:"inline-block w-1.5 h-4 bg-primary/50 animate-pulse ml-0.5 align-middle"})]}):s.content})]},s.id)),e.jsx("div",{ref:p})]})}),e.jsx("div",{className:"p-3 border-t bg-background shrink-0",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_e,{value:g,onChange:s=>k(s.target.value),onKeyDown:V,placeholder:v(),disabled:x,className:"flex-1 rounded-full bg-muted/50 border-0 focus-visible:ring-1",autoFocus:!0}),e.jsx(q,{onClick:R,disabled:!g.trim()||x,size:"icon",className:"shrink-0 rounded-full",children:x?e.jsx(se,{className:"h-4 w-4 animate-spin"}):e.jsx(Se,{className:"h-4 w-4"})})]})})]})})};function Je({onRefresh:t,threshold:u=80,maxPull:i=120}){const[a,j]=r.useState(!1),[h,g]=r.useState(!1),[k,I]=r.useState(0),D=r.useRef(0),x=r.useRef(0),z=r.useRef(null),_=r.useCallback(p=>{(window.scrollY||document.documentElement.scrollTop)>5||(D.current=p.touches[0].clientY,j(!0))},[]),M=r.useCallback(p=>{if(!a||h)return;x.current=p.touches[0].clientY;const R=x.current-D.current;if(R<0){I(0);return}R>10&&p.preventDefault();const O=Math.min(R*.5,i);I(O)},[a,h,i]),w=r.useCallback(async()=>{if(a)if(j(!1),k>=u&&!h){g(!0),I(u);try{await t()}finally{g(!1),I(0)}}else I(0)},[a,k,u,h,t]);r.useEffect(()=>{const p=z.current;if(p)return p.addEventListener("touchstart",_,{passive:!0}),p.addEventListener("touchmove",M,{passive:!1}),p.addEventListener("touchend",w,{passive:!0}),()=>{p.removeEventListener("touchstart",_),p.removeEventListener("touchmove",M),p.removeEventListener("touchend",w)}},[_,M,w]);const B=Math.min(k/u,1);return{containerRef:z,isPulling:a,isRefreshing:h,pullDistance:k,progress:B}}function Ge({children:t,onRefresh:u,className:i}){const{containerRef:a,isRefreshing:j,pullDistance:h,progress:g}=Je({onRefresh:u,threshold:80,maxPull:120});return e.jsxs("div",{ref:a,className:T("relative",i),children:[e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 z-50 flex items-center justify-center transition-opacity duration-200 pointer-events-none",style:{top:Math.max(h-50,8),opacity:h>20?1:0},children:e.jsx("div",{className:T("w-10 h-10 rounded-full bg-background/90 backdrop-blur-sm shadow-lg flex items-center justify-center border border-border/50",j&&"animate-pulse"),children:e.jsx($e,{className:T("w-5 h-5 text-primary transition-transform duration-200",j&&"animate-spin"),style:{transform:j?void 0:`rotate(${g*360}deg)`}})})}),e.jsx("div",{style:{transform:h>0?`translateY(${h}px)`:void 0,transition:h===0?"transform 0.3s ease-out":void 0},children:t})]})}const Z="/images/sushi-ramen-hero.jpg",ce="/images/sushi-ramen-mobile.jpg",de=r.memo(({stats:t,t:u})=>e.jsx("div",{className:"absolute top-16 sm:top-20 left-3 z-20",children:e.jsxs("div",{className:"gap-4 w-fit flex-col flex items-start justify-start",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm text-white/90 drop-shadow-md",children:u("home.stats.delivery")}),e.jsx("span",{className:"font-bold text-white text-sm drop-shadow-md",children:t.order_count})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"w-4 h-4 text-accent"}),e.jsx("span",{className:"text-sm text-white/90 drop-shadow-md",children:u("home.stats.reservation")}),e.jsx("span",{className:"font-bold text-white text-sm drop-shadow-md",children:t.reserve_count})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl sm:text-2xl font-bold text-white drop-shadow-md",children:u("home.hero.brandName")}),e.jsx("img",{src:ze,alt:"map icon",width:32,height:32,loading:"eager",decoding:"async",className:"w-7 sm:w-8 h-7 sm:h-8 object-contain flex-shrink-0"})]})]})}));de.displayName="StatsDisplay";const Y=r.memo(({to:t,Icon:u,title:i,desc:a,iconBg:j,iconColor:h,hoverBorderColor:g})=>e.jsx(U,{to:t,children:e.jsxs(Ce,{className:`group p-6 sm:p-8 border-border/50 ${g} transition-all hover:shadow-large cursor-pointer h-full`,children:[e.jsx("div",{className:`w-14 sm:w-16 h-14 sm:h-16 rounded-2xl ${j} flex items-center justify-center mb-4 sm:mb-6 group-hover:scale-110 transition-transform`,children:e.jsx(u,{className:`w-7 sm:w-8 h-7 sm:h-8 ${h}`})}),e.jsx("h3",{className:"text-xl sm:text-2xl font-semibold mb-2 sm:mb-3 text-card-foreground",children:i}),e.jsxs("p",{className:"text-sm sm:text-base text-muted-foreground leading-relaxed flex items-center gap-2",children:[a,e.jsx(We,{className:"w-4 h-4 flex-shrink-0 group-hover:translate-x-1 transition-transform"})]})]})}));Y.displayName="FeatureCard";const Ke=()=>{const t=window.innerWidth<640,u=window.innerWidth>=1024,i=navigator.connection,a=window.Capacitor,j=Ee(),h=Me(),g=le(),k=navigator.userAgent;return console.log("[LightweightMode] Detection:",{isCapacitorApp:j,isInWebView:h,isIOSDevice:g,hasCapacitor:!!a,capacitorDetails:a?{isNativePlatform:a.isNativePlatform,isNative:a.isNative,platform:a.getPlatform?.()}:null,userAgent:k.substring(0,150),hasSafari:/Safari\//.test(k),hasVersion:/Version\/[\d.]+/.test(k),isStandalone:window.navigator.standalone===!0}),u?!!i?.saveData:h&&!j?(console.log("[LightweightMode] WebView detected (not Capacitor), using lightweight mode"),!0):i&&(i.saveData||i.effectiveType==="2g"||i.effectiveType==="slow-2g")||t&&navigator.deviceMemory&&navigator.deviceMemory<2?!0:(console.log("[LightweightMode] Normal mode, videos enabled for",g?"iOS":"non-iOS","device"),!1)},ue=r.memo(({template:t,isActive:u,currentLang:i,t:a,onContentReady:j,onAskXiaoxiong:h})=>{const[g,k]=r.useState({}),[I,D]=r.useState({}),[x,z]=r.useState({}),[_,M]=r.useState({mobile:!0,tablet:!0,desktop:!0}),[w,B]=r.useState(!1),p=Ke(),R=r.useRef(null),V=r.useRef(null),O=r.useRef(null),P=d=>t[`${d}${i==="zh"?"_zh":i==="pt"?"_pt":"_en"}`]||"",n=()=>window.innerWidth<640?"mobile":window.innerWidth<1024?"tablet":"desktop",S=()=>{const d=n();return d==="mobile"&&t.mobile_overlay_opacity!==null?t.mobile_overlay_opacity:d==="tablet"&&t.tablet_overlay_opacity!==null?t.tablet_overlay_opacity:d==="desktop"&&t.desktop_overlay_opacity!==null?t.desktop_overlay_opacity:t.overlay_opacity??30},A=()=>{const d=S(),m=t.overlay_gradient_direction||"to-b",E=(X,fe)=>X==null?fe/100:X>1?X/100:X,C=d>1?d/100:d,ee=E(t.overlay_gradient_from_opacity,30)*C,G=E(t.overlay_gradient_via_opacity,25)*C,K=E(t.overlay_gradient_to_opacity,40)*C,me={"to-t":"to top","to-b":"to bottom","to-l":"to left","to-r":"to right","to-tl":"to top left","to-tr":"to top right","to-bl":"to bottom left","to-br":"to bottom right"}[m]||"to bottom",Q={black:"0, 0, 0",white:"255, 255, 255",background:"0, 0, 0",foreground:"255, 255, 255",primary:"1, 100, 80",secondary:"240, 240, 240"},he=Q[t.overlay_gradient_from||"black"]||"0, 0, 0",xe=Q[t.overlay_gradient_via||"black"]||"0, 0, 0",pe=Q[t.overlay_gradient_to||"black"]||"0, 0, 0";return{background:`linear-gradient(${me}, rgba(${he}, ${ee}), rgba(${xe}, ${G}), rgba(${pe}, ${K}))`}},W=t.mobile_image_url||ce,H=t.tablet_image_url||t.desktop_image_url||Z,F=t.desktop_image_url||Z,v=t.background_blur||0,J=t.desktop_media_type||t.media_type||"image",s=t.tablet_media_type||t.media_type||"image",N=t.mobile_media_type||t.media_type||"image",o=J==="video"&&!p,c=s==="video"&&!p,l=N==="video"&&!p,f=l?t.mobile_video_url:null,b=c?t.tablet_video_url||t.desktop_video_url:null,y=o?t.desktop_video_url:null;r.useEffect(()=>{const d=n(),m=d==="mobile"?W:d==="tablet"?H:F;if(m){const E=new Image;E.onload=()=>{k(C=>({...C,[d]:!0})),M(C=>({...C,[d]:!0})),u&&(j?.(),setTimeout(()=>B(!0),100))},E.src=m}},[W,H,F,u,j]),r.useEffect(()=>{u&&g[n()]&&B(!0)},[u,g]);const L=d=>{D(m=>({...m,[d]:!0}))},$=(d,m)=>{console.error(`[HeroSlide] Video error on ${d}:`,m),z(E=>({...E,[d]:!0}))};return r.useEffect(()=>{if(!w||!u||!le())return;const m=n(),C=(m==="mobile"?R:m==="tablet"?V:O).current;if(!C)return;const G=setTimeout(async()=>{try{C.muted=!0,C.playsInline=!0,C.setAttribute("webkit-playsinline","true"),await C.play(),console.log(`[HeroSlide] iOS video play successful on ${m}`)}catch(K){console.error(`[HeroSlide] iOS video play failed on ${m}:`,K),z(te=>({...te,[m]:!0}))}},150);return()=>clearTimeout(G)},[w,u]),e.jsxs("div",{className:T("absolute inset-0 w-full h-full transition-opacity duration-1000",u?"opacity-100 z-10":"opacity-0 z-0"),children:[e.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[e.jsxs("div",{className:"absolute inset-0 w-full h-full sm:hidden",children:[!_.mobile&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),l&&f?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:W,alt:"Background",className:T("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",I.mobile&&!x.mobile?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:v>0?`blur(${v}px)`:void 0}}),w&&!x.mobile&&e.jsx("video",{ref:R,src:f,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>L("mobile"),onError:d=>$("mobile",d),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:v>0?`blur(${v}px)`:void 0}})]}):e.jsx("img",{src:W,alt:"Background",className:T("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",_.mobile?"opacity-100":"opacity-0"),style:{filter:v>0?`blur(${v}px)`:void 0}})]}),e.jsxs("div",{className:"absolute inset-0 w-full h-full hidden sm:block lg:hidden",children:[!_.tablet&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),c&&b?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:H,alt:"Background",className:T("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",I.tablet&&!x.tablet?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:v>0?`blur(${v}px)`:void 0}}),w&&!x.tablet&&e.jsx("video",{ref:V,src:b,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>L("tablet"),onError:d=>$("tablet",d),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:v>0?`blur(${v}px)`:void 0}})]}):e.jsx("img",{src:H,alt:"Background",className:T("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",_.tablet?"opacity-100":"opacity-0"),style:{filter:v>0?`blur(${v}px)`:void 0}})]}),e.jsxs("div",{className:"absolute inset-0 w-full h-full hidden lg:block",children:[!_.desktop&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),o&&y?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:F,alt:"Background",className:T("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",I.desktop&&!x.desktop?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:v>0?`blur(${v}px)`:void 0}}),w&&!x.desktop&&e.jsx("video",{ref:O,src:y,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>L("desktop"),onError:d=>$("desktop",d),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:v>0?`blur(${v}px)`:void 0}})]}):e.jsx("img",{src:F,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:T("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",_.desktop?"opacity-100":"opacity-0"),style:{filter:v>0?`blur(${v}px)`:void 0}})]}),e.jsx("div",{className:"absolute inset-0 w-full h-full",style:A()})]}),e.jsx("div",{className:"relative z-10 container mx-auto px-4 sm:px-6 flex items-center min-h-screen",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center space-y-4 sm:space-y-8 animate-fade-in w-full",children:[t.subtitle_button_text_zh&&e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:h,className:"group flex items-center gap-3 bg-white/95 backdrop-blur-sm text-muted-foreground px-4 sm:px-6 py-3 sm:py-4 rounded-full shadow-lg hover:shadow-2xl hover:bg-white transition-all duration-300 cursor-text border border-border/20",children:[e.jsx(ne,{className:"w-5 h-5 text-primary/70 group-hover:text-primary transition-colors"}),e.jsx("span",{className:"text-sm sm:text-base text-muted-foreground/80 group-hover:text-muted-foreground transition-colors",children:P("subtitle_button_text")||a("home.hero.subtitle")}),e.jsx(re,{className:"w-4 h-4 text-muted-foreground/50 ml-2"})]})}),e.jsx("h1",{className:"text-3xl sm:text-5xl md:text-7xl font-bold text-white leading-tight px-4 drop-shadow-[0_2px_8px_rgba(0,0,0,0.8)]",children:P("title")||a("home.hero.title")}),e.jsx("p",{className:"text-sm sm:text-xl md:text-2xl text-white/95 max-w-2xl mx-auto px-4 drop-shadow-[0_2px_6px_rgba(0,0,0,0.7)]",children:P("description")||a("home.hero.description")}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4 justify-center pt-2 sm:pt-4 px-4",children:[e.jsx(q,{size:"lg",asChild:!0,className:"text-base sm:text-lg shadow-lg hover:shadow-2xl hover:scale-105 transition-all w-full sm:w-auto",children:e.jsxs(U,{to:t.primary_button_link||"/restaurants",children:[e.jsx(re,{className:"mr-2 w-4 sm:w-5 h-4 sm:h-5"}),P("primary_button_text")||a("home.hero.exploreBtn")]})}),e.jsx(q,{size:"lg",variant:"outline",asChild:!0,className:"text-base sm:text-lg w-full sm:w-auto backdrop-blur-sm hover:border-transparent hover:scale-105 transition-all",children:e.jsxs(U,{to:t.secondary_button_link||"/activities",children:[e.jsx(oe,{className:"mr-2 w-4 sm:w-5 h-4 sm:h-5"}),P("secondary_button_text")||a("home.hero.activitiesBtn")]})})]})]})})]})});ue.displayName="HeroSlide";const ft=()=>{const{t,i18n:u}=ie(),i=Be(),{data:a,isLoading:j,refetch:h}=Oe(),[g,k]=r.useState(0),[I,D]=r.useState(null),x=r.useRef(null),[z,_]=r.useState(!1),[M,w]=r.useState(!1),B=r.useCallback(()=>{_(!0)},[]);Le({pageType:"home"});const p=r.useCallback(async()=>{try{const S=await(await fetch("https://v.xiaoxiong.pt/api/get_info")).json();S&&D({order_count:S.order_count||0,reserve_count:S.reserve_count||0})}catch(n){console.error("Failed to fetch stats:",n)}},[]);r.useEffect(()=>{p()},[p]);const R=r.useCallback(async()=>{await Promise.all([h(),p(),i.invalidateQueries({queryKey:["restaurants"]}),i.invalidateQueries({queryKey:["activities"]})])},[h,p,i]);r.useEffect(()=>{if(!a||a.length<=1)return;const S=a[g]?.duration||5e3;return x.current=setTimeout(()=>{k(A=>(A+1)%a.length)},S),()=>{x.current&&clearTimeout(x.current)}},[a,g]);const V=r.useCallback(n=>{x.current&&clearTimeout(x.current),k(n)},[]);r.useCallback(()=>{a&&(x.current&&clearTimeout(x.current),k(n=>(n-1+a.length)%a.length))},[a]),r.useCallback(()=>{a&&(x.current&&clearTimeout(x.current),k(n=>(n+1)%a.length))},[a]);const O=u.language,P=a&&a.length>1;return e.jsx(Ge,{onRefresh:R,children:e.jsxs("div",{className:"min-h-screen",children:[e.jsxs("section",{className:"relative h-screen flex items-start overflow-hidden bg-background",children:[I&&e.jsx(de,{stats:I,t}),e.jsx("div",{className:T("absolute inset-0 w-full h-full transition-opacity duration-500",z?"opacity-100":"opacity-0"),children:a?.map((n,S)=>e.jsx(ue,{template:n,isActive:S===g,currentLang:O,t,onContentReady:S===0?B:void 0,onAskXiaoxiong:()=>w(!0)},n.id))}),e.jsx("div",{className:T("absolute inset-0 w-full h-full z-20 transition-opacity duration-500",j||!z?"opacity-100":"opacity-0 pointer-events-none"),children:e.jsx(Ie,{})}),!j&&(!a||a.length===0)&&e.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[e.jsx("img",{src:ce,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:"absolute inset-0 w-full h-full object-cover object-center sm:hidden"}),e.jsx("img",{src:Z,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:"absolute inset-0 w-full h-full object-cover object-center hidden sm:block"}),e.jsx("div",{className:"absolute inset-0 w-full h-full bg-gradient-to-b from-black/30 via-black/25 to-black/40"}),e.jsx("div",{className:"relative z-10 container mx-auto px-4 sm:px-6 flex items-center min-h-screen",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center space-y-4 sm:space-y-8 animate-fade-in w-full",children:[e.jsx("h1",{className:"text-3xl sm:text-5xl md:text-7xl font-bold text-white leading-tight px-4 drop-shadow-[0_2px_8px_rgba(0,0,0,0.8)]",children:t("home.hero.title")}),e.jsx("p",{className:"text-sm sm:text-xl md:text-2xl text-white/95 max-w-2xl mx-auto px-4 drop-shadow-[0_2px_6px_rgba(0,0,0,0.7)]",children:t("home.hero.description")})]})})]}),P&&e.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 z-30 flex gap-2",children:a.map((n,S)=>e.jsx("button",{onClick:()=>V(S),className:T("w-3 h-3 rounded-full transition-all duration-300",S===g?"bg-white w-8":"bg-white/50 hover:bg-white/70"),"aria-label":`Go to slide ${S+1}`},S))})]}),e.jsx("section",{className:"py-16 sm:py-24 px-4 bg-secondary/20",children:e.jsxs("div",{className:"container mx-auto max-w-6xl",children:[e.jsxs("div",{className:"text-center mb-12 sm:mb-16",children:[e.jsx("h2",{className:"text-3xl sm:text-4xl md:text-5xl font-bold text-foreground mb-3 sm:mb-4",children:t("home.features.title")}),e.jsx("p",{className:"text-base sm:text-lg text-muted-foreground max-w-2xl mx-auto px-4",children:t("home.features.description")})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 sm:gap-8",children:[e.jsx(Y,{to:"/map",Icon:Te,title:t("home.features.map.title"),desc:t("home.features.map.desc"),iconBg:"bg-gradient-to-br from-primary to-primary-light",iconColor:"text-primary-foreground",hoverBorderColor:"hover:border-primary/50"}),e.jsx(Y,{to:"/restaurants",Icon:He,title:t("home.features.reviews.title"),desc:t("home.features.reviews.desc"),iconBg:"bg-gradient-to-br from-accent to-warning",iconColor:"text-accent-foreground",hoverBorderColor:"hover:border-accent/50"}),e.jsx("div",{className:"sm:col-span-2 md:col-span-1",children:e.jsx(Y,{to:"/activities",Icon:oe,title:t("home.features.events.title"),desc:t("home.features.events.desc"),iconBg:"bg-gradient-to-br from-success to-accent",iconColor:"text-white",hoverBorderColor:"hover:border-success/50"})})]})]})}),e.jsxs("section",{className:"py-16 sm:py-24 px-4 bg-gradient-to-br from-primary/5 via-background to-primary/10 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-1/4 w-72 h-72 bg-primary/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 right-1/4 w-96 h-96 bg-primary/5 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute top-1/2 left-0 w-32 h-32 bg-primary/20 rounded-full blur-2xl -translate-y-1/2"}),e.jsx("div",{className:"absolute top-1/2 right-0 w-32 h-32 bg-primary/20 rounded-full blur-2xl -translate-y-1/2"}),e.jsx("div",{className:"container mx-auto max-w-5xl relative z-10",children:e.jsx("div",{className:"flex flex-col items-center justify-center gap-8",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-primary/10 text-primary text-sm font-medium px-4 py-2 rounded-full mb-4",children:[e.jsx(Pe,{className:"w-4 h-4"}),e.jsx("span",{children:"Mobile App"})]}),e.jsx("h3",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-foreground mb-4",children:t("home.app.title")}),e.jsx("p",{className:"text-base sm:text-lg text-muted-foreground mb-8 leading-relaxed",children:t("home.app.description")}),e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[e.jsxs("a",{href:"https://apps.apple.com/cn/app/xiaoxiong/id6755481369",target:"_blank",rel:"noopener noreferrer",className:"relative group",children:[e.jsx("div",{className:"absolute -inset-2 bg-gradient-to-r from-primary via-primary-glow to-primary rounded-2xl blur-lg opacity-40 group-hover:opacity-70 transition-opacity"}),e.jsx("div",{className:"relative bg-black hover:bg-gray-900 h-[52px] sm:h-[56px] w-[160px] sm:w-[180px] rounded-xl transition-all hover:scale-105 shadow-2xl hover:shadow-primary/30 border border-white/10 flex items-center justify-center",children:e.jsx("img",{src:Ye,alt:"Download on the App Store",className:"h-8 sm:h-9"})})]}),e.jsxs("a",{href:"https://play.google.com/store/apps/details?id=com.xiaoxiong.market",target:"_blank",rel:"noopener noreferrer",className:"relative group",children:[e.jsx("div",{className:"absolute -inset-2 bg-gradient-to-r from-primary via-primary-glow to-primary rounded-2xl blur-lg opacity-40 group-hover:opacity-70 transition-opacity"}),e.jsx("div",{className:"relative bg-black hover:bg-gray-900 h-[52px] sm:h-[56px] w-[160px] sm:w-[180px] rounded-xl transition-all hover:scale-105 shadow-2xl hover:shadow-primary/30 border border-white/10 flex items-center justify-center",children:e.jsx("img",{src:Xe,alt:"Get it on Google Play",className:"h-12 sm:h-14"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Fe,{className:"w-4 h-4 animate-bounce"}),e.jsx("span",{children:t("home.app.downloadNow")})]})]})]})})})]}),e.jsxs("section",{className:"py-16 sm:py-20 px-4 bg-gradient-to-br from-primary via-primary-glow to-primary-light relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-grid-pattern opacity-10"}),e.jsx("div",{className:"absolute top-0 right-0 w-64 sm:w-96 h-64 sm:h-96 bg-white/5 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-64 sm:w-96 h-64 sm:h-96 bg-white/5 rounded-full blur-3xl"}),e.jsxs("div",{className:"container mx-auto max-w-4xl text-center relative z-10",children:[e.jsx("h2",{className:"text-3xl sm:text-4xl md:text-5xl font-bold text-primary-foreground mb-4 sm:mb-6 px-4",children:t("home.cta.title")}),e.jsx("p",{className:"text-base sm:text-xl text-primary-foreground/90 mb-6 sm:mb-8 max-w-2xl mx-auto px-4",children:t("home.cta.description")}),e.jsx("div",{className:"flex justify-center",children:e.jsx(q,{size:"lg",variant:"secondary",asChild:!0,className:"text-base sm:text-lg shadow-xl hover:shadow-2xl",children:e.jsxs(U,{to:"/join-us",children:[e.jsx(Re,{className:"mr-2 w-4 sm:w-5 h-4 sm:h-5"}),t("home.cta.button")]})})})]})]}),e.jsx(Ue,{open:M,onOpenChange:w})]})})};export{ft as default};
//# sourceMappingURL=Home-CeiQ-bvC.js.map
