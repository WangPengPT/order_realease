{"version":3,"file":"AdminAIConfigDetail-GNO6pc_1.js","sources":["../../src/components/admin/AgentDemoDialog.tsx","../../src/pages/admin/AdminAIConfigDetail.tsx"],"sourcesContent":["import { useState, useRef, useEffect, useMemo } from \"react\";\r\nimport { flushSync } from \"react-dom\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Send, Trash2, Bot, User } from \"lucide-react\";\r\n\r\n// Markdown rendering helper\r\nconst renderMarkdown = (content: string) => {\r\n  if (!content) return null;\r\n\r\n  const lines = content.split('\\n');\r\n  const elements: React.ReactNode[] = [];\r\n  let inCodeBlock = false;\r\n  let codeBlockContent: string[] = [];\r\n  let codeBlockLang = '';\r\n  let inTable = false;\r\n  let tableRows: string[] = [];\r\n\r\n  const processInlineMarkdown = (text: string): React.ReactNode => {\r\n    // Process inline code, bold, italic, links\r\n    const parts: React.ReactNode[] = [];\r\n    let remaining = text;\r\n    let key = 0;\r\n\r\n    while (remaining.length > 0) {\r\n      // Inline code\r\n      const codeMatch = remaining.match(/`([^`]+)`/);\r\n      if (codeMatch && codeMatch.index !== undefined) {\r\n        if (codeMatch.index > 0) {\r\n          parts.push(processTextWithBold(remaining.slice(0, codeMatch.index), key++));\r\n        }\r\n        parts.push(\r\n          <code key={key++} className=\"px-1.5 py-0.5 rounded bg-muted-foreground/20 text-sm font-mono\">\r\n            {codeMatch[1]}\r\n          </code>\r\n        );\r\n        remaining = remaining.slice(codeMatch.index + codeMatch[0].length);\r\n        continue;\r\n      }\r\n\r\n      // Link\r\n      const linkMatch = remaining.match(/\\[([^\\]]+)\\]\\(([^)]+)\\)/);\r\n      if (linkMatch && linkMatch.index !== undefined) {\r\n        if (linkMatch.index > 0) {\r\n          parts.push(processTextWithBold(remaining.slice(0, linkMatch.index), key++));\r\n        }\r\n        parts.push(\r\n          <a\r\n            key={key++}\r\n            href={linkMatch[2]}\r\n            target=\"_blank\"\r\n            rel=\"noopener noreferrer\"\r\n            className=\"text-primary underline hover:text-primary/80\"\r\n          >\r\n            {linkMatch[1]}\r\n          </a>\r\n        );\r\n        remaining = remaining.slice(linkMatch.index + linkMatch[0].length);\r\n        continue;\r\n      }\r\n\r\n      parts.push(processTextWithBold(remaining, key++));\r\n      break;\r\n    }\r\n\r\n    return parts.length === 1 ? parts[0] : <>{parts}</>;\r\n  };\r\n\r\n  const processTextWithBold = (text: string, keyPrefix: number): React.ReactNode => {\r\n    const parts: React.ReactNode[] = [];\r\n    let remaining = text;\r\n    let key = 0;\r\n\r\n    while (remaining.length > 0) {\r\n      // Bold\r\n      const boldMatch = remaining.match(/\\*\\*([^*]+)\\*\\*/);\r\n      if (boldMatch && boldMatch.index !== undefined) {\r\n        if (boldMatch.index > 0) {\r\n          parts.push(<span key={`${keyPrefix}-${key++}`}>{remaining.slice(0, boldMatch.index)}</span>);\r\n        }\r\n        parts.push(<strong key={`${keyPrefix}-${key++}`} className=\"font-semibold\">{boldMatch[1]}</strong>);\r\n        remaining = remaining.slice(boldMatch.index + boldMatch[0].length);\r\n        continue;\r\n      }\r\n\r\n      parts.push(<span key={`${keyPrefix}-${key++}`}>{remaining}</span>);\r\n      break;\r\n    }\r\n\r\n    return parts.length === 1 ? parts[0] : <>{parts}</>;\r\n  };\r\n\r\n  const renderTable = (rows: string[]) => {\r\n    if (rows.length < 2) return null;\r\n    \r\n    const parseRow = (row: string) => \r\n      row.split('|').filter(cell => cell.trim()).map(cell => cell.trim());\r\n    \r\n    const headers = parseRow(rows[0]);\r\n    const dataRows = rows.slice(2).filter(row => !row.match(/^[\\s|:-]+$/));\r\n\r\n    return (\r\n      <div className=\"overflow-x-auto my-2\">\r\n        <table className=\"min-w-full border-collapse text-sm\">\r\n          <thead>\r\n            <tr className=\"border-b border-border\">\r\n              {headers.map((header, i) => (\r\n                <th key={i} className=\"px-3 py-2 text-left font-semibold bg-muted/50\">\r\n                  {header}\r\n                </th>\r\n              ))}\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {dataRows.map((row, i) => (\r\n              <tr key={i} className=\"border-b border-border/50 hover:bg-muted/30\">\r\n                {parseRow(row).map((cell, j) => (\r\n                  <td key={j} className=\"px-3 py-2\">\r\n                    {processInlineMarkdown(cell)}\r\n                  </td>\r\n                ))}\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  for (let i = 0; i < lines.length; i++) {\r\n    const line = lines[i];\r\n    const trimmedLine = line.trim();\r\n\r\n    // Code block handling\r\n    if (trimmedLine.startsWith('```')) {\r\n      if (!inCodeBlock) {\r\n        inCodeBlock = true;\r\n        codeBlockLang = trimmedLine.slice(3).trim();\r\n        codeBlockContent = [];\r\n      } else {\r\n        elements.push(\r\n          <div key={i} className=\"my-2 rounded-md overflow-hidden\">\r\n            {codeBlockLang && (\r\n              <div className=\"bg-muted-foreground/20 px-3 py-1 text-xs font-mono text-muted-foreground\">\r\n                {codeBlockLang}\r\n              </div>\r\n            )}\r\n            <pre className=\"bg-muted-foreground/10 p-3 overflow-x-auto\">\r\n              <code className=\"text-sm font-mono\">{codeBlockContent.join('\\n')}</code>\r\n            </pre>\r\n          </div>\r\n        );\r\n        inCodeBlock = false;\r\n        codeBlockLang = '';\r\n      }\r\n      continue;\r\n    }\r\n\r\n    if (inCodeBlock) {\r\n      codeBlockContent.push(line);\r\n      continue;\r\n    }\r\n\r\n    // Table handling\r\n    if (trimmedLine.startsWith('|') && trimmedLine.endsWith('|')) {\r\n      if (!inTable) {\r\n        inTable = true;\r\n        tableRows = [];\r\n      }\r\n      tableRows.push(trimmedLine);\r\n      continue;\r\n    } else if (inTable) {\r\n      elements.push(<div key={`table-${i}`}>{renderTable(tableRows)}</div>);\r\n      inTable = false;\r\n      tableRows = [];\r\n    }\r\n\r\n    // Empty line\r\n    if (!trimmedLine) {\r\n      elements.push(<div key={i} className=\"h-2\" />);\r\n      continue;\r\n    }\r\n\r\n    // Headers\r\n    if (trimmedLine.startsWith('### ')) {\r\n      elements.push(\r\n        <h3 key={i} className=\"text-base font-semibold mt-3 mb-1\">\r\n          {processInlineMarkdown(trimmedLine.slice(4))}\r\n        </h3>\r\n      );\r\n      continue;\r\n    }\r\n    if (trimmedLine.startsWith('## ')) {\r\n      elements.push(\r\n        <h2 key={i} className=\"text-lg font-semibold mt-3 mb-1\">\r\n          {processInlineMarkdown(trimmedLine.slice(3))}\r\n        </h2>\r\n      );\r\n      continue;\r\n    }\r\n    if (trimmedLine.startsWith('# ')) {\r\n      elements.push(\r\n        <h1 key={i} className=\"text-xl font-bold mt-3 mb-2\">\r\n          {processInlineMarkdown(trimmedLine.slice(2))}\r\n        </h1>\r\n      );\r\n      continue;\r\n    }\r\n\r\n    // Horizontal rule\r\n    if (trimmedLine === '---' || trimmedLine === '***') {\r\n      elements.push(<hr key={i} className=\"my-3 border-border\" />);\r\n      continue;\r\n    }\r\n\r\n    // List items\r\n    if (trimmedLine.match(/^[-*]\\s/)) {\r\n      elements.push(\r\n        <div key={i} className=\"flex gap-2 ml-2\">\r\n          <span className=\"text-muted-foreground\">â€¢</span>\r\n          <span>{processInlineMarkdown(trimmedLine.slice(2))}</span>\r\n        </div>\r\n      );\r\n      continue;\r\n    }\r\n\r\n    // Numbered list\r\n    const numberedMatch = trimmedLine.match(/^(\\d+)\\.\\s/);\r\n    if (numberedMatch) {\r\n      elements.push(\r\n        <div key={i} className=\"flex gap-2 ml-2\">\r\n          <span className=\"text-muted-foreground min-w-[1.5rem]\">{numberedMatch[1]}.</span>\r\n          <span>{processInlineMarkdown(trimmedLine.slice(numberedMatch[0].length))}</span>\r\n        </div>\r\n      );\r\n      continue;\r\n    }\r\n\r\n    // Regular paragraph\r\n    elements.push(\r\n      <p key={i} className=\"leading-relaxed\">\r\n        {processInlineMarkdown(trimmedLine)}\r\n      </p>\r\n    );\r\n  }\r\n\r\n  // Handle unclosed table\r\n  if (inTable && tableRows.length > 0) {\r\n    elements.push(<div key=\"table-final\">{renderTable(tableRows)}</div>);\r\n  }\r\n\r\n  return <div className=\"space-y-1\">{elements}</div>;\r\n};\r\n\r\ninterface AgentDemoDialogProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n}\r\n\r\ninterface Message {\r\n  id: string;\r\n  role: \"user\" | \"assistant\";\r\n  content: string;\r\n  isStreaming?: boolean;\r\n}\r\n\r\nconst AgentDemoDialog = ({ open, onOpenChange }: AgentDemoDialogProps) => {\r\n  const { t } = useTranslation();\r\n  const [userId, setUserId] = useState(\"T1\");\r\n  const [messages, setMessages] = useState<Message[]>([]);\r\n  const [input, setInput] = useState(\"\");\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [streamingContent, setStreamingContent] = useState(\"\");\r\n  const [streamingMessageId, setStreamingMessageId] = useState<string | null>(null);\r\n  const scrollAreaRef = useRef<HTMLDivElement>(null);\r\n  const abortControllerRef = useRef<AbortController | null>(null);\r\n\r\n  // Auto-scroll to bottom when messages change\r\n  useEffect(() => {\r\n    if (scrollAreaRef.current) {\r\n      const scrollContainer = scrollAreaRef.current.querySelector('[data-radix-scroll-area-viewport]');\r\n      if (scrollContainer) {\r\n        scrollContainer.scrollTop = scrollContainer.scrollHeight;\r\n      }\r\n    }\r\n  }, [messages]);\r\n\r\n  const handleClear = () => {\r\n    if (abortControllerRef.current) {\r\n      abortControllerRef.current.abort();\r\n    }\r\n    setMessages([]);\r\n    setStreamingContent(\"\");\r\n    setStreamingMessageId(null);\r\n    setIsLoading(false);\r\n  };\r\n\r\n  const handleClose = () => {\r\n    if (abortControllerRef.current) {\r\n      abortControllerRef.current.abort();\r\n    }\r\n    onOpenChange(false);\r\n  };\r\n\r\n  const handleSubmit = async () => {\r\n    if (!input.trim() || isLoading) return;\r\n\r\n    const requestStartTime = Date.now();\r\n    console.log(`[Demoå‰ç«¯] â±ï¸ å¼€å§‹å‘é€è¯·æ±‚: ${new Date().toISOString()}`);\r\n\r\n    const userMessage: Message = {\r\n      id: Date.now().toString(),\r\n      role: \"user\",\r\n      content: input.trim(),\r\n    };\r\n\r\n    setMessages((prev) => [...prev, userMessage]);\r\n    setInput(\"\");\r\n    setIsLoading(true);\r\n\r\n    // Create assistant message placeholder\r\n    const assistantMessageId = (Date.now() + 1).toString();\r\n    setStreamingMessageId(assistantMessageId);\r\n    setStreamingContent(\"\");\r\n    setMessages((prev) => [\r\n      ...prev,\r\n      { id: assistantMessageId, role: \"assistant\", content: \"\", isStreaming: true },\r\n    ]);\r\n\r\n    let firstChunkReceived = false;\r\n    let chunkCount = 0;\r\n\r\n    try {\r\n      abortControllerRef.current = new AbortController();\r\n\r\n      // Call demo API directly\r\n      const response = await fetch(\"https://xiaoxiongmarket.com/ai/demo/api/chat\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({\r\n          message: userMessage.content,\r\n          userId: userId,\r\n        }),\r\n        signal: abortControllerRef.current.signal,\r\n      });\r\n\r\n      const responseTime = Date.now() - requestStartTime;\r\n      console.log(`[Demoå‰ç«¯] â±ï¸ æ”¶åˆ°å“åº”å¤´: ${new Date().toISOString()}, è€—æ—¶: ${responseTime}ms`);\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`API error: ${response.status}`);\r\n      }\r\n\r\n      const reader = response.body?.getReader();\r\n      const decoder = new TextDecoder();\r\n\r\n      if (reader) {\r\n        let fullContent = \"\";\r\n\r\n        while (true) {\r\n          const { done, value } = await reader.read();\r\n          if (done) {\r\n            console.log(`[Demoå‰ç«¯] â±ï¸ æµç»“æŸ: ${new Date().toISOString()}, æ€»è€—æ—¶: ${Date.now() - requestStartTime}ms, å…± ${chunkCount} ä¸ªæ•°æ®å—`);\r\n            break;\r\n          }\r\n\r\n          chunkCount++;\r\n          const chunk = decoder.decode(value, { stream: true });\r\n          fullContent += chunk;\r\n\r\n          if (!firstChunkReceived) {\r\n            firstChunkReceived = true;\r\n            const ttfb = Date.now() - requestStartTime;\r\n            console.log(`[Demoå‰ç«¯] â±ï¸ é¦–ä¸ªæ•°æ®å— (TTFB): ${new Date().toISOString()}, è€—æ—¶: ${ttfb}ms, å¤§å°: ${chunk.length} å­—ç¬¦`);\r\n          }\r\n\r\n          // ä½¿ç”¨ flushSync å¼ºåˆ¶åŒæ­¥æ¸²æŸ“ï¼Œç»•è¿‡ React 18 æ‰¹é‡æ›´æ–°\r\n          flushSync(() => {\r\n            setStreamingContent(fullContent);\r\n          });\r\n          \r\n          // ç­‰å¾…æµè§ˆå™¨æ¸²æŸ“å¸§ï¼Œç¡®ä¿æ¯ä¸ªå­—ç¬¦éƒ½èƒ½æ˜¾ç¤º\r\n          await new Promise(resolve => requestAnimationFrame(resolve));\r\n        }\r\n\r\n        // å¤„ç† decoder å‰©ä½™å†…å®¹\r\n        const remaining = decoder.decode();\r\n        if (remaining) {\r\n          fullContent += remaining;\r\n        }\r\n\r\n        // æµå¼ä¼ è¾“å®Œæˆï¼Œå°†æœ€ç»ˆå†…å®¹ä¿å­˜åˆ° messages\r\n        setMessages((prev) =>\r\n          prev.map((msg) =>\r\n            msg.id === assistantMessageId\r\n              ? { ...msg, content: fullContent, isStreaming: false }\r\n              : msg\r\n          )\r\n        );\r\n        setStreamingContent(\"\");\r\n        setStreamingMessageId(null);\r\n      }\r\n    } catch (error) {\r\n      if ((error as Error).name === \"AbortError\") {\r\n        console.log(\"Request aborted\");\r\n      } else {\r\n        console.error(\"Chat error:\", error);\r\n        setMessages((prev) =>\r\n          prev.map((msg) =>\r\n            msg.id === assistantMessageId\r\n              ? {\r\n                  ...msg,\r\n                  content: t(\"error.general\", \"å‘ç”Ÿé”™è¯¯ï¼Œè¯·é‡è¯•\"),\r\n                  isStreaming: false,\r\n                }\r\n              : msg\r\n          )\r\n        );\r\n      }\r\n      setStreamingContent(\"\");\r\n      setStreamingMessageId(null);\r\n    } finally {\r\n      setIsLoading(false);\r\n      abortControllerRef.current = null;\r\n    }\r\n  };\r\n\r\n  const handleKeyDown = (e: React.KeyboardEvent) => {\r\n    if (e.key === \"Enter\" && !e.shiftKey) {\r\n      e.preventDefault();\r\n      handleSubmit();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={handleClose}>\r\n      <DialogContent className=\"sm:max-w-[600px] h-[80vh] flex flex-col\">\r\n        <DialogHeader>\r\n          <DialogTitle className=\"flex items-center gap-2\">\r\n            <Bot className=\"h-5 w-5\" />\r\n            {t(\"admin.aiSettings.agentDemo\", \"Agent Demo æµ‹è¯•\")}\r\n          </DialogTitle>\r\n        </DialogHeader>\r\n\r\n        {/* User ID Input */}\r\n        <div className=\"flex items-center gap-2 py-2\">\r\n          <Label htmlFor=\"demo-user-id\" className=\"whitespace-nowrap\">\r\n            {t(\"admin.aiSettings.testUserId\", \"æµ‹è¯•ç”¨æˆ·ID\")}:\r\n          </Label>\r\n          <Input\r\n            id=\"demo-user-id\"\r\n            value={userId}\r\n            onChange={(e) => setUserId(e.target.value)}\r\n            className=\"flex-1\"\r\n            placeholder=\"T1\"\r\n          />\r\n          <Button variant=\"outline\" size=\"sm\" onClick={handleClear}>\r\n            <Trash2 className=\"h-4 w-4 mr-1\" />\r\n            {t(\"admin.aiSettings.clearChat\", \"æ¸…ç©º\")}\r\n          </Button>\r\n        </div>\r\n\r\n        {/* Chat Messages */}\r\n        <ScrollArea ref={scrollAreaRef} className=\"flex-1 border rounded-md p-4\">\r\n          {messages.length === 0 ? (\r\n            <div className=\"flex items-center justify-center h-full text-muted-foreground\">\r\n              {t(\"admin.aiSettings.startChat\", \"å‘é€æ¶ˆæ¯å¼€å§‹æµ‹è¯•\")}\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-4\">\r\n              {messages.map((message) => (\r\n                <div\r\n                  key={message.id}\r\n                  className={`flex gap-2 ${\r\n                    message.role === \"user\" ? \"justify-end\" : \"justify-start\"\r\n                  }`}\r\n                >\r\n                  {message.role === \"assistant\" && (\r\n                    <div className=\"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0\">\r\n                      <Bot className=\"h-4 w-4 text-primary\" />\r\n                    </div>\r\n                  )}\r\n                  <div\r\n                    className={`max-w-[80%] rounded-lg px-4 py-2 ${\r\n                      message.role === \"user\"\r\n                        ? \"bg-primary text-primary-foreground\"\r\n                        : \"bg-muted\"\r\n                    }`}\r\n                  >\r\n                    {message.role === \"user\" ? (\r\n                      <p className=\"whitespace-pre-wrap break-words\">{message.content}</p>\r\n                    ) : (\r\n                      <div className=\"prose prose-sm dark:prose-invert max-w-none break-words\">\r\n                        {renderMarkdown(message.id === streamingMessageId ? streamingContent : message.content)}\r\n                        {message.isStreaming && (\r\n                          <span className=\"inline-block w-2 h-4 ml-1 bg-current animate-pulse\" />\r\n                        )}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  {message.role === \"user\" && (\r\n                    <div className=\"w-8 h-8 rounded-full bg-secondary flex items-center justify-center flex-shrink-0\">\r\n                      <User className=\"h-4 w-4\" />\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </ScrollArea>\r\n\r\n        {/* Input Area */}\r\n        <div className=\"flex gap-2 pt-2\">\r\n          <Input\r\n            value={input}\r\n            onChange={(e) => setInput(e.target.value)}\r\n            onKeyDown={handleKeyDown}\r\n            placeholder={t(\"admin.aiSettings.inputPlaceholder\", \"è¾“å…¥æ¶ˆæ¯...\")}\r\n            disabled={isLoading}\r\n            className=\"flex-1\"\r\n          />\r\n          <Button onClick={handleSubmit} disabled={isLoading || !input.trim()}>\r\n            <Send className=\"h-4 w-4\" />\r\n          </Button>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default AgentDemoDialog;\r\n","import { useState, useEffect } from \"react\";\r\nimport { useParams, Link } from \"react-router-dom\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Separator } from \"@/components/ui/separator\";\r\nimport { Skeleton } from \"@/components/ui/skeleton\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\nimport { Accordion, AccordionContent, AccordionItem, AccordionTrigger } from \"@/components/ui/accordion\";\r\nimport { \r\n  Settings, Play, Loader2, RefreshCw, Rocket, FlaskConical, FileText, \r\n  Plus, X, CheckCircle2, Copy, Eye, EyeOff, ArrowLeft \r\n} from \"lucide-react\";\r\nimport { toast } from \"sonner\";\r\nimport AgentDemoDialog from \"@/components/admin/AgentDemoDialog\";\r\n\r\ninterface ModelConfig {\r\n  name: string;\r\n  baseURL: string;\r\n}\r\n\r\ninterface SystemPromptConfig {\r\n  introduction: string;\r\n  responseProcedure: string[];\r\n  matchRequirements: string[];\r\n  formatRequirements: string[];\r\n  prohibitedContent: string[];\r\n  requiredElements: string[];\r\n}\r\n\r\nconst SUPABASE_URL = import.meta.env.VITE_SUPABASE_URL;\r\nconst SUPABASE_KEY = import.meta.env.VITE_SUPABASE_PUBLISHABLE_KEY;\r\n\r\nconst AdminAIConfigDetail = () => {\r\n  const { t } = useTranslation();\r\n  const { provider } = useParams<{ provider: string }>();\r\n  \r\n  // Main model configuration state (read-only display)\r\n  const [mainModelConfig, setMainModelConfig] = useState<ModelConfig | null>(null);\r\n  const [isLoadingMain, setIsLoadingMain] = useState(false);\r\n  \r\n  // Demo model configuration state (editable)\r\n  const [demoModelConfig, setDemoModelConfig] = useState<ModelConfig | null>(null);\r\n  const [isLoadingDemo, setIsLoadingDemo] = useState(false);\r\n  \r\n  // Form state for demo config\r\n  const [newModelName, setNewModelName] = useState(\"\");\r\n  const [newBaseURL, setNewBaseURL] = useState(\"\");\r\n  \r\n  // System prompt states\r\n  const [mainSystemPrompt, setMainSystemPrompt] = useState<SystemPromptConfig | null>(null);\r\n  const [isLoadingMainPrompt, setIsLoadingMainPrompt] = useState(false);\r\n  const [demoSystemPrompt, setDemoSystemPrompt] = useState<SystemPromptConfig | null>(null);\r\n  const [isLoadingDemoPrompt, setIsLoadingDemoPrompt] = useState(false);\r\n  \r\n  // Editable demo system prompt\r\n  const [editablePrompt, setEditablePrompt] = useState<SystemPromptConfig>({\r\n    introduction: \"\",\r\n    responseProcedure: [],\r\n    matchRequirements: [],\r\n    formatRequirements: [],\r\n    prohibitedContent: [],\r\n    requiredElements: [],\r\n  });\r\n  \r\n  // Action states\r\n  const [isSavingDemo, setIsSavingDemo] = useState(false);\r\n  const [isApplyingToMain, setIsApplyingToMain] = useState(false);\r\n  const [isSavingDemoPrompt, setIsSavingDemoPrompt] = useState(false);\r\n  const [demoDialogOpen, setDemoDialogOpen] = useState(false);\r\n  \r\n  // UI states\r\n  const [showMainPromptDetails, setShowMainPromptDetails] = useState(false);\r\n\r\n  // Fetch main model configuration\r\n  const fetchMainConfig = async () => {\r\n    setIsLoadingMain(true);\r\n    try {\r\n      const response = await fetch(\r\n        `${SUPABASE_URL}/functions/v1/xiaoxiong-agent-model?type=main&endpoint=model`,\r\n        {\r\n          method: 'GET',\r\n          headers: {\r\n            'Authorization': `Bearer ${SUPABASE_KEY}`,\r\n            'Content-Type': 'application/json',\r\n          },\r\n        }\r\n      );\r\n\r\n      if (!response.ok) throw new Error('Failed to fetch main config');\r\n      \r\n      const result = await response.json();\r\n      if (result?.success && result?.data) {\r\n        setMainModelConfig(result.data);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Failed to fetch main model config:\", error);\r\n      toast.error(\"è·å–ä¸»é¡µæ¨¡å‹é…ç½®å¤±è´¥\");\r\n    } finally {\r\n      setIsLoadingMain(false);\r\n    }\r\n  };\r\n\r\n  // Fetch demo model configuration\r\n  const fetchDemoConfig = async () => {\r\n    setIsLoadingDemo(true);\r\n    try {\r\n      const response = await fetch(\r\n        `${SUPABASE_URL}/functions/v1/xiaoxiong-agent-model?type=demo&endpoint=model`,\r\n        {\r\n          method: 'GET',\r\n          headers: {\r\n            'Authorization': `Bearer ${SUPABASE_KEY}`,\r\n            'Content-Type': 'application/json',\r\n          },\r\n        }\r\n      );\r\n\r\n      if (!response.ok) throw new Error('Failed to fetch demo config');\r\n      \r\n      const result = await response.json();\r\n      if (result?.success && result?.data) {\r\n        setDemoModelConfig(result.data);\r\n        setNewModelName(result.data.name || \"\");\r\n        setNewBaseURL(result.data.baseURL || \"\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Failed to fetch demo model config:\", error);\r\n      toast.error(\"è·å–Demoæ¨¡å‹é…ç½®å¤±è´¥\");\r\n    } finally {\r\n      setIsLoadingDemo(false);\r\n    }\r\n  };\r\n\r\n  // Fetch main system prompt\r\n  const fetchMainSystemPrompt = async () => {\r\n    setIsLoadingMainPrompt(true);\r\n    try {\r\n      const response = await fetch(\r\n        `${SUPABASE_URL}/functions/v1/xiaoxiong-agent-model?type=main&endpoint=system_prompt`,\r\n        {\r\n          method: 'GET',\r\n          headers: {\r\n            'Authorization': `Bearer ${SUPABASE_KEY}`,\r\n            'Content-Type': 'application/json',\r\n          },\r\n        }\r\n      );\r\n\r\n      if (!response.ok) throw new Error('Failed to fetch main system prompt');\r\n      \r\n      const result = await response.json();\r\n      if (result?.success && result?.data) {\r\n        setMainSystemPrompt(result.data);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Failed to fetch main system prompt:\", error);\r\n      toast.error(\"è·å–ä¸»é¡µç³»ç»Ÿæç¤ºè¯å¤±è´¥\");\r\n    } finally {\r\n      setIsLoadingMainPrompt(false);\r\n    }\r\n  };\r\n\r\n  // Fetch demo system prompt\r\n  const fetchDemoSystemPrompt = async () => {\r\n    setIsLoadingDemoPrompt(true);\r\n    try {\r\n      const response = await fetch(\r\n        `${SUPABASE_URL}/functions/v1/xiaoxiong-agent-model?type=demo&endpoint=system_prompt`,\r\n        {\r\n          method: 'GET',\r\n          headers: {\r\n            'Authorization': `Bearer ${SUPABASE_KEY}`,\r\n            'Content-Type': 'application/json',\r\n          },\r\n        }\r\n      );\r\n\r\n      if (!response.ok) throw new Error('Failed to fetch demo system prompt');\r\n      \r\n      const result = await response.json();\r\n      if (result?.success && result?.data) {\r\n        setDemoSystemPrompt(result.data);\r\n        setEditablePrompt(result.data);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Failed to fetch demo system prompt:\", error);\r\n      toast.error(\"è·å–Demoç³»ç»Ÿæç¤ºè¯å¤±è´¥\");\r\n    } finally {\r\n      setIsLoadingDemoPrompt(false);\r\n    }\r\n  };\r\n\r\n  // Save demo model configuration\r\n  const handleSaveDemoConfig = async () => {\r\n    if (!newModelName.trim() || !newBaseURL.trim()) {\r\n      toast.error(\"è¯·å¡«å†™æ‰€æœ‰å­—æ®µ\");\r\n      return;\r\n    }\r\n\r\n    setIsSavingDemo(true);\r\n    try {\r\n      const response = await fetch(\r\n        `${SUPABASE_URL}/functions/v1/xiaoxiong-agent-model?type=demo&endpoint=model`,\r\n        {\r\n          method: 'POST',\r\n          headers: {\r\n            'Authorization': `Bearer ${SUPABASE_KEY}`,\r\n            'Content-Type': 'application/json',\r\n          },\r\n          body: JSON.stringify({\r\n            name: newModelName.trim(),\r\n            baseURL: newBaseURL.trim(),\r\n          }),\r\n        }\r\n      );\r\n\r\n      if (!response.ok) throw new Error('Failed to save demo config');\r\n      \r\n      const result = await response.json();\r\n      if (result?.success) {\r\n        setDemoModelConfig(result.data);\r\n        toast.success(\"Demoæ¨¡å‹é…ç½®å·²ä¿å­˜\");\r\n      } else {\r\n        throw new Error(result?.error || \"Unknown error\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Failed to save demo config:\", error);\r\n      toast.error(\"ä¿å­˜Demoé…ç½®å¤±è´¥\");\r\n    } finally {\r\n      setIsSavingDemo(false);\r\n    }\r\n  };\r\n\r\n  // Save demo system prompt\r\n  const handleSaveDemoPrompt = async () => {\r\n    setIsSavingDemoPrompt(true);\r\n    try {\r\n      const response = await fetch(\r\n        `${SUPABASE_URL}/functions/v1/xiaoxiong-agent-model?type=demo&endpoint=system_prompt`,\r\n        {\r\n          method: 'PATCH',\r\n          headers: {\r\n            'Authorization': `Bearer ${SUPABASE_KEY}`,\r\n            'Content-Type': 'application/json',\r\n          },\r\n          body: JSON.stringify(editablePrompt),\r\n        }\r\n      );\r\n\r\n      if (!response.ok) throw new Error('Failed to save demo system prompt');\r\n      \r\n      const result = await response.json();\r\n      if (result?.success) {\r\n        setDemoSystemPrompt(result.data);\r\n        toast.success(\"Demoç³»ç»Ÿæç¤ºè¯å·²ä¿å­˜\");\r\n      } else {\r\n        throw new Error(result?.error || \"Unknown error\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Failed to save demo system prompt:\", error);\r\n      toast.error(\"ä¿å­˜Demoç³»ç»Ÿæç¤ºè¯å¤±è´¥\");\r\n    } finally {\r\n      setIsSavingDemoPrompt(false);\r\n    }\r\n  };\r\n\r\n  // Apply ALL demo configs to main (model + system prompt)\r\n  const handleApplyAllToMain = async () => {\r\n    if (!newModelName.trim() || !newBaseURL.trim()) {\r\n      toast.error(\"è¯·å…ˆé…ç½®Demoæ¨¡å‹\");\r\n      return;\r\n    }\r\n\r\n    setIsApplyingToMain(true);\r\n    \r\n    try {\r\n      // Apply model config\r\n      const modelResponse = await fetch(\r\n        `${SUPABASE_URL}/functions/v1/xiaoxiong-agent-model?type=main&endpoint=model`,\r\n        {\r\n          method: 'POST',\r\n          headers: {\r\n            'Authorization': `Bearer ${SUPABASE_KEY}`,\r\n            'Content-Type': 'application/json',\r\n          },\r\n          body: JSON.stringify({\r\n            name: newModelName.trim(),\r\n            baseURL: newBaseURL.trim(),\r\n          }),\r\n        }\r\n      );\r\n\r\n      if (!modelResponse.ok) throw new Error('Failed to apply model to main');\r\n      \r\n      const modelResult = await modelResponse.json();\r\n      if (!modelResult?.success) {\r\n        throw new Error(modelResult?.error || \"Model apply failed\");\r\n      }\r\n      setMainModelConfig(modelResult.data);\r\n\r\n      // Apply system prompt\r\n      const promptResponse = await fetch(\r\n        `${SUPABASE_URL}/functions/v1/xiaoxiong-agent-model?type=main&endpoint=system_prompt`,\r\n        {\r\n          method: 'PATCH',\r\n          headers: {\r\n            'Authorization': `Bearer ${SUPABASE_KEY}`,\r\n            'Content-Type': 'application/json',\r\n          },\r\n          body: JSON.stringify(editablePrompt),\r\n        }\r\n      );\r\n\r\n      if (!promptResponse.ok) throw new Error('Failed to apply system prompt to main');\r\n      \r\n      const promptResult = await promptResponse.json();\r\n      if (!promptResult?.success) {\r\n        throw new Error(promptResult?.error || \"Prompt apply failed\");\r\n      }\r\n      setMainSystemPrompt(promptResult.data);\r\n\r\n      toast.success(\"ğŸš€ æ¨¡å‹é…ç½®å’Œç³»ç»Ÿæç¤ºè¯å·²å…¨éƒ¨åº”ç”¨åˆ°ä¸»é¡µï¼\");\r\n    } catch (error) {\r\n      console.error(\"Failed to apply to main:\", error);\r\n      toast.error(\"åº”ç”¨åˆ°ä¸»é¡µå¤±è´¥\");\r\n    } finally {\r\n      setIsApplyingToMain(false);\r\n    }\r\n  };\r\n\r\n  // Copy main config to demo\r\n  const handleCopyMainToDemo = () => {\r\n    if (mainModelConfig) {\r\n      setNewModelName(mainModelConfig.name);\r\n      setNewBaseURL(mainModelConfig.baseURL);\r\n    }\r\n    if (mainSystemPrompt) {\r\n      setEditablePrompt({\r\n        introduction: mainSystemPrompt.introduction || \"\",\r\n        responseProcedure: mainSystemPrompt.responseProcedure || [],\r\n        matchRequirements: mainSystemPrompt.matchRequirements || [],\r\n        formatRequirements: mainSystemPrompt.formatRequirements || [],\r\n        prohibitedContent: mainSystemPrompt.prohibitedContent || [],\r\n        requiredElements: mainSystemPrompt.requiredElements || [],\r\n      });\r\n    }\r\n    toast.success(\"å·²å¤åˆ¶ä¸»é¡µé…ç½®åˆ°Demo\");\r\n  };\r\n\r\n  // Refresh all configs\r\n  const handleRefreshAll = () => {\r\n    fetchMainConfig();\r\n    fetchDemoConfig();\r\n    fetchMainSystemPrompt();\r\n    fetchDemoSystemPrompt();\r\n  };\r\n\r\n  // Array field helpers\r\n  const handleAddArrayItem = (field: keyof Omit<SystemPromptConfig, 'introduction'>) => {\r\n    setEditablePrompt(prev => ({\r\n      ...prev,\r\n      [field]: [...prev[field], \"\"],\r\n    }));\r\n  };\r\n\r\n  const handleRemoveArrayItem = (field: keyof Omit<SystemPromptConfig, 'introduction'>, index: number) => {\r\n    setEditablePrompt(prev => ({\r\n      ...prev,\r\n      [field]: prev[field].filter((_, i) => i !== index),\r\n    }));\r\n  };\r\n\r\n  const handleUpdateArrayItem = (field: keyof Omit<SystemPromptConfig, 'introduction'>, index: number, value: string) => {\r\n    setEditablePrompt(prev => ({\r\n      ...prev,\r\n      [field]: prev[field].map((item, i) => i === index ? value : item),\r\n    }));\r\n  };\r\n\r\n  // Fetch all configs on page load\r\n  useEffect(() => {\r\n    if (provider === 'xiaoxiong-agent') {\r\n      fetchMainConfig();\r\n      fetchDemoConfig();\r\n      fetchMainSystemPrompt();\r\n      fetchDemoSystemPrompt();\r\n    }\r\n  }, [provider]);\r\n\r\n  const renderArrayField = (\r\n    label: string,\r\n    field: keyof Omit<SystemPromptConfig, 'introduction'>,\r\n    items: string[]\r\n  ) => (\r\n    <div className=\"space-y-3\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <Label className=\"text-sm font-medium\">{label}</Label>\r\n        <Button\r\n          type=\"button\"\r\n          variant=\"outline\"\r\n          size=\"sm\"\r\n          onClick={() => handleAddArrayItem(field)}\r\n          className=\"h-7 text-xs\"\r\n        >\r\n          <Plus className=\"h-3 w-3 mr-1\" />\r\n          æ·»åŠ \r\n        </Button>\r\n      </div>\r\n      <div className=\"space-y-2\">\r\n        {items.map((item, index) => (\r\n          <div key={index} className=\"flex gap-2 items-center group\">\r\n            <span className=\"text-xs text-muted-foreground w-6 text-center shrink-0\">{index + 1}</span>\r\n            <Input\r\n              value={item}\r\n              onChange={(e) => handleUpdateArrayItem(field, index, e.target.value)}\r\n              placeholder={`è¾“å…¥ç¬¬ ${index + 1} æ¡å†…å®¹...`}\r\n              className=\"flex-1 h-9\"\r\n            />\r\n            <Button\r\n              type=\"button\"\r\n              variant=\"ghost\"\r\n              size=\"icon\"\r\n              className=\"h-9 w-9 opacity-0 group-hover:opacity-100 transition-opacity shrink-0\"\r\n              onClick={() => handleRemoveArrayItem(field, index)}\r\n            >\r\n              <X className=\"h-4 w-4 text-destructive\" />\r\n            </Button>\r\n          </div>\r\n        ))}\r\n        {items.length === 0 && (\r\n          <p className=\"text-sm text-muted-foreground text-center py-4 bg-muted/30 rounded-md\">\r\n            æš‚æ— å†…å®¹ï¼Œç‚¹å‡»ä¸Šæ–¹\"æ·»åŠ \"æŒ‰é’®æ·»åŠ \r\n          </p>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const getTotalPromptRules = (prompt: SystemPromptConfig | null) => {\r\n    if (!prompt) return 0;\r\n    return (\r\n      (prompt.responseProcedure?.length || 0) +\r\n      (prompt.matchRequirements?.length || 0) +\r\n      (prompt.formatRequirements?.length || 0) +\r\n      (prompt.prohibitedContent?.length || 0) +\r\n      (prompt.requiredElements?.length || 0)\r\n    );\r\n  };\r\n\r\n  // Provider name mapping\r\n  const providerNames: Record<string, string> = {\r\n    'xiaoxiong-agent': 'å°ç†ŠAgent',\r\n    'ask-xiaoxiong': 'å°ç†ŠAI',\r\n  };\r\n\r\n  const providerName = providerNames[provider || ''] || provider;\r\n\r\n  // If not xiaoxiong-agent, show not configurable message\r\n  if (provider !== 'xiaoxiong-agent') {\r\n    return (\r\n      <div className=\"p-6 space-y-6 max-w-4xl mx-auto\">\r\n        <div className=\"flex items-center gap-4\">\r\n          <Button variant=\"ghost\" size=\"sm\" asChild>\r\n            <Link to=\"/admin/ai-config\">\r\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\r\n              è¿”å›\r\n            </Link>\r\n          </Button>\r\n        </div>\r\n        <Card>\r\n          <CardContent className=\"pt-6 text-center\">\r\n            <p className=\"text-muted-foreground\">è¯¥AIæœåŠ¡æ— éœ€é…ç½®</p>\r\n            <Button className=\"mt-4\" asChild>\r\n              <Link to=\"/admin/ai-config\">è¿”å›é…ç½®åˆ—è¡¨</Link>\r\n            </Button>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-6 max-w-5xl mx-auto\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div className=\"flex items-center gap-4\">\r\n          <Button variant=\"ghost\" size=\"sm\" asChild>\r\n            <Link to=\"/admin/ai-config\">\r\n              <ArrowLeft className=\"h-4 w-4 mr-2\" />\r\n              è¿”å›\r\n            </Link>\r\n          </Button>\r\n          <Separator orientation=\"vertical\" className=\"h-6\" />\r\n          <div className=\"flex items-center gap-3\">\r\n            <Settings className=\"h-8 w-8 text-orange-500\" />\r\n            <div>\r\n              <h1 className=\"text-2xl font-bold\">{providerName} é…ç½®</h1>\r\n              <p className=\"text-muted-foreground\">\r\n                é…ç½®æ¨¡å‹å’Œç³»ç»Ÿæç¤ºè¯ï¼Œåœ¨Demoç¯å¢ƒæµ‹è¯•ååº”ç”¨åˆ°ä¸»é¡µ\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"flex gap-2\">\r\n          <Button variant=\"outline\" size=\"sm\" onClick={handleRefreshAll}>\r\n            <RefreshCw className=\"h-4 w-4 mr-2\" />\r\n            åˆ·æ–°\r\n          </Button>\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={() => setDemoDialogOpen(true)}\r\n          >\r\n            <Play className=\"h-4 w-4 mr-2\" />\r\n            Demoæµ‹è¯•\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Current Main Config Summary */}\r\n      <Card className=\"border-primary/20 bg-gradient-to-r from-primary/5 to-transparent\">\r\n        <CardHeader className=\"pb-3\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <CardTitle className=\"flex items-center gap-2 text-lg\">\r\n              <div className=\"h-2 w-2 rounded-full bg-green-500 animate-pulse\" />\r\n              ğŸ“Œ ä¸»é¡µå½“å‰é…ç½®\r\n            </CardTitle>\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              onClick={handleCopyMainToDemo}\r\n              className=\"text-xs\"\r\n            >\r\n              <Copy className=\"h-3 w-3 mr-1\" />\r\n              å¤åˆ¶åˆ°Demo\r\n            </Button>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n            {/* Model Info */}\r\n            <div className=\"space-y-2\">\r\n              <p className=\"text-xs text-muted-foreground uppercase tracking-wide\">æ¨¡å‹é…ç½®</p>\r\n              {isLoadingMain ? (\r\n                <Skeleton className=\"h-12 w-full\" />\r\n              ) : mainModelConfig ? (\r\n                <div className=\"p-3 bg-background rounded-lg space-y-1\">\r\n                  <p className=\"font-mono font-medium\">{mainModelConfig.name}</p>\r\n                  <p className=\"text-xs text-muted-foreground truncate\" title={mainModelConfig.baseURL}>\r\n                    {mainModelConfig.baseURL}\r\n                  </p>\r\n                </div>\r\n              ) : (\r\n                <p className=\"text-sm text-muted-foreground p-3 bg-background rounded-lg\">æœªé…ç½®</p>\r\n              )}\r\n            </div>\r\n\r\n            {/* Prompt Info */}\r\n            <div className=\"space-y-2\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <p className=\"text-xs text-muted-foreground uppercase tracking-wide\">ç³»ç»Ÿæç¤ºè¯</p>\r\n                <Button\r\n                  variant=\"ghost\"\r\n                  size=\"sm\"\r\n                  onClick={() => setShowMainPromptDetails(!showMainPromptDetails)}\r\n                  className=\"h-6 text-xs\"\r\n                >\r\n                  {showMainPromptDetails ? <EyeOff className=\"h-3 w-3\" /> : <Eye className=\"h-3 w-3\" />}\r\n                </Button>\r\n              </div>\r\n              {isLoadingMainPrompt ? (\r\n                <Skeleton className=\"h-12 w-full\" />\r\n              ) : mainSystemPrompt ? (\r\n                <div className=\"p-3 bg-background rounded-lg\">\r\n                  <Badge variant=\"secondary\" className=\"text-xs\">\r\n                    {getTotalPromptRules(mainSystemPrompt)} æ¡è§„åˆ™\r\n                  </Badge>\r\n                </div>\r\n              ) : (\r\n                <p className=\"text-sm text-muted-foreground p-3 bg-background rounded-lg\">æœªé…ç½®</p>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Main Prompt Details */}\r\n          {showMainPromptDetails && mainSystemPrompt && (\r\n            <div className=\"mt-4 pt-4 border-t space-y-2 text-sm\">\r\n              <p><span className=\"text-muted-foreground\">ä»‹ç»: </span>{mainSystemPrompt.introduction || \"æœªè®¾ç½®\"}</p>\r\n              <div className=\"grid grid-cols-2 md:grid-cols-5 gap-2 text-xs\">\r\n                <div className=\"p-2 bg-background rounded text-center\">\r\n                  <p className=\"font-medium\">{mainSystemPrompt.responseProcedure?.length || 0}</p>\r\n                  <p className=\"text-muted-foreground\">å“åº”æµç¨‹</p>\r\n                </div>\r\n                <div className=\"p-2 bg-background rounded text-center\">\r\n                  <p className=\"font-medium\">{mainSystemPrompt.matchRequirements?.length || 0}</p>\r\n                  <p className=\"text-muted-foreground\">åŒ¹é…è¦æ±‚</p>\r\n                </div>\r\n                <div className=\"p-2 bg-background rounded text-center\">\r\n                  <p className=\"font-medium\">{mainSystemPrompt.formatRequirements?.length || 0}</p>\r\n                  <p className=\"text-muted-foreground\">æ ¼å¼è¦æ±‚</p>\r\n                </div>\r\n                <div className=\"p-2 bg-background rounded text-center\">\r\n                  <p className=\"font-medium\">{mainSystemPrompt.prohibitedContent?.length || 0}</p>\r\n                  <p className=\"text-muted-foreground\">ç¦æ­¢å†…å®¹</p>\r\n                </div>\r\n                <div className=\"p-2 bg-background rounded text-center\">\r\n                  <p className=\"font-medium\">{mainSystemPrompt.requiredElements?.length || 0}</p>\r\n                  <p className=\"text-muted-foreground\">å¿…éœ€å…ƒç´ </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Demo Configuration */}\r\n      <Card>\r\n        <CardHeader className=\"pb-4\">\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <FlaskConical className=\"h-5 w-5 text-orange-500\" />\r\n            ğŸ§ª Demo æµ‹è¯•é…ç½®\r\n            <Badge variant=\"outline\" className=\"text-xs ml-2\">å¯ç¼–è¾‘</Badge>\r\n          </CardTitle>\r\n          <CardDescription>\r\n            åœ¨æ­¤ç¼–è¾‘é…ç½®ï¼Œé€šè¿‡Demoæµ‹è¯•éªŒè¯ååº”ç”¨åˆ°ä¸»é¡µ\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <Tabs defaultValue=\"model\" className=\"w-full\">\r\n            <TabsList className=\"grid w-full grid-cols-2 mb-4\">\r\n              <TabsTrigger value=\"model\" className=\"flex items-center gap-2\">\r\n                <Settings className=\"h-4 w-4\" />\r\n                æ¨¡å‹é…ç½®\r\n              </TabsTrigger>\r\n              <TabsTrigger value=\"prompt\" className=\"flex items-center gap-2\">\r\n                <FileText className=\"h-4 w-4\" />\r\n                ç³»ç»Ÿæç¤ºè¯\r\n              </TabsTrigger>\r\n            </TabsList>\r\n\r\n            {/* Model Tab */}\r\n            <TabsContent value=\"model\" className=\"space-y-4\">\r\n              {isLoadingDemo ? (\r\n                <div className=\"space-y-4\">\r\n                  <Skeleton className=\"h-10 w-full\" />\r\n                  <Skeleton className=\"h-10 w-full\" />\r\n                </div>\r\n              ) : (\r\n                <>\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"model-name\">æ¨¡å‹åç§°</Label>\r\n                      <Input\r\n                        id=\"model-name\"\r\n                        value={newModelName}\r\n                        onChange={(e) => setNewModelName(e.target.value)}\r\n                        placeholder=\"deepseek-chat\"\r\n                      />\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"base-url\">Base URL</Label>\r\n                      <Input\r\n                        id=\"base-url\"\r\n                        value={newBaseURL}\r\n                        onChange={(e) => setNewBaseURL(e.target.value)}\r\n                        placeholder=\"https://api.deepseek.com\"\r\n                      />\r\n                    </div>\r\n                  </div>\r\n\r\n                  <Button\r\n                    variant=\"secondary\"\r\n                    onClick={handleSaveDemoConfig}\r\n                    disabled={isSavingDemo || !newModelName.trim() || !newBaseURL.trim()}\r\n                  >\r\n                    {isSavingDemo && <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />}\r\n                    <CheckCircle2 className=\"h-4 w-4 mr-2\" />\r\n                    ä¿å­˜æ¨¡å‹é…ç½®\r\n                  </Button>\r\n                </>\r\n              )}\r\n            </TabsContent>\r\n\r\n            {/* Prompt Tab */}\r\n            <TabsContent value=\"prompt\" className=\"space-y-4\">\r\n              {isLoadingDemoPrompt ? (\r\n                <div className=\"space-y-3\">\r\n                  <Skeleton className=\"h-20 w-full\" />\r\n                  <Skeleton className=\"h-32 w-full\" />\r\n                </div>\r\n              ) : (\r\n                <>\r\n                  {/* Introduction */}\r\n                  <div className=\"space-y-2\">\r\n                    <Label>è§’è‰²ä»‹ç» (introduction)</Label>\r\n                    <Textarea\r\n                      value={editablePrompt.introduction}\r\n                      onChange={(e) => setEditablePrompt(prev => ({ ...prev, introduction: e.target.value }))}\r\n                      placeholder=\"ä½ æ˜¯å°ç†ŠaiåŠ©æ‰‹ï¼Œå¸®åŠ©é¡¾å®¢å¯»æ‰¾å¿ƒä»ªçš„é¤å…...\"\r\n                      rows={3}\r\n                      className=\"resize-none\"\r\n                    />\r\n                  </div>\r\n\r\n                  <Accordion type=\"multiple\" className=\"w-full\" defaultValue={[\"responseProcedure\"]}>\r\n                    <AccordionItem value=\"responseProcedure\" className=\"border rounded-lg px-4\">\r\n                      <AccordionTrigger className=\"text-sm hover:no-underline\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                          å“åº”æµç¨‹\r\n                          <Badge variant=\"secondary\" className=\"text-xs\">{editablePrompt.responseProcedure.length}</Badge>\r\n                        </div>\r\n                      </AccordionTrigger>\r\n                      <AccordionContent className=\"pt-2\">\r\n                        {renderArrayField(\"å“åº”æµç¨‹\", \"responseProcedure\", editablePrompt.responseProcedure)}\r\n                      </AccordionContent>\r\n                    </AccordionItem>\r\n\r\n                    <AccordionItem value=\"matchRequirements\" className=\"border rounded-lg px-4 mt-2\">\r\n                      <AccordionTrigger className=\"text-sm hover:no-underline\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                          åŒ¹é…è¦æ±‚\r\n                          <Badge variant=\"secondary\" className=\"text-xs\">{editablePrompt.matchRequirements.length}</Badge>\r\n                        </div>\r\n                      </AccordionTrigger>\r\n                      <AccordionContent className=\"pt-2\">\r\n                        {renderArrayField(\"åŒ¹é…è¦æ±‚\", \"matchRequirements\", editablePrompt.matchRequirements)}\r\n                      </AccordionContent>\r\n                    </AccordionItem>\r\n\r\n                    <AccordionItem value=\"formatRequirements\" className=\"border rounded-lg px-4 mt-2\">\r\n                      <AccordionTrigger className=\"text-sm hover:no-underline\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                          æ ¼å¼è¦æ±‚\r\n                          <Badge variant=\"secondary\" className=\"text-xs\">{editablePrompt.formatRequirements.length}</Badge>\r\n                        </div>\r\n                      </AccordionTrigger>\r\n                      <AccordionContent className=\"pt-2\">\r\n                        {renderArrayField(\"æ ¼å¼è¦æ±‚\", \"formatRequirements\", editablePrompt.formatRequirements)}\r\n                      </AccordionContent>\r\n                    </AccordionItem>\r\n\r\n                    <AccordionItem value=\"prohibitedContent\" className=\"border rounded-lg px-4 mt-2\">\r\n                      <AccordionTrigger className=\"text-sm hover:no-underline\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                          ç¦æ­¢å†…å®¹\r\n                          <Badge variant=\"secondary\" className=\"text-xs\">{editablePrompt.prohibitedContent.length}</Badge>\r\n                        </div>\r\n                      </AccordionTrigger>\r\n                      <AccordionContent className=\"pt-2\">\r\n                        {renderArrayField(\"ç¦æ­¢å†…å®¹\", \"prohibitedContent\", editablePrompt.prohibitedContent)}\r\n                      </AccordionContent>\r\n                    </AccordionItem>\r\n\r\n                    <AccordionItem value=\"requiredElements\" className=\"border rounded-lg px-4 mt-2\">\r\n                      <AccordionTrigger className=\"text-sm hover:no-underline\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                          å¿…éœ€å…ƒç´ \r\n                          <Badge variant=\"secondary\" className=\"text-xs\">{editablePrompt.requiredElements.length}</Badge>\r\n                        </div>\r\n                      </AccordionTrigger>\r\n                      <AccordionContent className=\"pt-2\">\r\n                        {renderArrayField(\"å¿…éœ€å…ƒç´ \", \"requiredElements\", editablePrompt.requiredElements)}\r\n                      </AccordionContent>\r\n                    </AccordionItem>\r\n                  </Accordion>\r\n\r\n                  <Button\r\n                    variant=\"secondary\"\r\n                    onClick={handleSaveDemoPrompt}\r\n                    disabled={isSavingDemoPrompt}\r\n                  >\r\n                    {isSavingDemoPrompt && <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />}\r\n                    <CheckCircle2 className=\"h-4 w-4 mr-2\" />\r\n                    ä¿å­˜ç³»ç»Ÿæç¤ºè¯\r\n                  </Button>\r\n                </>\r\n              )}\r\n            </TabsContent>\r\n          </Tabs>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Apply All to Main Button */}\r\n      <Card className=\"border-2 border-dashed border-primary/30\">\r\n        <CardContent className=\"pt-6\">\r\n          <Button\r\n            className=\"w-full h-12 text-base font-medium\"\r\n            size=\"lg\"\r\n            onClick={handleApplyAllToMain}\r\n            disabled={isApplyingToMain || !newModelName.trim() || !newBaseURL.trim()}\r\n          >\r\n            {isApplyingToMain ? (\r\n              <Loader2 className=\"h-5 w-5 mr-2 animate-spin\" />\r\n            ) : (\r\n              <Rocket className=\"h-5 w-5 mr-2\" />\r\n            )}\r\n            ğŸš€ åº”ç”¨å…¨éƒ¨é…ç½®åˆ°ä¸»é¡µ\r\n          </Button>\r\n          <p className=\"text-xs text-muted-foreground text-center mt-2\">\r\n            å°†åŒæ—¶åº”ç”¨æ¨¡å‹é…ç½®å’Œç³»ç»Ÿæç¤ºè¯åˆ°ç”Ÿäº§ç¯å¢ƒ\r\n          </p>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Demo Dialog */}\r\n      <AgentDemoDialog open={demoDialogOpen} onOpenChange={setDemoDialogOpen} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdminAIConfigDetail;\r\n"],"names":["renderMarkdown","content","lines","elements","inCodeBlock","codeBlockContent","codeBlockLang","inTable","tableRows","processInlineMarkdown","text","parts","remaining","key","codeMatch","processTextWithBold","linkMatch","jsx","keyPrefix","boldMatch","renderTable","rows","parseRow","row","cell","headers","dataRows","jsxs","header","i","j","line","trimmedLine","numberedMatch","AgentDemoDialog","open","onOpenChange","t","useTranslation","userId","setUserId","useState","messages","setMessages","input","setInput","isLoading","setIsLoading","streamingContent","setStreamingContent","streamingMessageId","setStreamingMessageId","scrollAreaRef","useRef","abortControllerRef","useEffect","scrollContainer","handleClear","handleClose","handleSubmit","requestStartTime","userMessage","prev","assistantMessageId","firstChunkReceived","chunkCount","response","responseTime","reader","decoder","fullContent","done","value","chunk","ttfb","flushSync","resolve","msg","error","handleKeyDown","e","Dialog","DialogContent","DialogHeader","DialogTitle","Bot","Label","Input","Button","Trash2","ScrollArea","message","User","Send","SUPABASE_URL","SUPABASE_KEY","AdminAIConfigDetail","provider","useParams","mainModelConfig","setMainModelConfig","isLoadingMain","setIsLoadingMain","demoModelConfig","setDemoModelConfig","isLoadingDemo","setIsLoadingDemo","newModelName","setNewModelName","newBaseURL","setNewBaseURL","mainSystemPrompt","setMainSystemPrompt","isLoadingMainPrompt","setIsLoadingMainPrompt","demoSystemPrompt","setDemoSystemPrompt","isLoadingDemoPrompt","setIsLoadingDemoPrompt","editablePrompt","setEditablePrompt","isSavingDemo","setIsSavingDemo","isApplyingToMain","setIsApplyingToMain","isSavingDemoPrompt","setIsSavingDemoPrompt","demoDialogOpen","setDemoDialogOpen","showMainPromptDetails","setShowMainPromptDetails","fetchMainConfig","result","toast","fetchDemoConfig","fetchMainSystemPrompt","fetchDemoSystemPrompt","handleSaveDemoConfig","handleSaveDemoPrompt","handleApplyAllToMain","modelResponse","modelResult","promptResponse","promptResult","handleCopyMainToDemo","handleRefreshAll","handleAddArrayItem","field","handleRemoveArrayItem","index","_","handleUpdateArrayItem","item","renderArrayField","label","items","Plus","X","getTotalPromptRules","prompt","providerName","Link","ArrowLeft","Card","CardContent","Separator","Settings","RefreshCw","Play","CardHeader","CardTitle","Copy","Skeleton","EyeOff","Eye","Badge","FlaskConical","CardDescription","Tabs","TabsList","TabsTrigger","FileText","TabsContent","Fragment","Loader2","CheckCircle2","Textarea","Accordion","AccordionItem","AccordionTrigger","AccordionContent","Rocket"],"mappings":"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"}