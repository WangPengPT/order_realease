{"version":3,"file":"PostDetail-FpuxBw64.js","sources":["../../src/components/community/PostCard.tsx","../../src/pages/PostDetail.tsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport { Link, useNavigate } from \"react-router-dom\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { formatDistanceToNow } from \"date-fns\";\r\nimport { zhCN, enUS, pt } from \"date-fns/locale\";\r\nimport { Heart, MessageCircle, Share2, MoreHorizontal, Calendar, X, ChevronLeft, ChevronRight } from \"lucide-react\";\r\nimport {\r\n  Carousel,\r\n  CarouselContent,\r\n  CarouselItem,\r\n  type CarouselApi,\r\n} from \"@/components/ui/carousel\";\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Card, CardContent, CardFooter, CardHeader } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuTrigger,\r\n} from \"@/components/ui/dropdown-menu\";\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogPortal,\r\n  DialogOverlay,\r\n} from \"@/components/ui/dialog\";\r\nimport { CommunityPost, useLikePost, useSharePost, useDeletePost } from \"@/hooks/useCommunityPosts\";\r\nimport { useAuth } from \"@/contexts/AuthContext\";\r\nimport { useLocalizedContent } from \"@/hooks/useLocalizedContent\";\r\nimport { toast } from \"sonner\";\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n} from \"@/components/ui/alert-dialog\";\r\nimport TranslateButton from \"@/components/TranslateButton\";\r\n\r\ninterface PostCardProps {\r\n  post: CommunityPost;\r\n  showActions?: boolean;\r\n  isDetailPage?: boolean;\r\n}\r\n\r\nconst PostCard = ({ post, showActions = true, isDetailPage = false }: PostCardProps) => {\r\n  const { t, i18n } = useTranslation();\r\n  const { user } = useAuth();\r\n  const navigate = useNavigate();\r\n  const { getLocalizedField } = useLocalizedContent();\r\n  const likePost = useLikePost();\r\n  const sharePost = useSharePost();\r\n  const deletePost = useDeletePost();\r\n  const [showDeleteDialog, setShowDeleteDialog] = useState(false);\r\n  const [imageError, setImageError] = useState<Record<string, boolean>>({});\r\n  const [previewOpen, setPreviewOpen] = useState(false);\r\n  const [previewIndex, setPreviewIndex] = useState(0);\r\n  const [carouselApi, setCarouselApi] = useState<CarouselApi>();\r\n  const [currentSlide, setCurrentSlide] = useState(0);\r\n  const [translatedContent, setTranslatedContent] = useState<string | null>(null);\r\n\r\n  // Listen to carousel slide changes\r\n  useEffect(() => {\r\n    if (!carouselApi) return;\r\n    \r\n    setCurrentSlide(carouselApi.selectedScrollSnap());\r\n    \r\n    carouselApi.on(\"select\", () => {\r\n      setCurrentSlide(carouselApi.selectedScrollSnap());\r\n    });\r\n  }, [carouselApi]);\r\n\r\n  const getDateLocale = () => {\r\n    switch (i18n.language) {\r\n      case \"zh\":\r\n        return zhCN;\r\n      case \"pt\":\r\n        return pt;\r\n      default:\r\n        return enUS;\r\n    }\r\n  };\r\n\r\n  const handleLike = () => {\r\n    if (!user) return;\r\n    likePost.mutate({ postId: post.id, liked: post.user_liked || false });\r\n  };\r\n\r\n  const handleShare = async () => {\r\n    const shareUrl = `${window.location.origin}/community/${post.id}`;\r\n    \r\n    if (navigator.share) {\r\n      try {\r\n        await navigator.share({\r\n          title: t(\"community.shareTitle\", \"分享帖子\"),\r\n          url: shareUrl,\r\n        });\r\n        if (user) {\r\n          sharePost.mutate(post.id);\r\n        }\r\n        toast.success(t(\"community.shareSuccess\", \"分享成功\"));\r\n      } catch (error: any) {\r\n        // User cancelled or share failed - fallback to copy\r\n        if (error?.name !== \"AbortError\") {\r\n          await navigator.clipboard.writeText(shareUrl);\r\n          toast.success(t(\"community.linkCopied\", \"链接已复制到剪贴板\"));\r\n          if (user) {\r\n            sharePost.mutate(post.id);\r\n          }\r\n        }\r\n      }\r\n    } else {\r\n      // Fallback: copy to clipboard\r\n      try {\r\n        await navigator.clipboard.writeText(shareUrl);\r\n        toast.success(t(\"community.linkCopied\", \"链接已复制到剪贴板\"));\r\n        if (user) {\r\n          sharePost.mutate(post.id);\r\n        }\r\n      } catch (error) {\r\n        toast.error(t(\"community.shareFailed\", \"分享失败\"));\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleDelete = () => {\r\n    deletePost.mutate(post.id);\r\n    setShowDeleteDialog(false);\r\n  };\r\n\r\n  const handleImageClick = (index: number) => {\r\n    if (isDetailPage) {\r\n      // On detail page, open preview\r\n      setPreviewIndex(index);\r\n      setPreviewOpen(true);\r\n    } else {\r\n      // On feed, navigate to post detail\r\n      navigate(`/community/${post.id}`);\r\n    }\r\n  };\r\n\r\n  const handlePrevImage = () => {\r\n    setPreviewIndex((prev) => \r\n      prev === 0 ? (post.image_urls?.length || 1) - 1 : prev - 1\r\n    );\r\n  };\r\n\r\n  const handleNextImage = () => {\r\n    setPreviewIndex((prev) => \r\n      prev === (post.image_urls?.length || 1) - 1 ? 0 : prev + 1\r\n    );\r\n  };\r\n\r\n  const isAuthor = user?.id === post.author_id;\r\n  const activityTitle = post.activity\r\n    ? getLocalizedField(post.activity, \"title\")\r\n    : null;\r\n\r\n  return (\r\n    <>\r\n      <Card className=\"overflow-hidden\">\r\n        <CardHeader className=\"pb-3\">\r\n          <div className=\"flex items-start justify-between\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <Avatar className=\"h-10 w-10\">\r\n                <AvatarImage src={post.author?.avatar_url || undefined} />\r\n                <AvatarFallback>\r\n                  {post.author?.display_name?.charAt(0) || \"?\"}\r\n                </AvatarFallback>\r\n              </Avatar>\r\n              <div>\r\n                <p className=\"font-medium text-sm\">{post.author?.display_name}</p>\r\n                <p className=\"text-xs text-muted-foreground\">\r\n                  {formatDistanceToNow(new Date(post.created_at), {\r\n                    addSuffix: true,\r\n                    locale: getDateLocale(),\r\n                  })}\r\n                </p>\r\n              </div>\r\n            </div>\r\n\r\n            {showActions && isAuthor && (\r\n              <DropdownMenu>\r\n                <DropdownMenuTrigger asChild>\r\n                  <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\">\r\n                    <MoreHorizontal className=\"h-4 w-4\" />\r\n                  </Button>\r\n                </DropdownMenuTrigger>\r\n                <DropdownMenuContent align=\"end\">\r\n                  <DropdownMenuItem\r\n                    onClick={() => setShowDeleteDialog(true)}\r\n                    className=\"text-destructive\"\r\n                  >\r\n                    {t(\"common.delete\", \"删除\")}\r\n                  </DropdownMenuItem>\r\n                </DropdownMenuContent>\r\n              </DropdownMenu>\r\n            )}\r\n          </div>\r\n        </CardHeader>\r\n\r\n        <CardContent className=\"pt-0 pb-3\">\r\n          {/* Activity Badge */}\r\n          {post.activity && (\r\n            <Link to={`/activity/${post.activity.id}`}>\r\n              <Badge variant=\"secondary\" className=\"mb-3 gap-1\">\r\n                <Calendar className=\"h-3 w-3\" />\r\n                {activityTitle}\r\n              </Badge>\r\n            </Link>\r\n          )}\r\n\r\n          {/* Content */}\r\n          <Link to={`/community/${post.id}`}>\r\n            <div\r\n              className=\"prose prose-sm max-w-none dark:prose-invert\"\r\n              dangerouslySetInnerHTML={{ __html: translatedContent || post.content }}\r\n            />\r\n          </Link>\r\n\r\n          {/* Translate Button - translate original content to current UI language */}\r\n          <TranslateButton \r\n            text={post.content} \r\n            onTranslation={setTranslatedContent}\r\n            className=\"mt-1\"\r\n          />\r\n\r\n          {/* Images - Carousel only for multiple images */}\r\n          {post.image_urls && post.image_urls.length > 0 && (\r\n            <div className=\"relative mt-3\">\r\n              {post.image_urls.length === 1 ? (\r\n                // Single image - no carousel, just clickable image\r\n                <div \r\n                  className=\"relative aspect-square overflow-hidden rounded-lg cursor-pointer\"\r\n                  onClick={() => handleImageClick(0)}\r\n                >\r\n                  {!imageError[post.image_urls[0]] ? (\r\n                    <img\r\n                      src={post.image_urls[0]}\r\n                      alt=\"\"\r\n                      className=\"w-full h-full object-cover\"\r\n                      onError={() =>\r\n                        setImageError((prev) => ({ ...prev, [post.image_urls![0]]: true }))\r\n                      }\r\n                    />\r\n                  ) : (\r\n                    <div className=\"w-full h-full bg-muted flex items-center justify-center\">\r\n                      <span className=\"text-xs text-muted-foreground\">\r\n                        {t(\"common.imageLoadError\", \"图片加载失败\")}\r\n                      </span>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              ) : (\r\n                // Multiple images - use carousel\r\n                <>\r\n                  <Carousel \r\n                    setApi={setCarouselApi} \r\n                    className=\"w-full\"\r\n                    opts={{ loop: true }}\r\n                  >\r\n                    <CarouselContent className=\"-ml-0\">\r\n                      {post.image_urls.map((url, index) => (\r\n                        <CarouselItem key={index} className=\"pl-0\">\r\n                          <div \r\n                            className=\"relative aspect-square overflow-hidden rounded-lg cursor-pointer\"\r\n                            onClick={() => handleImageClick(index)}\r\n                          >\r\n                            {!imageError[url] ? (\r\n                              <img\r\n                                src={url}\r\n                                alt=\"\"\r\n                                className=\"w-full h-full object-cover\"\r\n                                onError={() =>\r\n                                  setImageError((prev) => ({ ...prev, [url]: true }))\r\n                                }\r\n                              />\r\n                            ) : (\r\n                              <div className=\"w-full h-full bg-muted flex items-center justify-center\">\r\n                                <span className=\"text-xs text-muted-foreground\">\r\n                                  {t(\"common.imageLoadError\", \"图片加载失败\")}\r\n                                </span>\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        </CarouselItem>\r\n                      ))}\r\n                    </CarouselContent>\r\n                  </Carousel>\r\n                  \r\n                  {/* Top-right slide counter */}\r\n                  <div className=\"absolute top-3 right-3 bg-black/60 text-white text-xs px-2 py-1 rounded-full z-10\">\r\n                    {currentSlide + 1}/{post.image_urls.length}\r\n                  </div>\r\n                  \r\n                  {/* Bottom navigation dots */}\r\n                  <div className=\"flex justify-center gap-1.5 mt-2\">\r\n                    {post.image_urls.map((_, index) => (\r\n                      <button\r\n                        key={index}\r\n                        className={`w-1.5 h-1.5 rounded-full transition-colors ${\r\n                          index === currentSlide \r\n                            ? \"bg-primary\" \r\n                            : \"bg-muted-foreground/30\"\r\n                        }`}\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          carouselApi?.scrollTo(index);\r\n                        }}\r\n                      />\r\n                    ))}\r\n                  </div>\r\n                </>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {/* Video */}\r\n          {post.video_url && (\r\n            <div className=\"mt-3 rounded-lg overflow-hidden\">\r\n              <video\r\n                src={post.video_url}\r\n                controls\r\n                className=\"w-full max-h-96\"\r\n                preload=\"metadata\"\r\n              />\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n\r\n        <CardFooter className=\"pt-0 border-t\">\r\n          <div className=\"flex items-center gap-4 pt-3 w-full\">\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              className={`gap-2 ${post.user_liked ? \"text-red-500\" : \"\"}`}\r\n              onClick={handleLike}\r\n              disabled={!user}\r\n            >\r\n              <Heart\r\n                className={`h-4 w-4 ${post.user_liked ? \"fill-current\" : \"\"}`}\r\n              />\r\n              <span>{post.likes_count}</span>\r\n            </Button>\r\n\r\n            <Link to={`/community/${post.id}`}>\r\n              <Button variant=\"ghost\" size=\"sm\" className=\"gap-2\">\r\n                <MessageCircle className=\"h-4 w-4\" />\r\n                <span>{post.comments_count}</span>\r\n              </Button>\r\n            </Link>\r\n\r\n            <Button variant=\"ghost\" size=\"sm\" className=\"gap-2\" onClick={handleShare}>\r\n              <Share2 className=\"h-4 w-4\" />\r\n              <span>{post.shares_count}</span>\r\n            </Button>\r\n          </div>\r\n        </CardFooter>\r\n      </Card>\r\n\r\n      <AlertDialog open={showDeleteDialog} onOpenChange={setShowDeleteDialog}>\r\n        <AlertDialogContent>\r\n          <AlertDialogHeader>\r\n            <AlertDialogTitle>{t(\"common.confirmDelete\", \"确认删除\")}</AlertDialogTitle>\r\n            <AlertDialogDescription>\r\n              {t(\"community.deleteWarning\", \"删除后无法恢复，确定要删除这篇帖子吗？\")}\r\n            </AlertDialogDescription>\r\n          </AlertDialogHeader>\r\n          <AlertDialogFooter>\r\n            <AlertDialogCancel>{t(\"common.cancel\", \"取消\")}</AlertDialogCancel>\r\n            <AlertDialogAction onClick={handleDelete}>\r\n              {t(\"common.delete\", \"删除\")}\r\n            </AlertDialogAction>\r\n          </AlertDialogFooter>\r\n        </AlertDialogContent>\r\n      </AlertDialog>\r\n\r\n      {/* Image Preview Dialog */}\r\n      <Dialog open={previewOpen} onOpenChange={setPreviewOpen}>\r\n        <DialogPortal>\r\n          <DialogOverlay className=\"bg-black\" />\r\n          <div className=\"fixed inset-0 z-50 flex items-center justify-center\">\r\n          <div \r\n            className=\"relative w-full h-full flex items-center justify-center cursor-pointer\"\r\n            onClick={() => setPreviewOpen(false)}\r\n            onTouchStart={(e) => {\r\n              const touch = e.touches[0];\r\n              (e.currentTarget as HTMLDivElement).dataset.touchStartX = touch.clientX.toString();\r\n            }}\r\n            onTouchEnd={(e) => {\r\n              const touchStartX = parseFloat((e.currentTarget as HTMLDivElement).dataset.touchStartX || '0');\r\n              const touchEndX = e.changedTouches[0].clientX;\r\n              const diff = touchStartX - touchEndX;\r\n              \r\n              if (Math.abs(diff) > 50 && post.image_urls && post.image_urls.length > 1) {\r\n                e.stopPropagation();\r\n                if (diff > 0) {\r\n                  handleNextImage();\r\n                } else {\r\n                  handlePrevImage();\r\n                }\r\n              }\r\n            }}\r\n          >\r\n            {/* Image Counter - at top for multiple images */}\r\n            {post.image_urls && post.image_urls.length > 1 && (\r\n              <div className=\"absolute top-4 left-1/2 -translate-x-1/2 z-10 text-white text-sm bg-black/50 px-4 py-1.5 rounded-full\">\r\n                {previewIndex + 1} / {post.image_urls.length}\r\n              </div>\r\n            )}\r\n\r\n            {/* Close Button */}\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"icon\"\r\n              className=\"absolute top-4 right-4 z-10 text-white hover:bg-white/20\"\r\n              onClick={(e) => {\r\n                e.stopPropagation();\r\n                setPreviewOpen(false);\r\n              }}\r\n            >\r\n              <X className=\"h-6 w-6\" />\r\n            </Button>\r\n\r\n            {/* Navigation Buttons - only for multiple images */}\r\n            {post.image_urls && post.image_urls.length > 1 && (\r\n              <>\r\n                <Button\r\n                  variant=\"ghost\"\r\n                  size=\"icon\"\r\n                  className=\"absolute left-4 z-10 text-white hover:bg-white/20 h-12 w-12\"\r\n                  onClick={(e) => {\r\n                    e.stopPropagation();\r\n                    handlePrevImage();\r\n                  }}\r\n                >\r\n                  <ChevronLeft className=\"h-8 w-8\" />\r\n                </Button>\r\n                <Button\r\n                  variant=\"ghost\"\r\n                  size=\"icon\"\r\n                  className=\"absolute right-4 z-10 text-white hover:bg-white/20 h-12 w-12\"\r\n                  onClick={(e) => {\r\n                    e.stopPropagation();\r\n                    handleNextImage();\r\n                  }}\r\n                >\r\n                  <ChevronRight className=\"h-8 w-8\" />\r\n                </Button>\r\n              </>\r\n            )}\r\n\r\n            {/* Image - fill screen while maintaining aspect ratio */}\r\n            {post.image_urls && post.image_urls[previewIndex] && (\r\n              <img\r\n                src={post.image_urls[previewIndex]}\r\n                alt=\"\"\r\n                className=\"w-full h-full object-contain\"\r\n                onClick={(e) => e.stopPropagation()}\r\n              />\r\n            )}\r\n          </div>\r\n          </div>\r\n        </DialogPortal>\r\n      </Dialog>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PostCard;\r\n","import { useParams, useNavigate } from \"react-router-dom\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { ArrowLeft, Loader2 } from \"lucide-react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport PostCard from \"@/components/community/PostCard\";\r\nimport RestaurantComments from \"@/components/RestaurantComments\";\r\nimport { useCommunityPost } from \"@/hooks/useCommunityPosts\";\r\n\r\nconst PostDetail = () => {\r\n  const { id } = useParams<{ id: string }>();\r\n  const { t } = useTranslation();\r\n  const navigate = useNavigate();\r\n  const { data: post, isLoading, error } = useCommunityPost(id || \"\");\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"container max-w-2xl mx-auto py-6 px-4 flex justify-center\">\r\n        <Loader2 className=\"h-8 w-8 animate-spin\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error || !post) {\r\n    return (\r\n      <div className=\"container max-w-2xl mx-auto py-6 px-4\">\r\n        <div className=\"text-center py-12\">\r\n          <p className=\"text-muted-foreground\">\r\n            {t(\"community.postNotFound\", \"帖子不存在或已被删除\")}\r\n          </p>\r\n          <Button\r\n            variant=\"outline\"\r\n            className=\"mt-4\"\r\n            onClick={() => navigate(\"/community\")}\r\n          >\r\n            <ArrowLeft className=\"h-4 w-4 mr-2\" />\r\n            {t(\"community.backToList\", \"返回社区\")}\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"container max-w-2xl mx-auto py-6 px-4\">\r\n      {/* Back Button */}\r\n      <Button\r\n        variant=\"ghost\"\r\n        size=\"sm\"\r\n        className=\"mb-4\"\r\n        onClick={() => navigate(\"/community\")}\r\n      >\r\n        <ArrowLeft className=\"h-4 w-4 mr-2\" />\r\n        {t(\"community.backToList\", \"返回社区\")}\r\n      </Button>\r\n\r\n      {/* Post Card */}\r\n      <PostCard post={post} showActions isDetailPage />\r\n\r\n      {/* Comments Section */}\r\n      <div className=\"mt-6\">\r\n        <RestaurantComments\r\n          targetId={post.id}\r\n          targetType=\"post\"\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PostDetail;\r\n"],"names":["PostCard","post","showActions","isDetailPage","i18n","useTranslation","user","useAuth","navigate","useNavigate","getLocalizedField","useLocalizedContent","likePost","useLikePost","sharePost","useSharePost","deletePost","useDeletePost","showDeleteDialog","setShowDeleteDialog","useState","imageError","setImageError","previewOpen","setPreviewOpen","previewIndex","setPreviewIndex","carouselApi","setCarouselApi","currentSlide","setCurrentSlide","translatedContent","setTranslatedContent","useEffect","getDateLocale","zhCN","pt","enUS","handleLike","handleShare","shareUrl","toast","error","handleDelete","handleImageClick","index","handlePrevImage","prev","handleNextImage","isAuthor","activityTitle","jsxs","Fragment","Card","jsx","CardHeader","Avatar","AvatarImage","AvatarFallback","DropdownMenu","DropdownMenuTrigger","Button","MoreHorizontal","DropdownMenuContent","DropdownMenuItem","CardContent","Link","Badge","Calendar","TranslateButton","Carousel","CarouselContent","url","CarouselItem","_","e","CardFooter","Heart","MessageCircle","Share2","AlertDialog","AlertDialogContent","AlertDialogHeader","AlertDialogTitle","AlertDialogDescription","AlertDialogFooter","AlertDialogCancel","AlertDialogAction","Dialog","DialogPortal","DialogOverlay","touch","touchStartX","touchEndX","diff","X","ChevronLeft","ChevronRight","PostDetail","id","useParams","t","isLoading","useCommunityPost","Loader2","ArrowLeft","RestaurantComments"],"mappings":"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"}