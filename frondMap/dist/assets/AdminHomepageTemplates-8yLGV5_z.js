import{u as oe,r as b,j as e,L as U,B as x,C as f,p as N,W as ce,au as de,at as me,Y as pe,Z as he,$ as ue,a0 as xe,a1 as ge,a2 as _e,a3 as ve,D as je,d as ye,e as be,f as fe,a9 as Ne,aa as n,I as c,O as Te,Q as we,E as Ce,R as ke,T as C,V as De,aj as ze,ak as Fe,al as Ee,am as Ae,an as y,ao as O,o as $,z as H,N as _}from"./index-tBrG_sQo.js";import{S as G}from"./slider-CvYjoLX9.js";import{T as Re,a as Ie,b as k,c as D}from"./tabs-Dwxc8yrY.js";import{a as Se,b as Le,c as Ue,d as Oe,e as $e,f as He}from"./useHomepageTemplates-iN642JD8.js";import{P as Be}from"./plus-BnrcyCVr.js";import{G as Pe}from"./grip-vertical-BDq2hBfx.js";import{C as Ve}from"./clock-CfDFVEuU.js";import{E as We}from"./eye-DbDmf4_Z.js";import{E as Me}from"./eye-off-qSybhnbM.js";import{S as Ge}from"./square-pen-DX51RvZ3.js";import{S as Ye}from"./save-CgfNIfho.js";import{I as B}from"./image-BT7MLyHa.js";import{V as P}from"./video-6yLlj9sC.js";import{R as qe}from"./refresh-cw-DKCOhB1s.js";const ca=()=>{const{t}=oe(),{data:j,isLoading:Y}=Se(),z=Le(),T=Ue(),q=Oe(),F=$e(),J=He(),[u,E]=b.useState(null),[Q,A]=b.useState(!1),[s,v]=b.useState({}),[Z,R]=b.useState("images"),K=()=>{v({sort_order:(j==null?void 0:j.length)||0,is_active:!0,media_type:"image",desktop_media_type:"image",tablet_media_type:"image",mobile_media_type:"image",duration:5e3,overlay_opacity:40,overlay_gradient_direction:"to-b",overlay_gradient_from:"background",overlay_gradient_from_opacity:30,overlay_gradient_via:"background",overlay_gradient_via_opacity:25,overlay_gradient_to:"background",overlay_gradient_to_opacity:40,background_blur:0,title_zh:"发现您的亚洲美食之旅",title_en:"Discover Your Asian Food Journey",title_pt:"Descubra Sua Jornada Gastronômica Asiática",subtitle_zh:"您的美食之旅从这里开始",subtitle_en:"Your culinary journey starts here",subtitle_pt:"Sua jornada culinária começa aqui",description_zh:"探索里斯本地区最好的亚洲美食",description_en:"Explore the best Asian cuisine in the Lisbon area",description_pt:"Explore a melhor cozinha asiática na área de Lisboa",primary_button_text_zh:"探索餐厅",primary_button_text_en:"Explore Restaurants",primary_button_text_pt:"Explorar Restaurantes",primary_button_link:"/restaurants",primary_button_variant:"default",secondary_button_text_zh:"活动",secondary_button_text_en:"Activities",secondary_button_text_pt:"Atividades",secondary_button_link:"/activities",secondary_button_variant:"outline"}),A(!0),R("media")},X=a=>{v(a),E(a),R("media")},ee=async()=>{try{u?(await T.mutateAsync({id:u.id,...s}),E(null)):(await z.mutateAsync(s),A(!1)),v({})}catch(a){console.error("Save failed:",a)}},ae=async a=>{try{await q.mutateAsync(a)}catch(m){console.error("Delete failed:",m)}},se=async a=>{try{await T.mutateAsync({id:a.id,is_active:!a.is_active})}catch(m){console.error("Toggle failed:",m)}},I=async(a,m)=>{var i;const d=(i=a.target.files)==null?void 0:i[0];if(d){if(!d.type.startsWith("image/")){_.error(t("admin.homepageTemplates.selectImageFile"));return}try{const l=(u==null?void 0:u.id)||"new",h=await F.mutateAsync({file:d,type:m,templateId:l});v(o=>({...o,[`${m}_image_url`]:h.url}))}catch(l){console.error("Upload failed:",l)}}},te=a=>new Promise((m,d)=>{const i=document.createElement("video"),l=document.createElement("canvas"),h=l.getContext("2d");i.preload="auto",i.muted=!0,i.playsInline=!0,i.crossOrigin="anonymous";let o=!1;const g=()=>{o||i.videoWidth===0||i.videoHeight===0||(l.width=i.videoWidth,l.height=i.videoHeight,h?(h.drawImage(i,0,0,l.width,l.height),l.toBlob(p=>{p&&p.size>0?(o=!0,i.pause(),URL.revokeObjectURL(i.src),m(p)):d(new Error("Failed to create blob from canvas"))},"image/jpeg",.95)):d(new Error("Failed to get canvas context")))};i.onloadedmetadata=()=>{l.width=i.videoWidth,l.height=i.videoHeight,i.currentTime=.1},i.onseeked=()=>{setTimeout(g,100)},i.oncanplay=()=>{!o&&i.currentTime>=.1&&setTimeout(g,100)},i.onerror=p=>{URL.revokeObjectURL(i.src),d(new Error("Failed to load video: "+(p==null?void 0:p.message)||"Unknown error"))},setTimeout(()=>{o||(URL.revokeObjectURL(i.src),d(new Error("Timeout while extracting video frame")))},1e4),i.src=URL.createObjectURL(a),i.load()}),ie=a=>new Promise((m,d)=>{const i=document.createElement("video"),l=document.createElement("canvas"),h=l.getContext("2d");i.preload="auto",i.muted=!0,i.playsInline=!0,i.crossOrigin="anonymous";let o=!1;const g=()=>{o||i.videoWidth===0||i.videoHeight===0||(l.width=i.videoWidth,l.height=i.videoHeight,h?(h.drawImage(i,0,0,l.width,l.height),l.toBlob(p=>{p&&p.size>0?(o=!0,i.pause(),m(p)):d(new Error("Failed to create blob from canvas"))},"image/jpeg",.95)):d(new Error("Failed to get canvas context")))};i.onloadedmetadata=()=>{l.width=i.videoWidth,l.height=i.videoHeight,i.currentTime=.1},i.onseeked=()=>{setTimeout(g,100)},i.oncanplay=()=>{!o&&i.currentTime>=.1&&setTimeout(g,100)},i.onerror=()=>{d(new Error("Failed to load video from URL"))},setTimeout(()=>{o||d(new Error("Timeout while extracting video frame from URL"))},15e3),i.src=a,i.load()}),[V,W]=b.useState(!1),w=async a=>{const m=a?[a]:["desktop","tablet","mobile"],d=(u==null?void 0:u.id)||"new",i={desktop:"桌面端",tablet:"平板端",mobile:"移动端"};W(!0);let l=0,h=0;for(const o of m){const g=s[`${o}_video_url`];if(g)try{_.info(`正在提取${i[o]}视频第一帧...`);const p=await ie(g),L=new File([p],`${o}-poster-${Date.now()}.jpg`,{type:"image/jpeg"}),le=await F.mutateAsync({file:L,type:o,templateId:d});v(ne=>({...ne,[`${o}_image_url`]:le.url})),l++}catch(p){console.error(`Failed to regenerate ${o} poster:`,p),h++}}if(W(!1),l>0){const o=a?`成功重新生成${i[a]}备用图片`:`成功重新生成 ${l} 个备用图片`;_.success(o)}if(h>0&&_.warning(`${h} 个视频提取失败，可能是跨域限制`),l===0&&h===0){const o=a?`${i[a]}没有视频需要处理`:"没有找到需要处理的视频";_.info(o)}},S=async(a,m)=>{var i;const d=(i=a.target.files)==null?void 0:i[0];if(d){if(!d.type.startsWith("video/")){_.error("请选择视频文件");return}if(d.size>100*1024*1024){_.error("视频文件大小不能超过100MB");return}try{const l=(u==null?void 0:u.id)||"new",h=await J.mutateAsync({file:d,type:m,templateId:l});try{_.info("正在提取视频第一帧作为备用图片...");const o=await te(d),g=new File([o],`${m}-poster-${Date.now()}.jpg`,{type:"image/jpeg"}),p=await F.mutateAsync({file:g,type:m,templateId:l});v(L=>({...L,[`${m}_video_url`]:h.url,[`${m}_image_url`]:p.url})),_.success("视频和备用图片已自动生成")}catch(o){console.error("Failed to extract first frame:",o),v(g=>({...g,[`${m}_video_url`]:h.url})),_.warning("视频已上传，但无法自动提取第一帧，请手动上传备用图片")}}catch(l){console.error("Upload failed:",l)}}},r=(a,m)=>{v(d=>({...d,[a]:m}))},M=()=>{E(null),A(!1),v({})};if(Y)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(U,{className:"w-8 h-8 animate-spin"})});const re=()=>e.jsxs(Re,{value:Z,onValueChange:R,className:"w-full",children:[e.jsxs(Ie,{className:"grid w-full grid-cols-4",children:[e.jsx(k,{value:"media",children:"媒体"}),e.jsx(k,{value:"overlay",children:t("admin.homepageTemplates.tabs.overlay")}),e.jsx(k,{value:"content",children:t("admin.homepageTemplates.tabs.content")}),e.jsx(k,{value:"buttons",children:t("admin.homepageTemplates.tabs.buttons")})]}),e.jsxs(D,{value:"media",className:"space-y-6 mt-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"每个端可以独立选择图片或视频，支持混合配置（如：桌面端视频 + 移动端图片）"}),e.jsxs("div",{className:"space-y-3 p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"text-base font-medium",children:"桌面端"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(x,{type:"button",size:"sm",variant:(s.desktop_media_type||"image")==="image"?"default":"outline",onClick:()=>r("desktop_media_type","image"),className:"flex items-center gap-1",children:[e.jsx(B,{className:"w-3 h-3"}),"图片"]}),e.jsxs(x,{type:"button",size:"sm",variant:(s.desktop_media_type||"image")==="video"?"default":"outline",onClick:()=>r("desktop_media_type","video"),className:"flex items-center gap-1",children:[e.jsx(P,{className:"w-3 h-3"}),"视频"]})]})]}),(s.desktop_media_type||"image")==="image"?e.jsxs("div",{className:"flex items-center gap-4",children:[s.desktop_image_url&&e.jsx("img",{src:s.desktop_image_url,alt:"Desktop",className:"w-32 h-20 object-cover rounded border"}),e.jsx(c,{type:"file",accept:"image/*",onChange:a=>I(a,"desktop")})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[s.desktop_video_url&&e.jsx("video",{src:s.desktop_video_url,className:"w-32 h-20 object-cover rounded border",muted:!0}),e.jsx(c,{type:"file",accept:"video/mp4,video/webm",onChange:a=>S(a,"desktop")})]}),s.desktop_image_url&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx("span",{children:"备用图片:"}),e.jsx("img",{src:s.desktop_image_url,alt:"Desktop poster",className:"w-16 h-10 object-cover rounded border"})]})]})]}),e.jsxs("div",{className:"space-y-3 p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"text-base font-medium",children:"平板端"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(x,{type:"button",size:"sm",variant:(s.tablet_media_type||"image")==="image"?"default":"outline",onClick:()=>r("tablet_media_type","image"),className:"flex items-center gap-1",children:[e.jsx(B,{className:"w-3 h-3"}),"图片"]}),e.jsxs(x,{type:"button",size:"sm",variant:(s.tablet_media_type||"image")==="video"?"default":"outline",onClick:()=>r("tablet_media_type","video"),className:"flex items-center gap-1",children:[e.jsx(P,{className:"w-3 h-3"}),"视频"]})]})]}),(s.tablet_media_type||"image")==="image"?e.jsxs("div",{className:"flex items-center gap-4",children:[s.tablet_image_url&&e.jsx("img",{src:s.tablet_image_url,alt:"Tablet",className:"w-32 h-20 object-cover rounded border"}),e.jsx(c,{type:"file",accept:"image/*",onChange:a=>I(a,"tablet")})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[s.tablet_video_url&&e.jsx("video",{src:s.tablet_video_url,className:"w-32 h-20 object-cover rounded border",muted:!0}),e.jsx(c,{type:"file",accept:"video/mp4,video/webm",onChange:a=>S(a,"tablet")})]}),s.tablet_image_url&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx("span",{children:"备用图片:"}),e.jsx("img",{src:s.tablet_image_url,alt:"Tablet poster",className:"w-16 h-10 object-cover rounded border"})]})]})]}),e.jsxs("div",{className:"space-y-3 p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"text-base font-medium",children:"移动端"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(x,{type:"button",size:"sm",variant:(s.mobile_media_type||"image")==="image"?"default":"outline",onClick:()=>r("mobile_media_type","image"),className:"flex items-center gap-1",children:[e.jsx(B,{className:"w-3 h-3"}),"图片"]}),e.jsxs(x,{type:"button",size:"sm",variant:(s.mobile_media_type||"image")==="video"?"default":"outline",onClick:()=>r("mobile_media_type","video"),className:"flex items-center gap-1",children:[e.jsx(P,{className:"w-3 h-3"}),"视频"]})]})]}),(s.mobile_media_type||"image")==="image"?e.jsxs("div",{className:"flex items-center gap-4",children:[s.mobile_image_url&&e.jsx("img",{src:s.mobile_image_url,alt:"Mobile",className:"w-32 h-20 object-cover rounded border"}),e.jsx(c,{type:"file",accept:"image/*",onChange:a=>I(a,"mobile")})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[s.mobile_video_url&&e.jsx("video",{src:s.mobile_video_url,className:"w-32 h-20 object-cover rounded border",muted:!0}),e.jsx(c,{type:"file",accept:"video/mp4,video/webm",onChange:a=>S(a,"mobile")})]}),s.mobile_image_url&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx("span",{children:"备用图片:"}),e.jsx("img",{src:s.mobile_image_url,alt:"Mobile poster",className:"w-16 h-10 object-cover rounded border"})]})]})]}),(s.desktop_video_url||s.tablet_video_url||s.mobile_video_url)&&e.jsx("div",{className:"pt-4 border-t",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(n,{className:"text-sm font-medium",children:"备用图片管理"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"上传视频时会自动截取第一帧作为备用图片"})]}),e.jsxs(Te,{children:[e.jsx(we,{asChild:!0,children:e.jsxs(x,{type:"button",variant:"outline",size:"sm",disabled:V,children:[V?e.jsx(U,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(qe,{className:"w-4 h-4 mr-2"}),"重新生成第一帧",e.jsx(Ce,{className:"w-4 h-4 ml-2"})]})}),e.jsxs(ke,{align:"end",children:[e.jsx(C,{onClick:()=>w(),children:"全部重新生成"}),e.jsx(De,{}),e.jsx(C,{onClick:()=>w("desktop"),disabled:!s.desktop_video_url,className:s.desktop_video_url?"":"opacity-50 cursor-not-allowed",children:"仅桌面端"}),e.jsx(C,{onClick:()=>w("tablet"),disabled:!s.tablet_video_url,className:s.tablet_video_url?"":"opacity-50 cursor-not-allowed",children:"仅平板端"}),e.jsx(C,{onClick:()=>w("mobile"),disabled:!s.mobile_video_url,className:s.mobile_video_url?"":"opacity-50 cursor-not-allowed",children:"仅移动端"})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:t("admin.homepageTemplates.duration")}),e.jsx(c,{type:"number",value:s.duration||5e3,onChange:a=>r("duration",parseInt(a.target.value)||5e3),min:1e3,max:3e4}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t("admin.homepageTemplates.durationHint")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:t("admin.homepageTemplates.sortOrder")}),e.jsx(c,{type:"number",value:s.sort_order||0,onChange:a=>r("sort_order",parseInt(a.target.value)||0)})]})]})]}),e.jsx(D,{value:"overlay",className:"space-y-4 mt-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(n,{children:[t("admin.homepageTemplates.baseOverlayOpacity"),": ",s.overlay_opacity||40,"%"]}),e.jsx(G,{value:[s.overlay_opacity||40],onValueChange:([a])=>r("overlay_opacity",a),max:100,step:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:t("admin.homepageTemplates.gradientDirection")}),e.jsxs(ze,{value:s.overlay_gradient_direction||"to-b",onValueChange:a=>r("overlay_gradient_direction",a),children:[e.jsx(Fe,{children:e.jsx(Ee,{})}),e.jsxs(Ae,{children:[e.jsx(y,{value:"to-b",children:t("admin.homepageTemplates.gradientDirection.toBottom")}),e.jsx(y,{value:"to-t",children:t("admin.homepageTemplates.gradientDirection.toTop")}),e.jsx(y,{value:"to-r",children:t("admin.homepageTemplates.gradientDirection.toRight")}),e.jsx(y,{value:"to-l",children:t("admin.homepageTemplates.gradientDirection.toLeft")}),e.jsx(y,{value:"to-br",children:t("admin.homepageTemplates.gradientDirection.toBottomRight")}),e.jsx(y,{value:"to-tr",children:t("admin.homepageTemplates.gradientDirection.toTopRight")})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:t("admin.homepageTemplates.startOpacity")}),e.jsx(c,{type:"number",min:"0",max:"100",value:s.overlay_gradient_from_opacity||30,onChange:a=>r("overlay_gradient_from_opacity",parseInt(a.target.value)||0)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:t("admin.homepageTemplates.middleOpacity")}),e.jsx(c,{type:"number",min:"0",max:"100",value:s.overlay_gradient_via_opacity||25,onChange:a=>r("overlay_gradient_via_opacity",parseInt(a.target.value)||0)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:t("admin.homepageTemplates.endOpacity")}),e.jsx(c,{type:"number",min:"0",max:"100",value:s.overlay_gradient_to_opacity||40,onChange:a=>r("overlay_gradient_to_opacity",parseInt(a.target.value)||0)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(n,{children:[t("admin.homepageTemplates.backgroundBlur"),": ",s.background_blur||0,"px"]}),e.jsx(G,{value:[s.background_blur||0],onValueChange:([a])=>r("background_blur",a),max:50,step:1})]})]})}),e.jsx(D,{value:"content",className:"space-y-4 mt-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:t("admin.homepageTemplates.titleChinese")}),e.jsx(c,{value:s.title_zh||"",onChange:a=>r("title_zh",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:t("admin.homepageTemplates.titleEnglish")}),e.jsx(c,{value:s.title_en||"",onChange:a=>r("title_en",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:t("admin.homepageTemplates.titlePortuguese")}),e.jsx(c,{value:s.title_pt||"",onChange:a=>r("title_pt",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:t("admin.homepageTemplates.descriptionChinese")}),e.jsx(O,{value:s.description_zh||"",onChange:a=>r("description_zh",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:t("admin.homepageTemplates.descriptionEnglish")}),e.jsx(O,{value:s.description_en||"",onChange:a=>r("description_en",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:t("admin.homepageTemplates.descriptionPortuguese")}),e.jsx(O,{value:s.description_pt||"",onChange:a=>r("description_pt",a.target.value)})]})]})}),e.jsxs(D,{value:"buttons",className:"space-y-4 mt-4",children:[e.jsxs(f,{children:[e.jsx($,{className:"py-3",children:e.jsx(H,{className:"text-lg",children:t("admin.homepageTemplates.primaryButton")})}),e.jsxs(N,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:t("admin.homepageTemplates.chinese")}),e.jsx(c,{value:s.primary_button_text_zh||"",onChange:a=>r("primary_button_text_zh",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:t("admin.homepageTemplates.english")}),e.jsx(c,{value:s.primary_button_text_en||"",onChange:a=>r("primary_button_text_en",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:t("admin.homepageTemplates.portuguese")}),e.jsx(c,{value:s.primary_button_text_pt||"",onChange:a=>r("primary_button_text_pt",a.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:t("admin.homepageTemplates.link")}),e.jsx(c,{value:s.primary_button_link||"",onChange:a=>r("primary_button_link",a.target.value)})]})]})]}),e.jsxs(f,{children:[e.jsx($,{className:"py-3",children:e.jsx(H,{className:"text-lg",children:t("admin.homepageTemplates.secondaryButton")})}),e.jsxs(N,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:t("admin.homepageTemplates.chinese")}),e.jsx(c,{value:s.secondary_button_text_zh||"",onChange:a=>r("secondary_button_text_zh",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:t("admin.homepageTemplates.english")}),e.jsx(c,{value:s.secondary_button_text_en||"",onChange:a=>r("secondary_button_text_en",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:t("admin.homepageTemplates.portuguese")}),e.jsx(c,{value:s.secondary_button_text_pt||"",onChange:a=>r("secondary_button_text_pt",a.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:t("admin.homepageTemplates.link")}),e.jsx(c,{value:s.secondary_button_link||"",onChange:a=>r("secondary_button_link",a.target.value)})]})]})]}),e.jsxs(f,{children:[e.jsx($,{className:"py-3",children:e.jsx(H,{className:"text-lg",children:t("admin.homepageTemplates.subtitleButton")})}),e.jsxs(N,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:t("admin.homepageTemplates.chinese")}),e.jsx(c,{value:s.subtitle_button_text_zh||"",onChange:a=>r("subtitle_button_text_zh",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:t("admin.homepageTemplates.english")}),e.jsx(c,{value:s.subtitle_button_text_en||"",onChange:a=>r("subtitle_button_text_en",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:t("admin.homepageTemplates.portuguese")}),e.jsx(c,{value:s.subtitle_button_text_pt||"",onChange:a=>r("subtitle_button_text_pt",a.target.value)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:t("admin.homepageTemplates.link")}),e.jsx(c,{value:s.subtitle_button_link||"",onChange:a=>r("subtitle_button_link",a.target.value)})]})]})]})]})]});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:t("admin.homepageTemplates")}),e.jsx("p",{className:"text-muted-foreground mt-2",children:t("admin.homepageTemplatesDescription")})]}),e.jsxs(x,{onClick:K,children:[e.jsx(Be,{className:"w-4 h-4 mr-2"}),t("admin.homepageTemplates.createTemplate")]})]}),e.jsxs("div",{className:"grid gap-4",children:[j==null?void 0:j.map(a=>e.jsx(f,{className:a.is_active?"":"opacity-60",children:e.jsx(N,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Pe,{className:"w-5 h-5"}),e.jsxs("span",{className:"text-sm font-medium",children:["#",a.sort_order]})]}),a.desktop_image_url&&e.jsx("img",{src:a.desktop_image_url,alt:"Preview",className:"w-24 h-16 object-cover rounded border"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold truncate",children:a.title_zh}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:a.description_zh}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(Ve,{className:"w-3 h-3 text-muted-foreground"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[a.duration/1e3,t("admin.homepageTemplates.seconds")]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{variant:"ghost",size:"icon",onClick:()=>se(a),title:a.is_active?t("admin.homepageTemplates.hide"):t("admin.homepageTemplates.show"),children:a.is_active?e.jsx(We,{className:"w-4 h-4"}):e.jsx(Me,{className:"w-4 h-4"})}),e.jsx(x,{variant:"ghost",size:"icon",onClick:()=>X(a),children:e.jsx(Ge,{className:"w-4 h-4"})}),e.jsxs(ce,{children:[e.jsx(de,{asChild:!0,children:e.jsx(x,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive",children:e.jsx(me,{className:"w-4 h-4"})})}),e.jsxs(pe,{children:[e.jsxs(he,{children:[e.jsx(ue,{children:t("admin.confirmDelete")}),e.jsx(xe,{children:t("admin.homepageTemplates.deleteTemplateConfirm")})]}),e.jsxs(ge,{children:[e.jsx(_e,{children:t("common.cancel")}),e.jsx(ve,{onClick:()=>ae(a.id),children:t("common.delete")})]})]})]})]})]})})},a.id)),(!j||j.length===0)&&e.jsx(f,{children:e.jsx(N,{className:"p-8 text-center text-muted-foreground",children:t("admin.homepageTemplates.noTemplates")})})]}),e.jsx(je,{open:!!u||Q,onOpenChange:M,children:e.jsxs(ye,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(be,{children:[e.jsx(fe,{children:t(u?"admin.homepageTemplates.editTemplate":"admin.homepageTemplates.createTemplate")}),e.jsx(Ne,{children:t("admin.homepageTemplates.configureTemplate")})]}),re(),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(x,{variant:"outline",onClick:M,children:t("common.cancel")}),e.jsxs(x,{onClick:ee,disabled:z.isPending||T.isPending,children:[(z.isPending||T.isPending)&&e.jsx(U,{className:"w-4 h-4 mr-2 animate-spin"}),e.jsx(Ye,{className:"w-4 h-4 mr-2"}),t("common.save")]})]})]})})]})};export{ca as default};
