{"version":3,"file":"exportUtils-YWmY6fTR.js","sources":["../../src/lib/exportUtils.ts"],"sourcesContent":["/**\r\n * Export utilities for converting data to CSV format and downloading files\r\n */\r\n\r\n/**\r\n * Convert array of objects to CSV string\r\n */\r\nexport function convertToCSV(data: any[], headers: string[]): string {\r\n  if (!data || data.length === 0) {\r\n    return headers.join(\",\");\r\n  }\r\n\r\n  const csvRows = [];\r\n  \r\n  // Add header row\r\n  csvRows.push(headers.join(\",\"));\r\n  \r\n  // Add data rows\r\n  for (const row of data) {\r\n    const values = headers.map(header => {\r\n      const value = row[header];\r\n      \r\n      // Handle null/undefined\r\n      if (value === null || value === undefined) {\r\n        return \"\";\r\n      }\r\n      \r\n      // Handle arrays\r\n      if (Array.isArray(value)) {\r\n        return `\"${value.join(\", \")}\"`;\r\n      }\r\n      \r\n      // Handle objects\r\n      if (typeof value === \"object\") {\r\n        return `\"${JSON.stringify(value)}\"`;\r\n      }\r\n      \r\n      // Handle strings with commas or quotes\r\n      const stringValue = String(value);\r\n      if (stringValue.includes(\",\") || stringValue.includes('\"') || stringValue.includes(\"\\n\")) {\r\n        return `\"${stringValue.replace(/\"/g, '\"\"')}\"`;\r\n      }\r\n      \r\n      return stringValue;\r\n    });\r\n    \r\n    csvRows.push(values.join(\",\"));\r\n  }\r\n  \r\n  return csvRows.join(\"\\n\");\r\n}\r\n\r\n/**\r\n * Download CSV file\r\n */\r\nexport function downloadCSV(csvContent: string, filename: string): void {\r\n  // Add BOM for UTF-8 encoding (helps Excel recognize UTF-8)\r\n  const BOM = \"\\uFEFF\";\r\n  const blob = new Blob([BOM + csvContent], { type: \"text/csv;charset=utf-8;\" });\r\n  const link = document.createElement(\"a\");\r\n  \r\n  if (link.download !== undefined) {\r\n    const url = URL.createObjectURL(blob);\r\n    link.setAttribute(\"href\", url);\r\n    link.setAttribute(\"download\", filename);\r\n    link.style.visibility = \"hidden\";\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n    URL.revokeObjectURL(url);\r\n  }\r\n}\r\n\r\n/**\r\n * Export users to CSV\r\n */\r\nexport function exportUsersToCSV(users: any[]): void {\r\n  const headers = [\"id\", \"display_name\", \"phone\", \"created_at\", \"roles\"];\r\n  \r\n  const formattedData = users.map(user => ({\r\n    id: user.id,\r\n    display_name: user.display_name,\r\n    phone: user.phone || \"\",\r\n    created_at: new Date(user.created_at).toLocaleDateString(),\r\n    roles: user.roles?.join(\", \") || \"user\",\r\n  }));\r\n  \r\n  const csv = convertToCSV(formattedData, headers);\r\n  const filename = `users_export_${new Date().toISOString().split(\"T\")[0]}.csv`;\r\n  downloadCSV(csv, filename);\r\n}\r\n\r\n/**\r\n * Export restaurants to CSV\r\n */\r\nexport function exportRestaurantsToCSV(restaurants: any[]): void {\r\n  const headers = [\r\n    \"id\",\r\n    \"name\",\r\n    \"name_en\",\r\n    \"name_pt\",\r\n    \"type\",\r\n    \"type_en\",\r\n    \"type_pt\",\r\n    \"address\",\r\n    \"phone\",\r\n    \"website_url\",\r\n    \"rating\",\r\n    \"lat\",\r\n    \"lng\",\r\n    \"created_at\",\r\n  ];\r\n  \r\n  const formattedData = restaurants.map(restaurant => ({\r\n    id: restaurant.id,\r\n    name: restaurant.name,\r\n    name_en: restaurant.name_en || \"\",\r\n    name_pt: restaurant.name_pt || \"\",\r\n    type: restaurant.type,\r\n    type_en: restaurant.type_en || \"\",\r\n    type_pt: restaurant.type_pt || \"\",\r\n    address: restaurant.address,\r\n    phone: restaurant.phone || \"\",\r\n    website_url: restaurant.website_url || \"\",\r\n    rating: restaurant.rating || 0,\r\n    lat: restaurant.lat,\r\n    lng: restaurant.lng,\r\n    created_at: new Date(restaurant.created_at).toLocaleDateString(),\r\n  }));\r\n  \r\n  const csv = convertToCSV(formattedData, headers);\r\n  const filename = `restaurants_export_${new Date().toISOString().split(\"T\")[0]}.csv`;\r\n  downloadCSV(csv, filename);\r\n}\r\n\r\n/**\r\n * Export activities to CSV\r\n */\r\nexport function exportActivitiesToCSV(activities: any[]): void {\r\n  const headers = [\r\n    \"id\",\r\n    \"title_en\",\r\n    \"title_zh\",\r\n    \"title_pt\",\r\n    \"start_date\",\r\n    \"end_date\",\r\n    \"repeat_mode\",\r\n    \"pinned\",\r\n    \"sort_order\",\r\n    \"created_at\",\r\n  ];\r\n  \r\n  const formattedData = activities.map(activity => ({\r\n    id: activity.id,\r\n    title_en: activity.title_en,\r\n    title_zh: activity.title_zh,\r\n    title_pt: activity.title_pt,\r\n    start_date: new Date(activity.start_date).toLocaleDateString(),\r\n    end_date: activity.end_date ? new Date(activity.end_date).toLocaleDateString() : \"\",\r\n    repeat_mode: activity.repeat_mode || \"none\",\r\n    pinned: activity.pinned ? \"Yes\" : \"No\",\r\n    sort_order: activity.sort_order || 0,\r\n    created_at: new Date(activity.created_at).toLocaleDateString(),\r\n  }));\r\n  \r\n  const csv = convertToCSV(formattedData, headers);\r\n  const filename = `activities_export_${new Date().toISOString().split(\"T\")[0]}.csv`;\r\n  downloadCSV(csv, filename);\r\n}\r\n"],"names":["convertToCSV","data","headers","csvRows","row","values","header","value","stringValue","downloadCSV","csvContent","filename","BOM","blob","link","url","exportUsersToCSV","users","formattedData","user","csv","exportRestaurantsToCSV","restaurants","restaurant","exportActivitiesToCSV","activities","activity"],"mappings":"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"}