import{p as B,r as l,j as t,aM as C,dF as S,dG as F,w as d}from"./vendor-react-BQzJ6E-_.js";import{B as N,s as v}from"./index-BNKbGXoa.js";const j=new Map,E=({text:x,className:w,label:L,onTranslation:r})=>{const{t:s,i18n:h}=B(),[T,f]=l.useState(!1),[R,o]=l.useState(null),[c,n]=l.useState(!1),[i,p]=l.useState(null),y=h.language;i&&i!==y&&c&&(n(!1),o(null),r?.(null));const b=async()=>{const e=h.language,m=`${x.substring(0,100)}_${e}`;if(c&&i===e){n(!1),r?.(null);return}const u=j.get(m);if(u){o(u),n(!0),p(e),r?.(u);return}f(!0),console.log("[TranslateButton] Calling translate-content with targetLang:",e);try{const{data:a,error:g}=await v.functions.invoke("translate-content",{body:{text:x,targetLang:e}});if(console.log("[TranslateButton] Response:",a,g),g){console.error("Translation error:",g),d.error(s("translate.error","翻译失败，请稍后重试"));return}a?.translatedText?(j.set(m,a.translatedText),o(a.translatedText),n(!0),p(e),r?.(a.translatedText)):a?.error&&d.error(a.error)}catch(a){console.error("Translation error:",a),d.error(s("translate.error","翻译失败，请稍后重试"))}finally{f(!1)}};return t.jsx(N,{variant:"ghost",size:"sm",className:`gap-1.5 h-auto py-1 px-2 text-xs text-muted-foreground hover:text-foreground ${w||""}`,onClick:b,disabled:T,children:T?t.jsxs(t.Fragment,{children:[t.jsx(C,{className:"h-3 w-3 animate-spin"}),t.jsx("span",{children:s("translate.translating","翻译中...")})]}):c?t.jsxs(t.Fragment,{children:[t.jsx(S,{className:"h-3 w-3"}),t.jsx("span",{children:s("translate.showOriginal","显示原文")})]}):t.jsxs(t.Fragment,{children:[t.jsx(F,{className:"h-3 w-3"}),t.jsx("span",{children:L||s("translate.button","翻译")})]})})};export{E as T};
//# sourceMappingURL=TranslateButton-BpOQHGed.js.map
