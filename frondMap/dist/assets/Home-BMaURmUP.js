import{p as be,u as Me,r as n,j as e,al as pt,aL as Ee,aV as gt,aW as ft,aM as bt,aX as Oe,aY as ke,aZ as wt,a_ as yt,a$ as vt,av as Fe,ax as Ve,b0 as _e,b1 as Be,b2 as jt,b3 as Xe,b4 as Ce,b5 as Je,b6 as Ke,b7 as Qe,b8 as Nt,b9 as Pe,ba as kt,q as _t,bb as St,bc as Ct,L as At,bd as Dt}from"./vendor-react-Snp1tga-.js";import{a as Ye,u as Rt,b as Ze,c as Lt,l as Tt,D as It,d as zt,e as Mt,f as $t,S as Ge,g as B,A as Et,h as Ot,i as Ft,j as Vt,I as Bt,B as Z,k as V,C as Ae,s as Pt,m as Wt,n as Ht,o as qt,p as Ut,q as Xt,r as Jt,t as Kt,v as Qt,w as Yt,x as Zt,y as Le,z as Gt,H as es,E as et,F as tt,G as ts}from"./index-CEyHsx64.js";import{c as ss,g as as,m as st}from"./geolocation-DRm3QMsJ.js";import{a as rs,g as ns}from"./app-store-badge-CyCtXXOt.js";import{u as at}from"./useHomepageTemplates-D93jl3cy.js";import{u as os}from"./usePageView-CO_OJq94.js";import{L as rt}from"./LocationPermissionDialog-DcyT5_Go.js";import{P as is}from"./PullToRefresh-BkqUPYnJ.js";import{P as ls,a as cs,b as ds}from"./popover-DJ2q9U5E.js";import{u as ms,a as us}from"./useRestaurants-D9afiK9t.js";import{u as hs,R as xs,l as ps}from"./xiaoxiong-logo-clean-DjqRKnKm.js";import{u as nt}from"./useLocalizedContent-Ei9FcTeq.js";import{u as ot}from"./useActivities-CuRCLpHr.js";import{a as We,f as Te,K as gs,L as He,M as fs,i as bs}from"./vendor-utils-Z4kpnli5.js";import"./vendor-i18n-jtdHZIRR.js";import"./vendor-editor-B1vH4T8i.js";import"./vendor-supabase-D3137XJ9.js";import"./vendor-map-CvE3ASYw.js";const ws=()=>!!(window.webkit?.messageHandlers?.VoiceBridge||window.VoiceBridge),qe={start:()=>{const s=JSON.stringify({action:"start"});window.webkit?.messageHandlers?.VoiceBridge?window.webkit.messageHandlers.VoiceBridge.postMessage(s):window.VoiceBridge&&window.VoiceBridge.postMessage(s)},stop:()=>{const s=JSON.stringify({action:"stop"});window.webkit?.messageHandlers?.VoiceBridge?window.webkit.messageHandlers.VoiceBridge.postMessage(s):window.VoiceBridge&&window.VoiceBridge.postMessage(s)}},Ie="https://tzdgqhwyzsxkxnncgzap.supabase.co",ve="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR6ZGdxaHd5enN4a3hubmNnemFwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM2NTg2ODgsImV4cCI6MjA3OTIzNDY4OH0.D76C4OkjQVWyMxtjjdOofpD8X_hEEoTtrXHqi4XSYUw",ys=["最近","附近","离我","距离","远近","近的","周边","周围","最近的","附近的","nearest","closest","nearby","near me","close to me","distance","around me","mais perto","próximo","perto de mim","distância","mais próximo"],vs=()=>{const s="xiaoxiong_anonymous_user_id";let r=localStorage.getItem(s);return r||(r=`anon_${Date.now()}_${Math.random().toString(36).substring(2,11)}`,localStorage.setItem(s,r)),r},js=({open:s,onOpenChange:r,provider:i="ask-xiaoxiong"})=>{const{i18n:d}=be(),o=Me(),{settings:p}=Ye(),{user:u}=Rt(),w=Ze(),{data:h}=Lt(),m=p?.logo_url||Tt,[f,b]=n.useState(""),[S,j]=n.useState([]),[C,A]=n.useState(!1),[z,W]=n.useState(null),[H,P]=n.useState(!1),[O,M]=n.useState(null),[$,T]=n.useState(!1),[q,Q]=n.useState(!1),[U,g]=n.useState(!1),k=n.useRef(null),ue=n.useRef(null),G=n.useRef(null),se=n.useRef(null),ne=()=>{if(!q&&!U)return!1;const a=typeof window<"u"?window.innerWidth:1024,c=a>=768&&a<1024,l=a>=1024;return w?p?.voice_input_mobile!==!1:c?p?.voice_input_tablet!==!1:l?p?.voice_input_desktop!==!1:!0},we=()=>u?.id?u.id:vs();n.useEffect(()=>{const a=window.SpeechRecognition||window.webkitSpeechRecognition;return Q(!!a),g(ws()),window.onSpeechResult=c=>{b(c),T(!1)},()=>{window.onSpeechResult=void 0}},[]),n.useEffect(()=>{s&&!z&&navigator.geolocation?.getCurrentPosition(a=>{W({lat:a.coords.latitude,lng:a.coords.longitude})},a=>{console.log("Unable to get user location:",a.message)},{enableHighAccuracy:!1,timeout:5e3,maximumAge:3e5})},[s,z]),n.useEffect(()=>{!s&&G.current&&(G.current.stop(),T(!1))},[s]),n.useEffect(()=>{se.current?.scrollIntoView({behavior:"smooth"})},[S]);const oe=async(a,c)=>{const l=await fetch(`${Ie}/functions/v1/ask-xiaoxiong`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ve}`,apikey:ve},body:JSON.stringify({text:a.content,stream:!0,lat:z?.lat,lng:z?.lng}),signal:k.current?.signal});if(!l.ok)throw new Error(`Request failed with status: ${l.status}`);if(!l.body)throw new Error("No response body");const v=l.body.getReader(),x=new TextDecoder;let N="";for(;;){const{done:D,value:E}=await v.read();if(D)break;const fe=x.decode(E,{stream:!0});N+=fe;let I=N;I.startsWith('"')&&(I=I.slice(1)),I.endsWith('"')&&(I=I.slice(0,-1)),I=I.replace(/\\n/g,`
`),j(ee=>ee.map(K=>K.id===c?{...K,content:I}:K))}let _=N;_.startsWith('"')&&(_=_.slice(1)),_.endsWith('"')&&(_=_.slice(0,-1)),_=_.replace(/\\n/g,`
`),j(D=>D.map(E=>E.id===c?{...E,content:_,isStreaming:!1}:E))},ye=async(a,c)=>{const l=we(),v=Date.now();console.log(`[前端-Agent] ⏱️ 开始发送请求: ${new Date().toISOString()}`);const x=await fetch(`${Ie}/functions/v1/xiaoxiong-agent`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ve}`,apikey:ve},body:JSON.stringify({message:a.content,userId:l}),signal:k.current?.signal}),N=Date.now()-v;if(console.log(`[前端-Agent] ⏱️ 收到响应头: ${new Date().toISOString()}, 耗时: ${N}ms`),!x.ok)throw new Error(`Request failed with status: ${x.status}`);if(!x.body)throw new Error("No response body");const _=x.body.getReader(),D=new TextDecoder;let E="",fe=!1,I=0;for(;;){const{done:ee,value:K}=await _.read();if(ee){console.log(`[前端-Agent] ⏱️ 流结束: ${new Date().toISOString()}, 总耗时: ${Date.now()-v}ms, 共 ${I} 个数据块`);break}I++;const Y=D.decode(K,{stream:!0});if(E+=Y,!fe){fe=!0;const me=Date.now()-v;console.log(`[前端-Agent] ⏱️ 首个数据块 (TTFB): ${new Date().toISOString()}, 耗时: ${me}ms, 大小: ${Y.length} 字符`)}Oe.flushSync(()=>{j(me=>me.map(Ne=>Ne.id===c?{...Ne,content:E}:Ne))}),await new Promise(me=>requestAnimationFrame(me))}j(ee=>ee.map(K=>K.id===c?{...K,isStreaming:!1}:K))},he=async(a,c)=>{const l=Date.now();console.log(`[前端-LovableAI] ⏱️ 开始发送请求: ${new Date().toISOString()}`);const v=await fetch(`${Ie}/functions/v1/lovable-chat`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ve}`,apikey:ve},body:JSON.stringify({message:a.content,lat:z?.lat,lng:z?.lng,language:d.language}),signal:k.current?.signal}),x=Date.now()-l;if(console.log(`[前端-LovableAI] ⏱️ 收到响应头: ${new Date().toISOString()}, 耗时: ${x}ms`),!v.ok){const I=await v.json().catch(()=>({}));throw new Error(I.error||`Request failed with status: ${v.status}`)}if(!v.body)throw new Error("No response body");const N=v.body.getReader(),_=new TextDecoder;let D="",E="",fe=!1;for(;;){const{done:I,value:ee}=await N.read();if(I){console.log(`[前端-LovableAI] ⏱️ 流结束: ${new Date().toISOString()}, 总耗时: ${Date.now()-l}ms`);break}if(E+=_.decode(ee,{stream:!0}),!fe){fe=!0;const Y=Date.now()-l;console.log(`[前端-LovableAI] ⏱️ 首个数据块 (TTFB): ${new Date().toISOString()}, 耗时: ${Y}ms`)}let K;for(;(K=E.indexOf(`
`))!==-1;){let Y=E.slice(0,K);if(E=E.slice(K+1),Y.endsWith("\r")&&(Y=Y.slice(0,-1)),Y.startsWith(":")||Y.trim()===""||!Y.startsWith("data: "))continue;const me=Y.slice(6).trim();if(me==="[DONE]")break;try{const $e=JSON.parse(me).choices?.[0]?.delta?.content;$e&&(D+=$e,Oe.flushSync(()=>{j(De=>De.map(Re=>Re.id===c?{...Re,content:D}:Re))}),await new Promise(De=>requestAnimationFrame(De)))}catch{}}}j(I=>I.map(ee=>ee.id===c?{...ee,isStreaming:!1}:ee))},xe=a=>{const c=a.toLowerCase();return ys.some(l=>c.includes(l))},te=async a=>{const c={id:Date.now().toString(),role:"user",content:a},l=(Date.now()+1).toString(),v={id:l,role:"assistant",content:"",isStreaming:!0};j(x=>[...x,c,v]),b(""),A(!0),k.current&&k.current.abort(),k.current=new AbortController;try{i==="lovable-ai"?await he(c,l):i==="xiaoxiong-agent"?await ye(c,l):await oe(c,l)}catch(x){if(x instanceof Error&&x.name==="AbortError"){console.log("Request aborted");return}console.error("Ask API error:",x);const N=d.language==="zh"?"抱歉，暂时无法获取结果，请稍后再试":d.language==="pt"?"Desculpe, não foi possível obter resultados. Tente novamente mais tarde.":"Sorry, unable to get results. Please try again later.";j(_=>_.map(D=>D.id===l?{...D,content:N,isStreaming:!1}:D))}finally{A(!1)}},y=()=>{P(!1),navigator.geolocation?.getCurrentPosition(a=>{W({lat:a.coords.latitude,lng:a.coords.longitude}),O&&setTimeout(()=>{te(O),M(null)},100)},a=>{console.log("Location permission denied:",a.message),O&&(te(O),M(null))},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},L=async()=>{if(!f.trim()||C)return;const a=f.trim();if(!z&&xe(a)){M(a),P(!0),b("");return}await te(a)},X=a=>{a.key==="Enter"&&!a.shiftKey&&(a.preventDefault(),L())},R=()=>{if(U){qe.start(),T(!0);return}const a=window.SpeechRecognition||window.webkitSpeechRecognition;if(!a){console.log("Speech recognition not supported");return}G.current&&G.current.stop();const c=new a;G.current=c;const l={zh:"zh-CN",en:"en-US",pt:"pt-BR"};c.lang=l[d.language]||"zh-CN",c.continuous=!1,c.interimResults=!0,c.onstart=()=>{T(!0)},c.onresult=v=>{const x=Array.from(v.results).map(N=>N[0].transcript).join("");b(x)},c.onerror=v=>{console.log("Speech recognition error:",v.error),T(!1)},c.onend=()=>{T(!1)},c.start()},pe=()=>{if(U){qe.stop(),T(!1);return}G.current&&(G.current.stop(),T(!1))},ie=()=>{$?pe():R()},le=()=>{k.current&&k.current.abort(),r(!1)},ae=a=>{le(),o(a)},F=a=>{const c=/\[([^\]]+)\]\(([^)]+)\)/g,l=[];let v=0,x,N=0;for(;(x=c.exec(a))!==null;){x.index>v&&l.push(e.jsx("span",{children:a.slice(v,x.index)},N++));const _=x[1],D=x[2];D.startsWith("/")?l.push(e.jsx("button",{onClick:()=>ae(D),className:"text-primary hover:underline font-medium cursor-pointer",children:_},N++)):l.push(e.jsx("a",{href:D,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline font-medium",children:_},N++)),v=x.index+x[0].length}return v<a.length&&l.push(e.jsx("span",{children:a.slice(v)},N++)),l.length>0?l:[e.jsx("span",{children:a},"0")]},ce=a=>a.replace(/\*\*(.*?)\*\*/g,"$1"),de=(a,c=20)=>a.length<=c?a:a.slice(0,c)+"...",J=(a,c)=>{const l=N=>N.split("|").slice(1,-1).map(_=>ce(_.trim())),v=l(a[0]),x=a.slice(2).map(l);return e.jsx("div",{className:"overflow-x-auto my-2 max-w-full",children:e.jsxs("table",{className:"w-full text-xs border border-border rounded-md overflow-hidden table-fixed",children:[e.jsx("thead",{className:"bg-muted/60",children:e.jsx("tr",{children:v.map((N,_)=>e.jsx("th",{className:"px-2 py-2 text-left font-semibold border-b border-border truncate max-w-[100px]",title:N,children:F(de(N,15))},_))})}),e.jsx("tbody",{children:x.map((N,_)=>e.jsx("tr",{className:"border-b border-border last:border-0 hover:bg-muted/30 transition-colors",children:N.map((D,E)=>e.jsx("td",{className:"px-2 py-2 truncate max-w-[100px]",title:D,children:F(de(D,18))},E))},_))})]})},c)},ge=a=>{const c=a.split(`
`),l=[];let v=0;for(;v<c.length;){const x=c[v];if(x.trim().startsWith("|")&&x.split("|").length>2){const N=[];for(;v<c.length&&c[v].trim().startsWith("|");)N.push(c[v]),v++;N.length>=2&&l.push(J(N,l.length));continue}if(x.startsWith("### "))l.push(e.jsx("h3",{className:"text-base font-semibold mt-3 mb-1",children:F(x.slice(4))},l.length));else if(x.startsWith("## "))l.push(e.jsx("h2",{className:"text-lg font-bold mt-4 mb-2",children:F(x.slice(3))},l.length));else if(x.startsWith("# "))l.push(e.jsx("h1",{className:"text-xl font-bold mt-4 mb-2",children:F(x.slice(2))},l.length));else if(x.includes("**")){const N=x.split(/\*\*(.*?)\*\*/g);l.push(e.jsx("p",{className:"mb-1 leading-relaxed",children:N.map((_,D)=>D%2===1?e.jsx("strong",{className:"font-semibold",children:F(_)},D):F(_))},l.length))}else x.startsWith("- ")||x.startsWith("* ")?l.push(e.jsx("li",{className:"ml-4 mb-0.5 list-disc",children:F(x.slice(2))},l.length)):/^\d+\.\s/.test(x)?l.push(e.jsx("li",{className:"ml-4 mb-0.5 list-decimal",children:F(x.replace(/^\d+\.\s/,""))},l.length)):x.match(/^[-*_]{3,}$/)?l.push(e.jsx("hr",{className:"my-3 border-border"},l.length)):x.trim()===""?l.push(e.jsx("div",{className:"h-1"},l.length)):l.push(e.jsx("p",{className:"mb-1 leading-relaxed",children:F(x)},l.length));v++}return l},re=()=>d.language==="zh"?"小熊AI助手":d.language==="pt"?"Assistente IA Xiaoxiong":"Xiaoxiong AI Assistant",je=()=>d.language==="zh"?"告诉小熊，你想吃什么...":d.language==="pt"?"Diga ao Xiaoxiong o que você quer comer...":"Tell Xiaoxiong what you want to eat...",t=()=>d.language==="zh"?"你好，我是小熊，我来帮你推荐餐厅；比如：「我附近的寿司餐厅」":d.language==="pt"?"Olá, eu sou o Xiaoxiong, vou te ajudar a encontrar restaurantes; por exemplo: 「restaurantes de sushi perto de mim」":`Hi, I'm Xiaoxiong, I'll help you find restaurants; for example: "sushi restaurants near me"`;return e.jsx(It,{open:s,onOpenChange:le,children:e.jsxs(zt,{className:"w-full h-full max-w-full max-h-full sm:max-w-lg sm:h-[70vh] sm:max-h-[70vh] sm:rounded-lg rounded-none flex flex-col p-0 gap-0 overflow-hidden",children:[e.jsx(Mt,{className:"px-4 py-3 shrink-0 bg-white/60 dark:bg-gray-900/60 backdrop-blur-md border-b border-white/30 dark:border-white/20 shadow-[0_1px_3px_rgba(0,0,0,0.05)]",children:e.jsxs($t,{className:"flex items-center gap-3 text-base font-semibold",children:[e.jsx("div",{className:"w-11 h-11 rounded-full bg-white dark:bg-gray-800 flex items-center justify-center overflow-hidden shadow-sm border border-white/50 dark:border-white/30",children:e.jsx("img",{src:m,alt:"Logo",className:"w-8 h-8 object-contain"})}),e.jsx("span",{className:"text-foreground",children:re()})]})}),e.jsx(Ge,{className:"flex-1 h-0",ref:ue,children:e.jsxs("div",{className:"p-4 space-y-4",children:[S.length===0&&e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center shrink-0",children:e.jsx("img",{src:m,alt:"AI",className:"w-5 h-5 object-contain"})}),e.jsx("div",{className:"flex-1 bg-muted/50 rounded-2xl rounded-tl-sm px-4 py-3 text-sm",children:t()})]}),S.map(a=>e.jsxs("div",{className:B("flex gap-3",a.role==="user"&&"flex-row-reverse"),children:[a.role==="user"?e.jsxs(Et,{className:"w-8 h-8 shrink-0",children:[h?.avatar_url?e.jsx(Ot,{src:h.avatar_url,alt:"User avatar"}):null,e.jsx(Ft,{className:"bg-secondary/50 text-foreground",children:e.jsx(pt,{className:"h-4 w-4"})})]}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center shrink-0",children:e.jsx("img",{src:m,alt:"AI",className:"w-7 h-7 object-contain"})}),e.jsx("div",{className:B("flex-1 max-w-[85%] rounded-2xl px-4 py-3 text-sm",a.role==="user"?"bg-secondary/50 text-foreground rounded-tr-sm border border-border/50":"bg-muted/50 rounded-tl-sm"),children:a.role==="assistant"?e.jsxs(e.Fragment,{children:[a.content?e.jsx("div",{className:"prose-sm",children:ge(a.content)}):e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Ee,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:d.language==="zh"?"思考中...":d.language==="pt"?"Pensando...":"Thinking..."})]}),a.isStreaming&&a.content&&e.jsx("span",{className:"inline-block w-1.5 h-4 bg-primary/50 animate-pulse ml-0.5 align-middle"})]}):a.content})]},a.id)),e.jsx("div",{ref:se})]})}),e.jsx("div",{className:"p-4 bg-background shrink-0",children:e.jsxs("div",{className:"group flex items-center gap-3 bg-secondary/50 backdrop-blur-sm px-5 py-3.5 rounded-full shadow-sm hover:shadow-md hover:bg-secondary/70 transition-all duration-300 border border-border/50",children:[ne()&&e.jsx("button",{onClick:ie,disabled:C,className:B("shrink-0 transition-all duration-200",$&&"text-destructive animate-pulse"),title:d.language==="zh"?$?"停止录音":"语音输入":d.language==="pt"?$?"Parar gravação":"Entrada de voz":$?"Stop recording":"Voice input",children:$?e.jsx(gt,{className:"h-5 w-5"}):e.jsx(ft,{className:"h-5 w-5 text-muted-foreground group-hover:text-foreground transition-colors"})}),e.jsx("input",{value:f,onChange:a=>b(a.target.value),onKeyDown:X,placeholder:$?d.language==="zh"?"正在聆听...":d.language==="pt"?"Ouvindo...":"Listening...":je(),disabled:C,className:"flex-1 bg-transparent border-0 outline-none text-sm text-foreground placeholder:text-muted-foreground group-hover:placeholder:text-foreground/60 transition-colors",autoFocus:!0}),e.jsx("button",{onClick:L,disabled:!f.trim()||C,className:B("shrink-0 transition-all duration-200",f.trim()&&!C?"text-primary hover:text-primary/80":"text-muted-foreground/60"),children:C?e.jsx(Ee,{className:"h-5 w-5 animate-spin"}):e.jsx(bt,{className:"h-5 w-5"})})]})}),e.jsx(rt,{open:H,onOpenChange:a=>{P(a),!a&&O&&(te(O),M(null))},onConfirm:y})]})})},Ue=({restaurant:s,language:r})=>{const[i,d]=n.useState(999),o=n.useRef(null),p=s.type.slice(0,3).map((h,m)=>({key:`type-${m}`,label:h,variant:"secondary",color:void 0}));n.useEffect(()=>{const h=()=>{if(!o.current)return;const f=o.current,b=Array.from(f.querySelectorAll(".tag-badge"));if(b.length===0){setTimeout(h,50);return}const S=b[0]?.offsetTop;let j=b.length;for(let C=0;C<b.length;C++)if(b[C].offsetTop>S){j=C;break}j<b.length&&(j=Math.max(1,j-1)),d(j)};d(999);const m=setTimeout(h,100);return window.addEventListener("resize",h),()=>{clearTimeout(m),window.removeEventListener("resize",h)}},[p.length,s.id]);const u=p.slice(0,i),w=p.length>i;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{ref:o,className:"flex gap-1.5 flex-wrap flex-1",children:u.map(h=>e.jsx(V,{variant:h.variant,className:"text-xs font-medium whitespace-nowrap tag-badge",style:h.color?{backgroundColor:h.color,color:"white"}:void 0,children:h.label},h.key))}),w&&e.jsxs(ls,{children:[e.jsx(cs,{asChild:!0,children:e.jsx(Z,{variant:"ghost",size:"sm",className:"h-6 px-2 text-muted-foreground hover:text-foreground flex-shrink-0",children:e.jsx(jt,{className:"h-4 w-4"})})}),e.jsx(ds,{className:"w-80",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:p.map(h=>e.jsx(V,{variant:h.variant,className:"text-xs font-medium",style:h.color?{backgroundColor:h.color,color:"white"}:void 0,children:h.label},h.key))})})]})]})},Ns=()=>{const s=Me(),{t:r,i18n:i}=be(),{toast:d}=Vt(),{localizeRestaurant:o}=nt(),[p,u]=n.useState(""),[w,h]=n.useState([]),[m,f]=n.useState(null),[b,S]=n.useState([]),[j,C]=n.useState(null),[A,z]=n.useState(null),[W,H]=n.useState(!1),[P,O]=n.useState(!1),[M,$]=n.useState(!1),T=n.useRef(null),q=n.useRef(null),Q=n.useRef({}),[U,g]=n.useState(null),[k,ue]=n.useState(!1),[G,se]=n.useState(!1),[ne,we]=n.useState(!1),[oe,ye]=n.useState(!1),he=4,{data:xe,isLoading:te}=ms(p,w.length>0?w.join(","):void 0),{data:y=[]}=us(),{data:L=[]}=ot(),{data:X={}}=hs(),R=L.filter(t=>(X[t.id]||0)>0),pe=t=>{h(a=>a.includes(t)?a.filter(c=>c!==t):[...a,t])},ie=()=>{se(!0)},le=async()=>{se(!1);try{const t=await as();z({lat:t.coords.latitude,lng:t.coords.longitude}),d({title:r("restaurants.locationEnabled"),description:r("restaurants.sortByDistance")})}catch(t){console.error("Location error:",t)}},ae=t=>{C(t),t&&!A&&ie()},F=async t=>{if(m===t)f(null),S([]);else{f(t);const{data:a,error:c}=await Pt.from("activity_restaurants").select("restaurant_id").eq("activity_id",t);c?(console.error("Error fetching activity restaurants:",c),S([])):S(a.map(l=>l.restaurant_id))}},ce=xe?.map(t=>{const a=o(t);if(A){const c=ss(A.lat,A.lng,t.lat,t.lng);return{...a,distance:c}}return a})||[],de=m?ce.filter(t=>b.includes(t.id)):ce,J=j&&A?de.filter(t=>t.distance&&t.distance<=j).sort((t,a)=>(t.distance||0)-(a.distance||0)):A?de.sort((t,a)=>(t.distance||0)-(a.distance||0)):de.sort((t,a)=>(a.rating||0)-(t.rating||0)),ge=t=>{s(`/restaurant/${t.id}`)},re=t=>{g(t.id);const a=Q.current[t.id];a&&a.scrollIntoView({behavior:"smooth",block:"center"})},je=()=>{const t=document.getElementById("home-map-container");if(t)if(W)document.exitFullscreen&&document.exitFullscreen();else{if(T.current){const a=T.current.getCenter(),c=T.current.getZoom();q.current={center:[a.lng,a.lat],zoom:c}}t.requestFullscreen&&t.requestFullscreen()}};return n.useEffect(()=>{const t=()=>{const a=!!document.fullscreenElement;H(a),!a&&q.current&&T.current&&setTimeout(()=>{T.current?.jumpTo({center:q.current.center,zoom:q.current.zoom})},100)};return document.addEventListener("fullscreenchange",t),()=>{document.removeEventListener("fullscreenchange",t)}},[]),e.jsxs("div",{className:"animate-fade-in",children:[e.jsxs("div",{className:"text-left mb-6",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-foreground mb-2 sm:mb-3",children:r("nav.mapView")}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:r("map.subtitle")})]}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[e.jsx("div",{className:"flex-1 max-w-md",children:e.jsx(Bt,{placeholder:r("restaurants.search"),value:p,onChange:t=>u(t.target.value),className:"h-11 bg-background/60 backdrop-blur-sm border-primary/20 focus:border-primary"})}),e.jsxs("div",{className:"flex gap-2 md:contents",children:[e.jsxs(Z,{variant:A?"default":"outline",onClick:A?void 0:ie,className:"flex-1 md:flex-initial gap-2 h-11 md:px-6",children:[e.jsx(ke,{className:`w-4 h-4 ${A?"animate-pulse":""}`}),e.jsx("span",{className:"md:hidden",children:r("restaurants.getLocationMobile")}),e.jsx("span",{className:"hidden md:inline",children:r(A?"restaurants.locationEnabled":"restaurants.getLocation")})]}),e.jsxs(Z,{variant:k?"default":"outline",onClick:()=>ue(!k),className:"flex-1 md:flex-initial gap-2 h-11 md:px-6",children:[e.jsx(wt,{className:"w-4 h-4"}),r("restaurants.filter")]})]})]}),k&&e.jsxs("div",{className:"space-y-3 bg-card/50 backdrop-blur-sm rounded-lg p-4 border border-border/50 animate-fade-in",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("span",{className:"text-sm font-semibold text-foreground",children:[r("restaurants.restaurantTypes"),":"]}),w.length>0&&e.jsx(V,{variant:"outline",className:"cursor-pointer hover:bg-destructive hover:text-destructive-foreground hover:scale-105 transition-all duration-200 px-2 py-0 text-xs h-5",onClick:()=>h([]),children:r("common.actions.clearFilter")}),y.length>8&&e.jsx(Z,{variant:"ghost",size:"sm",className:"h-5 px-2 text-xs text-primary hover:text-primary/80 ml-auto hidden sm:flex transition-all duration-200",onClick:()=>O(!P),children:r(P?"common.showLess":"common.showMore")})]}),e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx("div",{className:`hidden sm:flex gap-2 flex-wrap transition-all duration-300 ease-out ${P?"animate-expand-height":""}`,children:(P?y:y.slice(0,8)).map((t,a)=>e.jsx(V,{variant:w.includes(t)?"default":"secondary",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs whitespace-nowrap hover:scale-105 active:animate-tag-select ${w.includes(t)?"ring-2 ring-primary/30 shadow-sm":""}`,style:{animationDelay:`${a*30}ms`},onClick:()=>pe(t),children:t},t))}),e.jsxs("div",{className:"sm:hidden relative -mx-1 px-1",children:[e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide snap-x snap-mandatory scroll-smooth",children:y.map((t,a)=>e.jsx(V,{variant:w.includes(t)?"default":"secondary",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs whitespace-nowrap flex-shrink-0 snap-start hover:scale-105 active:animate-tag-select ${w.includes(t)?"ring-2 ring-primary/30 shadow-sm":""}`,style:{animationDelay:`${a*30}ms`},onClick:()=>pe(t),children:t},t))}),e.jsx("div",{className:"absolute left-0 top-0 bottom-2 w-4 bg-gradient-to-r from-card via-card/60 to-transparent pointer-events-none"}),e.jsx("div",{className:"absolute right-0 top-0 bottom-2 w-4 bg-gradient-to-l from-card via-card/60 to-transparent pointer-events-none"})]})]})]}),R.length>0&&e.jsxs("div",{className:"space-y-2 pt-1 border-t border-border/30",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("span",{className:"text-sm font-semibold text-foreground",children:[r("nav.activities"),":"]}),m&&e.jsx(V,{variant:"outline",className:"cursor-pointer hover:bg-destructive hover:text-destructive-foreground hover:scale-105 transition-all duration-200 px-2 py-0 text-xs h-5",onClick:()=>{f(null),S([])},children:r("common.actions.clearFilter")}),R.length>8&&e.jsx(Z,{variant:"ghost",size:"sm",className:"h-5 px-2 text-xs text-primary hover:text-primary/80 ml-auto hidden sm:flex transition-all duration-200",onClick:()=>$(!M),children:r(M?"common.showLess":"common.showMore")})]}),e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx("div",{className:`hidden sm:flex gap-2 flex-wrap transition-all duration-300 ease-out ${M?"animate-expand-height":""}`,children:(M?R:R.slice(0,8)).map((t,a)=>{const c=i.language==="zh"?t.badge_text_zh||t.title_zh:i.language==="pt"?t.badge_text_pt||t.title_pt:t.badge_text_en||t.title_en;return e.jsx(V,{variant:m===t.id?"default":"secondary",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs whitespace-nowrap hover:scale-105 active:animate-tag-select ${m===t.id?"ring-2 ring-primary/30 shadow-sm":""}`,style:{animationDelay:`${a*30}ms`},onClick:()=>F(t.id),children:c},t.id)})}),e.jsxs("div",{className:"sm:hidden relative -mx-1 px-1",children:[e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide snap-x snap-mandatory scroll-smooth",children:R.map((t,a)=>{const c=i.language==="zh"?t.badge_text_zh||t.title_zh:i.language==="pt"?t.badge_text_pt||t.title_pt:t.badge_text_en||t.title_en;return e.jsx(V,{variant:m===t.id?"default":"secondary",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs whitespace-nowrap flex-shrink-0 snap-start hover:scale-105 active:animate-tag-select ${m===t.id?"ring-2 ring-primary/30 shadow-sm":""}`,style:{animationDelay:`${a*30}ms`},onClick:()=>F(t.id),children:c},t.id)})}),e.jsx("div",{className:"absolute left-0 top-0 bottom-2 w-4 bg-gradient-to-r from-card via-card/60 to-transparent pointer-events-none"}),e.jsx("div",{className:"absolute right-0 top-0 bottom-2 w-4 bg-gradient-to-l from-card via-card/60 to-transparent pointer-events-none"})]})]})]})]}),A&&e.jsxs("div",{className:"flex gap-2 flex-wrap items-center bg-muted/30 backdrop-blur-sm rounded-lg p-3 border border-primary/10",children:[e.jsxs("span",{className:"text-sm font-semibold text-primary",children:[r("restaurants.radius"),":"]}),e.jsx(V,{variant:j===null?"default":"secondary",className:"cursor-pointer hover:scale-105 transition-transform",onClick:()=>ae(null),children:r("restaurants.allRestaurants")}),e.jsx(V,{variant:j===5?"default":"secondary",className:"cursor-pointer hover:scale-105 transition-transform",onClick:()=>ae(5),children:r("restaurants.radius5km")}),e.jsx(V,{variant:j===10?"default":"secondary",className:"cursor-pointer hover:scale-105 transition-transform",onClick:()=>ae(10),children:r("restaurants.radius10km")}),e.jsx(V,{variant:j===20?"default":"secondary",className:"cursor-pointer hover:scale-105 transition-transform",onClick:()=>ae(20),children:r("restaurants.radius20km")})]})]}),!te&&J&&e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[e.jsx("div",{className:`w-full lg:flex-1 transition-all duration-300 ease-in-out ${ne?"h-0 overflow-hidden lg:h-[500px]":"h-[400px] lg:h-[500px]"}`,children:e.jsxs("div",{id:"home-map-container",className:`${W?"fixed inset-0 z-50 bg-background":"w-full h-full"} rounded-xl overflow-hidden shadow-2xl border border-primary/10 relative group`,children:[e.jsx(Z,{variant:"secondary",size:"icon",className:"absolute bottom-4 right-4 z-10 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity",onClick:je,children:W?e.jsx(yt,{className:"w-5 h-5"}):e.jsx(vt,{className:"w-5 h-5"})}),e.jsxs("div",{className:"h-full relative",children:[e.jsx(xs,{restaurants:J,onRestaurantClick:ge,userLocation:A,radiusFilter:j,onMarkerClick:re,showViewDetailsButton:!0,onMapInit:t=>{T.current=t}}),e.jsxs("div",{className:"absolute bottom-4 left-4 z-10 pointer-events-none flex items-center gap-2 bg-background/80 backdrop-blur-sm px-3 py-2 rounded-full shadow-lg",children:[e.jsx("img",{src:ps,alt:"Xiaoxiong Market Logo",className:"h-6 w-6 object-contain"}),e.jsx("span",{className:"text-sm font-semibold text-foreground whitespace-nowrap",children:i.language==="zh"?"小熊市场":"Xiaoxiong Market"})]})]})]})}),e.jsx(Z,{variant:"outline",size:"sm",className:"lg:hidden flex items-center justify-center gap-2 -mt-3 mb-1",onClick:()=>we(!ne),children:ne?e.jsxs(e.Fragment,{children:[e.jsx(Fe,{className:"w-4 h-4"}),r("map.showMap")]}):e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"w-4 h-4"}),r("map.hideMap")]})}),e.jsxs("div",{className:"w-full lg:w-[420px] flex flex-col",children:[e.jsxs("div",{className:"mb-4 pb-4 border-b border-border",children:[e.jsxs("h2",{className:"text-xl sm:text-2xl font-bold text-foreground flex items-center gap-2",children:[e.jsx(_e,{className:"w-6 h-6 text-primary"}),r("restaurants.title"),e.jsx(V,{variant:"secondary",className:"ml-2",children:J.length})]}),A&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-2 flex items-center gap-1.5",children:[e.jsx(ke,{className:"w-4 h-4"}),r("restaurants.sortedByDistance")]})]}),J.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(_e,{className:"w-16 h-16 text-muted-foreground/40 mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-foreground mb-2",children:r("restaurants.noResults")}),e.jsx("p",{className:"text-muted-foreground max-w-xs",children:r("restaurants.noResultsDesc")})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"lg:hidden space-y-3 pb-4",children:[(oe?J:J.slice(0,he)).map(t=>e.jsx(Ae,{ref:a=>Q.current[t.id]=a,className:`p-5 cursor-pointer hover:shadow-xl transition-all duration-300 hover:scale-[1.02] hover:border-primary/40 border-2 bg-gradient-to-br from-card to-card/50 backdrop-blur-sm ${U===t.id?"border-primary ring-2 ring-primary ring-offset-2":"border-transparent"}`,onClick:()=>ge(t),children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h3",{className:"font-bold text-lg text-foreground line-clamp-1 flex-1",children:t.name}),t.distance!==void 0&&e.jsxs("div",{className:"flex items-center gap-1.5 bg-primary/10 px-2.5 py-1 rounded-full w-fit",children:[e.jsx(ke,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"font-bold text-sm text-primary",children:t.distance<1?`${(t.distance*1e3).toFixed(0)} m`:`${t.distance.toFixed(1)} km`})]})]}),t.rating>0&&e.jsxs("div",{className:"flex items-center gap-1.5 bg-primary/10 px-2.5 py-1 rounded-full flex-shrink-0",children:[e.jsx(Be,{className:"w-4 h-4",style:{fill:"#016450",color:"#016450"}}),e.jsx("span",{className:"font-bold text-sm text-primary",children:t.rating})]})]}),t.type&&t.type.length>0&&e.jsx(Ue,{restaurant:t,language:i.language}),e.jsxs("div",{className:"flex items-start gap-2 text-sm text-muted-foreground",children:[e.jsx(_e,{className:"w-4 h-4 mt-0.5 flex-shrink-0 text-primary/60"}),e.jsx("span",{className:"line-clamp-2",children:t.address})]})]})},t.id)),J.length>he&&e.jsx(Z,{variant:"outline",className:"w-full mt-2 gap-2",onClick:()=>ye(!oe),children:oe?e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"w-4 h-4"}),r("map.collapseList")]}):e.jsxs(e.Fragment,{children:[e.jsx(Fe,{className:"w-4 h-4"}),r("map.showAllRestaurants",{count:J.length})]})})]}),e.jsx(Ge,{className:"hidden lg:block h-[420px] pr-4",children:e.jsx("div",{className:"space-y-3 pb-4",children:J.map(t=>e.jsx(Ae,{ref:a=>Q.current[t.id]=a,className:`p-5 cursor-pointer hover:shadow-xl transition-all duration-300 hover:scale-[1.02] hover:border-primary/40 border-2 bg-gradient-to-br from-card to-card/50 backdrop-blur-sm ${U===t.id?"border-primary ring-2 ring-primary ring-offset-2":"border-transparent"}`,onClick:()=>ge(t),children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h3",{className:"font-bold text-lg text-foreground line-clamp-1 flex-1",children:t.name}),t.distance!==void 0&&e.jsxs("div",{className:"flex items-center gap-1.5 bg-primary/10 px-2.5 py-1 rounded-full w-fit",children:[e.jsx(ke,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"font-bold text-sm text-primary",children:t.distance<1?`${(t.distance*1e3).toFixed(0)} m`:`${t.distance.toFixed(1)} km`})]})]}),t.rating>0&&e.jsxs("div",{className:"flex items-center gap-1.5 bg-primary/10 px-2.5 py-1 rounded-full flex-shrink-0",children:[e.jsx(Be,{className:"w-4 h-4",style:{fill:"#016450",color:"#016450"}}),e.jsx("span",{className:"font-bold text-sm text-primary",children:t.rating})]})]}),t.type&&t.type.length>0&&e.jsx(Ue,{restaurant:t,language:i.language}),e.jsxs("div",{className:"flex items-start gap-2 text-sm text-muted-foreground",children:[e.jsx(_e,{className:"w-4 h-4 mt-0.5 flex-shrink-0 text-primary/60"}),e.jsx("span",{className:"line-clamp-2",children:t.address})]})]})},t.id))})})]})]})]}),e.jsx(rt,{open:G,onOpenChange:se,onConfirm:le})]})},ks=({open:s,onOpenChange:r,onConfirm:i,siteName:d,url:o})=>{const{t:p}=be();let u=d||"";if(o)try{u=new URL(o).hostname}catch{u=o}return e.jsx(Wt,{open:s,onOpenChange:r,children:e.jsxs(Ht,{className:"max-w-[320px] w-[calc(100%-2rem)] mx-auto border-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-2xl shadow-2xl rounded-[28px] overflow-hidden p-6",children:[e.jsx("div",{className:"absolute inset-0 rounded-[28px] bg-gradient-to-b from-white/40 via-transparent to-transparent pointer-events-none"}),e.jsxs(qt,{className:"relative text-center space-y-3",children:[e.jsx("div",{className:"mx-auto w-14 h-14 rounded-2xl bg-gradient-to-br from-primary/20 to-primary/10 dark:from-primary/30 dark:to-primary/20 flex items-center justify-center shadow-sm shrink-0",style:{transform:"translateZ(0)",willChange:"transform"},children:e.jsx(Xe,{className:"w-7 h-7 text-primary shrink-0",strokeWidth:1.5})}),e.jsxs("div",{className:"space-y-1.5 px-1",children:[e.jsx(Ut,{className:"text-base font-semibold tracking-tight text-foreground",children:p("externalLink.confirmTitle")}),e.jsx(Xt,{className:"text-sm text-muted-foreground/80 leading-relaxed break-words",children:p("externalLink.confirmDescription",{site:u})})]})]}),e.jsxs(Jt,{className:"relative flex-col sm:flex-col gap-2 pt-4 mt-1 sm:space-x-0",children:[e.jsx(Kt,{onClick:i,className:"w-full rounded-xl h-11 bg-primary hover:bg-primary/90 text-primary-foreground font-medium shadow-lg shadow-primary/20 transition-all duration-200",children:p("externalLink.continue")}),e.jsx(Qt,{className:"w-full rounded-xl h-11 bg-black/5 dark:bg-white/10 hover:bg-black/10 dark:hover:bg-white/15 border-0 text-muted-foreground font-medium transition-all duration-200 mt-0",children:p("common.cancel")})]})]})})},it=n.memo(({stats:s,onAskXiaoxiong:r})=>{const{t:i,i18n:d}=be(),{data:o}=at(),{buttons:p}=Yt(),u=d.language,[w,h]=n.useState(!1),m=p?.find(H=>H.label_zh==="演示"||H.link?.includes("v.xiaoxiong.pt")),f=m&&m.enabled!==!1&&m.visible!==!1&&m.show_on_mobile!==!1,b=()=>m?u==="zh"?m.label_zh:u==="pt"?m.label_pt:m.label_en:i("home.hero.demo","前往演示"),S=H=>!o||o.length===0?"":o[0][`${H}${u==="zh"?"_zh":u==="pt"?"_pt":"_en"}`]||"",j=S("title")||i("home.hero.title"),C=S("description")||i("home.hero.description"),A=S("subtitle_button_text")||i("home.hero.subtitle"),z=()=>{h(!0)},W=()=>{m?.link&&Zt(m.link),h(!1)};return e.jsxs("section",{className:"min-h-[55vh] flex flex-col bg-secondary/20",children:[e.jsxs("div",{className:"pt-20 px-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl font-bold text-foreground",children:i("home.hero.brandName")}),e.jsx("img",{src:st,alt:"map icon",width:28,height:28,loading:"eager",decoding:"async",className:"w-7 h-7 object-contain flex-shrink-0"})]}),f&&m&&e.jsxs(Z,{variant:"outline",size:"sm",className:"gap-1.5 text-xs",onClick:z,children:[e.jsx(Xe,{className:"w-3.5 h-3.5"}),b()]})]}),s&&e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Ce,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:i("home.stats.delivery")}),e.jsx("span",{className:"font-bold text-foreground text-sm",children:s.order_count})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Je,{className:"w-4 h-4 text-accent"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:i("home.stats.reservation")}),e.jsx("span",{className:"font-bold text-foreground text-sm",children:s.reserve_count})]})]})]}),e.jsx("div",{className:"flex-1 flex flex-col items-center justify-center px-4 py-8",children:e.jsxs("div",{className:"max-w-md mx-auto text-center space-y-4",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground leading-tight",children:j}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground max-w-sm mx-auto",children:C}),e.jsx("div",{className:"pt-4",children:e.jsxs("button",{onClick:r,className:"group flex items-center gap-3 bg-secondary/50 backdrop-blur-sm text-foreground px-5 py-3.5 rounded-full shadow-sm hover:shadow-md hover:bg-secondary/70 transition-all duration-300 cursor-text border border-border/50 mx-auto",children:[e.jsx(Ke,{className:"w-5 h-5 text-primary group-hover:text-primary/80 transition-colors"}),e.jsx("span",{className:"text-sm text-muted-foreground group-hover:text-foreground transition-colors",children:A}),e.jsx(Qe,{className:"w-4 h-4 text-muted-foreground/60 ml-2"})]})})]})}),e.jsx(ks,{open:w,onOpenChange:h,onConfirm:W,url:m?.link})]})});it.displayName="MobileHeroSection";const _s=s=>!s||!Array.isArray(s)?!1:s.every(r=>typeof r=="object"&&r!==null&&"start"in r&&"end"in r&&typeof r.start=="number"&&typeof r.end=="number"),Ss=(s,r)=>{const i=Te(new Date(s.start_date)),d=s.end_date?Te(new Date(s.end_date)):null,o=Te(r);if(o<i||d&&o>d)return!1;switch(s.repeat_mode||"none"){case"none":return bs(i,o);case"daily":return!0;case"weekly":const u=fs(o);return s.repeat_weekday===u;case"monthly":const h=He(o),m=s.repeat_month_day;return _s(m)?m.some(C=>h>=C.start&&h<=C.end):!1;case"yearly":const f=gs(o)+1,b=He(o),S=s.repeat_yearly_month,j=s.repeat_yearly_day;return S===f&&j===b;default:return!1}},Se=s=>{switch(s.repeat_mode||"none"){case"none":return 0;case"weekly":return 1;case"monthly":return 2;case"yearly":return 3;case"daily":return 4;default:return 5}},Cs=()=>{const{data:s,isLoading:r}=ot(),i=n.useMemo(()=>{if(!s)return{today:[],tomorrow:[],dayAfterTomorrow:[]};const o=new Date,p=We(o,1),u=We(o,2),w=h=>s.filter(m=>m.visible&&m.status==="published").filter(m=>Ss(m,h)).sort((m,f)=>{const b=Se(m)-Se(f);return b!==0?b:m.pinned!==f.pinned?m.pinned?-1:1:(m.sort_order||0)-(f.sort_order||0)});return{today:w(o),tomorrow:w(p),dayAfterTomorrow:w(u)}},[s]),d=n.useMemo(()=>{const o=new Set,p=[];return i.today.forEach(u=>{o.has(u.id)||(o.add(u.id),p.push({...u,dayLabel:"today"}))}),i.tomorrow.forEach(u=>{o.has(u.id)||(o.add(u.id),p.push({...u,dayLabel:"tomorrow"}))}),i.dayAfterTomorrow.forEach(u=>{o.has(u.id)||(o.add(u.id),p.push({...u,dayLabel:"dayAfterTomorrow"}))}),p.sort((u,w)=>{const h=Se(u)-Se(w);return h!==0?h:u.pinned!==w.pinned?u.pinned?-1:1:(u.sort_order||0)-(w.sort_order||0)})},[i]);return{recentActivities:i,allRecentActivities:d,isLoading:r,hasActivities:d.length>0}},lt=()=>{const[s,r]=n.useState(4);return n.useEffect(()=>{const i=()=>{const d=window.innerWidth;d<640?r(2):d<1024?r(3):r(4)};return i(),window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[]),s},ct=n.memo(({activity:s,dayLabel:r})=>{const i=Me(),{t:d}=be(),{getLocalizedField:o}=nt(),p=o(s,"title"),u=n.useMemo(()=>{switch(s.service_type){case"dine_in":return d("activities.serviceType.dine_in");case"takeaway":return d("activities.serviceType.takeaway");case"both":return d("activities.serviceType.both");default:return""}},[s.service_type,d]),w=()=>{i(`/activity/${s.id}`)};return e.jsxs(Ae,{className:"group cursor-pointer overflow-hidden hover:shadow-lg transition-all duration-300 border-border/50 bg-card",onClick:w,children:[e.jsxs("div",{className:"relative aspect-[16/10] overflow-hidden bg-muted",children:[s.image_url?e.jsx("img",{src:s.image_url,alt:p,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",loading:"lazy"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-primary/20 to-primary/5",children:e.jsx(Nt,{className:"w-12 h-12 text-primary/40"})}),e.jsx(V,{className:B("absolute top-2 left-2 text-xs font-medium",r===d("home.recentActivities.today")?"bg-primary text-primary-foreground":"bg-secondary text-secondary-foreground"),children:r}),s.pinned&&e.jsx(V,{className:"absolute top-2 right-2 text-xs bg-accent text-accent-foreground",children:d("activities.pinned")})]}),e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx("h3",{className:"font-medium text-sm leading-tight line-clamp-2 text-foreground group-hover:text-primary transition-colors",children:p}),e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[s.service_type==="dine_in"&&e.jsx(Pe,{className:"w-3 h-3 flex-shrink-0"}),s.service_type==="takeaway"&&e.jsx(Ce,{className:"w-3 h-3 flex-shrink-0"}),s.service_type==="both"&&e.jsxs(e.Fragment,{children:[e.jsx(Pe,{className:"w-3 h-3 flex-shrink-0"}),e.jsx(Ce,{className:"w-3 h-3 flex-shrink-0"})]}),e.jsx("span",{className:"truncate",children:u})]})]})]})});ct.displayName="ActivityCard";const dt=n.memo(()=>{const s=lt();return e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4",children:Array.from({length:s}).map((r,i)=>e.jsxs(Ae,{className:"overflow-hidden",children:[e.jsx(Le,{className:"aspect-[16/10] w-full"}),e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx(Le,{className:"h-4 w-full"}),e.jsx(Le,{className:"h-3 w-2/3"})]})]},i))})});dt.displayName="LoadingSkeleton";const mt=n.memo(()=>{const{t:s}=be(),{allRecentActivities:r,isLoading:i,hasActivities:d}=Cs(),o=lt(),[p,u]=n.useState(!1),w=f=>{switch(f){case"today":return s("home.recentActivities.today");case"tomorrow":return s("home.recentActivities.tomorrow");case"dayAfterTomorrow":return s("home.recentActivities.dayAfterTomorrow");default:return""}},h=n.useMemo(()=>p?r:r.slice(0,o),[r,o,p]),m=r.length>o;return!i&&!d?null:e.jsx("section",{className:"py-8 sm:py-12 px-4 bg-secondary/20",children:e.jsxs("div",{className:"container mx-auto max-w-7xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-foreground",children:s("home.recentActivities.title")}),m&&!p&&e.jsx(Z,{variant:"ghost",size:"sm",className:"text-primary hover:text-primary/80",onClick:()=>u(!0),children:e.jsxs("span",{className:"flex items-center gap-1",children:[s("home.recentActivities.viewAll"),e.jsx(kt,{className:"w-4 h-4"})]})}),p&&e.jsx(Z,{variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-foreground",onClick:()=>u(!1),children:e.jsx("span",{className:"flex items-center gap-1",children:s("home.recentActivities.collapse")})})]}),i?e.jsx(dt,{}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4",children:h.map(f=>e.jsx(ct,{activity:f,dayLabel:w(f.dayLabel)},f.id))})]})})});mt.displayName="RecentActivitiesSection";const ze="/images/sushi-ramen-hero.jpg",ut="/images/sushi-ramen-mobile.jpg",ht=n.memo(({stats:s,t:r})=>e.jsx("div",{className:"absolute top-16 sm:top-20 left-3 z-20",children:e.jsxs("div",{className:"gap-4 w-fit flex-col flex items-start justify-start",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm text-white/90 drop-shadow-md",children:r("home.stats.delivery")}),e.jsx("span",{className:"font-bold text-white text-sm drop-shadow-md",children:s.order_count})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Je,{className:"w-4 h-4 text-accent"}),e.jsx("span",{className:"text-sm text-white/90 drop-shadow-md",children:r("home.stats.reservation")}),e.jsx("span",{className:"font-bold text-white text-sm drop-shadow-md",children:s.reserve_count})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl sm:text-2xl font-bold text-white drop-shadow-md",children:r("home.hero.brandName")}),e.jsx("img",{src:st,alt:"map icon",width:32,height:32,loading:"eager",decoding:"async",className:"w-7 sm:w-8 h-7 sm:h-8 object-contain flex-shrink-0"})]})]})}));ht.displayName="StatsDisplay";const As=()=>{const s=window.innerWidth<640,r=window.innerWidth>=1024,i=navigator.connection,d=tt(),o=et();return r?!!i?.saveData:!!(o&&!d||i&&(i.saveData||i.effectiveType==="2g"||i.effectiveType==="slow-2g")||s&&navigator.deviceMemory&&navigator.deviceMemory<2)},xt=n.memo(({template:s,isActive:r,currentLang:i,t:d,onContentReady:o,onAskXiaoxiong:p})=>{const[u,w]=n.useState({}),[h,m]=n.useState({}),[f,b]=n.useState({}),[S,j]=n.useState({mobile:!0,tablet:!0,desktop:!0}),[C,A]=n.useState(!1),z=As(),W=n.useRef(null),H=n.useRef(null),P=n.useRef(null),O=y=>s[`${y}${i==="zh"?"_zh":i==="pt"?"_pt":"_en"}`]||"",M=()=>window.innerWidth<640?"mobile":window.innerWidth<1024?"tablet":"desktop",$=()=>{const y=M();return y==="mobile"&&s.mobile_overlay_opacity!==null?s.mobile_overlay_opacity:y==="tablet"&&s.tablet_overlay_opacity!==null?s.tablet_overlay_opacity:y==="desktop"&&s.desktop_overlay_opacity!==null?s.desktop_overlay_opacity:s.overlay_opacity??30},T=()=>{const y=$(),L=s.overlay_gradient_direction||"to-b",X=(re,je)=>re==null?je/100:re>1?re/100:re,R=y>1?y/100:y,pe=X(s.overlay_gradient_from_opacity,30)*R,ie=X(s.overlay_gradient_via_opacity,25)*R,le=X(s.overlay_gradient_to_opacity,40)*R,F={"to-t":"to top","to-b":"to bottom","to-l":"to left","to-r":"to right","to-tl":"to top left","to-tr":"to top right","to-bl":"to bottom left","to-br":"to bottom right"}[L]||"to bottom",ce={black:"0, 0, 0",white:"255, 255, 255",background:"0, 0, 0",foreground:"255, 255, 255",primary:"1, 100, 80",secondary:"240, 240, 240"},de=ce[s.overlay_gradient_from||"black"]||"0, 0, 0",J=ce[s.overlay_gradient_via||"black"]||"0, 0, 0",ge=ce[s.overlay_gradient_to||"black"]||"0, 0, 0";return{background:`linear-gradient(${F}, rgba(${de}, ${pe}), rgba(${J}, ${ie}), rgba(${ge}, ${le}))`}},q=s.mobile_image_url||ut,Q=s.tablet_image_url||s.desktop_image_url||ze,U=s.desktop_image_url||ze,g=s.background_blur||0,k=s.desktop_media_type||s.media_type||"image",ue=s.tablet_media_type||s.media_type||"image",G=s.mobile_media_type||s.media_type||"image",se=k==="video"&&!z,ne=ue==="video"&&!z,we=G==="video"&&!z,oe=we?s.mobile_video_url:null,ye=ne?s.tablet_video_url||s.desktop_video_url:null,he=se?s.desktop_video_url:null;n.useEffect(()=>{const y=M(),L=y==="mobile"?q:y==="tablet"?Q:U;if(L){const X=new Image;X.onload=()=>{w(R=>({...R,[y]:!0})),j(R=>({...R,[y]:!0})),r&&(o?.(),setTimeout(()=>A(!0),100))},X.src=L}},[q,Q,U,r,o]),n.useEffect(()=>{r&&u[M()]&&A(!0)},[r,u]);const xe=y=>{m(L=>({...L,[y]:!0}))},te=(y,L)=>{console.error(`[HeroSlide] Video error on ${y}:`,L),b(X=>({...X,[y]:!0}))};return n.useEffect(()=>{if(!C||!r||!ts())return;const L=M(),R=(L==="mobile"?W:L==="tablet"?H:P).current;if(!R)return;const ie=setTimeout(async()=>{try{R.muted=!0,R.playsInline=!0,R.setAttribute("webkit-playsinline","true"),await R.play(),console.log(`[HeroSlide] iOS video play successful on ${L}`)}catch(le){console.error(`[HeroSlide] iOS video play failed on ${L}:`,le),b(ae=>({...ae,[L]:!0}))}},150);return()=>clearTimeout(ie)},[C,r]),e.jsxs("div",{className:B("absolute inset-0 w-full h-full transition-opacity duration-1000",r?"opacity-100 z-10":"opacity-0 z-0"),children:[e.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[e.jsxs("div",{className:"absolute inset-0 w-full h-full sm:hidden",children:[!S.mobile&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),we&&oe?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:q,alt:"Background",className:B("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",h.mobile&&!f.mobile?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:g>0?`blur(${g}px)`:void 0}}),C&&!f.mobile&&e.jsx("video",{ref:W,src:oe,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>xe("mobile"),onError:y=>te("mobile",y),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:g>0?`blur(${g}px)`:void 0}})]}):e.jsx("img",{src:q,alt:"Background",className:B("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",S.mobile?"opacity-100":"opacity-0"),style:{filter:g>0?`blur(${g}px)`:void 0}})]}),e.jsxs("div",{className:"absolute inset-0 w-full h-full hidden sm:block lg:hidden",children:[!S.tablet&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),ne&&ye?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:Q,alt:"Background",className:B("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",h.tablet&&!f.tablet?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:g>0?`blur(${g}px)`:void 0}}),C&&!f.tablet&&e.jsx("video",{ref:H,src:ye,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>xe("tablet"),onError:y=>te("tablet",y),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:g>0?`blur(${g}px)`:void 0}})]}):e.jsx("img",{src:Q,alt:"Background",className:B("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",S.tablet?"opacity-100":"opacity-0"),style:{filter:g>0?`blur(${g}px)`:void 0}})]}),e.jsxs("div",{className:"absolute inset-0 w-full h-full hidden lg:block",children:[!S.desktop&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),se&&he?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:U,alt:"Background",className:B("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",h.desktop&&!f.desktop?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:g>0?`blur(${g}px)`:void 0}}),C&&!f.desktop&&e.jsx("video",{ref:P,src:he,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>xe("desktop"),onError:y=>te("desktop",y),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:g>0?`blur(${g}px)`:void 0}})]}):e.jsx("img",{src:U,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:B("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",S.desktop?"opacity-100":"opacity-0"),style:{filter:g>0?`blur(${g}px)`:void 0}})]}),e.jsx("div",{className:"absolute inset-0 w-full h-full",style:T()})]}),e.jsx("div",{className:"relative z-10 container mx-auto px-4 sm:px-6 flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center space-y-4 sm:space-y-8 animate-fade-in w-full",children:[e.jsx("h1",{className:"text-3xl sm:text-5xl md:text-7xl font-bold text-white leading-tight px-4 drop-shadow-[0_2px_8px_rgba(0,0,0,0.8)]",children:O("title")||d("home.hero.title")}),e.jsx("p",{className:"text-sm sm:text-xl md:text-2xl text-white/95 max-w-2xl mx-auto px-4 drop-shadow-[0_2px_6px_rgba(0,0,0,0.7)]",children:O("description")||d("home.hero.description")}),s.subtitle_button_text_zh&&e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:p,className:"group flex items-center gap-3 bg-white/20 backdrop-blur-xl text-white px-5 sm:px-7 py-3.5 sm:py-4 rounded-full shadow-[0_8px_32px_rgba(0,0,0,0.12)] hover:shadow-[0_16px_48px_rgba(0,0,0,0.2)] hover:bg-white/30 transition-all duration-300 cursor-text border border-white/40",children:[e.jsx(Ke,{className:"w-5 h-5 text-white/90 group-hover:text-white transition-colors drop-shadow-sm"}),e.jsx("span",{className:"text-sm sm:text-base text-primary group-hover:text-primary/80 transition-colors drop-shadow-sm font-medium",children:O("subtitle_button_text")||d("home.hero.subtitle")}),e.jsx(Qe,{className:"w-4 h-4 text-white/60 ml-2 drop-shadow-sm"})]})})]})})]})});xt.displayName="HeroSlide";const Xs=()=>{const{t:s,i18n:r}=be(),i=_t(),{settings:d}=Ye(),{data:o,isLoading:p,refetch:u}=at(),[w,h]=n.useState(0),[m,f]=n.useState(null),b=n.useRef(null),[S,j]=n.useState(!1),[C,A]=n.useState(!1),z=Ze(),{isWebView:W}=Gt(),H=z||W,P=d?.ai_assistant_enabled!==!1,O=d?.ai_provider||"ask-xiaoxiong",M=n.useCallback(()=>{j(!0)},[]);os({pageType:"home"});const $=n.useCallback(async()=>{try{const k=await(await fetch("https://v.xiaoxiong.pt/api/get_info")).json();k&&f({order_count:k.order_count||0,reserve_count:k.reserve_count||0})}catch(g){console.error("Failed to fetch stats:",g)}},[]);n.useEffect(()=>{$()},[$]);const T=n.useCallback(async()=>{await Promise.all([u(),$(),i.invalidateQueries({queryKey:["restaurants"]}),i.invalidateQueries({queryKey:["activities"]})])},[u,$,i]);n.useEffect(()=>{if(!o||o.length<=1)return;const k=o[w]?.duration||5e3;return b.current=setTimeout(()=>{h(ue=>(ue+1)%o.length)},k),()=>{b.current&&clearTimeout(b.current)}},[o,w]);const q=n.useCallback(g=>{b.current&&clearTimeout(b.current),h(g)},[]);n.useCallback(()=>{o&&(b.current&&clearTimeout(b.current),h(g=>(g-1+o.length)%o.length))},[o]),n.useCallback(()=>{o&&(b.current&&clearTimeout(b.current),h(g=>(g+1)%o.length))},[o]);const Q=r.language,U=o&&o.length>1;return e.jsx(is,{onRefresh:T,children:e.jsxs("div",{className:"min-h-screen",children:[H?e.jsx(it,{stats:m,onAskXiaoxiong:()=>A(!0)}):e.jsxs("section",{className:"relative h-screen flex items-start overflow-hidden bg-background",children:[m&&e.jsx(ht,{stats:m,t:s}),e.jsx("div",{className:B("absolute inset-0 w-full h-full transition-opacity duration-500",S?"opacity-100":"opacity-0"),children:o?.map((g,k)=>e.jsx(xt,{template:g,isActive:k===w,currentLang:Q,t:s,onContentReady:k===0?M:void 0,onAskXiaoxiong:()=>A(!0)},g.id))}),e.jsx("div",{className:B("absolute inset-0 w-full h-full z-20 transition-opacity duration-500",p||!S?"opacity-100":"opacity-0 pointer-events-none"),children:e.jsx(es,{})}),!p&&(!o||o.length===0)&&e.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[e.jsx("img",{src:ut,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:"absolute inset-0 w-full h-full object-cover object-center sm:hidden"}),e.jsx("img",{src:ze,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:"absolute inset-0 w-full h-full object-cover object-center hidden sm:block"}),e.jsx("div",{className:"absolute inset-0 w-full h-full bg-gradient-to-b from-black/30 via-black/25 to-black/40"}),e.jsx("div",{className:"relative z-10 container mx-auto px-4 sm:px-6 flex items-center min-h-screen",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center space-y-4 sm:space-y-8 animate-fade-in w-full",children:[e.jsx("h1",{className:"text-3xl sm:text-5xl md:text-7xl font-bold text-white leading-tight px-4 drop-shadow-[0_2px_8px_rgba(0,0,0,0.8)]",children:s("home.hero.title")}),e.jsx("p",{className:"text-sm sm:text-xl md:text-2xl text-white/95 max-w-2xl mx-auto px-4 drop-shadow-[0_2px_6px_rgba(0,0,0,0.7)]",children:s("home.hero.description")})]})})]}),U&&e.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 z-30 flex gap-2",children:o.map((g,k)=>e.jsx("button",{onClick:()=>q(k),className:B("w-3 h-3 rounded-full transition-all duration-300",k===w?"bg-white w-8":"bg-white/50 hover:bg-white/70"),"aria-label":`Go to slide ${k+1}`},k))})]}),e.jsx(mt,{}),e.jsx("section",{className:"py-12 sm:py-20 px-4 bg-secondary/20",children:e.jsx("div",{className:"container mx-auto max-w-7xl",children:e.jsx(Ns,{})})}),!et()&&!tt()&&e.jsxs("section",{className:"py-16 sm:py-24 px-4 bg-gradient-to-br from-primary/5 via-background to-primary/10 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-1/4 w-72 h-72 bg-primary/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 right-1/4 w-96 h-96 bg-primary/5 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute top-1/2 left-0 w-32 h-32 bg-primary/20 rounded-full blur-2xl -translate-y-1/2"}),e.jsx("div",{className:"absolute top-1/2 right-0 w-32 h-32 bg-primary/20 rounded-full blur-2xl -translate-y-1/2"}),e.jsx("div",{className:"container mx-auto max-w-5xl relative z-10",children:e.jsx("div",{className:"flex flex-col items-center justify-center gap-8",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-primary/10 text-primary text-sm font-medium px-4 py-2 rounded-full mb-4",children:[e.jsx(St,{className:"w-4 h-4"}),e.jsx("span",{children:"Mobile App"})]}),e.jsx("h3",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-foreground mb-4",children:s("home.app.title")}),e.jsx("p",{className:"text-base sm:text-lg text-muted-foreground mb-8 leading-relaxed",children:s("home.app.description")}),e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[e.jsxs("a",{href:"https://apps.apple.com/cn/app/xiaoxiong/id6755481369",target:"_blank",rel:"noopener noreferrer",className:"relative group",children:[e.jsx("div",{className:"absolute -inset-2 bg-gradient-to-r from-primary via-primary-glow to-primary rounded-2xl blur-lg opacity-40 group-hover:opacity-70 transition-opacity"}),e.jsx("div",{className:"relative bg-black hover:bg-gray-900 h-[52px] sm:h-[56px] w-[160px] sm:w-[180px] rounded-xl transition-all hover:scale-105 shadow-2xl hover:shadow-primary/30 border border-white/10 flex items-center justify-center",children:e.jsx("img",{src:rs,alt:"Download on the App Store",className:"h-8 sm:h-9"})})]}),e.jsxs("a",{href:"https://play.google.com/store/apps/details?id=com.xiaoxiong.market",target:"_blank",rel:"noopener noreferrer",className:"relative group",children:[e.jsx("div",{className:"absolute -inset-2 bg-gradient-to-r from-primary via-primary-glow to-primary rounded-2xl blur-lg opacity-40 group-hover:opacity-70 transition-opacity"}),e.jsx("div",{className:"relative bg-black hover:bg-gray-900 h-[52px] sm:h-[56px] w-[160px] sm:w-[180px] rounded-xl transition-all hover:scale-105 shadow-2xl hover:shadow-primary/30 border border-white/10 flex items-center justify-center",children:e.jsx("img",{src:ns,alt:"Get it on Google Play",className:"h-12 sm:h-14"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Ct,{className:"w-4 h-4 animate-bounce"}),e.jsx("span",{children:s("home.app.downloadNow")})]})]})]})})})]}),e.jsxs("section",{className:"py-16 sm:py-20 px-4 bg-gradient-to-br from-primary via-primary-glow to-primary-light relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-grid-pattern opacity-10"}),e.jsx("div",{className:"absolute top-0 right-0 w-64 sm:w-96 h-64 sm:h-96 bg-white/5 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-64 sm:w-96 h-64 sm:h-96 bg-white/5 rounded-full blur-3xl"}),e.jsxs("div",{className:"container mx-auto max-w-4xl text-center relative z-10",children:[e.jsx("h2",{className:"text-3xl sm:text-4xl md:text-5xl font-bold text-primary-foreground mb-4 sm:mb-6 px-4",children:s("home.cta.title")}),e.jsx("p",{className:"text-base sm:text-xl text-primary-foreground/90 mb-6 sm:mb-8 max-w-2xl mx-auto px-4",children:s("home.cta.description")}),e.jsx("div",{className:"flex justify-center",children:e.jsx(Z,{size:"lg",variant:"secondary",asChild:!0,className:"text-base sm:text-lg shadow-xl hover:shadow-2xl",children:e.jsxs(At,{to:"/join-us",children:[e.jsx(Dt,{className:"mr-2 w-4 sm:w-5 h-4 sm:h-5"}),s("home.cta.button")]})})})]})]}),P&&e.jsx(js,{open:C,onOpenChange:A,provider:O})]})})};export{Xs as default};
//# sourceMappingURL=Home-BMaURmUP.js.map
