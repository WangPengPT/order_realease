import{j as e}from"./vendor-ui-DmpovMYY.js";import{r as p,L as y}from"./vendor-react-iAJ0IrSD.js";import{u as P}from"./index.esm-CVRqJy9l.js";import{o as z,s as j,a as E,e as I,t as D}from"./types-CpDVS0Ep.js";import{a as $,n as N,J as v,be as q,R as A,aZ as B,B as C,G as J,y as O,V as R,aM as V,I as x,L as G,s as H,aF as f}from"./index-B44MF3Hr.js";import{C as Z}from"./checkbox-p3Axtr7O.js";import{F as K,a as i,b as o,c,d as l,e as m,f as Q}from"./form-DXfft-vF.js";import{u as W}from"./vendor-i18n-DxKeo2S1.js";import"./vendor-charts-Bz7hPIBd.js";import"./vendor-query-D82cqPtt.js";import"./vendor-supabase-6pZ9VDFn.js";const S=["booking","delivery","qrcode"],le=()=>{const{t:s,i18n:u}=W(),[_,g]=p.useState(!1),[w,b]=p.useState(!1),{settings:n}=$(),F=p.useMemo(()=>z({name:j().min(2,{message:s("joinUs.nameMin")}),email:j().email({message:s("joinUs.emailInvalid")}),phone:j().min(6,{message:s("joinUs.phoneMin")}),restaurant_name:j().min(2,{message:s("joinUs.restaurantNameMin")}),restaurant_address:j().min(2,{message:s("joinUs.addressMin")}),features_selected:E(I(S)).min(1,{message:s("joinUs.featuresMin")})}),[s]),a=P({resolver:D(F),defaultValues:{name:"",email:"",phone:"",restaurant_name:"",restaurant_address:"",features_selected:[]}}),M=async r=>{g(!0);try{const t=u.language||"en",{error:d}=await H.functions.invoke("send-join-request-email",{body:{...r,language:t}});if(d){if(d.message.includes("rate_limit_exceeded"))f({title:s("joinUs.rateLimitError"),description:s("joinUs.rateLimitErrorDesc"),variant:"destructive"});else throw d;return}b(!0),a.reset(),f({title:s("joinUs.successTitle"),description:s("joinUs.successDescription")})}catch(t){console.error("Error submitting join request:",t),f({title:s("common.error"),description:s("joinUs.submitError"),variant:"destructive"})}finally{g(!1)}},T=()=>{const r=u.language;return r==="zh"&&n?.join_success_title_zh?n.join_success_title_zh:r==="pt"&&n?.join_success_title_pt?n.join_success_title_pt:n?.join_success_title_en?n.join_success_title_en:s("joinUs.successTitle")},k=()=>{const r=u.language;return r==="zh"&&n?.join_success_message_zh?n.join_success_message_zh:r==="pt"&&n?.join_success_message_pt?n.join_success_message_pt:n?.join_success_message_en?n.join_success_message_en:s("joinUs.successMessage")},U=n?.join_contact_phone||"968815050",h=n?.contact_email;return w?e.jsx("div",{className:"min-h-screen pt-20 pb-12 px-4 bg-secondary/20",children:e.jsx("div",{className:"container mx-auto max-w-2xl",children:e.jsx(N,{className:"border-primary",children:e.jsxs(v,{className:"pt-12 pb-12 text-center",children:[e.jsx(q,{className:"w-16 h-16 text-primary mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-4",children:T()}),e.jsx("p",{className:"text-muted-foreground mb-4 max-w-md mx-auto",children:k()}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4 mb-6",children:[e.jsxs("a",{href:`tel:${U}`,className:"flex items-center gap-2 text-primary font-semibold hover:underline",children:[e.jsx(A,{className:"w-5 h-5"}),e.jsx("span",{children:U})]}),h&&e.jsxs("a",{href:`mailto:${h}`,className:"flex items-center gap-2 text-primary font-semibold hover:underline",children:[e.jsx(B,{className:"w-5 h-5"}),e.jsx("span",{children:h})]})]}),e.jsx(C,{onClick:()=>b(!1),children:s("joinUs.submitAnother")})]})})})}):e.jsx("div",{className:"min-h-screen pt-4 pb-12 px-4 bg-secondary/20",children:e.jsx("div",{className:"container mx-auto max-w-3xl",children:e.jsxs(N,{children:[e.jsxs(J,{className:"text-center space-y-2",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(O,{className:"w-12 h-12 text-primary"})}),e.jsx(R,{className:"text-3xl font-bold",children:s("joinUs.title")}),e.jsx(V,{className:"text-base",children:s("joinUs.description")})]}),e.jsx(v,{children:e.jsx(K,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(M),className:"space-y-6",children:[e.jsx(i,{control:a.control,name:"name",render:({field:r})=>e.jsxs(o,{children:[e.jsx(c,{children:s("joinUs.name")}),e.jsx(l,{children:e.jsx(x,{placeholder:s("joinUs.namePlaceholder"),...r})}),e.jsx(m,{})]})}),e.jsx(i,{control:a.control,name:"email",render:({field:r})=>e.jsxs(o,{children:[e.jsx(c,{children:s("joinUs.email")}),e.jsx(l,{children:e.jsx(x,{type:"email",placeholder:s("joinUs.emailPlaceholder"),...r})}),e.jsx(m,{})]})}),e.jsx(i,{control:a.control,name:"phone",render:({field:r})=>e.jsxs(o,{children:[e.jsx(c,{children:s("joinUs.phone")}),e.jsx(l,{children:e.jsx(x,{type:"tel",placeholder:s("joinUs.phonePlaceholder"),...r})}),e.jsx(m,{})]})}),e.jsx(i,{control:a.control,name:"restaurant_name",render:({field:r})=>e.jsxs(o,{children:[e.jsx(c,{children:s("joinUs.restaurantName")}),e.jsx(l,{children:e.jsx(x,{placeholder:s("joinUs.restaurantNamePlaceholder"),...r})}),e.jsx(m,{})]})}),e.jsx(i,{control:a.control,name:"restaurant_address",render:({field:r})=>e.jsxs(o,{children:[e.jsx(c,{children:s("joinUs.restaurantAddress")}),e.jsx(l,{children:e.jsx(x,{placeholder:s("joinUs.restaurantAddressPlaceholder"),...r})}),e.jsx(m,{})]})}),e.jsx(i,{control:a.control,name:"features_selected",render:()=>e.jsxs(o,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx(c,{children:s("joinUs.featuresNeeded")}),e.jsx(Q,{children:s("joinUs.featuresDescription")})]}),S.map(r=>e.jsx(i,{control:a.control,name:"features_selected",render:({field:t})=>e.jsxs(o,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(l,{children:e.jsx(Z,{checked:t.value?.includes(r),onCheckedChange:d=>d?t.onChange([...t.value,r]):t.onChange(t.value?.filter(L=>L!==r))})}),e.jsx(c,{className:"font-normal cursor-pointer",children:s(`joinUs.feature.${r}`)})]},r)},r)),e.jsx(m,{})]})}),e.jsxs("div",{className:"text-xs text-muted-foreground text-center pb-4",children:[s("joinUs.consentText")," ",e.jsx(y,{to:"/privacy-policy",className:"text-primary hover:underline",children:s("joinUs.privacyPolicy")})," ",s("joinUs.and")," ",e.jsx(y,{to:"/terms-of-service",className:"text-primary hover:underline",children:s("joinUs.termsOfService")})]}),e.jsxs(C,{type:"submit",className:"w-full",size:"lg",disabled:_,children:[_&&e.jsx(G,{className:"mr-2 h-4 w-4 animate-spin"}),s("joinUs.submit")]})]})})})]})})})};export{le as default};
//# sourceMappingURL=JoinUs-B0XFIayK.js.map
