{"version":3,"file":"AdminShopItems-BDqq4Jm4.js","sources":["../../src/components/admin/ShopItemFormDialog.tsx","../../src/components/admin/ResetUserPurchaseLimitDialog.tsx","../../src/pages/admin/AdminShopItems.tsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { zodResolver } from \"@hookform/resolvers/zod\";\r\nimport * as z from \"zod\";\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\r\nimport { Form, FormControl, FormDescription, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\r\nimport { Switch } from \"@/components/ui/switch\";\r\nimport { useSaveShopItem } from \"@/hooks/useShopItems\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { toast } from \"sonner\";\r\n\r\nconst formSchema = z.object({\r\n  item_type: z.string(),\r\n  coupon_template_id: z.string().optional().nullable(),\r\n  name_zh: z.string().min(1),\r\n  name_en: z.string().min(1),\r\n  name_pt: z.string().min(1),\r\n  description_zh: z.string().optional(),\r\n  description_en: z.string().optional(),\r\n  description_pt: z.string().optional(),\r\n  image_url: z.string().optional(),\r\n  points_cost: z.number().min(1),\r\n  stock: z.number().optional().nullable(),\r\n  per_user_limit: z.number().min(1),\r\n  limit_refresh_period: z.string(),\r\n  is_active: z.boolean(),\r\n});\r\n\r\ntype FormData = z.infer<typeof formSchema>;\r\n\r\ninterface ShopItemFormDialogProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  item?: any;\r\n}\r\n\r\nexport const ShopItemFormDialog = ({ open, onOpenChange, item }: ShopItemFormDialogProps) => {\r\n  const { t } = useTranslation();\r\n  const saveItem = useSaveShopItem();\r\n  const [couponTemplates, setCouponTemplates] = useState<any[]>([]);\r\n  const [isLoadingTemplates, setIsLoadingTemplates] = useState(false);\r\n\r\n  const form = useForm<FormData>({\r\n    resolver: zodResolver(formSchema),\r\n    defaultValues: {\r\n      item_type: \"coupon\",\r\n      coupon_template_id: null,\r\n      name_zh: \"\",\r\n      name_en: \"\",\r\n      name_pt: \"\",\r\n      description_zh: \"\",\r\n      description_en: \"\",\r\n      description_pt: \"\",\r\n      image_url: \"\",\r\n      points_cost: 100,\r\n      stock: null,\r\n      per_user_limit: 1,\r\n      limit_refresh_period: \"none\",\r\n      is_active: true,\r\n    },\r\n  });\r\n\r\n  // Load coupon templates\r\n  useEffect(() => {\r\n    const loadTemplates = async () => {\r\n      setIsLoadingTemplates(true);\r\n      try {\r\n        const { data, error } = await supabase\r\n          .from(\"coupon_templates\")\r\n          .select(\"id, title_zh, title_en, title_pt, discount_type, discount_value\")\r\n          .eq(\"is_active\", true)\r\n          .order(\"title_en\");\r\n\r\n        if (error) throw error;\r\n        setCouponTemplates(data || []);\r\n      } catch (error) {\r\n        console.error(\"Error loading templates:\", error);\r\n      } finally {\r\n        setIsLoadingTemplates(false);\r\n      }\r\n    };\r\n\r\n    if (open) {\r\n      loadTemplates();\r\n    }\r\n  }, [open]);\r\n\r\n  // Reset form when item changes\r\n  useEffect(() => {\r\n    if (item) {\r\n      form.reset({\r\n        item_type: item.item_type,\r\n        coupon_template_id: item.coupon_template_id,\r\n        name_zh: item.name_zh,\r\n        name_en: item.name_en,\r\n        name_pt: item.name_pt,\r\n        description_zh: item.description_zh || \"\",\r\n        description_en: item.description_en || \"\",\r\n        description_pt: item.description_pt || \"\",\r\n        image_url: item.image_url || \"\",\r\n        points_cost: item.points_cost,\r\n        stock: item.stock,\r\n        per_user_limit: item.per_user_limit,\r\n        limit_refresh_period: item.limit_refresh_period,\r\n        is_active: item.is_active,\r\n      });\r\n    } else {\r\n      form.reset({\r\n        item_type: \"coupon\",\r\n        coupon_template_id: null,\r\n        name_zh: \"\",\r\n        name_en: \"\",\r\n        name_pt: \"\",\r\n        description_zh: \"\",\r\n        description_en: \"\",\r\n        description_pt: \"\",\r\n        image_url: \"\",\r\n        points_cost: 100,\r\n        stock: null,\r\n        per_user_limit: 1,\r\n        limit_refresh_period: \"none\",\r\n        is_active: true,\r\n      });\r\n    }\r\n  }, [item, form]);\r\n\r\n  const onSubmit = async (data: FormData) => {\r\n    try {\r\n      await saveItem.mutateAsync({\r\n        ...(item?.id ? { id: item.id } : {}),\r\n        item_type: data.item_type as \"coupon\" | \"physical\" | \"badge\",\r\n        name_zh: data.name_zh,\r\n        name_en: data.name_en,\r\n        name_pt: data.name_pt,\r\n        description_zh: data.description_zh,\r\n        description_en: data.description_en,\r\n        description_pt: data.description_pt,\r\n        image_url: data.image_url,\r\n        points_cost: data.points_cost,\r\n        per_user_limit: data.per_user_limit,\r\n        limit_refresh_period: data.limit_refresh_period as \"none\" | \"daily\" | \"weekly\" | \"monthly\",\r\n        is_active: data.is_active,\r\n        stock: data.stock || null,\r\n        coupon_template_id: data.item_type === \"coupon\" ? data.coupon_template_id : null,\r\n      });\r\n      toast.success(item ? t(\"admin.shop.updateSuccess\") : t(\"admin.shop.createSuccess\"));\r\n      onOpenChange(false);\r\n    } catch (error) {\r\n      console.error(\"Save error:\", error);\r\n      toast.error(t(\"common.error\"));\r\n    }\r\n  };\r\n\r\n  const itemType = form.watch(\"item_type\");\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={onOpenChange}>\r\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\r\n        <DialogHeader>\r\n          <DialogTitle>\r\n            {item ? t(\"admin.shop.editItem\") : t(\"admin.shop.addItem\")}\r\n          </DialogTitle>\r\n        </DialogHeader>\r\n\r\n        <Form {...form}>\r\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\r\n            {/* Basic Info */}\r\n            <div className=\"grid grid-cols-2 gap-4\">\r\n              <FormField\r\n                control={form.control}\r\n                name=\"item_type\"\r\n                render={({ field }) => (\r\n                  <FormItem>\r\n                    <FormLabel>{t(\"admin.shop.itemType\")}</FormLabel>\r\n                    <Select onValueChange={field.onChange} value={field.value}>\r\n                      <FormControl>\r\n                        <SelectTrigger>\r\n                          <SelectValue />\r\n                        </SelectTrigger>\r\n                      </FormControl>\r\n                      <SelectContent>\r\n                        <SelectItem value=\"coupon\">{t(\"admin.shop.typeCoupon\")}</SelectItem>\r\n                        <SelectItem value=\"physical\">{t(\"admin.shop.typePhysical\")}</SelectItem>\r\n                        <SelectItem value=\"badge\">{t(\"admin.shop.typeBadge\")}</SelectItem>\r\n                      </SelectContent>\r\n                    </Select>\r\n                    <FormMessage />\r\n                  </FormItem>\r\n                )}\r\n              />\r\n\r\n              {itemType === \"coupon\" && (\r\n                <FormField\r\n                  control={form.control}\r\n                  name=\"coupon_template_id\"\r\n                  render={({ field }) => (\r\n                    <FormItem>\r\n                      <FormLabel>{t(\"admin.shop.couponTemplate\")}</FormLabel>\r\n                      <Select \r\n                        onValueChange={field.onChange} \r\n                        value={field.value || \"\"}\r\n                        disabled={isLoadingTemplates}\r\n                      >\r\n                        <FormControl>\r\n                          <SelectTrigger>\r\n                            <SelectValue placeholder={t(\"admin.shop.selectTemplate\")} />\r\n                          </SelectTrigger>\r\n                        </FormControl>\r\n                        <SelectContent>\r\n                          {couponTemplates.map((template) => (\r\n                            <SelectItem key={template.id} value={template.id}>\r\n                              {template.title_zh} ({template.discount_type === \"percentage\" ? `${template.discount_value}%` : `â‚¬${template.discount_value}`})\r\n                            </SelectItem>\r\n                          ))}\r\n                        </SelectContent>\r\n                      </Select>\r\n                      <FormMessage />\r\n                    </FormItem>\r\n                  )}\r\n                />\r\n              )}\r\n            </div>\r\n\r\n            {/* Multilingual Names */}\r\n            <div className=\"space-y-4\">\r\n              <h3 className=\"font-medium\">{t(\"admin.shop.itemName\")}</h3>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                <FormField\r\n                  control={form.control}\r\n                  name=\"name_zh\"\r\n                  render={({ field }) => (\r\n                    <FormItem>\r\n                      <FormLabel>{t(\"admin.chinese\")}</FormLabel>\r\n                      <FormControl>\r\n                        <Input {...field} />\r\n                      </FormControl>\r\n                      <FormMessage />\r\n                    </FormItem>\r\n                  )}\r\n                />\r\n                <FormField\r\n                  control={form.control}\r\n                  name=\"name_en\"\r\n                  render={({ field }) => (\r\n                    <FormItem>\r\n                      <FormLabel>{t(\"admin.english\")}</FormLabel>\r\n                      <FormControl>\r\n                        <Input {...field} />\r\n                      </FormControl>\r\n                      <FormMessage />\r\n                    </FormItem>\r\n                  )}\r\n                />\r\n                <FormField\r\n                  control={form.control}\r\n                  name=\"name_pt\"\r\n                  render={({ field }) => (\r\n                    <FormItem>\r\n                      <FormLabel>{t(\"admin.portuguese\")}</FormLabel>\r\n                      <FormControl>\r\n                        <Input {...field} />\r\n                      </FormControl>\r\n                      <FormMessage />\r\n                    </FormItem>\r\n                  )}\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Multilingual Descriptions */}\r\n            <div className=\"space-y-4\">\r\n              <h3 className=\"font-medium\">{t(\"admin.shop.itemDescription\")}</h3>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                <FormField\r\n                  control={form.control}\r\n                  name=\"description_zh\"\r\n                  render={({ field }) => (\r\n                    <FormItem>\r\n                      <FormLabel>{t(\"admin.chinese\")}</FormLabel>\r\n                      <FormControl>\r\n                        <Textarea {...field} rows={2} />\r\n                      </FormControl>\r\n                      <FormMessage />\r\n                    </FormItem>\r\n                  )}\r\n                />\r\n                <FormField\r\n                  control={form.control}\r\n                  name=\"description_en\"\r\n                  render={({ field }) => (\r\n                    <FormItem>\r\n                      <FormLabel>{t(\"admin.english\")}</FormLabel>\r\n                      <FormControl>\r\n                        <Textarea {...field} rows={2} />\r\n                      </FormControl>\r\n                      <FormMessage />\r\n                    </FormItem>\r\n                  )}\r\n                />\r\n                <FormField\r\n                  control={form.control}\r\n                  name=\"description_pt\"\r\n                  render={({ field }) => (\r\n                    <FormItem>\r\n                      <FormLabel>{t(\"admin.portuguese\")}</FormLabel>\r\n                      <FormControl>\r\n                        <Textarea {...field} rows={2} />\r\n                      </FormControl>\r\n                      <FormMessage />\r\n                    </FormItem>\r\n                  )}\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Image URL */}\r\n            <FormField\r\n              control={form.control}\r\n              name=\"image_url\"\r\n              render={({ field }) => (\r\n                <FormItem>\r\n                  <FormLabel>{t(\"admin.shop.imageUrl\")}</FormLabel>\r\n                  <FormControl>\r\n                    <Input {...field} placeholder=\"https://...\" />\r\n                  </FormControl>\r\n                  <FormDescription>\r\n                    {t(\"admin.shop.imageUrlHelp\")}\r\n                  </FormDescription>\r\n                  <FormMessage />\r\n                </FormItem>\r\n              )}\r\n            />\r\n\r\n            {/* Points and Stock */}\r\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n              <FormField\r\n                control={form.control}\r\n                name=\"points_cost\"\r\n                render={({ field }) => (\r\n                  <FormItem>\r\n                    <FormLabel>{t(\"admin.shop.pointsCost\")}</FormLabel>\r\n                    <FormControl>\r\n                      <Input \r\n                        type=\"number\" \r\n                        {...field} \r\n                        onChange={e => field.onChange(parseInt(e.target.value) || 0)}\r\n                      />\r\n                    </FormControl>\r\n                    <FormMessage />\r\n                  </FormItem>\r\n                )}\r\n              />\r\n\r\n              <FormField\r\n                control={form.control}\r\n                name=\"stock\"\r\n                render={({ field }) => (\r\n                  <FormItem>\r\n                    <FormLabel>{t(\"admin.shop.stock\")}</FormLabel>\r\n                    <FormControl>\r\n                      <Input \r\n                        type=\"number\" \r\n                        placeholder={t(\"admin.shop.unlimited\")}\r\n                        value={field.value ?? \"\"}\r\n                        onChange={e => field.onChange(e.target.value ? parseInt(e.target.value) : null)}\r\n                      />\r\n                    </FormControl>\r\n                    <FormDescription>{t(\"admin.shop.stockHelp\")}</FormDescription>\r\n                    <FormMessage />\r\n                  </FormItem>\r\n                )}\r\n              />\r\n\r\n              <FormField\r\n                control={form.control}\r\n                name=\"per_user_limit\"\r\n                render={({ field }) => (\r\n                  <FormItem>\r\n                    <FormLabel>{t(\"admin.shop.perUserLimit\")}</FormLabel>\r\n                    <FormControl>\r\n                      <Input \r\n                        type=\"number\" \r\n                        {...field}\r\n                        onChange={e => field.onChange(parseInt(e.target.value) || 1)}\r\n                      />\r\n                    </FormControl>\r\n                    <FormMessage />\r\n                  </FormItem>\r\n                )}\r\n              />\r\n\r\n              <FormField\r\n                control={form.control}\r\n                name=\"limit_refresh_period\"\r\n                render={({ field }) => (\r\n                  <FormItem>\r\n                    <FormLabel>{t(\"admin.shop.refreshPeriod\")}</FormLabel>\r\n                    <Select onValueChange={field.onChange} value={field.value}>\r\n                      <FormControl>\r\n                        <SelectTrigger>\r\n                          <SelectValue />\r\n                        </SelectTrigger>\r\n                      </FormControl>\r\n                      <SelectContent>\r\n                        <SelectItem value=\"none\">{t(\"admin.shop.periodNone\")}</SelectItem>\r\n                        <SelectItem value=\"daily\">{t(\"admin.shop.periodDaily\")}</SelectItem>\r\n                        <SelectItem value=\"weekly\">{t(\"admin.shop.periodWeekly\")}</SelectItem>\r\n                        <SelectItem value=\"monthly\">{t(\"admin.shop.periodMonthly\")}</SelectItem>\r\n                      </SelectContent>\r\n                    </Select>\r\n                    <FormMessage />\r\n                  </FormItem>\r\n                )}\r\n              />\r\n            </div>\r\n\r\n            {/* Active Status */}\r\n            <FormField\r\n              control={form.control}\r\n              name=\"is_active\"\r\n              render={({ field }) => (\r\n                <FormItem className=\"flex items-center justify-between rounded-lg border p-4\">\r\n                  <div className=\"space-y-0.5\">\r\n                    <FormLabel>{t(\"admin.shop.isActive\")}</FormLabel>\r\n                    <FormDescription>\r\n                      {t(\"admin.shop.isActiveHelp\")}\r\n                    </FormDescription>\r\n                  </div>\r\n                  <FormControl>\r\n                    <Switch\r\n                      checked={field.value}\r\n                      onCheckedChange={field.onChange}\r\n                    />\r\n                  </FormControl>\r\n                </FormItem>\r\n              )}\r\n            />\r\n\r\n            <div className=\"flex justify-end gap-2\">\r\n              <Button type=\"button\" variant=\"outline\" onClick={() => onOpenChange(false)}>\r\n                {t(\"common.cancel\")}\r\n              </Button>\r\n              <Button type=\"submit\" disabled={saveItem.isPending}>\r\n                {saveItem.isPending ? t(\"common.saving\") : t(\"common.save\")}\r\n              </Button>\r\n            </div>\r\n          </form>\r\n        </Form>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n","import { useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Search, User } from \"lucide-react\";\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { useQuery } from \"@tanstack/react-query\";\r\n\r\ninterface ResetUserPurchaseLimitDialogProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  itemId: string;\r\n  itemName: string;\r\n  onConfirm: (userId: string) => void;\r\n}\r\n\r\ninterface UserWithLimit {\r\n  user_id: string;\r\n  purchase_count: number;\r\n  profile: {\r\n    id: string;\r\n    display_name: string | null;\r\n    avatar_url: string | null;\r\n    email?: string;\r\n  } | null;\r\n}\r\n\r\nexport const ResetUserPurchaseLimitDialog = ({\r\n  open,\r\n  onOpenChange,\r\n  itemId,\r\n  itemName,\r\n  onConfirm,\r\n}: ResetUserPurchaseLimitDialogProps) => {\r\n  const { t } = useTranslation();\r\n  const [searchQuery, setSearchQuery] = useState(\"\");\r\n  const [selectedUserId, setSelectedUserId] = useState<string | null>(null);\r\n\r\n  // Fetch users who have purchase limits for this item\r\n  const { data: usersWithLimits, isLoading } = useQuery({\r\n    queryKey: ['item-purchase-limits', itemId],\r\n    queryFn: async () => {\r\n      const { data: limits, error } = await supabase\r\n        .from('user_purchase_limits')\r\n        .select('user_id, purchase_count')\r\n        .eq('shop_item_id', itemId);\r\n\r\n      if (error) throw error;\r\n      if (!limits || limits.length === 0) return [];\r\n\r\n      // Get profile info for these users\r\n      const userIds = limits.map(l => l.user_id);\r\n      const { data: profiles } = await supabase\r\n        .from('profiles')\r\n        .select('id, display_name, avatar_url')\r\n        .in('id', userIds);\r\n\r\n      const profileMap = new Map(profiles?.map(p => [p.id, p]) || []);\r\n\r\n      return limits.map(limit => ({\r\n        user_id: limit.user_id,\r\n        purchase_count: limit.purchase_count,\r\n        profile: profileMap.get(limit.user_id) || null,\r\n      })) as UserWithLimit[];\r\n    },\r\n    enabled: open,\r\n  });\r\n\r\n  const filteredUsers = usersWithLimits?.filter(user => {\r\n    if (!searchQuery) return true;\r\n    const query = searchQuery.toLowerCase();\r\n    const displayName = user.profile?.display_name?.toLowerCase() || '';\r\n    return displayName.includes(query) || user.user_id.toLowerCase().includes(query);\r\n  });\r\n\r\n  const handleConfirm = () => {\r\n    if (selectedUserId) {\r\n      onConfirm(selectedUserId);\r\n      setSelectedUserId(null);\r\n      setSearchQuery(\"\");\r\n    }\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setSelectedUserId(null);\r\n    setSearchQuery(\"\");\r\n    onOpenChange(false);\r\n  };\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={handleClose}>\r\n      <DialogContent className=\"max-w-md\">\r\n        <DialogHeader>\r\n          <DialogTitle>{t(\"admin.shop.resetUserLimit\")}</DialogTitle>\r\n          <DialogDescription>\r\n            {t(\"admin.shop.resetUserLimitDesc\", { itemName })}\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        <div className=\"space-y-4\">\r\n          <div className=\"relative\">\r\n            <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\r\n            <Input\r\n              placeholder={t(\"admin.shop.searchUser\")}\r\n              value={searchQuery}\r\n              onChange={(e) => setSearchQuery(e.target.value)}\r\n              className=\"pl-9\"\r\n            />\r\n          </div>\r\n\r\n          <ScrollArea className=\"h-64 border rounded-md\">\r\n            {isLoading ? (\r\n              <div className=\"p-4 text-center text-muted-foreground\">\r\n                {t(\"common.loading\")}\r\n              </div>\r\n            ) : filteredUsers && filteredUsers.length > 0 ? (\r\n              <div className=\"p-2 space-y-1\">\r\n                {filteredUsers.map((user) => (\r\n                  <div\r\n                    key={user.user_id}\r\n                    className={`flex items-center gap-3 p-2 rounded-md cursor-pointer transition-colors ${\r\n                      selectedUserId === user.user_id\r\n                        ? \"bg-primary/10 border border-primary\"\r\n                        : \"hover:bg-muted\"\r\n                    }`}\r\n                    onClick={() => setSelectedUserId(user.user_id)}\r\n                  >\r\n                    <Avatar className=\"h-8 w-8\">\r\n                      <AvatarImage src={user.profile?.avatar_url || undefined} />\r\n                      <AvatarFallback>\r\n                        <User className=\"h-4 w-4\" />\r\n                      </AvatarFallback>\r\n                    </Avatar>\r\n                    <div className=\"flex-1 min-w-0\">\r\n                      <p className=\"text-sm font-medium truncate\">\r\n                        {user.profile?.display_name || t(\"common.anonymous\")}\r\n                      </p>\r\n                      <p className=\"text-xs text-muted-foreground\">\r\n                        {t(\"admin.shop.purchaseCount\", { count: user.purchase_count })}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            ) : (\r\n              <div className=\"p-4 text-center text-muted-foreground\">\r\n                {t(\"admin.shop.noUsersWithLimits\")}\r\n              </div>\r\n            )}\r\n          </ScrollArea>\r\n        </div>\r\n\r\n        <DialogFooter>\r\n          <Button variant=\"outline\" onClick={handleClose}>\r\n            {t(\"common.cancel\")}\r\n          </Button>\r\n          <Button \r\n            onClick={handleConfirm} \r\n            disabled={!selectedUserId}\r\n            className=\"bg-amber-500 hover:bg-amber-600\"\r\n          >\r\n            {t(\"admin.shop.resetLimits\")}\r\n          </Button>\r\n        </DialogFooter>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n","import { useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Plus, Edit, Trash2, Package, GripVertical, Eye, EyeOff, RotateCcw, Store } from \"lucide-react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Switch } from \"@/components/ui/switch\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { useAllShopItems, useSaveShopItem, useDeleteShopItem, useResetItemPurchaseLimits } from \"@/hooks/useShopItems\";\r\nimport { useLocalizedContent } from \"@/hooks/useLocalizedContent\";\r\nimport { useSiteSettings } from \"@/hooks/useSiteSettings\";\r\nimport { ShopItemFormDialog } from \"@/components/admin/ShopItemFormDialog\";\r\nimport { ResetUserPurchaseLimitDialog } from \"@/components/admin/ResetUserPurchaseLimitDialog\";\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n} from \"@/components/ui/alert-dialog\";\r\nimport { toast } from \"sonner\";\r\n\r\nconst AdminShopItems = () => {\r\n  const { t } = useTranslation();\r\n  const { getLocalizedField } = useLocalizedContent();\r\n  const { data: items, isLoading } = useAllShopItems();\r\n  const { settings, updateSettings } = useSiteSettings();\r\n  const saveItem = useSaveShopItem();\r\n  const deleteItem = useDeleteShopItem();\r\n  const resetLimits = useResetItemPurchaseLimits();\r\n  \r\n  const [formOpen, setFormOpen] = useState(false);\r\n  const [editingItem, setEditingItem] = useState<any>(null);\r\n  const [deleteDialogOpen, setDeleteDialogOpen] = useState(false);\r\n  const [itemToDelete, setItemToDelete] = useState<any>(null);\r\n  const [resetLimitsDialogOpen, setResetLimitsDialogOpen] = useState(false);\r\n  const [itemToResetLimits, setItemToResetLimits] = useState<any>(null);\r\n\r\n  const handleToggleShopEnabled = async () => {\r\n    const newValue = !settings?.shop_enabled;\r\n    await updateSettings.mutateAsync({ shop_enabled: newValue });\r\n    toast.success(newValue \r\n      ? t(\"admin.shop.shopEnabledSuccess\") \r\n      : t(\"admin.shop.shopDisabledSuccess\")\r\n    );\r\n  };\r\n\r\n  const handleAdd = () => {\r\n    setEditingItem(null);\r\n    setFormOpen(true);\r\n  };\r\n\r\n  const handleEdit = (item: any) => {\r\n    setEditingItem(item);\r\n    setFormOpen(true);\r\n  };\r\n\r\n  const handleDelete = (item: any) => {\r\n    setItemToDelete(item);\r\n    setDeleteDialogOpen(true);\r\n  };\r\n\r\n  const confirmDelete = async () => {\r\n    if (itemToDelete) {\r\n      try {\r\n        await deleteItem.mutateAsync(itemToDelete.id);\r\n        toast.success(t(\"admin.shop.deleteSuccess\"));\r\n      } catch (error) {\r\n        toast.error(t(\"admin.shop.deleteFailed\"));\r\n      }\r\n    }\r\n    setDeleteDialogOpen(false);\r\n    setItemToDelete(null);\r\n  };\r\n\r\n  const handleResetLimits = (item: any) => {\r\n    setItemToResetLimits(item);\r\n    setResetLimitsDialogOpen(true);\r\n  };\r\n\r\n  const handleConfirmResetUserLimit = async (userId: string) => {\r\n    if (itemToResetLimits) {\r\n      try {\r\n        await resetLimits.mutateAsync({ itemId: itemToResetLimits.id, userId });\r\n      } catch (error) {\r\n        // Error handled in hook\r\n      }\r\n    }\r\n    setResetLimitsDialogOpen(false);\r\n    setItemToResetLimits(null);\r\n  };\r\n\r\n  const handleToggleActive = async (item: any) => {\r\n    try {\r\n      await saveItem.mutateAsync({\r\n        ...item,\r\n        is_active: !item.is_active\r\n      });\r\n      toast.success(item.is_active \r\n        ? t(\"admin.shop.itemDeactivated\") \r\n        : t(\"admin.shop.itemActivated\")\r\n      );\r\n    } catch (error) {\r\n      toast.error(t(\"common.error\"));\r\n    }\r\n  };\r\n\r\n  const getItemTypeLabel = (type: string) => {\r\n    switch (type) {\r\n      case \"coupon\": return t(\"admin.shop.typeCoupon\");\r\n      case \"physical\": return t(\"admin.shop.typePhysical\");\r\n      case \"badge\": return t(\"admin.shop.typeBadge\");\r\n      default: return type;\r\n    }\r\n  };\r\n\r\n  const getRefreshPeriodLabel = (period: string) => {\r\n    switch (period) {\r\n      case \"daily\": return t(\"admin.shop.periodDaily\");\r\n      case \"weekly\": return t(\"admin.shop.periodWeekly\");\r\n      case \"monthly\": return t(\"admin.shop.periodMonthly\");\r\n      case \"none\": return t(\"admin.shop.periodNone\");\r\n      default: return period;\r\n    }\r\n  };\r\n\r\n  if (isLoading) {\r\n    return <div className=\"p-6\">{t(\"common.loading\")}</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold\">{t(\"admin.shop.title\")}</h1>\r\n          <p className=\"text-muted-foreground\">{t(\"admin.shop.description\")}</p>\r\n        </div>\r\n        <Button onClick={handleAdd}>\r\n          <Plus className=\"h-4 w-4 mr-2\" />\r\n          {t(\"admin.shop.addItem\")}\r\n        </Button>\r\n      </div>\r\n\r\n      {/* Shop Entrance Toggle */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Store className=\"h-5 w-5\" />\r\n            {t(\"admin.shop.shopEnabled\")}\r\n          </CardTitle>\r\n          <CardDescription>\r\n            {t(\"admin.shop.shopEnabledDesc\")}\r\n          </CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"flex items-center space-x-2\">\r\n            <Switch\r\n              id=\"shop-enabled\"\r\n              checked={settings?.shop_enabled ?? true}\r\n              onCheckedChange={handleToggleShopEnabled}\r\n            />\r\n            <Label htmlFor=\"shop-enabled\" className=\"flex items-center gap-2\">\r\n              {settings?.shop_enabled ? (\r\n                <>\r\n                  <Eye className=\"h-4 w-4 text-green-500\" />\r\n                  <span className=\"text-green-600 dark:text-green-400\">{t(\"admin.shop.itemActivated\")}</span>\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <EyeOff className=\"h-4 w-4 text-muted-foreground\" />\r\n                  <span className=\"text-muted-foreground\">{t(\"admin.shop.itemDeactivated\")}</span>\r\n                </>\r\n              )}\r\n            </Label>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Package className=\"h-5 w-5\" />\r\n            {t(\"admin.shop.itemList\")}\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          {items && items.length > 0 ? (\r\n            <Table>\r\n              <TableHeader>\r\n                <TableRow>\r\n                  <TableHead className=\"w-12\"></TableHead>\r\n                  <TableHead>{t(\"admin.shop.itemName\")}</TableHead>\r\n                  <TableHead>{t(\"admin.shop.itemType\")}</TableHead>\r\n                  <TableHead>{t(\"admin.shop.pointsCost\")}</TableHead>\r\n                  <TableHead>{t(\"admin.shop.stock\")}</TableHead>\r\n                  <TableHead>{t(\"admin.shop.limit\")}</TableHead>\r\n                  <TableHead>{t(\"admin.shop.status\")}</TableHead>\r\n                  <TableHead className=\"text-right\">{t(\"common.actions\")}</TableHead>\r\n                </TableRow>\r\n              </TableHeader>\r\n              <TableBody>\r\n                {items.map((item) => (\r\n                  <TableRow key={item.id}>\r\n                    <TableCell>\r\n                      <GripVertical className=\"h-4 w-4 text-muted-foreground cursor-grab\" />\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <div className=\"flex items-center gap-3\">\r\n                        {item.image_url ? (\r\n                          <img \r\n                            src={item.image_url} \r\n                            alt={getLocalizedField(item, \"name\")} \r\n                            className=\"w-10 h-10 rounded object-cover\"\r\n                          />\r\n                        ) : (\r\n                          <div className=\"w-10 h-10 rounded bg-muted flex items-center justify-center\">\r\n                            <Package className=\"h-5 w-5 text-muted-foreground\" />\r\n                          </div>\r\n                        )}\r\n                        <div>\r\n                          <div className=\"font-medium\">{getLocalizedField(item, \"name\")}</div>\r\n                          <div className=\"text-sm text-muted-foreground line-clamp-1\">\r\n                            {getLocalizedField(item, \"description\")}\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <Badge variant=\"outline\">{getItemTypeLabel(item.item_type)}</Badge>\r\n                    </TableCell>\r\n                    <TableCell className=\"font-medium\">{item.points_cost}</TableCell>\r\n                    <TableCell>\r\n                      {item.stock === null ? (\r\n                        <span className=\"text-muted-foreground\">{t(\"admin.shop.unlimited\")}</span>\r\n                      ) : (\r\n                        <span className={item.stock <= 0 ? \"text-destructive\" : \"\"}>\r\n                          {item.stock}\r\n                        </span>\r\n                      )}\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <div className=\"text-sm\">\r\n                        <div>{item.per_user_limit} {t(\"admin.shop.times\")}</div>\r\n                        <div className=\"text-muted-foreground text-xs\">\r\n                          {getRefreshPeriodLabel(item.limit_refresh_period)}\r\n                        </div>\r\n                      </div>\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <Switch\r\n                          checked={item.is_active}\r\n                          onCheckedChange={() => handleToggleActive(item)}\r\n                        />\r\n                        {item.is_active ? (\r\n                          <Eye className=\"h-4 w-4 text-green-500\" />\r\n                        ) : (\r\n                          <EyeOff className=\"h-4 w-4 text-muted-foreground\" />\r\n                        )}\r\n                      </div>\r\n                    </TableCell>\r\n                    <TableCell className=\"text-right\">\r\n                      <div className=\"flex items-center justify-end gap-1\">\r\n                        <Button \r\n                          variant=\"ghost\" \r\n                          size=\"icon\" \r\n                          onClick={() => handleResetLimits(item)}\r\n                          title={t(\"admin.shop.resetLimits\")}\r\n                        >\r\n                          <RotateCcw className=\"h-4 w-4 text-amber-500\" />\r\n                        </Button>\r\n                        <Button variant=\"ghost\" size=\"icon\" onClick={() => handleEdit(item)}>\r\n                          <Edit className=\"h-4 w-4\" />\r\n                        </Button>\r\n                        <Button variant=\"ghost\" size=\"icon\" onClick={() => handleDelete(item)}>\r\n                          <Trash2 className=\"h-4 w-4 text-destructive\" />\r\n                        </Button>\r\n                      </div>\r\n                    </TableCell>\r\n                  </TableRow>\r\n                ))}\r\n              </TableBody>\r\n            </Table>\r\n          ) : (\r\n            <div className=\"text-center py-12 text-muted-foreground\">\r\n              <Package className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\r\n              <p>{t(\"admin.shop.noItems\")}</p>\r\n              <Button variant=\"outline\" className=\"mt-4\" onClick={handleAdd}>\r\n                <Plus className=\"h-4 w-4 mr-2\" />\r\n                {t(\"admin.shop.addFirstItem\")}\r\n              </Button>\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <ShopItemFormDialog\r\n        open={formOpen}\r\n        onOpenChange={setFormOpen}\r\n        item={editingItem}\r\n      />\r\n\r\n      <AlertDialog open={deleteDialogOpen} onOpenChange={setDeleteDialogOpen}>\r\n        <AlertDialogContent>\r\n          <AlertDialogHeader>\r\n            <AlertDialogTitle>{t(\"admin.shop.confirmDelete\")}</AlertDialogTitle>\r\n            <AlertDialogDescription>\r\n              {t(\"admin.shop.deleteWarning\")}\r\n            </AlertDialogDescription>\r\n          </AlertDialogHeader>\r\n          <AlertDialogFooter>\r\n            <AlertDialogCancel>{t(\"common.cancel\")}</AlertDialogCancel>\r\n            <AlertDialogAction onClick={confirmDelete} className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\">\r\n              {t(\"common.delete\")}\r\n            </AlertDialogAction>\r\n          </AlertDialogFooter>\r\n        </AlertDialogContent>\r\n      </AlertDialog>\r\n\r\n      <ResetUserPurchaseLimitDialog\r\n        open={resetLimitsDialogOpen}\r\n        onOpenChange={setResetLimitsDialogOpen}\r\n        itemId={itemToResetLimits?.id || \"\"}\r\n        itemName={itemToResetLimits ? getLocalizedField(itemToResetLimits, \"name\") : \"\"}\r\n        onConfirm={handleConfirmResetUserLimit}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdminShopItems;\r\n"],"names":["formSchema","z.object","z.string","z.number","z.boolean","ShopItemFormDialog","open","onOpenChange","item","t","useTranslation","saveItem","useSaveShopItem","couponTemplates","setCouponTemplates","useState","isLoadingTemplates","setIsLoadingTemplates","form","useForm","zodResolver","useEffect","data","error","supabase","onSubmit","toast","itemType","Dialog","jsxs","DialogContent","jsx","DialogHeader","DialogTitle","Form","FormField","field","FormItem","FormLabel","Select","FormControl","SelectTrigger","SelectValue","SelectContent","SelectItem","FormMessage","template","Input","Textarea","FormDescription","e","Switch","Button","ResetUserPurchaseLimitDialog","itemId","itemName","onConfirm","searchQuery","setSearchQuery","selectedUserId","setSelectedUserId","usersWithLimits","isLoading","useQuery","limits","userIds","l","profiles","profileMap","p","limit","filteredUsers","user","query","handleConfirm","handleClose","DialogDescription","Search","ScrollArea","Avatar","AvatarImage","AvatarFallback","User","DialogFooter","AdminShopItems","getLocalizedField","useLocalizedContent","items","useAllShopItems","settings","updateSettings","useSiteSettings","deleteItem","useDeleteShopItem","resetLimits","useResetItemPurchaseLimits","formOpen","setFormOpen","editingItem","setEditingItem","deleteDialogOpen","setDeleteDialogOpen","itemToDelete","setItemToDelete","resetLimitsDialogOpen","setResetLimitsDialogOpen","itemToResetLimits","setItemToResetLimits","handleToggleShopEnabled","newValue","handleAdd","handleEdit","handleDelete","confirmDelete","handleResetLimits","handleConfirmResetUserLimit","userId","handleToggleActive","getItemTypeLabel","type","getRefreshPeriodLabel","period","Plus","Card","CardHeader","CardTitle","Store","CardDescription","CardContent","Label","Fragment","Eye","EyeOff","Package","Table","TableHeader","TableRow","TableHead","TableBody","TableCell","GripVertical","Badge","RotateCcw","Edit","Trash2","AlertDialog","AlertDialogContent","AlertDialogHeader","AlertDialogTitle","AlertDialogDescription","AlertDialogFooter","AlertDialogCancel","AlertDialogAction"],"mappings":"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"}