{"version":3,"file":"AdminComments-DNCr6Tsw.js","sources":["../../src/hooks/useCommentModeration.ts","../../src/pages/admin/AdminComments.tsx"],"sourcesContent":["import { useMutation, useQuery, useQueryClient } from \"@tanstack/react-query\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { useToast } from \"@/hooks/use-toast\";\r\n\r\nexport interface ModerationComment {\r\n  id: string;\r\n  user_id: string;\r\n  target_id: string;\r\n  target_type: string;\r\n  content: string;\r\n  rating_value?: number | null;\r\n  image_url?: string;\r\n  parent_id?: string;\r\n  created_at: string;\r\n  moderation_status: string;\r\n  risk_score: number;\r\n  risk_reasons: string[];\r\n  ai_reviewed_at?: string;\r\n  reviewed_by?: string;\r\n  reviewed_at?: string;\r\n  archived?: boolean;\r\n  profiles?: {\r\n    display_name: string;\r\n    avatar_url?: string;\r\n  };\r\n  target_name?: string;\r\n  target_name_en?: string;\r\n  target_name_pt?: string;\r\n}\r\n\r\nexport type CommentViewMode = \"pending\" | \"approved\" | \"rejected\" | \"archived\";\r\n\r\nexport const useAdminComments = (viewMode: CommentViewMode = \"pending\") => {\r\n  return useQuery({\r\n    queryKey: [\"admin-comments\", viewMode],\r\n    queryFn: async () => {\r\n      let query = supabase\r\n        .from(\"comments\")\r\n        .select(\"*\")\r\n        .is(\"parent_id\", null)\r\n        .order(\"created_at\", { ascending: false })\r\n        .limit(200);\r\n\r\n      // Filter based on view mode\r\n      if (viewMode === \"archived\") {\r\n        query = query.eq(\"archived\", true);\r\n      } else {\r\n        // Non-archived comments\r\n        query = query.or(\"archived.is.null,archived.eq.false\");\r\n        \r\n        if (viewMode === \"pending\") {\r\n          // Show pending and flagged (needs review)\r\n          query = query.in(\"moderation_status\", [\"pending\", \"flagged\"]);\r\n        } else if (viewMode === \"approved\") {\r\n          query = query.eq(\"moderation_status\", \"approved\");\r\n        } else if (viewMode === \"rejected\") {\r\n          query = query.eq(\"moderation_status\", \"rejected\");\r\n        }\r\n      }\r\n\r\n      const { data: comments, error } = await query;\r\n\r\n      if (error) throw error;\r\n      if (!comments || comments.length === 0) return [];\r\n\r\n      // Get unique user IDs\r\n      const userIds = [...new Set(comments.map((c) => c.user_id))];\r\n\r\n      // Get profiles\r\n      const { data: profiles } = await supabase.rpc(\"get_public_profiles\", {\r\n        user_ids: userIds,\r\n      });\r\n\r\n      const profileMap = new Map(\r\n        (profiles || []).map((p: { id: string; display_name: string; avatar_url: string }) => [\r\n          p.id,\r\n          { display_name: p.display_name, avatar_url: p.avatar_url },\r\n        ])\r\n      );\r\n\r\n      // Get restaurant names\r\n      const restaurantIds = comments\r\n        .filter((c) => c.target_type === \"restaurant\")\r\n        .map((c) => c.target_id);\r\n      const activityIds = comments\r\n        .filter((c) => c.target_type === \"activity\")\r\n        .map((c) => c.target_id);\r\n\r\n      const restaurantMap = new Map<string, { name: string; name_en?: string; name_pt?: string }>();\r\n      const activityMap = new Map<string, { title_zh: string; title_en?: string; title_pt?: string }>();\r\n\r\n      if (restaurantIds.length > 0) {\r\n        const { data: restaurants } = await supabase\r\n          .from(\"restaurants\")\r\n          .select(\"id, name, name_en, name_pt\")\r\n          .in(\"id\", restaurantIds);\r\n\r\n        restaurants?.forEach((r) => {\r\n          restaurantMap.set(r.id, { name: r.name, name_en: r.name_en || undefined, name_pt: r.name_pt || undefined });\r\n        });\r\n      }\r\n\r\n      if (activityIds.length > 0) {\r\n        const { data: activities } = await supabase\r\n          .from(\"activities\")\r\n          .select(\"id, title_zh, title_en, title_pt\")\r\n          .in(\"id\", activityIds);\r\n\r\n        activities?.forEach((a) => {\r\n          activityMap.set(a.id, { title_zh: a.title_zh, title_en: a.title_en, title_pt: a.title_pt });\r\n        });\r\n      }\r\n\r\n      return comments.map((comment) => {\r\n        let targetName = \"\";\r\n        let targetNameEn: string | undefined;\r\n        let targetNamePt: string | undefined;\r\n\r\n        if (comment.target_type === \"restaurant\") {\r\n          const restaurant = restaurantMap.get(comment.target_id);\r\n          targetName = restaurant?.name || \"Unknown Restaurant\";\r\n          targetNameEn = restaurant?.name_en;\r\n          targetNamePt = restaurant?.name_pt;\r\n        } else if (comment.target_type === \"activity\") {\r\n          const activity = activityMap.get(comment.target_id);\r\n          targetName = activity?.title_zh || \"Unknown Activity\";\r\n          targetNameEn = activity?.title_en;\r\n          targetNamePt = activity?.title_pt;\r\n        }\r\n\r\n        return {\r\n          ...comment,\r\n          risk_reasons: Array.isArray(comment.risk_reasons) ? comment.risk_reasons : [],\r\n          profiles: profileMap.get(comment.user_id),\r\n          target_name: targetName,\r\n          target_name_en: targetNameEn,\r\n          target_name_pt: targetNamePt,\r\n        } as ModerationComment;\r\n      });\r\n    },\r\n  });\r\n};\r\n\r\nexport const useModerateComment = () => {\r\n  const { toast } = useToast();\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: async ({\r\n      commentId,\r\n      action,\r\n    }: {\r\n      commentId: string;\r\n      action: \"approve\" | \"reject\" | \"flag\";\r\n    }) => {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (!user) throw new Error(\"Not authenticated\");\r\n\r\n      const statusMap = {\r\n        approve: \"approved\",\r\n        reject: \"rejected\",\r\n        flag: \"flagged\",\r\n      };\r\n\r\n      const { error } = await supabase\r\n        .from(\"comments\")\r\n        .update({\r\n          moderation_status: statusMap[action],\r\n          reviewed_by: user.id,\r\n          reviewed_at: new Date().toISOString(),\r\n        })\r\n        .eq(\"id\", commentId);\r\n\r\n      if (error) throw error;\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: [\"admin-comments\"] });\r\n      toast({\r\n        title: \"审核完成\",\r\n        description: \"评论状态已更新\",\r\n      });\r\n    },\r\n    onError: () => {\r\n      toast({\r\n        title: \"操作失败\",\r\n        description: \"无法更新评论状态\",\r\n        variant: \"destructive\",\r\n      });\r\n    },\r\n  });\r\n};\r\n\r\nexport const useBatchModerateComments = () => {\r\n  const { toast } = useToast();\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: async ({\r\n      commentIds,\r\n      action,\r\n    }: {\r\n      commentIds: string[];\r\n      action: \"approve\" | \"reject\";\r\n    }) => {\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (!user) throw new Error(\"Not authenticated\");\r\n\r\n      const statusMap = {\r\n        approve: \"approved\",\r\n        reject: \"rejected\",\r\n      };\r\n\r\n      const { error } = await supabase\r\n        .from(\"comments\")\r\n        .update({\r\n          moderation_status: statusMap[action],\r\n          reviewed_by: user.id,\r\n          reviewed_at: new Date().toISOString(),\r\n        })\r\n        .in(\"id\", commentIds);\r\n\r\n      if (error) throw error;\r\n    },\r\n    onSuccess: (_, variables) => {\r\n      queryClient.invalidateQueries({ queryKey: [\"admin-comments\"] });\r\n      toast({\r\n        title: \"批量审核完成\",\r\n        description: `已${variables.action === \"approve\" ? \"通过\" : \"拒绝\"} ${variables.commentIds.length} 条评论`,\r\n      });\r\n    },\r\n    onError: () => {\r\n      toast({\r\n        title: \"批量操作失败\",\r\n        description: \"无法更新评论状态\",\r\n        variant: \"destructive\",\r\n      });\r\n    },\r\n  });\r\n};\r\n\r\nexport const useTriggerAIModeration = () => {\r\n  return useMutation({\r\n    mutationFn: async ({\r\n      commentId,\r\n      content,\r\n      userId,\r\n      sensitiveWordDetected = false,\r\n    }: {\r\n      commentId: string;\r\n      content: string;\r\n      userId: string;\r\n      sensitiveWordDetected?: boolean;\r\n    }) => {\r\n      const { data, error } = await supabase.functions.invoke(\"moderate-comment\", {\r\n        body: {\r\n          comment_id: commentId,\r\n          content,\r\n          user_id: userId,\r\n          sensitive_word_detected: sensitiveWordDetected,\r\n        },\r\n      });\r\n\r\n      if (error) throw error;\r\n      return data;\r\n    },\r\n  });\r\n};\r\n\r\nexport const useArchiveComment = () => {\r\n  const { toast } = useToast();\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: async ({\r\n      commentId,\r\n      archived,\r\n    }: {\r\n      commentId: string;\r\n      archived: boolean;\r\n    }) => {\r\n      const { error } = await supabase\r\n        .from(\"comments\")\r\n        .update({ archived })\r\n        .eq(\"id\", commentId);\r\n\r\n      if (error) throw error;\r\n    },\r\n    onSuccess: (_, variables) => {\r\n      queryClient.invalidateQueries({ queryKey: [\"admin-comments\"] });\r\n      toast({\r\n        title: variables.archived ? \"已归档\" : \"已取消归档\",\r\n        description: variables.archived ? \"评论已移至归档\" : \"评论已恢复到列表\",\r\n      });\r\n    },\r\n    onError: () => {\r\n      toast({\r\n        title: \"操作失败\",\r\n        description: \"无法更新归档状态\",\r\n        variant: \"destructive\",\r\n      });\r\n    },\r\n  });\r\n};\r\n\r\nexport const useBatchArchiveComments = () => {\r\n  const { toast } = useToast();\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: async ({\r\n      commentIds,\r\n      archived,\r\n    }: {\r\n      commentIds: string[];\r\n      archived: boolean;\r\n    }) => {\r\n      const { error } = await supabase\r\n        .from(\"comments\")\r\n        .update({ archived })\r\n        .in(\"id\", commentIds);\r\n\r\n      if (error) throw error;\r\n    },\r\n    onSuccess: (_, variables) => {\r\n      queryClient.invalidateQueries({ queryKey: [\"admin-comments\"] });\r\n      toast({\r\n        title: variables.archived ? \"批量归档完成\" : \"批量取消归档完成\",\r\n        description: `已${variables.archived ? \"归档\" : \"恢复\"} ${variables.commentIds.length} 条评论`,\r\n      });\r\n    },\r\n    onError: () => {\r\n      toast({\r\n        title: \"批量操作失败\",\r\n        description: \"无法更新归档状态\",\r\n        variant: \"destructive\",\r\n      });\r\n    },\r\n  });\r\n};\r\n","import { useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { format } from \"date-fns\";\r\nimport {\r\n  MessageSquare,\r\n  Check,\r\n  X,\r\n  AlertTriangle,\r\n  Eye,\r\n  Search,\r\n  Bot,\r\n  User,\r\n  Star,\r\n  ExternalLink,\r\n  Archive,\r\n  ArchiveRestore,\r\n} from \"lucide-react\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Checkbox } from \"@/components/ui/checkbox\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n} from \"@/components/ui/table\";\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from \"@/components/ui/dialog\";\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\r\nimport { Link } from \"react-router-dom\";\r\nimport {\r\n  useAdminComments,\r\n  useModerateComment,\r\n  useBatchModerateComments,\r\n  useArchiveComment,\r\n  useBatchArchiveComments,\r\n  ModerationComment,\r\n  CommentViewMode,\r\n} from \"@/hooks/useCommentModeration\";\r\nimport { useLocalizedContent } from \"@/hooks/useLocalizedContent\";\r\n\r\nconst getRiskColor = (score: number) => {\r\n  if (score <= 30) return \"bg-green-500/10 text-green-600 border-green-500/20\";\r\n  if (score <= 60) return \"bg-yellow-500/10 text-yellow-600 border-yellow-500/20\";\r\n  return \"bg-red-500/10 text-red-600 border-red-500/20\";\r\n};\r\n\r\nconst getStatusBadge = (status: string, t: (key: string) => string) => {\r\n  switch (status) {\r\n    case \"approved\":\r\n      return <Badge variant=\"outline\" className=\"bg-green-500/10 text-green-600 border-green-500/20\">{t(\"admin.comments.status.approved\")}</Badge>;\r\n    case \"pending\":\r\n      return <Badge variant=\"outline\" className=\"bg-yellow-500/10 text-yellow-600 border-yellow-500/20\">{t(\"admin.comments.status.pending\")}</Badge>;\r\n    case \"flagged\":\r\n      return <Badge variant=\"outline\" className=\"bg-orange-500/10 text-orange-600 border-orange-500/20\">{t(\"admin.comments.status.flagged\")}</Badge>;\r\n    case \"rejected\":\r\n      return <Badge variant=\"outline\" className=\"bg-red-500/10 text-red-600 border-red-500/20\">{t(\"admin.comments.status.rejected\")}</Badge>;\r\n    default:\r\n      return <Badge variant=\"secondary\">{status}</Badge>;\r\n  }\r\n};\r\n\r\nconst getRiskReasonLabel = (reason: string, t: (key: string) => string) => {\r\n  const keyMap: Record<string, string> = {\r\n    spam: \"admin.comments.risk.spam\",\r\n    offensive: \"admin.comments.risk.offensive\",\r\n    harassment: \"admin.comments.risk.harassment\",\r\n    fake_review: \"admin.comments.risk.fake_review\",\r\n    flooding: \"admin.comments.risk.flooding\",\r\n    irrelevant: \"admin.comments.risk.irrelevant\",\r\n    sensitive_word_detected: \"admin.comments.risk.sensitive_word_detected\",\r\n    parse_error: \"admin.comments.risk.parse_error\",\r\n  };\r\n  return keyMap[reason] ? t(keyMap[reason]) : reason;\r\n};\r\n\r\nconst AdminComments = () => {\r\n  const { t, i18n } = useTranslation();\r\n  const { currentLang } = useLocalizedContent();\r\n  const [viewMode, setViewMode] = useState<CommentViewMode>(\"pending\");\r\n  const [searchQuery, setSearchQuery] = useState(\"\");\r\n  const [selectedComments, setSelectedComments] = useState<string[]>([]);\r\n  const [detailComment, setDetailComment] = useState<ModerationComment | null>(null);\r\n\r\n  const { data: comments, isLoading } = useAdminComments(viewMode);\r\n  const moderateComment = useModerateComment();\r\n  const batchModerate = useBatchModerateComments();\r\n  const archiveComment = useArchiveComment();\r\n  const batchArchive = useBatchArchiveComments();\r\n\r\n  const filteredComments = comments?.filter((comment) => {\r\n    if (!searchQuery) return true;\r\n    const query = searchQuery.toLowerCase();\r\n    return (\r\n      comment.content.toLowerCase().includes(query) ||\r\n      comment.profiles?.display_name?.toLowerCase().includes(query) ||\r\n      comment.target_name?.toLowerCase().includes(query)\r\n    );\r\n  });\r\n\r\n  const handleSelectAll = (checked: boolean) => {\r\n    if (checked) {\r\n      setSelectedComments(filteredComments?.map((c) => c.id) || []);\r\n    } else {\r\n      setSelectedComments([]);\r\n    }\r\n  };\r\n\r\n  const handleSelectComment = (commentId: string, checked: boolean) => {\r\n    if (checked) {\r\n      setSelectedComments((prev) => [...prev, commentId]);\r\n    } else {\r\n      setSelectedComments((prev) => prev.filter((id) => id !== commentId));\r\n    }\r\n  };\r\n\r\n  const handleBatchAction = (action: \"approve\" | \"reject\") => {\r\n    if (selectedComments.length === 0) return;\r\n    batchModerate.mutate(\r\n      { commentIds: selectedComments, action },\r\n      { onSuccess: () => setSelectedComments([]) }\r\n    );\r\n  };\r\n\r\n  const handleBatchArchive = (archived: boolean) => {\r\n    if (selectedComments.length === 0) return;\r\n    batchArchive.mutate(\r\n      { commentIds: selectedComments, archived },\r\n      { onSuccess: () => setSelectedComments([]) }\r\n    );\r\n  };\r\n\r\n  const getTargetLink = (comment: ModerationComment) => {\r\n    if (comment.target_type === \"restaurant\") {\r\n      return `/restaurant/${comment.target_id}`;\r\n    } else if (comment.target_type === \"activity\") {\r\n      return `/activity/${comment.target_id}`;\r\n    }\r\n    return \"#\";\r\n  };\r\n\r\n  const getLocalizedTargetName = (comment: ModerationComment) => {\r\n    if (i18n.language === \"en\" && comment.target_name_en) {\r\n      return comment.target_name_en;\r\n    }\r\n    if (i18n.language === \"pt\" && comment.target_name_pt) {\r\n      return comment.target_name_pt;\r\n    }\r\n    return comment.target_name || \"\";\r\n  };\r\n\r\n  const stats = {\r\n    total: comments?.length || 0,\r\n    pending: comments?.filter((c) => c.moderation_status === \"pending\").length || 0,\r\n    flagged: comments?.filter((c) => c.moderation_status === \"flagged\").length || 0,\r\n    approved: comments?.filter((c) => c.moderation_status === \"approved\").length || 0,\r\n    rejected: comments?.filter((c) => c.moderation_status === \"rejected\").length || 0,\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold flex items-center gap-2\">\r\n            <MessageSquare className=\"h-6 w-6\" />\r\n            {t(\"admin.comments.title\", \"评论管理\")}\r\n          </h1>\r\n          <p className=\"text-muted-foreground\">\r\n            {t(\"admin.comments.description\", \"审核和管理用户评论，防止恶意内容\")}\r\n          </p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Stats Cards */}\r\n      <div className=\"grid grid-cols-2 md:grid-cols-5 gap-4\">\r\n        <Card>\r\n          <CardContent className=\"pt-4\">\r\n            <div className=\"text-2xl font-bold\">{stats.total}</div>\r\n            <p className=\"text-xs text-muted-foreground\">{t(\"admin.comments.totalComments\")}</p>\r\n          </CardContent>\r\n        </Card>\r\n        <Card className=\"border-yellow-500/20\">\r\n          <CardContent className=\"pt-4\">\r\n            <div className=\"text-2xl font-bold text-yellow-600\">{stats.pending}</div>\r\n            <p className=\"text-xs text-muted-foreground\">{t(\"admin.comments.pendingReview\")}</p>\r\n          </CardContent>\r\n        </Card>\r\n        <Card className=\"border-orange-500/20\">\r\n          <CardContent className=\"pt-4\">\r\n            <div className=\"text-2xl font-bold text-orange-600\">{stats.flagged}</div>\r\n            <p className=\"text-xs text-muted-foreground\">{t(\"admin.comments.flagged\")}</p>\r\n          </CardContent>\r\n        </Card>\r\n        <Card className=\"border-green-500/20\">\r\n          <CardContent className=\"pt-4\">\r\n            <div className=\"text-2xl font-bold text-green-600\">{stats.approved}</div>\r\n            <p className=\"text-xs text-muted-foreground\">{t(\"admin.comments.approved\")}</p>\r\n          </CardContent>\r\n        </Card>\r\n        <Card className=\"border-red-500/20\">\r\n          <CardContent className=\"pt-4\">\r\n            <div className=\"text-2xl font-bold text-red-600\">{stats.rejected}</div>\r\n            <p className=\"text-xs text-muted-foreground\">{t(\"admin.comments.rejected\")}</p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      <Tabs value={viewMode} onValueChange={(v) => { setViewMode(v as CommentViewMode); setSelectedComments([]); }} className=\"space-y-4\">\r\n        <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\r\n          <TabsList>\r\n            <TabsTrigger value=\"pending\" className=\"gap-1\">\r\n              <AlertTriangle className=\"h-4 w-4\" />\r\n              {t(\"admin.comments.pendingReview\")}\r\n              {stats.pending + stats.flagged > 0 && (\r\n                <Badge variant=\"secondary\" className=\"ml-1 h-5 px-1.5\">{stats.pending + stats.flagged}</Badge>\r\n              )}\r\n            </TabsTrigger>\r\n            <TabsTrigger value=\"approved\" className=\"gap-1\">\r\n              <Check className=\"h-4 w-4\" />\r\n              {t(\"admin.comments.approved\")}\r\n            </TabsTrigger>\r\n            <TabsTrigger value=\"rejected\" className=\"gap-1\">\r\n              <X className=\"h-4 w-4\" />\r\n              {t(\"admin.comments.rejected\")}\r\n            </TabsTrigger>\r\n            <TabsTrigger value=\"archived\" className=\"gap-1\">\r\n              <Archive className=\"h-4 w-4\" />\r\n              {t(\"admin.comments.archived\")}\r\n            </TabsTrigger>\r\n          </TabsList>\r\n          <div className=\"relative w-64\">\r\n            <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\r\n            <Input\r\n              placeholder={t(\"admin.comments.search\")}\r\n              value={searchQuery}\r\n              onChange={(e) => setSearchQuery(e.target.value)}\r\n              className=\"pl-9\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <Card>\r\n          <CardHeader>\r\n            <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2\">\r\n              <div>\r\n                <CardTitle>\r\n                  {viewMode === \"pending\" && t(\"admin.comments.reviewList\")}\r\n                  {viewMode === \"approved\" && t(\"admin.comments.approvedList\")}\r\n                  {viewMode === \"rejected\" && t(\"admin.comments.rejectedList\")}\r\n                  {viewMode === \"archived\" && t(\"admin.comments.archivedList\")}\r\n                </CardTitle>\r\n                <CardDescription>\r\n                  {viewMode === \"pending\" && t(\"admin.comments.reviewListDesc\")}\r\n                  {viewMode === \"approved\" && t(\"admin.comments.approvedListDesc\")}\r\n                  {viewMode === \"rejected\" && t(\"admin.comments.rejectedListDesc\")}\r\n                  {viewMode === \"archived\" && t(\"admin.comments.archivedListDesc\")}\r\n                </CardDescription>\r\n              </div>\r\n            </div>\r\n\r\n            {selectedComments.length > 0 && (\r\n              <div className=\"flex items-center gap-2 mt-4 p-2 bg-muted rounded-lg flex-wrap\">\r\n                <span className=\"text-sm\">{t(\"admin.comments.selectedCount\", { count: selectedComments.length })}</span>\r\n                {viewMode === \"pending\" && (\r\n                  <>\r\n                    <Button\r\n                      size=\"sm\"\r\n                      variant=\"outline\"\r\n                      onClick={() => handleBatchAction(\"approve\")}\r\n                      disabled={batchModerate.isPending}\r\n                    >\r\n                      <Check className=\"h-4 w-4 mr-1\" />\r\n                      {t(\"admin.comments.batchApprove\")}\r\n                    </Button>\r\n                    <Button\r\n                      size=\"sm\"\r\n                      variant=\"outline\"\r\n                      onClick={() => handleBatchAction(\"reject\")}\r\n                      disabled={batchModerate.isPending}\r\n                    >\r\n                      <X className=\"h-4 w-4 mr-1\" />\r\n                      {t(\"admin.comments.batchReject\")}\r\n                    </Button>\r\n                  </>\r\n                )}\r\n                <Button\r\n                  size=\"sm\"\r\n                  variant=\"outline\"\r\n                  onClick={() => handleBatchArchive(viewMode !== \"archived\")}\r\n                  disabled={batchArchive.isPending}\r\n                >\r\n                  {viewMode === \"archived\" ? (\r\n                    <>\r\n                      <ArchiveRestore className=\"h-4 w-4 mr-1\" />\r\n                      {t(\"admin.comments.batchRestore\")}\r\n                    </>\r\n                  ) : (\r\n                    <>\r\n                      <Archive className=\"h-4 w-4 mr-1\" />\r\n                      {t(\"admin.comments.batchArchive\")}\r\n                    </>\r\n                  )}\r\n                </Button>\r\n                <Button size=\"sm\" variant=\"ghost\" onClick={() => setSelectedComments([])}>\r\n                  {t(\"admin.comments.cancelSelection\")}\r\n                </Button>\r\n              </div>\r\n            )}\r\n          </CardHeader>\r\n        <CardContent>\r\n          {isLoading ? (\r\n            <div className=\"text-center py-8 text-muted-foreground\">{t(\"admin.comments.loading\")}</div>\r\n          ) : filteredComments && filteredComments.length > 0 ? (\r\n            <div className=\"rounded-md border\">\r\n              <Table>\r\n                <TableHeader>\r\n                  <TableRow>\r\n                    <TableHead className=\"w-12\">\r\n                      <Checkbox\r\n                        checked={\r\n                          filteredComments.length > 0 &&\r\n                          selectedComments.length === filteredComments.length\r\n                        }\r\n                        onCheckedChange={handleSelectAll}\r\n                      />\r\n                    </TableHead>\r\n                    <TableHead className=\"w-16\">{t(\"admin.comments.risk\")}</TableHead>\r\n                    <TableHead>{t(\"admin.comments.content\")}</TableHead>\r\n                    <TableHead>{t(\"admin.comments.user\")}</TableHead>\r\n                    <TableHead>{t(\"admin.comments.target\")}</TableHead>\r\n                    <TableHead>{t(\"admin.comments.status\")}</TableHead>\r\n                    <TableHead>{t(\"admin.comments.time\")}</TableHead>\r\n                    <TableHead className=\"text-right\">{t(\"admin.comments.actions\")}</TableHead>\r\n                  </TableRow>\r\n                </TableHeader>\r\n                <TableBody>\r\n                  {filteredComments.map((comment) => (\r\n                    <TableRow\r\n                      key={comment.id}\r\n                      className={\r\n                        comment.risk_score > 60\r\n                          ? \"bg-red-500/5\"\r\n                          : comment.risk_score > 30\r\n                          ? \"bg-yellow-500/5\"\r\n                          : \"\"\r\n                      }\r\n                    >\r\n                      <TableCell>\r\n                        <Checkbox\r\n                          checked={selectedComments.includes(comment.id)}\r\n                          onCheckedChange={(checked) =>\r\n                            handleSelectComment(comment.id, checked as boolean)\r\n                          }\r\n                        />\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <Badge\r\n                          variant=\"outline\"\r\n                          className={getRiskColor(comment.risk_score)}\r\n                        >\r\n                          {comment.risk_score}\r\n                        </Badge>\r\n                      </TableCell>\r\n                      <TableCell className=\"max-w-xs\">\r\n                        <div className=\"truncate\" title={comment.content}>\r\n                          {comment.content}\r\n                        </div>\r\n                        {comment.risk_reasons.length > 0 && (\r\n                          <div className=\"flex flex-wrap gap-1 mt-1\">\r\n                            {comment.risk_reasons.map((reason, idx) => (\r\n                              <Badge key={idx} variant=\"secondary\" className=\"text-xs\">\r\n                                {getRiskReasonLabel(reason, t)}\r\n                              </Badge>\r\n                            ))}\r\n                          </div>\r\n                        )}\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <Avatar className=\"h-6 w-6\">\r\n                            <AvatarImage src={comment.profiles?.avatar_url} />\r\n                            <AvatarFallback>\r\n                              <User className=\"h-3 w-3\" />\r\n                            </AvatarFallback>\r\n                          </Avatar>\r\n                          <span className=\"text-sm truncate max-w-[100px]\">\r\n                            {comment.profiles?.display_name || \"Unknown\"}\r\n                          </span>\r\n                        </div>\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <Link\r\n                          to={getTargetLink(comment)}\r\n                          className=\"flex items-center gap-1 text-sm hover:underline text-primary\"\r\n                        >\r\n                          <span className=\"truncate max-w-[120px]\">\r\n                            {getLocalizedTargetName(comment)}\r\n                          </span>\r\n                          <ExternalLink className=\"h-3 w-3\" />\r\n                        </Link>\r\n                      </TableCell>\r\n                      <TableCell>{getStatusBadge(comment.moderation_status, t)}</TableCell>\r\n                      <TableCell className=\"text-sm text-muted-foreground\">\r\n                        {format(new Date(comment.created_at), \"MM-dd HH:mm\")}\r\n                      </TableCell>\r\n                      <TableCell className=\"text-right\">\r\n                        <div className=\"flex items-center justify-end gap-1\">\r\n                          <Button\r\n                            size=\"icon\"\r\n                            variant=\"ghost\"\r\n                            onClick={() => setDetailComment(comment)}\r\n                            title={t(\"admin.comments.viewDetails\")}\r\n                          >\r\n                            <Eye className=\"h-4 w-4\" />\r\n                          </Button>\r\n                          {viewMode === \"pending\" && comment.moderation_status !== \"approved\" && (\r\n                            <Button\r\n                              size=\"icon\"\r\n                              variant=\"ghost\"\r\n                              onClick={() =>\r\n                                moderateComment.mutate({\r\n                                  commentId: comment.id,\r\n                                  action: \"approve\",\r\n                                })\r\n                              }\r\n                              disabled={moderateComment.isPending}\r\n                              title={t(\"admin.comments.approve\")}\r\n                              className=\"text-green-600 hover:text-green-700\"\r\n                            >\r\n                              <Check className=\"h-4 w-4\" />\r\n                            </Button>\r\n                          )}\r\n                          {viewMode === \"pending\" && comment.moderation_status !== \"rejected\" && (\r\n                            <Button\r\n                              size=\"icon\"\r\n                              variant=\"ghost\"\r\n                              onClick={() =>\r\n                                moderateComment.mutate({\r\n                                  commentId: comment.id,\r\n                                  action: \"reject\",\r\n                                })\r\n                              }\r\n                              disabled={moderateComment.isPending}\r\n                              title={t(\"admin.comments.reject\")}\r\n                              className=\"text-red-600 hover:text-red-700\"\r\n                            >\r\n                              <X className=\"h-4 w-4\" />\r\n                            </Button>\r\n                          )}\r\n                          <Button\r\n                            size=\"icon\"\r\n                            variant=\"ghost\"\r\n                            onClick={() =>\r\n                              archiveComment.mutate({\r\n                                commentId: comment.id,\r\n                                archived: viewMode !== \"archived\",\r\n                              })\r\n                            }\r\n                            disabled={archiveComment.isPending}\r\n                            title={viewMode === \"archived\" ? t(\"admin.comments.restore\") : t(\"admin.comments.archive\")}\r\n                            className=\"text-muted-foreground hover:text-foreground\"\r\n                          >\r\n                            {viewMode === \"archived\" ? (\r\n                              <ArchiveRestore className=\"h-4 w-4\" />\r\n                            ) : (\r\n                              <Archive className=\"h-4 w-4\" />\r\n                            )}\r\n                          </Button>\r\n                        </div>\r\n                      </TableCell>\r\n                    </TableRow>\r\n                  ))}\r\n                </TableBody>\r\n              </Table>\r\n            </div>\r\n          ) : (\r\n            <div className=\"text-center py-8 text-muted-foreground\">\r\n              {searchQuery ? t(\"admin.comments.noMatchingComments\") : t(\"admin.comments.noComments\")}\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n    </Tabs>\r\n\r\n      {/* Comment Detail Dialog */}\r\n      <Dialog open={!!detailComment} onOpenChange={() => setDetailComment(null)}>\r\n        <DialogContent className=\"max-w-2xl\">\r\n          <DialogHeader>\r\n            <DialogTitle>{t(\"admin.comments.commentDetails\")}</DialogTitle>\r\n            <DialogDescription>\r\n              {t(\"admin.comments.commentDetailsDesc\")}\r\n            </DialogDescription>\r\n          </DialogHeader>\r\n          {detailComment && (\r\n            <ScrollArea className=\"max-h-[60vh]\">\r\n              <div className=\"space-y-4\">\r\n                {/* User Info */}\r\n                <div className=\"flex items-center gap-3 p-3 bg-muted rounded-lg\">\r\n                  <Avatar>\r\n                    <AvatarImage src={detailComment.profiles?.avatar_url} />\r\n                    <AvatarFallback>\r\n                      <User className=\"h-4 w-4\" />\r\n                    </AvatarFallback>\r\n                  </Avatar>\r\n                  <div>\r\n                    <div className=\"font-medium\">\r\n                      {detailComment.profiles?.display_name || \"Unknown\"}\r\n                    </div>\r\n                    <div className=\"text-sm text-muted-foreground\">\r\n                      {format(new Date(detailComment.created_at), \"yyyy-MM-dd HH:mm:ss\")}\r\n                    </div>\r\n                  </div>\r\n                  {detailComment.rating_value && (\r\n                    <div className=\"ml-auto flex items-center gap-1\">\r\n                      <Star className=\"h-4 w-4 fill-yellow-400 text-yellow-400\" />\r\n                      <span>{detailComment.rating_value}</span>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n\r\n                {/* Content */}\r\n                <div>\r\n                  <h4 className=\"font-medium mb-2\">{t(\"admin.comments.commentContent\")}</h4>\r\n                  <div className=\"p-3 bg-muted rounded-lg whitespace-pre-wrap\">\r\n                    {detailComment.content}\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Image */}\r\n                {detailComment.image_url && (\r\n                  <div>\r\n                    <h4 className=\"font-medium mb-2\">{t(\"admin.comments.commentImage\")}</h4>\r\n                    <img\r\n                      src={detailComment.image_url}\r\n                      alt=\"Comment\"\r\n                      className=\"max-w-full h-auto rounded-lg\"\r\n                    />\r\n                  </div>\r\n                )}\r\n\r\n                {/* Target */}\r\n                <div>\r\n                  <h4 className=\"font-medium mb-2\">{t(\"admin.comments.commentTarget\")}</h4>\r\n                  <Link\r\n                    to={getTargetLink(detailComment)}\r\n                    className=\"flex items-center gap-2 p-3 bg-muted rounded-lg hover:bg-muted/80\"\r\n                  >\r\n                    <span>\r\n                      {detailComment.target_type === \"restaurant\" ? t(\"admin.comments.restaurant\") : t(\"admin.comments.activity\")}:\r\n                    </span>\r\n                    <span className=\"text-primary\">{getLocalizedTargetName(detailComment)}</span>\r\n                    <ExternalLink className=\"h-4 w-4\" />\r\n                  </Link>\r\n                </div>\r\n\r\n                {/* AI Analysis */}\r\n                <div>\r\n                  <h4 className=\"font-medium mb-2 flex items-center gap-2\">\r\n                    <Bot className=\"h-4 w-4\" />\r\n                    {t(\"admin.comments.aiAnalysis\")}\r\n                  </h4>\r\n                  <div className=\"p-3 bg-muted rounded-lg space-y-2\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <span>{t(\"admin.comments.riskScore\")}:</span>\r\n                      <Badge variant=\"outline\" className={getRiskColor(detailComment.risk_score)}>\r\n                        {detailComment.risk_score}/100\r\n                      </Badge>\r\n                    </div>\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <span>{t(\"admin.comments.moderationStatus\")}:</span>\r\n                      {getStatusBadge(detailComment.moderation_status, t)}\r\n                    </div>\r\n                    {detailComment.risk_reasons.length > 0 && (\r\n                      <div>\r\n                        <span>{t(\"admin.comments.issuesDetected\")}:</span>\r\n                        <div className=\"flex flex-wrap gap-1 mt-1\">\r\n                          {detailComment.risk_reasons.map((reason, idx) => (\r\n                            <Badge key={idx} variant=\"secondary\">\r\n                              {getRiskReasonLabel(reason, t)}\r\n                            </Badge>\r\n                          ))}\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                    {detailComment.ai_reviewed_at && (\r\n                      <div className=\"text-sm text-muted-foreground\">\r\n                        {t(\"admin.comments.aiReviewTime\")}: {format(new Date(detailComment.ai_reviewed_at), \"yyyy-MM-dd HH:mm:ss\")}\r\n                      </div>\r\n                    )}\r\n                    {detailComment.reviewed_at && (\r\n                      <div className=\"text-sm text-muted-foreground\">\r\n                        {t(\"admin.comments.manualReviewTime\")}: {format(new Date(detailComment.reviewed_at), \"yyyy-MM-dd HH:mm:ss\")}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Actions */}\r\n                <div className=\"flex gap-2 pt-4 border-t\">\r\n                  {detailComment.moderation_status !== \"approved\" && (\r\n                    <Button\r\n                      onClick={() => {\r\n                        moderateComment.mutate(\r\n                          { commentId: detailComment.id, action: \"approve\" },\r\n                          { onSuccess: () => setDetailComment(null) }\r\n                        );\r\n                      }}\r\n                      disabled={moderateComment.isPending}\r\n                      className=\"bg-green-600 hover:bg-green-700\"\r\n                    >\r\n                      <Check className=\"h-4 w-4 mr-2\" />\r\n                      {t(\"admin.comments.approve\")}\r\n                    </Button>\r\n                  )}\r\n                  {detailComment.moderation_status !== \"rejected\" && (\r\n                    <Button\r\n                      variant=\"destructive\"\r\n                      onClick={() => {\r\n                        moderateComment.mutate(\r\n                          { commentId: detailComment.id, action: \"reject\" },\r\n                          { onSuccess: () => setDetailComment(null) }\r\n                        );\r\n                      }}\r\n                      disabled={moderateComment.isPending}\r\n                    >\r\n                      <X className=\"h-4 w-4 mr-2\" />\r\n                      {t(\"admin.comments.reject\")}\r\n                    </Button>\r\n                  )}\r\n                  <Button variant=\"outline\" onClick={() => setDetailComment(null)}>\r\n                    {t(\"admin.comments.close\")}\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </ScrollArea>\r\n          )}\r\n        </DialogContent>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdminComments;\r\n"],"names":["useAdminComments","viewMode","useQuery","query","supabase","comments","error","userIds","c","profiles","profileMap","p","restaurantIds","activityIds","restaurantMap","activityMap","restaurants","r","activities","a","comment","targetName","targetNameEn","targetNamePt","restaurant","activity","useModerateComment","toast","useToast","queryClient","useQueryClient","useMutation","commentId","action","user","statusMap","useBatchModerateComments","commentIds","_","variables","useArchiveComment","archived","useBatchArchiveComments","getRiskColor","score","getStatusBadge","status","t","jsx","Badge","getRiskReasonLabel","reason","keyMap","AdminComments","i18n","useTranslation","useLocalizedContent","setViewMode","useState","searchQuery","setSearchQuery","selectedComments","setSelectedComments","detailComment","setDetailComment","isLoading","moderateComment","batchModerate","archiveComment","batchArchive","filteredComments","handleSelectAll","checked","handleSelectComment","prev","id","handleBatchAction","handleBatchArchive","getTargetLink","getLocalizedTargetName","stats","jsxs","MessageSquare","Card","CardContent","Tabs","v","TabsList","TabsTrigger","AlertTriangle","Check","X","Archive","Search","Input","e","CardHeader","CardTitle","CardDescription","Fragment","Button","ArchiveRestore","Table","TableHeader","TableRow","TableHead","Checkbox","TableBody","TableCell","idx","Avatar","AvatarImage","AvatarFallback","User","Link","ExternalLink","format","Eye","Dialog","DialogContent","DialogHeader","DialogTitle","DialogDescription","ScrollArea","Star","Bot"],"mappings":"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"}