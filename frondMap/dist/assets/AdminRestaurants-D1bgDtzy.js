import{r as f,j as e}from"./vendor-react-core-BErlw7p5.js";import{L as ee}from"./vendor-router-CLK0c9aH.js";import{m as se,r as ae,B as c,C as N,j as v,I as te,X as ie,Y as le,Z as ne,$ as re,a0 as C,A as y,a5 as b,E as S,F as D,G as A,J as R,K as P,L as T,M as k,h as ce,p as me,a2 as oe,o as de,R as xe}from"./index-kEIDKiMZ.js";import{C as _}from"./checkbox-eFOlcZpK.js";import{S as he}from"./switch-DLggLZLa.js";import{u as fe,P as ue,a as je,b as j,c as pe,d as ge,e as Ne,f as ve}from"./usePagination-Be1lFMuE.js";import{u as we}from"./useLocalizedContent-DqTgPnyL.js";import{n as Ce,o as ye,p as be,q as Se}from"./useAdmin-BfKtTn6L.js";import{R as L}from"./RestaurantFormDialog-Cnyt4khi.js";import{a as De}from"./exportUtils-YWmY6fTR.js";import{u as Ae}from"./vendor-i18n-CqcxoxDo.js";import{D as Re,ac as Pe,t as Te,T as ke,u as _e,d as Le}from"./vendor-icons-C2Bicc1E.js";import"./vendor-editor-BdQcs4B3.js";import"./vendor-misc-DH4LiFnZ.js";import"./vendor-date-fYlqblcl.js";import"./vendor-ui-other-CPTlx-W2.js";import"./vendor-query-BS0wY7WL.js";import"./vendor-supabase-Clrw0GhO.js";import"./vendor-ui-dialog-Sv_VEL0d.js";import"./vendor-ui-dropdown-DwTcg2UT.js";import"./vendor-forms-6GCG0Z6m.js";import"./vendor-map-DWLu9L1V.js";import"./tabs-CIAMexK9.js";import"./RichTextEditor-DUm6nj-5.js";const is=()=>{const{t:a}=Ae(),{toast:w}=se(),{isSupervisor:u}=ae(),{data:n,isLoading:E}=Ce(),{getLocalizedField:i}=we(),F=ye(),z=be(),B=Se(),[r,m]=f.useState([]),[o,I]=f.useState(""),[d,M]=f.useState("all"),V=f.useMemo(()=>{if(!n)return[];const s=new Set;return n.forEach(t=>{const l=i(t,"type");Array.isArray(l)?l.forEach(g=>s.add(g)):l&&s.add(l)}),Array.from(s)},[n,i]),H=f.useMemo(()=>n?n.filter(s=>{const t=o===""||i(s,"name").toString().toLowerCase().includes(o.toLowerCase())||s.address.toLowerCase().includes(o.toLowerCase()),l=i(s,"type"),g=d==="all"||(Array.isArray(l)?l.includes(d):l===d);return t&&g}):[],[n,o,d,i]),{currentPage:x,totalPages:p,paginatedData:h,goToPage:$,nextPage:G,previousPage:Q,canGoNext:W,canGoPrevious:q,startIndex:J,endIndex:K,totalItems:U}=fe({data:H,itemsPerPage:10}),X=()=>{if(!n||n.length===0){w({title:a("common.error"),description:a("admin.noDataToExport"),variant:"destructive"});return}De(n),w({title:a("common.success"),description:a("admin.exportSuccess")})},Y=s=>{m(t=>t.includes(s)?t.filter(l=>l!==s):[...t,s])},Z=()=>{r.length===h?.length?m([]):m(h?.map(s=>s.id)||[])},O=()=>{r.length!==0&&(z.mutate(r),m([]))};return E?e.jsx("div",{className:"text-center",children:a("common.loading")}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-2",children:a("admin.restaurantManagement")}),e.jsx("p",{className:"text-muted-foreground",children:a("admin.manageRestaurants")})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(c,{variant:"outline",onClick:X,className:"flex-1 sm:flex-initial",children:[e.jsx(Re,{className:"mr-2 h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:a("admin.exportCSV")})]}),e.jsx(L,{trigger:e.jsxs(c,{className:"flex-1 sm:flex-initial",children:[e.jsx(Pe,{className:"mr-2 h-4 w-4"}),a("admin.addRestaurant")]})})]})]}),e.jsx(N,{children:e.jsx(v,{className:"pt-6",children:e.jsxs("div",{className:"flex gap-4 flex-wrap",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsxs("div",{className:"relative",children:[e.jsx(Te,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(te,{placeholder:a("admin.searchRestaurants"),value:o,onChange:s=>I(s.target.value),className:"pl-9"})]})}),e.jsxs(ie,{value:d,onValueChange:M,children:[e.jsx(le,{className:"w-[180px]",children:e.jsx(ne,{placeholder:a("admin.filterByType")})}),e.jsxs(re,{children:[e.jsx(C,{value:"all",children:a("admin.allTypes")}),V.map(s=>e.jsx(C,{value:s,children:s},s))]})]})]})})}),!u&&r.length>0&&e.jsx(N,{className:"bg-muted/50",children:e.jsx(v,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[e.jsx("span",{className:"font-medium",children:a("admin.selectedCount",{count:r.length})}),e.jsxs("div",{className:"flex gap-2 flex-wrap w-full sm:w-auto",children:[e.jsxs(y,{children:[e.jsx(b,{asChild:!0,children:e.jsxs(c,{variant:"destructive",size:"sm",className:"flex-1 sm:flex-initial",children:[e.jsx(ke,{className:"mr-2 h-4 w-4"}),a("admin.batchDelete")]})}),e.jsxs(S,{className:"max-w-[90vw] sm:max-w-[425px]",children:[e.jsxs(D,{children:[e.jsx(A,{children:a("admin.confirmBatchDelete")}),e.jsx(R,{children:a("admin.batchDeleteWarning",{count:r.length})})]}),e.jsxs(P,{children:[e.jsx(T,{children:a("common.cancel")}),e.jsx(k,{onClick:O,children:a("common.delete")})]})]})]}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>m([]),className:"flex-1 sm:flex-initial",children:a("admin.clearSelection")})]})]})})}),e.jsxs("div",{className:"flex items-center justify-between pb-2 border-b",children:[e.jsx("div",{className:"flex items-center gap-2",children:!u&&e.jsxs(e.Fragment,{children:[e.jsx(_,{checked:r.length===h?.length&&h.length>0,onCheckedChange:Z}),e.jsx("span",{className:"font-medium",children:a("admin.selectAll")})]})}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[a("admin.showing")," ",J,"-",K," ",a("admin.of")," ",U]})]}),e.jsx("div",{className:"grid gap-4",children:h?.map(s=>e.jsx(N,{children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center",children:[e.jsx("div",{className:"p-4 flex items-start md:self-start",children:!u&&e.jsx(_,{checked:r.includes(s.id),onCheckedChange:()=>Y(s.id),className:"mt-1"})}),s.image_url&&e.jsx("div",{className:"w-full md:w-48 h-48 flex items-center justify-center overflow-hidden mx-auto md:mx-0 flex-shrink-0",children:e.jsx("img",{src:s.image_url,alt:String(i(s,"name")),className:"object-cover object-center w-full h-full"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs(ce,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2",children:[e.jsx(me,{className:"text-lg md:text-xl",children:i(s,"name")}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(_e,{className:"h-4 w-4 fill-accent text-accent"}),e.jsx("span",{className:"font-medium",children:s.rating||0})]})})]}),e.jsxs("div",{className:"flex flex-col gap-2 mt-2",children:[e.jsxs(oe,{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"h-3 w-3 flex-shrink-0"}),e.jsx("span",{className:"text-xs sm:text-sm",children:s.address})]}),i(s,"description")&&e.jsx("div",{className:`text-sm text-muted-foreground prose prose-sm max-w-none line-clamp-2\r
                            [&_p]:inline [&_p]:m-0\r
                            [&_strong]:font-semibold [&_strong]:text-foreground\r
                            [&_em]:italic\r
                            [&_h1]:text-base [&_h2]:text-base [&_h3]:text-base\r
                            [&_*]:text-muted-foreground`,dangerouslySetInnerHTML:{__html:i(s,"description")}})]})]}),e.jsxs(v,{children:[e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:(Array.isArray(i(s,"type"))?i(s,"type"):[i(s,"type")]).map((t,l)=>e.jsx(de,{children:t},l))}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(xe,{htmlFor:`visible-${s.id}`,className:"text-sm font-medium",children:a("admin.frontendDisplay")}),e.jsx("div",{className:"text-xs text-muted-foreground",children:s.visible?a("admin.restaurantShown"):a("admin.restaurantHidden")})]}),e.jsx(he,{id:`visible-${s.id}`,checked:s.visible??!0,onCheckedChange:t=>B.mutate({restaurantId:s.id,visible:t})})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(c,{variant:"outline",size:"sm",asChild:!0,className:"flex-1 sm:flex-initial",children:e.jsx(ee,{to:`/restaurant/${s.id}`,state:{from:"admin"},children:a("admin.view")})}),e.jsx(L,{restaurant:s,trigger:e.jsx(c,{variant:"outline",size:"sm",className:"flex-1 sm:flex-initial",children:a("common.edit")})}),!u&&e.jsxs(y,{children:[e.jsx(b,{asChild:!0,children:e.jsx(c,{variant:"outline",size:"sm",className:"flex-1 sm:flex-initial",children:a("common.delete")})}),e.jsxs(S,{className:"max-w-[90vw] sm:max-w-[425px]",children:[e.jsxs(D,{children:[e.jsx(A,{children:a("admin.confirmDelete")}),e.jsx(R,{children:a("admin.deleteRestaurantWarning")})]}),e.jsxs(P,{children:[e.jsx(T,{children:a("common.cancel")}),e.jsx(k,{onClick:()=>F.mutate(s.id),children:a("common.delete")})]})]})]})]})]})]})]})]})},s.id))}),p>1&&e.jsx(ue,{className:"mt-6",children:e.jsxs(je,{children:[e.jsx(j,{children:e.jsx(pe,{onClick:Q,className:q?"cursor-pointer":"pointer-events-none opacity-50"})}),Array.from({length:p},(s,t)=>t+1).map(s=>s===1||s===p||s>=x-1&&s<=x+1?e.jsx(j,{children:e.jsx(ge,{onClick:()=>$(s),isActive:x===s,className:"cursor-pointer",children:s})},s):s===x-2||s===x+2?e.jsx(j,{children:e.jsx(Ne,{})},s):null),e.jsx(j,{children:e.jsx(ve,{onClick:G,className:W?"cursor-pointer":"pointer-events-none opacity-50"})})]})})]})};export{is as default};
//# sourceMappingURL=AdminRestaurants-D1bgDtzy.js.map
