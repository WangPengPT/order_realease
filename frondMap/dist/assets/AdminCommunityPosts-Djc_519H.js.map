{"version":3,"file":"AdminCommunityPosts-Djc_519H.js","sources":["../../src/pages/admin/AdminCommunityPosts.tsx"],"sourcesContent":["import { useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { formatDistanceToNow } from \"date-fns\";\r\nimport { zhCN, enUS, pt } from \"date-fns/locale\";\r\nimport { toast } from \"sonner\";\r\nimport {\r\n  Search,\r\n  Eye,\r\n  Trash2,\r\n  EyeOff,\r\n  Check,\r\n  AlertTriangle,\r\n  Image,\r\n  Video,\r\n  Heart,\r\n  MessageCircle,\r\n  Share2,\r\n  Clock,\r\n  Filter,\r\n  LayoutGrid,\r\n  List,\r\n  CheckCircle2,\r\n  XCircle,\r\n  AlertCircle,\r\n  Link2,\r\n  FileText,\r\n  Ban,\r\n  ImagePlus,\r\n  Loader2,\r\n} from \"lucide-react\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\r\nimport { Card, CardContent } from \"@/components/ui/card\";\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport {\r\n  Tooltip,\r\n  TooltipContent,\r\n  TooltipProvider,\r\n  TooltipTrigger,\r\n} from \"@/components/ui/tooltip\";\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n} from \"@/components/ui/alert-dialog\";\r\nimport { Skeleton } from \"@/components/ui/skeleton\";\r\nimport {\r\n  useAdminCommunityPosts,\r\n  useUpdatePost,\r\n  useDeletePost,\r\n  CommunityPost,\r\n} from \"@/hooks/useCommunityPosts\";\r\nimport { useLocalizedContent } from \"@/hooks/useLocalizedContent\";\r\nimport PostManagementDialog from \"@/components/admin/PostManagementDialog\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nconst AdminCommunityPosts = () => {\r\n  const { t, i18n } = useTranslation();\r\n  const { getLocalizedField } = useLocalizedContent();\r\n  const [search, setSearch] = useState(\"\");\r\n  const [statusFilter, setStatusFilter] = useState<string>(\"all\");\r\n  const [moderationFilter, setModerationFilter] = useState<string>(\"all\");\r\n  const [selectedPost, setSelectedPost] = useState<CommunityPost | null>(null);\r\n  const [deletePost, setDeletePost] = useState<CommunityPost | null>(null);\r\n  const [viewMode, setViewMode] = useState<\"grid\" | \"list\">(\"grid\");\r\n  const [generatingCoverId, setGeneratingCoverId] = useState<string | null>(null);\r\n\r\n  const { data: posts, isLoading } = useAdminCommunityPosts({\r\n    status: statusFilter !== \"all\" ? statusFilter : undefined,\r\n    moderation_status: moderationFilter !== \"all\" ? moderationFilter : undefined,\r\n    search: search || undefined,\r\n  });\r\n\r\n  const updatePost = useUpdatePost();\r\n  const deletePostMutation = useDeletePost();\r\n\r\n  const getDateLocale = () => {\r\n    switch (i18n.language) {\r\n      case \"zh\":\r\n        return zhCN;\r\n      case \"pt\":\r\n        return pt;\r\n      default:\r\n        return enUS;\r\n    }\r\n  };\r\n\r\n  const getStatusConfig = (status: string) => {\r\n    switch (status) {\r\n      case \"approved\":\r\n        return {\r\n          label: t(\"admin.status.approved\", \"已发布\"),\r\n          icon: CheckCircle2,\r\n          className: \"bg-emerald-500/10 text-emerald-600 border-emerald-500/20\",\r\n        };\r\n      case \"pending\":\r\n        return {\r\n          label: t(\"admin.status.pending\", \"待审核\"),\r\n          icon: Clock,\r\n          className: \"bg-amber-500/10 text-amber-600 border-amber-500/20\",\r\n        };\r\n      case \"rejected\":\r\n        return {\r\n          label: t(\"admin.status.rejected\", \"已拒绝\"),\r\n          icon: XCircle,\r\n          className: \"bg-red-500/10 text-red-600 border-red-500/20\",\r\n        };\r\n      case \"hidden\":\r\n        return {\r\n          label: t(\"admin.status.hidden\", \"已隐藏\"),\r\n          icon: EyeOff,\r\n          className: \"bg-gray-500/10 text-gray-600 border-gray-500/20\",\r\n        };\r\n      default:\r\n        return {\r\n          label: status,\r\n          icon: AlertCircle,\r\n          className: \"bg-gray-500/10 text-gray-600 border-gray-500/20\",\r\n        };\r\n    }\r\n  };\r\n\r\n  const getModerationConfig = (status: string) => {\r\n    switch (status) {\r\n      case \"approved\":\r\n        return {\r\n          label: t(\"admin.moderation.approved\", \"通过\"),\r\n          icon: Check,\r\n          className: \"text-emerald-600\",\r\n        };\r\n      case \"flagged\":\r\n        return {\r\n          label: t(\"admin.moderation.flagged\", \"标记\"),\r\n          icon: AlertTriangle,\r\n          className: \"text-orange-500\",\r\n        };\r\n      case \"pending\":\r\n        return {\r\n          label: t(\"admin.moderation.pending\", \"待审\"),\r\n          icon: Clock,\r\n          className: \"text-muted-foreground\",\r\n        };\r\n      default:\r\n        return {\r\n          label: status,\r\n          icon: AlertCircle,\r\n          className: \"text-muted-foreground\",\r\n        };\r\n    }\r\n  };\r\n\r\n  const handleQuickAction = (post: CommunityPost, action: string) => {\r\n    switch (action) {\r\n      case \"approve\":\r\n        updatePost.mutate({ id: post.id, status: \"approved\" });\r\n        break;\r\n      case \"hide\":\r\n        updatePost.mutate({ id: post.id, status: \"hidden\" });\r\n        break;\r\n      case \"unhide\":\r\n        updatePost.mutate({ id: post.id, status: \"approved\" });\r\n        break;\r\n      case \"delete\":\r\n        setDeletePost(post);\r\n        break;\r\n    }\r\n  };\r\n\r\n  const confirmDelete = () => {\r\n    if (deletePost) {\r\n      deletePostMutation.mutate(deletePost.id);\r\n      setDeletePost(null);\r\n    }\r\n  };\r\n\r\n  const stripHtml = (html: string) => {\r\n    const tmp = document.createElement(\"div\");\r\n    tmp.innerHTML = html;\r\n    return tmp.textContent || tmp.innerText || \"\";\r\n  };\r\n\r\n  // Extract first frame from video URL\r\n  const extractVideoFirstFrame = (videoUrl: string): Promise<Blob> => {\r\n    return new Promise((resolve, reject) => {\r\n      const video = document.createElement(\"video\");\r\n      const canvas = document.createElement(\"canvas\");\r\n      const ctx = canvas.getContext(\"2d\");\r\n\r\n      video.preload = \"auto\";\r\n      video.muted = true;\r\n      video.playsInline = true;\r\n      video.crossOrigin = \"anonymous\";\r\n\r\n      let hasResolved = false;\r\n\r\n      const captureFrame = () => {\r\n        if (hasResolved) return;\r\n        if (video.videoWidth === 0 || video.videoHeight === 0) return;\r\n\r\n        canvas.width = video.videoWidth;\r\n        canvas.height = video.videoHeight;\r\n\r\n        if (ctx) {\r\n          ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\r\n          canvas.toBlob(\r\n            (blob) => {\r\n              if (blob && blob.size > 0) {\r\n                hasResolved = true;\r\n                video.pause();\r\n                resolve(blob);\r\n              } else {\r\n                reject(new Error(\"Failed to create blob\"));\r\n              }\r\n            },\r\n            \"image/jpeg\",\r\n            0.85\r\n          );\r\n        }\r\n      };\r\n\r\n      video.onloadedmetadata = () => {\r\n        canvas.width = video.videoWidth;\r\n        canvas.height = video.videoHeight;\r\n        video.currentTime = 0.1;\r\n      };\r\n\r\n      video.onseeked = () => {\r\n        setTimeout(captureFrame, 100);\r\n      };\r\n\r\n      video.onerror = () => {\r\n        reject(new Error(\"Failed to load video\"));\r\n      };\r\n\r\n      setTimeout(() => {\r\n        if (!hasResolved) {\r\n          reject(new Error(\"Timeout\"));\r\n        }\r\n      }, 15000);\r\n\r\n      video.src = videoUrl;\r\n      video.load();\r\n    });\r\n  };\r\n\r\n  // Generate cover for video post\r\n  const handleGenerateCover = async (post: CommunityPost) => {\r\n    if (!post.video_url) return;\r\n    \r\n    setGeneratingCoverId(post.id);\r\n    try {\r\n      toast.info(t(\"admin.communityPosts.extractingCover\", \"正在提取视频封面...\"));\r\n      \r\n      // Extract first frame\r\n      const coverBlob = await extractVideoFirstFrame(post.video_url);\r\n      \r\n      // Upload to storage\r\n      const { data: { user } } = await supabase.auth.getUser();\r\n      if (!user) throw new Error(\"Not authenticated\");\r\n      \r\n      const coverFileName = `covers/${post.id}-cover-${Date.now()}.jpg`;\r\n      const { error: uploadError } = await supabase.storage\r\n        .from(\"community-posts\")\r\n        .upload(coverFileName, coverBlob);\r\n      \r\n      if (uploadError) throw uploadError;\r\n      \r\n      const { data: { publicUrl } } = supabase.storage\r\n        .from(\"community-posts\")\r\n        .getPublicUrl(coverFileName);\r\n      \r\n      // Update post with new cover\r\n      const newImageUrls = [publicUrl, ...(post.image_urls || [])];\r\n      await supabase\r\n        .from(\"community_posts\")\r\n        .update({ image_urls: newImageUrls })\r\n        .eq(\"id\", post.id);\r\n      \r\n      // Refresh the list\r\n      updatePost.mutate({ id: post.id, image_urls: newImageUrls } as any);\r\n      \r\n      toast.success(t(\"admin.communityPosts.coverGenerated\", \"封面已生成\"));\r\n    } catch (error) {\r\n      console.error(\"Failed to generate cover:\", error);\r\n      toast.error(t(\"admin.communityPosts.coverFailed\", \"封面生成失败，请重试\"));\r\n    } finally {\r\n      setGeneratingCoverId(null);\r\n    }\r\n  };\r\n\r\n  // Check if post needs cover (has video but no images)\r\n  const needsCover = (post: CommunityPost) => {\r\n    return post.video_url && (!post.image_urls || post.image_urls.length === 0);\r\n  };\r\n\r\n  const PostCard = ({ post }: { post: CommunityPost }) => {\r\n    const statusConfig = getStatusConfig(post.status);\r\n    const moderationConfig = getModerationConfig(post.moderation_status);\r\n    const StatusIcon = statusConfig.icon;\r\n    const ModerationIcon = moderationConfig.icon;\r\n\r\n    return (\r\n      <Card className=\"group overflow-hidden hover:shadow-md transition-all duration-200 border-border/60\">\r\n        <CardContent className=\"p-0\">\r\n          {/* Header */}\r\n          <div className=\"flex items-center justify-between p-4 border-b border-border/40\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <Avatar className=\"h-10 w-10 ring-2 ring-background shadow-sm\">\r\n                <AvatarImage src={post.author?.avatar_url || undefined} />\r\n                <AvatarFallback className=\"bg-primary/10 text-primary font-medium\">\r\n                  {post.author?.display_name?.charAt(0) || \"?\"}\r\n                </AvatarFallback>\r\n              </Avatar>\r\n              <div>\r\n                <p className=\"font-medium text-sm\">{post.author?.display_name}</p>\r\n                <p className=\"text-xs text-muted-foreground flex items-center gap-1\">\r\n                  <Clock className=\"h-3 w-3\" />\r\n                  {formatDistanceToNow(new Date(post.created_at), {\r\n                    addSuffix: true,\r\n                    locale: getDateLocale(),\r\n                  })}\r\n                </p>\r\n              </div>\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <TooltipProvider>\r\n                <Tooltip>\r\n                  <TooltipTrigger asChild>\r\n                    <div className={cn(\"p-1.5 rounded-full\", moderationConfig.className)}>\r\n                      <ModerationIcon className=\"h-3.5 w-3.5\" />\r\n                    </div>\r\n                  </TooltipTrigger>\r\n                  <TooltipContent side=\"left\">\r\n                    <p>{moderationConfig.label}</p>\r\n                  </TooltipContent>\r\n                </Tooltip>\r\n              </TooltipProvider>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Content */}\r\n          <div className=\"p-4 space-y-3\">\r\n            <p className=\"text-sm line-clamp-3 text-foreground/90\">\r\n              {stripHtml(post.content)}\r\n            </p>\r\n\r\n            {/* Media Preview */}\r\n            {(post.image_urls?.length > 0 || post.video_url) && (\r\n              <div className=\"flex items-center gap-3\">\r\n                {post.image_urls && post.image_urls.length > 0 && (\r\n                  <div className=\"flex -space-x-2\">\r\n                    {post.image_urls.slice(0, 3).map((url, index) => (\r\n                      <div\r\n                        key={index}\r\n                        className=\"h-12 w-12 rounded-lg overflow-hidden border-2 border-background shadow-sm\"\r\n                      >\r\n                        <img src={url} alt=\"\" className=\"w-full h-full object-cover\" />\r\n                      </div>\r\n                    ))}\r\n                    {post.image_urls.length > 3 && (\r\n                      <div className=\"h-12 w-12 rounded-lg bg-muted/80 border-2 border-background flex items-center justify-center shadow-sm\">\r\n                        <span className=\"text-xs font-medium text-muted-foreground\">\r\n                          +{post.image_urls.length - 3}\r\n                        </span>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                )}\r\n                {post.video_url && (\r\n                  <div className=\"flex items-center gap-1.5\">\r\n                    <div className=\"flex items-center gap-1.5 text-xs text-muted-foreground bg-muted/50 px-2 py-1 rounded-full\">\r\n                      <Video className=\"h-3.5 w-3.5\" />\r\n                      <span>{t(\"admin.communityPosts.hasVideo\", \"视频\")}</span>\r\n                    </div>\r\n                    {needsCover(post) && (\r\n                      <Button\r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                        className=\"h-6 text-xs gap-1 text-orange-600 border-orange-300 hover:bg-orange-50\"\r\n                        onClick={() => handleGenerateCover(post)}\r\n                        disabled={generatingCoverId === post.id}\r\n                      >\r\n                        {generatingCoverId === post.id ? (\r\n                          <Loader2 className=\"h-3 w-3 animate-spin\" />\r\n                        ) : (\r\n                          <ImagePlus className=\"h-3 w-3\" />\r\n                        )}\r\n                        {t(\"admin.communityPosts.generateCover\", \"生成封面\")}\r\n                      </Button>\r\n                    )}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            )}\r\n\r\n            {/* Activity Link */}\r\n            {post.activity && (\r\n              <div className=\"flex items-center gap-1.5\">\r\n                <Link2 className=\"h-3.5 w-3.5 text-primary\" />\r\n                <Badge variant=\"secondary\" className=\"text-xs font-normal\">\r\n                  {getLocalizedField(post.activity, \"title\")}\r\n                </Badge>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Stats & Status */}\r\n          <div className=\"px-4 py-3 bg-muted/30 border-t border-border/40\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div className=\"flex items-center gap-4 text-muted-foreground\">\r\n                <span className=\"flex items-center gap-1 text-xs\">\r\n                  <Eye className=\"h-3.5 w-3.5\" />\r\n                  {post.views_count || 0}\r\n                </span>\r\n                <span className=\"flex items-center gap-1 text-xs\">\r\n                  <Heart className=\"h-3.5 w-3.5\" />\r\n                  {post.likes_count}\r\n                </span>\r\n                <span className=\"flex items-center gap-1 text-xs\">\r\n                  <MessageCircle className=\"h-3.5 w-3.5\" />\r\n                  {post.comments_count}\r\n                </span>\r\n                <span className=\"flex items-center gap-1 text-xs\">\r\n                  <Share2 className=\"h-3.5 w-3.5\" />\r\n                  {post.shares_count}\r\n                </span>\r\n              </div>\r\n              <Badge \r\n                variant=\"outline\" \r\n                className={cn(\"text-xs border\", statusConfig.className)}\r\n              >\r\n                <StatusIcon className=\"h-3 w-3 mr-1\" />\r\n                {statusConfig.label}\r\n              </Badge>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Quick Actions */}\r\n          <div className=\"flex items-center gap-1 p-2 border-t border-border/40 bg-background\">\r\n            <TooltipProvider>\r\n              <Tooltip>\r\n                <TooltipTrigger asChild>\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"sm\"\r\n                    className=\"flex-1 h-8 text-blue-600 hover:text-blue-700 hover:bg-blue-50\"\r\n                    onClick={() => setSelectedPost(post)}\r\n                  >\r\n                    <FileText className=\"h-4 w-4\" />\r\n                    <span className=\"ml-1.5 text-xs hidden sm:inline\">{t(\"common.details\", \"详情\")}</span>\r\n                  </Button>\r\n                </TooltipTrigger>\r\n                <TooltipContent>\r\n                  <p>{t(\"common.viewDetails\", \"查看详情\")}</p>\r\n                </TooltipContent>\r\n              </Tooltip>\r\n            </TooltipProvider>\r\n\r\n            {/* 只有 pending/flagged 状态显示发布按钮，hidden 状态用下面的显示/隐藏按钮 */}\r\n            {post.status === \"pending\" || post.status === \"flagged\" ? (\r\n              <TooltipProvider>\r\n                <Tooltip>\r\n                  <TooltipTrigger asChild>\r\n                    <Button\r\n                      variant=\"ghost\"\r\n                      size=\"sm\"\r\n                      className=\"flex-1 h-8 text-emerald-600 hover:text-emerald-700 hover:bg-emerald-50\"\r\n                      onClick={() => handleQuickAction(post, \"approve\")}\r\n                    >\r\n                      <CheckCircle2 className=\"h-4 w-4\" />\r\n                      <span className=\"ml-1.5 text-xs hidden sm:inline\">{t(\"admin.action.approve\", \"发布\")}</span>\r\n                    </Button>\r\n                  </TooltipTrigger>\r\n                  <TooltipContent>\r\n                    <p>{t(\"admin.action.approve\", \"发布\")}</p>\r\n                  </TooltipContent>\r\n                </Tooltip>\r\n              </TooltipProvider>\r\n            ) : null}\r\n\r\n            <TooltipProvider>\r\n              <Tooltip>\r\n                <TooltipTrigger asChild>\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"sm\"\r\n                    className={cn(\r\n                      \"flex-1 h-8\",\r\n                      post.status === \"hidden\"\r\n                        ? \"text-emerald-600 hover:text-emerald-700 hover:bg-emerald-50\"\r\n                        : \"text-amber-600 hover:text-amber-700 hover:bg-amber-50\"\r\n                    )}\r\n                    onClick={() => handleQuickAction(post, post.status === \"hidden\" ? \"unhide\" : \"hide\")}\r\n                  >\r\n                    {post.status === \"hidden\" ? (\r\n                      <>\r\n                        <Eye className=\"h-4 w-4\" />\r\n                        <span className=\"ml-1.5 text-xs hidden sm:inline\">{t(\"admin.action.unhide\", \"显示\")}</span>\r\n                      </>\r\n                    ) : (\r\n                      <>\r\n                        <Ban className=\"h-4 w-4\" />\r\n                        <span className=\"ml-1.5 text-xs hidden sm:inline\">{t(\"admin.action.hide\", \"隐藏\")}</span>\r\n                      </>\r\n                    )}\r\n                  </Button>\r\n                </TooltipTrigger>\r\n                <TooltipContent>\r\n                  <p>{post.status === \"hidden\" ? t(\"admin.action.unhide\", \"显示\") : t(\"admin.action.hide\", \"隐藏\")}</p>\r\n                </TooltipContent>\r\n              </Tooltip>\r\n            </TooltipProvider>\r\n\r\n            <TooltipProvider>\r\n              <Tooltip>\r\n                <TooltipTrigger asChild>\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"sm\"\r\n                    className=\"flex-1 h-8 text-destructive hover:text-destructive hover:bg-destructive/10\"\r\n                    onClick={() => handleQuickAction(post, \"delete\")}\r\n                  >\r\n                    <Trash2 className=\"h-4 w-4\" />\r\n                  </Button>\r\n                </TooltipTrigger>\r\n                <TooltipContent>\r\n                  <p>{t(\"common.delete\", \"删除\")}</p>\r\n                </TooltipContent>\r\n              </Tooltip>\r\n            </TooltipProvider>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  };\r\n\r\n  const PostSkeleton = () => (\r\n    <Card className=\"overflow-hidden\">\r\n      <CardContent className=\"p-0\">\r\n        <div className=\"flex items-center gap-3 p-4 border-b\">\r\n          <Skeleton className=\"h-10 w-10 rounded-full\" />\r\n          <div className=\"space-y-2\">\r\n            <Skeleton className=\"h-4 w-24\" />\r\n            <Skeleton className=\"h-3 w-16\" />\r\n          </div>\r\n        </div>\r\n        <div className=\"p-4 space-y-3\">\r\n          <Skeleton className=\"h-4 w-full\" />\r\n          <Skeleton className=\"h-4 w-3/4\" />\r\n          <div className=\"flex gap-2\">\r\n            <Skeleton className=\"h-12 w-12 rounded-lg\" />\r\n            <Skeleton className=\"h-12 w-12 rounded-lg\" />\r\n          </div>\r\n        </div>\r\n        <div className=\"px-4 py-3 bg-muted/30 border-t\">\r\n          <div className=\"flex justify-between\">\r\n            <Skeleton className=\"h-4 w-24\" />\r\n            <Skeleton className=\"h-5 w-16 rounded-full\" />\r\n          </div>\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold\">\r\n            {t(\"admin.communityPosts.title\", \"帖子管理\")}\r\n          </h1>\r\n          <p className=\"text-muted-foreground text-sm mt-1\">\r\n            {t(\"admin.communityPosts.subtitle\", \"管理和审核社区帖子\")}\r\n          </p>\r\n        </div>\r\n        <div className=\"flex items-center gap-2\">\r\n          <Button\r\n            variant={viewMode === \"grid\" ? \"secondary\" : \"ghost\"}\r\n            size=\"icon\"\r\n            className=\"h-9 w-9\"\r\n            onClick={() => setViewMode(\"grid\")}\r\n          >\r\n            <LayoutGrid className=\"h-4 w-4\" />\r\n          </Button>\r\n          <Button\r\n            variant={viewMode === \"list\" ? \"secondary\" : \"ghost\"}\r\n            size=\"icon\"\r\n            className=\"h-9 w-9\"\r\n            onClick={() => setViewMode(\"list\")}\r\n          >\r\n            <List className=\"h-4 w-4\" />\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Filters */}\r\n      <Card className=\"border-border/60\">\r\n        <CardContent className=\"p-4\">\r\n          <div className=\"flex flex-col sm:flex-row gap-4\">\r\n            <div className=\"relative flex-1\">\r\n              <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\r\n              <Input\r\n                placeholder={t(\"admin.communityPosts.searchPlaceholder\", \"搜索内容...\")}\r\n                value={search}\r\n                onChange={(e) => setSearch(e.target.value)}\r\n                className=\"pl-10\"\r\n              />\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <Filter className=\"h-4 w-4 text-muted-foreground hidden sm:block\" />\r\n              <Select value={statusFilter} onValueChange={setStatusFilter}>\r\n                <SelectTrigger className=\"w-[140px]\">\r\n                  <SelectValue placeholder={t(\"admin.status.all\", \"所有状态\")} />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"all\">{t(\"admin.status.all\", \"所有状态\")}</SelectItem>\r\n                  <SelectItem value=\"approved\">\r\n                    <span className=\"flex items-center gap-2\">\r\n                      <CheckCircle2 className=\"h-3.5 w-3.5 text-emerald-600\" />\r\n                      {t(\"admin.status.approved\", \"已发布\")}\r\n                    </span>\r\n                  </SelectItem>\r\n                  <SelectItem value=\"pending\">\r\n                    <span className=\"flex items-center gap-2\">\r\n                      <Clock className=\"h-3.5 w-3.5 text-amber-600\" />\r\n                      {t(\"admin.status.pending\", \"待审核\")}\r\n                    </span>\r\n                  </SelectItem>\r\n                  <SelectItem value=\"hidden\">\r\n                    <span className=\"flex items-center gap-2\">\r\n                      <EyeOff className=\"h-3.5 w-3.5 text-gray-500\" />\r\n                      {t(\"admin.status.hidden\", \"已隐藏\")}\r\n                    </span>\r\n                  </SelectItem>\r\n                  <SelectItem value=\"rejected\">\r\n                    <span className=\"flex items-center gap-2\">\r\n                      <XCircle className=\"h-3.5 w-3.5 text-red-600\" />\r\n                      {t(\"admin.status.rejected\", \"已拒绝\")}\r\n                    </span>\r\n                  </SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n\r\n              <Select value={moderationFilter} onValueChange={setModerationFilter}>\r\n                <SelectTrigger className=\"w-[130px]\">\r\n                  <SelectValue placeholder={t(\"admin.moderation.all\", \"所有审核\")} />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"all\">{t(\"admin.moderation.all\", \"所有审核\")}</SelectItem>\r\n                  <SelectItem value=\"pending\">\r\n                    <span className=\"flex items-center gap-2\">\r\n                      <Clock className=\"h-3.5 w-3.5 text-gray-500\" />\r\n                      {t(\"admin.moderation.pending\", \"待审\")}\r\n                    </span>\r\n                  </SelectItem>\r\n                  <SelectItem value=\"approved\">\r\n                    <span className=\"flex items-center gap-2\">\r\n                      <Check className=\"h-3.5 w-3.5 text-emerald-600\" />\r\n                      {t(\"admin.moderation.approved\", \"通过\")}\r\n                    </span>\r\n                  </SelectItem>\r\n                  <SelectItem value=\"flagged\">\r\n                    <span className=\"flex items-center gap-2\">\r\n                      <AlertTriangle className=\"h-3.5 w-3.5 text-orange-500\" />\r\n                      {t(\"admin.moderation.flagged\", \"标记\")}\r\n                    </span>\r\n                  </SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Posts Count */}\r\n      {posts && (\r\n        <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n          <span>{t(\"admin.communityPosts.total\", \"共\")} {posts.length} {t(\"admin.communityPosts.posts\", \"篇帖子\")}</span>\r\n        </div>\r\n      )}\r\n\r\n      {/* Posts Grid/List */}\r\n      {isLoading ? (\r\n        <div className={cn(\r\n          \"grid gap-4\",\r\n          viewMode === \"grid\" \r\n            ? \"grid-cols-1 md:grid-cols-2 lg:grid-cols-3\" \r\n            : \"grid-cols-1\"\r\n        )}>\r\n          {Array.from({ length: 6 }).map((_, i) => (\r\n            <PostSkeleton key={i} />\r\n          ))}\r\n        </div>\r\n      ) : posts && posts.length > 0 ? (\r\n        <div className={cn(\r\n          \"grid gap-4\",\r\n          viewMode === \"grid\" \r\n            ? \"grid-cols-1 md:grid-cols-2 lg:grid-cols-3\" \r\n            : \"grid-cols-1\"\r\n        )}>\r\n          {posts.map((post) => (\r\n            <PostCard key={post.id} post={post} />\r\n          ))}\r\n        </div>\r\n      ) : (\r\n        <Card className=\"border-dashed\">\r\n          <CardContent className=\"py-16 text-center\">\r\n            <div className=\"mx-auto w-16 h-16 rounded-full bg-muted flex items-center justify-center mb-4\">\r\n              <Image className=\"h-8 w-8 text-muted-foreground\" />\r\n            </div>\r\n            <h3 className=\"font-medium text-lg mb-1\">\r\n              {t(\"admin.communityPosts.noPosts\", \"暂无帖子\")}\r\n            </h3>\r\n            <p className=\"text-muted-foreground text-sm\">\r\n              {t(\"admin.communityPosts.noPostsDesc\", \"当前筛选条件下没有帖子\")}\r\n            </p>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {/* Post Management Dialog */}\r\n      <PostManagementDialog\r\n        post={selectedPost}\r\n        open={!!selectedPost}\r\n        onOpenChange={(open) => !open && setSelectedPost(null)}\r\n      />\r\n\r\n      {/* Delete Confirmation */}\r\n      <AlertDialog open={!!deletePost} onOpenChange={(open) => !open && setDeletePost(null)}>\r\n        <AlertDialogContent>\r\n          <AlertDialogHeader>\r\n            <AlertDialogTitle className=\"flex items-center gap-2\">\r\n              <Trash2 className=\"h-5 w-5 text-destructive\" />\r\n              {t(\"common.confirmDelete\", \"确认删除\")}\r\n            </AlertDialogTitle>\r\n            <AlertDialogDescription>\r\n              {t(\"admin.communityPosts.deleteWarning\", \"删除后无法恢复，确定要删除这篇帖子吗？\")}\r\n            </AlertDialogDescription>\r\n          </AlertDialogHeader>\r\n          <AlertDialogFooter>\r\n            <AlertDialogCancel>{t(\"common.cancel\", \"取消\")}</AlertDialogCancel>\r\n            <AlertDialogAction \r\n              onClick={confirmDelete}\r\n              className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\r\n            >\r\n              {t(\"common.delete\", \"删除\")}\r\n            </AlertDialogAction>\r\n          </AlertDialogFooter>\r\n        </AlertDialogContent>\r\n      </AlertDialog>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdminCommunityPosts;\r\n"],"names":["AdminCommunityPosts","t","i18n","useTranslation","getLocalizedField","useLocalizedContent","search","setSearch","useState","statusFilter","setStatusFilter","moderationFilter","setModerationFilter","selectedPost","setSelectedPost","deletePost","setDeletePost","viewMode","setViewMode","generatingCoverId","setGeneratingCoverId","posts","isLoading","useAdminCommunityPosts","updatePost","useUpdatePost","deletePostMutation","useDeletePost","getDateLocale","zhCN","pt","enUS","getStatusConfig","status","CheckCircle2","Clock","XCircle","EyeOff","AlertCircle","getModerationConfig","Check","AlertTriangle","handleQuickAction","post","action","confirmDelete","stripHtml","html","tmp","extractVideoFirstFrame","videoUrl","resolve","reject","video","canvas","ctx","hasResolved","captureFrame","blob","handleGenerateCover","toast","coverBlob","user","supabase","coverFileName","uploadError","publicUrl","newImageUrls","error","needsCover","PostCard","statusConfig","moderationConfig","StatusIcon","ModerationIcon","Card","jsxs","CardContent","Avatar","jsx","AvatarImage","AvatarFallback","formatDistanceToNow","TooltipProvider","Tooltip","TooltipTrigger","cn","TooltipContent","url","index","Video","Button","Loader2","ImagePlus","Link2","Badge","Eye","Heart","MessageCircle","Share2","FileText","Fragment","Ban","Trash2","PostSkeleton","Skeleton","LayoutGrid","List","Search","Input","e","Filter","Select","SelectTrigger","SelectValue","SelectContent","SelectItem","_","i","Image","PostManagementDialog","open","AlertDialog","AlertDialogContent","AlertDialogHeader","AlertDialogTitle","AlertDialogDescription","AlertDialogFooter","AlertDialogCancel","AlertDialogAction"],"mappings":"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"}