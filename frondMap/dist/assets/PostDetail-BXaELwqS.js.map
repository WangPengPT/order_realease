{"version":3,"file":"PostDetail-BXaELwqS.js","sources":["../../src/components/community/PostCard.tsx","../../src/pages/PostDetail.tsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport { createPortal } from \"react-dom\";\r\nimport { Link, useNavigate } from \"react-router-dom\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { formatDistanceToNow } from \"date-fns\";\r\nimport { zhCN, enUS, pt } from \"date-fns/locale\";\r\nimport { Heart, MessageCircle, Share2, MoreHorizontal, Calendar, X, ChevronLeft, ChevronRight } from \"lucide-react\";\r\nimport {\r\n  Carousel,\r\n  CarouselContent,\r\n  CarouselItem,\r\n  type CarouselApi,\r\n} from \"@/components/ui/carousel\";\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Card, CardContent, CardFooter, CardHeader } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuTrigger,\r\n} from \"@/components/ui/dropdown-menu\";\r\nimport { CommunityPost, useLikePost, useSharePost, useDeletePost } from \"@/hooks/useCommunityPosts\";\r\nimport { useAuth } from \"@/contexts/AuthContext\";\r\nimport { useLocalizedContent } from \"@/hooks/useLocalizedContent\";\r\nimport { toast } from \"sonner\";\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n} from \"@/components/ui/alert-dialog\";\r\nimport TranslateButton from \"@/components/TranslateButton\";\r\n\r\ninterface PostCardProps {\r\n  post: CommunityPost;\r\n  showActions?: boolean;\r\n  isDetailPage?: boolean;\r\n}\r\n\r\nconst PostCard = ({ post, showActions = true, isDetailPage = false }: PostCardProps) => {\r\n  const { t, i18n } = useTranslation();\r\n  const { user } = useAuth();\r\n  const navigate = useNavigate();\r\n  const { getLocalizedField } = useLocalizedContent();\r\n  const likePost = useLikePost();\r\n  const sharePost = useSharePost();\r\n  const deletePost = useDeletePost();\r\n  const [showDeleteDialog, setShowDeleteDialog] = useState(false);\r\n  const [imageError, setImageError] = useState<Record<string, boolean>>({});\r\n  const [previewOpen, setPreviewOpen] = useState(false);\r\n  const [previewIndex, setPreviewIndex] = useState(0);\r\n  const [carouselApi, setCarouselApi] = useState<CarouselApi>();\r\n  const [previewCarouselApi, setPreviewCarouselApi] = useState<CarouselApi>();\r\n  const [currentSlide, setCurrentSlide] = useState(0);\r\n  const [translatedContent, setTranslatedContent] = useState<string | null>(null);\r\n  const [touchStartX, setTouchStartX] = useState<number | null>(null);\r\n  const [isSwiping, setIsSwiping] = useState(false);\r\n  const [swipeOffset, setSwipeOffset] = useState(0);\r\n  const [isAnimating, setIsAnimating] = useState(false);\r\n\r\n  // Listen to carousel slide changes\r\n  useEffect(() => {\r\n    if (!carouselApi) return;\r\n    \r\n    setCurrentSlide(carouselApi.selectedScrollSnap());\r\n    \r\n    carouselApi.on(\"select\", () => {\r\n      setCurrentSlide(carouselApi.selectedScrollSnap());\r\n    });\r\n  }, [carouselApi]);\r\n\r\n  const getDateLocale = () => {\r\n    switch (i18n.language) {\r\n      case \"zh\":\r\n        return zhCN;\r\n      case \"pt\":\r\n        return pt;\r\n      default:\r\n        return enUS;\r\n    }\r\n  };\r\n\r\n  const handleLike = () => {\r\n    if (!user) return;\r\n    likePost.mutate({ postId: post.id, liked: post.user_liked || false });\r\n  };\r\n\r\n  const handleShare = async () => {\r\n    const shareUrl = `${window.location.origin}/community/${post.id}`;\r\n    \r\n    if (navigator.share) {\r\n      try {\r\n        await navigator.share({\r\n          title: t(\"community.shareTitle\", \"分享帖子\"),\r\n          url: shareUrl,\r\n        });\r\n        if (user) {\r\n          sharePost.mutate(post.id);\r\n        }\r\n        toast.success(t(\"community.shareSuccess\", \"分享成功\"));\r\n      } catch (error: any) {\r\n        // User cancelled or share failed - fallback to copy\r\n        if (error?.name !== \"AbortError\") {\r\n          await navigator.clipboard.writeText(shareUrl);\r\n          toast.success(t(\"community.linkCopied\", \"链接已复制到剪贴板\"));\r\n          if (user) {\r\n            sharePost.mutate(post.id);\r\n          }\r\n        }\r\n      }\r\n    } else {\r\n      // Fallback: copy to clipboard\r\n      try {\r\n        await navigator.clipboard.writeText(shareUrl);\r\n        toast.success(t(\"community.linkCopied\", \"链接已复制到剪贴板\"));\r\n        if (user) {\r\n          sharePost.mutate(post.id);\r\n        }\r\n      } catch (error) {\r\n        toast.error(t(\"community.shareFailed\", \"分享失败\"));\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleDelete = () => {\r\n    deletePost.mutate(post.id);\r\n    setShowDeleteDialog(false);\r\n  };\r\n\r\n  const handleImageClick = (index: number) => {\r\n    if (isDetailPage) {\r\n      // On detail page, open preview\r\n      setPreviewIndex(index);\r\n      setPreviewOpen(true);\r\n    } else {\r\n      // On feed, navigate to post detail\r\n      navigate(`/community/${post.id}`);\r\n    }\r\n  };\r\n\r\n  const handlePrevImage = () => {\r\n    if (isAnimating) return;\r\n    setIsAnimating(true);\r\n    setSwipeOffset(window.innerWidth);\r\n    setTimeout(() => {\r\n      setPreviewIndex((prev) => \r\n        prev === 0 ? (post.image_urls?.length || 1) - 1 : prev - 1\r\n      );\r\n      setSwipeOffset(0);\r\n      setIsAnimating(false);\r\n    }, 250);\r\n  };\r\n\r\n  const handleNextImage = () => {\r\n    if (isAnimating) return;\r\n    setIsAnimating(true);\r\n    setSwipeOffset(-window.innerWidth);\r\n    setTimeout(() => {\r\n      setPreviewIndex((prev) => \r\n        prev === (post.image_urls?.length || 1) - 1 ? 0 : prev + 1\r\n      );\r\n      setSwipeOffset(0);\r\n      setIsAnimating(false);\r\n    }, 250);\r\n  };\r\n\r\n  const isAuthor = user?.id === post.author_id;\r\n  const activityTitle = post.activity\r\n    ? getLocalizedField(post.activity, \"title\")\r\n    : null;\r\n\r\n  return (\r\n    <>\r\n      <Card className=\"overflow-hidden\">\r\n        <CardHeader className=\"pb-3\">\r\n          <div className=\"flex items-start justify-between\">\r\n            <div className=\"flex items-center gap-3\">\r\n              <Avatar className=\"h-10 w-10\">\r\n                <AvatarImage src={post.author?.avatar_url || undefined} />\r\n                <AvatarFallback>\r\n                  {post.author?.display_name?.charAt(0) || \"?\"}\r\n                </AvatarFallback>\r\n              </Avatar>\r\n              <div>\r\n                <p className=\"font-medium text-sm\">{post.author?.display_name}</p>\r\n                <p className=\"text-xs text-muted-foreground\">\r\n                  {formatDistanceToNow(new Date(post.created_at), {\r\n                    addSuffix: true,\r\n                    locale: getDateLocale(),\r\n                  })}\r\n                </p>\r\n              </div>\r\n            </div>\r\n\r\n            {showActions && isAuthor && (\r\n              <DropdownMenu>\r\n                <DropdownMenuTrigger asChild>\r\n                  <Button variant=\"ghost\" size=\"icon\" className=\"h-8 w-8\">\r\n                    <MoreHorizontal className=\"h-4 w-4\" />\r\n                  </Button>\r\n                </DropdownMenuTrigger>\r\n                <DropdownMenuContent align=\"end\">\r\n                  <DropdownMenuItem\r\n                    onClick={() => setShowDeleteDialog(true)}\r\n                    className=\"text-destructive\"\r\n                  >\r\n                    {t(\"common.delete\", \"删除\")}\r\n                  </DropdownMenuItem>\r\n                </DropdownMenuContent>\r\n              </DropdownMenu>\r\n            )}\r\n          </div>\r\n        </CardHeader>\r\n\r\n        <CardContent className=\"pt-0 pb-3\">\r\n          {/* Activity Badge */}\r\n          {post.activity && (\r\n            <Link to={`/activity/${post.activity.id}`}>\r\n              <Badge variant=\"secondary\" className=\"mb-3 gap-1\">\r\n                <Calendar className=\"h-3 w-3\" />\r\n                {activityTitle}\r\n              </Badge>\r\n            </Link>\r\n          )}\r\n\r\n          {/* Content */}\r\n          <Link to={`/community/${post.id}`}>\r\n            <div\r\n              className=\"prose prose-sm max-w-none dark:prose-invert\"\r\n              dangerouslySetInnerHTML={{ __html: translatedContent || post.content }}\r\n            />\r\n          </Link>\r\n\r\n          {/* Translate Button - translate original content to current UI language */}\r\n          <TranslateButton \r\n            text={post.content} \r\n            onTranslation={setTranslatedContent}\r\n            className=\"mt-1\"\r\n          />\r\n\r\n          {/* Images - Carousel only for multiple images */}\r\n          {post.image_urls && post.image_urls.length > 0 && (\r\n            <div className=\"relative mt-3\">\r\n              {post.image_urls.length === 1 ? (\r\n                // Single image - no carousel, just clickable image\r\n                <div \r\n                  className=\"relative aspect-square overflow-hidden rounded-lg cursor-pointer\"\r\n                  onClick={() => handleImageClick(0)}\r\n                >\r\n                  {!imageError[post.image_urls[0]] ? (\r\n                    <img\r\n                      src={post.image_urls[0]}\r\n                      alt=\"\"\r\n                      className=\"w-full h-full object-cover\"\r\n                      onError={() =>\r\n                        setImageError((prev) => ({ ...prev, [post.image_urls![0]]: true }))\r\n                      }\r\n                    />\r\n                  ) : (\r\n                    <div className=\"w-full h-full bg-muted flex items-center justify-center\">\r\n                      <span className=\"text-xs text-muted-foreground\">\r\n                        {t(\"common.imageLoadError\", \"图片加载失败\")}\r\n                      </span>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              ) : (\r\n                // Multiple images - use carousel\r\n                <>\r\n                  <Carousel \r\n                    setApi={setCarouselApi} \r\n                    className=\"w-full\"\r\n                    opts={{ loop: true }}\r\n                  >\r\n                    <CarouselContent className=\"-ml-0\">\r\n                      {post.image_urls.map((url, index) => (\r\n                        <CarouselItem key={index} className=\"pl-0\">\r\n                          <div \r\n                            className=\"relative aspect-square overflow-hidden rounded-lg cursor-pointer\"\r\n                            onClick={() => handleImageClick(index)}\r\n                          >\r\n                            {!imageError[url] ? (\r\n                              <img\r\n                                src={url}\r\n                                alt=\"\"\r\n                                className=\"w-full h-full object-cover\"\r\n                                onError={() =>\r\n                                  setImageError((prev) => ({ ...prev, [url]: true }))\r\n                                }\r\n                              />\r\n                            ) : (\r\n                              <div className=\"w-full h-full bg-muted flex items-center justify-center\">\r\n                                <span className=\"text-xs text-muted-foreground\">\r\n                                  {t(\"common.imageLoadError\", \"图片加载失败\")}\r\n                                </span>\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        </CarouselItem>\r\n                      ))}\r\n                    </CarouselContent>\r\n                  </Carousel>\r\n                  \r\n                  {/* Top-right slide counter */}\r\n                  <div className=\"absolute top-3 right-3 bg-black/60 text-white text-xs px-2 py-1 rounded-full z-10\">\r\n                    {currentSlide + 1}/{post.image_urls.length}\r\n                  </div>\r\n                  \r\n                  {/* Bottom navigation dots */}\r\n                  <div className=\"flex justify-center gap-1.5 mt-2\">\r\n                    {post.image_urls.map((_, index) => (\r\n                      <button\r\n                        key={index}\r\n                        className={`w-1.5 h-1.5 rounded-full transition-colors ${\r\n                          index === currentSlide \r\n                            ? \"bg-primary\" \r\n                            : \"bg-muted-foreground/30\"\r\n                        }`}\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          carouselApi?.scrollTo(index);\r\n                        }}\r\n                      />\r\n                    ))}\r\n                  </div>\r\n                </>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {/* Video */}\r\n          {post.video_url && (\r\n            <div className=\"mt-3 rounded-lg overflow-hidden\">\r\n              <video\r\n                src={post.video_url}\r\n                controls\r\n                className=\"w-full max-h-96\"\r\n                preload=\"metadata\"\r\n              />\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n\r\n        <CardFooter className=\"pt-0 border-t\">\r\n          <div className=\"flex items-center gap-4 pt-3 w-full\">\r\n            <Button\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              className={`gap-2 ${post.user_liked ? \"text-red-500\" : \"\"}`}\r\n              onClick={handleLike}\r\n              disabled={!user}\r\n            >\r\n              <Heart\r\n                className={`h-4 w-4 ${post.user_liked ? \"fill-current\" : \"\"}`}\r\n              />\r\n              <span>{post.likes_count}</span>\r\n            </Button>\r\n\r\n            <Link to={`/community/${post.id}`}>\r\n              <Button variant=\"ghost\" size=\"sm\" className=\"gap-2\">\r\n                <MessageCircle className=\"h-4 w-4\" />\r\n                <span>{post.comments_count}</span>\r\n              </Button>\r\n            </Link>\r\n\r\n            <Button variant=\"ghost\" size=\"sm\" className=\"gap-2\" onClick={handleShare}>\r\n              <Share2 className=\"h-4 w-4\" />\r\n              <span>{post.shares_count}</span>\r\n            </Button>\r\n          </div>\r\n        </CardFooter>\r\n      </Card>\r\n\r\n      <AlertDialog open={showDeleteDialog} onOpenChange={setShowDeleteDialog}>\r\n        <AlertDialogContent>\r\n          <AlertDialogHeader>\r\n            <AlertDialogTitle>{t(\"common.confirmDelete\", \"确认删除\")}</AlertDialogTitle>\r\n            <AlertDialogDescription>\r\n              {t(\"community.deleteWarning\", \"删除后无法恢复，确定要删除这篇帖子吗？\")}\r\n            </AlertDialogDescription>\r\n          </AlertDialogHeader>\r\n          <AlertDialogFooter>\r\n            <AlertDialogCancel>{t(\"common.cancel\", \"取消\")}</AlertDialogCancel>\r\n            <AlertDialogAction onClick={handleDelete}>\r\n              {t(\"common.delete\", \"删除\")}\r\n            </AlertDialogAction>\r\n          </AlertDialogFooter>\r\n        </AlertDialogContent>\r\n      </AlertDialog>\r\n\r\n      {/* Image Preview - Using Carousel for smooth swipe like feed */}\r\n      {previewOpen && createPortal(\r\n        <div \r\n          className=\"fixed inset-0 z-[100] bg-black overflow-hidden\"\r\n          onClick={(e) => {\r\n            // Only close if clicking on backdrop, not carousel\r\n            if (e.target === e.currentTarget) {\r\n              setPreviewOpen(false);\r\n            }\r\n          }}\r\n        >\r\n          {/* Image Counter */}\r\n          {post.image_urls && post.image_urls.length > 1 && (\r\n            <div className=\"absolute top-4 left-1/2 -translate-x-1/2 z-10 text-white text-sm bg-black/50 px-4 py-1.5 rounded-full\">\r\n              {previewIndex + 1} / {post.image_urls.length}\r\n            </div>\r\n          )}\r\n\r\n          {/* Close Button */}\r\n          <Button\r\n            variant=\"ghost\"\r\n            size=\"icon\"\r\n            className=\"absolute top-4 right-4 z-10 text-white hover:bg-white/20\"\r\n            onClick={() => setPreviewOpen(false)}\r\n          >\r\n            <X className=\"h-6 w-6\" />\r\n          </Button>\r\n\r\n          {/* Full screen Carousel - centered with calc() constraints */}\r\n          <div className=\"absolute inset-0 flex items-center justify-center\">\r\n            <Carousel\r\n              className=\"w-full\"\r\n              opts={{ loop: true }}\r\n              setApi={(api) => {\r\n                setPreviewCarouselApi(api);\r\n                if (api) {\r\n                  api.on(\"select\", () => {\r\n                    setPreviewIndex(api.selectedScrollSnap());\r\n                  });\r\n                }\r\n              }}\r\n            >\r\n              <CarouselContent className=\"-ml-0\">\r\n                {post.image_urls?.map((url, index) => (\r\n                  <CarouselItem key={index} className=\"pl-0 flex items-center justify-center\">\r\n                    <img\r\n                      src={url}\r\n                      alt=\"\"\r\n                      className=\"object-contain select-none w-screen h-screen cursor-pointer\"\r\n                      draggable={false}\r\n                      onClick={() => setPreviewOpen(false)}\r\n                    />\r\n                  </CarouselItem>\r\n                ))}\r\n              </CarouselContent>\r\n            </Carousel>\r\n          </div>\r\n\r\n          {/* Desktop Navigation Buttons - connected to Carousel API */}\r\n          {post.image_urls && post.image_urls.length > 1 && (\r\n            <>\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"icon\"\r\n                className=\"absolute left-4 top-1/2 -translate-y-1/2 z-10 text-white hover:bg-white/20 h-12 w-12 hidden sm:flex\"\r\n                onClick={() => previewCarouselApi?.scrollPrev()}\r\n              >\r\n                <ChevronLeft className=\"h-8 w-8\" />\r\n              </Button>\r\n              <Button\r\n                variant=\"ghost\"\r\n                size=\"icon\"\r\n                className=\"absolute right-4 top-1/2 -translate-y-1/2 z-10 text-white hover:bg-white/20 h-12 w-12 hidden sm:flex\"\r\n                onClick={() => previewCarouselApi?.scrollNext()}\r\n              >\r\n                <ChevronRight className=\"h-8 w-8\" />\r\n              </Button>\r\n            </>\r\n          )}\r\n        </div>,\r\n        document.body\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PostCard;\r\n","import { useParams, useNavigate } from \"react-router-dom\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { ArrowLeft, Loader2 } from \"lucide-react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport PostCard from \"@/components/community/PostCard\";\r\nimport RestaurantComments from \"@/components/RestaurantComments\";\r\nimport { useCommunityPost } from \"@/hooks/useCommunityPosts\";\r\n\r\nconst PostDetail = () => {\r\n  const { id } = useParams<{ id: string }>();\r\n  const { t } = useTranslation();\r\n  const navigate = useNavigate();\r\n  const { data: post, isLoading, error } = useCommunityPost(id || \"\");\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"container max-w-2xl mx-auto py-6 px-4 flex justify-center\">\r\n        <Loader2 className=\"h-8 w-8 animate-spin\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error || !post) {\r\n    return (\r\n      <div className=\"container max-w-2xl mx-auto py-6 px-4\">\r\n        <div className=\"text-center py-12\">\r\n          <p className=\"text-muted-foreground\">\r\n            {t(\"community.postNotFound\", \"帖子不存在或已被删除\")}\r\n          </p>\r\n          <Button\r\n            variant=\"outline\"\r\n            className=\"mt-4\"\r\n            onClick={() => navigate(\"/community\")}\r\n          >\r\n            <ArrowLeft className=\"h-4 w-4 mr-2\" />\r\n            {t(\"community.backToList\", \"返回社区\")}\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"container max-w-2xl mx-auto py-6 px-4\">\r\n      {/* Back Button */}\r\n      <Button\r\n        variant=\"ghost\"\r\n        size=\"sm\"\r\n        className=\"mb-4\"\r\n        onClick={() => navigate(\"/community\")}\r\n      >\r\n        <ArrowLeft className=\"h-4 w-4 mr-2\" />\r\n        {t(\"community.backToList\", \"返回社区\")}\r\n      </Button>\r\n\r\n      {/* Post Card */}\r\n      <PostCard post={post} showActions isDetailPage />\r\n\r\n      {/* Comments Section */}\r\n      <div className=\"mt-6\">\r\n        <RestaurantComments\r\n          targetId={post.id}\r\n          targetType=\"post\"\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PostDetail;\r\n"],"names":["PostCard","post","showActions","isDetailPage","i18n","useTranslation","user","useAuth","navigate","useNavigate","getLocalizedField","useLocalizedContent","likePost","useLikePost","sharePost","useSharePost","deletePost","useDeletePost","showDeleteDialog","setShowDeleteDialog","useState","imageError","setImageError","previewOpen","setPreviewOpen","previewIndex","setPreviewIndex","carouselApi","setCarouselApi","previewCarouselApi","setPreviewCarouselApi","currentSlide","setCurrentSlide","translatedContent","setTranslatedContent","useEffect","getDateLocale","zhCN","pt","enUS","handleLike","handleShare","shareUrl","toast","error","handleDelete","handleImageClick","index","isAuthor","activityTitle","jsxs","Fragment","Card","jsx","CardHeader","Avatar","AvatarImage","AvatarFallback","DropdownMenu","DropdownMenuTrigger","Button","MoreHorizontal","DropdownMenuContent","DropdownMenuItem","CardContent","Link","Badge","Calendar","TranslateButton","prev","Carousel","CarouselContent","url","CarouselItem","_","e","CardFooter","Heart","MessageCircle","Share2","AlertDialog","AlertDialogContent","AlertDialogHeader","AlertDialogTitle","AlertDialogDescription","AlertDialogFooter","AlertDialogCancel","AlertDialogAction","createPortal","X","api","ChevronLeft","ChevronRight","PostDetail","id","useParams","t","isLoading","useCommunityPost","Loader2","ArrowLeft","RestaurantComments"],"mappings":"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"}