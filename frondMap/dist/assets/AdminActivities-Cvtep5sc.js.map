{"version":3,"file":"AdminActivities-Cvtep5sc.js","sources":["../../node_modules/lucide-react/dist/esm/icons/crop.js","../../node_modules/lucide-react/dist/esm/icons/maximize-2.js","../../node_modules/lucide-react/dist/esm/icons/pin.js","../../node_modules/react-image-crop/dist/index.js","../../src/components/admin/ImageCropDialog.tsx","../../src/components/admin/ActivityFormDialog.tsx","../../src/components/admin/ActivityRulesEditorDialog.tsx","../../src/components/admin/GlobalHandbookEditorDialog.tsx","../../src/pages/admin/AdminActivities.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.462.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Crop = createLucideIcon(\"Crop\", [\n  [\"path\", { d: \"M6 2v14a2 2 0 0 0 2 2h14\", key: \"ron5a4\" }],\n  [\"path\", { d: \"M18 22V8a2 2 0 0 0-2-2H2\", key: \"7s9ehn\" }]\n]);\n\nexport { Crop as default };\n//# sourceMappingURL=crop.js.map\n","/**\n * @license lucide-react v0.462.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Maximize2 = createLucideIcon(\"Maximize2\", [\n  [\"polyline\", { points: \"15 3 21 3 21 9\", key: \"mznyad\" }],\n  [\"polyline\", { points: \"9 21 3 21 3 15\", key: \"1avn1i\" }],\n  [\"line\", { x1: \"21\", x2: \"14\", y1: \"3\", y2: \"10\", key: \"ota7mn\" }],\n  [\"line\", { x1: \"3\", x2: \"10\", y1: \"21\", y2: \"14\", key: \"1atl0r\" }]\n]);\n\nexport { Maximize2 as default };\n//# sourceMappingURL=maximize-2.js.map\n","/**\n * @license lucide-react v0.462.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Pin = createLucideIcon(\"Pin\", [\n  [\"path\", { d: \"M12 17v5\", key: \"bb1du9\" }],\n  [\n    \"path\",\n    {\n      d: \"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z\",\n      key: \"1nkz8b\"\n    }\n  ]\n]);\n\nexport { Pin as default };\n//# sourceMappingURL=pin.js.map\n","var _ = Object.defineProperty;\nvar $ = (a, h, e) => h in a ? _(a, h, { enumerable: !0, configurable: !0, writable: !0, value: e }) : a[h] = e;\nvar m = (a, h, e) => $(a, typeof h != \"symbol\" ? h + \"\" : h, e);\nimport u, { PureComponent as K, createRef as P } from \"react\";\nconst E = {\n  x: 0,\n  y: 0,\n  width: 0,\n  height: 0,\n  unit: \"px\"\n}, b = (a, h, e) => Math.min(Math.max(a, h), e), H = (...a) => a.filter((h) => h && typeof h == \"string\").join(\" \"), X = (a, h) => a === h || a.width === h.width && a.height === h.height && a.x === h.x && a.y === h.y && a.unit === h.unit;\nfunction B(a, h, e, n) {\n  const t = D(a, e, n);\n  return a.width && (t.height = t.width / h), a.height && (t.width = t.height * h), t.y + t.height > n && (t.height = n - t.y, t.width = t.height * h), t.x + t.width > e && (t.width = e - t.x, t.height = t.width / h), a.unit === \"%\" ? v(t, e, n) : t;\n}\nfunction L(a, h, e) {\n  const n = D(a, h, e);\n  return n.x = (h - n.width) / 2, n.y = (e - n.height) / 2, a.unit === \"%\" ? v(n, h, e) : n;\n}\nfunction v(a, h, e) {\n  return a.unit === \"%\" ? { ...E, ...a, unit: \"%\" } : {\n    unit: \"%\",\n    x: a.x ? a.x / h * 100 : 0,\n    y: a.y ? a.y / e * 100 : 0,\n    width: a.width ? a.width / h * 100 : 0,\n    height: a.height ? a.height / e * 100 : 0\n  };\n}\nfunction D(a, h, e) {\n  return a.unit ? a.unit === \"px\" ? { ...E, ...a, unit: \"px\" } : {\n    unit: \"px\",\n    x: a.x ? a.x * h / 100 : 0,\n    y: a.y ? a.y * e / 100 : 0,\n    width: a.width ? a.width * h / 100 : 0,\n    height: a.height ? a.height * e / 100 : 0\n  } : { ...E, ...a, unit: \"px\" };\n}\nfunction k(a, h, e, n, t, d = 0, r = 0, o = n, w = t) {\n  const i = { ...a };\n  let s = Math.min(d, n), c = Math.min(r, t), g = Math.min(o, n), p = Math.min(w, t);\n  h && (h > 1 ? (s = r ? r * h : s, c = s / h, g = o * h) : (c = d ? d / h : c, s = c * h, p = w / h)), i.y < 0 && (i.height = Math.max(i.height + i.y, c), i.y = 0), i.x < 0 && (i.width = Math.max(i.width + i.x, s), i.x = 0);\n  const l = n - (i.x + i.width);\n  l < 0 && (i.x = Math.min(i.x, n - s), i.width += l);\n  const C = t - (i.y + i.height);\n  if (C < 0 && (i.y = Math.min(i.y, t - c), i.height += C), i.width < s && ((e === \"sw\" || e == \"nw\") && (i.x -= s - i.width), i.width = s), i.height < c && ((e === \"nw\" || e == \"ne\") && (i.y -= c - i.height), i.height = c), i.width > g && ((e === \"sw\" || e == \"nw\") && (i.x -= g - i.width), i.width = g), i.height > p && ((e === \"nw\" || e == \"ne\") && (i.y -= p - i.height), i.height = p), h) {\n    const y = i.width / i.height;\n    if (y < h) {\n      const f = Math.max(i.width / h, c);\n      (e === \"nw\" || e == \"ne\") && (i.y -= f - i.height), i.height = f;\n    } else if (y > h) {\n      const f = Math.max(i.height * h, s);\n      (e === \"sw\" || e == \"nw\") && (i.x -= f - i.width), i.width = f;\n    }\n  }\n  return i;\n}\nfunction I(a, h, e, n) {\n  const t = { ...a };\n  return h === \"ArrowLeft\" ? n === \"nw\" ? (t.x -= e, t.y -= e, t.width += e, t.height += e) : n === \"w\" ? (t.x -= e, t.width += e) : n === \"sw\" ? (t.x -= e, t.width += e, t.height += e) : n === \"ne\" ? (t.y += e, t.width -= e, t.height -= e) : n === \"e\" ? t.width -= e : n === \"se\" && (t.width -= e, t.height -= e) : h === \"ArrowRight\" && (n === \"nw\" ? (t.x += e, t.y += e, t.width -= e, t.height -= e) : n === \"w\" ? (t.x += e, t.width -= e) : n === \"sw\" ? (t.x += e, t.width -= e, t.height -= e) : n === \"ne\" ? (t.y -= e, t.width += e, t.height += e) : n === \"e\" ? t.width += e : n === \"se\" && (t.width += e, t.height += e)), h === \"ArrowUp\" ? n === \"nw\" ? (t.x -= e, t.y -= e, t.width += e, t.height += e) : n === \"n\" ? (t.y -= e, t.height += e) : n === \"ne\" ? (t.y -= e, t.width += e, t.height += e) : n === \"sw\" ? (t.x += e, t.width -= e, t.height -= e) : n === \"s\" ? t.height -= e : n === \"se\" && (t.width -= e, t.height -= e) : h === \"ArrowDown\" && (n === \"nw\" ? (t.x += e, t.y += e, t.width -= e, t.height -= e) : n === \"n\" ? (t.y += e, t.height -= e) : n === \"ne\" ? (t.y += e, t.width -= e, t.height -= e) : n === \"sw\" ? (t.x -= e, t.width += e, t.height += e) : n === \"s\" ? t.height += e : n === \"se\" && (t.width += e, t.height += e)), t;\n}\nconst M = { capture: !0, passive: !1 };\nlet N = 0;\nconst x = class x extends K {\n  constructor() {\n    super(...arguments);\n    m(this, \"docMoveBound\", !1);\n    m(this, \"mouseDownOnCrop\", !1);\n    m(this, \"dragStarted\", !1);\n    m(this, \"evData\", {\n      startClientX: 0,\n      startClientY: 0,\n      startCropX: 0,\n      startCropY: 0,\n      clientX: 0,\n      clientY: 0,\n      isResize: !0\n    });\n    m(this, \"componentRef\", P());\n    m(this, \"mediaRef\", P());\n    m(this, \"resizeObserver\");\n    m(this, \"initChangeCalled\", !1);\n    m(this, \"instanceId\", `rc-${N++}`);\n    m(this, \"state\", {\n      cropIsActive: !1,\n      newCropIsBeingDrawn: !1\n    });\n    m(this, \"onCropPointerDown\", (e) => {\n      const { crop: n, disabled: t } = this.props, d = this.getBox();\n      if (!n)\n        return;\n      const r = D(n, d.width, d.height);\n      if (t)\n        return;\n      e.cancelable && e.preventDefault(), this.bindDocMove(), this.componentRef.current.focus({ preventScroll: !0 });\n      const o = e.target.dataset.ord, w = !!o;\n      let i = e.clientX, s = e.clientY, c = r.x, g = r.y;\n      if (o) {\n        const p = e.clientX - d.x, l = e.clientY - d.y;\n        let C = 0, y = 0;\n        o === \"ne\" || o == \"e\" ? (C = p - (r.x + r.width), y = l - r.y, c = r.x, g = r.y + r.height) : o === \"se\" || o === \"s\" ? (C = p - (r.x + r.width), y = l - (r.y + r.height), c = r.x, g = r.y) : o === \"sw\" || o == \"w\" ? (C = p - r.x, y = l - (r.y + r.height), c = r.x + r.width, g = r.y) : (o === \"nw\" || o == \"n\") && (C = p - r.x, y = l - r.y, c = r.x + r.width, g = r.y + r.height), i = c + d.x + C, s = g + d.y + y;\n      }\n      this.evData = {\n        startClientX: i,\n        startClientY: s,\n        startCropX: c,\n        startCropY: g,\n        clientX: e.clientX,\n        clientY: e.clientY,\n        isResize: w,\n        ord: o\n      }, this.mouseDownOnCrop = !0, this.setState({ cropIsActive: !0 });\n    });\n    m(this, \"onComponentPointerDown\", (e) => {\n      const { crop: n, disabled: t, locked: d, keepSelection: r, onChange: o } = this.props, w = this.getBox();\n      if (t || d || r && n)\n        return;\n      e.cancelable && e.preventDefault(), this.bindDocMove(), this.componentRef.current.focus({ preventScroll: !0 });\n      const i = e.clientX - w.x, s = e.clientY - w.y, c = {\n        unit: \"px\",\n        x: i,\n        y: s,\n        width: 0,\n        height: 0\n      };\n      this.evData = {\n        startClientX: e.clientX,\n        startClientY: e.clientY,\n        startCropX: i,\n        startCropY: s,\n        clientX: e.clientX,\n        clientY: e.clientY,\n        isResize: !0\n      }, this.mouseDownOnCrop = !0, o(D(c, w.width, w.height), v(c, w.width, w.height)), this.setState({ cropIsActive: !0, newCropIsBeingDrawn: !0 });\n    });\n    m(this, \"onDocPointerMove\", (e) => {\n      const { crop: n, disabled: t, onChange: d, onDragStart: r } = this.props, o = this.getBox();\n      if (t || !n || !this.mouseDownOnCrop)\n        return;\n      e.cancelable && e.preventDefault(), this.dragStarted || (this.dragStarted = !0, r && r(e));\n      const { evData: w } = this;\n      w.clientX = e.clientX, w.clientY = e.clientY;\n      let i;\n      w.isResize ? i = this.resizeCrop() : i = this.dragCrop(), X(n, i) || d(\n        D(i, o.width, o.height),\n        v(i, o.width, o.height)\n      );\n    });\n    m(this, \"onComponentKeyDown\", (e) => {\n      const { crop: n, disabled: t, onChange: d, onComplete: r } = this.props;\n      if (t)\n        return;\n      const o = e.key;\n      let w = !1;\n      if (!n)\n        return;\n      const i = this.getBox(), s = this.makePixelCrop(i), g = (navigator.platform.match(\"Mac\") ? e.metaKey : e.ctrlKey) ? x.nudgeStepLarge : e.shiftKey ? x.nudgeStepMedium : x.nudgeStep;\n      if (o === \"ArrowLeft\" ? (s.x -= g, w = !0) : o === \"ArrowRight\" ? (s.x += g, w = !0) : o === \"ArrowUp\" ? (s.y -= g, w = !0) : o === \"ArrowDown\" && (s.y += g, w = !0), w) {\n        e.cancelable && e.preventDefault(), s.x = b(s.x, 0, i.width - s.width), s.y = b(s.y, 0, i.height - s.height);\n        const p = D(s, i.width, i.height), l = v(s, i.width, i.height);\n        d(p, l), r && r(p, l);\n      }\n    });\n    m(this, \"onHandlerKeyDown\", (e, n) => {\n      const {\n        aspect: t = 0,\n        crop: d,\n        disabled: r,\n        minWidth: o = 0,\n        minHeight: w = 0,\n        maxWidth: i,\n        maxHeight: s,\n        onChange: c,\n        onComplete: g\n      } = this.props, p = this.getBox();\n      if (r || !d)\n        return;\n      if (e.key === \"ArrowUp\" || e.key === \"ArrowDown\" || e.key === \"ArrowLeft\" || e.key === \"ArrowRight\")\n        e.stopPropagation(), e.preventDefault();\n      else\n        return;\n      const C = (navigator.platform.match(\"Mac\") ? e.metaKey : e.ctrlKey) ? x.nudgeStepLarge : e.shiftKey ? x.nudgeStepMedium : x.nudgeStep, y = D(d, p.width, p.height), f = I(y, e.key, C, n), R = k(\n        f,\n        t,\n        n,\n        p.width,\n        p.height,\n        o,\n        w,\n        i,\n        s\n      );\n      if (!X(d, R)) {\n        const Y = v(R, p.width, p.height);\n        c(R, Y), g && g(R, Y);\n      }\n    });\n    m(this, \"onDocPointerDone\", (e) => {\n      const { crop: n, disabled: t, onComplete: d, onDragEnd: r } = this.props, o = this.getBox();\n      this.unbindDocMove(), !(t || !n) && this.mouseDownOnCrop && (this.mouseDownOnCrop = !1, this.dragStarted = !1, r && r(e), d && d(D(n, o.width, o.height), v(n, o.width, o.height)), this.setState({ cropIsActive: !1, newCropIsBeingDrawn: !1 }));\n    });\n    m(this, \"onDragFocus\", () => {\n      var e;\n      (e = this.componentRef.current) == null || e.scrollTo(0, 0);\n    });\n  }\n  get document() {\n    return document;\n  }\n  // We unfortunately get the bounding box every time as x+y changes\n  // due to scrolling.\n  getBox() {\n    const e = this.mediaRef.current;\n    if (!e)\n      return { x: 0, y: 0, width: 0, height: 0 };\n    const { x: n, y: t, width: d, height: r } = e.getBoundingClientRect();\n    return { x: n, y: t, width: d, height: r };\n  }\n  componentDidUpdate(e) {\n    const { crop: n, onComplete: t } = this.props;\n    if (t && !e.crop && n) {\n      const { width: d, height: r } = this.getBox();\n      d && r && t(D(n, d, r), v(n, d, r));\n    }\n  }\n  componentWillUnmount() {\n    this.resizeObserver && this.resizeObserver.disconnect(), this.unbindDocMove();\n  }\n  bindDocMove() {\n    this.docMoveBound || (this.document.addEventListener(\"pointermove\", this.onDocPointerMove, M), this.document.addEventListener(\"pointerup\", this.onDocPointerDone, M), this.document.addEventListener(\"pointercancel\", this.onDocPointerDone, M), this.docMoveBound = !0);\n  }\n  unbindDocMove() {\n    this.docMoveBound && (this.document.removeEventListener(\"pointermove\", this.onDocPointerMove, M), this.document.removeEventListener(\"pointerup\", this.onDocPointerDone, M), this.document.removeEventListener(\"pointercancel\", this.onDocPointerDone, M), this.docMoveBound = !1);\n  }\n  getCropStyle() {\n    const { crop: e } = this.props;\n    if (e)\n      return {\n        top: `${e.y}${e.unit}`,\n        left: `${e.x}${e.unit}`,\n        width: `${e.width}${e.unit}`,\n        height: `${e.height}${e.unit}`\n      };\n  }\n  dragCrop() {\n    const { evData: e } = this, n = this.getBox(), t = this.makePixelCrop(n), d = e.clientX - e.startClientX, r = e.clientY - e.startClientY;\n    return t.x = b(e.startCropX + d, 0, n.width - t.width), t.y = b(e.startCropY + r, 0, n.height - t.height), t;\n  }\n  getPointRegion(e, n, t, d) {\n    const { evData: r } = this, o = r.clientX - e.x, w = r.clientY - e.y;\n    let i;\n    d && n ? i = n === \"nw\" || n === \"n\" || n === \"ne\" : i = w < r.startCropY;\n    let s;\n    return t && n ? s = n === \"nw\" || n === \"w\" || n === \"sw\" : s = o < r.startCropX, s ? i ? \"nw\" : \"sw\" : i ? \"ne\" : \"se\";\n  }\n  resolveMinDimensions(e, n, t = 0, d = 0) {\n    const r = Math.min(t, e.width), o = Math.min(d, e.height);\n    return !n || !r && !o ? [r, o] : n > 1 ? r ? [r, r / n] : [o * n, o] : o ? [o * n, o] : [r, r / n];\n  }\n  resizeCrop() {\n    const { evData: e } = this, { aspect: n = 0, maxWidth: t, maxHeight: d } = this.props, r = this.getBox(), [o, w] = this.resolveMinDimensions(r, n, this.props.minWidth, this.props.minHeight);\n    let i = this.makePixelCrop(r);\n    const s = this.getPointRegion(r, e.ord, o, w), c = e.ord || s;\n    let g = e.clientX - e.startClientX, p = e.clientY - e.startClientY;\n    (o && c === \"nw\" || c === \"w\" || c === \"sw\") && (g = Math.min(g, -o)), (w && c === \"nw\" || c === \"n\" || c === \"ne\") && (p = Math.min(p, -w));\n    const l = {\n      unit: \"px\",\n      x: 0,\n      y: 0,\n      width: 0,\n      height: 0\n    };\n    s === \"ne\" ? (l.x = e.startCropX, l.width = g, n ? (l.height = l.width / n, l.y = e.startCropY - l.height) : (l.height = Math.abs(p), l.y = e.startCropY - l.height)) : s === \"se\" ? (l.x = e.startCropX, l.y = e.startCropY, l.width = g, n ? l.height = l.width / n : l.height = p) : s === \"sw\" ? (l.x = e.startCropX + g, l.y = e.startCropY, l.width = Math.abs(g), n ? l.height = l.width / n : l.height = p) : s === \"nw\" && (l.x = e.startCropX + g, l.width = Math.abs(g), n ? (l.height = l.width / n, l.y = e.startCropY - l.height) : (l.height = Math.abs(p), l.y = e.startCropY + p));\n    const C = k(\n      l,\n      n,\n      s,\n      r.width,\n      r.height,\n      o,\n      w,\n      t,\n      d\n    );\n    return n || x.xyOrds.indexOf(c) > -1 ? i = C : x.xOrds.indexOf(c) > -1 ? (i.x = C.x, i.width = C.width) : x.yOrds.indexOf(c) > -1 && (i.y = C.y, i.height = C.height), i.x = b(i.x, 0, r.width - i.width), i.y = b(i.y, 0, r.height - i.height), i;\n  }\n  renderCropSelection() {\n    const {\n      ariaLabels: e = x.defaultProps.ariaLabels,\n      disabled: n,\n      locked: t,\n      renderSelectionAddon: d,\n      ruleOfThirds: r,\n      crop: o\n    } = this.props, w = this.getCropStyle();\n    if (o)\n      return /* @__PURE__ */ u.createElement(\n        \"div\",\n        {\n          style: w,\n          className: \"ReactCrop__crop-selection\",\n          onPointerDown: this.onCropPointerDown,\n          \"aria-label\": e.cropArea,\n          tabIndex: 0,\n          onKeyDown: this.onComponentKeyDown,\n          role: \"group\"\n        },\n        !n && !t && /* @__PURE__ */ u.createElement(\"div\", { className: \"ReactCrop__drag-elements\", onFocus: this.onDragFocus }, /* @__PURE__ */ u.createElement(\"div\", { className: \"ReactCrop__drag-bar ord-n\", \"data-ord\": \"n\" }), /* @__PURE__ */ u.createElement(\"div\", { className: \"ReactCrop__drag-bar ord-e\", \"data-ord\": \"e\" }), /* @__PURE__ */ u.createElement(\"div\", { className: \"ReactCrop__drag-bar ord-s\", \"data-ord\": \"s\" }), /* @__PURE__ */ u.createElement(\"div\", { className: \"ReactCrop__drag-bar ord-w\", \"data-ord\": \"w\" }), /* @__PURE__ */ u.createElement(\n          \"div\",\n          {\n            className: \"ReactCrop__drag-handle ord-nw\",\n            \"data-ord\": \"nw\",\n            tabIndex: 0,\n            \"aria-label\": e.nwDragHandle,\n            onKeyDown: (i) => this.onHandlerKeyDown(i, \"nw\"),\n            role: \"button\"\n          }\n        ), /* @__PURE__ */ u.createElement(\n          \"div\",\n          {\n            className: \"ReactCrop__drag-handle ord-n\",\n            \"data-ord\": \"n\",\n            tabIndex: 0,\n            \"aria-label\": e.nDragHandle,\n            onKeyDown: (i) => this.onHandlerKeyDown(i, \"n\"),\n            role: \"button\"\n          }\n        ), /* @__PURE__ */ u.createElement(\n          \"div\",\n          {\n            className: \"ReactCrop__drag-handle ord-ne\",\n            \"data-ord\": \"ne\",\n            tabIndex: 0,\n            \"aria-label\": e.neDragHandle,\n            onKeyDown: (i) => this.onHandlerKeyDown(i, \"ne\"),\n            role: \"button\"\n          }\n        ), /* @__PURE__ */ u.createElement(\n          \"div\",\n          {\n            className: \"ReactCrop__drag-handle ord-e\",\n            \"data-ord\": \"e\",\n            tabIndex: 0,\n            \"aria-label\": e.eDragHandle,\n            onKeyDown: (i) => this.onHandlerKeyDown(i, \"e\"),\n            role: \"button\"\n          }\n        ), /* @__PURE__ */ u.createElement(\n          \"div\",\n          {\n            className: \"ReactCrop__drag-handle ord-se\",\n            \"data-ord\": \"se\",\n            tabIndex: 0,\n            \"aria-label\": e.seDragHandle,\n            onKeyDown: (i) => this.onHandlerKeyDown(i, \"se\"),\n            role: \"button\"\n          }\n        ), /* @__PURE__ */ u.createElement(\n          \"div\",\n          {\n            className: \"ReactCrop__drag-handle ord-s\",\n            \"data-ord\": \"s\",\n            tabIndex: 0,\n            \"aria-label\": e.sDragHandle,\n            onKeyDown: (i) => this.onHandlerKeyDown(i, \"s\"),\n            role: \"button\"\n          }\n        ), /* @__PURE__ */ u.createElement(\n          \"div\",\n          {\n            className: \"ReactCrop__drag-handle ord-sw\",\n            \"data-ord\": \"sw\",\n            tabIndex: 0,\n            \"aria-label\": e.swDragHandle,\n            onKeyDown: (i) => this.onHandlerKeyDown(i, \"sw\"),\n            role: \"button\"\n          }\n        ), /* @__PURE__ */ u.createElement(\n          \"div\",\n          {\n            className: \"ReactCrop__drag-handle ord-w\",\n            \"data-ord\": \"w\",\n            tabIndex: 0,\n            \"aria-label\": e.wDragHandle,\n            onKeyDown: (i) => this.onHandlerKeyDown(i, \"w\"),\n            role: \"button\"\n          }\n        )),\n        d && /* @__PURE__ */ u.createElement(\"div\", { className: \"ReactCrop__selection-addon\", onPointerDown: (i) => i.stopPropagation() }, d(this.state)),\n        r && /* @__PURE__ */ u.createElement(u.Fragment, null, /* @__PURE__ */ u.createElement(\"div\", { className: \"ReactCrop__rule-of-thirds-hz\" }), /* @__PURE__ */ u.createElement(\"div\", { className: \"ReactCrop__rule-of-thirds-vt\" }))\n      );\n  }\n  makePixelCrop(e) {\n    const n = { ...E, ...this.props.crop || {} };\n    return D(n, e.width, e.height);\n  }\n  render() {\n    const { aspect: e, children: n, circularCrop: t, className: d, crop: r, disabled: o, locked: w, style: i, ruleOfThirds: s } = this.props, { cropIsActive: c, newCropIsBeingDrawn: g } = this.state, p = r ? this.renderCropSelection() : null, l = H(\n      \"ReactCrop\",\n      d,\n      c && \"ReactCrop--active\",\n      o && \"ReactCrop--disabled\",\n      w && \"ReactCrop--locked\",\n      g && \"ReactCrop--new-crop\",\n      r && e && \"ReactCrop--fixed-aspect\",\n      r && t && \"ReactCrop--circular-crop\",\n      r && s && \"ReactCrop--rule-of-thirds\",\n      !this.dragStarted && r && !r.width && !r.height && \"ReactCrop--invisible-crop\",\n      t && \"ReactCrop--no-animate\"\n    );\n    return /* @__PURE__ */ u.createElement(\"div\", { ref: this.componentRef, className: l, style: i }, /* @__PURE__ */ u.createElement(\"div\", { ref: this.mediaRef, className: \"ReactCrop__child-wrapper\", onPointerDown: this.onComponentPointerDown }, n), r ? /* @__PURE__ */ u.createElement(\"svg\", { className: \"ReactCrop__crop-mask\", width: \"100%\", height: \"100%\" }, /* @__PURE__ */ u.createElement(\"defs\", null, /* @__PURE__ */ u.createElement(\"mask\", { id: `hole-${this.instanceId}` }, /* @__PURE__ */ u.createElement(\"rect\", { width: \"100%\", height: \"100%\", fill: \"white\" }), t ? /* @__PURE__ */ u.createElement(\n      \"ellipse\",\n      {\n        cx: `${r.x + r.width / 2}${r.unit}`,\n        cy: `${r.y + r.height / 2}${r.unit}`,\n        rx: `${r.width / 2}${r.unit}`,\n        ry: `${r.height / 2}${r.unit}`,\n        fill: \"black\"\n      }\n    ) : /* @__PURE__ */ u.createElement(\n      \"rect\",\n      {\n        x: `${r.x}${r.unit}`,\n        y: `${r.y}${r.unit}`,\n        width: `${r.width}${r.unit}`,\n        height: `${r.height}${r.unit}`,\n        fill: \"black\"\n      }\n    ))), /* @__PURE__ */ u.createElement(\"rect\", { fill: \"black\", fillOpacity: 0.5, width: \"100%\", height: \"100%\", mask: `url(#hole-${this.instanceId})` })) : void 0, p);\n  }\n};\nm(x, \"xOrds\", [\"e\", \"w\"]), m(x, \"yOrds\", [\"n\", \"s\"]), m(x, \"xyOrds\", [\"nw\", \"ne\", \"se\", \"sw\"]), m(x, \"nudgeStep\", 1), m(x, \"nudgeStepMedium\", 10), m(x, \"nudgeStepLarge\", 100), m(x, \"defaultProps\", {\n  ariaLabels: {\n    cropArea: \"Use the arrow keys to move the crop selection area\",\n    nwDragHandle: \"Use the arrow keys to move the north west drag handle to change the crop selection area\",\n    nDragHandle: \"Use the up and down arrow keys to move the north drag handle to change the crop selection area\",\n    neDragHandle: \"Use the arrow keys to move the north east drag handle to change the crop selection area\",\n    eDragHandle: \"Use the up and down arrow keys to move the east drag handle to change the crop selection area\",\n    seDragHandle: \"Use the arrow keys to move the south east drag handle to change the crop selection area\",\n    sDragHandle: \"Use the up and down arrow keys to move the south drag handle to change the crop selection area\",\n    swDragHandle: \"Use the arrow keys to move the south west drag handle to change the crop selection area\",\n    wDragHandle: \"Use the up and down arrow keys to move the west drag handle to change the crop selection area\"\n  }\n});\nlet S = x;\nexport {\n  S as Component,\n  S as ReactCrop,\n  X as areCropsEqual,\n  L as centerCrop,\n  b as clamp,\n  H as cls,\n  k as containCrop,\n  v as convertToPercentCrop,\n  D as convertToPixelCrop,\n  S as default,\n  E as defaultCrop,\n  B as makeAspectCrop,\n  I as nudgeCrop\n};\n","import { useState, useRef, useCallback, useEffect } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport ReactCrop, { Crop, PixelCrop, centerCrop, makeAspectCrop } from \"react-image-crop\";\r\nimport \"react-image-crop/dist/ReactCrop.css\";\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogDescription,\r\n  DialogFooter,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Crop as CropIcon, Info, Maximize2 } from \"lucide-react\";\r\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\r\n\r\ninterface ImageCropDialogProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  imageFile: File;\r\n  onCropComplete: (croppedFile: File, preview: string) => void;\r\n}\r\n\r\n// Recommended dimensions for activity images\r\nconst RECOMMENDED_WIDTH = 1200;\r\nconst RECOMMENDED_HEIGHT = 630;\r\nconst ASPECT_RATIO = RECOMMENDED_WIDTH / RECOMMENDED_HEIGHT;\r\n\r\nfunction centerAspectCrop(\r\n  mediaWidth: number,\r\n  mediaHeight: number,\r\n  aspect: number,\r\n) {\r\n  return centerCrop(\r\n    makeAspectCrop(\r\n      {\r\n        unit: '%',\r\n        width: 90,\r\n      },\r\n      aspect,\r\n      mediaWidth,\r\n      mediaHeight,\r\n    ),\r\n    mediaWidth,\r\n    mediaHeight,\r\n  );\r\n}\r\n\r\nexport function ImageCropDialog({\r\n  open,\r\n  onOpenChange,\r\n  imageFile,\r\n  onCropComplete,\r\n}: ImageCropDialogProps) {\r\n  const { t } = useTranslation();\r\n  const [imgSrc, setImgSrc] = useState(\"\");\r\n  const [crop, setCrop] = useState<Crop>();\r\n  const [completedCrop, setCompletedCrop] = useState<PixelCrop>();\r\n  const imgRef = useRef<HTMLImageElement>(null);\r\n  const [isCropping, setIsCropping] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (open && imageFile) {\r\n      const reader = new FileReader();\r\n      reader.addEventListener(\"load\", () => {\r\n        setImgSrc(reader.result?.toString() || \"\");\r\n      });\r\n      reader.readAsDataURL(imageFile);\r\n    }\r\n  }, [open, imageFile]);\r\n\r\n  const onImageLoad = useCallback((e: React.SyntheticEvent<HTMLImageElement>) => {\r\n    const { width, height } = e.currentTarget;\r\n    setCrop(centerAspectCrop(width, height, ASPECT_RATIO));\r\n  }, []);\r\n\r\n  const getCroppedImg = useCallback(\r\n    async (image: HTMLImageElement, crop: PixelCrop): Promise<Blob> => {\r\n      const canvas = document.createElement(\"canvas\");\r\n      const ctx = canvas.getContext(\"2d\");\r\n\r\n      if (!ctx) {\r\n        throw new Error(\"No 2d context\");\r\n      }\r\n\r\n      const scaleX = image.naturalWidth / image.width;\r\n      const scaleY = image.naturalHeight / image.height;\r\n\r\n      // Set canvas size to match the crop area\r\n      canvas.width = crop.width * scaleX;\r\n      canvas.height = crop.height * scaleY;\r\n\r\n      ctx.imageSmoothingQuality = \"high\";\r\n\r\n      ctx.drawImage(\r\n        image,\r\n        crop.x * scaleX,\r\n        crop.y * scaleY,\r\n        crop.width * scaleX,\r\n        crop.height * scaleY,\r\n        0,\r\n        0,\r\n        canvas.width,\r\n        canvas.height\r\n      );\r\n\r\n      return new Promise((resolve, reject) => {\r\n        canvas.toBlob(\r\n          (blob) => {\r\n            if (!blob) {\r\n              reject(new Error(\"Canvas is empty\"));\r\n              return;\r\n            }\r\n            resolve(blob);\r\n          },\r\n          \"image/jpeg\",\r\n          0.95\r\n        );\r\n      });\r\n    },\r\n    []\r\n  );\r\n\r\n  const handleCropConfirm = useCallback(async () => {\r\n    if (!completedCrop || !imgRef.current) return;\r\n\r\n    setIsCropping(true);\r\n    try {\r\n      const croppedBlob = await getCroppedImg(imgRef.current, completedCrop);\r\n      const croppedFile = new File([croppedBlob], imageFile.name, {\r\n        type: \"image/jpeg\",\r\n      });\r\n\r\n      // Create preview URL\r\n      const previewUrl = URL.createObjectURL(croppedBlob);\r\n\r\n      onCropComplete(croppedFile, previewUrl);\r\n      onOpenChange(false);\r\n    } catch (error) {\r\n      console.error(\"Error cropping image:\", error);\r\n    } finally {\r\n      setIsCropping(false);\r\n    }\r\n  }, [completedCrop, imageFile, onCropComplete, onOpenChange, getCroppedImg]);\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={onOpenChange}>\r\n      <DialogContent className=\"max-w-[95vw] sm:max-w-4xl max-h-[95vh] overflow-hidden flex flex-col p-0\">\r\n        <DialogHeader className=\"px-4 sm:px-6 pt-4 sm:pt-6 pb-4 border-b\">\r\n          <DialogTitle className=\"text-lg sm:text-xl flex items-center gap-2\">\r\n            <CropIcon className=\"w-5 h-5 text-primary\" />\r\n            {t(\"admin.cropImage\")}\r\n          </DialogTitle>\r\n          <DialogDescription className=\"text-xs sm:text-sm\">\r\n            {t(\"admin.cropImageDescription\")}\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        <div className=\"px-4 sm:px-6 py-4 space-y-4 overflow-y-auto\">\r\n          <Alert className=\"border-primary/20 bg-primary/5\">\r\n            <Info className=\"h-4 w-4\" />\r\n            <AlertDescription className=\"text-xs sm:text-sm\">\r\n              <div className=\"flex flex-col sm:flex-row sm:items-center gap-2\">\r\n                <span className=\"font-medium\">{t(\"admin.recommendedSize\")}:</span>\r\n                <Badge variant=\"secondary\" className=\"w-fit\">\r\n                  <Maximize2 className=\"w-3 h-3 mr-1\" />\r\n                  {RECOMMENDED_WIDTH} × {RECOMMENDED_HEIGHT} px\r\n                </Badge>\r\n              </div>\r\n              <p className=\"mt-2 text-muted-foreground text-xs\">\r\n                {t(\"admin.imageSizeHint\")}\r\n              </p>\r\n            </AlertDescription>\r\n          </Alert>\r\n\r\n          <div className=\"relative w-full overflow-hidden rounded-lg border\">\r\n            {imgSrc && (\r\n              <ReactCrop\r\n                crop={crop}\r\n                onChange={(c) => setCrop(c)}\r\n                onComplete={(c) => setCompletedCrop(c)}\r\n                aspect={ASPECT_RATIO}\r\n                className=\"max-h-[50vh] sm:max-h-[60vh]\"\r\n              >\r\n                <img\r\n                  ref={imgRef}\r\n                  src={imgSrc}\r\n                  alt=\"Crop preview\"\r\n                  onLoad={onImageLoad}\r\n                  className=\"max-w-full h-auto\"\r\n                />\r\n              </ReactCrop>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        <DialogFooter className=\"px-4 sm:px-6 pb-4 sm:pb-6 pt-4 border-t gap-2 sm:gap-0\">\r\n          <Button\r\n            type=\"button\"\r\n            variant=\"outline\"\r\n            onClick={() => onOpenChange(false)}\r\n            disabled={isCropping}\r\n            className=\"w-full sm:w-auto\"\r\n          >\r\n            {t(\"common.cancel\")}\r\n          </Button>\r\n          <Button\r\n            type=\"button\"\r\n            onClick={handleCropConfirm}\r\n            disabled={!completedCrop || isCropping}\r\n            className=\"w-full sm:w-auto\"\r\n          >\r\n            {isCropping ? t(\"common.processing\") : t(\"admin.confirmCrop\")}\r\n          </Button>\r\n        </DialogFooter>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}\r\n","import { useState, useEffect } from \"react\";\r\nimport { useForm, Controller } from \"react-hook-form\";\r\nimport { zodResolver } from \"@hookform/resolvers/zod\";\r\nimport * as z from \"zod\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Calendar } from \"@/components/ui/calendar\";\r\nimport { Popover, PopoverContent, PopoverTrigger } from \"@/components/ui/popover\";\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\r\nimport { Checkbox } from \"@/components/ui/checkbox\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\nimport { CalendarIcon, Upload, X, Globe, Pin, ArrowUpDown, Store, FileEdit, Send, Image, Video } from \"lucide-react\";\r\nimport { format } from \"date-fns\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { supabase } from \"@/integrations/supabase/client\";\r\nimport { toast } from \"sonner\";\r\nimport { useRestaurants } from \"@/hooks/useRestaurants\";\r\nimport { useQueryClient } from \"@tanstack/react-query\";\r\nimport { RichTextEditor } from \"./RichTextEditor\";\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Card, CardContent } from \"@/components/ui/card\";\r\nimport { ImageCropDialog } from \"./ImageCropDialog\";\r\nimport i18n from \"@/i18n/config\";\r\n\r\n// Draft schema - no required fields except status\r\nconst draftSchema = z.object({\r\n  title_en: z.string().optional(),\r\n  title_zh: z.string().optional(),\r\n  title_pt: z.string().optional(),\r\n  intro_zh: z.string().optional(),\r\n  intro_en: z.string().optional(),\r\n  intro_pt: z.string().optional(),\r\n  content_en: z.string().optional(),\r\n  content_zh: z.string().optional(),\r\n  content_pt: z.string().optional(),\r\n  usage_instructions_zh: z.string().optional(),\r\n  usage_instructions_en: z.string().optional(),\r\n  usage_instructions_pt: z.string().optional(),\r\n  start_date: z.date().optional(),\r\n  end_date: z.date().optional(),\r\n  repeat_mode: z.enum([\"none\", \"daily\", \"weekly\", \"monthly\", \"yearly\", \"days_before\"]).optional(),\r\n  repeat_weekday: z.number().min(0).max(6).optional().nullable(),\r\n  repeat_days_before: z.number().min(0).max(30).optional().nullable(),\r\n  service_type: z.enum([\"dine_in\", \"takeaway\", \"both\"]).optional(),\r\n  status: z.enum([\"draft\", \"published\"]).default(\"draft\"),\r\n  pinned: z.boolean().default(false),\r\n  visible: z.boolean().default(false),\r\n  sort_order: z.number().default(0),\r\n  badge_text_zh: z.string().optional(),\r\n  badge_text_en: z.string().optional(),\r\n  badge_text_pt: z.string().optional(),\r\n  badge_color: z.string().optional(),\r\n  discount_type: z.enum([\"percentage\", \"fixed_amount\"]).optional().nullable(),\r\n  discount_value: z.number().optional().nullable(),\r\n  discount_key: z.string().optional().nullable()\r\n});\r\n\r\n// Published schema - with required fields\r\nconst publishedSchema = z.object({\r\n  title_en: z.string().min(1, i18n.t(\"validation.titleRequired\")),\r\n  title_zh: z.string().min(1, i18n.t(\"validation.titleRequired\")),\r\n  title_pt: z.string().min(1, i18n.t(\"validation.titleRequired\")),\r\n  intro_zh: z.string().optional(),\r\n  intro_en: z.string().optional(),\r\n  intro_pt: z.string().optional(),\r\n  content_en: z.string().min(1, i18n.t(\"validation.contentRequired\")),\r\n  content_zh: z.string().min(1, i18n.t(\"validation.contentRequired\")),\r\n  content_pt: z.string().min(1, i18n.t(\"validation.contentRequired\")),\r\n  usage_instructions_zh: z.string().optional(),\r\n  usage_instructions_en: z.string().optional(),\r\n  usage_instructions_pt: z.string().optional(),\r\n  start_date: z.date(),\r\n  end_date: z.date().optional(),\r\n  repeat_mode: z.enum([\"none\", \"daily\", \"weekly\", \"monthly\", \"yearly\", \"days_before\"]),\r\n  repeat_weekday: z.number().min(0).max(6).optional().nullable(),\r\n  repeat_days_before: z.number().min(0).max(30).optional().nullable(),\r\n  service_type: z.enum([\"dine_in\", \"takeaway\", \"both\"]),\r\n  status: z.enum([\"draft\", \"published\"]).default(\"published\"),\r\n  pinned: z.boolean().default(false),\r\n  visible: z.boolean().default(true),\r\n  sort_order: z.number().default(0),\r\n  badge_text_zh: z.string().optional(),\r\n  badge_text_en: z.string().optional(),\r\n  badge_text_pt: z.string().optional(),\r\n  badge_color: z.string().optional(),\r\n  discount_type: z.enum([\"percentage\", \"fixed_amount\"]).optional().nullable(),\r\n  discount_value: z.number().optional().nullable(),\r\n  discount_key: z.string().optional().nullable()\r\n});\r\n\r\n// Base schema for form (uses draft schema, validation happens on submit)\r\nconst activitySchema = draftSchema;\r\ntype ActivityFormData = z.infer<typeof activitySchema>;\r\ninterface ActivityFormDialogProps {\r\n  activity?: any;\r\n  trigger: React.ReactNode;\r\n}\r\nexport function ActivityFormDialog({\r\n  activity,\r\n  trigger\r\n}: ActivityFormDialogProps) {\r\n  const {\r\n    t\r\n  } = useTranslation();\r\n  const queryClient = useQueryClient();\r\n  const [open, setOpen] = useState(false);\r\n  const [imageFile, setImageFile] = useState<File | null>(null);\r\n  const [imagePreview, setImagePreview] = useState<string | null>(activity?.image_url || null);\r\n  const [selectedRestaurants, setSelectedRestaurants] = useState<string[]>([]);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [showCropDialog, setShowCropDialog] = useState(false);\r\n  const [tempImageFile, setTempImageFile] = useState<File | null>(null);\r\n  const [mediaType, setMediaType] = useState<\"image\" | \"video\">(activity?.media_type === \"video\" ? \"video\" : \"image\");\r\n  const [videoFile, setVideoFile] = useState<File | null>(null);\r\n  const [videoPreview, setVideoPreview] = useState<string | null>(activity?.video_url || null);\r\n  const [isUploadingVideo, setIsUploadingVideo] = useState(false);\r\n  const [videoDeleted, setVideoDeleted] = useState(false);\r\n  const {\r\n    data: restaurants\r\n  } = useRestaurants();\r\n  const {\r\n    register,\r\n    handleSubmit,\r\n    formState: {\r\n      errors\r\n    },\r\n    setValue,\r\n    watch,\r\n    control\r\n  } = useForm<ActivityFormData>({\r\n    resolver: zodResolver(activitySchema),\r\n    defaultValues: activity ? {\r\n      title_en: activity.title_en,\r\n      title_zh: activity.title_zh,\r\n      title_pt: activity.title_pt,\r\n      intro_zh: activity.intro_zh || \"\",\r\n      intro_en: activity.intro_en || \"\",\r\n      intro_pt: activity.intro_pt || \"\",\r\n      content_en: activity.content_en,\r\n      content_zh: activity.content_zh,\r\n      content_pt: activity.content_pt,\r\n      usage_instructions_zh: activity.usage_instructions_zh || \"\",\r\n      usage_instructions_en: activity.usage_instructions_en || \"\",\r\n      usage_instructions_pt: activity.usage_instructions_pt || \"\",\r\n      start_date: new Date(activity.start_date),\r\n      end_date: activity.end_date ? new Date(activity.end_date) : undefined,\r\n      repeat_mode: activity.repeat_mode || \"none\",\r\n      repeat_weekday: activity.repeat_weekday ?? null,\r\n      repeat_days_before: activity.repeat_days_before ?? null,\r\n      service_type: activity.service_type || \"both\",\r\n      status: activity.status || \"draft\",\r\n      pinned: activity.pinned || false,\r\n      visible: activity.visible !== undefined ? activity.visible : true,\r\n      sort_order: activity.sort_order || 0,\r\n      badge_text_zh: activity.badge_text_zh || activity.title_zh,\r\n      badge_text_en: activity.badge_text_en || activity.title_en,\r\n      badge_text_pt: activity.badge_text_pt || activity.title_pt,\r\n      badge_color: activity.badge_color || \"#9b87f5\",\r\n      discount_type: activity.discount_type || null,\r\n      discount_value: activity.discount_value || null,\r\n      discount_key: activity.discount_key || null\r\n    } : {\r\n      repeat_mode: \"none\",\r\n      repeat_weekday: null,\r\n      repeat_days_before: null,\r\n      service_type: \"both\",\r\n      status: \"draft\",\r\n      pinned: false,\r\n      visible: false, // Draft starts with visible=false\r\n      sort_order: 0,\r\n      badge_color: \"#9b87f5\",\r\n      discount_type: null,\r\n      discount_value: null,\r\n      discount_key: null\r\n    }\r\n  });\r\n  const startDate = watch(\"start_date\");\r\n  const endDate = watch(\"end_date\");\r\n  const pinned = watch(\"pinned\");\r\n  const visible = watch(\"visible\");\r\n  const status = watch(\"status\");\r\n\r\n  // Sync visible with status - draft always has visible=false\r\n  useEffect(() => {\r\n    if (status === \"draft\") {\r\n      setValue(\"visible\", false);\r\n      setValue(\"pinned\", false);\r\n    }\r\n  }, [status, setValue]);\r\n\r\n  // Load associated restaurants when editing\r\n  useEffect(() => {\r\n    const loadAssociatedRestaurants = async () => {\r\n      if (activity?.id) {\r\n        const {\r\n          data\r\n        } = await supabase.from(\"activity_restaurants\").select(\"restaurant_id\").eq(\"activity_id\", activity.id);\r\n        if (data) {\r\n          setSelectedRestaurants(data.map(ar => ar.restaurant_id));\r\n        }\r\n      }\r\n    };\r\n    loadAssociatedRestaurants();\r\n  }, [activity?.id]);\r\n  const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (file) {\r\n      // Check file size (max 10MB)\r\n      if (file.size > 10 * 1024 * 1024) {\r\n        toast.error(t(\"admin.imageTooBig\"));\r\n        return;\r\n      }\r\n      setTempImageFile(file);\r\n      setShowCropDialog(true);\r\n    }\r\n    // Reset input\r\n    e.target.value = \"\";\r\n  };\r\n\r\n  const handleCropComplete = (croppedFile: File, preview: string) => {\r\n    setImageFile(croppedFile);\r\n    setImagePreview(preview);\r\n  };\r\n\r\n  const handleVideoChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (file) {\r\n      // Check file size (max 100MB)\r\n      if (file.size > 100 * 1024 * 1024) {\r\n        toast.error(t(\"admin.videoTooBig\") || \"视频文件过大（最大100MB）\");\r\n        return;\r\n      }\r\n      // Check file type\r\n      if (!file.type.startsWith(\"video/\")) {\r\n        toast.error(t(\"admin.invalidVideoFormat\") || \"请上传视频文件\");\r\n        return;\r\n      }\r\n      setVideoFile(file);\r\n      setVideoPreview(URL.createObjectURL(file));\r\n      setVideoDeleted(false); // Reset deleted flag when new video is uploaded\r\n    }\r\n    e.target.value = \"\";\r\n  };\r\n\r\n  const uploadImage = async (): Promise<string | null> => {\r\n    if (!imageFile) return activity?.image_url || null;\r\n    const fileExt = imageFile.name.split(\".\").pop();\r\n    const fileName = `${Math.random()}.${fileExt}`;\r\n    const filePath = `${fileName}`;\r\n    const {\r\n      error: uploadError\r\n    } = await supabase.storage.from(\"activity-images\").upload(filePath, imageFile);\r\n    if (uploadError) {\r\n      throw uploadError;\r\n    }\r\n    const {\r\n      data: {\r\n        publicUrl\r\n      }\r\n    } = supabase.storage.from(\"activity-images\").getPublicUrl(filePath);\r\n    return publicUrl;\r\n  };\r\n\r\n  const uploadVideo = async (): Promise<string | null> => {\r\n    // If user explicitly deleted video, return null\r\n    if (videoDeleted && !videoFile) return null;\r\n    if (!videoFile) return activity?.video_url || null;\r\n    setIsUploadingVideo(true);\r\n    try {\r\n      const fileExt = videoFile.name.split(\".\").pop();\r\n      const fileName = `video_${Date.now()}.${fileExt}`;\r\n      const { error: uploadError } = await supabase.storage\r\n        .from(\"activity-images\")\r\n        .upload(fileName, videoFile);\r\n      if (uploadError) throw uploadError;\r\n      const { data: { publicUrl } } = supabase.storage\r\n        .from(\"activity-images\")\r\n        .getPublicUrl(fileName);\r\n      return publicUrl;\r\n    } finally {\r\n      setIsUploadingVideo(false);\r\n    }\r\n  };\r\n  const onSubmit = async (data: ActivityFormData) => {\r\n    setIsSubmitting(true);\r\n    try {\r\n      // If publishing, validate with publishedSchema\r\n      if (data.status === \"published\") {\r\n        const publishedResult = publishedSchema.safeParse(data);\r\n        if (!publishedResult.success) {\r\n          // Map field names to readable labels\r\n          const fieldLabels: Record<string, string> = {\r\n            title_zh: t(\"admin.titleChinese\"),\r\n            title_en: t(\"admin.titleEnglish\"),\r\n            title_pt: t(\"admin.titlePortuguese\"),\r\n            content_zh: t(\"admin.contentChinese\"),\r\n            content_en: t(\"admin.contentEnglish\"),\r\n            content_pt: t(\"admin.contentPortuguese\"),\r\n            start_date: t(\"admin.startDate\"),\r\n            end_date: t(\"admin.endDate\"),\r\n            repeat_mode: t(\"admin.repeatMode\"),\r\n            service_type: t(\"admin.serviceType\")\r\n          };\r\n          \r\n          // Collect all missing fields\r\n          const missingFields = publishedResult.error.errors.map(err => {\r\n            const fieldPath = err.path.join(\".\");\r\n            return fieldLabels[fieldPath] || fieldPath;\r\n          });\r\n          \r\n          // Show all missing fields in toast\r\n          toast.error(`${t(\"admin.publishRequiresComplete\")}: ${missingFields.join(\", \")}`);\r\n          setIsSubmitting(false);\r\n          return;\r\n        }\r\n      }\r\n\r\n      const {\r\n        data: {\r\n          user\r\n        }\r\n      } = await supabase.auth.getUser();\r\n      if (!user) throw new Error(\"Not authenticated\");\r\n      // Upload image and video in parallel for better performance\r\n      const [imageUrl, videoUrl] = await Promise.all([\r\n        uploadImage(),\r\n        uploadVideo()\r\n      ]);\r\n\r\n      // Draft activities always have visible=false\r\n      const finalVisible = data.status === \"draft\" ? false : data.visible;\r\n\r\n      const activityData = {\r\n        title_en: data.title_en || \"\",\r\n        title_zh: data.title_zh || \"\",\r\n        title_pt: data.title_pt || \"\",\r\n        intro_zh: data.intro_zh || null,\r\n        intro_en: data.intro_en || null,\r\n        intro_pt: data.intro_pt || null,\r\n        content_en: data.content_en || \"\",\r\n        content_zh: data.content_zh || \"\",\r\n        content_pt: data.content_pt || \"\",\r\n        usage_instructions_zh: data.usage_instructions_zh || null,\r\n        usage_instructions_en: data.usage_instructions_en || null,\r\n        usage_instructions_pt: data.usage_instructions_pt || null,\r\n        repeat_mode: data.repeat_mode || \"none\",\r\n        repeat_weekday: data.repeat_mode === 'weekly' ? data.repeat_weekday : null,\r\n        repeat_days_before: data.repeat_mode === 'days_before' ? data.repeat_days_before : null,\r\n        service_type: data.service_type || \"both\",\r\n        status: data.status,\r\n        pinned: data.status === \"draft\" ? false : data.pinned,\r\n        visible: finalVisible,\r\n        sort_order: data.sort_order,\r\n        image_url: imageUrl,\r\n        media_type: mediaType,\r\n        video_url: videoUrl,\r\n        creator_id: user.id,\r\n        start_date: data.start_date?.toISOString() || new Date().toISOString(),\r\n        end_date: data.end_date?.toISOString() || null,\r\n        badge_text_zh: data.badge_text_zh || data.title_zh || \"\",\r\n        badge_text_en: data.badge_text_en || data.title_en || \"\",\r\n        badge_text_pt: data.badge_text_pt || data.title_pt || \"\",\r\n        badge_color: data.badge_color || \"#9b87f5\",\r\n        discount_type: data.discount_type || null,\r\n        discount_value: data.discount_value || null,\r\n        discount_key: data.discount_key || null\r\n      };\r\n      if (activity) {\r\n        // Update activity\r\n        const {\r\n          error\r\n        } = await supabase.from(\"activities\").update(activityData).eq(\"id\", activity.id);\r\n        if (error) throw error;\r\n\r\n        // Update restaurant associations\r\n        await supabase.from(\"activity_restaurants\").delete().eq(\"activity_id\", activity.id);\r\n        if (selectedRestaurants.length > 0) {\r\n          const associations = selectedRestaurants.map(restaurantId => ({\r\n            activity_id: activity.id,\r\n            restaurant_id: restaurantId\r\n          }));\r\n          const {\r\n            error: assocError\r\n          } = await supabase.from(\"activity_restaurants\").insert(associations);\r\n          if (assocError) throw assocError;\r\n        }\r\n        toast.success(t(\"admin.activityUpdated\"));\r\n        setOpen(false);\r\n      } else {\r\n        // Create activity\r\n        const {\r\n          data: newActivity,\r\n          error\r\n        } = await supabase.from(\"activities\").insert([activityData]).select().single();\r\n        if (error) throw error;\r\n\r\n        // Add restaurant associations\r\n        if (selectedRestaurants.length > 0) {\r\n          const associations = selectedRestaurants.map(restaurantId => ({\r\n            activity_id: newActivity.id,\r\n            restaurant_id: restaurantId\r\n          }));\r\n          const {\r\n            error: assocError\r\n          } = await supabase.from(\"activity_restaurants\").insert(associations);\r\n          if (assocError) throw assocError;\r\n        }\r\n\r\n        // Auto-link coupon templates with auto_link_activities enabled\r\n        const { data: autoLinkTemplates } = await supabase\r\n          .from(\"coupon_templates\")\r\n          .select(\"id\")\r\n          .eq(\"auto_link_activities\", true)\r\n          .eq(\"is_active\", true);\r\n\r\n        if (autoLinkTemplates && autoLinkTemplates.length > 0) {\r\n          const couponAssociations = autoLinkTemplates.map(template => ({\r\n            coupon_template_id: template.id,\r\n            activity_id: newActivity.id\r\n          }));\r\n          await supabase\r\n            .from(\"coupon_template_activities\")\r\n            .insert(couponAssociations);\r\n        }\r\n\r\n        toast.success(t(\"admin.activityCreated\"));\r\n        setOpen(false);\r\n      }\r\n      queryClient.invalidateQueries({\r\n        queryKey: [\"activities\"]\r\n      });\r\n    } catch (error: any) {\r\n      toast.error(error.message || t(\"common.error\"));\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n  return <Dialog open={open} onOpenChange={setOpen}>\r\n      <DialogTrigger asChild>{trigger}</DialogTrigger>\r\n      <DialogContent className=\"max-w-[95vw] sm:max-w-6xl max-h-[95vh] overflow-hidden flex flex-col p-0\">\r\n        <DialogHeader className=\"px-6 pt-6 pb-4 border-b bg-muted/30\">\r\n          <DialogTitle className=\"text-2xl flex items-center gap-2\">\r\n            <Globe className=\"w-6 h-6 text-primary\" />\r\n            {activity ? t(\"admin.editActivity\") : t(\"admin.addActivity\")}\r\n          </DialogTitle>\r\n          <DialogDescription className=\"text-base\">\r\n            {activity ? t(\"admin.editActivityDetails\") : t(\"admin.createActivityWithContent\")}\r\n          </DialogDescription>\r\n        </DialogHeader>\r\n\r\n        <ScrollArea className=\"px-6 h-[calc(95vh-220px)]\">\r\n          <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-6 py-6\">\r\n            {/* Media Upload */}\r\n            <Card className=\"border-primary/20 bg-gradient-to-br from-background to-muted/20\">\r\n              <CardContent className=\"p-6\">\r\n                <Label className=\"text-base font-semibold flex items-center gap-2 mb-4\">\r\n                  <Upload className=\"w-5 h-5 text-primary\" />\r\n                  {t(\"admin.activityMedia\") || \"活动媒体\"}\r\n                </Label>\r\n                \r\n                {/* Media Type Selector */}\r\n                <div className=\"flex gap-2 mb-4\">\r\n                  <Button\r\n                    type=\"button\"\r\n                    variant={mediaType === \"image\" ? \"default\" : \"outline\"}\r\n                    size=\"sm\"\r\n                    onClick={() => setMediaType(\"image\")}\r\n                    className=\"flex items-center gap-2\"\r\n                  >\r\n                    <Image className=\"w-4 h-4\" />\r\n                    {t(\"admin.image\") || \"图片\"}\r\n                  </Button>\r\n                  <Button\r\n                    type=\"button\"\r\n                    variant={mediaType === \"video\" ? \"default\" : \"outline\"}\r\n                    size=\"sm\"\r\n                    onClick={() => setMediaType(\"video\")}\r\n                    className=\"flex items-center gap-2\"\r\n                  >\r\n                    <Video className=\"w-4 h-4\" />\r\n                    {t(\"admin.video\") || \"视频\"}\r\n                  </Button>\r\n                </div>\r\n\r\n                {/* Image Upload */}\r\n                {mediaType === \"image\" && (\r\n                  <div className=\"flex items-center gap-6\">\r\n                    {imagePreview && (\r\n                      <div className=\"relative group\">\r\n                        <img src={imagePreview} alt=\"Preview\" className=\"w-40 h-40 object-cover rounded-lg shadow-lg ring-2 ring-primary/20 transition-transform duration-200 group-hover:scale-105\" />\r\n                        <Button type=\"button\" variant=\"destructive\" size=\"icon\" className=\"absolute -top-2 -right-2 h-8 w-8 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity\" onClick={() => {\r\n                          setImageFile(null);\r\n                          setImagePreview(null);\r\n                        }}>\r\n                          <X className=\"h-4 w-4\" />\r\n                        </Button>\r\n                      </div>\r\n                    )}\r\n                    <Label htmlFor=\"image-upload\" className=\"cursor-pointer\">\r\n                      <div className=\"flex flex-col items-center gap-3 px-8 py-6 border-2 border-dashed border-primary/30 rounded-lg hover:border-primary hover:bg-primary/5 transition-all duration-200\">\r\n                        <Upload className=\"h-8 w-8 text-primary\" />\r\n                        <div className=\"text-center\">\r\n                          <p className=\"font-medium text-sm\">{t(\"admin.uploadImage\")}</p>\r\n                          <p className=\"text-xs text-muted-foreground mt-1\">{t(\"admin.imageMaxSize\")}</p>\r\n                        </div>\r\n                      </div>\r\n                      <Input id=\"image-upload\" type=\"file\" accept=\"image/*\" className=\"hidden\" onChange={handleImageChange} />\r\n                    </Label>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Video Upload */}\r\n                {mediaType === \"video\" && (\r\n                  <div className=\"space-y-4\">\r\n                    <div className=\"flex items-center gap-6\">\r\n                      {videoPreview && (\r\n                        <div className=\"relative group\">\r\n                          <video \r\n                            src={videoPreview} \r\n                            className=\"w-40 h-40 object-cover rounded-lg shadow-lg ring-2 ring-primary/20\"\r\n                            muted\r\n                            loop\r\n                            playsInline\r\n                            onMouseEnter={(e) => e.currentTarget.play()}\r\n                            onMouseLeave={(e) => {\r\n                              e.currentTarget.pause();\r\n                              e.currentTarget.currentTime = 0;\r\n                            }}\r\n                          />\r\n                          <Button type=\"button\" variant=\"destructive\" size=\"icon\" className=\"absolute -top-2 -right-2 h-8 w-8 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity\" onClick={() => {\r\n                            setVideoFile(null);\r\n                            setVideoPreview(null);\r\n                            setVideoDeleted(true);\r\n                          }}>\r\n                            <X className=\"h-4 w-4\" />\r\n                          </Button>\r\n                        </div>\r\n                      )}\r\n                      <Label htmlFor=\"video-upload\" className=\"cursor-pointer\">\r\n                        <div className=\"flex flex-col items-center gap-3 px-8 py-6 border-2 border-dashed border-primary/30 rounded-lg hover:border-primary hover:bg-primary/5 transition-all duration-200\">\r\n                          <Video className=\"h-8 w-8 text-primary\" />\r\n                          <div className=\"text-center\">\r\n                            <p className=\"font-medium text-sm\">{t(\"admin.uploadVideo\") || \"上传视频\"}</p>\r\n                            <p className=\"text-xs text-muted-foreground mt-1\">{t(\"admin.videoMaxSize\") || \"最大 50MB\"}</p>\r\n                          </div>\r\n                        </div>\r\n                        <Input id=\"video-upload\" type=\"file\" accept=\"video/*\" className=\"hidden\" onChange={handleVideoChange} />\r\n                      </Label>\r\n                    </div>\r\n                    \r\n                    {/* Fallback Image for Video */}\r\n                    <div className=\"pt-4 border-t\">\r\n                      <Label className=\"text-sm font-medium mb-2 block\">{t(\"admin.fallbackImage\") || \"封面图片（可选）\"}</Label>\r\n                      <p className=\"text-xs text-muted-foreground mb-3\">{t(\"admin.fallbackImageDesc\") || \"视频加载前显示的封面图\"}</p>\r\n                      <div className=\"flex items-center gap-4\">\r\n                        {imagePreview && (\r\n                          <div className=\"relative group\">\r\n                            <img src={imagePreview} alt=\"Fallback\" className=\"w-20 h-20 object-cover rounded-lg shadow ring-2 ring-primary/20\" />\r\n                            <Button type=\"button\" variant=\"destructive\" size=\"icon\" className=\"absolute -top-1 -right-1 h-6 w-6 shadow opacity-0 group-hover:opacity-100 transition-opacity\" onClick={() => {\r\n                              setImageFile(null);\r\n                              setImagePreview(null);\r\n                            }}>\r\n                              <X className=\"h-3 w-3\" />\r\n                            </Button>\r\n                          </div>\r\n                        )}\r\n                        <Label htmlFor=\"fallback-image-upload\" className=\"cursor-pointer\">\r\n                          <div className=\"flex items-center gap-2 px-4 py-2 border border-dashed border-primary/30 rounded-lg hover:border-primary hover:bg-primary/5 transition-all text-sm\">\r\n                            <Image className=\"h-4 w-4 text-primary\" />\r\n                            <span>{t(\"admin.uploadFallback\") || \"上传封面\"}</span>\r\n                          </div>\r\n                          <Input id=\"fallback-image-upload\" type=\"file\" accept=\"image/*\" className=\"hidden\" onChange={handleImageChange} />\r\n                        </Label>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Multi-language Content with Tabs */}\r\n            <Card className=\"border-primary/20\">\r\n              <CardContent className=\"p-6\">\r\n                <Label className=\"text-base font-semibold flex items-center gap-2 mb-4\">\r\n                  <Globe className=\"w-5 h-5 text-primary\" />\r\n                  {t(\"admin.multilingualContent\")}\r\n                </Label>\r\n                <Tabs defaultValue=\"zh\" className=\"w-full\">\r\n                  <TabsList className=\"grid w-full grid-cols-3 mb-6\">\r\n                    <TabsTrigger value=\"zh\" className=\"gap-2\">\r\n                      🇨🇳 {t(\"admin.chinese\")}\r\n                    </TabsTrigger>\r\n                    <TabsTrigger value=\"en\" className=\"gap-2\">\r\n                      🇬🇧 {t(\"admin.english\")}\r\n                    </TabsTrigger>\r\n                    <TabsTrigger value=\"pt\" className=\"gap-2\">\r\n                      🇵🇹 {t(\"admin.portuguese\")}\r\n                    </TabsTrigger>\r\n                  </TabsList>\r\n                  \r\n                  <TabsContent value=\"zh\" className=\"space-y-4 mt-0\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"title_zh\" className=\"text-sm font-medium\">{t(\"admin.title\")}</Label>\r\n                      <Input id=\"title_zh\" {...register(\"title_zh\")} placeholder={t(\"admin.enterTitle\")} className=\"text-base\" />\r\n                      {errors.title_zh && <p className=\"text-sm text-destructive\">{errors.title_zh.message}</p>}\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"intro_zh\" className=\"text-sm font-medium\">活动简介</Label>\r\n                      <Input id=\"intro_zh\" {...register(\"intro_zh\")} placeholder=\"简短描述活动（显示在餐厅详情页）\" className=\"text-base\" />\r\n                      <p className=\"text-xs text-muted-foreground\">在餐厅详情页活动标签后显示的简短说明</p>\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"content_zh\" className=\"text-sm font-medium\">{t(\"admin.content\")}</Label>\r\n                      <Controller name=\"content_zh\" control={control} render={({\r\n                      field\r\n                    }) => <RichTextEditor value={field.value} onChange={field.onChange} placeholder={t(\"admin.enterContent\")} />} />\r\n                      {errors.content_zh && <p className=\"text-sm text-destructive\">{errors.content_zh.message}</p>}\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"usage_instructions_zh\" className=\"text-sm font-medium\">活动使用方法</Label>\r\n                      <Controller name=\"usage_instructions_zh\" control={control} render={({\r\n                      field\r\n                    }) => <RichTextEditor value={field.value || \"\"} onChange={field.onChange} placeholder=\"描述如何使用此活动（可选）\" />} />\r\n                      <p className=\"text-xs text-muted-foreground\">向用户说明如何参与和使用此活动</p>\r\n                    </div>\r\n                  </TabsContent>\r\n                  \r\n                  <TabsContent value=\"en\" className=\"space-y-4 mt-0\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"title_en\" className=\"text-sm font-medium\">{t(\"admin.title\")}</Label>\r\n                      <Input id=\"title_en\" {...register(\"title_en\")} placeholder={t(\"admin.enterTitle\")} className=\"text-base\" />\r\n                      {errors.title_en && <p className=\"text-sm text-destructive\">{errors.title_en.message}</p>}\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"intro_en\" className=\"text-sm font-medium\">Activity Brief</Label>\r\n                      <Input id=\"intro_en\" {...register(\"intro_en\")} placeholder=\"Short description (shown on restaurant details)\" className=\"text-base\" />\r\n                      <p className=\"text-xs text-muted-foreground\">Brief description shown after activity badge on restaurant page</p>\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"content_en\" className=\"text-sm font-medium\">{t(\"admin.content\")}</Label>\r\n                      <Controller name=\"content_en\" control={control} render={({\r\n                      field\r\n                    }) => <RichTextEditor value={field.value} onChange={field.onChange} placeholder={t(\"admin.enterContent\")} />} />\r\n                      {errors.content_en && <p className=\"text-sm text-destructive\">{errors.content_en.message}</p>}\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"usage_instructions_en\" className=\"text-sm font-medium\">Usage Instructions</Label>\r\n                      <Controller name=\"usage_instructions_en\" control={control} render={({\r\n                      field\r\n                    }) => <RichTextEditor value={field.value || \"\"} onChange={field.onChange} placeholder=\"Describe how to use this activity (optional)\" />} />\r\n                      <p className=\"text-xs text-muted-foreground\">Explain to users how to participate and use this activity</p>\r\n                    </div>\r\n                  </TabsContent>\r\n                  \r\n                  <TabsContent value=\"pt\" className=\"space-y-4 mt-0\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"title_pt\" className=\"text-sm font-medium\">{t(\"admin.title\")}</Label>\r\n                      <Input id=\"title_pt\" {...register(\"title_pt\")} placeholder={t(\"admin.enterTitle\")} className=\"text-base\" />\r\n                      {errors.title_pt && <p className=\"text-sm text-destructive\">{errors.title_pt.message}</p>}\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"intro_pt\" className=\"text-sm font-medium\">Resumo da Atividade</Label>\r\n                      <Input id=\"intro_pt\" {...register(\"intro_pt\")} placeholder=\"Descrição curta (exibida nos detalhes do restaurante)\" className=\"text-base\" />\r\n                      <p className=\"text-xs text-muted-foreground\">Breve descrição exibida após o distintivo da atividade na página do restaurante</p>\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"content_pt\" className=\"text-sm font-medium\">{t(\"admin.content\")}</Label>\r\n                      <Controller name=\"content_pt\" control={control} render={({\r\n                      field\r\n                    }) => <RichTextEditor value={field.value} onChange={field.onChange} placeholder={t(\"admin.enterContent\")} />} />\r\n                      {errors.content_pt && <p className=\"text-sm text-destructive\">{errors.content_pt.message}</p>}\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"usage_instructions_pt\" className=\"text-sm font-medium\">Instruções de Uso</Label>\r\n                      <Controller name=\"usage_instructions_pt\" control={control} render={({\r\n                      field\r\n                    }) => <RichTextEditor value={field.value || \"\"} onChange={field.onChange} placeholder=\"Descreva como usar esta atividade (opcional)\" />} />\r\n                      <p className=\"text-xs text-muted-foreground\">Explique aos usuários como participar e usar esta atividade</p>\r\n                    </div>\r\n                  </TabsContent>\r\n                </Tabs>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Date Range and Settings */}\r\n            <Card className=\"border-primary/20\">\r\n              <CardContent className=\"p-6 space-y-6\">\r\n                <div>\r\n                  <Label className=\"text-base font-semibold flex items-center gap-2 mb-4\">\r\n                    <CalendarIcon className=\"w-5 h-5 text-primary\" />\r\n                    {t(\"admin.dateSettings\")}\r\n                  </Label>\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label className=\"text-sm font-medium\">{t(\"admin.startDate\")}</Label>\r\n                      <Popover>\r\n                        <PopoverTrigger asChild>\r\n                          <Button variant=\"outline\" className={cn(\"w-full justify-start text-left font-normal h-11\", !startDate && \"text-muted-foreground\")}>\r\n                            <CalendarIcon className=\"mr-2 h-4 w-4\" />\r\n                            {startDate ? format(startDate, \"PPP\") : <span>{t(\"admin.selectDate\")}</span>}\r\n                          </Button>\r\n                        </PopoverTrigger>\r\n                        <PopoverContent className=\"w-auto p-0 z-[100]\" align=\"start\">\r\n                          <Calendar mode=\"single\" selected={startDate} onSelect={date => setValue(\"start_date\", date as Date)} initialFocus className=\"pointer-events-auto\" />\r\n                        </PopoverContent>\r\n                      </Popover>\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label className=\"text-sm font-medium\">{t(\"admin.endDate\")}</Label>\r\n                      <Popover>\r\n                        <PopoverTrigger asChild>\r\n                          <Button variant=\"outline\" className={cn(\"w-full justify-start text-left font-normal h-11\", !endDate && \"text-muted-foreground\")}>\r\n                            <CalendarIcon className=\"mr-2 h-4 w-4\" />\r\n                            {endDate ? format(endDate, \"PPP\") : <span>{t(\"admin.selectDate\")} ({t(\"admin.optional\")})</span>}\r\n                          </Button>\r\n                        </PopoverTrigger>\r\n                        <PopoverContent className=\"w-auto p-0 z-[100]\" align=\"start\">\r\n                          <Calendar mode=\"single\" selected={endDate} onSelect={date => setValue(\"end_date\", date)} initialFocus className=\"pointer-events-auto\" />\r\n                        </PopoverContent>\r\n                      </Popover>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"repeat_mode\" className=\"text-sm font-medium\">{t(\"admin.repeatMode\")}</Label>\r\n                  <Select onValueChange={value => setValue(\"repeat_mode\", value as any)} defaultValue={watch(\"repeat_mode\")}>\r\n                    <SelectTrigger className=\"h-11\">\r\n                      <SelectValue placeholder={t(\"admin.selectRepeatMode\")} />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"none\">{t(\"admin.repeatNone\")}</SelectItem>\r\n                      <SelectItem value=\"daily\">{t(\"admin.repeatDaily\")}</SelectItem>\r\n                      <SelectItem value=\"weekly\">{t(\"admin.repeatWeekly\")}</SelectItem>\r\n                      <SelectItem value=\"monthly\">{t(\"admin.repeatMonthly\")}</SelectItem>\r\n                      <SelectItem value=\"yearly\">{t(\"admin.repeatYearly\")}</SelectItem>\r\n                      <SelectItem value=\"days_before\">{t(\"admin.repeatDaysBefore\")}</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n                \r\n                {/* Weekday selector for weekly repeat mode */}\r\n                {watch(\"repeat_mode\") === \"weekly\" && (\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"repeat_weekday\" className=\"text-sm font-medium\">\r\n                      每周重复日 / Weekly on\r\n                    </Label>\r\n                    <Controller\r\n                      name=\"repeat_weekday\"\r\n                      control={control}\r\n                      render={({ field }) => (\r\n                        <Select \r\n                          value={field.value?.toString() || \"\"} \r\n                          onValueChange={(value) => field.onChange(value ? parseInt(value) : null)}\r\n                        >\r\n                          <SelectTrigger className=\"h-11\">\r\n                            <SelectValue placeholder=\"选择星期几 / Select day\" />\r\n                          </SelectTrigger>\r\n                          <SelectContent>\r\n                            <SelectItem value=\"1\">周一 / Monday</SelectItem>\r\n                            <SelectItem value=\"2\">周二 / Tuesday</SelectItem>\r\n                            <SelectItem value=\"3\">周三 / Wednesday</SelectItem>\r\n                            <SelectItem value=\"4\">周四 / Thursday</SelectItem>\r\n                            <SelectItem value=\"5\">周五 / Friday</SelectItem>\r\n                            <SelectItem value=\"6\">周六 / Saturday</SelectItem>\r\n                            <SelectItem value=\"0\">周日 / Sunday</SelectItem>\r\n                          </SelectContent>\r\n                        </Select>\r\n                      )}\r\n                    />\r\n                    <p className=\"text-xs text-muted-foreground\">\r\n                      选择活动每周生效的日期 / Select which day this activity is valid each week\r\n                    </p>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Days before selector for days_before repeat mode */}\r\n                {watch(\"repeat_mode\") === \"days_before\" && (\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"repeat_days_before\" className=\"text-sm font-medium\">\r\n                      {t(\"admin.daysBeforeLabel\")}\r\n                    </Label>\r\n                    <Controller\r\n                      name=\"repeat_days_before\"\r\n                      control={control}\r\n                      render={({ field }) => (\r\n                        <Input\r\n                          type=\"number\"\r\n                          min={1}\r\n                          max={30}\r\n                          className=\"h-11\"\r\n                          placeholder={t(\"admin.daysBeforePlaceholder\")}\r\n                          value={field.value ?? \"\"}\r\n                          onChange={(e) => field.onChange(e.target.value ? parseInt(e.target.value) : null)}\r\n                        />\r\n                      )}\r\n                    />\r\n                    <p className=\"text-xs text-muted-foreground\">\r\n                      {t(\"admin.daysBeforeHint\")}\r\n                    </p>\r\n                  </div>\r\n                )}\r\n\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"service_type\" className=\"text-sm font-medium\">{t(\"admin.serviceType\")}</Label>\r\n                  <Select onValueChange={value => setValue(\"service_type\", value as any)} defaultValue={watch(\"service_type\")}>\r\n                    <SelectTrigger className=\"h-11\">\r\n                      <SelectValue placeholder={t(\"admin.selectServiceType\")} />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"dine_in\">{t(\"activities.serviceType.dine_in\")}</SelectItem>\r\n                      <SelectItem value=\"takeaway\">{t(\"activities.serviceType.takeaway\")}</SelectItem>\r\n                      <SelectItem value=\"both\">{t(\"activities.serviceType.both\")}</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n                  {/* Status Selector */}\r\n                  <div className=\"space-y-2\">\r\n                    <Label className=\"text-sm font-medium flex items-center gap-2\">\r\n                      {watch(\"status\") === \"draft\" ? (\r\n                        <FileEdit className=\"w-4 h-4 text-yellow-500\" />\r\n                      ) : (\r\n                        <Send className=\"w-4 h-4 text-green-500\" />\r\n                      )}\r\n                      活动状态\r\n                    </Label>\r\n                    <Select onValueChange={value => setValue(\"status\", value as \"draft\" | \"published\")} value={status || \"draft\"}>\r\n                      <SelectTrigger className=\"h-11\">\r\n                        <SelectValue />\r\n                      </SelectTrigger>\r\n                      <SelectContent>\r\n                        <SelectItem value=\"draft\">\r\n                          <span className=\"flex items-center gap-2\">\r\n                            <FileEdit className=\"w-4 h-4 text-yellow-500\" />\r\n                            草稿\r\n                          </span>\r\n                        </SelectItem>\r\n                        <SelectItem value=\"published\">\r\n                          <span className=\"flex items-center gap-2\">\r\n                            <Send className=\"w-4 h-4 text-green-500\" />\r\n                            已发布\r\n                          </span>\r\n                        </SelectItem>\r\n                      </SelectContent>\r\n                    </Select>\r\n                    <p className=\"text-xs text-muted-foreground\">\r\n                      {status === \"draft\" \r\n                        ? \"草稿状态：无必填项，不显示在前端，餐厅不会收到通知\" \r\n                        : \"发布时将验证必填项\"}\r\n                    </p>\r\n                  </div>\r\n\r\n                  <div className={cn(\r\n                    \"flex items-center space-x-3 p-4 border rounded-lg transition-colors h-fit self-end\",\r\n                    status === \"draft\" ? \"opacity-50 cursor-not-allowed bg-muted/30\" : \"hover:bg-muted/50\"\r\n                  )}>\r\n                    <Checkbox \r\n                      id=\"pinned\" \r\n                      checked={pinned} \r\n                      onCheckedChange={(checked) => setValue(\"pinned\", checked === true)} \r\n                      className=\"data-[state=checked]:bg-primary\"\r\n                      disabled={status === \"draft\"}\r\n                    />\r\n                    <Label htmlFor=\"pinned\" className={cn(\r\n                      \"flex items-center gap-2 text-sm font-medium\",\r\n                      status === \"draft\" ? \"cursor-not-allowed\" : \"cursor-pointer\"\r\n                    )}>\r\n                      <Pin className=\"w-4 h-4 text-primary\" />\r\n                      {t(\"admin.pinToTop\")}\r\n                    </Label>\r\n                  </div>\r\n                  <div className={cn(\r\n                    \"flex items-center space-x-3 p-4 border rounded-lg transition-colors h-fit self-end\",\r\n                    status === \"draft\" ? \"opacity-50 cursor-not-allowed bg-muted/30\" : \"hover:bg-muted/50\"\r\n                  )}>\r\n                    <Checkbox \r\n                      id=\"visible\" \r\n                      checked={visible} \r\n                      onCheckedChange={(checked) => setValue(\"visible\", checked === true)} \r\n                      className=\"data-[state=checked]:bg-primary\"\r\n                      disabled={status === \"draft\"}\r\n                    />\r\n                    <Label htmlFor=\"visible\" className={cn(\r\n                      \"flex items-center gap-2 text-sm font-medium\",\r\n                      status === \"draft\" ? \"cursor-not-allowed\" : \"cursor-pointer\"\r\n                    )}>\r\n                      <Globe className=\"w-4 h-4 text-primary\" />\r\n                      显示活动\r\n                      {status === \"draft\" && <span className=\"text-xs text-muted-foreground\">(草稿默认关闭)</span>}\r\n                    </Label>\r\n                  </div>\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"sort_order\" className=\"text-sm font-medium flex items-center gap-2\">\r\n                      <ArrowUpDown className=\"w-4 h-4 text-primary\" />\r\n                      {t(\"admin.sortOrder\")}\r\n                    </Label>\r\n                    <Input id=\"sort_order\" type=\"number\" {...register(\"sort_order\", {\r\n                    valueAsNumber: true\r\n                  })} className=\"h-11\" placeholder=\"0\" />\r\n                  </div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Badge Display Settings */}\r\n            <Card className=\"border-primary/20\">\r\n              <CardContent className=\"p-6\">\r\n                <Label className=\"text-base font-semibold flex items-center gap-2 mb-4\">\r\n                  <Badge className=\"w-5 h-5 text-primary\" />\r\n                  显示徽章设置\r\n                </Label>\r\n                <Tabs defaultValue=\"zh\" className=\"w-full\">\r\n                  <TabsList className=\"grid w-full grid-cols-3 mb-4\">\r\n                    <TabsTrigger value=\"zh\">🇨🇳 中文</TabsTrigger>\r\n                    <TabsTrigger value=\"en\">🇬🇧 English</TabsTrigger>\r\n                    <TabsTrigger value=\"pt\">🇵🇹 Português</TabsTrigger>\r\n                  </TabsList>\r\n                  \r\n                  <TabsContent value=\"zh\" className=\"space-y-3\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"badge_text_zh\" className=\"text-sm\">徽章文字 (中文) <span className=\"text-destructive\">*</span></Label>\r\n                      <Input id=\"badge_text_zh\" {...register(\"badge_text_zh\")} placeholder=\"例如: 粉丝节\" />\r\n                      {errors.badge_text_zh && <p className=\"text-sm text-destructive\">{errors.badge_text_zh.message}</p>}\r\n                      <p className=\"text-xs text-muted-foreground\">徽章文字显示在餐厅详情和活动列表中，建议简洁明了</p>\r\n                    </div>\r\n                  </TabsContent>\r\n                  \r\n                  <TabsContent value=\"en\" className=\"space-y-3\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"badge_text_en\" className=\"text-sm\">Badge Text (English) <span className=\"text-destructive\">*</span></Label>\r\n                      <Input id=\"badge_text_en\" {...register(\"badge_text_en\")} placeholder=\"e.g. Fan Festival\" />\r\n                      {errors.badge_text_en && <p className=\"text-sm text-destructive\">{errors.badge_text_en.message}</p>}\r\n                      <p className=\"text-xs text-muted-foreground\">Badge text shown on restaurant details and activity list, keep it concise</p>\r\n                    </div>\r\n                  </TabsContent>\r\n                  \r\n                  <TabsContent value=\"pt\" className=\"space-y-3\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"badge_text_pt\" className=\"text-sm\">Texto do Distintivo (Português) <span className=\"text-destructive\">*</span></Label>\r\n                      <Input id=\"badge_text_pt\" {...register(\"badge_text_pt\")} placeholder=\"ex: Festival dos Fãs\" />\r\n                      {errors.badge_text_pt && <p className=\"text-sm text-destructive\">{errors.badge_text_pt.message}</p>}\r\n                      <p className=\"text-xs text-muted-foreground\">Texto do emblema exibido nos detalhes do restaurante e na lista de atividades, mantenha-o conciso</p>\r\n                    </div>\r\n                  </TabsContent>\r\n                </Tabs>\r\n                \r\n                <div className=\"space-y-2 mt-4\">\r\n                  <Label htmlFor=\"badge_color\" className=\"text-sm\">徽章颜色 / Badge Color</Label>\r\n                  <Controller name=\"badge_color\" control={control} render={({\r\n                  field\r\n                }) => <div className=\"flex items-center gap-3\">\r\n                        <Input id=\"badge_color\" type=\"color\" value={field.value || \"#9b87f5\"} onChange={e => field.onChange(e.target.value)} className=\"w-20 h-11 cursor-pointer\" />\r\n                        <Input value={field.value || \"#9b87f5\"} onChange={e => field.onChange(e.target.value)} placeholder=\"#9b87f5\" className=\"flex-1\" />\r\n                      </div>} />\r\n                  <div className=\"flex items-center gap-2 mt-2\">\r\n                    <span className=\"text-xs text-muted-foreground\">预览 / Preview:</span>\r\n                    <Badge style={{\r\n                    backgroundColor: watch(\"badge_color\") || \"#9b87f5\"\r\n                  }} className=\"text-white\">\r\n                      {watch(\"badge_text_zh\") || watch(\"title_zh\") || \"示例\"}\r\n                    </Badge>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Discount Settings */}\r\n                <div className=\"border-t pt-4 mt-4\">\r\n                  <Label className=\"text-sm font-medium flex items-center gap-2 mb-3\">\r\n                    💰 优惠设置 / Discount Settings\r\n                  </Label>\r\n                  <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"discount_type\" className=\"text-sm\">折扣类型 / Discount Type</Label>\r\n                      <Controller \r\n                        name=\"discount_type\" \r\n                        control={control} \r\n                        render={({ field }) => (\r\n                          <Select \r\n                            value={field.value || \"none\"} \r\n                            onValueChange={(value) => field.onChange(value === \"none\" ? null : value)}\r\n                          >\r\n                            <SelectTrigger className=\"h-11\">\r\n                              <SelectValue placeholder=\"选择折扣类型\" />\r\n                            </SelectTrigger>\r\n                            <SelectContent>\r\n                              <SelectItem value=\"none\">无优惠 / No Discount</SelectItem>\r\n                              <SelectItem value=\"percentage\">百分比折扣 / Percentage</SelectItem>\r\n                              <SelectItem value=\"fixed_amount\">固定金额 / Fixed Amount</SelectItem>\r\n                            </SelectContent>\r\n                          </Select>\r\n                        )} \r\n                      />\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"discount_value\" className=\"text-sm\">\r\n                        折扣值 / Discount Value\r\n                        {watch(\"discount_type\") === \"percentage\" && \" (%)\"}\r\n                        {watch(\"discount_type\") === \"fixed_amount\" && \" (€)\"}\r\n                      </Label>\r\n                      <Input \r\n                        id=\"discount_value\" \r\n                        type=\"number\" \r\n                        step=\"0.01\"\r\n                        {...register(\"discount_value\", { valueAsNumber: true })} \r\n                        className=\"h-11\" \r\n                        placeholder={watch(\"discount_type\") === \"percentage\" ? \"例如: 20 (表示8折)\" : \"例如: 5 (表示减5€)\"}\r\n                        disabled={!watch(\"discount_type\")}\r\n                      />\r\n                      <p className=\"text-xs text-muted-foreground\">\r\n                        {watch(\"discount_type\") === \"percentage\" \r\n                          ? \"输入折扣百分比，如 20 表示打8折（减20%）\" \r\n                          : watch(\"discount_type\") === \"fixed_amount\"\r\n                          ? \"输入固定减免金额（欧元）\"\r\n                          : \"先选择折扣类型\"}\r\n                      </p>\r\n                    </div>\r\n                    \r\n                    {/* Discount Key */}\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"discount_key\" className=\"text-sm\">折扣标识 / Discount Key</Label>\r\n                      <Input \r\n                        id=\"discount_key\"\r\n                        type=\"text\"\r\n                        {...register(\"discount_key\")} \r\n                        className=\"h-11\" \r\n                        placeholder=\"例如: SUMMER2025, VIP_DISCOUNT\"\r\n                        disabled={!watch(\"discount_type\")}\r\n                      />\r\n                      <p className=\"text-xs text-muted-foreground\">\r\n                        用于外部系统识别的折扣标识符\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Associated Restaurants */}\r\n            <Card className=\"border-primary/20\">\r\n              <CardContent className=\"p-6\">\r\n                <Label className=\"text-base font-semibold flex items-center gap-2 mb-4\">\r\n                  <Store className=\"w-5 h-5 text-primary\" />\r\n                  {t(\"admin.associatedRestaurants\")}\r\n                </Label>\r\n                <ScrollArea className=\"h-64 border rounded-lg p-4 bg-muted/20\">\r\n                  <div className=\"space-y-2\">\r\n                    {restaurants?.map(restaurant => <div key={restaurant.id} className=\"flex items-center space-x-3 p-3 rounded-md hover:bg-background transition-colors border border-transparent hover:border-primary/30\">\r\n                        <Checkbox id={restaurant.id} checked={selectedRestaurants.includes(restaurant.id)} onCheckedChange={checked => {\r\n                      if (checked) {\r\n                        setSelectedRestaurants([...selectedRestaurants, restaurant.id]);\r\n                      } else {\r\n                        setSelectedRestaurants(selectedRestaurants.filter(id => id !== restaurant.id));\r\n                      }\r\n                    }} className=\"data-[state=checked]:bg-primary\" />\r\n                        <Label htmlFor={restaurant.id} className=\"cursor-pointer flex-1 font-normal\">\r\n                          {restaurant.name}\r\n                        </Label>\r\n                        {selectedRestaurants.includes(restaurant.id) && <Badge variant=\"secondary\" className=\"text-xs\">已选</Badge>}\r\n                      </div>)}\r\n                  </div>\r\n                </ScrollArea>\r\n                <p className=\"text-xs text-muted-foreground mt-2\">\r\n                  已选择 {selectedRestaurants.length} 个餐厅\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Submit Buttons */}\r\n            <div className=\"flex justify-end gap-3 pt-4 border-t sticky bottom-0 bg-background pb-[16px]\">\r\n              <Button type=\"button\" variant=\"outline\" onClick={() => setOpen(false)} className=\"min-w-[100px]\">\r\n                {t(\"common.cancel\")}\r\n              </Button>\r\n              <Button type=\"submit\" disabled={isSubmitting} className=\"min-w-[100px] bg-primary hover:bg-primary/90\">\r\n                {isSubmitting ? <>\r\n                    <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2\" />\r\n                    {t(\"common.saving\")}\r\n                  </> : t(\"common.save\")}\r\n              </Button>\r\n            </div>\r\n          </form>\r\n        </ScrollArea>\r\n\r\n        {/* Image Crop Dialog */}\r\n        {tempImageFile && (\r\n          <ImageCropDialog\r\n            open={showCropDialog}\r\n            onOpenChange={setShowCropDialog}\r\n            imageFile={tempImageFile}\r\n            onCropComplete={handleCropComplete}\r\n          />\r\n        )}\r\n      </DialogContent>\r\n    </Dialog>;\r\n}","import { useState, useEffect } from \"react\";\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger, DialogFooter } from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\nimport { useActivityRules, useUpdateActivityRules } from \"@/hooks/useActivityRules\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Loader2, FileText, Save } from \"lucide-react\";\r\nimport { toast } from \"@/hooks/use-toast\";\r\nimport { RichTextEditor } from \"./RichTextEditor\";\r\n\r\ninterface ActivityRulesEditorDialogProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\nconst ActivityRulesEditorDialog = ({ children }: ActivityRulesEditorDialogProps) => {\r\n  const { t } = useTranslation();\r\n  const { data: rules, isLoading } = useActivityRules();\r\n  const updateRules = useUpdateActivityRules();\r\n  const [open, setOpen] = useState(false);\r\n  const [activeTab, setActiveTab] = useState(\"zh\");\r\n  \r\n  const [contentZh, setContentZh] = useState(\"\");\r\n  const [contentEn, setContentEn] = useState(\"\");\r\n  const [contentPt, setContentPt] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    if (rules) {\r\n      setContentZh(rules.content_zh);\r\n      setContentEn(rules.content_en);\r\n      setContentPt(rules.content_pt);\r\n    }\r\n  }, [rules]);\r\n\r\n  const handleSave = async () => {\r\n    if (!rules) return;\r\n    \r\n    try {\r\n      await updateRules.mutateAsync({\r\n        id: rules.id,\r\n        content_zh: contentZh,\r\n        content_en: contentEn,\r\n        content_pt: contentPt,\r\n      });\r\n      toast({\r\n        title: t(\"common.success\"),\r\n        description: \"活动条例已更新\",\r\n      });\r\n      setOpen(false);\r\n    } catch (error) {\r\n      toast({\r\n        title: t(\"common.error\"),\r\n        description: \"更新失败\",\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={setOpen}>\r\n      <DialogTrigger asChild>\r\n        {children}\r\n      </DialogTrigger>\r\n      <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto\">\r\n        <DialogHeader>\r\n          <DialogTitle className=\"flex items-center gap-2\">\r\n            <FileText className=\"w-5 h-5\" />\r\n            编辑活动条例\r\n          </DialogTitle>\r\n        </DialogHeader>\r\n        \r\n        {isLoading ? (\r\n          <div className=\"flex justify-center py-8\">\r\n            <Loader2 className=\"w-6 h-6 animate-spin text-primary\" />\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-4\">\r\n            <Tabs value={activeTab} onValueChange={setActiveTab}>\r\n              <TabsList className=\"grid w-full grid-cols-3\">\r\n                <TabsTrigger value=\"zh\">中文</TabsTrigger>\r\n                <TabsTrigger value=\"en\">English</TabsTrigger>\r\n                <TabsTrigger value=\"pt\">Português</TabsTrigger>\r\n              </TabsList>\r\n              \r\n              <TabsContent value=\"zh\" className=\"mt-4\">\r\n                <RichTextEditor\r\n                  value={contentZh}\r\n                  onChange={setContentZh}\r\n                  placeholder=\"请输入中文活动条例内容...\"\r\n                />\r\n              </TabsContent>\r\n              \r\n              <TabsContent value=\"en\" className=\"mt-4\">\r\n                <RichTextEditor\r\n                  value={contentEn}\r\n                  onChange={setContentEn}\r\n                  placeholder=\"Enter English activity rules...\"\r\n                />\r\n              </TabsContent>\r\n              \r\n              <TabsContent value=\"pt\" className=\"mt-4\">\r\n                <RichTextEditor\r\n                  value={contentPt}\r\n                  onChange={setContentPt}\r\n                  placeholder=\"Digite as regras da atividade em português...\"\r\n                />\r\n              </TabsContent>\r\n            </Tabs>\r\n          </div>\r\n        )}\r\n        \r\n        <DialogFooter>\r\n          <Button variant=\"outline\" onClick={() => setOpen(false)}>\r\n            {t(\"common.cancel\")}\r\n          </Button>\r\n          <Button onClick={handleSave} disabled={updateRules.isPending}>\r\n            {updateRules.isPending ? (\r\n              <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\r\n            ) : (\r\n              <Save className=\"w-4 h-4 mr-2\" />\r\n            )}\r\n            {t(\"common.save\")}\r\n          </Button>\r\n        </DialogFooter>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default ActivityRulesEditorDialog;\r\n","import { useState, useEffect } from \"react\";\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger, DialogFooter } from \"@/components/ui/dialog\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\nimport { useGlobalHandbook, useUpdateGlobalHandbook } from \"@/hooks/useGlobalHandbook\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Loader2, BookOpen, Save } from \"lucide-react\";\r\nimport { toast } from \"@/hooks/use-toast\";\r\nimport { RichTextEditor } from \"./RichTextEditor\";\r\n\r\ninterface GlobalHandbookEditorDialogProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\nconst GlobalHandbookEditorDialog = ({ children }: GlobalHandbookEditorDialogProps) => {\r\n  const { t } = useTranslation();\r\n  const { data: handbook, isLoading } = useGlobalHandbook();\r\n  const updateHandbook = useUpdateGlobalHandbook();\r\n  const [open, setOpen] = useState(false);\r\n  const [activeTab, setActiveTab] = useState(\"zh\");\r\n  \r\n  const [contentZh, setContentZh] = useState(\"\");\r\n  const [contentEn, setContentEn] = useState(\"\");\r\n  const [contentPt, setContentPt] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    if (handbook) {\r\n      setContentZh(handbook.content_zh);\r\n      setContentEn(handbook.content_en);\r\n      setContentPt(handbook.content_pt);\r\n    }\r\n  }, [handbook]);\r\n\r\n  const handleSave = async () => {\r\n    if (!handbook) return;\r\n    \r\n    try {\r\n      await updateHandbook.mutateAsync({\r\n        id: handbook.id,\r\n        content_zh: contentZh,\r\n        content_en: contentEn,\r\n        content_pt: contentPt,\r\n      });\r\n      toast({\r\n        title: t(\"common.success\"),\r\n        description: t(\"activities.handbook.updateSuccess\"),\r\n      });\r\n      setOpen(false);\r\n    } catch (error) {\r\n      toast({\r\n        title: t(\"common.error\"),\r\n        description: t(\"activities.handbook.updateError\"),\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={setOpen}>\r\n      <DialogTrigger asChild>\r\n        {children}\r\n      </DialogTrigger>\r\n      <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto\">\r\n        <DialogHeader>\r\n          <DialogTitle className=\"flex items-center gap-2\">\r\n            <BookOpen className=\"w-5 h-5\" />\r\n            {t(\"admin.editActivityHandbook\")}\r\n          </DialogTitle>\r\n        </DialogHeader>\r\n        \r\n        {isLoading ? (\r\n          <div className=\"flex justify-center py-8\">\r\n            <Loader2 className=\"w-6 h-6 animate-spin text-primary\" />\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-4\">\r\n            <Tabs value={activeTab} onValueChange={setActiveTab}>\r\n              <TabsList className=\"grid w-full grid-cols-3\">\r\n                <TabsTrigger value=\"zh\">中文</TabsTrigger>\r\n                <TabsTrigger value=\"en\">English</TabsTrigger>\r\n                <TabsTrigger value=\"pt\">Português</TabsTrigger>\r\n              </TabsList>\r\n              \r\n              <TabsContent value=\"zh\" className=\"mt-4\">\r\n                <RichTextEditor\r\n                  value={contentZh}\r\n                  onChange={setContentZh}\r\n                  placeholder=\"请输入中文活动手册内容...\"\r\n                />\r\n              </TabsContent>\r\n              \r\n              <TabsContent value=\"en\" className=\"mt-4\">\r\n                <RichTextEditor\r\n                  value={contentEn}\r\n                  onChange={setContentEn}\r\n                  placeholder=\"Enter English activity handbook content...\"\r\n                />\r\n              </TabsContent>\r\n              \r\n              <TabsContent value=\"pt\" className=\"mt-4\">\r\n                <RichTextEditor\r\n                  value={contentPt}\r\n                  onChange={setContentPt}\r\n                  placeholder=\"Digite o conteúdo do manual da atividade em português...\"\r\n                />\r\n              </TabsContent>\r\n            </Tabs>\r\n          </div>\r\n        )}\r\n        \r\n        <DialogFooter>\r\n          <Button variant=\"outline\" onClick={() => setOpen(false)}>\r\n            {t(\"common.cancel\")}\r\n          </Button>\r\n          <Button onClick={handleSave} disabled={updateHandbook.isPending}>\r\n            {updateHandbook.isPending ? (\r\n              <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\r\n            ) : (\r\n              <Save className=\"w-4 h-4 mr-2\" />\r\n            )}\r\n            {t(\"common.save\")}\r\n          </Button>\r\n        </DialogFooter>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default GlobalHandbookEditorDialog;\r\n","import { useState, useMemo } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Checkbox } from \"@/components/ui/checkbox\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from \"@/components/ui/select\";\r\nimport {\r\n  AlertDialog,\r\n  AlertDialogAction,\r\n  AlertDialogCancel,\r\n  AlertDialogContent,\r\n  AlertDialogDescription,\r\n  AlertDialogFooter,\r\n  AlertDialogHeader,\r\n  AlertDialogTitle,\r\n  AlertDialogTrigger,\r\n} from \"@/components/ui/alert-dialog\";\r\nimport { useAdminActivities } from \"@/hooks/useActivities\";\r\nimport { useLocalizedContent } from \"@/hooks/useLocalizedContent\";\r\nimport { useDeleteActivity, useBatchDeleteActivities } from \"@/hooks/useAdmin\";\r\n\r\nimport { ActivityFormDialog } from \"@/components/admin/ActivityFormDialog\";\r\nimport ActivityRulesEditorDialog from \"@/components/admin/ActivityRulesEditorDialog\";\r\nimport GlobalHandbookEditorDialog from \"@/components/admin/GlobalHandbookEditorDialog\";\r\nimport { Calendar, Plus, Download, Trash2, Search, FileText, FileEdit, Send, BarChart3, BookOpen } from \"lucide-react\";\r\nimport { format } from \"date-fns\";\r\nimport { exportActivitiesToCSV } from \"@/lib/exportUtils\";\r\nimport { useToast } from \"@/hooks/use-toast\";\r\nconst AdminActivities = () => {\r\n  const { t } = useTranslation();\r\n  const { toast } = useToast();\r\n  const { data: activities, isLoading } = useAdminActivities();\r\n  const { getLocalizedField } = useLocalizedContent();\r\n  const deleteActivity = useDeleteActivity();\r\n  const batchDeleteActivities = useBatchDeleteActivities();\r\n  const [selectedActivities, setSelectedActivities] = useState<string[]>([]);\r\n  const [searchQuery, setSearchQuery] = useState(\"\");\r\n  const [statusFilter, setStatusFilter] = useState<string>(\"all\");\r\n  const [deleteConfirmText, setDeleteConfirmText] = useState<{ [key: string]: string }>({});\r\n  const [batchDeleteConfirmText, setBatchDeleteConfirmText] = useState(\"\");\r\n\r\n  // Filter activities based on search query and status filter\r\n  const filteredActivities = useMemo(() => {\r\n    if (!activities) return [];\r\n    \r\n    return activities.filter((activity) => {\r\n      const title = String(getLocalizedField(activity, \"title\") || \"\");\r\n      const content = String(getLocalizedField(activity, \"content\") || \"\");\r\n      const matchesSearch = searchQuery === \"\" || \r\n        title.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n        content.toLowerCase().includes(searchQuery.toLowerCase());\r\n      \r\n      const now = new Date();\r\n      const startDate = new Date(activity.start_date);\r\n      // If no end_date, activity is ongoing indefinitely\r\n      const endDate = activity.end_date ? new Date(activity.end_date) : null;\r\n      const isEnded = endDate ? endDate < now : false;\r\n      const isOngoing = !isEnded && startDate <= now;\r\n      \r\n      const activityStatus = (activity as any).status || \"published\";\r\n      const matchesStatus = \r\n        statusFilter === \"all\" ||\r\n        (statusFilter === \"active\" && isOngoing) ||\r\n        (statusFilter === \"ended\" && isEnded) ||\r\n        (statusFilter === \"pinned\" && activity.pinned) ||\r\n        (statusFilter === \"draft\" && activityStatus === \"draft\") ||\r\n        (statusFilter === \"published\" && activityStatus === \"published\");\r\n      \r\n      return matchesSearch && matchesStatus;\r\n    });\r\n  }, [activities, searchQuery, statusFilter, getLocalizedField]);\r\n\r\n  const handleExport = () => {\r\n    if (!activities || activities.length === 0) {\r\n      toast({\r\n        title: t(\"common.error\"),\r\n        description: t(\"admin.noDataToExport\"),\r\n        variant: \"destructive\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    exportActivitiesToCSV(activities);\r\n    toast({\r\n      title: t(\"common.success\"),\r\n      description: t(\"admin.exportSuccess\"),\r\n    });\r\n  };\r\n\r\n  const toggleSelectActivity = (activityId: string) => {\r\n    setSelectedActivities(prev =>\r\n      prev.includes(activityId)\r\n        ? prev.filter(id => id !== activityId)\r\n        : [...prev, activityId]\r\n    );\r\n  };\r\n\r\n  const toggleSelectAll = () => {\r\n    if (selectedActivities.length === filteredActivities?.length) {\r\n      setSelectedActivities([]);\r\n    } else {\r\n      setSelectedActivities(filteredActivities?.map(a => a.id) || []);\r\n    }\r\n  };\r\n\r\n  const handleBatchDelete = () => {\r\n    if (selectedActivities.length === 0) return;\r\n    batchDeleteActivities.mutate(selectedActivities);\r\n    setSelectedActivities([]);\r\n  };\r\n\r\n  if (isLoading) {\r\n    return <div className=\"text-center\">{t(\"common.loading\")}</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n        <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4\">\r\n          <div>\r\n            <h1 className=\"text-2xl md:text-3xl font-bold mb-2\">{t(\"admin.activityManagement\")}</h1>\r\n            <p className=\"text-muted-foreground\">{t(\"admin.manageActivities\")}</p>\r\n          </div>\r\n          <div className=\"flex gap-2 flex-wrap\">\r\n            <GlobalHandbookEditorDialog>\r\n              <Button variant=\"outline\" className=\"flex-1 sm:flex-initial\">\r\n                <BookOpen className=\"mr-2 h-4 w-4\" />\r\n                <span className=\"hidden sm:inline\">{t(\"admin.activityHandbook\")}</span>\r\n              </Button>\r\n            </GlobalHandbookEditorDialog>\r\n            <ActivityRulesEditorDialog>\r\n              <Button variant=\"outline\" className=\"flex-1 sm:flex-initial\">\r\n                <FileText className=\"mr-2 h-4 w-4\" />\r\n                <span className=\"hidden sm:inline\">{t(\"admin.activityRules\")}</span>\r\n              </Button>\r\n            </ActivityRulesEditorDialog>\r\n            <Button variant=\"outline\" onClick={handleExport} className=\"flex-1 sm:flex-initial\">\r\n              <Download className=\"mr-2 h-4 w-4\" />\r\n              <span className=\"hidden sm:inline\">{t(\"admin.exportCSV\")}</span>\r\n            </Button>\r\n            <ActivityFormDialog\r\n              trigger={\r\n                <Button className=\"flex-1 sm:flex-initial\">\r\n                  <Plus className=\"mr-2 h-4 w-4\" />\r\n                  {t(\"admin.addActivity\")}\r\n                </Button>\r\n              }\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {/* Search and Filter */}\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"flex gap-4 flex-wrap\">\r\n              <div className=\"flex-1 min-w-[200px]\">\r\n                <div className=\"relative\">\r\n                  <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\r\n                  <Input\r\n                    placeholder={t(\"admin.searchActivities\")}\r\n                    value={searchQuery}\r\n                    onChange={(e) => setSearchQuery(e.target.value)}\r\n                    className=\"pl-9\"\r\n                  />\r\n                </div>\r\n              </div>\r\n              <Select value={statusFilter} onValueChange={setStatusFilter}>\r\n                <SelectTrigger className=\"w-[180px]\">\r\n                  <SelectValue placeholder={t(\"admin.filterByStatus\")} />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"all\">{t(\"admin.allStatus\")}</SelectItem>\r\n                  <SelectItem value=\"draft\">{t(\"admin.statusDraft\")}</SelectItem>\r\n                  <SelectItem value=\"published\">{t(\"admin.statusPublished\")}</SelectItem>\r\n                  <SelectItem value=\"active\">{t(\"admin.statusActive\")}</SelectItem>\r\n                  <SelectItem value=\"ended\">{t(\"admin.statusEnded\")}</SelectItem>\r\n                  <SelectItem value=\"pinned\">{t(\"admin.statusPinned\")}</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Batch Operations */}\r\n        {selectedActivities.length > 0 && (\r\n          <Card className=\"bg-muted/50\">\r\n            <CardContent className=\"pt-6\">\r\n              <div className=\"flex flex-col sm:flex-row items-start sm:items-center gap-4\">\r\n                <span className=\"font-medium\">\r\n                  {t(\"admin.selectedCount\", { count: selectedActivities.length })}\r\n                </span>\r\n\r\n                <div className=\"flex gap-2 flex-wrap w-full sm:w-auto\">\r\n                  <AlertDialog>\r\n                    <AlertDialogTrigger asChild>\r\n                      <Button variant=\"destructive\" size=\"sm\" className=\"flex-1 sm:flex-initial\">\r\n                        <Trash2 className=\"mr-2 h-4 w-4\" />\r\n                        {t(\"admin.batchDelete\")}\r\n                      </Button>\r\n                    </AlertDialogTrigger>\r\n                    <AlertDialogContent className=\"max-w-[90vw] sm:max-w-[425px]\">\r\n                      <AlertDialogHeader>\r\n                        <AlertDialogTitle>{t(\"admin.confirmBatchDelete\")}</AlertDialogTitle>\r\n                        <AlertDialogDescription className=\"space-y-3\">\r\n                          <p>{t(\"admin.batchDeleteWarning\", { count: selectedActivities.length })}</p>\r\n                          <p className=\"font-semibold text-destructive\">\r\n                            {t(\"admin.willDeleteActivities\", { count: selectedActivities.length })}\r\n                          </p>\r\n                          <div className=\"space-y-2\">\r\n                            <p className=\"text-sm\">{t(\"admin.typeDeleteToConfirmBatch\")}</p>\r\n                            <Input\r\n                              value={batchDeleteConfirmText}\r\n                              onChange={(e) => setBatchDeleteConfirmText(e.target.value)}\r\n                              placeholder=\"DELETE\"\r\n                              className=\"font-mono\"\r\n                            />\r\n                          </div>\r\n                        </AlertDialogDescription>\r\n                      </AlertDialogHeader>\r\n                      <AlertDialogFooter>\r\n                        <AlertDialogCancel onClick={() => setBatchDeleteConfirmText(\"\")}>\r\n                          {t(\"common.cancel\")}\r\n                        </AlertDialogCancel>\r\n                        <AlertDialogAction\r\n                          disabled={batchDeleteConfirmText !== \"DELETE\"}\r\n                          onClick={() => {\r\n                            handleBatchDelete();\r\n                            setBatchDeleteConfirmText(\"\");\r\n                          }}\r\n                          className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\r\n                        >\r\n                          {t(\"common.delete\")}\r\n                        </AlertDialogAction>\r\n                      </AlertDialogFooter>\r\n                    </AlertDialogContent>\r\n                  </AlertDialog>\r\n\r\n                  <Button variant=\"outline\" size=\"sm\" onClick={() => setSelectedActivities([])} className=\"flex-1 sm:flex-initial\">\r\n                    {t(\"admin.clearSelection\")}\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        )}\r\n\r\n        {/* Select All */}\r\n        <div className=\"flex items-center gap-2 pb-2 border-b\">\r\n          <Checkbox\r\n            checked={selectedActivities.length === filteredActivities?.length && filteredActivities.length > 0}\r\n            onCheckedChange={toggleSelectAll}\r\n          />\r\n          <span className=\"font-medium\">{t(\"admin.selectAll\")}</span>\r\n          <span className=\"text-sm text-muted-foreground ml-2\">\r\n            ({filteredActivities?.length} {t(\"admin.results\")})\r\n          </span>\r\n        </div>\r\n\r\n        <div className=\"grid gap-4\">\r\n          {filteredActivities?.map((activity) => (\r\n            <Card key={activity.id}>\r\n              <div className=\"flex flex-col md:flex-row md:items-center\">\r\n                <div className=\"p-4 flex items-start md:self-start\">\r\n                  <Checkbox\r\n                    checked={selectedActivities.includes(activity.id)}\r\n                    onCheckedChange={() => toggleSelectActivity(activity.id)}\r\n                    className=\"mt-1\"\r\n                  />\r\n                </div>\r\n                {activity.image_url && (\r\n                  <div className=\"w-full md:w-48 h-48 flex items-center justify-center overflow-hidden mx-auto md:mx-0 flex-shrink-0\">\r\n                    <img\r\n                      src={activity.image_url}\r\n                      alt={String(getLocalizedField(activity, \"title\"))}\r\n                      className=\"object-cover w-full h-full\"\r\n                    />\r\n                  </div>\r\n                )}\r\n                <div className=\"flex-1\">\r\n                  <CardHeader>\r\n                    <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-2\">\r\n                      <CardTitle className=\"text-lg md:text-xl\">{getLocalizedField(activity, \"title\")}</CardTitle>\r\n                      <div className=\"flex gap-2 flex-wrap\">\r\n                        {(activity as any).status === \"draft\" ? (\r\n                          <Badge variant=\"outline\" className=\"bg-yellow-500/10 text-yellow-600 border-yellow-500/30\">\r\n                            <FileEdit className=\"w-3 h-3 mr-1\" />\r\n                            草稿\r\n                          </Badge>\r\n                        ) : (\r\n                          <Badge variant=\"outline\" className=\"bg-green-500/10 text-green-600 border-green-500/30\">\r\n                            <Send className=\"w-3 h-3 mr-1\" />\r\n                            已发布\r\n                          </Badge>\r\n                        )}\r\n                        {!activity.visible && <Badge variant=\"secondary\">{t(\"admin.hidden\")}</Badge>}\r\n                        {activity.pinned && <Badge>{t(\"activities.pinned\")}</Badge>}\r\n                        {(() => {\r\n                          const now = new Date();\r\n                          const startDate = new Date(activity.start_date);\r\n                          const endDate = activity.end_date ? new Date(activity.end_date) : null;\r\n                          const isEnded = endDate ? endDate < now : false;\r\n                          const isOngoing = !isEnded && startDate <= now;\r\n                          \r\n                          if (isEnded) {\r\n                            return <Badge variant=\"secondary\">{t(\"activities.ended\")}</Badge>;\r\n                          } else if (isOngoing) {\r\n                            return <Badge>{t(\"activities.ongoing\")}</Badge>;\r\n                          }\r\n                          return null;\r\n                        })()}\r\n                      </div>\r\n                    </div>\r\n                    <CardDescription className=\"line-clamp-2\">\r\n                      <div \r\n                        className=\"prose prose-sm max-w-none\r\n                          [&_p]:inline [&_p]:m-0\r\n                          [&_strong]:font-semibold [&_strong]:text-foreground\r\n                          [&_em]:italic\r\n                          [&_h1]:text-base [&_h2]:text-base [&_h3]:text-base\r\n                          [&_*]:text-muted-foreground\"\r\n                        dangerouslySetInnerHTML={{ __html: getLocalizedField(activity, \"content\") }}\r\n                      />\r\n                    </CardDescription>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <div className=\"flex items-center gap-4 text-sm text-muted-foreground mb-4 overflow-x-auto\">\r\n                      <div className=\"flex items-center gap-1 whitespace-nowrap\">\r\n                        <Calendar className=\"h-4 w-4 flex-shrink-0\" />\r\n                        <span className=\"text-xs sm:text-sm\">\r\n                          {format(new Date(activity.start_date), \"PPP\")}\r\n                          {activity.end_date &&\r\n                            ` - ${format(new Date(activity.end_date), \"PPP\")}`}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex gap-2 flex-wrap\">\r\n                      {(activity as any).status !== \"draft\" && (\r\n                        <Button variant=\"outline\" size=\"sm\" asChild className=\"flex-1 sm:flex-initial\">\r\n                          <Link to={`/admin/activity-stats/${activity.id}`}>\r\n                            <BarChart3 className=\"w-4 h-4 mr-1\" />\r\n                            {t(\"admin.stats\", \"统计\")}\r\n                          </Link>\r\n                        </Button>\r\n                      )}\r\n                      <Button variant=\"outline\" size=\"sm\" asChild className=\"flex-1 sm:flex-initial\">\r\n                        <Link to={`/activity/${activity.id}`} state={{ from: \"admin\" }}>{t(\"admin.view\")}</Link>\r\n                      </Button>\r\n                      <ActivityFormDialog\r\n                        activity={activity}\r\n                        trigger={\r\n                          <Button variant=\"outline\" size=\"sm\" className=\"flex-1 sm:flex-initial\">\r\n                            {t(\"common.edit\")}\r\n                          </Button>\r\n                        }\r\n                      />\r\n                      {(activity as any).status === \"draft\" ? (\r\n                        /* Draft activity: simple confirmation */\r\n                        <AlertDialog>\r\n                          <AlertDialogTrigger asChild>\r\n                            <Button variant=\"outline\" size=\"sm\" className=\"flex-1 sm:flex-initial\">\r\n                              {t(\"common.delete\")}\r\n                            </Button>\r\n                          </AlertDialogTrigger>\r\n                          <AlertDialogContent className=\"max-w-[90vw] sm:max-w-[425px]\">\r\n                            <AlertDialogHeader>\r\n                              <AlertDialogTitle>{t(\"admin.confirmDelete\")}</AlertDialogTitle>\r\n                              <AlertDialogDescription>\r\n                                <p>{t(\"admin.deleteActivityWarning\")}</p>\r\n                                <p className=\"font-semibold text-foreground mt-2\">\r\n                                  {getLocalizedField(activity, \"title\")}\r\n                                </p>\r\n                              </AlertDialogDescription>\r\n                            </AlertDialogHeader>\r\n                            <AlertDialogFooter>\r\n                              <AlertDialogCancel>{t(\"common.cancel\")}</AlertDialogCancel>\r\n                              <AlertDialogAction\r\n                                onClick={() => deleteActivity.mutate(activity.id)}\r\n                                className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\r\n                              >\r\n                                {t(\"common.delete\")}\r\n                              </AlertDialogAction>\r\n                            </AlertDialogFooter>\r\n                          </AlertDialogContent>\r\n                        </AlertDialog>\r\n                      ) : (\r\n                        /* Published activity: strict verification */\r\n                        <AlertDialog>\r\n                          <AlertDialogTrigger asChild>\r\n                            <Button variant=\"outline\" size=\"sm\" className=\"flex-1 sm:flex-initial\">\r\n                              {t(\"common.delete\")}\r\n                            </Button>\r\n                          </AlertDialogTrigger>\r\n                          <AlertDialogContent className=\"max-w-[90vw] sm:max-w-[425px]\">\r\n                            <AlertDialogHeader>\r\n                              <AlertDialogTitle>{t(\"admin.confirmDelete\")}</AlertDialogTitle>\r\n                              <AlertDialogDescription className=\"space-y-3\">\r\n                                <p>{t(\"admin.deleteActivityWarning\")}</p>\r\n                                <p className=\"font-semibold text-foreground\">\r\n                                  {getLocalizedField(activity, \"title\")}\r\n                                </p>\r\n                                <div className=\"space-y-2\">\r\n                                  <p className=\"text-sm\">{t(\"admin.typeDeleteToConfirmBatch\")}</p>\r\n                                  <Input\r\n                                    value={deleteConfirmText[activity.id] || \"\"}\r\n                                    onChange={(e) => setDeleteConfirmText({ ...deleteConfirmText, [activity.id]: e.target.value })}\r\n                                    placeholder=\"DELETE\"\r\n                                    className=\"font-mono\"\r\n                                  />\r\n                                </div>\r\n                              </AlertDialogDescription>\r\n                            </AlertDialogHeader>\r\n                            <AlertDialogFooter>\r\n                              <AlertDialogCancel onClick={() => setDeleteConfirmText({ ...deleteConfirmText, [activity.id]: \"\" })}>\r\n                                {t(\"common.cancel\")}\r\n                              </AlertDialogCancel>\r\n                              <AlertDialogAction\r\n                                disabled={deleteConfirmText[activity.id] !== \"DELETE\"}\r\n                                onClick={() => {\r\n                                  deleteActivity.mutate(activity.id);\r\n                                  setDeleteConfirmText({ ...deleteConfirmText, [activity.id]: \"\" });\r\n                                }}\r\n                                className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\r\n                              >\r\n                                {t(\"common.delete\")}\r\n                              </AlertDialogAction>\r\n                            </AlertDialogFooter>\r\n                          </AlertDialogContent>\r\n                        </AlertDialog>\r\n                      )}\r\n                    </div>\r\n                  </CardContent>\r\n                </div>\r\n              </div>\r\n            </Card>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  export default AdminActivities;\r\n"],"names":["Crop","createLucideIcon","Maximize2","Pin","_","$","h","e","m","E","b","H","X","B","n","t","D","v","L","k","d","r","o","w","i","s","c","p","l","C","y","f","I","M","N","x","K","P","g","Y","u","S","RECOMMENDED_WIDTH","RECOMMENDED_HEIGHT","ASPECT_RATIO","centerAspectCrop","mediaWidth","mediaHeight","aspect","centerCrop","makeAspectCrop","ImageCropDialog","open","onOpenChange","imageFile","onCropComplete","useTranslation","imgSrc","setImgSrc","useState","crop","setCrop","completedCrop","setCompletedCrop","imgRef","useRef","isCropping","setIsCropping","useEffect","reader","onImageLoad","useCallback","width","height","getCroppedImg","image","canvas","ctx","scaleX","scaleY","resolve","reject","blob","handleCropConfirm","croppedBlob","croppedFile","previewUrl","error","Dialog","jsxs","DialogContent","DialogHeader","DialogTitle","jsx","CropIcon","DialogDescription","Alert","Info","AlertDescription","Badge","ReactCrop","DialogFooter","Button","draftSchema","z.object","z.string","z.date","z.enum","z.number","z.boolean","publishedSchema","i18n","activitySchema","ActivityFormDialog","activity","trigger","t$1","queryClient","useQueryClient","setOpen","setImageFile","imagePreview","setImagePreview","selectedRestaurants","setSelectedRestaurants","isSubmitting","setIsSubmitting","showCropDialog","setShowCropDialog","tempImageFile","setTempImageFile","mediaType","setMediaType","videoFile","setVideoFile","videoPreview","setVideoPreview","isUploadingVideo","setIsUploadingVideo","videoDeleted","setVideoDeleted","restaurants","useRestaurants","register","handleSubmit","errors","setValue","watch","control","useForm","zodResolver","startDate","endDate","pinned","visible","status","data","supabase","ar","handleImageChange","file","toast","handleCropComplete","preview","handleVideoChange","uploadImage","fileExt","filePath","uploadError","publicUrl","uploadVideo","fileName","onSubmit","publishedResult","fieldLabels","missingFields","err","fieldPath","user","imageUrl","videoUrl","finalVisible","activityData","associations","restaurantId","assocError","newActivity","autoLinkTemplates","couponAssociations","template","DialogTrigger","Globe","ScrollArea","Card","CardContent","Label","Upload","Image","Video","Input","Tabs","TabsList","TabsTrigger","TabsContent","Controller","field","RichTextEditor","CalendarIcon","Popover","PopoverTrigger","cn","format","PopoverContent","Calendar","date","Select","value","SelectTrigger","SelectValue","SelectContent","SelectItem","FileEdit","Send","Checkbox","checked","ArrowUpDown","Store","restaurant","id","Fragment","ActivityRulesEditorDialog","children","rules","isLoading","useActivityRules","updateRules","useUpdateActivityRules","activeTab","setActiveTab","contentZh","setContentZh","contentEn","setContentEn","contentPt","setContentPt","handleSave","FileText","Loader2","Save","GlobalHandbookEditorDialog","handbook","useGlobalHandbook","updateHandbook","useUpdateGlobalHandbook","BookOpen","AdminActivities","useToast","activities","useAdminActivities","getLocalizedField","useLocalizedContent","deleteActivity","useDeleteActivity","batchDeleteActivities","useBatchDeleteActivities","selectedActivities","setSelectedActivities","searchQuery","setSearchQuery","statusFilter","setStatusFilter","deleteConfirmText","setDeleteConfirmText","batchDeleteConfirmText","setBatchDeleteConfirmText","filteredActivities","useMemo","title","content","matchesSearch","now","isEnded","isOngoing","activityStatus","matchesStatus","handleExport","exportActivitiesToCSV","toggleSelectActivity","activityId","prev","toggleSelectAll","a","handleBatchDelete","Download","Plus","Search","AlertDialog","AlertDialogTrigger","Trash2","AlertDialogContent","AlertDialogHeader","AlertDialogTitle","AlertDialogDescription","AlertDialogFooter","AlertDialogCancel","AlertDialogAction","CardHeader","CardTitle","CardDescription","Link","BarChart3"],"mappings":"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","x_google_ignoreList":[0,1,2,3]}