{"version":3,"file":"ImagePreviewModal-BqCHox3o.js","sources":["../../src/components/ImagePreviewModal.tsx"],"sourcesContent":["import { useState, useEffect, useRef } from \"react\";\r\nimport { createPortal } from \"react-dom\";\r\nimport { X } from \"lucide-react\";\r\nimport { Button } from \"@/components/ui/button\";\r\n\r\ninterface ImagePreviewModalProps {\r\n  imageUrl: string;\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  disableLongImage?: boolean;\r\n}\r\n\r\nconst ImagePreviewModal = ({ imageUrl, isOpen, onClose, disableLongImage = false }: ImagePreviewModalProps) => {\r\n  const [isLongImage, setIsLongImage] = useState(false);\r\n  const [imageLoaded, setImageLoaded] = useState(false);\r\n  const [scrollStart, setScrollStart] = useState<{ y: number; scrollTop: number } | null>(null);\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n\r\n  // Lock body scroll when preview is open\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      const scrollY = window.scrollY;\r\n      document.body.style.position = 'fixed';\r\n      document.body.style.top = `-${scrollY}px`;\r\n      document.body.style.left = '0';\r\n      document.body.style.right = '0';\r\n      document.body.style.overflow = 'hidden';\r\n      \r\n      return () => {\r\n        document.body.style.position = '';\r\n        document.body.style.top = '';\r\n        document.body.style.left = '';\r\n        document.body.style.right = '';\r\n        document.body.style.overflow = '';\r\n        window.scrollTo(0, scrollY);\r\n      };\r\n    }\r\n  }, [isOpen]);\r\n\r\n  // Reset state when image URL changes\r\n  useEffect(() => {\r\n    setIsLongImage(false);\r\n    setImageLoaded(false);\r\n  }, [imageUrl]);\r\n\r\n  const handleImageLoad = (e: React.SyntheticEvent<HTMLImageElement>) => {\r\n    const img = e.currentTarget;\r\n    const ratio = img.naturalHeight / img.naturalWidth;\r\n    setIsLongImage(disableLongImage ? false : ratio > 1.5);\r\n    setImageLoaded(true);\r\n  };\r\n\r\n  const handleContainerClick = (e: React.MouseEvent) => {\r\n    if (e.target === e.currentTarget) {\r\n      onClose();\r\n    }\r\n  };\r\n\r\n  const handleTouchEnd = (e: React.TouchEvent) => {\r\n    if (!scrollStart) return;\r\n    \r\n    const touch = e.changedTouches[0];\r\n    const deltaY = Math.abs(touch.clientY - scrollStart.y);\r\n    const container = containerRef.current;\r\n    const deltaScroll = container ? Math.abs(container.scrollTop - scrollStart.scrollTop) : 0;\r\n    \r\n    if (deltaY < 15 && deltaScroll < 15) {\r\n      e.preventDefault();\r\n      onClose();\r\n    }\r\n    setScrollStart(null);\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return createPortal(\r\n    <div \r\n      className=\"fixed inset-0 z-[100] bg-black\"\r\n      style={{ \r\n        left: 0,\r\n        right: 0,\r\n        top: 0,\r\n        bottom: 0,\r\n        width: '100vw',\r\n        height: '100dvh',\r\n        overflow: 'hidden',\r\n        margin: 0,\r\n        padding: 0\r\n      }}\r\n    >\r\n      {/* Close Button */}\r\n      <Button\r\n        variant=\"ghost\"\r\n        size=\"icon\"\r\n        className=\"absolute top-4 right-4 z-10 text-white hover:bg-white/20\"\r\n        onClick={onClose}\r\n      >\r\n        <X className=\"h-6 w-6\" />\r\n      </Button>\r\n\r\n      {/* Image Container */}\r\n      <div \r\n        ref={containerRef}\r\n        className=\"w-full h-full overflow-x-hidden overscroll-contain\"\r\n        style={{\r\n          overflowY: isLongImage ? 'scroll' : 'hidden',\r\n          WebkitOverflowScrolling: 'touch',\r\n        }}\r\n        onClick={handleContainerClick}\r\n        onTouchStart={(e) => {\r\n          setScrollStart({ \r\n            y: e.touches[0].clientY, \r\n            scrollTop: containerRef.current?.scrollTop || 0 \r\n          });\r\n        }}\r\n        onTouchEnd={handleTouchEnd}\r\n        onMouseDown={(e) => {\r\n          setScrollStart({ \r\n            y: e.clientY, \r\n            scrollTop: containerRef.current?.scrollTop || 0 \r\n          });\r\n        }}\r\n        onMouseUp={(e) => {\r\n          if (scrollStart) {\r\n            const deltaY = Math.abs(e.clientY - scrollStart.y);\r\n            const container = containerRef.current;\r\n            const deltaScroll = container ? Math.abs(container.scrollTop - scrollStart.scrollTop) : 0;\r\n            if (deltaY < 10 && deltaScroll < 10) {\r\n              onClose();\r\n            }\r\n            setScrollStart(null);\r\n          }\r\n        }}\r\n      >\r\n        {/* Hidden image to detect dimensions */}\r\n        {!imageLoaded && (\r\n          <img \r\n            src={imageUrl} \r\n            alt=\"\" \r\n            onLoad={handleImageLoad}\r\n            style={{ position: 'absolute', opacity: 0, pointerEvents: 'none' }}\r\n          />\r\n        )}\r\n        \r\n        {/* Actual visible image */}\r\n        {imageLoaded && (\r\n          isLongImage ? (\r\n            <img\r\n              src={imageUrl}\r\n              alt=\"\"\r\n              draggable={false}\r\n              className=\"block select-none\"\r\n              style={{ \r\n                width: '100vw',\r\n                minWidth: '100vw',\r\n                minHeight: '100dvh',\r\n                height: 'auto',\r\n                margin: 0,\r\n                objectFit: 'cover',\r\n                objectPosition: 'top center'\r\n              }}\r\n            />\r\n          ) : (\r\n            <div \r\n              className=\"w-full h-full flex items-center justify-center\"\r\n              onClick={onClose}\r\n            >\r\n              <img\r\n                src={imageUrl}\r\n                alt=\"\"\r\n                draggable={false}\r\n                className=\"max-w-full max-h-full object-contain select-none\"\r\n              />\r\n            </div>\r\n          )\r\n        )}\r\n      </div>\r\n    </div>,\r\n    document.body\r\n  );\r\n};\r\n\r\nexport default ImagePreviewModal;\r\n"],"names":["ImagePreviewModal","imageUrl","isOpen","onClose","disableLongImage","isLongImage","setIsLongImage","useState","imageLoaded","setImageLoaded","scrollStart","setScrollStart","containerRef","useRef","useEffect","scrollY","handleImageLoad","e","img","ratio","handleContainerClick","handleTouchEnd","touch","deltaY","container","deltaScroll","createPortal","jsxs","jsx","Button","X"],"mappings":"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"}