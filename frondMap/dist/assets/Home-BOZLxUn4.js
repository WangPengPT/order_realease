const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/HomeMapSection-CIilOmDf.js","assets/vendor-react-87iFmKFJ.js","assets/vendor-i18n-AOdgFpXS.js","assets/vendor-editor-B1vH4T8i.js","assets/vendor-utils-vwQGbBim.js","assets/vendor-react-CG6K1Se3.css","assets/textFormatting-37JGiPHb.js","assets/index-C3xfGQgV.js","assets/vendor-supabase-CQWbleDe.js","assets/index-9G6UCpRo.css","assets/popover-CGHGbMdw.js","assets/useRestaurants-Cw8LOIIA.js","assets/geolocation-YPf7LJYy.js","assets/xiaoxiong-logo-clean-BAOawS-z.js","assets/vendor-map-CvE3ASYw.js","assets/vendor-map-BbyR9nQ0.css","assets/map-icon-DR07RZr_.js","assets/useLocalizedContent-CFh79NZC.js","assets/useActivities-CYv0-Emh.js","assets/LocationPermissionDialog-FxX2MnqE.js"])))=>i.map(i=>d[i]);
import{a as ue,b as J,D as Ee,c as Ie,d as $e,e as Pe,f as Ve,o as Be,C as xe,B as le,h as _,S as U,i as Y,_ as Oe,j as He,k as We,H as qe,l as Ke,m as Xe}from"./index-C3xfGQgV.js";import{p as V,u as H,r,j as e,L as he,al as Qe,aW as O,aX as pe,aY as fe,aZ as ge,a_ as be,a$ as ye,b0 as Fe,b1 as ce,b2 as Ue,q as Ge,b3 as Ye,b4 as Ze,b5 as Je}from"./vendor-react-87iFmKFJ.js";import{m as ve}from"./map-icon-DR07RZr_.js";import{a as et,g as tt}from"./app-store-badge-CyCtXXOt.js";import{u as we}from"./useHomepageTemplates-BstxsbLI.js";import{u as st}from"./usePageView-BZdkQiaO.js";import{u as ot,X as at}from"./XiaoxiongChatContent-DZ1888nS.js";import{P as rt}from"./PullToRefresh-8f8L43sb.js";import{E as it}from"./ExternalLinkConfirmDialog-CNB11ppm.js";import{u as nt}from"./useActivities-CYv0-Emh.js";import{a as de,f as G,K as lt,L as me,M as ct,i as dt}from"./vendor-utils-vwQGbBim.js";import{u as mt}from"./useLocalizedContent-CFh79NZC.js";import"./vendor-supabase-CQWbleDe.js";import"./vendor-editor-B1vH4T8i.js";import"./vendor-i18n-AOdgFpXS.js";import"./LocationPermissionDialog-FxX2MnqE.js";const ut=({open:t,onOpenChange:o})=>{const{i18n:l}=V(),s=H(),n=ue(),{settings:a}=J(),i=a?.logo_url,m=a?.ai_provider||"xiaoxiong-community",{input:u,setInput:d,messages:x,isLoading:f,showLocationDialog:h,setShowLocationDialog:g,pendingMessage:k,setPendingMessage:N,handleSubmit:S,handleKeyDown:C,handleLocationConfirm:j,processMessage:L,abortRequest:M,requestLocation:T}=ot(m);r.useEffect(()=>{t&&n&&(o(!1),s("/ask-xiaoxiong"))},[t,n,s,o]),r.useEffect(()=>{t&&!n&&T()},[t,n,T]);const A=()=>{M(),o(!1)},$=()=>l.language==="zh"?"小熊AI助手":l.language==="pt"?"Assistente IA Xiaoxiong":"Xiaoxiong AI Assistant";return n?null:e.jsx(Ee,{open:t,onOpenChange:A,children:e.jsxs(Ie,{className:"sm:max-w-2xl sm:h-[90vh] sm:max-h-[90vh] flex flex-col p-0 gap-0 overflow-hidden",children:[e.jsx($e,{className:"px-4 py-3 shrink-0 border-b",children:e.jsxs(Pe,{className:"text-base font-semibold flex items-center gap-2",children:[i&&e.jsx("img",{src:i,alt:"Logo",className:"w-8 h-8 rounded-full object-cover"}),$()]})}),e.jsx("div",{className:"flex-1 min-h-0 flex flex-col overflow-hidden",children:e.jsx(at,{messages:x,input:u,setInput:d,isLoading:f,showLocationDialog:h,setShowLocationDialog:g,pendingMessage:k,handleSubmit:S,handleKeyDown:C,handleLocationConfirm:j,processMessage:L,setPendingMessage:N,onClose:A,showBackButton:!1,showHeader:!1,className:"flex-1"})})]})})},je=r.memo(({stats:t,onAskXiaoxiong:o})=>{const l=H(),{t:s,i18n:n}=V(),{data:a}=we(),{buttons:i}=Ve(),{settings:m}=J(),u=n.language,[d,x]=r.useState(!1),f=m?.about_us_button_mobile!==!1,h=i?.find(j=>j.label_zh==="演示"||j.link?.includes("v.xiaoxiong.pt"));h&&h.enabled!==!1&&h.visible!==!1&&h.show_on_mobile;const g=j=>!a||a.length===0?"":a[0][`${j}${u==="zh"?"_zh":u==="pt"?"_pt":"_en"}`]||"",k=g("title")||s("home.hero.title"),N=g("description")||s("home.hero.description"),S=g("subtitle_button_text")||s("home.hero.subtitle"),C=()=>{h?.link&&Be(h.link),x(!1)};return e.jsxs("section",{className:"min-h-[55vh] flex flex-col bg-secondary/20",children:[e.jsxs("div",{className:"pt-20 px-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl font-bold text-foreground",children:s("home.hero.brandName")}),e.jsx("img",{src:ve,alt:"map icon",width:28,height:28,loading:"eager",decoding:"async",className:"w-7 h-7 object-contain flex-shrink-0"})]}),f&&e.jsxs(he,{to:"/about-us",className:"flex items-center gap-1 px-2 py-1 text-xs bg-background/80 backdrop-blur-sm rounded-full border border-border/50 shadow-sm hover:bg-background transition-colors whitespace-nowrap flex-shrink-0",children:[e.jsx(Qe,{className:"w-3.5 h-3.5 text-primary flex-shrink-0"}),e.jsx("span",{className:"text-foreground/80",children:s("nav.aboutUs","关于我们")})]})]}),t&&e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(O,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:s("home.stats.delivery")}),e.jsx("span",{className:"font-bold text-foreground text-sm",children:t.order_count})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(pe,{className:"w-4 h-4 text-accent"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:s("home.stats.reservation")}),e.jsx("span",{className:"font-bold text-foreground text-sm",children:t.reserve_count})]})]})]}),e.jsx("div",{className:"flex-1 flex flex-col items-center justify-center px-4 py-8",children:e.jsxs("div",{className:"max-w-md mx-auto text-center space-y-4",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground leading-tight",children:k}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground max-w-sm mx-auto",children:N}),e.jsxs("div",{className:"pt-4 space-y-3",children:[e.jsxs("button",{onClick:o,className:"group flex items-center gap-3 bg-secondary/50 backdrop-blur-sm text-foreground px-5 py-3.5 rounded-full shadow-sm hover:shadow-md hover:bg-secondary/70 transition-all duration-300 cursor-text border border-border/50 mx-auto",children:[e.jsx(fe,{className:"w-5 h-5 text-primary group-hover:text-primary/80 transition-colors"}),e.jsx("span",{className:"text-sm text-muted-foreground group-hover:text-foreground transition-colors",children:S}),e.jsx(ge,{className:"w-4 h-4 text-muted-foreground/60 ml-2"})]}),e.jsxs("div",{className:"flex items-center gap-3 px-4",children:[e.jsx("div",{className:"flex-1 h-px bg-border/50"}),e.jsx("span",{className:"text-xs text-muted-foreground/60",children:s("aiRecipe.or","或者")}),e.jsx("div",{className:"flex-1 h-px bg-border/50"})]}),e.jsxs("button",{onClick:()=>l("/ai-recipe"),className:"group flex items-center gap-3 bg-secondary/50 backdrop-blur-sm text-foreground px-5 py-3.5 rounded-full shadow-sm hover:shadow-md hover:bg-secondary/70 transition-all duration-300 border border-border/50 mx-auto",children:[e.jsx(be,{className:"w-5 h-5 text-primary group-hover:text-primary/80 transition-colors"}),e.jsx("span",{className:"text-sm text-muted-foreground group-hover:text-foreground transition-colors",children:s("aiRecipe.diyCook","自己动手做，Ai菜谱")}),e.jsx(ye,{className:"w-4 h-4 text-muted-foreground/70 group-hover:text-foreground/70 transition-colors"})]})]})]})}),e.jsx(it,{open:d,onOpenChange:x,onConfirm:C,url:h?.link})]})});je.displayName="MobileHeroSection";const xt=t=>!t||!Array.isArray(t)?!1:t.every(o=>typeof o=="object"&&o!==null&&"start"in o&&"end"in o&&typeof o.start=="number"&&typeof o.end=="number"),ht=(t,o)=>{const l=G(new Date(t.start_date)),s=t.end_date?G(new Date(t.end_date)):null,n=G(o);if(n<l||s&&n>s)return!1;switch(t.repeat_mode||"none"){case"none":return dt(l,n);case"daily":return!0;case"weekly":const i=ct(n);return t.repeat_weekday===i;case"monthly":const u=me(n),d=t.repeat_month_day;return xt(d)?d.some(k=>u>=k.start&&u<=k.end):!1;case"yearly":const x=lt(n)+1,f=me(n),h=t.repeat_yearly_month,g=t.repeat_yearly_day;return h===x&&g===f;default:return!1}},B=t=>{switch(t.repeat_mode||"none"){case"none":return 0;case"weekly":return 1;case"monthly":return 2;case"yearly":return 3;case"daily":return 4;default:return 5}},pt=()=>{const{data:t,isLoading:o}=nt(),l=r.useMemo(()=>{if(!t)return{today:[],tomorrow:[],dayAfterTomorrow:[]};const n=new Date,a=de(n,1),i=de(n,2),m=u=>t.filter(d=>d.visible&&d.status==="published").filter(d=>ht(d,u)).sort((d,x)=>{const f=B(d)-B(x);return f!==0?f:d.pinned!==x.pinned?d.pinned?-1:1:(d.sort_order||0)-(x.sort_order||0)});return{today:m(n),tomorrow:m(a),dayAfterTomorrow:m(i)}},[t]),s=r.useMemo(()=>{const n=new Set,a=[];return l.today.forEach(i=>{n.has(i.id)||(n.add(i.id),a.push({...i,dayLabel:"today"}))}),l.tomorrow.forEach(i=>{n.has(i.id)||(n.add(i.id),a.push({...i,dayLabel:"tomorrow"}))}),l.dayAfterTomorrow.forEach(i=>{n.has(i.id)||(n.add(i.id),a.push({...i,dayLabel:"dayAfterTomorrow"}))}),a.sort((i,m)=>{const u=B(i)-B(m);return u!==0?u:i.pinned!==m.pinned?i.pinned?-1:1:(i.sort_order||0)-(m.sort_order||0)})},[l]);return{recentActivities:l,allRecentActivities:s,isLoading:o,hasActivities:s.length>0}},Ne=()=>{const[t,o]=r.useState(4);return r.useEffect(()=>{const l=()=>{const s=window.innerWidth;s<640?o(2):s<1024?o(3):o(4)};return l(),window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[]),t},_e=r.memo(({activity:t,dayLabel:o})=>{const l=H(),{t:s}=V(),{getLocalizedField:n}=mt(),a=n(t,"title"),i=r.useMemo(()=>{switch(t.service_type){case"dine_in":return s("activities.serviceType.dine_in");case"takeaway":return s("activities.serviceType.takeaway");case"both":return s("activities.serviceType.both");default:return""}},[t.service_type,s]),m=()=>{l(`/activity/${t.id}`)};return e.jsxs(xe,{className:"group cursor-pointer overflow-hidden hover:shadow-lg transition-all duration-300 border-border/50 bg-card",onClick:m,children:[e.jsxs("div",{className:"relative aspect-[16/10] overflow-hidden bg-muted",children:[t.image_url?e.jsx("img",{src:t.image_url,alt:a,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",loading:"lazy"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-primary/20 to-primary/5",children:e.jsx(Fe,{className:"w-12 h-12 text-primary/40"})}),e.jsx(le,{className:_("absolute top-2 left-2 text-xs font-medium",o===s("home.recentActivities.today")?"bg-primary text-primary-foreground":"bg-secondary text-secondary-foreground"),children:o}),t.pinned&&e.jsx(le,{className:"absolute top-2 right-2 text-xs bg-accent text-accent-foreground",children:s("activities.pinned")})]}),e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx("h3",{className:"font-medium text-sm leading-tight line-clamp-2 text-foreground group-hover:text-primary transition-colors",children:a}),e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[t.service_type==="dine_in"&&e.jsx(ce,{className:"w-3 h-3 flex-shrink-0"}),t.service_type==="takeaway"&&e.jsx(O,{className:"w-3 h-3 flex-shrink-0"}),t.service_type==="both"&&e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"w-3 h-3 flex-shrink-0"}),e.jsx(O,{className:"w-3 h-3 flex-shrink-0"})]}),e.jsx("span",{className:"truncate",children:i})]})]})]})});_e.displayName="ActivityCard";const ke=r.memo(()=>{const t=Ne();return e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4",children:Array.from({length:t}).map((o,l)=>e.jsxs(xe,{className:"overflow-hidden",children:[e.jsx(U,{className:"aspect-[16/10] w-full"}),e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx(U,{className:"h-4 w-full"}),e.jsx(U,{className:"h-3 w-2/3"})]})]},l))})});ke.displayName="LoadingSkeleton";const Se=r.memo(()=>{const{t}=V(),{allRecentActivities:o,isLoading:l,hasActivities:s}=pt(),n=Ne(),[a,i]=r.useState(!1),m=x=>{switch(x){case"today":return t("home.recentActivities.today");case"tomorrow":return t("home.recentActivities.tomorrow");case"dayAfterTomorrow":return t("home.recentActivities.dayAfterTomorrow");default:return""}},u=r.useMemo(()=>a?o:o.slice(0,n),[o,n,a]),d=o.length>n;return!l&&!s?null:e.jsx("section",{className:"py-8 sm:py-12 px-4 bg-secondary/20",children:e.jsxs("div",{className:"container mx-auto max-w-7xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-foreground",children:t("home.recentActivities.title")}),d&&!a&&e.jsx(Y,{variant:"ghost",size:"sm",className:"text-primary hover:text-primary/80",onClick:()=>i(!0),children:e.jsxs("span",{className:"flex items-center gap-1",children:[t("home.recentActivities.viewAll"),e.jsx(Ue,{className:"w-4 h-4"})]})}),a&&e.jsx(Y,{variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-foreground",onClick:()=>i(!1),children:e.jsx("span",{className:"flex items-center gap-1",children:t("home.recentActivities.collapse")})})]}),l?e.jsx(ke,{}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4",children:u.map(x=>e.jsx(_e,{activity:x,dayLabel:m(x.dayLabel)},x.id))})]})})});Se.displayName="RecentActivitiesSection";const Z="/images/sushi-ramen-hero.jpg",Ce="/images/sushi-ramen-mobile.jpg",ft=r.lazy(()=>Oe(()=>import("./HomeMapSection-CIilOmDf.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]))),Ae=r.memo(({stats:t,t:o})=>e.jsx("div",{className:"absolute top-16 sm:top-20 left-3 z-20",children:e.jsxs("div",{className:"gap-4 w-fit flex-col flex items-start justify-start",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm text-white/90 drop-shadow-md",children:o("home.stats.delivery")}),e.jsx("span",{className:"font-bold text-white text-sm drop-shadow-md",children:t.order_count})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-accent"}),e.jsx("span",{className:"text-sm text-white/90 drop-shadow-md",children:o("home.stats.reservation")}),e.jsx("span",{className:"font-bold text-white text-sm drop-shadow-md",children:t.reserve_count})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl sm:text-2xl font-bold text-white drop-shadow-md",children:o("home.hero.brandName")}),e.jsx("img",{src:ve,alt:"map icon",width:32,height:32,loading:"eager",decoding:"async",className:"w-7 sm:w-8 h-7 sm:h-8 object-contain flex-shrink-0"})]})]})}));Ae.displayName="StatsDisplay";const gt=()=>{const t=()=>{try{return typeof window<"u"?window.innerWidth:1024}catch{return 1024}},o=()=>{try{return typeof navigator<"u"?navigator.connection:null}catch{return null}},l=()=>{try{return typeof navigator<"u"?navigator.deviceMemory:null}catch{return null}},s=t(),n=s<640,a=s>=1024,i=o();let m=!1,u=!1;try{m=Ke(),u=Xe()}catch(x){console.warn("[useLightweightMode] Environment detection failed:",x)}if(a)return!!i?.saveData;if(u&&!m||i&&(i.saveData||i.effectiveType==="2g"||i.effectiveType==="slow-2g"))return!0;const d=l();return!!(n&&d&&d<2)},De=r.memo(({template:t,isActive:o,currentLang:l,t:s,onContentReady:n,onAskXiaoxiong:a,onDIYCook:i})=>{const[m,u]=r.useState({}),[d,x]=r.useState({}),[f,h]=r.useState({}),[g,k]=r.useState({mobile:!0,tablet:!0,desktop:!0}),[N,S]=r.useState(!1),C=gt(),j=r.useRef(null),L=r.useRef(null),M=r.useRef(null),T=c=>t[`${c}${l==="zh"?"_zh":l==="pt"?"_pt":"_en"}`]||"",A=()=>{try{if(typeof window>"u")return"desktop";const c=window.innerWidth;return c<640?"mobile":c<1024?"tablet":"desktop"}catch{return"desktop"}},$=()=>{const c=A();return c==="mobile"&&t.mobile_overlay_opacity!==null?t.mobile_overlay_opacity:c==="tablet"&&t.tablet_overlay_opacity!==null?t.tablet_overlay_opacity:c==="desktop"&&t.desktop_overlay_opacity!==null?t.desktop_overlay_opacity:t.overlay_opacity??30},R=()=>{const c=$(),v=t.overlay_gradient_direction||"to-b",D=(P,ze)=>P==null?ze/100:P>1?P/100:P,w=c>1?c/100:c,ie=D(t.overlay_gradient_from_opacity,30)*w,X=D(t.overlay_gradient_via_opacity,25)*w,Q=D(t.overlay_gradient_to_opacity,40)*w,Te={"to-t":"to top","to-b":"to bottom","to-l":"to left","to-r":"to right","to-tl":"to top left","to-tr":"to top right","to-bl":"to bottom left","to-br":"to bottom right"}[v]||"to bottom",F={black:"0, 0, 0",white:"255, 255, 255",background:"0, 0, 0",foreground:"255, 255, 255",primary:"1, 100, 80",secondary:"240, 240, 240"},Le=F[t.overlay_gradient_from||"black"]||"0, 0, 0",Me=F[t.overlay_gradient_via||"black"]||"0, 0, 0",Re=F[t.overlay_gradient_to||"black"]||"0, 0, 0";return{background:`linear-gradient(${Te}, rgba(${Le}, ${ie}), rgba(${Me}, ${X}), rgba(${Re}, ${Q}))`}},z=t.mobile_image_url||Ce,E=t.tablet_image_url||t.desktop_image_url||Z,I=t.desktop_image_url||Z,p=t.background_blur||0,b=t.desktop_media_type||t.media_type||"image",y=t.tablet_media_type||t.media_type||"image",W=t.mobile_media_type||t.media_type||"image",ee=b==="video"&&!C,te=y==="video"&&!C,se=W==="video"&&!C,oe=se?t.mobile_video_url:null,ae=te?t.tablet_video_url||t.desktop_video_url:null,re=ee?t.desktop_video_url:null;r.useEffect(()=>{const c=A(),v=c==="mobile"?z:c==="tablet"?E:I;if(v){const D=new Image;D.onload=()=>{u(w=>({...w,[c]:!0})),k(w=>({...w,[c]:!0})),o&&(n?.(),setTimeout(()=>S(!0),100))},D.src=v}},[z,E,I,o,n]),r.useEffect(()=>{o&&m[A()]&&S(!0)},[o,m]);const q=c=>{x(v=>({...v,[c]:!0}))},K=(c,v)=>{console.error(`[HeroSlide] Video error on ${c}:`,v),h(D=>({...D,[c]:!0}))};return r.useEffect(()=>{if(!N||!o)return;let c=!1;try{c=He()}catch{}if(!c)return;const v=A(),w=(v==="mobile"?j:v==="tablet"?L:M).current;if(!w)return;const X=setTimeout(async()=>{try{w.muted=!0,w.playsInline=!0,w.setAttribute("webkit-playsinline","true"),await w.play(),console.log(`[HeroSlide] iOS video play successful on ${v}`)}catch(Q){console.error(`[HeroSlide] iOS video play failed on ${v}:`,Q),h(ne=>({...ne,[v]:!0}))}},150);return()=>clearTimeout(X)},[N,o]),e.jsxs("div",{className:_("absolute inset-0 w-full h-full transition-opacity duration-1000",o?"opacity-100 z-10":"opacity-0 z-0"),children:[e.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[e.jsxs("div",{className:"absolute inset-0 w-full h-full sm:hidden",children:[!g.mobile&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),se&&oe?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:z,alt:"Background",className:_("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",d.mobile&&!f.mobile?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:p>0?`blur(${p}px)`:void 0}}),N&&!f.mobile&&e.jsx("video",{ref:j,src:oe,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>q("mobile"),onError:c=>K("mobile",c),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:p>0?`blur(${p}px)`:void 0}})]}):e.jsx("img",{src:z,alt:"Background",className:_("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",g.mobile?"opacity-100":"opacity-0"),style:{filter:p>0?`blur(${p}px)`:void 0}})]}),e.jsxs("div",{className:"absolute inset-0 w-full h-full hidden sm:block lg:hidden",children:[!g.tablet&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),te&&ae?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:E,alt:"Background",className:_("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",d.tablet&&!f.tablet?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:p>0?`blur(${p}px)`:void 0}}),N&&!f.tablet&&e.jsx("video",{ref:L,src:ae,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>q("tablet"),onError:c=>K("tablet",c),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:p>0?`blur(${p}px)`:void 0}})]}):e.jsx("img",{src:E,alt:"Background",className:_("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",g.tablet?"opacity-100":"opacity-0"),style:{filter:p>0?`blur(${p}px)`:void 0}})]}),e.jsxs("div",{className:"absolute inset-0 w-full h-full hidden lg:block",children:[!g.desktop&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),ee&&re?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:I,alt:"Background",className:_("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",d.desktop&&!f.desktop?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:p>0?`blur(${p}px)`:void 0}}),N&&!f.desktop&&e.jsx("video",{ref:M,src:re,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>q("desktop"),onError:c=>K("desktop",c),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:p>0?`blur(${p}px)`:void 0}})]}):e.jsx("img",{src:I,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:_("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",g.desktop?"opacity-100":"opacity-0"),style:{filter:p>0?`blur(${p}px)`:void 0}})]}),e.jsx("div",{className:"absolute inset-0 w-full h-full",style:R()})]}),e.jsx("div",{className:"relative z-10 container mx-auto px-4 sm:px-6 flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center space-y-4 sm:space-y-8 animate-fade-in w-full",children:[e.jsx("h1",{className:"text-3xl sm:text-5xl md:text-7xl font-bold text-white leading-tight px-4 drop-shadow-[0_2px_8px_rgba(0,0,0,0.8)]",children:T("title")||s("home.hero.title")}),e.jsx("p",{className:"text-sm sm:text-xl md:text-2xl text-white/95 max-w-2xl mx-auto px-4 drop-shadow-[0_2px_6px_rgba(0,0,0,0.7)]",children:T("description")||s("home.hero.description")}),t.subtitle_button_text_zh&&e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsxs("button",{onClick:a,className:"group flex items-center gap-3 bg-white/20 backdrop-blur-xl text-white px-5 sm:px-7 py-3.5 sm:py-4 rounded-full shadow-[0_8px_32px_rgba(0,0,0,0.12)] hover:shadow-[0_16px_48px_rgba(0,0,0,0.2)] hover:bg-white/30 transition-all duration-300 cursor-text border border-white/40",children:[e.jsx(fe,{className:"w-5 h-5 text-white/90 group-hover:text-white transition-colors drop-shadow-sm"}),e.jsx("span",{className:"text-sm sm:text-base text-primary group-hover:text-primary/80 transition-colors drop-shadow-sm font-medium",children:T("subtitle_button_text")||s("home.hero.subtitle")}),e.jsx(ge,{className:"w-4 h-4 text-white/60 ml-2 drop-shadow-sm"})]}),e.jsxs("div",{className:"flex items-center gap-3 w-64",children:[e.jsx("div",{className:"flex-1 h-px bg-white/30"}),e.jsx("span",{className:"text-xs text-white/60",children:s("aiRecipe.or","或者")}),e.jsx("div",{className:"flex-1 h-px bg-white/30"})]}),e.jsxs("button",{onClick:i,className:"group flex items-center gap-3 bg-white/20 backdrop-blur-xl text-white px-5 sm:px-7 py-3.5 sm:py-4 rounded-full shadow-[0_8px_32px_rgba(0,0,0,0.12)] hover:shadow-[0_16px_48px_rgba(0,0,0,0.2)] hover:bg-white/30 transition-all duration-300 border border-white/40",children:[e.jsx(be,{className:"w-5 h-5 text-white/90 group-hover:text-white transition-colors drop-shadow-sm"}),e.jsx("span",{className:"text-sm sm:text-base text-primary group-hover:text-primary/80 transition-colors drop-shadow-sm font-medium",children:s("aiRecipe.diyCook","自己动手做")}),e.jsx(ye,{className:"w-4 h-4 text-white/70 group-hover:text-white/90 transition-colors drop-shadow-sm"})]})]})]})})]})});De.displayName="HeroSlide";const zt=()=>{const{t,i18n:o}=V(),l=H(),s=Ge(),{settings:n}=J(),{data:a,isLoading:i,refetch:m}=we(),[u,d]=r.useState(0),[x,f]=r.useState(null),h=r.useRef(null),[g,k]=r.useState(!1),[N,S]=r.useState(!1),C=ue(),{isWebView:j,isNativeApp:L}=We(),M=C||j,T=j||L,A=n?.ai_assistant_enabled!==!1,$=r.useCallback(()=>{k(!0)},[]);st({pageType:"home"});const R=r.useCallback(async()=>{try{const y=await(await fetch("https://v.xiaoxiong.pt/api/get_info")).json();y&&f({order_count:y.order_count||0,reserve_count:y.reserve_count||0})}catch(b){console.error("Failed to fetch stats:",b)}},[]);r.useEffect(()=>{R()},[R]);const z=r.useCallback(async()=>{s.removeQueries({queryKey:["homepage-templates"]}),s.removeQueries({queryKey:["restaurants"]}),s.removeQueries({queryKey:["activities"]}),s.removeQueries({queryKey:["recent-activities"]}),await Promise.all([m(),R(),s.invalidateQueries({queryKey:["restaurants"]}),s.invalidateQueries({queryKey:["activities"]}),s.invalidateQueries({queryKey:["recent-activities"]})])},[m,R,s]);r.useEffect(()=>{if(!a||a.length<=1)return;const y=a[u]?.duration||5e3;return h.current=setTimeout(()=>{d(W=>(W+1)%a.length)},y),()=>{h.current&&clearTimeout(h.current)}},[a,u]);const E=r.useCallback(b=>{h.current&&clearTimeout(h.current),d(b)},[]);r.useCallback(()=>{a&&(h.current&&clearTimeout(h.current),d(b=>(b-1+a.length)%a.length))},[a]),r.useCallback(()=>{a&&(h.current&&clearTimeout(h.current),d(b=>(b+1)%a.length))},[a]);const I=o.language,p=a&&a.length>1;return e.jsx(rt,{onRefresh:z,children:e.jsxs("div",{className:"min-h-screen",children:[M?e.jsx(je,{stats:x,onAskXiaoxiong:()=>S(!0)}):e.jsxs("section",{className:"relative h-screen flex items-start overflow-hidden bg-background",children:[x&&e.jsx(Ae,{stats:x,t}),e.jsx("div",{className:_("absolute inset-0 w-full h-full transition-opacity duration-500",g?"opacity-100":"opacity-0"),children:a?.map((b,y)=>e.jsx(De,{template:b,isActive:y===u,currentLang:I,t,onContentReady:y===0?$:void 0,onAskXiaoxiong:()=>S(!0),onDIYCook:()=>l("/ai-recipe")},b.id))}),e.jsx("div",{className:_("absolute inset-0 w-full h-full z-20 transition-opacity duration-500",i||!g?"opacity-100":"opacity-0 pointer-events-none"),children:e.jsx(qe,{})}),!i&&(!a||a.length===0)&&e.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[e.jsx("img",{src:Ce,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:"absolute inset-0 w-full h-full object-cover object-center sm:hidden"}),e.jsx("img",{src:Z,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:"absolute inset-0 w-full h-full object-cover object-center hidden sm:block"}),e.jsx("div",{className:"absolute inset-0 w-full h-full bg-gradient-to-b from-black/30 via-black/25 to-black/40"}),e.jsx("div",{className:"relative z-10 container mx-auto px-4 sm:px-6 flex items-center min-h-screen",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center space-y-4 sm:space-y-8 animate-fade-in w-full",children:[e.jsx("h1",{className:"text-3xl sm:text-5xl md:text-7xl font-bold text-white leading-tight px-4 drop-shadow-[0_2px_8px_rgba(0,0,0,0.8)]",children:t("home.hero.title")}),e.jsx("p",{className:"text-sm sm:text-xl md:text-2xl text-white/95 max-w-2xl mx-auto px-4 drop-shadow-[0_2px_6px_rgba(0,0,0,0.7)]",children:t("home.hero.description")})]})})]}),p&&e.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 z-30 flex gap-2",children:a.map((b,y)=>e.jsx("button",{onClick:()=>E(y),className:_("w-3 h-3 rounded-full transition-all duration-300",y===u?"bg-white w-8":"bg-white/50 hover:bg-white/70"),"aria-label":`Go to slide ${y+1}`},y))})]}),e.jsx(Se,{}),e.jsx("section",{className:"py-12 sm:py-20 px-4 bg-secondary/20",children:e.jsx("div",{className:"container mx-auto max-w-7xl",children:e.jsx(r.Suspense,{fallback:e.jsx("div",{className:"h-[400px] bg-muted/30 rounded-lg animate-pulse"}),children:e.jsx(ft,{})})})}),!T&&e.jsxs("section",{className:"py-16 sm:py-24 px-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 via-primary/3 to-primary/8",style:{maskImage:"radial-gradient(ellipse 80% 70% at 50% 50%, black 40%, transparent 100%)",WebkitMaskImage:"radial-gradient(ellipse 80% 70% at 50% 50%, black 40%, transparent 100%)"}}),e.jsx("div",{className:"absolute top-1/4 left-1/4 w-72 h-72 bg-primary/8 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-primary/5 rounded-full blur-3xl"}),e.jsx("div",{className:"container mx-auto max-w-5xl relative z-10",children:e.jsx("div",{className:"flex flex-col items-center justify-center gap-8",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-primary/10 text-primary text-sm font-medium px-4 py-2 rounded-full mb-4",children:[e.jsx(Ye,{className:"w-4 h-4"}),e.jsx("span",{children:"Mobile App"})]}),e.jsx("h3",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-foreground mb-4",children:t("home.app.title")}),e.jsx("p",{className:"text-base sm:text-lg text-muted-foreground mb-8 leading-relaxed",children:t("home.app.description")}),e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[e.jsxs("a",{href:"https://apps.apple.com/cn/app/xiaoxiong/id6755481369",target:"_blank",rel:"noopener noreferrer",className:"relative group",children:[e.jsx("div",{className:"absolute -inset-2 bg-gradient-to-r from-primary via-primary-glow to-primary rounded-2xl blur-lg opacity-40 group-hover:opacity-70 transition-opacity"}),e.jsx("div",{className:"relative bg-black hover:bg-gray-900 h-[52px] sm:h-[56px] w-[160px] sm:w-[180px] rounded-xl transition-all hover:scale-105 shadow-2xl hover:shadow-primary/30 border border-white/10 flex items-center justify-center",children:e.jsx("img",{src:et,alt:"Download on the App Store",width:108,height:36,className:"h-8 sm:h-9"})})]}),e.jsxs("a",{href:"https://play.google.com/store/apps/details?id=com.xiaoxiong.market",target:"_blank",rel:"noopener noreferrer",className:"relative group",children:[e.jsx("div",{className:"absolute -inset-2 bg-gradient-to-r from-primary via-primary-glow to-primary rounded-2xl blur-lg opacity-40 group-hover:opacity-70 transition-opacity"}),e.jsx("div",{className:"relative bg-black hover:bg-gray-900 h-[52px] sm:h-[56px] w-[160px] sm:w-[180px] rounded-xl transition-all hover:scale-105 shadow-2xl hover:shadow-primary/30 border border-white/10 flex items-center justify-center",children:e.jsx("img",{src:tt,alt:"Get it on Google Play",width:145,height:56,className:"h-12 sm:h-14"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Ze,{className:"w-4 h-4 animate-bounce"}),e.jsx("span",{children:t("home.app.downloadNow")})]})]})]})})})]}),e.jsxs("section",{className:"py-16 sm:py-20 px-4 bg-gradient-to-r from-primary/90 to-primary relative overflow-hidden rounded-3xl mx-4 sm:mx-8 lg:mx-16 mb-8",children:[e.jsx("div",{className:"absolute inset-0 bg-grid-pattern opacity-10"}),e.jsx("div",{className:"absolute top-0 right-0 w-64 sm:w-96 h-64 sm:h-96 bg-white/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-64 sm:w-96 h-64 sm:h-96 bg-white/10 rounded-full blur-3xl"}),e.jsxs("div",{className:"container mx-auto max-w-4xl text-center relative z-10",children:[e.jsx("h2",{className:"text-3xl sm:text-4xl md:text-5xl font-bold text-primary-foreground mb-4 sm:mb-6 px-4",children:t("home.cta.title")}),e.jsx("p",{className:"text-base sm:text-xl text-primary-foreground/90 mb-6 sm:mb-8 max-w-2xl mx-auto px-4",children:t("home.cta.description")}),e.jsx("div",{className:"flex justify-center",children:e.jsx(Y,{size:"lg",variant:"secondary",asChild:!0,className:"text-base sm:text-lg shadow-xl hover:shadow-2xl",children:e.jsxs(he,{to:"/join-us",children:[e.jsx(Je,{className:"mr-2 w-4 sm:w-5 h-4 sm:h-5"}),t("home.cta.button")]})})})]})]}),A&&e.jsx(ut,{open:N,onOpenChange:S})]})})};export{zt as default};
//# sourceMappingURL=Home-BOZLxUn4.js.map
