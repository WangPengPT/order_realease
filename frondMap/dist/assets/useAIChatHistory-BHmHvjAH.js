import{r as s}from"./vendor-react-DImbKuZP.js";import{u as m,s as i}from"./index-_G3CuCzp.js";const L=(t="what_to_eat")=>{const{user:e}=m(),[d,c]=s.useState(!1),[u,l]=s.useState(!1),y=s.useCallback(async()=>{if(!e?.id)return[];c(!0);try{const r=i.from("ai_chat_messages").select("role, content, created_at").eq("user_id",e.id).order("created_at",{ascending:!0}).limit(200);r.eq("chat_type",t);const{data:a,error:o}=await r;return o?(console.error("Load chat history error:",o),[]):(l(!0),(a||[]).map(n=>({role:n.role,content:n.content})))}catch(r){return console.error("Load chat history error:",r),[]}finally{c(!1)}},[e?.id,t]),_=s.useCallback(async(r,a)=>{if(!(!e?.id||!a.trim()))try{await i.from("ai_chat_messages").insert({user_id:e.id,role:r,content:a,chat_type:t})}catch(o){console.error("Save chat message error:",o)}},[e?.id,t]),h=s.useCallback(async()=>{if(e?.id)try{const r=i.from("ai_chat_messages").delete().eq("user_id",e.id);r.eq("chat_type",t),await r}catch(r){console.error("Clear chat history error:",r)}},[e?.id,t]);return{loadMessages:y,saveMessage:_,clearHistory:h,isLoadingHistory:d,historyLoaded:u}};export{L as u};
//# sourceMappingURL=useAIChatHistory-BHmHvjAH.js.map
