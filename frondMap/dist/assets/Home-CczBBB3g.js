import{p as U,u as ge,r as o,j as e,aW as ie,aX as Xe,aY as Qe,aZ as Ke,aw as ye,ay as ve,a_ as le,a$ as je,b0 as Ue,L as Ce,al as Ge,b1 as de,b2 as Se,b3 as Le,b4 as Ae,b5 as Ze,b6 as we,b7 as Ye,q as Je,b8 as et,b9 as tt,ba as st}from"./vendor-react-COnB1Bf9.js";import{a as Te,b as be,D as at,c as rt,d as ot,e as nt,f as it,I as lt,B as $,g as C,C as me,S as ct,s as dt,h as mt,o as ut,i as I,j as he,k as xt,H as ht,l as Re,m as Me,n as pt}from"./index-B-ATr_p9.js";import{c as ft,g as gt,m as ze}from"./geolocation-DRm3QMsJ.js";import{a as bt,g as yt}from"./app-store-badge-CyCtXXOt.js";import{u as De}from"./useHomepageTemplates-CBVWYgGD.js";import{u as vt}from"./usePageView-BMQdzT_N.js";import{u as jt,X as wt}from"./XiaoxiongChatContent-BWMml3lI.js";import{P as Nt}from"./PullToRefresh-D9ZdI0iA.js";import{P as kt,a as _t,b as Ct}from"./popover-B4Zdx0S9.js";import{u as St,a as Lt}from"./useRestaurants-qNgLbNB5.js";import{u as At,R as Tt,l as Rt}from"./xiaoxiong-logo-clean-wc8obKTK.js";import{u as Ee}from"./useLocalizedContent-pMHaJh_n.js";import{u as $e}from"./useActivities-CyjcT3q-.js";import{L as Mt}from"./LocationPermissionDialog-BCylfWqh.js";import{E as zt}from"./ExternalLinkConfirmDialog-DlGFCdLe.js";import{a as Ne,f as pe,K as Dt,L as ke,M as Et,i as $t}from"./vendor-utils-Z4kpnli5.js";import"./vendor-i18n-jtdHZIRR.js";import"./vendor-editor-B1vH4T8i.js";import"./vendor-supabase-CK3nEoYK.js";import"./vendor-map-CvE3ASYw.js";const It=({open:s,onOpenChange:a,provider:n="xiaoxiong-community"})=>{const{i18n:d}=U(),r=ge(),m=Te(),{settings:l}=be(),x=l?.logo_url,{input:i,setInput:c,messages:g,isLoading:u,showLocationDialog:b,setShowLocationDialog:v,pendingMessage:j,setPendingMessage:y,handleSubmit:R,handleKeyDown:_,handleLocationConfirm:B,processMessage:L,abortRequest:P,requestLocation:S}=jt(n);o.useEffect(()=>{s&&m&&(a(!1),r("/ask-xiaoxiong"))},[s,m,r,a]),o.useEffect(()=>{s&&!m&&S()},[s,m,S]);const M=()=>{P(),a(!1)},A=()=>d.language==="zh"?"小熊AI助手":d.language==="pt"?"Assistente IA Xiaoxiong":"Xiaoxiong AI Assistant";return m?null:e.jsx(at,{open:s,onOpenChange:M,children:e.jsxs(rt,{className:"sm:max-w-2xl sm:h-[90vh] sm:max-h-[90vh] flex flex-col p-0 gap-0 overflow-hidden",children:[e.jsx(ot,{className:"px-4 py-3 shrink-0 border-b",children:e.jsxs(nt,{className:"text-base font-semibold flex items-center gap-2",children:[x&&e.jsx("img",{src:x,alt:"Logo",className:"w-8 h-8 rounded-full object-cover"}),A()]})}),e.jsx("div",{className:"flex-1 min-h-0 flex flex-col overflow-hidden",children:e.jsx(wt,{messages:g,input:i,setInput:c,isLoading:u,showLocationDialog:b,setShowLocationDialog:v,pendingMessage:j,handleSubmit:R,handleKeyDown:_,handleLocationConfirm:B,processMessage:L,setPendingMessage:y,onClose:M,showBackButton:!1,showHeader:!1,className:"flex-1"})})]})})},_e=({restaurant:s,language:a})=>{const[n,d]=o.useState(999),r=o.useRef(null),m=s.type.slice(0,3).map((i,c)=>({key:`type-${c}`,label:i,variant:"secondary",color:void 0}));o.useEffect(()=>{const i=()=>{if(!r.current)return;const g=r.current,u=Array.from(g.querySelectorAll(".tag-badge"));if(u.length===0){setTimeout(i,50);return}const b=u[0]?.offsetTop;let v=u.length;for(let j=0;j<u.length;j++)if(u[j].offsetTop>b){v=j;break}v<u.length&&(v=Math.max(1,v-1)),d(v)};d(999);const c=setTimeout(i,100);return window.addEventListener("resize",i),()=>{clearTimeout(c),window.removeEventListener("resize",i)}},[m.length,s.id]);const l=m.slice(0,n),x=m.length>n;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{ref:r,className:"flex gap-1.5 flex-wrap flex-1",children:l.map(i=>e.jsx(C,{variant:i.variant,className:"text-xs font-medium whitespace-nowrap tag-badge",style:i.color?{backgroundColor:i.color,color:"white"}:void 0,children:i.label},i.key))}),x&&e.jsxs(kt,{children:[e.jsx(_t,{asChild:!0,children:e.jsx($,{variant:"ghost",size:"sm",className:"h-6 px-2 text-muted-foreground hover:text-foreground flex-shrink-0",children:e.jsx(Ue,{className:"h-4 w-4"})})}),e.jsx(Ct,{className:"w-80",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:m.map(i=>e.jsx(C,{variant:i.variant,className:"text-xs font-medium",style:i.color?{backgroundColor:i.color,color:"white"}:void 0,children:i.label},i.key))})})]})]})},Ft=()=>{const s=ge(),{t:a,i18n:n}=U(),{toast:d}=it(),{localizeRestaurant:r}=Ee(),[m,l]=o.useState(""),[x,i]=o.useState([]),[c,g]=o.useState(null),[u,b]=o.useState([]),[v,j]=o.useState(null),[y,R]=o.useState(null),[_,B]=o.useState(!1),[L,P]=o.useState(!1),[S,M]=o.useState(!1),A=o.useRef(null),z=o.useRef(null),F=o.useRef({}),[V,p]=o.useState(null),[w,G]=o.useState(!1),[ue,H]=o.useState(!1),[W,re]=o.useState(!1),[X,oe]=o.useState(!1),Z=4,{data:Y,isLoading:J}=St(m,x.length>0?x.join(","):void 0),{data:f=[]}=Lt(),{data:k=[]}=$e(),{data:D={}}=At(),N=k.filter(t=>(D[t.id]||0)>0),ee=t=>{i(h=>h.includes(t)?h.filter(T=>T!==t):[...h,t])},Q=()=>{H(!0)},te=async()=>{H(!1);try{const t=await gt();R({lat:t.coords.latitude,lng:t.coords.longitude}),d({title:a("restaurants.locationEnabled"),description:a("restaurants.sortByDistance")})}catch(t){console.error("Location error:",t)}},O=t=>{j(t),t&&!y&&Q()},ne=async t=>{if(c===t)g(null),b([]);else{g(t);const{data:h,error:T}=await dt.from("activity_restaurants").select("restaurant_id").eq("activity_id",t);T?(console.error("Error fetching activity restaurants:",T),b([])):b(h.map(We=>We.restaurant_id))}},K=Y?.map(t=>{const h=r(t);if(y){const T=ft(y.lat,y.lng,t.lat,t.lng);return{...h,distance:T}}return h})||[],se=c?K.filter(t=>u.includes(t.id)):K,E=v&&y?se.filter(t=>t.distance&&t.distance<=v).sort((t,h)=>(t.distance||0)-(h.distance||0)):y?se.sort((t,h)=>(t.distance||0)-(h.distance||0)):se.sort((t,h)=>(h.rating||0)-(t.rating||0)),ae=t=>{s(`/restaurant/${t.id}`)},q=t=>{p(t.id);const h=F.current[t.id];h&&h.scrollIntoView({behavior:"smooth",block:"center"})},xe=()=>{const t=document.getElementById("home-map-container");if(t)if(_)document.exitFullscreen&&document.exitFullscreen();else{if(A.current){const h=A.current.getCenter(),T=A.current.getZoom();z.current={center:[h.lng,h.lat],zoom:T}}t.requestFullscreen&&t.requestFullscreen()}};return o.useEffect(()=>{const t=()=>{const h=!!document.fullscreenElement;B(h),!h&&z.current&&A.current&&setTimeout(()=>{A.current?.jumpTo({center:z.current.center,zoom:z.current.zoom})},100)};return document.addEventListener("fullscreenchange",t),()=>{document.removeEventListener("fullscreenchange",t)}},[]),e.jsxs("div",{className:"animate-fade-in",children:[e.jsxs("div",{className:"text-left mb-6",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-foreground mb-2 sm:mb-3",children:a("nav.mapView")}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:a("map.subtitle")})]}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[e.jsx("div",{className:"flex-1 max-w-md",children:e.jsx(lt,{placeholder:a("restaurants.search"),value:m,onChange:t=>l(t.target.value),className:"h-11 bg-background/60 backdrop-blur-sm border-primary/20 focus:border-primary"})}),e.jsxs("div",{className:"flex gap-2 md:contents",children:[e.jsxs($,{variant:y?"default":"outline",onClick:y?void 0:Q,className:"flex-1 md:flex-initial gap-2 h-11 md:px-6",children:[e.jsx(ie,{className:`w-4 h-4 ${y?"animate-pulse":""}`}),e.jsx("span",{className:"md:hidden",children:a("restaurants.getLocationMobile")}),e.jsx("span",{className:"hidden md:inline",children:a(y?"restaurants.locationEnabled":"restaurants.getLocation")})]}),e.jsxs($,{variant:w?"default":"outline",onClick:()=>G(!w),className:"flex-1 md:flex-initial gap-2 h-11 md:px-6",children:[e.jsx(Xe,{className:"w-4 h-4"}),a("restaurants.filter")]})]})]}),w&&e.jsxs("div",{className:"space-y-3 bg-card/50 backdrop-blur-sm rounded-lg p-4 border border-border/50 animate-fade-in",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("span",{className:"text-sm font-semibold text-foreground",children:[a("restaurants.restaurantTypes"),":"]}),x.length>0&&e.jsx(C,{variant:"outline",className:"cursor-pointer hover:bg-destructive hover:text-destructive-foreground hover:scale-105 transition-all duration-200 px-2 py-0 text-xs h-5",onClick:()=>i([]),children:a("common.actions.clearFilter")}),f.length>8&&e.jsx($,{variant:"ghost",size:"sm",className:"h-5 px-2 text-xs text-primary hover:text-primary/80 ml-auto hidden sm:flex transition-all duration-200",onClick:()=>P(!L),children:a(L?"common.showLess":"common.showMore")})]}),e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx("div",{className:`hidden sm:flex gap-2 flex-wrap transition-all duration-300 ease-out ${L?"animate-expand-height":""}`,children:(L?f:f.slice(0,8)).map((t,h)=>e.jsx(C,{variant:x.includes(t)?"default":"secondary",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs whitespace-nowrap hover:scale-105 active:animate-tag-select ${x.includes(t)?"ring-2 ring-primary/30 shadow-sm":""}`,style:{animationDelay:`${h*30}ms`},onClick:()=>ee(t),children:t},t))}),e.jsxs("div",{className:"sm:hidden relative -mx-1 px-1",children:[e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide snap-x snap-mandatory scroll-smooth",children:f.map((t,h)=>e.jsx(C,{variant:x.includes(t)?"default":"secondary",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs whitespace-nowrap flex-shrink-0 snap-start hover:scale-105 active:animate-tag-select ${x.includes(t)?"ring-2 ring-primary/30 shadow-sm":""}`,style:{animationDelay:`${h*30}ms`},onClick:()=>ee(t),children:t},t))}),e.jsx("div",{className:"absolute left-0 top-0 bottom-2 w-4 bg-gradient-to-r from-card via-card/60 to-transparent pointer-events-none"}),e.jsx("div",{className:"absolute right-0 top-0 bottom-2 w-4 bg-gradient-to-l from-card via-card/60 to-transparent pointer-events-none"})]})]})]}),N.length>0&&e.jsxs("div",{className:"space-y-2 pt-1 border-t border-border/30",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("span",{className:"text-sm font-semibold text-foreground",children:[a("nav.activities"),":"]}),c&&e.jsx(C,{variant:"outline",className:"cursor-pointer hover:bg-destructive hover:text-destructive-foreground hover:scale-105 transition-all duration-200 px-2 py-0 text-xs h-5",onClick:()=>{g(null),b([])},children:a("common.actions.clearFilter")}),N.length>8&&e.jsx($,{variant:"ghost",size:"sm",className:"h-5 px-2 text-xs text-primary hover:text-primary/80 ml-auto hidden sm:flex transition-all duration-200",onClick:()=>M(!S),children:a(S?"common.showLess":"common.showMore")})]}),e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx("div",{className:`hidden sm:flex gap-2 flex-wrap transition-all duration-300 ease-out ${S?"animate-expand-height":""}`,children:(S?N:N.slice(0,8)).map((t,h)=>{const T=n.language==="zh"?t.badge_text_zh||t.title_zh:n.language==="pt"?t.badge_text_pt||t.title_pt:t.badge_text_en||t.title_en;return e.jsx(C,{variant:c===t.id?"default":"secondary",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs whitespace-nowrap hover:scale-105 active:animate-tag-select ${c===t.id?"ring-2 ring-primary/30 shadow-sm":""}`,style:{animationDelay:`${h*30}ms`},onClick:()=>ne(t.id),children:T},t.id)})}),e.jsxs("div",{className:"sm:hidden relative -mx-1 px-1",children:[e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide snap-x snap-mandatory scroll-smooth",children:N.map((t,h)=>{const T=n.language==="zh"?t.badge_text_zh||t.title_zh:n.language==="pt"?t.badge_text_pt||t.title_pt:t.badge_text_en||t.title_en;return e.jsx(C,{variant:c===t.id?"default":"secondary",className:`cursor-pointer transition-all duration-200 px-3 py-1.5 text-xs whitespace-nowrap flex-shrink-0 snap-start hover:scale-105 active:animate-tag-select ${c===t.id?"ring-2 ring-primary/30 shadow-sm":""}`,style:{animationDelay:`${h*30}ms`},onClick:()=>ne(t.id),children:T},t.id)})}),e.jsx("div",{className:"absolute left-0 top-0 bottom-2 w-4 bg-gradient-to-r from-card via-card/60 to-transparent pointer-events-none"}),e.jsx("div",{className:"absolute right-0 top-0 bottom-2 w-4 bg-gradient-to-l from-card via-card/60 to-transparent pointer-events-none"})]})]})]})]}),y&&e.jsxs("div",{className:"flex gap-2 flex-wrap items-center bg-muted/30 backdrop-blur-sm rounded-lg p-3 border border-primary/10",children:[e.jsxs("span",{className:"text-sm font-semibold text-primary",children:[a("restaurants.radius"),":"]}),e.jsx(C,{variant:v===null?"default":"secondary",className:"cursor-pointer hover:scale-105 transition-transform",onClick:()=>O(null),children:a("restaurants.allRestaurants")}),e.jsx(C,{variant:v===5?"default":"secondary",className:"cursor-pointer hover:scale-105 transition-transform",onClick:()=>O(5),children:a("restaurants.radius5km")}),e.jsx(C,{variant:v===10?"default":"secondary",className:"cursor-pointer hover:scale-105 transition-transform",onClick:()=>O(10),children:a("restaurants.radius10km")}),e.jsx(C,{variant:v===20?"default":"secondary",className:"cursor-pointer hover:scale-105 transition-transform",onClick:()=>O(20),children:a("restaurants.radius20km")})]})]}),!J&&E&&e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[e.jsx("div",{className:`w-full lg:flex-1 transition-all duration-300 ease-in-out ${W?"h-0 overflow-hidden lg:h-[500px]":"h-[400px] lg:h-[500px]"}`,children:e.jsxs("div",{id:"home-map-container",className:`${_?"fixed inset-0 z-50 bg-background":"w-full h-full"} rounded-xl overflow-hidden shadow-2xl border border-primary/10 relative group`,children:[e.jsx($,{variant:"secondary",size:"icon",className:"absolute bottom-4 right-4 z-10 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity",onClick:xe,children:_?e.jsx(Qe,{className:"w-5 h-5"}):e.jsx(Ke,{className:"w-5 h-5"})}),e.jsxs("div",{className:"h-full relative",children:[e.jsx(Tt,{restaurants:E,onRestaurantClick:ae,userLocation:y,radiusFilter:v,onMarkerClick:q,showViewDetailsButton:!0,onMapInit:t=>{A.current=t}}),e.jsxs("div",{className:"absolute bottom-4 left-4 z-10 pointer-events-none flex items-center gap-2 bg-background/80 backdrop-blur-sm px-3 py-2 rounded-full shadow-lg",children:[e.jsx("img",{src:Rt,alt:"Xiaoxiong Market Logo",className:"h-6 w-6 object-contain"}),e.jsx("span",{className:"text-sm font-semibold text-foreground whitespace-nowrap",children:n.language==="zh"?"小熊市场":"Xiaoxiong Market"})]})]})]})}),e.jsx($,{variant:"outline",size:"sm",className:"lg:hidden flex items-center justify-center gap-2 -mt-3 mb-1",onClick:()=>re(!W),children:W?e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"w-4 h-4"}),a("map.showMap")]}):e.jsxs(e.Fragment,{children:[e.jsx(ve,{className:"w-4 h-4"}),a("map.hideMap")]})}),e.jsxs("div",{className:"w-full lg:w-[420px] flex flex-col",children:[e.jsxs("div",{className:"mb-4 pb-4 border-b border-border",children:[e.jsxs("h2",{className:"text-xl sm:text-2xl font-bold text-foreground flex items-center gap-2",children:[e.jsx(le,{className:"w-6 h-6 text-primary"}),a("restaurants.title"),e.jsx(C,{variant:"secondary",className:"ml-2",children:E.length})]}),y&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-2 flex items-center gap-1.5",children:[e.jsx(ie,{className:"w-4 h-4"}),a("restaurants.sortedByDistance")]})]}),E.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(le,{className:"w-16 h-16 text-muted-foreground/40 mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-foreground mb-2",children:a("restaurants.noResults")}),e.jsx("p",{className:"text-muted-foreground max-w-xs",children:a("restaurants.noResultsDesc")})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"lg:hidden space-y-3 pb-4",children:[(X?E:E.slice(0,Z)).map(t=>e.jsx(me,{ref:h=>F.current[t.id]=h,className:`p-5 cursor-pointer hover:shadow-xl transition-all duration-300 hover:scale-[1.02] hover:border-primary/40 border-2 bg-gradient-to-br from-card to-card/50 backdrop-blur-sm ${V===t.id?"border-primary ring-2 ring-primary ring-offset-2":"border-transparent"}`,onClick:()=>ae(t),children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h3",{className:"font-bold text-lg text-foreground line-clamp-1 flex-1",children:t.name}),t.distance!==void 0&&e.jsxs("div",{className:"flex items-center gap-1.5 bg-primary/10 px-2.5 py-1 rounded-full w-fit",children:[e.jsx(ie,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"font-bold text-sm text-primary",children:t.distance<1?`${(t.distance*1e3).toFixed(0)} m`:`${t.distance.toFixed(1)} km`})]})]}),t.rating>0&&e.jsxs("div",{className:"flex items-center gap-1.5 bg-primary/10 px-2.5 py-1 rounded-full flex-shrink-0",children:[e.jsx(je,{className:"w-4 h-4",style:{fill:"#016450",color:"#016450"}}),e.jsx("span",{className:"font-bold text-sm text-primary",children:t.rating})]})]}),t.type&&t.type.length>0&&e.jsx(_e,{restaurant:t,language:n.language}),e.jsxs("div",{className:"flex items-start gap-2 text-sm text-muted-foreground",children:[e.jsx(le,{className:"w-4 h-4 mt-0.5 flex-shrink-0 text-primary/60"}),e.jsx("span",{className:"line-clamp-2",children:t.address})]})]})},t.id)),E.length>Z&&e.jsx($,{variant:"outline",className:"w-full mt-2 gap-2",onClick:()=>oe(!X),children:X?e.jsxs(e.Fragment,{children:[e.jsx(ve,{className:"w-4 h-4"}),a("map.collapseList")]}):e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"w-4 h-4"}),a("map.showAllRestaurants",{count:E.length})]})})]}),e.jsx(ct,{className:"hidden lg:block h-[420px] pr-4",children:e.jsx("div",{className:"space-y-3 pb-4",children:E.map(t=>e.jsx(me,{ref:h=>F.current[t.id]=h,className:`p-5 cursor-pointer hover:shadow-xl transition-all duration-300 hover:scale-[1.02] hover:border-primary/40 border-2 bg-gradient-to-br from-card to-card/50 backdrop-blur-sm ${V===t.id?"border-primary ring-2 ring-primary ring-offset-2":"border-transparent"}`,onClick:()=>ae(t),children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h3",{className:"font-bold text-lg text-foreground line-clamp-1 flex-1",children:t.name}),t.distance!==void 0&&e.jsxs("div",{className:"flex items-center gap-1.5 bg-primary/10 px-2.5 py-1 rounded-full w-fit",children:[e.jsx(ie,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"font-bold text-sm text-primary",children:t.distance<1?`${(t.distance*1e3).toFixed(0)} m`:`${t.distance.toFixed(1)} km`})]})]}),t.rating>0&&e.jsxs("div",{className:"flex items-center gap-1.5 bg-primary/10 px-2.5 py-1 rounded-full flex-shrink-0",children:[e.jsx(je,{className:"w-4 h-4",style:{fill:"#016450",color:"#016450"}}),e.jsx("span",{className:"font-bold text-sm text-primary",children:t.rating})]})]}),t.type&&t.type.length>0&&e.jsx(_e,{restaurant:t,language:n.language}),e.jsxs("div",{className:"flex items-start gap-2 text-sm text-muted-foreground",children:[e.jsx(le,{className:"w-4 h-4 mt-0.5 flex-shrink-0 text-primary/60"}),e.jsx("span",{className:"line-clamp-2",children:t.address})]})]})},t.id))})})]})]})]}),e.jsx(Mt,{open:ue,onOpenChange:H,onConfirm:te})]})},Ie=o.memo(({stats:s,onAskXiaoxiong:a})=>{const{t:n,i18n:d}=U(),{data:r}=De(),{buttons:m}=mt(),{settings:l}=be(),x=d.language,[i,c]=o.useState(!1),g=l?.about_us_button_mobile!==!1,u=m?.find(_=>_.label_zh==="演示"||_.link?.includes("v.xiaoxiong.pt"));u&&u.enabled!==!1&&u.visible!==!1&&u.show_on_mobile;const b=_=>!r||r.length===0?"":r[0][`${_}${x==="zh"?"_zh":x==="pt"?"_pt":"_en"}`]||"",v=b("title")||n("home.hero.title"),j=b("description")||n("home.hero.description"),y=b("subtitle_button_text")||n("home.hero.subtitle"),R=()=>{u?.link&&ut(u.link),c(!1)};return e.jsxs("section",{className:"min-h-[55vh] flex flex-col bg-secondary/20",children:[e.jsxs("div",{className:"pt-20 px-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl font-bold text-foreground",children:n("home.hero.brandName")}),e.jsx("img",{src:ze,alt:"map icon",width:28,height:28,loading:"eager",decoding:"async",className:"w-7 h-7 object-contain flex-shrink-0"})]}),g&&e.jsxs(Ce,{to:"/about-us",className:"flex items-center gap-1 px-2 py-1 text-xs bg-background/80 backdrop-blur-sm rounded-full border border-border/50 shadow-sm hover:bg-background transition-colors whitespace-nowrap flex-shrink-0",children:[e.jsx(Ge,{className:"w-3.5 h-3.5 text-primary flex-shrink-0"}),e.jsx("span",{className:"text-foreground/80",children:n("nav.aboutUs","关于我们")})]})]}),s&&e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(de,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:n("home.stats.delivery")}),e.jsx("span",{className:"font-bold text-foreground text-sm",children:s.order_count})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Se,{className:"w-4 h-4 text-accent"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:n("home.stats.reservation")}),e.jsx("span",{className:"font-bold text-foreground text-sm",children:s.reserve_count})]})]})]}),e.jsx("div",{className:"flex-1 flex flex-col items-center justify-center px-4 py-8",children:e.jsxs("div",{className:"max-w-md mx-auto text-center space-y-4",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground leading-tight",children:v}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground max-w-sm mx-auto",children:j}),e.jsx("div",{className:"pt-4",children:e.jsxs("button",{onClick:a,className:"group flex items-center gap-3 bg-secondary/50 backdrop-blur-sm text-foreground px-5 py-3.5 rounded-full shadow-sm hover:shadow-md hover:bg-secondary/70 transition-all duration-300 cursor-text border border-border/50 mx-auto",children:[e.jsx(Le,{className:"w-5 h-5 text-primary group-hover:text-primary/80 transition-colors"}),e.jsx("span",{className:"text-sm text-muted-foreground group-hover:text-foreground transition-colors",children:y}),e.jsx(Ae,{className:"w-4 h-4 text-muted-foreground/60 ml-2"})]})})]})}),e.jsx(zt,{open:i,onOpenChange:c,onConfirm:R,url:u?.link})]})});Ie.displayName="MobileHeroSection";const Bt=s=>!s||!Array.isArray(s)?!1:s.every(a=>typeof a=="object"&&a!==null&&"start"in a&&"end"in a&&typeof a.start=="number"&&typeof a.end=="number"),Pt=(s,a)=>{const n=pe(new Date(s.start_date)),d=s.end_date?pe(new Date(s.end_date)):null,r=pe(a);if(r<n||d&&r>d)return!1;switch(s.repeat_mode||"none"){case"none":return $t(n,r);case"daily":return!0;case"weekly":const l=Et(r);return s.repeat_weekday===l;case"monthly":const i=ke(r),c=s.repeat_month_day;return Bt(c)?c.some(j=>i>=j.start&&i<=j.end):!1;case"yearly":const g=Dt(r)+1,u=ke(r),b=s.repeat_yearly_month,v=s.repeat_yearly_day;return b===g&&v===u;default:return!1}},ce=s=>{switch(s.repeat_mode||"none"){case"none":return 0;case"weekly":return 1;case"monthly":return 2;case"yearly":return 3;case"daily":return 4;default:return 5}},Vt=()=>{const{data:s,isLoading:a}=$e(),n=o.useMemo(()=>{if(!s)return{today:[],tomorrow:[],dayAfterTomorrow:[]};const r=new Date,m=Ne(r,1),l=Ne(r,2),x=i=>s.filter(c=>c.visible&&c.status==="published").filter(c=>Pt(c,i)).sort((c,g)=>{const u=ce(c)-ce(g);return u!==0?u:c.pinned!==g.pinned?c.pinned?-1:1:(c.sort_order||0)-(g.sort_order||0)});return{today:x(r),tomorrow:x(m),dayAfterTomorrow:x(l)}},[s]),d=o.useMemo(()=>{const r=new Set,m=[];return n.today.forEach(l=>{r.has(l.id)||(r.add(l.id),m.push({...l,dayLabel:"today"}))}),n.tomorrow.forEach(l=>{r.has(l.id)||(r.add(l.id),m.push({...l,dayLabel:"tomorrow"}))}),n.dayAfterTomorrow.forEach(l=>{r.has(l.id)||(r.add(l.id),m.push({...l,dayLabel:"dayAfterTomorrow"}))}),m.sort((l,x)=>{const i=ce(l)-ce(x);return i!==0?i:l.pinned!==x.pinned?l.pinned?-1:1:(l.sort_order||0)-(x.sort_order||0)})},[n]);return{recentActivities:n,allRecentActivities:d,isLoading:a,hasActivities:d.length>0}},Fe=()=>{const[s,a]=o.useState(4);return o.useEffect(()=>{const n=()=>{const d=window.innerWidth;d<640?a(2):d<1024?a(3):a(4)};return n(),window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]),s},Be=o.memo(({activity:s,dayLabel:a})=>{const n=ge(),{t:d}=U(),{getLocalizedField:r}=Ee(),m=r(s,"title"),l=o.useMemo(()=>{switch(s.service_type){case"dine_in":return d("activities.serviceType.dine_in");case"takeaway":return d("activities.serviceType.takeaway");case"both":return d("activities.serviceType.both");default:return""}},[s.service_type,d]),x=()=>{n(`/activity/${s.id}`)};return e.jsxs(me,{className:"group cursor-pointer overflow-hidden hover:shadow-lg transition-all duration-300 border-border/50 bg-card",onClick:x,children:[e.jsxs("div",{className:"relative aspect-[16/10] overflow-hidden bg-muted",children:[s.image_url?e.jsx("img",{src:s.image_url,alt:m,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",loading:"lazy"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-primary/20 to-primary/5",children:e.jsx(Ze,{className:"w-12 h-12 text-primary/40"})}),e.jsx(C,{className:I("absolute top-2 left-2 text-xs font-medium",a===d("home.recentActivities.today")?"bg-primary text-primary-foreground":"bg-secondary text-secondary-foreground"),children:a}),s.pinned&&e.jsx(C,{className:"absolute top-2 right-2 text-xs bg-accent text-accent-foreground",children:d("activities.pinned")})]}),e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx("h3",{className:"font-medium text-sm leading-tight line-clamp-2 text-foreground group-hover:text-primary transition-colors",children:m}),e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[s.service_type==="dine_in"&&e.jsx(we,{className:"w-3 h-3 flex-shrink-0"}),s.service_type==="takeaway"&&e.jsx(de,{className:"w-3 h-3 flex-shrink-0"}),s.service_type==="both"&&e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"w-3 h-3 flex-shrink-0"}),e.jsx(de,{className:"w-3 h-3 flex-shrink-0"})]}),e.jsx("span",{className:"truncate",children:l})]})]})]})});Be.displayName="ActivityCard";const Pe=o.memo(()=>{const s=Fe();return e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4",children:Array.from({length:s}).map((a,n)=>e.jsxs(me,{className:"overflow-hidden",children:[e.jsx(he,{className:"aspect-[16/10] w-full"}),e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx(he,{className:"h-4 w-full"}),e.jsx(he,{className:"h-3 w-2/3"})]})]},n))})});Pe.displayName="LoadingSkeleton";const Ve=o.memo(()=>{const{t:s}=U(),{allRecentActivities:a,isLoading:n,hasActivities:d}=Vt(),r=Fe(),[m,l]=o.useState(!1),x=g=>{switch(g){case"today":return s("home.recentActivities.today");case"tomorrow":return s("home.recentActivities.tomorrow");case"dayAfterTomorrow":return s("home.recentActivities.dayAfterTomorrow");default:return""}},i=o.useMemo(()=>m?a:a.slice(0,r),[a,r,m]),c=a.length>r;return!n&&!d?null:e.jsx("section",{className:"py-8 sm:py-12 px-4 bg-secondary/20",children:e.jsxs("div",{className:"container mx-auto max-w-7xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-foreground",children:s("home.recentActivities.title")}),c&&!m&&e.jsx($,{variant:"ghost",size:"sm",className:"text-primary hover:text-primary/80",onClick:()=>l(!0),children:e.jsxs("span",{className:"flex items-center gap-1",children:[s("home.recentActivities.viewAll"),e.jsx(Ye,{className:"w-4 h-4"})]})}),m&&e.jsx($,{variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-foreground",onClick:()=>l(!1),children:e.jsx("span",{className:"flex items-center gap-1",children:s("home.recentActivities.collapse")})})]}),n?e.jsx(Pe,{}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4",children:i.map(g=>e.jsx(Be,{activity:g,dayLabel:x(g.dayLabel)},g.id))})]})})});Ve.displayName="RecentActivitiesSection";const fe="/images/sushi-ramen-hero.jpg",Oe="/images/sushi-ramen-mobile.jpg",qe=o.memo(({stats:s,t:a})=>e.jsx("div",{className:"absolute top-16 sm:top-20 left-3 z-20",children:e.jsxs("div",{className:"gap-4 w-fit flex-col flex items-start justify-start",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm text-white/90 drop-shadow-md",children:a("home.stats.delivery")}),e.jsx("span",{className:"font-bold text-white text-sm drop-shadow-md",children:s.order_count})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"w-4 h-4 text-accent"}),e.jsx("span",{className:"text-sm text-white/90 drop-shadow-md",children:a("home.stats.reservation")}),e.jsx("span",{className:"font-bold text-white text-sm drop-shadow-md",children:s.reserve_count})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl sm:text-2xl font-bold text-white drop-shadow-md",children:a("home.hero.brandName")}),e.jsx("img",{src:ze,alt:"map icon",width:32,height:32,loading:"eager",decoding:"async",className:"w-7 sm:w-8 h-7 sm:h-8 object-contain flex-shrink-0"})]})]})}));qe.displayName="StatsDisplay";const Ot=()=>{const s=window.innerWidth<640,a=window.innerWidth>=1024,n=navigator.connection,d=Me(),r=Re();return a?!!n?.saveData:!!(r&&!d||n&&(n.saveData||n.effectiveType==="2g"||n.effectiveType==="slow-2g")||s&&navigator.deviceMemory&&navigator.deviceMemory<2)},He=o.memo(({template:s,isActive:a,currentLang:n,t:d,onContentReady:r,onAskXiaoxiong:m})=>{const[l,x]=o.useState({}),[i,c]=o.useState({}),[g,u]=o.useState({}),[b,v]=o.useState({mobile:!0,tablet:!0,desktop:!0}),[j,y]=o.useState(!1),R=Ot(),_=o.useRef(null),B=o.useRef(null),L=o.useRef(null),P=f=>s[`${f}${n==="zh"?"_zh":n==="pt"?"_pt":"_en"}`]||"",S=()=>window.innerWidth<640?"mobile":window.innerWidth<1024?"tablet":"desktop",M=()=>{const f=S();return f==="mobile"&&s.mobile_overlay_opacity!==null?s.mobile_overlay_opacity:f==="tablet"&&s.tablet_overlay_opacity!==null?s.tablet_overlay_opacity:f==="desktop"&&s.desktop_overlay_opacity!==null?s.desktop_overlay_opacity:s.overlay_opacity??30},A=()=>{const f=M(),k=s.overlay_gradient_direction||"to-b",D=(q,xe)=>q==null?xe/100:q>1?q/100:q,N=f>1?f/100:f,ee=D(s.overlay_gradient_from_opacity,30)*N,Q=D(s.overlay_gradient_via_opacity,25)*N,te=D(s.overlay_gradient_to_opacity,40)*N,ne={"to-t":"to top","to-b":"to bottom","to-l":"to left","to-r":"to right","to-tl":"to top left","to-tr":"to top right","to-bl":"to bottom left","to-br":"to bottom right"}[k]||"to bottom",K={black:"0, 0, 0",white:"255, 255, 255",background:"0, 0, 0",foreground:"255, 255, 255",primary:"1, 100, 80",secondary:"240, 240, 240"},se=K[s.overlay_gradient_from||"black"]||"0, 0, 0",E=K[s.overlay_gradient_via||"black"]||"0, 0, 0",ae=K[s.overlay_gradient_to||"black"]||"0, 0, 0";return{background:`linear-gradient(${ne}, rgba(${se}, ${ee}), rgba(${E}, ${Q}), rgba(${ae}, ${te}))`}},z=s.mobile_image_url||Oe,F=s.tablet_image_url||s.desktop_image_url||fe,V=s.desktop_image_url||fe,p=s.background_blur||0,w=s.desktop_media_type||s.media_type||"image",G=s.tablet_media_type||s.media_type||"image",ue=s.mobile_media_type||s.media_type||"image",H=w==="video"&&!R,W=G==="video"&&!R,re=ue==="video"&&!R,X=re?s.mobile_video_url:null,oe=W?s.tablet_video_url||s.desktop_video_url:null,Z=H?s.desktop_video_url:null;o.useEffect(()=>{const f=S(),k=f==="mobile"?z:f==="tablet"?F:V;if(k){const D=new Image;D.onload=()=>{x(N=>({...N,[f]:!0})),v(N=>({...N,[f]:!0})),a&&(r?.(),setTimeout(()=>y(!0),100))},D.src=k}},[z,F,V,a,r]),o.useEffect(()=>{a&&l[S()]&&y(!0)},[a,l]);const Y=f=>{c(k=>({...k,[f]:!0}))},J=(f,k)=>{console.error(`[HeroSlide] Video error on ${f}:`,k),u(D=>({...D,[f]:!0}))};return o.useEffect(()=>{if(!j||!a||!pt())return;const k=S(),N=(k==="mobile"?_:k==="tablet"?B:L).current;if(!N)return;const Q=setTimeout(async()=>{try{N.muted=!0,N.playsInline=!0,N.setAttribute("webkit-playsinline","true"),await N.play(),console.log(`[HeroSlide] iOS video play successful on ${k}`)}catch(te){console.error(`[HeroSlide] iOS video play failed on ${k}:`,te),u(O=>({...O,[k]:!0}))}},150);return()=>clearTimeout(Q)},[j,a]),e.jsxs("div",{className:I("absolute inset-0 w-full h-full transition-opacity duration-1000",a?"opacity-100 z-10":"opacity-0 z-0"),children:[e.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[e.jsxs("div",{className:"absolute inset-0 w-full h-full sm:hidden",children:[!b.mobile&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),re&&X?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:z,alt:"Background",className:I("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",i.mobile&&!g.mobile?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:p>0?`blur(${p}px)`:void 0}}),j&&!g.mobile&&e.jsx("video",{ref:_,src:X,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>Y("mobile"),onError:f=>J("mobile",f),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:p>0?`blur(${p}px)`:void 0}})]}):e.jsx("img",{src:z,alt:"Background",className:I("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",b.mobile?"opacity-100":"opacity-0"),style:{filter:p>0?`blur(${p}px)`:void 0}})]}),e.jsxs("div",{className:"absolute inset-0 w-full h-full hidden sm:block lg:hidden",children:[!b.tablet&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),W&&oe?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:F,alt:"Background",className:I("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",i.tablet&&!g.tablet?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:p>0?`blur(${p}px)`:void 0}}),j&&!g.tablet&&e.jsx("video",{ref:B,src:oe,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>Y("tablet"),onError:f=>J("tablet",f),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:p>0?`blur(${p}px)`:void 0}})]}):e.jsx("img",{src:F,alt:"Background",className:I("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",b.tablet?"opacity-100":"opacity-0"),style:{filter:p>0?`blur(${p}px)`:void 0}})]}),e.jsxs("div",{className:"absolute inset-0 w-full h-full hidden lg:block",children:[!b.desktop&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),H&&Z?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:V,alt:"Background",className:I("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",i.desktop&&!g.desktop?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:p>0?`blur(${p}px)`:void 0}}),j&&!g.desktop&&e.jsx("video",{ref:L,src:Z,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>Y("desktop"),onError:f=>J("desktop",f),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:p>0?`blur(${p}px)`:void 0}})]}):e.jsx("img",{src:V,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:I("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",b.desktop?"opacity-100":"opacity-0"),style:{filter:p>0?`blur(${p}px)`:void 0}})]}),e.jsx("div",{className:"absolute inset-0 w-full h-full",style:A()})]}),e.jsx("div",{className:"relative z-10 container mx-auto px-4 sm:px-6 flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center space-y-4 sm:space-y-8 animate-fade-in w-full",children:[e.jsx("h1",{className:"text-3xl sm:text-5xl md:text-7xl font-bold text-white leading-tight px-4 drop-shadow-[0_2px_8px_rgba(0,0,0,0.8)]",children:P("title")||d("home.hero.title")}),e.jsx("p",{className:"text-sm sm:text-xl md:text-2xl text-white/95 max-w-2xl mx-auto px-4 drop-shadow-[0_2px_6px_rgba(0,0,0,0.7)]",children:P("description")||d("home.hero.description")}),s.subtitle_button_text_zh&&e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:m,className:"group flex items-center gap-3 bg-white/20 backdrop-blur-xl text-white px-5 sm:px-7 py-3.5 sm:py-4 rounded-full shadow-[0_8px_32px_rgba(0,0,0,0.12)] hover:shadow-[0_16px_48px_rgba(0,0,0,0.2)] hover:bg-white/30 transition-all duration-300 cursor-text border border-white/40",children:[e.jsx(Le,{className:"w-5 h-5 text-white/90 group-hover:text-white transition-colors drop-shadow-sm"}),e.jsx("span",{className:"text-sm sm:text-base text-primary group-hover:text-primary/80 transition-colors drop-shadow-sm font-medium",children:P("subtitle_button_text")||d("home.hero.subtitle")}),e.jsx(Ae,{className:"w-4 h-4 text-white/60 ml-2 drop-shadow-sm"})]})})]})})]})});He.displayName="HeroSlide";const cs=()=>{const{t:s,i18n:a}=U(),n=Je(),{settings:d}=be(),{data:r,isLoading:m,refetch:l}=De(),[x,i]=o.useState(0),[c,g]=o.useState(null),u=o.useRef(null),[b,v]=o.useState(!1),[j,y]=o.useState(!1),R=Te(),{isWebView:_}=xt(),B=R||_,L=d?.ai_assistant_enabled!==!1,P=d?.ai_provider||"xiaoxiong-community",S=o.useCallback(()=>{v(!0)},[]);vt({pageType:"home"});const M=o.useCallback(async()=>{try{const w=await(await fetch("https://v.xiaoxiong.pt/api/get_info")).json();w&&g({order_count:w.order_count||0,reserve_count:w.reserve_count||0})}catch(p){console.error("Failed to fetch stats:",p)}},[]);o.useEffect(()=>{M()},[M]);const A=o.useCallback(async()=>{n.removeQueries({queryKey:["homepage-templates"]}),n.removeQueries({queryKey:["restaurants"]}),n.removeQueries({queryKey:["activities"]}),n.removeQueries({queryKey:["recent-activities"]}),await Promise.all([l(),M(),n.invalidateQueries({queryKey:["restaurants"]}),n.invalidateQueries({queryKey:["activities"]}),n.invalidateQueries({queryKey:["recent-activities"]})])},[l,M,n]);o.useEffect(()=>{if(!r||r.length<=1)return;const w=r[x]?.duration||5e3;return u.current=setTimeout(()=>{i(G=>(G+1)%r.length)},w),()=>{u.current&&clearTimeout(u.current)}},[r,x]);const z=o.useCallback(p=>{u.current&&clearTimeout(u.current),i(p)},[]);o.useCallback(()=>{r&&(u.current&&clearTimeout(u.current),i(p=>(p-1+r.length)%r.length))},[r]),o.useCallback(()=>{r&&(u.current&&clearTimeout(u.current),i(p=>(p+1)%r.length))},[r]);const F=a.language,V=r&&r.length>1;return e.jsx(Nt,{onRefresh:A,children:e.jsxs("div",{className:"min-h-screen",children:[B?e.jsx(Ie,{stats:c,onAskXiaoxiong:()=>y(!0)}):e.jsxs("section",{className:"relative h-screen flex items-start overflow-hidden bg-background",children:[c&&e.jsx(qe,{stats:c,t:s}),e.jsx("div",{className:I("absolute inset-0 w-full h-full transition-opacity duration-500",b?"opacity-100":"opacity-0"),children:r?.map((p,w)=>e.jsx(He,{template:p,isActive:w===x,currentLang:F,t:s,onContentReady:w===0?S:void 0,onAskXiaoxiong:()=>y(!0)},p.id))}),e.jsx("div",{className:I("absolute inset-0 w-full h-full z-20 transition-opacity duration-500",m||!b?"opacity-100":"opacity-0 pointer-events-none"),children:e.jsx(ht,{})}),!m&&(!r||r.length===0)&&e.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[e.jsx("img",{src:Oe,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:"absolute inset-0 w-full h-full object-cover object-center sm:hidden"}),e.jsx("img",{src:fe,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:"absolute inset-0 w-full h-full object-cover object-center hidden sm:block"}),e.jsx("div",{className:"absolute inset-0 w-full h-full bg-gradient-to-b from-black/30 via-black/25 to-black/40"}),e.jsx("div",{className:"relative z-10 container mx-auto px-4 sm:px-6 flex items-center min-h-screen",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center space-y-4 sm:space-y-8 animate-fade-in w-full",children:[e.jsx("h1",{className:"text-3xl sm:text-5xl md:text-7xl font-bold text-white leading-tight px-4 drop-shadow-[0_2px_8px_rgba(0,0,0,0.8)]",children:s("home.hero.title")}),e.jsx("p",{className:"text-sm sm:text-xl md:text-2xl text-white/95 max-w-2xl mx-auto px-4 drop-shadow-[0_2px_6px_rgba(0,0,0,0.7)]",children:s("home.hero.description")})]})})]}),V&&e.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 z-30 flex gap-2",children:r.map((p,w)=>e.jsx("button",{onClick:()=>z(w),className:I("w-3 h-3 rounded-full transition-all duration-300",w===x?"bg-white w-8":"bg-white/50 hover:bg-white/70"),"aria-label":`Go to slide ${w+1}`},w))})]}),e.jsx(Ve,{}),e.jsx("section",{className:"py-12 sm:py-20 px-4 bg-secondary/20",children:e.jsx("div",{className:"container mx-auto max-w-7xl",children:e.jsx(Ft,{})})}),!Re()&&!Me()&&e.jsxs("section",{className:"py-16 sm:py-24 px-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 via-primary/3 to-primary/8",style:{maskImage:"radial-gradient(ellipse 80% 70% at 50% 50%, black 40%, transparent 100%)",WebkitMaskImage:"radial-gradient(ellipse 80% 70% at 50% 50%, black 40%, transparent 100%)"}}),e.jsx("div",{className:"absolute top-1/4 left-1/4 w-72 h-72 bg-primary/8 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-primary/5 rounded-full blur-3xl"}),e.jsx("div",{className:"container mx-auto max-w-5xl relative z-10",children:e.jsx("div",{className:"flex flex-col items-center justify-center gap-8",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-primary/10 text-primary text-sm font-medium px-4 py-2 rounded-full mb-4",children:[e.jsx(et,{className:"w-4 h-4"}),e.jsx("span",{children:"Mobile App"})]}),e.jsx("h3",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-foreground mb-4",children:s("home.app.title")}),e.jsx("p",{className:"text-base sm:text-lg text-muted-foreground mb-8 leading-relaxed",children:s("home.app.description")}),e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[e.jsxs("a",{href:"https://apps.apple.com/cn/app/xiaoxiong/id6755481369",target:"_blank",rel:"noopener noreferrer",className:"relative group",children:[e.jsx("div",{className:"absolute -inset-2 bg-gradient-to-r from-primary via-primary-glow to-primary rounded-2xl blur-lg opacity-40 group-hover:opacity-70 transition-opacity"}),e.jsx("div",{className:"relative bg-black hover:bg-gray-900 h-[52px] sm:h-[56px] w-[160px] sm:w-[180px] rounded-xl transition-all hover:scale-105 shadow-2xl hover:shadow-primary/30 border border-white/10 flex items-center justify-center",children:e.jsx("img",{src:bt,alt:"Download on the App Store",className:"h-8 sm:h-9"})})]}),e.jsxs("a",{href:"https://play.google.com/store/apps/details?id=com.xiaoxiong.market",target:"_blank",rel:"noopener noreferrer",className:"relative group",children:[e.jsx("div",{className:"absolute -inset-2 bg-gradient-to-r from-primary via-primary-glow to-primary rounded-2xl blur-lg opacity-40 group-hover:opacity-70 transition-opacity"}),e.jsx("div",{className:"relative bg-black hover:bg-gray-900 h-[52px] sm:h-[56px] w-[160px] sm:w-[180px] rounded-xl transition-all hover:scale-105 shadow-2xl hover:shadow-primary/30 border border-white/10 flex items-center justify-center",children:e.jsx("img",{src:yt,alt:"Get it on Google Play",className:"h-12 sm:h-14"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(tt,{className:"w-4 h-4 animate-bounce"}),e.jsx("span",{children:s("home.app.downloadNow")})]})]})]})})})]}),e.jsxs("section",{className:"py-16 sm:py-20 px-4 bg-gradient-to-r from-primary/90 to-primary relative overflow-hidden rounded-3xl mx-4 sm:mx-8 lg:mx-16 mb-8",children:[e.jsx("div",{className:"absolute inset-0 bg-grid-pattern opacity-10"}),e.jsx("div",{className:"absolute top-0 right-0 w-64 sm:w-96 h-64 sm:h-96 bg-white/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-64 sm:w-96 h-64 sm:h-96 bg-white/10 rounded-full blur-3xl"}),e.jsxs("div",{className:"container mx-auto max-w-4xl text-center relative z-10",children:[e.jsx("h2",{className:"text-3xl sm:text-4xl md:text-5xl font-bold text-primary-foreground mb-4 sm:mb-6 px-4",children:s("home.cta.title")}),e.jsx("p",{className:"text-base sm:text-xl text-primary-foreground/90 mb-6 sm:mb-8 max-w-2xl mx-auto px-4",children:s("home.cta.description")}),e.jsx("div",{className:"flex justify-center",children:e.jsx($,{size:"lg",variant:"secondary",asChild:!0,className:"text-base sm:text-lg shadow-xl hover:shadow-2xl",children:e.jsxs(Ce,{to:"/join-us",children:[e.jsx(st,{className:"mr-2 w-4 sm:w-5 h-4 sm:h-5"}),s("home.cta.button")]})})})]})]}),L&&e.jsx(It,{open:j,onOpenChange:y,provider:P})]})})};export{cs as default};
//# sourceMappingURL=Home-CczBBB3g.js.map
