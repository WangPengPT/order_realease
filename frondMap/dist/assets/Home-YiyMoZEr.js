const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/HomeMapSection-CGmZdEXF.js","assets/vendor-react-DrIUZWbh.js","assets/vendor-i18n-jtdHZIRR.js","assets/vendor-editor-B1vH4T8i.js","assets/vendor-utils-vwQGbBim.js","assets/vendor-react-CG6K1Se3.css","assets/textFormatting-CiiJqHSA.js","assets/index-DBaPCe8F.js","assets/vendor-supabase-CcV0KC8v.js","assets/index-BswLKXTb.css","assets/popover-d6rkpjKU.js","assets/useRestaurants-6WaFFlUP.js","assets/geolocation-YPf7LJYy.js","assets/xiaoxiong-logo-clean-Bgkqu53e.js","assets/vendor-map-CvE3ASYw.js","assets/vendor-map-BbyR9nQ0.css","assets/map-icon-DR07RZr_.js","assets/useLocalizedContent-BuhQuGhE.js","assets/useActivities-CeFKZbzi.js","assets/LocationPermissionDialog-CnKaJRt8.js"])))=>i.map(i=>d[i]);
import{a as de,b as Y,D as Me,c as ze,d as Ee,e as Re,f as Ie,o as $e,C as me,B as ie,g as N,S as Q,h as U,_ as Pe,i as Ve,j as Be,H as Oe,k as He,l as We}from"./index-DBaPCe8F.js";import{p as P,u as ue,r as i,j as e,L as xe,al as qe,aW as B,aX as he,aY as pe,aZ as fe,a_ as Ke,a$ as ne,b0 as Xe,q as Qe,b1 as Fe,b2 as Ue,b3 as Ge}from"./vendor-react-DrIUZWbh.js";import{m as ge}from"./map-icon-DR07RZr_.js";import{a as Ye,g as Ze}from"./app-store-badge-CyCtXXOt.js";import{u as be}from"./useHomepageTemplates-DtWzB4iC.js";import{u as Je}from"./usePageView-CySWTzqt.js";import{u as et,X as tt}from"./XiaoxiongChatContent-BHEwZVdu.js";import{P as st}from"./PullToRefresh-DeeApRUq.js";import{E as at}from"./ExternalLinkConfirmDialog-DuzxnM1z.js";import{u as ot}from"./useActivities-CeFKZbzi.js";import{a as le,f as F,K as rt,L as ce,M as it,i as nt}from"./vendor-utils-vwQGbBim.js";import{u as lt}from"./useLocalizedContent-BuhQuGhE.js";import"./vendor-supabase-CcV0KC8v.js";import"./vendor-editor-B1vH4T8i.js";import"./vendor-i18n-jtdHZIRR.js";import"./LocationPermissionDialog-CnKaJRt8.js";const ct=({open:t,onOpenChange:a})=>{const{i18n:o}=P(),n=ue(),s=de(),{settings:d}=Y(),r=d?.logo_url,m=d?.ai_provider||"xiaoxiong-community",{input:h,setInput:c,messages:x,isLoading:u,showLocationDialog:f,setShowLocationDialog:k,pendingMessage:v,setPendingMessage:_,handleSubmit:S,handleKeyDown:j,handleLocationConfirm:T,processMessage:L,abortRequest:M,requestLocation:C}=et(m);i.useEffect(()=>{t&&s&&(a(!1),n("/ask-xiaoxiong"))},[t,s,n,a]),i.useEffect(()=>{t&&!s&&C()},[t,s,C]);const z=()=>{M(),a(!1)},D=()=>o.language==="zh"?"小熊AI助手":o.language==="pt"?"Assistente IA Xiaoxiong":"Xiaoxiong AI Assistant";return s?null:e.jsx(Me,{open:t,onOpenChange:z,children:e.jsxs(ze,{className:"sm:max-w-2xl sm:h-[90vh] sm:max-h-[90vh] flex flex-col p-0 gap-0 overflow-hidden",children:[e.jsx(Ee,{className:"px-4 py-3 shrink-0 border-b",children:e.jsxs(Re,{className:"text-base font-semibold flex items-center gap-2",children:[r&&e.jsx("img",{src:r,alt:"Logo",className:"w-8 h-8 rounded-full object-cover"}),D()]})}),e.jsx("div",{className:"flex-1 min-h-0 flex flex-col overflow-hidden",children:e.jsx(tt,{messages:x,input:h,setInput:c,isLoading:u,showLocationDialog:f,setShowLocationDialog:k,pendingMessage:v,handleSubmit:S,handleKeyDown:j,handleLocationConfirm:T,processMessage:L,setPendingMessage:_,onClose:z,showBackButton:!1,showHeader:!1,className:"flex-1"})})]})})},ye=i.memo(({stats:t,onAskXiaoxiong:a})=>{const{t:o,i18n:n}=P(),{data:s}=be(),{buttons:d}=Ie(),{settings:r}=Y(),m=n.language,[h,c]=i.useState(!1),x=r?.about_us_button_mobile!==!1,u=d?.find(j=>j.label_zh==="演示"||j.link?.includes("v.xiaoxiong.pt"));u&&u.enabled!==!1&&u.visible!==!1&&u.show_on_mobile;const f=j=>!s||s.length===0?"":s[0][`${j}${m==="zh"?"_zh":m==="pt"?"_pt":"_en"}`]||"",k=f("title")||o("home.hero.title"),v=f("description")||o("home.hero.description"),_=f("subtitle_button_text")||o("home.hero.subtitle"),S=()=>{u?.link&&$e(u.link),c(!1)};return e.jsxs("section",{className:"min-h-[55vh] flex flex-col bg-secondary/20",children:[e.jsxs("div",{className:"pt-20 px-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl font-bold text-foreground",children:o("home.hero.brandName")}),e.jsx("img",{src:ge,alt:"map icon",width:28,height:28,loading:"eager",decoding:"async",className:"w-7 h-7 object-contain flex-shrink-0"})]}),x&&e.jsxs(xe,{to:"/about-us",className:"flex items-center gap-1 px-2 py-1 text-xs bg-background/80 backdrop-blur-sm rounded-full border border-border/50 shadow-sm hover:bg-background transition-colors whitespace-nowrap flex-shrink-0",children:[e.jsx(qe,{className:"w-3.5 h-3.5 text-primary flex-shrink-0"}),e.jsx("span",{className:"text-foreground/80",children:o("nav.aboutUs","关于我们")})]})]}),t&&e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(B,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:o("home.stats.delivery")}),e.jsx("span",{className:"font-bold text-foreground text-sm",children:t.order_count})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(he,{className:"w-4 h-4 text-accent"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:o("home.stats.reservation")}),e.jsx("span",{className:"font-bold text-foreground text-sm",children:t.reserve_count})]})]})]}),e.jsx("div",{className:"flex-1 flex flex-col items-center justify-center px-4 py-8",children:e.jsxs("div",{className:"max-w-md mx-auto text-center space-y-4",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground leading-tight",children:k}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground max-w-sm mx-auto",children:v}),e.jsx("div",{className:"pt-4",children:e.jsxs("button",{onClick:a,className:"group flex items-center gap-3 bg-secondary/50 backdrop-blur-sm text-foreground px-5 py-3.5 rounded-full shadow-sm hover:shadow-md hover:bg-secondary/70 transition-all duration-300 cursor-text border border-border/50 mx-auto",children:[e.jsx(pe,{className:"w-5 h-5 text-primary group-hover:text-primary/80 transition-colors"}),e.jsx("span",{className:"text-sm text-muted-foreground group-hover:text-foreground transition-colors",children:_}),e.jsx(fe,{className:"w-4 h-4 text-muted-foreground/60 ml-2"})]})})]})}),e.jsx(at,{open:h,onOpenChange:c,onConfirm:S,url:u?.link})]})});ye.displayName="MobileHeroSection";const dt=t=>!t||!Array.isArray(t)?!1:t.every(a=>typeof a=="object"&&a!==null&&"start"in a&&"end"in a&&typeof a.start=="number"&&typeof a.end=="number"),mt=(t,a)=>{const o=F(new Date(t.start_date)),n=t.end_date?F(new Date(t.end_date)):null,s=F(a);if(s<o||n&&s>n)return!1;switch(t.repeat_mode||"none"){case"none":return nt(o,s);case"daily":return!0;case"weekly":const r=it(s);return t.repeat_weekday===r;case"monthly":const h=ce(s),c=t.repeat_month_day;return dt(c)?c.some(v=>h>=v.start&&h<=v.end):!1;case"yearly":const x=rt(s)+1,u=ce(s),f=t.repeat_yearly_month,k=t.repeat_yearly_day;return f===x&&k===u;default:return!1}},V=t=>{switch(t.repeat_mode||"none"){case"none":return 0;case"weekly":return 1;case"monthly":return 2;case"yearly":return 3;case"daily":return 4;default:return 5}},ut=()=>{const{data:t,isLoading:a}=ot(),o=i.useMemo(()=>{if(!t)return{today:[],tomorrow:[],dayAfterTomorrow:[]};const s=new Date,d=le(s,1),r=le(s,2),m=h=>t.filter(c=>c.visible&&c.status==="published").filter(c=>mt(c,h)).sort((c,x)=>{const u=V(c)-V(x);return u!==0?u:c.pinned!==x.pinned?c.pinned?-1:1:(c.sort_order||0)-(x.sort_order||0)});return{today:m(s),tomorrow:m(d),dayAfterTomorrow:m(r)}},[t]),n=i.useMemo(()=>{const s=new Set,d=[];return o.today.forEach(r=>{s.has(r.id)||(s.add(r.id),d.push({...r,dayLabel:"today"}))}),o.tomorrow.forEach(r=>{s.has(r.id)||(s.add(r.id),d.push({...r,dayLabel:"tomorrow"}))}),o.dayAfterTomorrow.forEach(r=>{s.has(r.id)||(s.add(r.id),d.push({...r,dayLabel:"dayAfterTomorrow"}))}),d.sort((r,m)=>{const h=V(r)-V(m);return h!==0?h:r.pinned!==m.pinned?r.pinned?-1:1:(r.sort_order||0)-(m.sort_order||0)})},[o]);return{recentActivities:o,allRecentActivities:n,isLoading:a,hasActivities:n.length>0}},ve=()=>{const[t,a]=i.useState(4);return i.useEffect(()=>{const o=()=>{const n=window.innerWidth;n<640?a(2):n<1024?a(3):a(4)};return o(),window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[]),t},we=i.memo(({activity:t,dayLabel:a})=>{const o=ue(),{t:n}=P(),{getLocalizedField:s}=lt(),d=s(t,"title"),r=i.useMemo(()=>{switch(t.service_type){case"dine_in":return n("activities.serviceType.dine_in");case"takeaway":return n("activities.serviceType.takeaway");case"both":return n("activities.serviceType.both");default:return""}},[t.service_type,n]),m=()=>{o(`/activity/${t.id}`)};return e.jsxs(me,{className:"group cursor-pointer overflow-hidden hover:shadow-lg transition-all duration-300 border-border/50 bg-card",onClick:m,children:[e.jsxs("div",{className:"relative aspect-[16/10] overflow-hidden bg-muted",children:[t.image_url?e.jsx("img",{src:t.image_url,alt:d,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",loading:"lazy"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-primary/20 to-primary/5",children:e.jsx(Ke,{className:"w-12 h-12 text-primary/40"})}),e.jsx(ie,{className:N("absolute top-2 left-2 text-xs font-medium",a===n("home.recentActivities.today")?"bg-primary text-primary-foreground":"bg-secondary text-secondary-foreground"),children:a}),t.pinned&&e.jsx(ie,{className:"absolute top-2 right-2 text-xs bg-accent text-accent-foreground",children:n("activities.pinned")})]}),e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx("h3",{className:"font-medium text-sm leading-tight line-clamp-2 text-foreground group-hover:text-primary transition-colors",children:d}),e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[t.service_type==="dine_in"&&e.jsx(ne,{className:"w-3 h-3 flex-shrink-0"}),t.service_type==="takeaway"&&e.jsx(B,{className:"w-3 h-3 flex-shrink-0"}),t.service_type==="both"&&e.jsxs(e.Fragment,{children:[e.jsx(ne,{className:"w-3 h-3 flex-shrink-0"}),e.jsx(B,{className:"w-3 h-3 flex-shrink-0"})]}),e.jsx("span",{className:"truncate",children:r})]})]})]})});we.displayName="ActivityCard";const je=i.memo(()=>{const t=ve();return e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4",children:Array.from({length:t}).map((a,o)=>e.jsxs(me,{className:"overflow-hidden",children:[e.jsx(Q,{className:"aspect-[16/10] w-full"}),e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx(Q,{className:"h-4 w-full"}),e.jsx(Q,{className:"h-3 w-2/3"})]})]},o))})});je.displayName="LoadingSkeleton";const Ne=i.memo(()=>{const{t}=P(),{allRecentActivities:a,isLoading:o,hasActivities:n}=ut(),s=ve(),[d,r]=i.useState(!1),m=x=>{switch(x){case"today":return t("home.recentActivities.today");case"tomorrow":return t("home.recentActivities.tomorrow");case"dayAfterTomorrow":return t("home.recentActivities.dayAfterTomorrow");default:return""}},h=i.useMemo(()=>d?a:a.slice(0,s),[a,s,d]),c=a.length>s;return!o&&!n?null:e.jsx("section",{className:"py-8 sm:py-12 px-4 bg-secondary/20",children:e.jsxs("div",{className:"container mx-auto max-w-7xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-foreground",children:t("home.recentActivities.title")}),c&&!d&&e.jsx(U,{variant:"ghost",size:"sm",className:"text-primary hover:text-primary/80",onClick:()=>r(!0),children:e.jsxs("span",{className:"flex items-center gap-1",children:[t("home.recentActivities.viewAll"),e.jsx(Xe,{className:"w-4 h-4"})]})}),d&&e.jsx(U,{variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-foreground",onClick:()=>r(!1),children:e.jsx("span",{className:"flex items-center gap-1",children:t("home.recentActivities.collapse")})})]}),o?e.jsx(je,{}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4",children:h.map(x=>e.jsx(we,{activity:x,dayLabel:m(x.dayLabel)},x.id))})]})})});Ne.displayName="RecentActivitiesSection";const G="/images/sushi-ramen-hero.jpg",_e="/images/sushi-ramen-mobile.jpg",xt=i.lazy(()=>Pe(()=>import("./HomeMapSection-CGmZdEXF.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]))),ke=i.memo(({stats:t,t:a})=>e.jsx("div",{className:"absolute top-16 sm:top-20 left-3 z-20",children:e.jsxs("div",{className:"gap-4 w-fit flex-col flex items-start justify-start",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-sm text-white/90 drop-shadow-md",children:a("home.stats.delivery")}),e.jsx("span",{className:"font-bold text-white text-sm drop-shadow-md",children:t.order_count})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"w-4 h-4 text-accent"}),e.jsx("span",{className:"text-sm text-white/90 drop-shadow-md",children:a("home.stats.reservation")}),e.jsx("span",{className:"font-bold text-white text-sm drop-shadow-md",children:t.reserve_count})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl sm:text-2xl font-bold text-white drop-shadow-md",children:a("home.hero.brandName")}),e.jsx("img",{src:ge,alt:"map icon",width:32,height:32,loading:"eager",decoding:"async",className:"w-7 sm:w-8 h-7 sm:h-8 object-contain flex-shrink-0"})]})]})}));ke.displayName="StatsDisplay";const ht=()=>{const t=()=>{try{return typeof window<"u"?window.innerWidth:1024}catch{return 1024}},a=()=>{try{return typeof navigator<"u"?navigator.connection:null}catch{return null}},o=()=>{try{return typeof navigator<"u"?navigator.deviceMemory:null}catch{return null}},n=t(),s=n<640,d=n>=1024,r=a();let m=!1,h=!1;try{m=He(),h=We()}catch(x){console.warn("[useLightweightMode] Environment detection failed:",x)}if(d)return!!r?.saveData;if(h&&!m||r&&(r.saveData||r.effectiveType==="2g"||r.effectiveType==="slow-2g"))return!0;const c=o();return!!(s&&c&&c<2)},Se=i.memo(({template:t,isActive:a,currentLang:o,t:n,onContentReady:s,onAskXiaoxiong:d})=>{const[r,m]=i.useState({}),[h,c]=i.useState({}),[x,u]=i.useState({}),[f,k]=i.useState({mobile:!0,tablet:!0,desktop:!0}),[v,_]=i.useState(!1),S=ht(),j=i.useRef(null),T=i.useRef(null),L=i.useRef(null),M=l=>t[`${l}${o==="zh"?"_zh":o==="pt"?"_pt":"_en"}`]||"",C=()=>{try{if(typeof window>"u")return"desktop";const l=window.innerWidth;return l<640?"mobile":l<1024?"tablet":"desktop"}catch{return"desktop"}},z=()=>{const l=C();return l==="mobile"&&t.mobile_overlay_opacity!==null?t.mobile_overlay_opacity:l==="tablet"&&t.tablet_overlay_opacity!==null?t.tablet_overlay_opacity:l==="desktop"&&t.desktop_overlay_opacity!==null?t.desktop_overlay_opacity:t.overlay_opacity??30},D=()=>{const l=z(),y=t.overlay_gradient_direction||"to-b",A=($,Le)=>$==null?Le/100:$>1?$/100:$,w=l>1?l/100:l,oe=A(t.overlay_gradient_from_opacity,30)*w,q=A(t.overlay_gradient_via_opacity,25)*w,K=A(t.overlay_gradient_to_opacity,40)*w,Ce={"to-t":"to top","to-b":"to bottom","to-l":"to left","to-r":"to right","to-tl":"to top left","to-tr":"to top right","to-bl":"to bottom left","to-br":"to bottom right"}[y]||"to bottom",X={black:"0, 0, 0",white:"255, 255, 255",background:"0, 0, 0",foreground:"255, 255, 255",primary:"1, 100, 80",secondary:"240, 240, 240"},Ae=X[t.overlay_gradient_from||"black"]||"0, 0, 0",De=X[t.overlay_gradient_via||"black"]||"0, 0, 0",Te=X[t.overlay_gradient_to||"black"]||"0, 0, 0";return{background:`linear-gradient(${Ce}, rgba(${Ae}, ${oe}), rgba(${De}, ${q}), rgba(${Te}, ${K}))`}},E=t.mobile_image_url||_e,R=t.tablet_image_url||t.desktop_image_url||G,I=t.desktop_image_url||G,p=t.background_blur||0,g=t.desktop_media_type||t.media_type||"image",b=t.tablet_media_type||t.media_type||"image",O=t.mobile_media_type||t.media_type||"image",Z=g==="video"&&!S,J=b==="video"&&!S,ee=O==="video"&&!S,te=ee?t.mobile_video_url:null,se=J?t.tablet_video_url||t.desktop_video_url:null,ae=Z?t.desktop_video_url:null;i.useEffect(()=>{const l=C(),y=l==="mobile"?E:l==="tablet"?R:I;if(y){const A=new Image;A.onload=()=>{m(w=>({...w,[l]:!0})),k(w=>({...w,[l]:!0})),a&&(s?.(),setTimeout(()=>_(!0),100))},A.src=y}},[E,R,I,a,s]),i.useEffect(()=>{a&&r[C()]&&_(!0)},[a,r]);const H=l=>{c(y=>({...y,[l]:!0}))},W=(l,y)=>{console.error(`[HeroSlide] Video error on ${l}:`,y),u(A=>({...A,[l]:!0}))};return i.useEffect(()=>{if(!v||!a)return;let l=!1;try{l=Ve()}catch{}if(!l)return;const y=C(),w=(y==="mobile"?j:y==="tablet"?T:L).current;if(!w)return;const q=setTimeout(async()=>{try{w.muted=!0,w.playsInline=!0,w.setAttribute("webkit-playsinline","true"),await w.play(),console.log(`[HeroSlide] iOS video play successful on ${y}`)}catch(K){console.error(`[HeroSlide] iOS video play failed on ${y}:`,K),u(re=>({...re,[y]:!0}))}},150);return()=>clearTimeout(q)},[v,a]),e.jsxs("div",{className:N("absolute inset-0 w-full h-full transition-opacity duration-1000",a?"opacity-100 z-10":"opacity-0 z-0"),children:[e.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[e.jsxs("div",{className:"absolute inset-0 w-full h-full sm:hidden",children:[!f.mobile&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),ee&&te?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:E,alt:"Background",className:N("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",h.mobile&&!x.mobile?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:p>0?`blur(${p}px)`:void 0}}),v&&!x.mobile&&e.jsx("video",{ref:j,src:te,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>H("mobile"),onError:l=>W("mobile",l),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:p>0?`blur(${p}px)`:void 0}})]}):e.jsx("img",{src:E,alt:"Background",className:N("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",f.mobile?"opacity-100":"opacity-0"),style:{filter:p>0?`blur(${p}px)`:void 0}})]}),e.jsxs("div",{className:"absolute inset-0 w-full h-full hidden sm:block lg:hidden",children:[!f.tablet&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),J&&se?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:R,alt:"Background",className:N("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",h.tablet&&!x.tablet?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:p>0?`blur(${p}px)`:void 0}}),v&&!x.tablet&&e.jsx("video",{ref:T,src:se,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>H("tablet"),onError:l=>W("tablet",l),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:p>0?`blur(${p}px)`:void 0}})]}):e.jsx("img",{src:R,alt:"Background",className:N("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",f.tablet?"opacity-100":"opacity-0"),style:{filter:p>0?`blur(${p}px)`:void 0}})]}),e.jsxs("div",{className:"absolute inset-0 w-full h-full hidden lg:block",children:[!f.desktop&&e.jsx("div",{className:"absolute inset-0 w-full h-full bg-muted animate-pulse z-20"}),Z&&ae?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:I,alt:"Background",className:N("absolute inset-0 w-full h-full object-cover object-center z-10 transition-opacity duration-500",h.desktop&&!x.desktop?"opacity-0 pointer-events-none":"opacity-100"),style:{filter:p>0?`blur(${p}px)`:void 0}}),v&&!x.desktop&&e.jsx("video",{ref:L,src:ae,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,"webkit-playsinline":"true",preload:"auto",onCanPlay:()=>H("desktop"),onError:l=>W("desktop",l),className:"absolute inset-0 w-full h-full object-cover object-center",style:{filter:p>0?`blur(${p}px)`:void 0}})]}):e.jsx("img",{src:I,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:N("absolute inset-0 w-full h-full object-cover object-center transition-opacity duration-500",f.desktop?"opacity-100":"opacity-0"),style:{filter:p>0?`blur(${p}px)`:void 0}})]}),e.jsx("div",{className:"absolute inset-0 w-full h-full",style:D()})]}),e.jsx("div",{className:"relative z-10 container mx-auto px-4 sm:px-6 flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center space-y-4 sm:space-y-8 animate-fade-in w-full",children:[e.jsx("h1",{className:"text-3xl sm:text-5xl md:text-7xl font-bold text-white leading-tight px-4 drop-shadow-[0_2px_8px_rgba(0,0,0,0.8)]",children:M("title")||n("home.hero.title")}),e.jsx("p",{className:"text-sm sm:text-xl md:text-2xl text-white/95 max-w-2xl mx-auto px-4 drop-shadow-[0_2px_6px_rgba(0,0,0,0.7)]",children:M("description")||n("home.hero.description")}),t.subtitle_button_text_zh&&e.jsx("div",{className:"flex justify-center",children:e.jsxs("button",{onClick:d,className:"group flex items-center gap-3 bg-white/20 backdrop-blur-xl text-white px-5 sm:px-7 py-3.5 sm:py-4 rounded-full shadow-[0_8px_32px_rgba(0,0,0,0.12)] hover:shadow-[0_16px_48px_rgba(0,0,0,0.2)] hover:bg-white/30 transition-all duration-300 cursor-text border border-white/40",children:[e.jsx(pe,{className:"w-5 h-5 text-white/90 group-hover:text-white transition-colors drop-shadow-sm"}),e.jsx("span",{className:"text-sm sm:text-base text-primary group-hover:text-primary/80 transition-colors drop-shadow-sm font-medium",children:M("subtitle_button_text")||n("home.hero.subtitle")}),e.jsx(fe,{className:"w-4 h-4 text-white/60 ml-2 drop-shadow-sm"})]})})]})})]})});Se.displayName="HeroSlide";const Lt=()=>{const{t,i18n:a}=P(),o=Qe(),{settings:n}=Y(),{data:s,isLoading:d,refetch:r}=be(),[m,h]=i.useState(0),[c,x]=i.useState(null),u=i.useRef(null),[f,k]=i.useState(!1),[v,_]=i.useState(!1),S=de(),{isWebView:j,isNativeApp:T}=Be(),L=S||j,M=j||T,C=n?.ai_assistant_enabled!==!1,z=i.useCallback(()=>{k(!0)},[]);Je({pageType:"home"});const D=i.useCallback(async()=>{try{const b=await(await fetch("https://v.xiaoxiong.pt/api/get_info")).json();b&&x({order_count:b.order_count||0,reserve_count:b.reserve_count||0})}catch(g){console.error("Failed to fetch stats:",g)}},[]);i.useEffect(()=>{D()},[D]);const E=i.useCallback(async()=>{o.removeQueries({queryKey:["homepage-templates"]}),o.removeQueries({queryKey:["restaurants"]}),o.removeQueries({queryKey:["activities"]}),o.removeQueries({queryKey:["recent-activities"]}),await Promise.all([r(),D(),o.invalidateQueries({queryKey:["restaurants"]}),o.invalidateQueries({queryKey:["activities"]}),o.invalidateQueries({queryKey:["recent-activities"]})])},[r,D,o]);i.useEffect(()=>{if(!s||s.length<=1)return;const b=s[m]?.duration||5e3;return u.current=setTimeout(()=>{h(O=>(O+1)%s.length)},b),()=>{u.current&&clearTimeout(u.current)}},[s,m]);const R=i.useCallback(g=>{u.current&&clearTimeout(u.current),h(g)},[]);i.useCallback(()=>{s&&(u.current&&clearTimeout(u.current),h(g=>(g-1+s.length)%s.length))},[s]),i.useCallback(()=>{s&&(u.current&&clearTimeout(u.current),h(g=>(g+1)%s.length))},[s]);const I=a.language,p=s&&s.length>1;return e.jsx(st,{onRefresh:E,children:e.jsxs("div",{className:"min-h-screen",children:[L?e.jsx(ye,{stats:c,onAskXiaoxiong:()=>_(!0)}):e.jsxs("section",{className:"relative h-screen flex items-start overflow-hidden bg-background",children:[c&&e.jsx(ke,{stats:c,t}),e.jsx("div",{className:N("absolute inset-0 w-full h-full transition-opacity duration-500",f?"opacity-100":"opacity-0"),children:s?.map((g,b)=>e.jsx(Se,{template:g,isActive:b===m,currentLang:I,t,onContentReady:b===0?z:void 0,onAskXiaoxiong:()=>_(!0)},g.id))}),e.jsx("div",{className:N("absolute inset-0 w-full h-full z-20 transition-opacity duration-500",d||!f?"opacity-100":"opacity-0 pointer-events-none"),children:e.jsx(Oe,{})}),!d&&(!s||s.length===0)&&e.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[e.jsx("img",{src:_e,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:"absolute inset-0 w-full h-full object-cover object-center sm:hidden"}),e.jsx("img",{src:G,alt:"Background",fetchPriority:"high",loading:"eager",decoding:"async",className:"absolute inset-0 w-full h-full object-cover object-center hidden sm:block"}),e.jsx("div",{className:"absolute inset-0 w-full h-full bg-gradient-to-b from-black/30 via-black/25 to-black/40"}),e.jsx("div",{className:"relative z-10 container mx-auto px-4 sm:px-6 flex items-center min-h-screen",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center space-y-4 sm:space-y-8 animate-fade-in w-full",children:[e.jsx("h1",{className:"text-3xl sm:text-5xl md:text-7xl font-bold text-white leading-tight px-4 drop-shadow-[0_2px_8px_rgba(0,0,0,0.8)]",children:t("home.hero.title")}),e.jsx("p",{className:"text-sm sm:text-xl md:text-2xl text-white/95 max-w-2xl mx-auto px-4 drop-shadow-[0_2px_6px_rgba(0,0,0,0.7)]",children:t("home.hero.description")})]})})]}),p&&e.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 z-30 flex gap-2",children:s.map((g,b)=>e.jsx("button",{onClick:()=>R(b),className:N("w-3 h-3 rounded-full transition-all duration-300",b===m?"bg-white w-8":"bg-white/50 hover:bg-white/70"),"aria-label":`Go to slide ${b+1}`},b))})]}),e.jsx(Ne,{}),e.jsx("section",{className:"py-12 sm:py-20 px-4 bg-secondary/20",children:e.jsx("div",{className:"container mx-auto max-w-7xl",children:e.jsx(i.Suspense,{fallback:e.jsx("div",{className:"h-[400px] bg-muted/30 rounded-lg animate-pulse"}),children:e.jsx(xt,{})})})}),!M&&e.jsxs("section",{className:"py-16 sm:py-24 px-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/5 via-primary/3 to-primary/8",style:{maskImage:"radial-gradient(ellipse 80% 70% at 50% 50%, black 40%, transparent 100%)",WebkitMaskImage:"radial-gradient(ellipse 80% 70% at 50% 50%, black 40%, transparent 100%)"}}),e.jsx("div",{className:"absolute top-1/4 left-1/4 w-72 h-72 bg-primary/8 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-primary/5 rounded-full blur-3xl"}),e.jsx("div",{className:"container mx-auto max-w-5xl relative z-10",children:e.jsx("div",{className:"flex flex-col items-center justify-center gap-8",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-primary/10 text-primary text-sm font-medium px-4 py-2 rounded-full mb-4",children:[e.jsx(Fe,{className:"w-4 h-4"}),e.jsx("span",{children:"Mobile App"})]}),e.jsx("h3",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-foreground mb-4",children:t("home.app.title")}),e.jsx("p",{className:"text-base sm:text-lg text-muted-foreground mb-8 leading-relaxed",children:t("home.app.description")}),e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[e.jsxs("a",{href:"https://apps.apple.com/cn/app/xiaoxiong/id6755481369",target:"_blank",rel:"noopener noreferrer",className:"relative group",children:[e.jsx("div",{className:"absolute -inset-2 bg-gradient-to-r from-primary via-primary-glow to-primary rounded-2xl blur-lg opacity-40 group-hover:opacity-70 transition-opacity"}),e.jsx("div",{className:"relative bg-black hover:bg-gray-900 h-[52px] sm:h-[56px] w-[160px] sm:w-[180px] rounded-xl transition-all hover:scale-105 shadow-2xl hover:shadow-primary/30 border border-white/10 flex items-center justify-center",children:e.jsx("img",{src:Ye,alt:"Download on the App Store",width:108,height:36,className:"h-8 sm:h-9"})})]}),e.jsxs("a",{href:"https://play.google.com/store/apps/details?id=com.xiaoxiong.market",target:"_blank",rel:"noopener noreferrer",className:"relative group",children:[e.jsx("div",{className:"absolute -inset-2 bg-gradient-to-r from-primary via-primary-glow to-primary rounded-2xl blur-lg opacity-40 group-hover:opacity-70 transition-opacity"}),e.jsx("div",{className:"relative bg-black hover:bg-gray-900 h-[52px] sm:h-[56px] w-[160px] sm:w-[180px] rounded-xl transition-all hover:scale-105 shadow-2xl hover:shadow-primary/30 border border-white/10 flex items-center justify-center",children:e.jsx("img",{src:Ze,alt:"Get it on Google Play",width:145,height:56,className:"h-12 sm:h-14"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Ue,{className:"w-4 h-4 animate-bounce"}),e.jsx("span",{children:t("home.app.downloadNow")})]})]})]})})})]}),e.jsxs("section",{className:"py-16 sm:py-20 px-4 bg-gradient-to-r from-primary/90 to-primary relative overflow-hidden rounded-3xl mx-4 sm:mx-8 lg:mx-16 mb-8",children:[e.jsx("div",{className:"absolute inset-0 bg-grid-pattern opacity-10"}),e.jsx("div",{className:"absolute top-0 right-0 w-64 sm:w-96 h-64 sm:h-96 bg-white/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-64 sm:w-96 h-64 sm:h-96 bg-white/10 rounded-full blur-3xl"}),e.jsxs("div",{className:"container mx-auto max-w-4xl text-center relative z-10",children:[e.jsx("h2",{className:"text-3xl sm:text-4xl md:text-5xl font-bold text-primary-foreground mb-4 sm:mb-6 px-4",children:t("home.cta.title")}),e.jsx("p",{className:"text-base sm:text-xl text-primary-foreground/90 mb-6 sm:mb-8 max-w-2xl mx-auto px-4",children:t("home.cta.description")}),e.jsx("div",{className:"flex justify-center",children:e.jsx(U,{size:"lg",variant:"secondary",asChild:!0,className:"text-base sm:text-lg shadow-xl hover:shadow-2xl",children:e.jsxs(xe,{to:"/join-us",children:[e.jsx(Ge,{className:"mr-2 w-4 sm:w-5 h-4 sm:h-5"}),t("home.cta.button")]})})})]})]}),C&&e.jsx(ct,{open:v,onOpenChange:_})]})})};export{Lt as default};
//# sourceMappingURL=Home-YiyMoZEr.js.map
