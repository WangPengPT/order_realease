import{r as S,j as e}from"./vendor-react-core-BErlw7p5.js";import{a as L}from"./vendor-query-BS0wY7WL.js";import{X as Me,Y as Be,Z as Le,$ as Pe,a0 as D,B as O,d as P,C as x,h,p as u,j,g as p,a2 as M,S as I,o as m,D as ee,a as se,b as ae,c as te,Q as Ie,s as K}from"./index-CEqKPgls.js";import{T as re,a as ne,b as T,c,d as de,e as d}from"./table-BmTgE8rr.js";import{T as Ke,a as qe,b as q,c as $}from"./tabs-CCXSC-tz.js";import{P as le,a as ie,b as ce}from"./popover-spUU1PkJ.js";import{C as me}from"./calendar-Bc_6WYfD.js";import{u as $e}from"./vendor-i18n-CqcxoxDo.js";import{J as oe,C as k,K as N,c as C,s as A}from"./vendor-date-fYlqblcl.js";import{e as xe,R as He,r as H,s as B,aH as Fe,aC as he,ae as ue,U as F,P as Ee,M as Ue,x as Ve,b7 as We,aO as Xe}from"./vendor-icons-C2Bicc1E.js";import{R as E,L as Ye,C as je,X as pe,Y as fe,T as U,b as Ne,P as ze,d as Qe,e as Ge,B as Je,c as ge}from"./vendor-charts-C2PWrzKy.js";import"./vendor-editor-BdQcs4B3.js";import"./vendor-misc-DH4LiFnZ.js";import"./vendor-router-CLK0c9aH.js";import"./vendor-ui-other-CPTlx-W2.js";import"./vendor-supabase-Clrw0GhO.js";import"./vendor-ui-dialog-Sv_VEL0d.js";import"./vendor-ui-dropdown-DwTcg2UT.js";const ye=["hsl(var(--primary))","hsl(var(--chart-2))","hsl(var(--chart-3))","hsl(var(--chart-4))","hsl(var(--chart-5))"],Ns=()=>{const{t:a}=$e(),[ve,be]=S.useState("overview"),[v,we]=S.useState("all"),[b,Se]=S.useState(void 0),[w,De]=S.useState(void 0),[t,V]=S.useState(null),[l,W]=S.useState(null),Ce=()=>{const s=new Date;switch(v){case"today":return{start:C(s),end:N(s)};case"7days":return{start:C(A(s,6)),end:N(s)};case"30days":return{start:C(A(s,29)),end:N(s)};case"90days":return{start:C(A(s,89)),end:N(s)};case"180days":return{start:C(A(s,179)),end:N(s)};case"all":return{start:new Date(2020,0,1),end:N(s)};case"custom":return{start:b?C(b):C(A(s,29)),end:w?N(w):N(s)};default:return{start:new Date(2020,0,1),end:N(s)}}},{data:X,isLoading:_e,refetch:Te}=L({queryKey:["external-stats-info"],queryFn:async()=>{const{data:s,error:r}=await K.functions.invoke("external-stats-api",{body:{action:"get_info"}});if(r)throw r;return s},refetchInterval:3e3}),{data:Y,isLoading:z,refetch:ke}=L({queryKey:["external-orders-data"],queryFn:async()=>{const{data:s,error:r}=await K.functions.invoke("external-stats-api",{body:{action:"query_data",table:"order",query:{name:{$regex:"^T"}},count:1e4}});if(r)throw r;return Array.isArray(s)?s:[]},refetchInterval:3e3}),{data:Q,isLoading:G,refetch:Re}=L({queryKey:["external-reserves-data"],queryFn:async()=>{const{data:s,error:r}=await K.functions.invoke("external-stats-api",{body:{action:"query_data",table:"reserve",count:1e4}});if(r)throw r;return Array.isArray(s)?s:[]},refetchInterval:3e3}),{filteredOrders:f,filteredReserves:g}=S.useMemo(()=>{const{start:s,end:r}=Ce(),_=(Y?.filter(n=>{if(!n.created_at)return!1;const i=new Date(n.created_at);return oe(i,{start:s,end:r})})||[]).sort((n,i)=>{const y=n.created_at?new Date(n.created_at).getTime():0;return(i.created_at?new Date(i.created_at).getTime():0)-y}),R=(Q?.filter(n=>{const i=n.created_at||n.date;if(!i)return!1;const y=new Date(i);return oe(y,{start:s,end:r})})||[]).sort((n,i)=>{const y=n.creationDate?new Date(n.creationDate).getTime():0;return(i.creationDate?new Date(i.creationDate).getTime():0)-y});return{filteredOrders:_,filteredReserves:R}},[Y,Q,v,b,w]),Oe=()=>{Te(),ke(),Re()},o=_e||z||G,J=(()=>{const s={},r={};f.forEach(n=>{const i=n.created_at?k(new Date(n.created_at),"MM-dd"):"Unknown";s[i]=(s[i]||0)+1}),g.forEach(n=>{const i=n.created_at||n.date,y=i?k(new Date(i),"MM-dd"):"Unknown";r[y]=(r[y]||0)+1});const _=[...new Set([...Object.keys(s),...Object.keys(r)])].sort(),R=v==="today"?1:v==="7days"?7:v==="30days"?14:30;return _.slice(-R).map(n=>({date:n,orders:s[n]||0,reserves:r[n]||0}))})(),Z=[{name:a("admin.orderStats.orders","外卖订单"),value:f.length},{name:a("admin.orderStats.reserves","订台预约"),value:g.length}];return e.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:a("admin.orderStats.title","外卖订台统计")}),e.jsx("p",{className:"text-muted-foreground",children:a("admin.orderStats.description","查看外卖订单和订台预约数据")})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Me,{value:v,onValueChange:s=>we(s),children:[e.jsx(Be,{className:"w-[140px]",children:e.jsx(Le,{})}),e.jsxs(Pe,{children:[e.jsx(D,{value:"all",children:a("admin.orderStats.allTime","全部")}),e.jsx(D,{value:"today",children:a("admin.orderStats.today","今天")}),e.jsx(D,{value:"7days",children:a("admin.orderStats.last7Days","最近7天")}),e.jsx(D,{value:"30days",children:a("admin.orderStats.last30Days","最近30天")}),e.jsx(D,{value:"90days",children:a("admin.orderStats.last90Days","最近90天")}),e.jsx(D,{value:"180days",children:a("admin.orderStats.last180Days","最近半年")}),e.jsx(D,{value:"custom",children:a("admin.orderStats.customRange","自定义")})]})]}),v==="custom"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(le,{children:[e.jsx(ie,{asChild:!0,children:e.jsxs(O,{variant:"outline",className:P("w-[130px] justify-start text-left font-normal",!b&&"text-muted-foreground"),children:[e.jsx(xe,{className:"mr-2 h-4 w-4"}),b?k(b,"yyyy-MM-dd"):a("admin.orderStats.startDate","开始日期")]})}),e.jsx(ce,{className:"w-auto p-0",align:"start",children:e.jsx(me,{mode:"single",selected:b,onSelect:Se,initialFocus:!0})})]}),e.jsx("span",{className:"text-muted-foreground",children:"-"}),e.jsxs(le,{children:[e.jsx(ie,{asChild:!0,children:e.jsxs(O,{variant:"outline",className:P("w-[130px] justify-start text-left font-normal",!w&&"text-muted-foreground"),children:[e.jsx(xe,{className:"mr-2 h-4 w-4"}),w?k(w,"yyyy-MM-dd"):a("admin.orderStats.endDate","结束日期")]})}),e.jsx(ce,{className:"w-auto p-0",align:"start",children:e.jsx(me,{mode:"single",selected:w,onSelect:De,initialFocus:!0})})]})]}),e.jsxs(O,{onClick:Oe,variant:"outline",disabled:o,children:[e.jsx(He,{className:`h-4 w-4 mr-2 ${o?"animate-spin":""}`}),a("common.refresh","刷新")]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(x,{className:"border-primary/30 bg-primary/5",children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:a("admin.orderStats.totalOrders","外卖总订单")}),e.jsx(H,{className:"h-5 w-5 text-primary"})]}),e.jsx(j,{children:o?e.jsx(p,{className:"h-10 w-24"}):e.jsx("div",{className:"text-3xl font-bold text-primary",children:X?.order_count??0})})]}),e.jsxs(x,{className:"border-chart-2/30 bg-chart-2/5",children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:a("admin.orderStats.totalReserves","订台总预约")}),e.jsx(B,{className:"h-5 w-5 text-chart-2"})]}),e.jsx(j,{children:o?e.jsx(p,{className:"h-10 w-24"}):e.jsx("div",{className:"text-3xl font-bold text-chart-2",children:X?.reserve_count??0})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(x,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:a("admin.orderStats.periodOrders","期间外卖订单")}),e.jsx(H,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(j,{children:o?e.jsx(p,{className:"h-8 w-20"}):e.jsx("div",{className:"text-2xl font-bold",children:f.length})})]}),e.jsxs(x,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:a("admin.orderStats.periodReserves","期间订台预约")}),e.jsx(B,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(j,{children:o?e.jsx(p,{className:"h-8 w-20"}):e.jsx("div",{className:"text-2xl font-bold",children:g.length})})]}),e.jsxs(x,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:a("admin.orderStats.periodTotal","期间总交易")}),e.jsx(Fe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(j,{children:o?e.jsx(p,{className:"h-8 w-20"}):e.jsx("div",{className:"text-2xl font-bold",children:f.length+g.length})})]}),e.jsxs(x,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(u,{className:"text-sm font-medium",children:a("admin.orderStats.ratio","订单占比")}),e.jsx(he,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(j,{children:o?e.jsx(p,{className:"h-8 w-20"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-2xl font-bold",children:f.length+g.length>0?`${Math.round(f.length/(f.length+g.length)*100)}%`:"0%"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a("admin.orderStats.orderVsReserve","外卖 vs 订台")})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(x,{className:"lg:col-span-2",children:[e.jsxs(h,{children:[e.jsx(u,{children:a("admin.orderStats.trendChart","趋势图")}),e.jsx(M,{children:a("admin.orderStats.selectedPeriod","所选时间段数据")})]}),e.jsx(j,{children:o?e.jsx(p,{className:"h-[300px] w-full"}):e.jsx(E,{width:"100%",height:300,children:e.jsxs(Ye,{data:J,children:[e.jsx(je,{strokeDasharray:"3 3",className:"stroke-muted"}),e.jsx(pe,{dataKey:"date",className:"text-xs"}),e.jsx(fe,{className:"text-xs"}),e.jsx(U,{contentStyle:{backgroundColor:"hsl(var(--background))",border:"1px solid hsl(var(--border))",borderRadius:"8px"}}),e.jsx(Ne,{type:"monotone",dataKey:"orders",stroke:"hsl(var(--primary))",strokeWidth:2,name:a("admin.orderStats.orders","外卖订单")}),e.jsx(Ne,{type:"monotone",dataKey:"reserves",stroke:"hsl(var(--chart-2))",strokeWidth:2,name:a("admin.orderStats.reserves","订台预约")})]})})})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(u,{children:a("admin.orderStats.distribution","分布")}),e.jsx(M,{children:a("admin.orderStats.orderTypeRatio","订单类型占比")})]}),e.jsx(j,{children:o?e.jsx(p,{className:"h-[300px] w-full"}):e.jsx(E,{width:"100%",height:300,children:e.jsxs(ze,{children:[e.jsx(Qe,{data:Z,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:5,dataKey:"value",label:({name:s,percent:r})=>`${s} ${(r*100).toFixed(0)}%`,children:Z.map((s,r)=>e.jsx(Ge,{fill:ye[r%ye.length]},`cell-${r}`))}),e.jsx(U,{contentStyle:{backgroundColor:"hsl(var(--background))",border:"1px solid hsl(var(--border))",borderRadius:"8px"}})]})})})]})]}),e.jsxs(Ke,{value:ve,onValueChange:s=>be(s),children:[e.jsxs(qe,{children:[e.jsx(q,{value:"overview",children:a("admin.orderStats.overview","概览")}),e.jsx(q,{value:"orders",children:a("admin.orderStats.ordersList","外卖订单")}),e.jsx(q,{value:"reserves",children:a("admin.orderStats.reservesList","订台预约")})]}),e.jsx($,{value:"overview",children:e.jsxs(x,{children:[e.jsx(h,{children:e.jsx(u,{children:a("admin.orderStats.dailyStats","每日统计")})}),e.jsx(j,{children:o?e.jsx(p,{className:"h-[300px] w-full"}):e.jsx(E,{width:"100%",height:300,children:e.jsxs(Je,{data:J,children:[e.jsx(je,{strokeDasharray:"3 3",className:"stroke-muted"}),e.jsx(pe,{dataKey:"date",className:"text-xs"}),e.jsx(fe,{className:"text-xs"}),e.jsx(U,{contentStyle:{backgroundColor:"hsl(var(--background))",border:"1px solid hsl(var(--border))",borderRadius:"8px"}}),e.jsx(ge,{dataKey:"orders",fill:"hsl(var(--primary))",name:a("admin.orderStats.orders","外卖订单")}),e.jsx(ge,{dataKey:"reserves",fill:"hsl(var(--chart-2))",name:a("admin.orderStats.reserves","订台预约")})]})})})]})}),e.jsx($,{value:"orders",children:e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(u,{children:a("admin.orderStats.recentOrders","最近外卖订单")}),e.jsx(M,{children:a("admin.orderStats.showingRecent","显示最近的订单记录")})]}),e.jsx(j,{children:z?e.jsx(p,{className:"h-[400px] w-full"}):e.jsx(I,{className:"h-[400px]",children:e.jsxs(re,{children:[e.jsx(ne,{children:e.jsxs(T,{children:[e.jsx(c,{children:a("admin.orderStats.orderNumber","订单号")}),e.jsx(c,{children:a("admin.orderStats.customer","客户")}),e.jsx(c,{children:a("admin.orderStats.restaurant","餐厅")}),e.jsx(c,{className:"text-right",children:a("admin.orderStats.amount","金额")}),e.jsx(c,{children:a("admin.orderStats.pickupTime","取餐时间")}),e.jsx(c,{children:a("admin.orderStats.paymentStatus","支付状态")}),e.jsx(c,{})]})}),e.jsxs(de,{children:[f.slice(0,50).map((s,r)=>e.jsxs(T,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>V(s),children:[e.jsx(d,{className:"font-mono text-xs",children:s.name||`#${r+1}`}),e.jsx(d,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-medium",children:s.customer?.name||"-"}),e.jsx("span",{className:"text-xs text-muted-foreground truncate max-w-[150px]",children:s.customer?.email||""})]})}),e.jsx(d,{children:e.jsx("span",{className:"text-xs",children:s.restaurant||"-"})}),e.jsxs(d,{className:"text-right font-medium",children:["€",s.total_price||"0"]}),e.jsx(d,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs",children:s.pickupDate||s.pickup_date||"-"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.pickupTime||""})]})}),e.jsx(d,{children:e.jsx(m,{variant:s.pay_state==="paid"?"default":"secondary",className:P("text-xs",s.pay_state==="paid"&&"bg-green-500"),children:s.pay_state==="paid"?"已付款":s.pay_state||"pending"})}),e.jsx(d,{children:e.jsx(O,{variant:"ghost",size:"sm",className:"h-7",children:e.jsx(ue,{className:"h-4 w-4"})})})]},s.id||r)),f.length===0&&e.jsx(T,{children:e.jsx(d,{colSpan:7,className:"text-center text-muted-foreground",children:a("common.noData","暂无数据")})})]})]})})})]})}),e.jsx($,{value:"reserves",children:e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(u,{children:a("admin.orderStats.recentReserves","最近订台预约")}),e.jsx(M,{children:a("admin.orderStats.showingRecent","显示最近的预约记录")})]}),e.jsx(j,{children:G?e.jsx(p,{className:"h-[400px] w-full"}):e.jsx(I,{className:"h-[400px]",children:e.jsxs(re,{children:[e.jsx(ne,{children:e.jsxs(T,{children:[e.jsx(c,{children:a("admin.orderStats.reserveNo","订台号")}),e.jsx(c,{children:a("admin.orderStats.customerName","预订人")}),e.jsx(c,{children:a("admin.orderStats.restaurant","餐厅")}),e.jsx(c,{children:a("admin.orderStats.creationDate","创建时间")}),e.jsx(c,{children:a("admin.orderStats.reserveDateTime","预约日期/时间")}),e.jsx(c,{className:"text-center",children:a("admin.orderStats.guests","人数")}),e.jsx(c,{children:a("common.status","状态")}),e.jsx(c,{})]})}),e.jsxs(de,{children:[g.slice(0,50).map((s,r)=>e.jsxs(T,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>W(s),children:[e.jsx(d,{children:e.jsx(m,{variant:"outline",className:"font-mono",children:s.name||"-"})}),e.jsx(d,{className:"font-medium",children:s.customerName||"-"}),e.jsx(d,{className:"max-w-[150px] truncate",children:s.restaurant||"-"}),e.jsx(d,{children:e.jsx("span",{className:"text-xs text-muted-foreground",children:s.creationDate?k(new Date(s.creationDate),"yyyy-MM-dd HH:mm"):"-"})}),e.jsx(d,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm",children:s.date||"-"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.time||"-"})]})}),e.jsx(d,{className:"text-center",children:e.jsx(m,{variant:"outline",children:s.numberPeople||s.guests||"-"})}),e.jsx(d,{children:e.jsx(m,{variant:s.status==="confirmed"?"default":"secondary",children:s.status||"pending"})}),e.jsx(d,{children:e.jsx(O,{variant:"ghost",size:"sm",className:"h-7",children:e.jsx(ue,{className:"h-4 w-4"})})})]},s.id||r)),g.length===0&&e.jsx(T,{children:e.jsx(d,{colSpan:8,className:"text-center text-muted-foreground",children:a("common.noData","暂无数据")})})]})]})})})]})})]}),e.jsx(ee,{open:!!t,onOpenChange:s=>!s&&V(null),children:e.jsxs(se,{className:"max-w-2xl max-h-[85vh] overflow-hidden",children:[e.jsxs(ae,{children:[e.jsxs(te,{className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-5 w-5 text-primary"}),a("admin.orderStats.orderDetail","外卖订单详情")]}),e.jsxs(Ie,{className:"flex items-center gap-2",children:[t?.name&&e.jsx(m,{variant:"outline",className:"font-mono",children:t.name}),t?.pay_state&&e.jsx(m,{variant:t.pay_state==="paid"?"default":"secondary",className:t.pay_state==="paid"?"bg-green-500":"",children:t.pay_state==="paid"?"已付款":t.pay_state})]})]}),t&&e.jsx(I,{className:"max-h-[65vh] pr-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-lg border bg-primary/5 p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"订单总额"}),e.jsxs("p",{className:"text-2xl font-bold text-primary",children:["€ ",t.total_price||"0"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"创建时间"}),e.jsx("p",{className:"text-sm font-medium",children:t.created_at?k(new Date(t.created_at),"yyyy-MM-dd HH:mm:ss"):"-"})]})]})}),t.customer&&e.jsxs("div",{className:"rounded-lg border bg-muted/30 p-4 space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4"}),"客户信息"]}),e.jsxs("div",{className:"grid gap-3",children:[t.customer.name&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:t.customer.name})]}),t.customer.phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:t.customer.phone.includes("#")?`+${t.customer.phone.replace("#"," ")}`:t.customer.phone})]}),t.customer.email&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:t.customer.email})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-muted/30 p-4 space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(Ve,{className:"h-4 w-4"}),"取餐信息"]}),e.jsxs("div",{className:"grid gap-2",children:[t.restaurant&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"餐厅"}),e.jsx("span",{className:"font-medium",children:t.restaurant})]}),(t.pickupDate||t.pickup_date)&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"取餐日期"}),e.jsx("span",{className:"font-medium",children:t.pickupDate||t.pickup_date})]}),t.pickupTime&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"取餐时间"}),e.jsx(m,{variant:"outline",className:"font-medium",children:t.pickupTime})]})]})]}),t.line_items&&Array.isArray(t.line_items)&&t.line_items.length>0&&e.jsxs("div",{className:"rounded-lg border bg-muted/30 p-4 space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(he,{className:"h-4 w-4"}),"订单商品 (",t.line_items.length,")"]}),e.jsx("div",{className:"space-y-2",children:t.line_items.map((s,r)=>e.jsxs("div",{className:"flex justify-between items-start py-2 border-b border-border/50 last:border-0",children:[e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:s.name||s.title||"商品"}),s.sku&&e.jsxs("p",{className:"text-xs text-muted-foreground font-mono",children:["SKU: ",s.sku]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["数量: ",s.quantity||1," × €",s.price||"0"]}),s.properties&&Array.isArray(s.properties)&&s.properties.length>0&&e.jsx("div",{className:"text-xs text-muted-foreground",children:s.properties.map((_,R)=>e.jsxs("span",{className:"mr-2",children:[_.name,": ",_.value]},R))})]}),e.jsxs("p",{className:"font-medium text-primary",children:["€",((s.quantity||1)*parseFloat(s.price||"0")).toFixed(2)]})]},r))})]}),e.jsxs("div",{className:"rounded-lg border bg-muted/30 p-4 space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(We,{className:"h-4 w-4"}),"付款信息"]}),e.jsxs("div",{className:"grid gap-2",children:[t.pay_type&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"付款方式"}),e.jsx(m,{variant:"outline",children:t.pay_type})]}),t.pay_state&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"付款状态"}),e.jsx(m,{variant:t.pay_state==="paid"?"default":"secondary",className:t.pay_state==="paid"?"bg-green-500":"",children:t.pay_state==="paid"?"已付款":t.pay_state})]}),e.jsxs("div",{className:"flex justify-between items-center font-bold border-t pt-2 mt-2",children:[e.jsx("span",{children:"总计"}),e.jsxs("span",{className:"text-primary",children:["€",t.total_price||"0"]})]})]})]}),t.note&&e.jsxs("div",{className:"rounded-lg border p-4 space-y-2",children:[e.jsxs("h4",{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(Xe,{className:"h-4 w-4"}),"备注"]}),e.jsx("p",{className:"text-sm",children:t.note})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("p",{className:"text-xs text-muted-foreground font-mono",children:["ID: ",t.id||"-"," ",t._id&&`| MongoDB: ${t._id}`]})})]})})]})}),e.jsx(ee,{open:!!l,onOpenChange:s=>!s&&W(null),children:e.jsxs(se,{className:"max-w-md",children:[e.jsx(ae,{children:e.jsxs(te,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-5 w-5 text-chart-2"}),a("admin.orderStats.reserveDetail","订台预约详情"),l?.name&&e.jsx(m,{variant:"outline",className:"font-mono ml-2",children:l.name})]})}),l&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg border bg-muted/30 p-4 space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4"}),a("admin.orderStats.customerInfo","客户信息")]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:a("admin.orderStats.customerName","预订人")}),e.jsx("span",{className:"font-medium",children:l.customerName||"-"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:a("common.phone","电话")}),e.jsx("span",{className:"font-medium",children:l.phone||"-"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:a("common.email","邮箱")}),e.jsx("span",{className:"font-medium text-sm",children:l.email||"-"})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-muted/30 p-4 space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4"}),a("admin.orderStats.reservationDetails","预约信息")]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:a("admin.orderStats.restaurant","餐厅")}),e.jsx("span",{className:"font-medium",children:l.restaurant||"-"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:a("admin.orderStats.reserveDate","预约日期")}),e.jsx("span",{className:"font-medium",children:l.date||"-"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:a("admin.orderStats.reserveTime","预约时间")}),e.jsx("span",{className:"font-medium",children:l.time||"-"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:a("admin.orderStats.guests","人数")}),e.jsxs(m,{variant:"outline",className:"font-medium",children:[l.numberPeople||l.guests||"-"," ",a("admin.orderStats.people","人")]})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center px-1",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:a("common.status","状态")}),e.jsx(m,{variant:l.status==="confirmed"?"default":"secondary",children:l.status||"pending"})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("p",{className:"text-xs text-muted-foreground font-mono",children:["ID: ",l.id||l._id||"-"]})})]})]})})]})};export{Ns as default};
//# sourceMappingURL=AdminOrderStats-BLPcGASe.js.map
