import{s as ve,q as te,v as he,w as V,p as we,r as x,d1 as Re,d2 as je,j as e,bj as pe,aL as ne,d3 as qe,d4 as ze,d5 as Pe,d6 as Me,bM as ue,d7 as Le,d8 as $e,cS as Ue,X as se,d9 as He,da as Ke,db as Be,dc as Oe,a4 as Ge,bG as Ve,bK as Qe,bd as Ne,ab as ye,b1 as J,y as Xe,dd as Ze,b5 as We,b9 as Ye,bh as Je}from"./vendor-react-BJ_Fufgb.js";import{m as re}from"./vendor-map-CvE3ASYw.js";import{s as S,u as es,C as H,z as ss,G as ts,$ as as,E as K,B as M,A as ns,i as rs,j as is,k as ls,m as os,n as cs,I as u,f as ds,g as ms,J as ps,D as us,X as hs,c as xs,d as gs,e as fs,U as js,S as Ns,V as i,a8 as ie}from"./index-BSqTIOKh.js";import{C as O}from"./checkbox-ChbmaHve.js";import{S as ys}from"./switch-BNjp0ZUu.js";import{T as bs,a as _s,b as le,c as oe}from"./tabs-DHusoSbk.js";import{i as F}from"./vendor-i18n-jtdHZIRR.js";import{R as ce}from"./RichTextEditor-JV7qwlxe.js";import{N as vs,O as I,P as de,T as be,U as ee}from"./vendor-utils-Z4kpnli5.js";const ws=a=>ve({queryKey:["dish-images",a],queryFn:async()=>{const{data:c,error:t}=await S.from("restaurant_dish_images").select("*").eq("restaurant_id",a).order("sort_order",{ascending:!0});if(t)throw t;return c},enabled:!!a}),Cs=()=>{const{user:a}=es(),c=te();return he({mutationFn:async({restaurantId:t,file:g})=>{if(!a)throw new Error("Must be logged in");const{data:f,error:h}=await S.from("restaurant_dish_images").select("id").eq("restaurant_id",t);if(h)throw h;if(f&&f.length>=10)throw new Error("MAX_IMAGES_REACHED");const m=g.name.split(".").pop(),y=`${t}/${Date.now()}-${Math.random().toString(36).substring(7)}.${m}`,{error:j}=await S.storage.from("dish-images").upload(y,g);if(j)throw j;const{data:{publicUrl:N}}=S.storage.from("dish-images").getPublicUrl(y),C=f?f.length:0,{data:v,error:_}=await S.from("restaurant_dish_images").insert({restaurant_id:t,image_url:N,sort_order:C,created_by:a.id}).select().single();if(_)throw _;return v},onSuccess:(t,g)=>{c.invalidateQueries({queryKey:["dish-images",g.restaurantId]}),V.success(F.t("dishImages.uploadSuccess"))},onError:t=>{t.message==="MAX_IMAGES_REACHED"?V.error(F.t("dishImages.maxImagesReached")):V.error(F.t("dishImages.uploadFailed"))}})},ks=()=>{const a=te();return he({mutationFn:async({imageId:c,restaurantId:t,imageUrl:g})=>{const f=g.split("/dish-images/");f[1]&&await S.storage.from("dish-images").remove([f[1]]);const{error:h}=await S.from("restaurant_dish_images").delete().eq("id",c);if(h)throw h;return{restaurantId:t}},onSuccess:c=>{a.invalidateQueries({queryKey:["dish-images",c.restaurantId]}),V.success(F.t("dishImages.deleteSuccess"))},onError:()=>{V.error(F.t("dishImages.deleteFailed"))}})},Is=()=>{const a=te();return he({mutationFn:async({images:c,restaurantId:t})=>{const g=c.map(f=>S.from("restaurant_dish_images").update({sort_order:f.sort_order}).eq("id",f.id));return await Promise.all(g),{restaurantId:t}},onSuccess:c=>{a.invalidateQueries({queryKey:["dish-images",c.restaurantId]})}})};function Ss({image:a,index:c,onDelete:t}){const{attributes:g,listeners:f,setNodeRef:h,transform:m,transition:y,isDragging:j}=Le({id:a.id}),N={transform:$e.Transform.toString(m),transition:y,zIndex:j?10:1,opacity:j?.8:1};return e.jsxs("div",{ref:h,style:N,className:`relative group aspect-square rounded-lg overflow-hidden border ${j?"ring-2 ring-primary shadow-lg":""}`,children:[e.jsx("div",{...g,...f,className:"absolute top-1 left-1 z-10 p-1 bg-black/60 rounded cursor-grab active:cursor-grabbing opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(Ue,{className:"w-4 h-4 text-white"})}),e.jsx("img",{src:a.image_url,alt:`Dish ${c+1}`,className:"w-full h-full object-cover",draggable:!1}),e.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:e.jsx(M,{type:"button",variant:"destructive",size:"icon",className:"h-8 w-8",onClick:C=>{C.preventDefault(),C.stopPropagation(),t(a.id,a.image_url)},children:e.jsx(se,{className:"w-4 h-4"})})}),e.jsx("div",{className:"absolute bottom-1 right-1 bg-black/60 text-white text-xs px-1.5 py-0.5 rounded",children:c+1})]})}function Ds({restaurantId:a}){const{t:c}=we(),t=x.useRef(null),{data:g=[],isLoading:f}=ws(a),h=Cs(),m=ks(),y=Is(),[j,N]=x.useState(null),[C,v]=x.useState([]),[_,q]=x.useState(!1),o=C.length>0?C:g,R=Re(je(Be,{activationConstraint:{distance:8}}),je(Ke,{coordinateGetter:He})),Q=l=>{const{active:r,over:p}=l;if(p&&r.id!==p.id){const T=o.findIndex(k=>k.id===r.id),G=o.findIndex(k=>k.id===p.id),D=Oe(o,T,G);v(D);const W=D.map((k,E)=>({id:k.id,sort_order:E}));y.mutate({images:W,restaurantId:a},{onSuccess:()=>{v([])},onError:()=>{v([])}})}},X=async l=>{const r=l.target.files?.[0];r&&(r.size>5*1024*1024||r.type.startsWith("image/")&&(await h.mutateAsync({restaurantId:a,file:r}),t.current&&(t.current.value="")))},Z=async()=>{if(!j||_)return;const{id:l,url:r}=j;q(!0);try{await m.mutateAsync({imageId:l,restaurantId:a,imageUrl:r}),N(null)}catch(p){console.error("Delete failed:",p)}finally{q(!1)}},B=l=>{!l&&!_&&N(null)},b=o.length<10;return e.jsxs(H,{children:[e.jsxs(ss,{className:"pb-3",children:[e.jsxs(ts,{className:"text-lg flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5"}),c("dishImages.title")]}),e.jsxs(as,{children:[c("dishImages.description",{current:o.length,max:10}),o.length>1&&e.jsx("span",{className:"block mt-1 text-xs",children:c("dishImages.dragToReorder")})]})]}),e.jsxs(K,{children:[f?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(ne,{className:"w-6 h-6 animate-spin"})}):e.jsxs("div",{className:"space-y-4",children:[o.length>0&&e.jsx(qe,{sensors:R,collisionDetection:ze,onDragEnd:Q,children:e.jsx(Pe,{items:o.map(l=>l.id),strategy:Me,children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:o.map((l,r)=>e.jsx(Ss,{image:l,index:r,onDelete:(p,T)=>N({id:p,url:T})},l.id))})})}),b&&e.jsxs("div",{children:[e.jsx("input",{ref:t,type:"file",accept:"image/*",className:"hidden",onChange:X,disabled:h.isPending}),e.jsxs(M,{type:"button",variant:"outline",className:"w-full",onClick:()=>t.current?.click(),disabled:h.isPending,children:[h.isPending?e.jsx(ne,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(ue,{className:"w-4 h-4 mr-2"}),c("dishImages.upload")]})]}),!b&&e.jsx("p",{className:"text-sm text-muted-foreground text-center",children:c("dishImages.maxReached")})]}),e.jsx(ns,{open:!!j,onOpenChange:B,children:e.jsx(rs,{onClick:l=>l.stopPropagation(),onKeyDown:l=>{l.key==="Enter"&&(l.preventDefault(),l.stopPropagation())},children:e.jsxs("form",{onSubmit:l=>l.preventDefault(),children:[e.jsxs(is,{children:[e.jsx(ls,{children:c("dishImages.deleteConfirmTitle")}),e.jsx(os,{children:c("dishImages.deleteConfirmDescription")})]}),e.jsxs(cs,{className:"mt-4",children:[e.jsx(M,{type:"button",variant:"outline",onClick:l=>{l.preventDefault(),l.stopPropagation(),_||N(null)},disabled:_,children:c("common.cancel")}),e.jsxs(M,{type:"button",variant:"destructive",onClick:l=>{l.preventDefault(),l.stopPropagation(),Z()},disabled:_,children:[_?e.jsx(ne,{className:"w-4 h-4 mr-2 animate-spin"}):null,c("common.delete")]})]})]})})})]})]})}function me({value:a,onChange:c,suggestions:t,placeholder:g,className:f}){const[h,m]=x.useState(!1),[y,j]=x.useState(a),N=x.useRef(null),C=x.useRef(null),v=t.filter(o=>o.toLowerCase().includes(y.toLowerCase()));x.useEffect(()=>{j(a)},[a]),x.useEffect(()=>{const o=R=>{C.current&&!C.current.contains(R.target)&&N.current&&!N.current.contains(R.target)&&m(!1)};return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[]);const _=o=>{const R=o.target.value;j(R),c(R),m(!0)},q=o=>{j(o),c(o),m(!1),N.current?.focus()};return e.jsxs("div",{className:"relative",children:[e.jsx(u,{ref:N,value:y,onChange:_,onFocus:()=>m(!0),placeholder:g,className:f}),h&&v.length>0&&e.jsx("div",{ref:C,className:"absolute z-50 mt-1 w-full max-h-48 overflow-auto rounded-md border bg-popover p-1 shadow-md",children:v.map(o=>e.jsxs("div",{onClick:()=>q(o),className:ds("relative flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none hover:bg-accent hover:text-accent-foreground",o===y&&"bg-accent"),children:[o===y&&e.jsx(Ge,{className:"mr-2 h-4 w-4"}),e.jsx("span",{className:o===y?"":"pl-6",children:o})]},o))})]})}const Es=()=>ve({queryKey:["all-restaurant-types"],queryFn:async()=>{const{data:a,error:c}=await S.from("restaurants").select("type, type_en, type_pt");if(c)throw c;const t=new Map;a.forEach(m=>{const y=m.type||[],j=m.type_en||[],N=m.type_pt||[],C=Math.max(y.length,j.length,N.length);for(let v=0;v<C;v++){const _=y[v]||"",q=j[v]||"",o=N[v]||"",R=`${_}|${q}|${o}`;(_||q||o)&&(t.has(R)||t.set(R,{zh:_,en:q,pt:o}))}});const g=new Set,f=new Set,h=new Set;return t.forEach(m=>{m.zh&&g.add(m.zh),m.en&&f.add(m.en),m.pt&&h.add(m.pt)}),{typeSets:Array.from(t.values()),uniqueZh:Array.from(g).sort(),uniqueEn:Array.from(f).sort(),uniquePt:Array.from(h).sort()}}}),Fs=vs({name:I().min(1,F.t("validation.nameRequired")),name_en:I().min(1,F.t("validation.nameRequired")),name_pt:I().min(1,F.t("validation.nameRequired")),key_id:I().optional(),type:de(I()).min(1,F.t("validation.typeRequired")).max(3,F.t("validation.typeMaximum")),type_en:de(I()).min(1,F.t("validation.typeRequired")).max(3,F.t("validation.typeMaximum")),type_pt:de(I()).min(1,F.t("validation.typeRequired")).max(3,F.t("validation.typeMaximum")),description:I().optional(),description_en:I().optional(),description_pt:I().optional(),announcement_zh:I().optional(),announcement_en:I().optional(),announcement_pt:I().optional(),address:I().min(1,F.t("validation.addressRequired")),lat:be(),lng:be(),phone:I().optional(),website_url:I().optional(),show_website_button:ee().default(!0),show_takeaway_button:ee().default(!0),show_booking_button:ee().default(!0),show_dish_gallery:ee().default(!0)}),_e=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];function Us({restaurant:a,trigger:c}){const{t}=we(),{toast:g}=ms(),f=te(),{isAdmin:h}=ps(),{data:m}=Es(),[y,j]=x.useState(!1),[N,C]=x.useState(null),[v,_]=x.useState(a?.image_url||null),[q,o]=x.useState(null),[R,Q]=x.useState(a?.cover_image_url||null),[X,Z]=x.useState(!1),B=x.useRef(null),b=x.useRef(null),l=x.useRef(null),[r,p]=x.useState(()=>{const s={};return _e.forEach(n=>{s[n]={open:"12:00",close:"23:00",closed:!1,splitShift:!1,open2:"19:00",close2:"23:00"}}),a?.opening_hours?{...s,...a.opening_hours}:s}),[T,G]=x.useState(()=>a?.type&&Array.isArray(a.type)?a.type.map((s,n)=>({zh:s,en:a.type_en?.[n]||"",pt:a.type_pt?.[n]||""})):[{zh:"",en:"",pt:""}]),{register:D,handleSubmit:W,formState:{errors:k},setValue:E,watch:L}=Ve({resolver:Qe(Fs),defaultValues:a?{name:a.name,name_en:a.name_en||"",name_pt:a.name_pt||"",key_id:a.key_id||"",type:Array.isArray(a.type)?a.type:[a.type],type_en:Array.isArray(a.type_en)?a.type_en:a.type_en?[a.type_en]:[""],type_pt:Array.isArray(a.type_pt)?a.type_pt:a.type_pt?[a.type_pt]:[""],description:a.description||"",description_en:a.description_en||"",description_pt:a.description_pt||"",announcement_zh:a.announcement_zh||"",announcement_en:a.announcement_en||"",announcement_pt:a.announcement_pt||"",address:a.address,lat:typeof a.lat=="number"&&!isNaN(a.lat)?a.lat:38.7223,lng:typeof a.lng=="number"&&!isNaN(a.lng)?a.lng:-9.1393,phone:a.phone||"",website_url:a.website_url||"",show_website_button:a.show_website_button??!0,show_takeaway_button:a.show_takeaway_button??!0,show_booking_button:a.show_booking_button??!0,show_dish_gallery:a.show_dish_gallery??!0}:{name:"",name_en:"",name_pt:"",key_id:"",type:[""],type_en:[""],type_pt:[""],description:"",description_en:"",description_pt:"",announcement_zh:"",announcement_en:"",announcement_pt:"",address:"",lat:38.7223,lng:-9.1393,phone:"",website_url:"",show_website_button:!0,show_takeaway_button:!0,show_booking_button:!0,show_dish_gallery:!0}}),Ce=()=>{T.length<3&&G([...T,{zh:"",en:"",pt:""}])},ke=s=>{T.length>1&&G(T.filter((n,d)=>d!==s))},ae=(s,n,d)=>{const w=[...T];w[s][n]=d,G(w),E("type",w.map(A=>A.zh).filter(Boolean)),E("type_en",w.map(A=>A.en).filter(Boolean)),E("type_pt",w.map(A=>A.pt).filter(Boolean))},z=L("lat"),P=L("lng");L("show_website_button");const Ie=L("show_takeaway_button"),Se=L("show_booking_button"),De=L("show_dish_gallery"),Y=(s,n)=>typeof s=="number"&&typeof n=="number"&&!isNaN(s)&&!isNaN(n)&&isFinite(s)&&isFinite(n);x.useEffect(()=>{if(!y){b.current&&(b.current.remove(),b.current=null,l.current=null);return}if(b.current)return;const s="pk.eyJ1IjoieGlhb3hpb25nMTIzIiwiYSI6ImNtNTFjOXliYjF1Y2IyaXM4bnNzMGxvdnkifQ.mPcWqH7ndIrjEqlWIJVk8g",d=setTimeout(()=>{if(!B.current){console.error("Map container not found");return}try{re.accessToken=s;const w=Y(z,P)?P:-9.1393,A=Y(z,P)?z:38.7223;b.current=new re.Map({container:B.current,style:"mapbox://styles/mapbox/light-v11",center:[w,A],zoom:15}),b.current.scrollZoom.disable(),b.current.on("load",()=>{b.current&&(Y(z,P)&&(l.current=new re.Marker({draggable:!0}).setLngLat([P,z]).addTo(b.current)),l.current.on("dragend",()=>{const $=l.current.getLngLat();E("lng",$.lng),E("lat",$.lat)}),setTimeout(()=>{b.current?.resize()},100))});const U=$=>{$.ctrlKey||$.metaKey?b.current?.scrollZoom.enable():b.current?.scrollZoom.disable()};B.current.addEventListener("wheel",U),b.current.on("click",$=>{const{lng:ge,lat:fe}=$.lngLat;E("lng",ge),E("lat",fe),l.current?.setLngLat([ge,fe])}),b.current.on("error",$=>{console.error("Map error:",$)})}catch(w){console.error("Failed to initialize map:",w)}},500);return()=>{clearTimeout(d)}},[y,z,P]),x.useEffect(()=>{l.current&&b.current&&Y(z,P)&&(l.current.setLngLat([P,z]),b.current.setCenter([P,z]))},[z,P]);const Ee=s=>{const n=s.target.files?.[0];if(n){C(n);const d=new FileReader;d.onloadend=()=>{_(d.result)},d.readAsDataURL(n)}},Fe=s=>{const n=s.target.files?.[0];if(n){o(n);const d=new FileReader;d.onloadend=()=>{Q(d.result)},d.readAsDataURL(n)}},Te=async()=>{if(!N)return a?.image_url||null;const s=N.name.split(".").pop(),d=`${`${Math.random()}.${s}`}`,{error:w}=await S.storage.from("restaurant-images").upload(d,N);if(w)throw w;const{data:{publicUrl:A}}=S.storage.from("restaurant-images").getPublicUrl(d);return A},Ae=async()=>{if(!q)return a?.cover_image_url||null;const s=q.name.split(".").pop(),d=`${`cover_${Math.random()}.${s}`}`,{error:w}=await S.storage.from("restaurant-images").upload(d,q);if(w)throw w;const{data:{publicUrl:A}}=S.storage.from("restaurant-images").getPublicUrl(d);return A},xe=async s=>{Z(!0);try{const{data:{user:n}}=await S.auth.getUser();if(!n)throw new Error("Not authenticated");const d=await Te(),w=await Ae(),A={name:s.name,name_en:s.name_en,name_pt:s.name_pt,key_id:s.key_id||null,type:s.type,type_en:s.type_en,type_pt:s.type_pt,description:s.description||null,description_en:s.description_en||null,description_pt:s.description_pt||null,announcement_zh:s.announcement_zh||null,announcement_en:s.announcement_en||null,announcement_pt:s.announcement_pt||null,address:s.address,lat:s.lat,lng:s.lng,phone:s.phone||null,website_url:s.website_url||null,show_website_button:s.show_website_button,show_takeaway_button:s.show_takeaway_button,show_booking_button:s.show_booking_button,show_dish_gallery:s.show_dish_gallery,image_url:d,cover_image_url:w,opening_hours:r};if(a){const{error:U}=await S.from("restaurants").update({...A,updated_by:n.id}).eq("id",a.id);if(U)throw U;g({title:t("common.success"),description:t("admin.restaurantUpdated")})}else{const{error:U}=await S.from("restaurants").insert([{...A,created_by:n.id}]);if(U)throw U;g({title:t("common.success"),description:t("admin.restaurantCreated")})}f.invalidateQueries({queryKey:["restaurants"]}),j(!1)}catch(n){g({title:t("common.error"),description:n.message,variant:"destructive"})}finally{Z(!1)}};return e.jsxs(us,{open:y,onOpenChange:j,children:[e.jsx(hs,{asChild:!0,children:c}),e.jsxs(xs,{className:"max-w-[95vw] sm:max-w-6xl max-h-[95vh] overflow-hidden flex flex-col p-0",children:[e.jsxs(gs,{className:"px-6 pt-6 pb-4 border-b bg-muted/30",children:[e.jsxs(fs,{className:"text-2xl flex items-center gap-2",children:[e.jsx(Ne,{className:"w-6 h-6 text-primary"}),t(a?"admin.editRestaurant":"admin.addRestaurant")]}),e.jsx(js,{className:"text-base",children:t(a?"admin.editRestaurantDetails":"admin.createRestaurantWithInfo")})]}),e.jsx(Ns,{className:"px-6 h-[calc(95vh-220px)]",children:e.jsxs("form",{onSubmit:W(xe),className:"space-y-6 py-6",children:[e.jsx(H,{className:"border-primary/20 bg-gradient-to-br from-background to-muted/20",children:e.jsxs(K,{className:"p-6",children:[e.jsxs(i,{className:"text-base font-semibold flex items-center gap-2 mb-4",children:[e.jsx(ue,{className:"w-5 h-5 text-primary"}),t("admin.restaurantImages")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:t("admin.cardImage")}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",t("admin.cardImageHint"),")"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[v&&e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:v,alt:"Card Preview",className:"w-32 h-32 object-cover rounded-lg shadow-lg ring-2 ring-primary/20 transition-transform duration-200 group-hover:scale-105"}),e.jsx(M,{type:"button",variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>{C(null),_(null)},children:e.jsx(se,{className:"h-3 w-3"})})]}),e.jsxs(i,{htmlFor:"image-upload",className:"cursor-pointer",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2 px-6 py-4 border-2 border-dashed border-primary/30 rounded-lg hover:border-primary hover:bg-primary/5 transition-all duration-200",children:[e.jsx(ue,{className:"h-6 w-6 text-primary"}),e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"font-medium text-xs",children:t("admin.uploadImage")})})]}),e.jsx(u,{id:"image-upload",type:"file",accept:"image/*",className:"hidden",onChange:Ee})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:t("admin.coverImage")}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",t("admin.coverImageHint"),")"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[R&&e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:R,alt:"Cover Preview",className:"w-32 h-32 object-cover rounded-lg shadow-lg ring-2 ring-accent/20 transition-transform duration-200 group-hover:scale-105"}),e.jsx(M,{type:"button",variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6 shadow-lg opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>{o(null),Q(null)},children:e.jsx(se,{className:"h-3 w-3"})})]}),e.jsxs(i,{htmlFor:"cover-image-upload",className:"cursor-pointer",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2 px-6 py-4 border-2 border-dashed border-accent/30 rounded-lg hover:border-accent hover:bg-accent/5 transition-all duration-200",children:[e.jsx(pe,{className:"h-6 w-6 text-accent"}),e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"font-medium text-xs",children:t("admin.uploadImage")})})]}),e.jsx(u,{id:"cover-image-upload",type:"file",accept:"image/*",className:"hidden",onChange:Fe})]})]})]})]})]})}),a?.id&&e.jsx(H,{className:"border-primary/20",children:e.jsxs(K,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs(i,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5 text-primary"}),t("admin.dishGallery")]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{htmlFor:"show-dish-gallery",className:"text-sm text-muted-foreground",children:t("admin.showDishGallery")}),e.jsx(ys,{id:"show-dish-gallery",checked:De,onCheckedChange:s=>E("show_dish_gallery",s)})]})]}),e.jsx(Ds,{restaurantId:a.id})]})}),e.jsx(H,{className:"border-primary/20",children:e.jsxs(K,{className:"p-6",children:[e.jsxs(i,{className:"text-base font-semibold flex items-center gap-2 mb-4",children:[e.jsx(ye,{className:"w-5 h-5 text-primary"}),t("admin.multilingualContent")]}),e.jsxs(bs,{defaultValue:"zh",className:"w-full",children:[e.jsxs(_s,{className:"grid w-full grid-cols-3 mb-6",children:[e.jsxs(le,{value:"zh",className:"gap-2",children:["ðŸ‡¨ðŸ‡³ ",t("admin.chinese")]}),e.jsxs(le,{value:"en",className:"gap-2",children:["ðŸ‡¬ðŸ‡§ ",t("admin.english")]}),e.jsxs(le,{value:"pt",className:"gap-2",children:["ðŸ‡µðŸ‡¹ ",t("admin.portuguese")]})]}),e.jsxs(oe,{value:"zh",className:"space-y-4 mt-0",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"name",className:"text-sm font-medium",children:t("admin.restaurantName")}),e.jsx(u,{id:"name",...D("name"),placeholder:t("admin.enterRestaurantName"),className:"text-base"}),k.name&&e.jsx("p",{className:"text-sm text-destructive",children:k.name.message})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(i,{className:"text-sm font-medium",children:t("admin.restaurantType")}),T.length<3&&e.jsx(M,{type:"button",variant:"outline",size:"sm",onClick:Ce,children:t("admin.addType")})]}),T.map((s,n)=>e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(me,{placeholder:t("admin.typeExample"),value:s.zh,onChange:d=>ae(n,"zh",d),suggestions:m?.uniqueZh||[]}),e.jsx(M,{type:"button",variant:"ghost",size:"icon",onClick:()=>ke(n),disabled:T.length===1,children:e.jsx(se,{className:"h-4 w-4"})})]},n)),k.type&&e.jsx("p",{className:"text-sm text-destructive",children:k.type.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"description",className:"text-sm font-medium",children:t("admin.description")}),e.jsx(ce,{value:L("description")||"",onChange:s=>E("description",s),placeholder:t("admin.enterDescription")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"announcement_zh",className:"text-sm font-medium",children:t("admin.announcement")}),e.jsx(ie,{id:"announcement_zh",...D("announcement_zh"),rows:2,placeholder:t("admin.enterAnnouncement")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t("admin.announcementHint")})]})]}),e.jsxs(oe,{value:"en",className:"space-y-4 mt-0",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"name_en",className:"text-sm font-medium",children:"Restaurant Name"}),e.jsx(u,{id:"name_en",...D("name_en"),placeholder:"Enter restaurant name...",className:"text-base"}),k.name_en&&e.jsx("p",{className:"text-sm text-destructive",children:k.name_en.message})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(i,{className:"text-sm font-medium",children:"Restaurant Types (1-3 tags)"}),T.map((s,n)=>e.jsx("div",{className:"flex gap-2 items-center",children:e.jsx(me,{placeholder:"e.g. Cantonese",value:s.en,onChange:d=>ae(n,"en",d),suggestions:m?.uniqueEn||[]})},n))]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"description_en",className:"text-sm font-medium",children:"Description"}),e.jsx(ce,{value:L("description_en")||"",onChange:s=>E("description_en",s),placeholder:"Enter restaurant description..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"announcement_en",className:"text-sm font-medium",children:"Announcement"}),e.jsx(ie,{id:"announcement_en",...D("announcement_en"),rows:2,placeholder:"Enter announcement (optional)..."}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Display important notices at top of restaurant page"})]})]}),e.jsxs(oe,{value:"pt",className:"space-y-4 mt-0",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"name_pt",className:"text-sm font-medium",children:"Nome do Restaurante"}),e.jsx(u,{id:"name_pt",...D("name_pt"),placeholder:"Digite o nome do restaurante...",className:"text-base"}),k.name_pt&&e.jsx("p",{className:"text-sm text-destructive",children:k.name_pt.message})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(i,{className:"text-sm font-medium",children:"Tipos de Restaurante (1-3 tags)"}),T.map((s,n)=>e.jsx("div",{className:"flex gap-2 items-center",children:e.jsx(me,{placeholder:"ex: Cantonesa",value:s.pt,onChange:d=>ae(n,"pt",d),suggestions:m?.uniquePt||[]})},n))]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"description_pt",className:"text-sm font-medium",children:"DescriÃ§Ã£o"}),e.jsx(ce,{value:L("description_pt")||"",onChange:s=>E("description_pt",s),placeholder:"Digite a descriÃ§Ã£o do restaurante..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"announcement_pt",className:"text-sm font-medium",children:"AnÃºncio"}),e.jsx(ie,{id:"announcement_pt",...D("announcement_pt"),rows:2,placeholder:"Digite o anÃºncio (opcional)..."}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Exibir avisos importantes no topo da pÃ¡gina do restaurante"})]})]})]})]})}),e.jsx(H,{className:"border-primary/20",children:e.jsxs(K,{className:"p-6 space-y-4",children:[e.jsxs(i,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5 text-primary"}),t("admin.locationAndContact")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"address",className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(J,{className:"w-4 h-4"}),t("admin.address")]}),e.jsx(u,{id:"address",...D("address"),placeholder:t("admin.enterAddress")}),k.address&&e.jsx("p",{className:"text-sm text-destructive",children:k.address.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"phone",className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Xe,{className:"w-4 h-4"}),t("admin.phone")]}),e.jsx(u,{id:"phone",...D("phone"),placeholder:"+351..."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"website_url",className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ye,{className:"w-4 h-4"}),t("admin.websiteBaseUrl")]}),e.jsx(u,{id:"website_url",...D("website_url"),placeholder:"https://sushi.xiaoxiong.pt:6000",readOnly:!h,disabled:!h,className:h?"":"bg-muted cursor-not-allowed"}),!h&&e.jsx("p",{className:"text-xs text-muted-foreground",children:t("admin.websiteReadOnly")})]}),h&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(i,{htmlFor:"key_id",className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Ze,{className:"w-4 h-4"}),"Key ID (API)"]}),e.jsx(u,{id:"key_id",...D("key_id"),placeholder:"ä¾‹å¦‚: saldanha01"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 p-3 rounded-lg border bg-muted/30",children:[e.jsx(O,{id:"show_takeaway_button",checked:Ie,onCheckedChange:s=>E("show_takeaway_button",s)}),e.jsxs(i,{htmlFor:"show_takeaway_button",className:"cursor-pointer text-sm flex items-center gap-2",children:[e.jsx(We,{className:"w-4 h-4"}),t("admin.showTakeawayButton")]})]}),e.jsxs("div",{className:"flex items-center space-x-2 p-3 rounded-lg border bg-muted/30",children:[e.jsx(O,{id:"show_booking_button",checked:Se,onCheckedChange:s=>E("show_booking_button",s)}),e.jsxs(i,{htmlFor:"show_booking_button",className:"cursor-pointer text-sm flex items-center gap-2",children:[e.jsx(Ye,{className:"w-4 h-4"}),t("admin.showBookingButton")]})]})]})]})}),e.jsx(H,{className:"border-primary/20",children:e.jsxs(K,{className:"p-6 space-y-4",children:[e.jsxs(i,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5 text-primary"}),t("admin.location")]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"lat",className:"text-sm font-medium",children:t("admin.latitude")}),e.jsx(u,{id:"lat",type:"number",step:"any",...D("lat",{valueAsNumber:!0})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"lng",className:"text-sm font-medium",children:t("admin.longitude")}),e.jsx(u,{id:"lng",type:"number",step:"any",...D("lng",{valueAsNumber:!0})})]})]}),e.jsx("div",{ref:B,className:"h-96 w-full rounded-lg border-2 border-primary/20 shadow-sm",style:{minHeight:"384px"}}),e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[e.jsx(J,{className:"w-4 h-4"}),t("admin.clickOrDragToSetLocation")]})]})}),e.jsx(H,{className:"border-primary/20 overflow-hidden",children:e.jsxs(K,{className:"p-3 md:p-6 space-y-4",children:[e.jsxs(i,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(Je,{className:"w-5 h-5 text-primary"}),t("admin.openingHours")]}),e.jsx("div",{className:"space-y-2",children:_e.map(s=>e.jsxs("div",{className:"space-y-2 p-2 md:p-3 rounded-lg hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"md:hidden space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{className:"capitalize font-semibold text-sm",children:t(`admin.day.${s}`)}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(O,{id:`split-mobile-${s}`,checked:r[s].splitShift,onCheckedChange:n=>p({...r,[s]:{...r[s],splitShift:n}}),disabled:r[s].closed,className:"h-4 w-4"}),e.jsx(i,{htmlFor:`split-mobile-${s}`,className:"cursor-pointer text-xs",children:"åˆ†æ®µ"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(O,{id:`closed-mobile-${s}`,checked:r[s].closed,onCheckedChange:n=>p({...r,[s]:{...r[s],closed:n}}),className:"h-4 w-4"}),e.jsx(i,{htmlFor:`closed-mobile-${s}`,className:"cursor-pointer text-xs",children:t("admin.closed")})]})]})]}),!r[s].closed&&e.jsx("div",{className:"space-y-1.5",children:r[s].splitShift?e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"grid grid-cols-[32px_1fr_12px_1fr] gap-1 items-center",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"åˆé¤"}),e.jsx(u,{type:"time",value:r[s].open,onChange:n=>p({...r,[s]:{...r[s],open:n.target.value}}),className:"h-8 text-xs px-2 min-w-0"}),e.jsx("span",{className:"text-muted-foreground text-xs text-center",children:"-"}),e.jsx(u,{type:"time",value:r[s].close,onChange:n=>p({...r,[s]:{...r[s],close:n.target.value}}),className:"h-8 text-xs px-2 min-w-0"})]}),e.jsxs("div",{className:"grid grid-cols-[32px_1fr_12px_1fr] gap-1 items-center",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"æ™šé¤"}),e.jsx(u,{type:"time",value:r[s].open2||"19:00",onChange:n=>p({...r,[s]:{...r[s],open2:n.target.value}}),className:"h-8 text-xs px-2 min-w-0"}),e.jsx("span",{className:"text-muted-foreground text-xs text-center",children:"-"}),e.jsx(u,{type:"time",value:r[s].close2||"23:00",onChange:n=>p({...r,[s]:{...r[s],close2:n.target.value}}),className:"h-8 text-xs px-2 min-w-0"})]})]}):e.jsxs("div",{className:"grid grid-cols-[1fr_12px_1fr] gap-1 items-center",children:[e.jsx(u,{type:"time",value:r[s].open,onChange:n=>p({...r,[s]:{...r[s],open:n.target.value}}),className:"h-8 text-xs px-2 min-w-0"}),e.jsx("span",{className:"text-muted-foreground text-xs text-center",children:"-"}),e.jsx(u,{type:"time",value:r[s].close,onChange:n=>p({...r,[s]:{...r[s],close:n.target.value}}),className:"h-8 text-xs px-2 min-w-0"})]})})]}),e.jsxs("div",{className:"hidden md:block",children:[e.jsxs("div",{className:"grid grid-cols-[120px_1fr_auto] gap-4 items-center",children:[e.jsx(i,{className:"capitalize font-semibold",children:t(`admin.day.${s}`)}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{id:`split-${s}`,checked:r[s].splitShift,onCheckedChange:n=>p({...r,[s]:{...r[s],splitShift:n}}),disabled:r[s].closed}),e.jsx(i,{htmlFor:`split-${s}`,className:"cursor-pointer text-sm",children:"åˆ†æ®µè¥ä¸š"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{id:`closed-${s}`,checked:r[s].closed,onCheckedChange:n=>p({...r,[s]:{...r[s],closed:n}})}),e.jsx(i,{htmlFor:`closed-${s}`,className:"cursor-pointer",children:t("admin.closed")})]})]}),!r[s].closed&&e.jsx("div",{className:"ml-[120px] space-y-2 mt-2",children:r[s].splitShift?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground w-12",children:"åˆé¤"}),e.jsx(u,{type:"time",value:r[s].open,onChange:n=>p({...r,[s]:{...r[s],open:n.target.value}}),className:"w-32"}),e.jsx("span",{className:"text-muted-foreground",children:"-"}),e.jsx(u,{type:"time",value:r[s].close,onChange:n=>p({...r,[s]:{...r[s],close:n.target.value}}),className:"w-32"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground w-12",children:"æ™šé¤"}),e.jsx(u,{type:"time",value:r[s].open2||"19:00",onChange:n=>p({...r,[s]:{...r[s],open2:n.target.value}}),className:"w-32"}),e.jsx("span",{className:"text-muted-foreground",children:"-"}),e.jsx(u,{type:"time",value:r[s].close2||"23:00",onChange:n=>p({...r,[s]:{...r[s],close2:n.target.value}}),className:"w-32"})]})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{type:"time",value:r[s].open,onChange:n=>p({...r,[s]:{...r[s],open:n.target.value}}),className:"w-32"}),e.jsx("span",{className:"text-muted-foreground",children:"-"}),e.jsx(u,{type:"time",value:r[s].close,onChange:n=>p({...r,[s]:{...r[s],close:n.target.value}}),className:"w-32"})]})})]})]},s))})]})})]})}),e.jsxs("div",{className:"flex justify-end gap-2 px-6 py-4 border-t bg-muted/30",children:[e.jsx(M,{type:"button",variant:"outline",onClick:()=>j(!1),children:t("common.cancel")}),e.jsxs(M,{type:"submit",disabled:X,onClick:W(xe),className:"gap-2",children:[e.jsx(Ne,{className:"w-4 h-4"}),t(X?"common.saving":"common.save")]})]})]})]})}export{Us as R,ws as u};
//# sourceMappingURL=RestaurantFormDialog-C0je_fKJ.js.map
