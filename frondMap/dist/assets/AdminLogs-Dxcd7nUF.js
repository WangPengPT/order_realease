import{c as q,u as Z,r as c,j as e,C as n,f as i,I as K,af as P,ag as D,ah as A,ai as _,aj as m,Z as v,at as Q,B as W,q as X,v as Y,n as I}from"./index-OzGmxN22.js";import{T as ee,a as ae,b as w,c as j,d as se,e as o}from"./table-C7mgm3el.js";import{t as re}from"./useAdmin-8G1PkNeE.js";import{u as te,P as le,a as ne,b as k,c as de,d as ce,f as ie}from"./usePagination-cjiaKTJI.js";import{F as y}from"./file-text-nQ01j1zD.js";import{S as me}from"./search-BtPL6nQN.js";import{F as oe}from"./filter-BzcQ-z-5.js";import{C as xe}from"./clock-aHvNU43N.js";import{f as he}from"./format-i6n1YrG8.js";import"./chevron-left-Do78uqFQ.js";import"./ellipsis-DmbGDE6H.js";import"./startOfDay-DN1Q9D9G.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p=q("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),Ee=()=>{const{t:r}=Z(),{data:t,isLoading:F}=re(),[R,M]=c.useState(new Set),[x,U]=c.useState(""),[u,B]=c.useState("all"),[N,V]=c.useState("all"),H=c.useMemo(()=>t?[...new Set(t.map(l=>l.table_name))].sort():[],[t]),T=c.useMemo(()=>t?t.filter(a=>{var L;const l=x===""||((L=a.user_name)==null?void 0:L.toLowerCase().includes(x.toLowerCase()))||a.table_name.toLowerCase().includes(x.toLowerCase()),s=u==="all"||a.action===u,f=N==="all"||a.table_name===N;return l&&s&&f}):[],[t,x,u,N]),{currentPage:d,totalPages:h,paginatedData:b,goToPage:g,canGoNext:E,canGoPrevious:S,startIndex:z,endIndex:G,totalItems:J}=te({data:T,itemsPerPage:15}),O=a=>{M(l=>{const s=new Set(l);return s.has(a)?s.delete(a):s.add(a),s})},$=a=>({INSERT:{variant:"default",className:"bg-emerald-500/10 text-emerald-600 dark:text-emerald-400 border-emerald-500/20 hover:bg-emerald-500/20"},UPDATE:{variant:"secondary",className:"bg-amber-500/10 text-amber-600 dark:text-amber-400 border-amber-500/20 hover:bg-amber-500/20"},DELETE:{variant:"destructive",className:"bg-red-500/10 text-red-600 dark:text-red-400 border-red-500/20 hover:bg-red-500/20"}})[a]||{variant:"outline",className:""},C=a=>{if(!a)return null;try{return JSON.stringify(a,null,2)}catch{return String(a)}};return F?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),e.jsx("span",{className:"text-muted-foreground",children:r("common.loading")})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(y,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:r("admin.operationLogs")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r("admin.viewSystemLogs")})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(n,{className:"border-none shadow-sm bg-gradient-to-br from-emerald-500/5 to-emerald-500/10 dark:from-emerald-500/10 dark:to-emerald-500/20",children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-emerald-500/10 dark:bg-emerald-500/20",children:e.jsx(p,{className:"h-4 w-4 text-emerald-600 dark:text-emerald-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"INSERT"}),e.jsx("p",{className:"text-xl font-bold text-emerald-600 dark:text-emerald-400",children:(t==null?void 0:t.filter(a=>a.action==="INSERT").length)||0})]})]})})}),e.jsx(n,{className:"border-none shadow-sm bg-gradient-to-br from-amber-500/5 to-amber-500/10 dark:from-amber-500/10 dark:to-amber-500/20",children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-amber-500/10 dark:bg-amber-500/20",children:e.jsx(p,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"UPDATE"}),e.jsx("p",{className:"text-xl font-bold text-amber-600 dark:text-amber-400",children:(t==null?void 0:t.filter(a=>a.action==="UPDATE").length)||0})]})]})})}),e.jsx(n,{className:"border-none shadow-sm bg-gradient-to-br from-red-500/5 to-red-500/10 dark:from-red-500/10 dark:to-red-500/20",children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-red-500/10 dark:bg-red-500/20",children:e.jsx(p,{className:"h-4 w-4 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"DELETE"}),e.jsx("p",{className:"text-xl font-bold text-red-600 dark:text-red-400",children:(t==null?void 0:t.filter(a=>a.action==="DELETE").length)||0})]})]})})}),e.jsx(n,{className:"border-none shadow-sm bg-gradient-to-br from-primary/5 to-primary/10",children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-primary/10",children:e.jsx(y,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:r("common.total")}),e.jsx("p",{className:"text-xl font-bold text-primary",children:(t==null?void 0:t.length)||0})]})]})})})]}),e.jsx(n,{className:"border-none shadow-sm",children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(me,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(K,{placeholder:r("common.search"),value:x,onChange:a=>U(a.target.value),className:"pl-9"})]}),e.jsxs(P,{value:u,onValueChange:B,children:[e.jsxs(D,{className:"w-full sm:w-[140px]",children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),e.jsx(A,{placeholder:r("admin.action")})]}),e.jsxs(_,{children:[e.jsx(m,{value:"all",children:r("common.all")}),e.jsx(m,{value:"INSERT",children:"INSERT"}),e.jsx(m,{value:"UPDATE",children:"UPDATE"}),e.jsx(m,{value:"DELETE",children:"DELETE"})]})]}),e.jsxs(P,{value:N,onValueChange:V,children:[e.jsxs(D,{className:"w-full sm:w-[180px]",children:[e.jsx(p,{className:"h-4 w-4 mr-2"}),e.jsx(A,{placeholder:r("admin.table")})]}),e.jsxs(_,{children:[e.jsx(m,{value:"all",children:r("common.all")}),H.map(a=>e.jsx(m,{value:a,children:a},a))]})]})]})})}),T.length>0&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:[r("common.showing")," ",z,"-",G," ",r("common.of")," ",J," ",r("common.results")]}),b&&b.length>0?e.jsx(n,{className:"border-none shadow-sm overflow-hidden",children:e.jsx(v,{className:"w-full",children:e.jsxs(ee,{children:[e.jsx(ae,{children:e.jsxs(w,{className:"bg-muted/30 hover:bg-muted/30",children:[e.jsx(j,{className:"w-[50px]"}),e.jsx(j,{className:"min-w-[120px]",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4"}),r("admin.user")]})}),e.jsx(j,{className:"min-w-[120px]",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-4 w-4"}),r("admin.table")]})}),e.jsx(j,{className:"min-w-[100px]",children:r("admin.action")}),e.jsx(j,{className:"min-w-[160px]",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4"}),r("admin.time")]})})]})}),e.jsx(se,{children:b.map(a=>{const l=R.has(a.id),s=a.old_data||a.new_data,f=$(a.action);return e.jsxs(e.Fragment,{children:[e.jsxs(w,{className:`cursor-pointer transition-colors ${s?"hover:bg-muted/50":""}`,onClick:()=>s&&O(a.id),children:[e.jsx(o,{className:"w-[50px]",children:s&&e.jsx(W,{variant:"ghost",size:"icon",className:"h-6 w-6",children:l?e.jsx(X,{className:"h-4 w-4"}):e.jsx(Y,{className:"h-4 w-4"})})}),e.jsx(o,{children:e.jsx("span",{className:"font-medium",children:a.user_name||"-"})}),e.jsx(o,{children:e.jsx(I,{variant:"outline",className:"font-mono text-xs",children:a.table_name})}),e.jsx(o,{children:e.jsx(I,{variant:f.variant,className:f.className,children:a.action})}),e.jsx(o,{className:"text-muted-foreground text-sm",children:he(new Date(a.created_at),"yyyy-MM-dd HH:mm:ss")})]},a.id),l&&s&&e.jsx(w,{children:e.jsx(o,{colSpan:5,className:"bg-muted/20 p-0",children:e.jsx("div",{className:"p-4 space-y-4",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[a.old_data&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-red-500 dark:bg-red-400"}),e.jsx("span",{className:"font-semibold text-sm text-red-600 dark:text-red-400",children:r("admin.oldData")})]}),e.jsx(v,{className:"h-[200px] rounded-lg border border-red-500/20 dark:border-red-400/30 bg-red-500/5 dark:bg-red-500/10",children:e.jsx("pre",{className:"p-3 text-xs font-mono whitespace-pre-wrap break-all text-foreground",children:C(a.old_data)})})]}),a.new_data&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-emerald-500 dark:bg-emerald-400"}),e.jsx("span",{className:"font-semibold text-sm text-emerald-600 dark:text-emerald-400",children:r("admin.newData")})]}),e.jsx(v,{className:"h-[200px] rounded-lg border border-emerald-500/20 dark:border-emerald-400/30 bg-emerald-500/5 dark:bg-emerald-500/10",children:e.jsx("pre",{className:"p-3 text-xs font-mono whitespace-pre-wrap break-all text-foreground",children:C(a.new_data)})})]})]})})})},`${a.id}-expanded`)]})})})]})})}):e.jsx(n,{className:"border-none shadow-sm",children:e.jsx(i,{className:"py-16 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"p-4 rounded-full bg-muted",children:e.jsx(y,{className:"h-8 w-8 text-muted-foreground"})}),e.jsx("p",{className:"text-muted-foreground",children:r("admin.noLogs")})]})})}),h>1&&e.jsx(le,{children:e.jsxs(ne,{children:[e.jsx(k,{children:e.jsx(de,{onClick:()=>S&&g(d-1),className:S?"cursor-pointer":"pointer-events-none opacity-50"})}),Array.from({length:Math.min(5,h)},(a,l)=>{let s;return h<=5||d<=3?s=l+1:d>=h-2?s=h-4+l:s=d-2+l,e.jsx(k,{children:e.jsx(ce,{onClick:()=>g(s),isActive:d===s,className:"cursor-pointer",children:s})},s)}),e.jsx(k,{children:e.jsx(ie,{onClick:()=>E&&g(d+1),className:E?"cursor-pointer":"pointer-events-none opacity-50"})})]})})]})};export{Ee as default};
