import{b as S}from"./index-CVxU1wDC.js";import{s as T,a as V}from"./index-B6M-gLoM.js";import{s as B,a as $}from"./index-avQ4xReK.js";import{s as j}from"./index-BsjQsiAw.js";import{q as z,x as O,n as w,h as b,s as q,c as g,a as s,d as r,w as d,l as a,F as E,o as _,z as G,t as o,C as U,e as A,G as H}from"./index-MrR6C9t0.js";import{s as K}from"./index-BfLEwXS-.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-Lxj5anYN.js";import"./index-CvDYJC99.js";import"./index-DvDI8nHD.js";import"./index-BtIaMt8Q.js";import"./index-Cov5iJfY.js";import"./index-C9wI_QoG.js";import"./index-CTV2FnW_.js";const J={class:"card h-full",style:{display:"flex","flex-direction":"column"}},Q={class:"flex flex-wrap gap-2 items-center justify-between"},W={class:"m-0 font-bold text-2xl text-left flex-grow-1"},X={class:"flex gap-2 mt-1"},Y={class:"font-bold"},Z={class:"font-bold text-green-800"},ee={class:"font-bold text-blue-800"},te={class:"font-bold text-red-800"},se={key:0},ae={key:1},le={class:"text-center py-5"},oe={class:"mt-3 text-gray-500"},re={class:"flex flex-column gap-2"},ne={key:0,class:"text-red-600"},ie={class:"font-bold text-lg"},de={class:"font-bold text-lg"},ce={class:"font-bold text-lg"},ue={class:"font-bold text-lg"},me={class:"flex justify-content-end"},ve={__name:"ReserverPage",setup(pe){const{t:e}=z(),y=O(),m=w.tableReserves,t=b(),v=b(!1);function C(l){t.value=l.data,v.value=!0,console.log(t.value)}const h=b({global:{value:null,matchMode:H.CONTAINS}}),P=q(()=>{const l=t.value.status;return l=="processing"?{label:e("reserverPage.processing")+"...",outlined:!0}:l=="voided"?{label:e("orderPage.voided"),outlined:!0}:{label:e("reserverPage.cancelReserve"),outlined:!1}});function R(){t.value.status=="processing"||t.value.status=="voided"||y.require({message:e("reserverPage.reserveCancellationMSG"),header:e("reserverPage.cancelReserve")+":"+t.value.name,rejectProps:{label:e("common.cancel"),severity:"secondary",outlined:!0},acceptProps:{label:e("common.confirm"),severity:"danger"},accept:()=>{w.cancelReserve({...t.value,status:"processing"},l=>{l.success?(t.value.status=l.data.status,v.value=!1):console.log("Cancellation Error:",l.data)})},reject:()=>{}})}function p(l){const n=m.value.filter(u=>u.financial_status==="voided"||u.status==="voided").length,f=m.value.filter(u=>u.status==="new"||u.status==="confirmed").length;switch(l){case"completed":return m.value.length-n-f;case"voided":return n;case"unCompleted":return f;default:return m.value.length}}const N=l=>({completed:"status-completed",confirmed:"status-confirmed",processing:"status-processing",new:"status-new",voided:"status-voided"})[l]||"",D=l=>({completed:e("orderPage.completed"),confirmed:e("orderPage.confirmed"),processing:e("reserverPage.processing"),new:e("orderPage.new"),voided:e("orderPage.voided")})[l]||l,k=l=>new Date(l).toLocaleString(void 0,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});return(l,n)=>{var x;const f=$,u=j,I=B,c=V,M=T,F=S;return _(),g(E,null,[s("div",J,[r(M,{value:a(m),tableStyle:"min-width: 50rem",dataKey:"id",paginator:"",rows:10,rowsPerPageOptions:[10,20,50],stripedRows:"",filters:h.value,scrollable:"",scrollHeight:"flex",onRowClick:C,selectionMode:"single"},{header:d(()=>[s("div",Q,[s("h4",W,o(a(e)("reserverPage.header")),1),r(I,null,{default:d(()=>[r(f,null,{default:d(()=>n[2]||(n[2]=[s("i",{class:"pi pi-search"},null,-1)])),_:1,__:[2]}),r(u,{modelValue:h.value.global.value,"onUpdate:modelValue":n[0]||(n[0]=i=>h.value.global.value=i),placeholder:a(e)("orderPage.find")},null,8,["modelValue","placeholder"])]),_:1})]),s("div",X,[s("label",Y,"订台总数:"+o(p("all")),1),s("label",Z,"订台完成数:"+o(p("completed")),1),s("label",ee,"订台未完成数:"+o(p("unCompleted")),1),s("label",te,"订台取消数:"+o(p("voided")),1)])]),empty:d(()=>[s("div",le,[n[3]||(n[3]=s("i",{class:"pi pi-search",style:{"font-size":"3rem",color:"#ccc"}},null,-1)),s("p",oe,o(a(e)("orderPage.notFound")),1)])]),default:d(()=>[r(c,{header:a(e)("orderPage.status")},{body:d(({data:i})=>[s("span",{class:G(["status-badge",N(i.status||"new")])},o(D(i.status||"new")),3)]),_:1},8,["header"]),r(c,{field:"name",header:"ID",sortable:""}),r(c,{field:"date",header:a(e)("reserverPage.dateTime"),sortable:""},{body:d(({data:i})=>[U(o(i.date+" "+i.time),1)]),_:1},8,["header"]),r(c,{field:"discount",header:a(e)("reserverPage.discount")},{body:d(({data:i})=>[i.discount?(_(),g("label",se,o(i.discount)+"%",1)):(_(),g("label",ae))]),_:1},8,["header"]),r(c,{field:"customerName",header:a(e)("reserverPage.customerName")},null,8,["header"]),r(c,{field:"numberPeople",header:a(e)("reserverPage.numberPeople")},null,8,["header"]),r(c,{field:"phone",header:a(e)("reserverPage.phone")},null,8,["header"]),r(c,{field:"note",header:a(e)("reserverPage.note")},null,8,["header"])]),_:1},8,["value","filters"])]),r(a(K),{visible:v.value,"onUpdate:visible":n[1]||(n[1]=i=>v.value=i),header:a(e)("reserverPage.reserveDetails")+" (ID: "+((x=t.value)==null?void 0:x.name)+")",modal:"",style:{width:"450px"}},{default:d(()=>[s("div",re,[t.value.financial_status||t.value.status==="voided"?(_(),g("label",ne,o(t.value.financial_status?a(e)("reserverPage.cancelForClient"):a(e)("reserverPage.cancelForRestaurant")),1)):A("",!0),s("label",ie,o(a(e)("reserverPage.dateTime")+": "+t.value.date+" "+t.value.time),1),s("label",de,o(a(e)("reserverPage.discount")+": "+(t.value.discount?t.value.discount+"%":"")),1),s("label",ce,o(a(e)("reserverPage.customerName")+": "+t.value.customerName),1),s("label",ue,o(a(e)("reserverPage.numberPeople")+": "+t.value.numberPeople),1),s("label",null,o(a(e)("reserverPage.phone")+": "+t.value.phone),1),s("label",null,o(a(e)("reserverPage.email")+": "+t.value.email),1),s("label",null,o(a(e)("reserverPage.creationDate")+": "+(t.value.creationDate?k(t.value.creationDate):"")),1),s("label",null,o(a(e)("reserverPage.note")+": "+t.value.note),1),s("div",me,[r(F,{label:P.value.label,outlined:P.value.outlined,onClick:R},null,8,["label","outlined"])])])]),_:1},8,["visible","header"])],64)}}},Ie=L(ve,[["__scopeId","data-v-4baf4600"]]);export{Ie as default};
