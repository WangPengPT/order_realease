import{g as Ye,r as Ze}from"./vendor-DYQJwaLu.js";import{Q as re,b as w,e as _e,f as m,o as n,h as e,v as y,F,y as ee,a as D,B as ue,t as o,M as t,s as N,E as Ie,c as K,A as pe,U as ze,w as ve,C as oe,p as et,I as tt,J as st,n as We,R as lt,S as at}from"./vue-BLaX11bV.js";import{k as De,b as E,e as me,l as nt,m as Ue,j as Ee,n as He,u as ot,f as Me,g as Le,h as Re,d as Ve,o as it,p as Pe,c as Se,q as rt,r as ut,v as ct,i as dt,w as mt,x as ft}from"./primevue-DRc8vkgT.js";import{c as x,m as Z,a as Ce,g as vt}from"./index-B6hkIraI.js";import{D as Q,c as ne,l as Be}from"./localforage-Cr7WH93t.js";import{_ as xe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as ht,S as pt}from"./pagination-ByGpG7Fh.js";var gt=Ze();const Ae=Ye(gt),yt={class:"grid"},bt={key:0,class:"col-12 sm:col-12 md:col-6 lg:col-4 border-round surface-section shadow-1 p-2"},_t={class:"flex flex-column"},xt=["onClick"],kt={class:"p-1 flex-shrink-0 w-7rem h-7rem flex align-items-center justify-content-center overflow-hidden"},wt=["src","alt"],$t={class:"flex flex-column justify-content-center"},Dt={class:"font-bold"},It={class:"flex flex-wrap gap-2"},Ct={class:"flex gap-1 align-items-center"},Tt={class:"text-color-secondary line2"},Nt={key:0,class:"text-xl font-bold text-primary"},qt={key:1,class:"flex align-items-center gap-1"},St={class:"text-l font-bold text-color-secondary"},At={class:"text-sm line-through text-500"},Mt={key:2,class:"flex gap-2 mr-2",id:"card-quantity"},Lt={class:"w-2rem text-xl text-center"},Rt={key:3,class:"flex gap-2 mr-2"},Vt={key:0,class:"m-2 mt-0"},Pt={class:"flex flex-row justify-content-between align-content-center"},Et={class:"flex flex-column"},jt={class:"text-l font-bold"},Ot={key:0,class:"text-l font-bold text-color-secondary"},Ft={key:1,class:"flex align-items-center gap-1"},Wt={class:"text-l font-bold text-color-secondary"},Ut={class:"text-sm line-through text-500"},Ht={key:0,class:"flex ml-2 mr-2"},Bt={class:"w-2rem text-xl text-center"},zt={key:1,class:"flex gap-2 mr-3 pt-2 pb-2"},Qt={class:"mb-2 flex justify-content-center"},Gt={class:"font-bold text-center"},Kt={class:"mb-2"},Jt={class:"text-color-secondary m-0 line-height-3 line2 text-center"},Xt={class:"mb-2"},Yt={class:"flex justify-content-center"},Zt=["src","alt"],es={class:"flex align-items-center gap-2"},ts=["src","alt"],ss={class:"flex align-items-center gap-3 ml-auto"},ls={__name:"DishList",props:{rateDish:{type:Function,required:!0},likedItemsRef:Array,dislikedItemsRef:Array,tabIndex:Number,onlyVeg:Boolean},setup(q){const{t:z}=re(),$=Q.dishDatas,L=w(null),b=q,C=(u,S=!0)=>{if(!b.onlyVeg)return!0;if(S)return u.vegetable;if(u.subItems.length>0){for(const f of u.subItems)if(f.vegetable)return!0}else return u.dish.vegetable;return!1};_e(()=>{let u=x.getOrderMenuTab()[b.tabIndex];if(x.customDishAPI.customDishes.value.map(c=>c.name),x.getMenu().length==0){console.log("exit");return}L.value=$.value[f($.value,u)].mainDishes,Q.showDishList(L.value);function f(c,g){for(const l in c)if(c[l].name==g)return l;console.error("Can not find tab index in menu")}});let i={rated:!1,id:null,like:0,rate:0};const V=u=>Q.dishDatas.value[u]?Q.dishDatas.value[u].quantity:0,p=u=>{if(!j())return!1;const S=u.quantity;let f=3;if(u.price>0&&(f=9),u.limit){const c=u.id,g=j(),l=(g.peopleType.adults+g.peopleType.children)*u.limit,d=g.order.find(v=>v.dishid==c);let r=0;if(u.subitem)for(const v of u.subitem){r+=V(v);const _=g.order.find(G=>G.dishid==P(v));_&&(r+=_.quantity)}else r+=u.quantity,d&&(r+=d.quantity);return S>=f||l&&r>=l}return S>=f},P=u=>Q.dishDatas.value[u]?Q.dishDatas.value[u].id:0,j=()=>x.getTableValue(),W=u=>{let S="absolute origin-top-left mt-1 ml-1 border-round-lg pl-1 pr-1 text-xs text-white font-bold ";switch(u){case"new":S+="bg-red-600";break;case"recommended":case"special":S+="bg-orange-600";break;default:S+="bg-blue-600"}return S};function I(u){b.rateDish(i.id,i.like,i.rate,i.rated),U(u,i.rate,i.like),i.id=null,i.like=0,i.rate=0,i.rated=!1}const M=u=>{const S=b.likedItemsRef.indexOf(u);if(i.id=u.id,S!==-1)b.likedItemsRef.splice(S,1),i.like+=-1,i.rate+=-1,i.rated=!1;else{i.rated=!0,b.likedItemsRef.push(u);const f=b.dislikedItemsRef.indexOf(u);f!==-1?(b.dislikedItemsRef.splice(f,1),i.like+=1):(i.like+=1,i.rate+=1)}I(u)};function U(u,S=0,f=0){u.rates=(u.rates||0)+S,u.likes=(u.likes||0)+f}const J=u=>{const S=b.dislikedItemsRef.indexOf(u);if(i.id=u.id,S!==-1)b.dislikedItemsRef.splice(S,1),i.rate+=-1,i.rated=!1;else{i.rated=!0,b.dislikedItemsRef.push(u);const f=b.likedItemsRef.indexOf(u);f!==-1?(b.likedItemsRef.splice(f,1),i.like+=-1):i.rate+=1}I(u)},X=w(!1),O=w({}),ae=u=>{X.value=!0,O.value=u},te=u=>{u.target.src="/images/default.png"};function se(u){le(u.target,300)}function ie(u){le(u.target,110)}function le(u,S){const f=u.naturalWidth,c=u.naturalHeight,g=Math.min(f,S),l=g/f,d=c*l;u.style.width=`${g}px`,u.style.height=`${d}px`}return(u,S)=>(n(),m(F,null,[e("div",yt,[(n(!0),m(F,null,ee(L.value,(f,c)=>{var g;return n(),m(F,{key:c},[C(f,!1)?(n(),m("div",bt,[e("div",_t,[e("div",{class:ue(["flex flex-row",f.subItems.length!==0?"flex-grow-1":""]),onClick:l=>ae(f.dish)},[((g=f.dish.etiquette)==null?void 0:g.length)>0?(n(),m("div",{key:0,class:ue(W(f.dish.etiquette))},o(t(z)("common.etiquette."+f.dish.etiquette)),3)):D("",!0),e("div",kt,[e("img",{src:f.dish.image||"/images/default.png",alt:f.dish.name,class:"w-full h-full",style:{"object-fit":"cover"},onError:te,onLoad:ie},null,40,wt)]),e("div",$t,[e("div",Dt,o(f.dish.name),1),e("div",null,[e("div",It,[e("div",Ct,[(n(),m(F,null,ee(5,l=>e("i",{key:l,class:ue(["pi invert-star",l<=Math.floor(f.dish.likes/f.dish.rates*5)?"pi-star-fill":l-.5<=f.dish.likes/f.dish.rates*5?"pi-star-half-fill":"pi-star"]),style:{color:"black"}},null,2)),64)),e("p",null,"("+o(f.dish.rates?f.dish.rates:0)+")",1)])])]),e("div",null,[e("p",Tt,o(f.dish.note),1)])])],10,xt),f.subItems.length==0?(n(),m("div",{key:0,class:ue(["flex ml-2 mr-2 mb-2",Number(f.dish.price)>0?"justify-content-between":"justify-content-end"])},[!f.dish.discount&&Number(f.dish.price)>0?(n(),m("span",Nt,"â‚¬"+o(f.dish.price),1)):D("",!0),f.dish.discount?(n(),m("div",qt,[e("span",St,"â‚¬"+o(f.dish.dis_price),1),e("span",At,"â‚¬"+o(f.dish.price),1),y(t(De),{severity:"danger",value:"-"+f.dish.discount+"%"},null,8,["value"])])):D("",!0),f.dish.soldout?D("",!0):(n(),m("div",Mt,[y(t(E),{icon:"pi pi-minus",rounded:"",disabled:f.dish.quantity<=0,onClick:l=>f.dish.quantity--,class:"w-2rem h-2rem"},null,8,["disabled","onClick"]),e("span",Lt,o(f.dish.quantity),1),y(t(E),{icon:"pi pi-plus",rounded:"",disabled:p(f.dish),onClick:l=>f.dish.quantity++,class:"w-2rem h-2rem"},null,8,["disabled","onClick"])])),f.dish.soldout?(n(),m("div",Rt,[y(t(De),{severity:"danger",value:u.$t("common.soldout")},null,8,["value"])])):D("",!0)],2)):D("",!0),f.subItems.length!==0?(n(!0),m(F,{key:1},ee(f.subItems,(l,d)=>(n(),m(F,{key:"index"},[!l.disable&&C(l)?(n(),m("div",Vt,[e("div",Pt,[e("div",Et,[e("span",jt,o(l.subname),1),!l.discount&&l.price!=="0.00"&&l.price!=="0"?(n(),m("span",Ot,"â‚¬"+o(l.price),1)):D("",!0),l.discount?(n(),m("div",Ft,[e("span",Wt,"â‚¬"+o(l.dis_price),1),e("span",Ut,"â‚¬"+o(l.price),1),y(t(De),{severity:"danger",value:"-"+l.discount+"%"},null,8,["value"])])):D("",!0)]),l.soldout?D("",!0):(n(),m("div",Ht,[y(t(E),{icon:"pi pi-minus",rounded:"",disabled:l.quantity<=0,onClick:r=>l.quantity--,class:"w-2rem h-2rem"},null,8,["disabled","onClick"]),e("span",Bt,o(l.quantity),1),y(t(E),{icon:"pi pi-plus",rounded:"",onClick:r=>l.quantity++,class:"w-2rem h-2rem",disabled:p(l)},null,8,["onClick","disabled"])])),l.soldout?(n(),m("div",zt,[y(t(De),{severity:"danger",value:u.$t("common.soldout")},null,8,["value"])])):D("",!0)])])):D("",!0)],64))),128)):D("",!0)])])):D("",!0)],64)}),128))]),y(t(me),{visible:X.value,"onUpdate:visible":S[2]||(S[2]=f=>X.value=f),modal:"",header:" ",style:Ie([{width:"23rem"},{width:"80vw","max-width":"700px"}]),pt:{header:{class:"p-1"}}},{default:N(()=>[e("div",Qt,[e("span",Gt,o(O.value.name),1)]),e("div",Kt,[e("span",Jt,o(O.value.note),1)]),e("div",Xt,[e("div",Yt,[e("img",{class:"w-full h-auto object-contain",src:O.value.image,alt:O.value.name,onError:te,onLoad:se},null,40,Zt)])]),e("div",es,[(n(!0),m(F,null,ee(O.value.allergies,(f,c)=>(n(),m("img",{src:"images/"+f+".png",alt:f,class:"w-2rem h-2rem border-round flex-shrink-0",style:{"object-fit":"cover","min-width":"2rem"}},null,8,ts))),256)),e("div",ss,[e("button",{onClick:S[0]||(S[0]=f=>M(O.value)),class:"p-0 border-none bg-transparent cursor-pointer"},[e("i",{class:ue(["pi pi-thumbs-up text-xl",b.likedItemsRef.includes(O.value)?"text-green-500":"text-gray-400"])},null,2)]),e("button",{onClick:S[1]||(S[1]=f=>J(O.value)),class:"p-0 border-none bg-transparent cursor-pointer"},[e("i",{class:ue(["pi pi-thumbs-down text-xl",b.dislikedItemsRef.includes(O.value)?"text-red-500":"text-gray-400"])},null,2)])])])]),_:1},8,["visible"])],64))}},as=xe(ls,[["__scopeId","data-v-51ff8788"]]),ns={key:0,class:"text-3xl font-bold"},os={class:"flex flex-column gap-3 p-1"},is={key:0,class:"flex flex-column gap-1"},rs={key:0,class:"m-0"},us={key:0,class:"m-0"},cs={class:"flex justify-content-between gap-4 mt-1"},ds={class:"flex align-items-center gap-2"},ms=["src","alt"],fs={class:"flex-grow-1 min-width-0 max-w-18rem"},vs={class:"flex flex-column gap-1"},hs={class:"flex align-items-center gap-2"},ps={class:"text-xl font-bold line1 whitespace-nowrap overflow-hidden text-overflow-ellipsis",style:{"max-width":"20rem"}},gs={class:"flex align-items-end gap-1"},ys={key:0,class:"text-xl font-bold text-primary"},bs={key:1,class:"text-xl font-bold text-primary"},_s={key:2,class:"text-sm text-color-secondary"},xs={key:0,class:"text-xs text-primary"},ks={class:"flex-shrink-0 flex flex-wrap justify-content-between align-items-center gap-1"},ws={class:"flex flex-wrap justify-content-between align-content-center"},$s={class:"flex align-items-center gap-1"},Ds={class:"w-2rem text-center"},Is={key:1,class:"flex flex-column gap-2 mt-2"},Cs={for:"in_label"},Ts={for:"in_label"},Ns={class:"bottom-0 left-0 mt-2"},qs={class:"text-2xl font-bold"},Ss={class:"text-2xl font-bold text-primary pl-2"},As={class:"flex justify-content-between"},Ms={__name:"Cart",props:{checkout:{type:Function,required:!0},isTakeaway:Boolean},setup(q,{expose:z}){const{locale:$}=re(),L=ze(),{t:b}=re(),C=ne.cartDishs,i=w([]),V=w(),p=w(),P=w(!1),j=w(!1),W=w(!0),I=w(""),M=w("");function U(r,v,_){let G="";const T=$.value,B=x.customDishAPI.getCustomDishByName(r);for(const Y of _){const ce=B.types[v].dishes.find(de=>de.dishid===Y.id)[`name_${T}`];G=G+ce+"/"}return G}function J(r,v){const _=$.value;return x.customDishAPI.getCustomDishByName(r).types[v][`typeName_${_}`]}const X=(r,v)=>{const _=i.value[r].quantity+v;_>=0&&(i.value[r].quantity=_)};function O(r){r&&V.value&&(V.value.dishNote=p.value?p.value:void 0),j.value=!1}function ae(){p.value&&(p.value=void 0),V.value&&(V.value=void 0)}function te(r){V.value=r,p.value=V.value.dishNote?V.value.dishNote:void 0,j.value=!0}const se=q;z({showDishList:r=>{P.value=!0,i.value.length=0;for(let v=0;v<r.length;v++)i.value.push(r[v]);W.value=i.value.length==0&&C.length==0}});function le(r){ne.removeItem(r)}function u(){se.isTakeaway?S():f()}function S(){const r=[];C.value.forEach(v=>{r.push(v)}),i.value.forEach(v=>{v.quantity>0&&r.push(v)}),r.length<=0?Z.show_warn(b("notification.select_at_least_one")):(P.value=!1,L.push({path:"/paymentPage"}))}function f(){se.checkout({name:I.value,note:M.value},r=>{r.success&&(C.value.forEach(v=>{v.dishNote=void 0}),i.value.forEach(v=>{v.dishNote=void 0}),M.value="",Q.cleanDishDataQty(),Ce.deleteCookie("cartDish_normal"),ne.cleanAll(),Ce.deleteCookie("cartDish_custom"),P.value=!1)})}function c(r){return r.subname!=""&&r.subname!="Default Title"?r.name+" "+r.subname:r.name}function g(){let r=0;return C.value.forEach(v=>{r+=v.discount?(v.dis_price?v.dis_price:0)*v.count:(v.price?v.price:0)*v.count}),i.value.forEach(v=>{r+=v.discount?(v.dis_price?v.dis_price:0)*v.quantity:(v.price?v.price:0)*v.quantity}),"â‚¬"+r.toFixed(2)}const l=r=>{r.target.src="/images/default.png"},d=r=>{const v=r.quantity;let _=3;return r.price>0&&(_=9),v>=_};return(r,v)=>(n(),m(F,null,[y(t(me),{class:"bg-primary-reverse text-sm md:text-lg lg:text-xl",visible:P.value,"onUpdate:visible":v[2]||(v[2]=_=>P.value=_),modal:"",header:r.$t("common.cart"),style:Ie([{backgroundColor:"rgba(250, 250, 250, 1)",height:"100%",minWidth:"24rem"},{width:"80vw","max-width":"700px"}]),dismissableMask:!0},{footer:N(()=>[e("div",Ns,[e("span",qs,o(r.$t("common.total"))+": ",1),e("span",Ss,o(g()),1),y(t(E),{icon:q.isTakeaway?"pi pi-wallet":"pi pi-plus",class:"p-button-success p-button-rounded ml-3",onClick:u,label:q.isTakeaway?t(b)("common.pay"):t(b)("common.send")},null,8,["icon","label"])])]),default:N(()=>[W.value?(n(),m("h2",ns,"Cart is empty.")):D("",!0),e("div",os,[(n(!0),m(F,null,ee(t(C),(_,G)=>(n(),K(t(nt),{style:{overflow:"hidden"},key:G},{title:N(()=>[pe(o(r.$t(`common.${_.name}`)),1)]),subtitle:N(()=>[pe(o(r.$t("common.price"))+" : "+o(_.price)+"â‚¬",1)]),content:N(()=>[t(x).customDishAPI.customDishes.value.find(T=>T.name==_.name)?(n(),m("div",is,[(n(!0),m(F,null,ee(_.notesAndId,(T,B)=>(n(),m("div",null,[_.notesAndId[B].length!==0?(n(),m("span",rs,o(J(_.name,B))+": "+o(U(_.name,B,T)),1)):D("",!0)]))),256)),e("div",null,[_.dishNote?(n(),m("span",us,o(r.$t("common.note"))+": "+o(_.dishNote),1)):D("",!0)])])):D("",!0)]),footer:N(()=>[e("div",cs,[q.isTakeaway?D("",!0):(n(),K(t(E),{key:0,label:t(b)("common.edit")+" "+t(b)("common.note"),severity:"contrast",onClick:T=>te(_)},null,8,["label","onClick"])),y(t(E),{label:t(b)("common.remove"),severity:"danger",onClick:T=>le(_)},null,8,["label","onClick"])])]),_:2},1024))),128)),(n(!0),m(F,null,ee(i.value,(_,G)=>(n(),m("div",{key:G,class:"p-2 border-round shadow-1 transition-all transition-duration-200 hover:shadow-3 flex flex-column gap-1"},[e("div",ds,[e("img",{src:_.image,alt:_.name,class:"w-4rem h-4rem border-round flex-shrink-0",onError:l,style:{"object-fit":"cover","min-width":"4rem"}},null,40,ms),e("div",fs,[e("div",vs,[e("div",hs,[e("span",ps,o(c(_)),1)])]),e("div",gs,[_.discount?(n(),m("span",ys,"â‚¬"+o(Number(_.dis_price?_.dis_price:0).toFixed(2)),1)):D("",!0),_.discount?D("",!0):(n(),m("span",bs,"â‚¬"+o(Number(_.price?_.price:0).toFixed(2)),1)),_.price>0?(n(),m("span",_s,"/uni.")):D("",!0)])])]),e("div",null,[_.dishNote?(n(),m("span",xs,o(t(b)("common.note")+": "+_.dishNote),1)):D("",!0)]),e("div",ks,[e("div",ws,[q.isTakeaway?D("",!0):(n(),K(t(E),{key:0,label:t(b)("common.edit")+" "+t(b)("common.note"),severity:"contrast",class:"w-3.5rem h-2rem",onClick:T=>te(_)},null,8,["label","onClick"]))]),e("div",$s,[y(t(E),{icon:"pi pi-minus",rounded:"",disabled:_.quantity<=0,onClick:T=>X(G,-1),class:"w-2rem h-2rem"},null,8,["disabled","onClick"]),e("span",Ds,o(_.quantity),1),y(t(E),{icon:"pi pi-plus",rounded:"",disabled:d(_),onClick:T=>X(G,1),class:"w-2rem h-2rem"},null,8,["disabled","onClick"])])])]))),128))]),q.isTakeaway?D("",!0):(n(),m("div",Is,[y(t(Ue),{variant:"in"},{default:N(()=>[y(t(Ee),{id:"in_label",modelValue:I.value,"onUpdate:modelValue":v[0]||(v[0]=_=>I.value=_),variant:"filled",maxlength:"20"},null,8,["modelValue"]),e("label",Cs,o(t(b)("common.name")),1)]),_:1}),y(t(Ue),{variant:"in"},{default:N(()=>[y(t(He),{id:"in_label",class:"min-w-full",rows:"5",modelValue:M.value,"onUpdate:modelValue":v[1]||(v[1]=_=>M.value=_),variant:"filled",maxlength:"200"},null,8,["modelValue"]),e("label",Ts,o(t(b)("common.observation")),1)]),_:1})]))]),_:1},8,["visible","header"]),y(t(me),{visible:j.value,"onUpdate:visible":v[6]||(v[6]=_=>j.value=_),header:t(b)("common.note"),onHide:v[7]||(v[7]=_=>ae()),modal:"",dismissableMask:!0},{default:N(()=>[y(t(He),{modelValue:p.value,"onUpdate:modelValue":v[3]||(v[3]=_=>p.value=_),rows:"5",cols:"30",placeholder:t(b)("common.edit")+" "+t(b)("common.note")+"...",maxlength:"100"},null,8,["modelValue","placeholder"]),e("div",As,[y(t(E),{label:t(b)("common.cancel"),severity:"danger",onClick:v[4]||(v[4]=_=>O(!1))},null,8,["label"]),y(t(E),{label:t(b)("common.save"),severity:"primary",size:"sm",onClick:v[5]||(v[5]=_=>O(!0))},null,8,["label"])])]),_:1},8,["visible","header"])],64))}},Ls=xe(Ms,[["__scopeId","data-v-c63f1df5"]]);w([]);w("iniImages()");const Rs={class:"m-3"},Vs={class:"flex flex-column gap-2"},Ps={class:"w-full flex justify-content-center"},Es={key:0,class:"max-w-19rem"},js=["src"],Os={style:{width:"300px",height:"300px",background:"url(/boxImage/box.png)"}},Fs={key:0,class:"flex align-items-center justify-content-center text-4xl font-bold text-white w-full h-full"},Ws={key:1,class:"grid m-0 p-2"},Us=["onClick"],Hs={class:"flex align-items-center justify-content-center font-bold m-0 p-0",style:{width:"94px",height:"94px"}},Bs=["src"],zs={class:"flex flex-wrap justify-content-between align-items-center m-1"},Qs={class:"flex gap-1 align-items-center"},Gs={key:0},Ks={class:"font-bold mb-2"},Js={key:1,class:"flex justify-content-between gap-2 mt-3"},Xs={class:"font-bold mb-2"},Ys={class:"flex mr-2"},Zs={class:"w-3rem text-xl text-center"},el={class:"font-bold block mb-2"},tl={class:"flex flex-wrap"},sl={key:2,class:"flex flex-wrap gap-2 mt-3"},ll={class:"font-bold block mb-2"},al={class:"font-bold block mb-2 text-center"},nl={class:"flex flex-wrap gap-2 mt-3"},ol={__name:"CustomDish",props:{currentCustomDish:Object,tabindex:Number},emits:["typeClick"],setup(q,{emit:z}){const{locale:$}=re(),L=q,b=ot(),{t:C}=re(),i=w(null);ve(()=>L.currentCustomDish,c=>{c&&(i.value=c)},{immediate:!0,deep:!0});const V=oe(()=>i.boxImages),p=w(0),P=oe(()=>{var g;if(i.value==null)return 0;let c=(g=i.value)==null?void 0:g.initialPrice;for(const l of i.value.types??[])for(const d of l.dishes??[])d.selected&&(c+=d.price);return Number(c).toFixed(2)}),j=z,W=w(null),I=oe(()=>{const c=$.value,g=`title_${c}`,l=`description_${c}`;return i.value==null?{}:i.value.descriptions.map(d=>({title:d[g],descriptions:d.descriptions.map(r=>r[l]),image:d==null?void 0:d.image}))}),M=oe(()=>{var l,d;const c=Number(((l=i.value)==null?void 0:l.like)??0),g=Number(((d=i.value)==null?void 0:d.rate)??0);return g?c/g*5:0});function U(c,g){const l=$.value;return c[`${g}_${l}`]}function J(c,g,l){const d=c[g];if(d.selected){d.selected=!1;return}else{const v=c.filter(_=>_.selected).length;if(l===1){u(c),d.selected=!0;return}v<l&&(d.selected=!0)}}function X(c,g,l){const d=c.dishes;j("typeClick",c,g,d[g].selected),J(d,g,l)}function O(c){return c.selected}function ae(){if(!S(i.value.types))return;const c=se(i.value.types),g=ie(i.value.types);ne.addItem({dishid:-1,name:i.value.name,category:L.currentCustomDish.category,count:p.value!==0?p.value:1,price:P.value,notes:c,notesAndId:g}),console.log("CART: ",ne.cartDishs),le(i.value.types),Z.show({severity:"info",summary:"info",detail:C("customDishBibimbapVue.addToCartSuccessBibimbap")})}function te(c){return!c||!c.dishes?"":c.dishes.filter(l=>l.selected).map(l=>l.name).join(",")}function se(c){return c?c.map(g=>te(g)):[]}function ie(c){return c?c.map(g=>g.dishes?g.dishes.filter(l=>l.selected).map(l=>({id:l.dishid,name:l.name})):[]):[]}function le(c){c&&c.forEach(g=>{g.dishes&&g.dishes.forEach(l=>{l.selected=!1})})}function u(c){c.forEach(g=>g.selected=!1)}function S(c){if(i.value.options.quantity&&p.value<=0)return Z.show({severity:"warn",detail:C("notification.quantity_must_be_positive")}),!1;for(const g of c)if(g.dishes.filter(d=>d.selected).length<g.minQuantity){const d=g.typeName;return Z.show({severity:"warn",detail:C("notification.select_type_of",{name:d})}),!1}return!0}function f(c){c?x.customDishAPI.like(i.value.id)&&(W.value="like",b.add({severity:"success",summary:C("common.success"),detail:C("common.rate")+" "+C("common.success"),life:750})):x.customDishAPI.unLike(i.value.id)&&(W.value="unlike",b.add({severity:"success",summary:C("common.success"),detail:C("common.rate")+" "+C("common.success"),life:750}))}return(c,g)=>{var l,d,r,v,_,G;return n(),m("div",Rs,[e("div",Vs,[y(t(Ve),{class:"w-full max-w-xl mx-auto"},{default:N(()=>[(n(!0),m(F,null,ee(I.value,(T,B)=>(n(),K(t(Me),{key:B,value:B},{default:N(()=>[y(t(Le),null,{default:N(()=>[pe(o(T.title),1)]),_:2},1024),y(t(Re),null,{default:N(()=>{var Y;return[(n(!0),m(F,null,ee(T.descriptions,(ce,de)=>(n(),m("p",{key:de},o(ce),1))),128)),e("div",Ps,[(Y=T.image)!=null&&Y.src?(n(),m("div",Es,[e("img",{src:T.image.src,class:"w-full"},null,8,js)])):D("",!0)])]}),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1}),((d=(l=i.value)==null?void 0:l.value)==null?void 0:d.name)==="MY BOX"?(n(),K(t(Ve),{key:0,class:"w-full max-w-xl mx-auto"},{default:N(()=>[y(t(Me),{value:"0"},{default:N(()=>[y(t(Le),null,{default:N(()=>[pe(" ðŸ¥© "+o(c.$t("common.showMybox")),1)]),_:1}),y(t(Re),null,{default:N(()=>[e("div",Os,[c.isEmptyArray(V.value)?(n(),m("div",Fs,o(c.$t("common.myboxAlarm")),1)):D("",!0),c.isEmptyArray(V.value)?D("",!0):(n(),m("div",Ws,[(n(!0),m(F,null,ee(V.value,T=>(n(),m("div",{class:"col-4 p-0",onClick:B=>c.imageSelectAction(T)},[e("div",Hs,[T?(n(),m("img",{key:0,class:"m-0 p-0",src:c.imagePath(T),style:{width:"82px",height:"82px"}},null,8,Bs)):D("",!0)])],8,Us))),256))]))])]),_:1})]),_:1})]),_:1})):D("",!0)]),e("div",zs,[e("div",Qs,[(n(),m(F,null,ee(5,T=>e("i",{key:T,class:ue(["pi invert-star",T<=Math.floor(M.value)?"pi-star-fill":T-.5<=M.value?"pi-star-half":"pi-star"]),style:{color:"black"}},null,2)),64)),e("p",null,"("+o((r=i.value)!=null&&r.rate?i.value.rate:0)+")",1)]),e("div",null,[y(t(E),{text:"",icon:"pi pi-thumbs-up",severity:W.value==="like"?"success":"",onClick:g[0]||(g[0]=T=>f(!0))},null,8,["severity"]),y(t(E),{text:"",icon:"pi pi-thumbs-down",severity:W.value==="unlike"?"danger":"",onClick:g[1]||(g[1]=T=>f(!1))},null,8,["severity"])])]),(v=i.value)!=null&&v.options.extraInfo?(n(),m("div",Gs,[e("label",Ks,o(i.value.options.extraInfo),1)])):D("",!0),(_=i.value)!=null&&_.options.quantity?(n(),m("div",Js,[e("div",null,[e("label",Xs,o(c.$t("common.quantity"))+" / "+o(c.$t("common.pieces")),1)]),e("div",Ys,[y(t(E),{icon:"pi pi-minus",disabled:p.value<=0,onClick:g[2]||(g[2]=T=>{var B;return p.value-=(B=i.value)==null?void 0:B.options.quantitySetp}),class:"w-2rem h-2rem"},null,8,["disabled"]),e("span",Zs,o(p.value),1),y(t(E),{icon:"pi pi-plus",disabled:p.value>=i.value.options.maxQuantity,onClick:g[3]||(g[3]=T=>{var B;return p.value+=(B=i.value)==null?void 0:B.options.quantitySetp}),class:"w-2rem h-2rem"},null,8,["disabled"])])])):D("",!0),(n(!0),m(F,null,ee((G=i.value)==null?void 0:G.types,(T,B)=>(n(),m("div",{key:T.id},[et(e("div",null,[e("label",el,o(B+1)+". "+o(U(T,"typeName")),1),e("div",tl,[(n(!0),m(F,null,ee(T.dishes,(Y,ce)=>(n(),K(t(E),{key:ce,onClick:de=>X(T,ce,p.value==0?T.maxQuantity:T.maxQuantity*p.value),class:ue([{"p-button-primary":O(Y),"p-button-outlined":!O(Y)},"m-1"])},{default:N(()=>[e("p",{class:ue({"text-gray-700":!O(Y)})},o(U(Y,"name")),3)]),_:2},1032,["onClick","class"]))),128))])],512),[[tt,T.enable]])]))),128)),q.currentCustomDish.initialPrice!==0?(n(),m("div",sl,[e("label",ll,o(c.$t("common.price"))+":",1),e("label",al,o(P.value+"â‚¬"),1)])):D("",!0),e("div",nl,[y(t(E),{icon:"pi pi-shopping-cart",onClick:g[4]||(g[4]=T=>ae()),label:c.$t("common.addToCart"),class:"m-3",severity:"primary",raised:""},null,8,["label"])])])}}},il=xe(ol,[["__scopeId","data-v-e97559ab"]]),rl={class:"flex flex-column gap-3"},ul={class:"flex flex-column gap-2"},cl={for:"email"},dl={class:"flex flex-column gap-2"},ml={for:"password"},fl={key:0,class:"text-red-500 text-sm"},vl={class:"flex justify-content-end gap-2"},hl={__name:"LoginDialog",props:{visible:{type:Boolean,default:!1}},emits:["update:visible","login-success"],setup(q,{emit:z}){const{t:$}=re(),L=q,b=z,C=w(""),i=w(""),V=w(!1),p=w("");ve(()=>L.visible,I=>{I&&P()});function P(){C.value="",i.value="",p.value="",V.value=!1}function j(){b("update:visible",!1),P()}async function W(){if(!C.value||!i.value){p.value=$("common.auth.emailPasswordRequired");return}V.value=!0,p.value="";try{const I=await x.login(C.value,i.value);I.success?(b("login-success"),b("update:visible",!1)):p.value=I.error||$("common.auth.loginFailed")}catch(I){p.value=$("common.auth.loginFailed"),console.error("Login error:",I)}finally{V.value=!1}}return(I,M)=>(n(),K(t(me),{visible:q.visible,"onUpdate:visible":M[2]||(M[2]=U=>I.$emit("update:visible",U)),header:I.$t("common.auth.login"),modal:!0,dismissableMask:!0,style:{width:"90vw",maxWidth:"25rem"},onHide:P},{footer:N(()=>[e("div",vl,[y(t(E),{label:I.$t("common.cancel"),severity:"secondary",onClick:j,disabled:V.value},null,8,["label","disabled"]),y(t(E),{label:I.$t("common.auth.login"),onClick:W,loading:V.value},null,8,["label","loading"])])]),default:N(()=>[e("div",rl,[e("div",ul,[e("label",cl,o(I.$t("common.auth.email")),1),y(t(Ee),{id:"email",modelValue:C.value,"onUpdate:modelValue":M[0]||(M[0]=U=>C.value=U),type:"email",placeholder:I.$t("common.auth.emailPlaceholder"),class:"w-full",disabled:V.value},null,8,["modelValue","placeholder","disabled"])]),e("div",dl,[e("label",ml,o(I.$t("common.auth.password")),1),y(t(it),{id:"password",modelValue:i.value,"onUpdate:modelValue":M[1]||(M[1]=U=>i.value=U),placeholder:I.$t("common.auth.passwordPlaceholder"),feedback:!1,toggleMask:"",class:"w-full",disabled:V.value,onKeyup:st(W,["enter"]),fluid:""},null,8,["modelValue","placeholder","disabled"])]),p.value?(n(),m("div",fl,o(p.value),1)):D("",!0)])]),_:1},8,["visible","header"]))}},pl={key:0,class:"flex flex-column gap-4"},gl={class:"flex justify-content-center"},yl={class:"flex flex-column gap-3"},bl={class:"flex flex-column gap-1"},_l={class:"text-sm text-color-secondary"},xl={class:"text-lg font-semibold"},kl={class:"flex flex-column gap-1"},wl={class:"text-sm text-color-secondary"},$l={class:"text-lg"},Dl={class:"flex flex-column gap-1"},Il={class:"text-sm text-color-secondary"},Cl={class:"text-lg"},Tl={key:0,class:"flex flex-column gap-1"},Nl={class:"text-sm text-color-secondary"},ql={class:"text-sm text-color-secondary"},Sl={__name:"UserInfoDialog",props:{visible:{type:Boolean,default:!1},user:{type:Object,default:null}},emits:["update:visible"],setup(q,{emit:z}){const{t:$}=re(),L=q,b=z,C=w(!1),i=oe(()=>{var P;if(!((P=L.user)!=null&&P.avatar_url))return null;const p=L.user.avatar_url;return p&&(p.startsWith("http://")||p.startsWith("https://")||p.startsWith("/"))?p:null});ve(()=>L.user,p=>{if(C.value=!1,p!=null&&p.avatar_url&&i.value){const P=new Image;P.onload=()=>{C.value=!1},P.onerror=()=>{C.value=!0,console.warn("Avatar image failed to load:",p.avatar_url)},P.src=i.value}},{immediate:!0});function V(){b("update:visible",!1)}return(p,P)=>(n(),K(t(me),{visible:q.visible,"onUpdate:visible":P[0]||(P[0]=j=>p.$emit("update:visible",j)),header:p.$t("common.auth.userInfo"),modal:!0,dismissableMask:!0,style:{width:"90vw",maxWidth:"30rem"}},{footer:N(()=>[y(t(E),{label:p.$t("common.cancel"),severity:"secondary",onClick:V},null,8,["label"])]),default:N(()=>[q.user?(n(),m("div",pl,[e("div",gl,[y(t(Pe),{image:i.value&&!C.value?i.value:void 0,shape:"circle",size:"xlarge",class:"mb-3"},null,8,["image"])]),e("div",yl,[e("div",bl,[e("label",_l,o(p.$t("common.auth.displayName")),1),e("div",xl,o(q.user.display_name||"-"),1)]),e("div",kl,[e("label",wl,o(p.$t("common.auth.email")),1),e("div",$l,o(q.user.email||"-"),1)]),e("div",Dl,[e("label",Il,o(p.$t("common.auth.role")),1),e("div",Cl,o(q.user.role||"-"),1)]),q.user.id?(n(),m("div",Tl,[e("label",Nl,o(p.$t("common.auth.userId")),1),e("div",ql,o(q.user.id),1)])):D("",!0)])])):D("",!0)]),_:1},8,["visible","header"]))}},Al={class:"fixed top-0 left-0 w-full bg-primary-reverse",style:{"z-index":"10"}},Ml={class:"grid mt-1 ml-1"},Ll={class:"h-3rem w-3rem flex align-items-center"},Rl=["src"],Vl={class:"flex align-items-center"},Pl={key:0,class:"text-color font-bold p-1"},El={key:1,class:"text-color font-bold p-1"},jl={class:"card flex mr-3 flex align-items-center gap-2",style:{"margin-left":"auto"}},Ol={key:0},Fl={key:1},Wl={style:{display:"flex","align-items":"center"}},Ul={style:{"flex-grow":"1",width:"0",overflow:"hidden"}},Hl={class:"mt-2"},Bl={class:"flex justify-content-end mt-2"},zl={class:"flex inline-flex items-center justify-center gap-2"},Ql={class:"flex align-items-center"},Gl={class:"flex flex-column"},Kl={class:"text-sm p-2"},Jl={class:"text-sm p-2"},Xl={class:"flex items-center gap-4 mb-4 p-2"},Yl={class:"flex flex-column gap-3"},Zl={__name:"HeaderTabs",props:{types:Array,typeIndex:Number,tableId:String,tabItems:Array},emits:["clickType","switchToWelcome"],setup(q,{emit:z}){const{t:$}=re(),L=w(!1),b=w(!1),C=w(!1),i=w(""),V=w(),p=w(!1),P=oe(()=>x.isAuthenticated()),j=oe(()=>x.authUser.value),W=oe(()=>{var d;if(!((d=j.value)!=null&&d.avatar_url))return null;const l=j.value.avatar_url;return l&&(l.startsWith("http://")||l.startsWith("https://")||l.startsWith("/"))?l:null});ve(j,l=>{if(p.value=!1,l!=null&&l.avatar_url&&W.value){const d=new Image;d.onload=()=>{p.value=!1},d.onerror=()=>{p.value=!0,console.warn("Avatar image failed to load:",l.avatar_url)},d.src=W.value}},{immediate:!0});function I(){return x.getTable()}_e(async()=>{i.value=await vt()});const M=w(),U=oe(()=>[{label:$("common.options"),items:[{label:$("common.pay"),icon:"pi pi-wallet",command:()=>{ie()}},{label:$("common.call"),icon:"pi pi-user-plus",command:()=>{x.send_cmd(I(),{cmd:"call"},l=>{l.success?Z.show_info($("notification.call_msg")):Z.show_warn(l.data)})}}]}]),J=l=>{M.value.toggle(l)},X=l=>{O.value.toggle(l)},O=w(),ae=w(!1),te=w(),se=w();function ie(){ae.value=!0}function le(){l(te.value)?x.send_cmd(I(),{cmd:"pay",nif:te.value,note:se.value},d=>{d.success?(Z.show_info($("notification.pay_msg")),ae.value=!1):Z.show_error($("common.failed"))}):Z.show_warn($("notification.cancel_msg"));function l(d){return!d||d.toString().length===9||d.toString().length===0}}function u(){se.value&&(se.value=void 0)}function S(){L.value=!0}const f=oe(()=>[{label:$("common.auth.userInfo"),icon:"pi pi-user",command:()=>{C.value=!0}},{separator:!0},{label:$("common.auth.logout"),icon:"pi pi-sign-out",command:()=>{x.logout(),Z.show_info($("common.auth.logoutSuccess"))}}]);function c(l){V.value.toggle(l)}function g(){var l;b.value=!1,Z.show_info($("common.auth.loginSuccess")),console.log("Login success, user:",x.authUser.value),console.log("Avatar URL:",(l=x.authUser.value)==null?void 0:l.avatar_url)}return(l,d)=>(n(),m(F,null,[e("div",Al,[e("div",Ml,[e("div",Ll,[e("img",{src:i.value,class:"h-full w-full",onClick:d[0]||(d[0]=()=>l.$emit("switchToWelcome"))},null,8,Rl)]),e("div",Vl,[q.tableId?(n(),m("p",Pl,o(l.$t("common.table"))+": "+o(q.tableId),1)):D("",!0),q.tableId?D("",!0):(n(),m("p",El,o(l.$t("common.takeAway")),1))]),e("div",jl,[P.value?j.value?(n(),m("div",Fl,[y(t(Pe),{image:W.value,shape:"circle",size:"large",onClick:c,style:{cursor:"pointer"}},null,8,["image"]),y(t(Se),{ref_key:"userMenu",ref:V,id:"user_menu",model:f.value,popup:!0},null,8,["model"])])):D("",!0):(n(),m("div",Ol,[y(t(E),{label:t($)("common.auth.login"),icon:"pi pi-sign-in",onClick:d[1]||(d[1]=r=>b.value=!0)},null,8,["label"])])),q.tableId?(n(),K(t(E),{key:2,icon:"pi pi-bell",rounded:"","aria-label":"Filter",onClick:J,"aria-haspopup":"true","aria-controls":"overlay_menu"})):(n(),K(t(E),{key:3,icon:"pi pi-question",rounded:"",onClick:S})),y(t(Se),{ref_key:"menu",ref:M,id:"overlay_menu",model:U.value,popup:!0},null,8,["model"])])]),e("div",Wl,[e("div",null,[y(t(E),{icon:"pi pi-bars",variant:"text",rounded:"","aria-label":"Filter",onClick:X,"aria-haspopup":"true","aria-controls":"tab_menu"}),y(t(Se),{ref_key:"tabMenu",ref:O,id:"tab_menu",model:q.tabItems,popup:!0},null,8,["model"])]),e("div",Ul,[y(t(ct),{value:q.typeIndex,scrollable:"",showNavigators:!1},{default:N(()=>[y(t(rt),null,{default:N(()=>[(n(!0),m(F,null,ee(q.types,(r,v)=>(n(),K(t(ut),{value:v,onClick:()=>l.$emit("clickType",v),class:"text-sm md:text-lg lg:text-xl"},{default:N(()=>[pe(o(r),1)]),_:2},1032,["value","onClick"]))),256))]),_:1})]),_:1},8,["value"])])])]),y(t(me),{visible:ae.value,"onUpdate:visible":d[5]||(d[5]=r=>ae.value=r),header:"ç»“è´¦",class:"flex flex-column",modal:!0,dismissableMask:!0,onHide:u},{default:N(()=>[e("div",null,[d[9]||(d[9]=e("label",null,"NIF:",-1)),y(t(dt),{modelValue:te.value,"onUpdate:modelValue":d[2]||(d[2]=r=>te.value=r),inputId:"withoutgrouping",useGrouping:!1,fluid:"",class:"w-full m-1"},null,8,["modelValue"])]),e("div",Hl,[e("label",null,o(l.$t("common.note"))+":",1),y(t(Ee),{type:"text",modelValue:se.value,"onUpdate:modelValue":d[3]||(d[3]=r=>se.value=r),class:"w-full m-1"},null,8,["modelValue"])]),e("div",Bl,[y(t(E),{label:t($)("common.send"),onClick:d[4]||(d[4]=r=>le())},null,8,["label"])])]),_:1},8,["visible"]),y(t(me),{visible:L.value,"onUpdate:visible":d[6]||(d[6]=r=>L.value=r),modal:"",dismissableMask:"",class:"h-full",style:{width:"90vw",maxWidth:"40rem",minWidth:"20rem"},draggable:!1},{header:N(()=>[e("div",zl,[y(t(Pe),{icon:"pi pi-question",shape:"circle"}),e("span",Ql,o(t($)("takeawayHelper.dialogTitle")),1)])]),default:N(()=>[e("div",Gl,[e("span",Kl,o(t($)("takeawayHelper.introduction")),1),e("span",Jl,o(t($)("takeawayHelper.note_t"))+" "+o(t($)("takeawayHelper.note_1")),1),e("div",Xl,[y(t(Ve),{class:"w-full max-w-xl mx-auto"},{default:N(()=>[y(t(Me),{value:"0"},{default:N(()=>[y(t(Le),{class:"text-sm"},{default:N(()=>[pe(o(t($)("takeawayHelper.question_1")),1)]),_:1}),y(t(Re),{class:"p-1"},{default:N(()=>[e("div",Yl,[e("span",null,o(t($)("takeawayHelper.q_1_request_1")),1),e("span",null,o(t($)("takeawayHelper.q_1_request_2")),1),e("span",null,o(t($)("takeawayHelper.q_1_request_3")),1),e("span",null,o(t($)("takeawayHelper.q_1_request_4")),1),e("span",null,o(t($)("takeawayHelper.q_1_request_5")),1)])]),_:1})]),_:1})]),_:1})])])]),_:1},8,["visible"]),y(hl,{visible:b.value,"onUpdate:visible":d[7]||(d[7]=r=>b.value=r),onLoginSuccess:g},null,8,["visible"]),y(Sl,{visible:C.value,"onUpdate:visible":d[8]||(d[8]=r=>C.value=r),user:j.value},null,8,["visible","user"])],64))}},ea={__name:"SwipeHint",props:{size:{type:String,default:"8rem"},duration:{type:Number,default:6e3},position:{type:String,default:"bottom"}},setup(q){const z=q,$=w(!0);_e(()=>{z.duration>0&&setTimeout(()=>{$.value=!1},z.duration);const b=()=>{$.value=!1,window.removeEventListener("touchstart",b)};window.addEventListener("touchstart",b)});const L=oe(()=>{let b={left:"50%",transform:"translateX(-50%)",zIndex:99999,opacity:.5,pointerEvents:"none",textAlign:"center",position:"fixed"};return z.position==="top"?b.top="15%":z.position==="center"?(b.top="50%",b.transform="translate(-50%, -50%)"):b.bottom="15%",b});return(b,C)=>$.value?(n(),m("div",{key:0,class:"swipe-hint",style:Ie(L.value)},[e("div",{class:"hand",style:Ie({width:q.size,height:q.size,backgroundImages:"url(/images/hand_finger.png)"})},null,4)],4)):D("",!0)}},ta=xe(ea,[["__scopeId","data-v-30a48de8"]]),sa={class:"w-full h-full flex flex-column p-1"},la={class:"swiper-container-wrapper"},aa={class:"fixed bottom-0 left-0 w-full h-3rem bg-primary-reverse p-3 z-[9999]"},na={class:"h-full flex align-items-center justify-content-between w-full"},oa={class:"m-2"},ia={class:"m-2"},ra={class:"m-2"},ua={style:{"max-height":"60vh","overflow-y":"auto","padding-bottom":"60px"}},ca={class:"flex flex-column border-bottom-1"},da={key:0,class:"flex justify-content-between"},ma={class:"flex flex-column"},fa={class:"font-bold"},va={class:"text-right"},ha={key:1,class:"flex justify-content-between"},pa={class:"flex flex-column"},ga={class:"font-bold"},ya={class:"text-right"},ba={key:0},_a={key:1,class:"flex flex-column"},xa={class:"flex flex-column"},ka={class:"font-bold"},wa={class:"text-right"},$a={class:"total-footer bg-primary-reverse"},Da={__name:"HomePage",setup(q){const z=ze(),$=at(),{t:L}=re(),{locale:b}=re(),C=w(0),i=w(!1),V=w([""]),p=w(0),P=ne.cartItemCount,j=w(!1),W=w([]),I=w(0),M=w({}),U=w(!1),J=Q.dishDatas,X=w(x.getOrderMenuTab()),O=w(null),ae=w(null),te=w([]),se=w([]),ie=w([]),le=w(!1);let u=null;const S=s=>{p.value=s.activeIndex,Te()},f=s=>{u=s};ve(p,s=>{u&&u.activeIndex!==s&&u.slideTo(s);let a=x.getOrderMenuTab()[s];x.customDishAPI.customDishes.value.map(k=>k.name).includes(a)?(U.value=!0,M.value=x.customDishAPI.customDishes.value.find(k=>k.name==a)):U.value=!1});const c=(s,a,h,k)=>{x.rateDish(s,a,h),k&&Z.show_success(L("notification.rating_submitted"))},g=(s,a,h)=>{if(M.value.name=="XIAOXIONGÂ® RAMEN"&&s.id===1){const k=s.dishes[a];let A;k.dishid==47?h?A=l(3,!0,1):A=l(3,!1,1):A=l(3,!0,1),A!==void 0&&d(A)}if(M.value.name=="Menu AlmoÃ§o"&&s.id===3){const k=s.dishes[a];let A;[1427,41].includes(k.dishid)?h?A=l(4,!0,0):A=l(4,!1,0):A=l(4,!0,0),A!==void 0&&d(A)}};function l(s,a,h){if(M.value={...M.value,types:M.value.types.map(k=>k.id===s?{...k,enable:a,minQuantity:a?h:0}:k)},a===!1)return s}function d(s){!M.value||!Array.isArray(M.value.types)||(M.value={...M.value,types:M.value.types.map(a=>a.id===s?{...a,dishes:a.dishes.map(h=>({...h,selected:!1}))}:a)})}function r(s){let a=x.getOrderMenuTab()[s];if(x.customDishAPI.customDishes.value.map(R=>R.name).includes(a)?(U.value=!0,M.value=x.customDishAPI.customDishes.value.find(R=>R.name==a)):U.value=!1,x.getMenu().length==0){console.log("exit");return}let A=J.value[s].mainDishes;Q.showDishList(A)}const v=()=>{x.refreshTableFromServer(),x.getTableTotalAmount(I),j.value=!0},_=s=>{let a=s.id;s.org_id&&(a=s.org_id);for(let h=0;h<J.value.length;h++)if(J.value[h].id==a)for(const k in s){let A=k;k.startsWith("note")&&(A=A.replace("note","description")),J.value[h][A]=s[k]}};function G(){return new Promise(s=>{let a=()=>{const h=x.formatedMenu.value;h.length>0?s(h):setTimeout(a,200)};a()})}function T(){return new Promise(s=>{let a=()=>{const h=x.getOrderMenuTab();h.length>0?s(h):setTimeout(a,200)};a()})}const B=oe(()=>s=>{const a=x.dictinaryAPI.dictinary.value.find(h=>h.refName===s);return a?a[`text_${b.value.toLowerCase()}`]:s});ve([()=>x.formatedMenu.value,()=>b.value],([s,a])=>{if(!s||s.length===0){ie.value=[];return}const h={};x.orderMenuTab.value;const k=s.map(ge=>({...ge,mainDishes:ge.dishes.map(ye=>{const H=ye.dish;if(h[H.id])return h[H.id];const he={...H,defaultName:H.name,defaultSubname:H.subname,name:Y(H,"name",a),note:Y(H,"note",a),subname:Y(H,"subname",a),quantity:0},fe=ye.subItems.map(Fe=>{const $e=Fe;return{...Fe,defaultName:H.name,defaultSubname:$e.subname,name:Y($e,"name",a),note:Y($e,"note",a),subname:Y($e,"subname",a),quantity:0}}),be={...ye,dish:he,subItems:fe};return h[be.id]=be,be})}));J.value.length;const A=Q.getAllIncrementedDish();Q.getIdsAndQuantity(A);const R=ne.cartDishs.value;Ae.compressToEncodedURIComponent(JSON.stringify(R)),ie.value=k,J.value=ie.value,V.value=x.orderMenuTab.value,(A.length>0||R.length>0)&&(Q.cleanDishDataQty(),Q.updateDishDataQty(A)),x.filterMenuTabs(le.value),console.log("languagedMenu updated via watch:",ie.value),We(()=>{C.value++,u&&typeof u.updateDictionaryWord=="function"&&(u.updateDictionaryWord(),u.slideTo(p.value))})},{immediate:!0,deep:!0}),ve(()=>x.orderMenuTab.value,s=>{X.value=s.map(a=>{const h=x.dictinaryAPI.dictinary.value.find(k=>k.refName===a);return h?h[`text_${b.value.toLowerCase()}`]:a}),W.value=de(s),p.value=0}),_e(()=>{const s=x.orderMenuTab.value;X.value=s.map(a=>{const h=x.dictinaryAPI.dictinary.value.find(k=>k.refName===a);return h?h[`text_${b.value.toLowerCase()}`]:a}),W.value=de(s),p.value=0});function Y(s,a,h){return s?h==="en"?s[`${a}_en`]||s[a]:h==="zh"&&s[`${a}_cn`]||s[a]:""}async function ce(){await G();const s=await T();x.onMenuItemChanged=_,Xe(),W.value=de(s)}function de(s){const a=[];for(let h=0;h<s.length;h++){const k=h;a.push({label:B.value(s[h]),command:()=>{je(k),Te()}})}return a}const Te=()=>{We(()=>{const s=document.querySelector(".p-tablist-viewport"),a=document.querySelector(".p-tab.p-tab-active");if(s&&a){const h=a.offsetLeft-s.offsetWidth/2+a.offsetWidth/2;s.scrollTo({left:h,behavior:"smooth"})}window.scrollTo({top:0,behavior:"smooth"})})},je=s=>{r(s),p.value=s,Te()},Qe=()=>{var s=Q.getAllIncrementedDish();ae.value.showDishList(s)};function Ne(){return x.getTable()}x.params.port,O.value=x.table.value.order;const Ge=(s,a)=>{const h=localStorage.getItem("lastOrderTime"),k=x.getShopInfo("orderCoolingTime")||0;if(h&&k>0){const he=(Date.now()-parseInt(h))/1e3;if(he<k){const fe=Math.ceil(k-he);return Z.show_warn(L("notification.too_fast",{remainTime:fe})),!1}}const A=[];for(let H=0;H<ne.cartDishs.value.length;H++){var R=ne.cartDishs.value[H];const he=x.formateCustomDishNotes(R),fe=R.dis_count?R.dis_price:R.price;A.push({dishid:R.dishid,name:R.name,quantity:R.count,notes:he,limit:R.limit,price:fe,dishNote:R.dishNote,category:R.category})}const ge=Q.getAllIncrementedDish();for(let H=0;H<ge.length;H++){var R=ge[H];if(R.quantity>0){const fe=R.dis_count?R.dis_price:R.price,be=x.getDishNameDefaultName(R);A.push({dishid:R.id,name:be,quantity:R.quantity,limit:R.limit,price:fe,dishNote:R.dishNote})}}if(A.length===0)return Z.show_warn(L("notification.select_at_least_one")),!1;console.log("cart item:",A);const ye=Date.now().toString(36)+Math.random().toString(36).substring(2,5);return i.value=!0,x.submit_order({uniCode:ye,name:s.name,note:s.note,table:Ne(),items:A},H=>{a(H)}),!0};function Ke(){const s=Ce.getCookie("language");s&&(b.value=s)}function Oe(){for(let s=0;s<J.value.length;s++){const a=J.value[s];a.quantity=0}i.value=!1,ne.cleanAll()}_e(async()=>{Ke(),await ce(),r(p.value),x.clear_order_data=()=>{Oe()},x.setOnOrderConfirmed(s=>{localStorage.setItem("lastOrderTime",Date.now()),Oe();const a=s;Z.show_success(L("notification.order_submitted",{id:a}))}),x.setOnShowError(s=>{i.value=!1;let a=s;if(typeof s=="string"&&s.startsWith("COOLING_LIMIT:")){const h=s.split(":");h.length===3&&(a=L("notification.order_cooling_wait",{coolingTime:h[1],remaining:h[2]}))}Z.show_error(L("notification.order_failed")+": "+a)})});function Je(){Ce.deleteCookie("login_time");const s=$.query.table;s?z.push({path:"/",query:{table:s}}):z.push({path:"/takeReserve"})}async function ke(s,a=!0){const h=a?ne.cartDishs.value:Q.getIdsAndQuantity(Q.getAllIncrementedDish()),k=Ae.compressToEncodedURIComponent(JSON.stringify(h));try{await Be.setItem(s,k)}catch(A){console.error("ä¿å­˜åˆ° localForage å¤±è´¥:",A)}}function qe(){x.isTakeaway()?(ke("take_cartDish_normal",!1),ke("take_cartDish_custom",!0)):(ke("cartDish_normal",!1),ke("cartDish_custom",!0))}async function we(s,a=!0){try{const h=await Be.getItem(s);if(!h)return;const k=JSON.parse(Ae.decompressFromEncodedURIComponent(h));k&&k!=="undefined"&&(a?ne.cartDishs.value=k:Q.updateDishDataQty(k))}catch(h){console.error("ä»Ž localForage è¯»å–å¤±è´¥æˆ–è§£æžå¤±è´¥:",h)}}function Xe(){x.isTakeaway()?(we("take_cartDish_normal",!1),we("take_cartDish_custom")):(we("cartDish_normal",!1),we("cartDish_custom"))}return lt(()=>{qe()}),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&qe()}),window.addEventListener("beforeunload",s=>{qe(),x.cleanup()}),(s,a)=>(n(),m(F,null,[e("div",sa,[(n(),K(Zl,{key:C.value,types:X.value,typeIndex:p.value,tabItems:W.value,tableId:Ne(),onClickType:je,onSwitchToWelcome:Je},null,8,["types","typeIndex","tabItems","tableId"])),a[4]||(a[4]=e("div",{class:"pb-8"},null,-1)),a[5]||(a[5]=e("div",{class:"pb-4 sm:pb-5 md:pb-5 lg:pb-5"},null,-1)),y(ta,{duration:3e3,position:"center",size:"3rem"}),e("div",la,[(n(),K(t(ht),{key:`swiper-${X.value.length}-${C.value}`,"space-between":20,"centered-slides":"","grab-cursor":!0,class:"w-full",autoHeight:!0,onSlideChange:S,onSwiper:f,"initial-slide":p.value},{default:N(()=>[(n(!0),m(F,null,ee(X.value,(h,k)=>(n(),K(t(pt),{key:k},{default:N(()=>[Math.abs(p.value-k)<=1&&(!U.value||p.value!==k)?(n(),K(as,{key:0,rateDish:c,likedItemsRef:te.value,dislikedItemsRef:se.value,tabIndex:k,onlyVeg:le.value},null,8,["likedItemsRef","dislikedItemsRef","tabIndex","onlyVeg"])):Math.abs(p.value-k)<=1&&U.value&&p.value===k?(n(),K(il,{key:1,currentCustomDish:M.value,onTypeClick:g,tabindex:k},null,8,["currentCustomDish","tabindex"])):D("",!0)]),_:2},1024))),128))]),_:1},8,["initial-slide"]))]),a[6]||(a[6]=e("div",{style:{height:"60px"}},null,-1)),e("div",aa,[e("div",na,[e("div",oa,[t(x).isTakeaway()?D("",!0):(n(),K(t(E),{key:0,label:s.$t("common.orders"),icon:"pi pi-list",class:"p-button-secondary",onClick:v},null,8,["label"]))]),e("div",ia,[y(t(mt),{class:"text-sm",modelValue:le.value,"onUpdate:modelValue":a[0]||(a[0]=h=>le.value=h),onLabel:t(L)("common.showAll"),offLabel:t(L)("common.showOnlyVegetables"),onClick:a[1]||(a[1]=h=>t(x).filterMenuTabs(le.value))},null,8,["modelValue","onLabel","offLabel"])]),e("div",ra,[y(t(ft),{value:t(P),severity:"danger",onClick:Qe},{default:N(()=>a[3]||(a[3]=[e("i",{class:"pi pi-shopping-cart",style:{"font-size":"2rem"}},null,-1)])),_:1,__:[3]},8,["value"])])])])]),y(Ls,{ref_key:"cartRef",ref:ae,checkout:Ge,isTakeaway:!Ne()},null,8,["isTakeaway"]),y(t(me),{visible:j.value,"onUpdate:visible":a[2]||(a[2]=h=>j.value=h),header:s.$t("common.completedOrders"),modal:"",style:{width:"80vw","max-width":"700px"}},{default:N(()=>{var h,k;return[e("div",ua,[e("div",ca,[(h=I.value.adultPrice)!=null&&h.quantity&&I.value.adultPrice.quantity!=0?(n(),m("div",da,[e("div",ma,[e("span",fa,o(s.$t("common.adult")),1),e("small",null,o(s.$t("common.quantity"))+": "+o(I.value.adultPrice.quantity),1)]),e("div",va,[e("span",null,"â‚¬"+o((Number(I.value.adultPrice.price)*I.value.adultPrice.quantity).toFixed(2)),1)])])):D("",!0),(k=I.value.childrenPrice)!=null&&k.quantity&&I.value.childrenPrice.quantity!=0?(n(),m("div",ha,[e("div",pa,[e("span",ga,o(s.$t("common.children")),1),e("small",null,o(s.$t("common.quantity"))+": "+o(I.value.childrenPrice.quantity),1)]),e("div",ya,[e("span",null,"â‚¬"+o((Number(I.value.childrenPrice.price)*I.value.childrenPrice.quantity).toFixed(2)),1)])])):D("",!0)]),t(x).table.value.order.length===0?(n(),m("div",ba,o(s.$t("common.noOrders")),1)):(n(),m("div",_a,[(n(!0),m(F,null,ee(t(x).table.value.order,(A,R)=>(n(),m("div",{key:R,class:"flex justify-content-between border-bottom-1 pb-2"},[e("div",xa,[e("span",ka,o(t(x).getDishName(A)),1),e("small",null,o(s.$t("common.quantity"))+": "+o(A.quantity),1)]),e("div",wa,[e("span",null,"â‚¬"+o((A.price*A.quantity).toFixed(2)),1)])]))),128))]))]),e("div",$a,o(s.$t("common.total"))+": â‚¬"+o(I.value.total),1)]}),_:1},8,["visible","header"])],64))}},Ma=xe(Da,[["__scopeId","data-v-e8c507e0"]]);export{Ma as default};
