import{s as y}from"./index-4J5uDsgn.js";import{s as C}from"./index-ByQOO0kz.js";import{b as M}from"./index-DBEuPXgb.js";import{s as w}from"./index-DlCpv07f.js";import{q as F,u as V,a4 as B,h as m,c as T,a as s,d as t,w as j,l as f,F as E,n as N,j as P,o as D,t as I}from"./index-CR4ehUtA.js";import"./index-BpRYCbz2.js";import"./index-DiaEDWn4.js";import"./index-D_OJDOUw.js";import"./index-BiWO65Yw.js";import"./index-DJ6jMz4y.js";const q={class:"flex flex-column justify-between items-center flex-1 gap-4"},R={class:"flex gap-3 align-items-center"},A={class:"m-2"},G={class:"mr-2"},oe={__name:"UpdateMenu",setup(H){const{t:d}=F();P();const v=V(),_=B(),h=m(0),p=m([]),n=m(!1);let g;g="/upload";const k=()=>{let e="";for(const o of p.value)e+='"'+o.name+'",';N.refreshMenuSignal(),console.log("update_all:",n.value),v.add({severity:"info",summary:d("common.success"),detail:d("optionPages.menuUpload")+e.substring(0,e.length-1),life:5e3})},x=e=>{console.log("执行callback()函数，触发实际的文件上传"),e()},S=e=>{p.value=e.files,p.value.forEach(o=>{h.value+=parseInt($(o.size))})},$=e=>{const i=_.config.locale.fileSizeTypes;if(e===0)return`0 ${i[0]}`;const r=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/Math.pow(1024,r)).toFixed(3))} ${i[r]}`},b=e=>{console.log("上传前的文件",e.files),e.formData.append("update_all",n.value)};return(e,o)=>{const a=M,i=C,r=y;return D(),T(E,null,[s("div",null,[t(f(w),{url:f(g),onUpload:o[1]||(o[1]=l=>k()),multiple:!0,accept:".xlsx,.xls,.csv,.json",maxFileSize:1e6,onSelect:S,onBeforeUpload:o[2]||(o[2]=l=>b(l))},{header:j(({chooseCallback:l,uploadCallback:z,clearCallback:U,files:c})=>[s("div",q,[s("div",R,[t(a,{onClick:u=>l(),icon:"pi pi-file-arrow-up",rounded:"",outlined:"",severity:"secondary"},null,8,["onClick"]),t(a,{onClick:u=>x(z),icon:"pi pi-cloud-upload",rounded:"",outlined:"",severity:"success",disabled:!c||c.length===0},null,8,["onClick","disabled"]),t(a,{onClick:u=>U(),icon:"pi pi-times",rounded:"",outlined:"",severity:"danger",disabled:!c||c.length===0},null,8,["onClick","disabled"])])]),s("div",A,[s("label",G,I(f(d)("optionPages.changeMenu")),1),t(i,{modelValue:n.value,"onUpdate:modelValue":o[0]||(o[0]=u=>n.value=u)},null,8,["modelValue"])])]),_:1},8,["url"])]),t(r)],64)}}};export{oe as default};
