import{s as V}from"./index-DgAu5FlL.js";import{s as z}from"./index-B_Rza8S-.js";import{b as C}from"./index-DMrXkPVb.js";import{s as M}from"./index-Bmj0Fv3I.js";import{q as F,u as B,a4 as T,h as c,c as j,a as t,d as l,w as D,l as v,F as E,n as N,j as P,o as I,t as q}from"./index-Dy1WZXMP.js";import"./index-3_96Xgi8.js";import"./index-BqxabeSv.js";import"./index-DE1hH8uO.js";import"./index-C8wxsonw.js";import"./index-CkGpqcYY.js";import"./index-BT6HVbUo.js";const R={class:"flex flex-column justify-between items-center flex-1 gap-4"},A={class:"flex gap-3 align-items-center"},G={class:"m-2"},H={class:"mr-2"},J={class:"m-2"},ae={__name:"UpdateMenu",setup(K){const{t:p}=F();P();const _=B(),k=T(),x=c(0),m=c([]),i=c(!1),f=c(!1);let g;g="/upload";const S=()=>{let e="";for(const o of m.value)e+='"'+o.name+'",';N.refreshMenuSignal(),console.log("update_all:",i.value),_.add({severity:"info",summary:p("common.success"),detail:p("optionPages.menuUpload")+e.substring(0,e.length-1),life:5e3})},$=e=>{console.log("执行callback()函数，触发实际的文件上传"),e()},h=e=>{m.value=e.files,m.value.forEach(o=>{x.value+=parseInt(y(o.size))})},y=e=>{const s=k.config.locale.fileSizeTypes;if(e===0)return`0 ${s[0]}`;const u=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/Math.pow(1024,u)).toFixed(3))} ${s[u]}`},b=e=>{console.log("上传前的文件",e.files),e.formData.append("update_all",i.value),e.formData.append("takeaway",f.value)};return(e,o)=>{const r=C,s=z,u=V;return I(),j(E,null,[t("div",null,[l(v(M),{url:v(g),onUpload:o[2]||(o[2]=n=>S()),multiple:!0,accept:".xlsx,.xls,.csv,.json",maxFileSize:1e6,onSelect:h,onBeforeUpload:o[3]||(o[3]=n=>b(n))},{header:D(({chooseCallback:n,uploadCallback:w,clearCallback:U,files:d})=>[t("div",R,[t("div",A,[l(r,{onClick:a=>n(),icon:"pi pi-file-arrow-up",rounded:"",outlined:"",severity:"secondary"},null,8,["onClick"]),l(r,{onClick:a=>$(w),icon:"pi pi-cloud-upload",rounded:"",outlined:"",severity:"success",disabled:!d||d.length===0},null,8,["onClick","disabled"]),l(r,{onClick:a=>U(),icon:"pi pi-times",rounded:"",outlined:"",severity:"danger",disabled:!d||d.length===0},null,8,["onClick","disabled"])])]),t("div",G,[t("label",H,q(v(p)("optionPages.changeMenu")),1),l(s,{modelValue:i.value,"onUpdate:modelValue":o[0]||(o[0]=a=>i.value=a)},null,8,["modelValue"])]),t("div",J,[o[4]||(o[4]=t("label",{class:"mr-2"},"takeaway",-1)),l(s,{modelValue:f.value,"onUpdate:modelValue":o[1]||(o[1]=a=>f.value=a)},null,8,["modelValue"])])]),_:1},8,["url"])]),l(u)],64)}}};export{ae as default};
