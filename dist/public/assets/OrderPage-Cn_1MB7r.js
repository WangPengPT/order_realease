import{s as F}from"./index-DyD5Egxe.js";import{s as U}from"./index-Cqr1fXii.js";import{s as L}from"./index-C9hmWf_l.js";import{s as P,a as A}from"./index-CXjYNH-A.js";import{s as j,a as q}from"./index-DvtexoX6.js";import{s as E}from"./index-wnQ3wTQp.js";import{n as o,h as c,c as f,a as s,d as a,w as i,l as H,F as b,o as v,y as K,x as G,t as u,z as J,A as Q,e as W,C as X}from"./index-DzkxfiHh.js";import"./index-Ba247DgM.js";import"./index-BOKqgSf2.js";import"./index-DpivqBnZ.js";import"./index-DsdB08zA.js";import"./index-v0D06vXE.js";import"./index-COcBdBuz.js";const Y={class:"card",style:{display:"flex","flex-direction":"column",height:"75%"}},Z={class:"flex flex-wrap gap-2 items-center justify-between"},ee=["onClick"],te={style:{"list-style-type":"none","padding-left":"0"}},le={class:"flex flex-wrap p-2 items-center gap-4"},se={style:{"max-width":"200px"}},ae={key:0,style:{"max-width":"200px"}},be={__name:"OrderPage",setup(oe){const _=o.orders,p=c(!1),n=c(null),m=c(!1),r=c(null),y=c([{label:"已完成",value:"completed"},{label:"已浏览",value:"readed"},{label:"新订单",value:"new"}]),h=c({global:{value:null,matchMode:X.CONTAINS}}),x=e=>({completed:"已完成",readed:"已浏览",new:"新订单"})[e]||e,C=e=>({completed:"status-completed",readed:"status-readed",new:"status-new"})[e]||"";function N(e){n.value=e,p.value=!1,r.value=e.status,m.value=!0}function S(){r.value!==null&&(n.value.status!==r.value&&(n.value.status==="new"&&o.newOrderCount.value>0&&(o.newOrderCount.value-=1),r.value==="new"&&(o.newOrderCount.value+=1),n.value.status=r.value,o.updateOrderStatus(n.value)),m.value=!1)}const D=e=>new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});function k(e){e.data?(n.value=e.data,console.log("selRow.value",n.value),p.value=!0,e.data.isNew=!1,e.data.status=="new"&&(e.data.status="readed",o.updateOrderStatus(e.data),o.decrementOrderCount())):console.error("Row data is missing in the event",e)}function M(e){return o.getDishNameById(e.dishid)}function V(e){return e.dishid?e.dishid:e.name}function O(e){return o.getDishNote(e)}return(e,l)=>{const $=q,I=E,R=j,d=A,B=P,T=L,w=U,z=F;return v(),f(b,null,[s("div",Y,[a(B,{value:H(_),tableStyle:"min-width: 50rem",dataKey:"id",paginator:"",rows:5,rowsPerPageOptions:[5,10,20,50],stripedRows:"",filters:h.value,scrollable:"",scrollHeight:"flex",onRowClick:k,selectionMode:"single"},{header:i(()=>[s("div",Z,[l[5]||(l[5]=s("h4",{class:"m-0 font-bold text-2xl text-left flex-grow-1"},"所有订单",-1)),a(R,null,{default:i(()=>[a($,null,{default:i(()=>l[4]||(l[4]=[s("i",{class:"pi pi-search"},null,-1)])),_:1,__:[4]}),a(I,{modelValue:h.value.global.value,"onUpdate:modelValue":l[0]||(l[0]=t=>h.value.global.value=t),placeholder:"查找.."},null,8,["modelValue"])]),_:1})])]),empty:i(()=>l[6]||(l[6]=[s("div",{class:"text-center py-5"},[s("i",{class:"pi pi-search",style:{"font-size":"3rem",color:"#ccc"}}),s("p",{class:"mt-3 text-gray-500"},"未找到匹配的订单")],-1)])),default:i(()=>[a(d,{field:"status",header:"状态",sortable:"",style:{width:"10%"}},{body:i(({data:t})=>[s("span",{class:G(["status-badge",C(t.status)]),onClick:K(g=>N(t),["stop"])},u(x(t.status)),11,ee)]),_:1}),a(d,{field:"id",header:"订单号",sortable:"",style:{width:"10%"}}),a(d,{field:"table",header:"桌号",sortable:"",style:{width:"10%"}}),a(d,{field:"time",header:"时间",sortable:"",style:{width:"20%"}},{body:i(({data:t})=>[J(u(D(t.timestamp)),1)]),_:1}),a(d,{field:"name",header:"名字",style:{width:"15%"}}),a(d,{field:"note",header:"备注",style:{width:"35%"},class:"multiline-cell"})]),_:1},8,["value","filters"])]),s("div",null,[a(w,{visible:p.value,"onUpdate:visible":l[1]||(l[1]=t=>p.value=t),header:"详细信息",modal:!0,dismissableMask:!0},{default:i(()=>[s("ul",te,[(v(!0),f(b,null,Q(n.value.items,(t,g)=>(v(),f("li",{key:g},[s("div",le,[s("label",null,u(V(t)),1),s("label",null,u(M(t)),1),s("label",null,"x "+u(t.quantity),1),s("label",se,u(O(t.notes)),1),t.dishNote?(v(),f("label",ae,u(t.dishNote),1)):W("",!0)]),a(T)]))),128))])]),_:1},8,["visible"])]),s("div",null,[a(w,{visible:m.value,"onUpdate:visible":l[3]||(l[3]=t=>m.value=t),header:"订单状态",modal:!0,dismissableMask:!0},{default:i(()=>[a(z,{modelValue:r.value,"onUpdate:modelValue":l[2]||(l[2]=t=>r.value=t),options:y.value,optionLabel:"label",optionValue:"value",onClick:S},null,8,["modelValue","options"])]),_:1},8,["visible"])])],64)}}};export{be as default};
