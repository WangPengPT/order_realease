import{s as E}from"./index-Kb1GGTp-.js";import{s as L}from"./index-DUtRwU2z.js";import{s as q}from"./index-94mcCLn7.js";import{s as j,a as G}from"./index-_cDKrP7J.js";import{s as H,a as K}from"./index-CdBUr0m-.js";import{s as J}from"./index-aXuIawC2.js";import{a as Q}from"./index-BAw4wzdj.js";import{q as W,n,h as m,s as X,c as g,a as s,b as o,w as d,l as r,F as x,o as v,A as Y,z as Z,t as i,C as ee,E as te,e as ae,G as le}from"./index-Bh5r7ere.js";import"./index-BxDh6QJ2.js";import"./index-BJs70N85.js";import"./index-DFi4Aux_.js";import"./index-DdOOIdM2.js";import"./index-5xk_L1Fr.js";import"./index-Ch1VY8YX.js";import"./index-BQsMzXQ-.js";import"./index-aUxrns4h.js";const se={class:"card h-full",style:{display:"flex","flex-direction":"column"}},oe={class:"flex flex-column"},re={class:"flex flex-wrap gap-2 items-center justify-between"},ne={class:"m-0 font-bold text-2xl text-left flex-grow-1"},de=["onClick"],ie={class:"text-center py-5"},ue={class:"mt-3 text-gray-500"},ce={style:{"list-style-type":"none","padding-left":"0"}},pe={class:"flex flex-wrap p-2 items-center gap-4"},me={style:{"max-width":"200px"}},fe={key:0,style:{"max-width":"200px"}},$e={__name:"OrderPage",setup(he){const{t:l}=W(),_=n.orders,f=m(!1),u=m(null),h=m(!1),c=m(null),N=X(()=>[{label:l("orderPage.completed"),value:"completed"},{label:l("orderPage.read"),value:"read"},{label:l("orderPage.new"),value:"new"}]),w=m({global:{value:null,matchMode:le.CONTAINS}}),P=e=>({completed:l("orderPage.completed"),read:l("orderPage.read"),new:l("orderPage.new")})[e]||e,C=e=>({completed:"status-completed",read:"status-read",new:"status-new"})[e]||"";function S(e){u.value=e,f.value=!1,c.value=e.status,h.value=!0}function k(){c.value!==null&&(u.value.status!==c.value&&(u.value.status==="new"&&n.updateNewOrderCount("order",-1),c.value==="new"&&n.updateNewOrderCount("order",1),u.value.status=c.value,n.updateOrderStatus(u.value)),h.value=!1)}function D(){_.value.forEach(e=>{e.status=="new"&&(e.status="read",n.updateOrderStatus(e),n.updateNewOrderCount("order",-1))})}const M=e=>new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});function O(e){e.data?(u.value=e.data,console.log("selRow.value",u.value),f.value=!0,e.data.isNew=!1,e.data.status=="new"&&(e.data.status="read",n.updateOrderStatus(e.data),n.updateNewOrderCount("order",-1))):console.error("Row data is missing in the event",e)}function V(e){const a=n.menuApi.getDishNameById(e.dishid);return a||e.name}function $(e){return e.dishid?e.dishid:e.name}function I(e){return n.getDishNote(e)}return(e,a)=>{const R=Q,B=K,T=J,A=H,p=G,F=j,z=q,b=L,U=E;return v(),g(x,null,[s("div",se,[o(F,{value:r(_),tableStyle:"min-width: 50rem",dataKey:"id",paginator:"",rows:5,rowsPerPageOptions:[5,10,20,50],stripedRows:"",scrollable:"",scrollHeight:"flex",selectionMode:"single",filters:w.value,onRowClick:O},{header:d(()=>[s("div",oe,[s("div",re,[s("h4",ne,i(r(l)("orderPage.orders")),1),o(R,{label:r(l)("orderPage.markAllAsRead"),onClick:a[0]||(a[0]=t=>D())},null,8,["label"]),o(A,null,{default:d(()=>[o(B,null,{default:d(()=>a[5]||(a[5]=[s("i",{class:"pi pi-search"},null,-1)])),_:1,__:[5]}),o(T,{modelValue:w.value.global.value,"onUpdate:modelValue":a[1]||(a[1]=t=>w.value.global.value=t),placeholder:r(l)("orderPage.find")},null,8,["modelValue","placeholder"])]),_:1})])])]),empty:d(()=>[s("div",ie,[a[6]||(a[6]=s("i",{class:"pi pi-search",style:{"font-size":"3rem",color:"#ccc"}},null,-1)),s("p",ue,i(r(l)("orderPage.notFound")),1)])]),default:d(()=>[o(p,{field:"status",header:r(l)("orderPage.status"),sortable:"",style:{width:"10%"}},{body:d(({data:t})=>[s("span",{class:Z(["status-badge",C(t.status)]),onClick:Y(y=>S(t),["stop"])},i(P(t.status)),11,de)]),_:1},8,["header"]),o(p,{field:"id",header:r(l)("orderPage.orderNumber"),sortable:"",style:{width:"10%"}},null,8,["header"]),o(p,{field:"table",header:r(l)("orderPage.tableNumber"),sortable:"",style:{width:"10%"}},null,8,["header"]),o(p,{field:"time",header:r(l)("orderPage.time"),sortable:"",style:{width:"20%"}},{body:d(({data:t})=>[ee(i(M(t.timestamp)),1)]),_:1},8,["header"]),o(p,{field:"name",header:r(l)("orderPage.name"),style:{width:"15%"}},null,8,["header"]),o(p,{field:"note",header:r(l)("orderPage.notes"),style:{width:"35%"},class:"multiline-cell"},null,8,["header"])]),_:1},8,["value","filters"])]),s("div",null,[o(b,{visible:f.value,"onUpdate:visible":a[2]||(a[2]=t=>f.value=t),header:r(l)("orderPage.details"),modal:!0,dismissableMask:!0},{default:d(()=>[s("ul",ce,[(v(!0),g(x,null,te(u.value.items,(t,y)=>(v(),g("li",{key:y},[s("div",pe,[s("label",null,i($(t)),1),s("label",null,i(V(t)),1),s("label",null,"x "+i(t.quantity),1),s("label",me,i(I(t.notes)),1),t.dishNote?(v(),g("label",fe,i(t.dishNote),1)):ae("",!0)]),o(z)]))),128))])]),_:1},8,["visible","header"])]),s("div",null,[o(b,{visible:h.value,"onUpdate:visible":a[4]||(a[4]=t=>h.value=t),header:r(l)("orderPage.orderStatus"),modal:!0,dismissableMask:!0},{default:d(()=>[o(U,{modelValue:c.value,"onUpdate:modelValue":a[3]||(a[3]=t=>c.value=t),options:N.value,optionLabel:"label",optionValue:"value",onClick:k},null,8,["modelValue","options"])]),_:1},8,["visible","header"])])],64)}}};export{$e as default};
