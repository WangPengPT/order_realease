import{g as Ye,r as Ze}from"./vendor-DYQJwaLu.js";import{Q as ue,b as w,e as ye,f,o as n,h as e,v as b,F,y as X,a as D,B as ce,t as o,M as t,s as N,E as we,c as Q,A as he,U as Be,w as ve,C as oe,p as et,I as tt,J as st,n as Oe,R as lt,S as at}from"./vue-BLaX11bV.js";import{k as ke,b as P,e as fe,l as nt,m as We,j as Pe,n as Ue,u as ot,f as Ae,g as Me,h as Le,d as Re,o as it,p as Ve,c as qe,q as rt,r as ut,v as ct,i as dt,w as mt,x as ft}from"./primevue-DRc8vkgT.js";import{c as k,m as Y,a as $e,g as vt}from"./index-CuWKOV3v.js";import{D as B,c as ne,l as He}from"./localforage-Cr7WH93t.js";import{_ as ge}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as ht,S as pt}from"./pagination-ByGpG7Fh.js";var yt=Ze();const Se=Ye(yt),gt={class:"grid"},bt={key:0,class:"col-12 sm:col-12 md:col-6 lg:col-4 border-round surface-section shadow-1 p-2"},_t={class:"flex flex-column"},xt=["onClick"],kt={class:"p-1 flex-shrink-0 w-7rem h-7rem flex align-items-center justify-content-center overflow-hidden"},wt=["src","alt"],$t={class:"flex flex-column justify-content-center"},Dt={class:"font-bold"},It={class:"flex flex-wrap gap-2"},Ct={class:"flex gap-1 align-items-center"},Tt={class:"text-color-secondary line2"},Nt={key:0,class:"text-xl font-bold text-primary"},qt={key:1,class:"flex align-items-center gap-1"},St={class:"text-l font-bold text-color-secondary"},At={class:"text-sm line-through text-500"},Mt={key:2,class:"flex gap-2 mr-2",id:"card-quantity"},Lt={class:"w-2rem text-xl text-center"},Rt={key:3,class:"flex gap-2 mr-2"},Vt={key:0,class:"m-2 mt-0"},Pt={class:"flex flex-row justify-content-between align-content-center"},Et={class:"flex flex-column"},jt={class:"text-l font-bold"},Ft={key:0,class:"text-l font-bold text-color-secondary"},Ot={key:1,class:"flex align-items-center gap-1"},Wt={class:"text-l font-bold text-color-secondary"},Ut={class:"text-sm line-through text-500"},Ht={key:0,class:"flex ml-2 mr-2"},Bt={class:"w-2rem text-xl text-center"},zt={key:1,class:"flex gap-2 mr-3 pt-2 pb-2"},Qt={class:"mb-2 flex justify-content-center"},Gt={class:"font-bold text-center"},Kt={class:"mb-2"},Jt={class:"text-color-secondary m-0 line-height-3 line2 text-center"},Xt={class:"mb-2"},Yt={class:"flex justify-content-center"},Zt=["src","alt"],es={class:"flex align-items-center gap-2"},ts=["src","alt"],ss={class:"flex align-items-center gap-3 ml-auto"},ls={__name:"DishList",props:{rateDish:{type:Function,required:!0},likedItemsRef:Array,dislikedItemsRef:Array,tabIndex:Number,onlyVeg:Boolean},setup(q){const{t:H}=ue(),$=B.dishDatas,L=w(null),_=q,C=(u,S=!0)=>{if(!_.onlyVeg)return!0;if(S)return u.vegetable;if(u.subItems.length>0){for(const v of u.subItems)if(v.vegetable)return!0}else return u.dish.vegetable;return!1};ye(()=>{let u=k.getOrderMenuTab()[_.tabIndex];if(k.customDishAPI.customDishes.value.map(c=>c.name),k.getMenu().length==0){console.log("exit");return}L.value=$.value[v($.value,u)].mainDishes,B.showDishList(L.value);function v(c,g){for(const l in c)if(c[l].name==g)return l;console.error("Can not find tab index in menu")}});let i={rated:!1,id:null,like:0,rate:0};const R=u=>B.dishDatas.value[u]?B.dishDatas.value[u].quantity:0,y=u=>{if(!E())return!1;const S=u.quantity;let v=3;if(u.price>0&&(v=9),u.limit){const c=u.id,g=E(),l=(g.peopleType.adults+g.peopleType.children)*u.limit,d=g.order.find(h=>h.dishid==c);let r=0;if(u.subitem)for(const h of u.subitem){r+=R(h);const x=g.order.find(z=>z.dishid==V(h));x&&(r+=x.quantity)}else r+=u.quantity,d&&(r+=d.quantity);return S>=v||l&&r>=l}return S>=v},V=u=>B.dishDatas.value[u]?B.dishDatas.value[u].id:0,E=()=>k.getTableValue(),O=u=>{let S="absolute origin-top-left mt-1 ml-1 border-round-lg pl-1 pr-1 text-xs text-white font-bold ";switch(u){case"new":S+="bg-red-600";break;case"recommended":case"special":S+="bg-orange-600";break;default:S+="bg-blue-600"}return S};function I(u){_.rateDish(i.id,i.like,i.rate,i.rated),W(u,i.rate,i.like),i.id=null,i.like=0,i.rate=0,i.rated=!1}const A=u=>{const S=_.likedItemsRef.indexOf(u);if(i.id=u.id,S!==-1)_.likedItemsRef.splice(S,1),i.like+=-1,i.rate+=-1,i.rated=!1;else{i.rated=!0,_.likedItemsRef.push(u);const v=_.dislikedItemsRef.indexOf(u);v!==-1?(_.dislikedItemsRef.splice(v,1),i.like+=1):(i.like+=1,i.rate+=1)}I(u)};function W(u,S=0,v=0){u.rates=(u.rates||0)+S,u.likes=(u.likes||0)+v}const G=u=>{const S=_.dislikedItemsRef.indexOf(u);if(i.id=u.id,S!==-1)_.dislikedItemsRef.splice(S,1),i.rate+=-1,i.rated=!1;else{i.rated=!0,_.dislikedItemsRef.push(u);const v=_.likedItemsRef.indexOf(u);v!==-1?(_.likedItemsRef.splice(v,1),i.like+=-1):i.rate+=1}I(u)},K=w(!1),j=w({}),se=u=>{K.value=!0,j.value=u},Z=u=>{u.target.src="/images/default.png"};function ee(u){te(u.target,300)}function ie(u){te(u.target,110)}function te(u,S){const v=u.naturalWidth,c=u.naturalHeight,g=Math.min(v,S),l=g/v,d=c*l;u.style.width=`${g}px`,u.style.height=`${d}px`}return(u,S)=>(n(),f(F,null,[e("div",gt,[(n(!0),f(F,null,X(L.value,(v,c)=>{var g;return n(),f(F,{key:c},[C(v,!1)?(n(),f("div",bt,[e("div",_t,[e("div",{class:ce(["flex flex-row",v.subItems.length!==0?"flex-grow-1":""]),onClick:l=>se(v.dish)},[((g=v.dish.etiquette)==null?void 0:g.length)>0?(n(),f("div",{key:0,class:ce(O(v.dish.etiquette))},o(t(H)("common.etiquette."+v.dish.etiquette)),3)):D("",!0),e("div",kt,[e("img",{src:v.dish.image||"/images/default.png",alt:v.dish.name,class:"w-full h-full",style:{"object-fit":"cover"},onError:Z,onLoad:ie},null,40,wt)]),e("div",$t,[e("div",Dt,o(v.dish.name),1),e("div",null,[e("div",It,[e("div",Ct,[(n(),f(F,null,X(5,l=>e("i",{key:l,class:ce(["pi invert-star",l<=Math.floor(v.dish.likes/v.dish.rates*5)?"pi-star-fill":l-.5<=v.dish.likes/v.dish.rates*5?"pi-star-half-fill":"pi-star"]),style:{color:"black"}},null,2)),64)),e("p",null,"("+o(v.dish.rates?v.dish.rates:0)+")",1)])])]),e("div",null,[e("p",Tt,o(v.dish.note),1)])])],10,xt),v.subItems.length==0?(n(),f("div",{key:0,class:ce(["flex ml-2 mr-2 mb-2",Number(v.dish.price)>0?"justify-content-between":"justify-content-end"])},[!v.dish.discount&&Number(v.dish.price)>0?(n(),f("span",Nt,"â‚¬"+o(v.dish.price),1)):D("",!0),v.dish.discount?(n(),f("div",qt,[e("span",St,"â‚¬"+o(v.dish.dis_price),1),e("span",At,"â‚¬"+o(v.dish.price),1),b(t(ke),{severity:"danger",value:"-"+v.dish.discount+"%"},null,8,["value"])])):D("",!0),v.dish.soldout?D("",!0):(n(),f("div",Mt,[b(t(P),{icon:"pi pi-minus",rounded:"",disabled:v.dish.quantity<=0,onClick:l=>v.dish.quantity--,class:"w-2rem h-2rem"},null,8,["disabled","onClick"]),e("span",Lt,o(v.dish.quantity),1),b(t(P),{icon:"pi pi-plus",rounded:"",disabled:y(v.dish),onClick:l=>v.dish.quantity++,class:"w-2rem h-2rem"},null,8,["disabled","onClick"])])),v.dish.soldout?(n(),f("div",Rt,[b(t(ke),{severity:"danger",value:u.$t("common.soldout")},null,8,["value"])])):D("",!0)],2)):D("",!0),v.subItems.length!==0?(n(!0),f(F,{key:1},X(v.subItems,(l,d)=>(n(),f(F,{key:"index"},[!l.disable&&C(l)?(n(),f("div",Vt,[e("div",Pt,[e("div",Et,[e("span",jt,o(l.subname),1),!l.discount&&l.price!=="0.00"&&l.price!=="0"?(n(),f("span",Ft,"â‚¬"+o(l.price),1)):D("",!0),l.discount?(n(),f("div",Ot,[e("span",Wt,"â‚¬"+o(l.dis_price),1),e("span",Ut,"â‚¬"+o(l.price),1),b(t(ke),{severity:"danger",value:"-"+l.discount+"%"},null,8,["value"])])):D("",!0)]),l.soldout?D("",!0):(n(),f("div",Ht,[b(t(P),{icon:"pi pi-minus",rounded:"",disabled:l.quantity<=0,onClick:r=>l.quantity--,class:"w-2rem h-2rem"},null,8,["disabled","onClick"]),e("span",Bt,o(l.quantity),1),b(t(P),{icon:"pi pi-plus",rounded:"",onClick:r=>l.quantity++,class:"w-2rem h-2rem",disabled:y(l)},null,8,["onClick","disabled"])])),l.soldout?(n(),f("div",zt,[b(t(ke),{severity:"danger",value:u.$t("common.soldout")},null,8,["value"])])):D("",!0)])])):D("",!0)],64))),128)):D("",!0)])])):D("",!0)],64)}),128))]),b(t(fe),{visible:K.value,"onUpdate:visible":S[2]||(S[2]=v=>K.value=v),modal:"",header:" ",style:we([{width:"23rem"},{width:"80vw","max-width":"700px"}]),pt:{header:{class:"p-1"}}},{default:N(()=>[e("div",Qt,[e("span",Gt,o(j.value.name),1)]),e("div",Kt,[e("span",Jt,o(j.value.note),1)]),e("div",Xt,[e("div",Yt,[e("img",{class:"w-full h-auto object-contain",src:j.value.image,alt:j.value.name,onError:Z,onLoad:ee},null,40,Zt)])]),e("div",es,[(n(!0),f(F,null,X(j.value.allergies,(v,c)=>(n(),f("img",{src:"images/"+v+".png",alt:v,class:"w-2rem h-2rem border-round flex-shrink-0",style:{"object-fit":"cover","min-width":"2rem"}},null,8,ts))),256)),e("div",ss,[e("button",{onClick:S[0]||(S[0]=v=>A(j.value)),class:"p-0 border-none bg-transparent cursor-pointer"},[e("i",{class:ce(["pi pi-thumbs-up text-xl",_.likedItemsRef.includes(j.value)?"text-green-500":"text-gray-400"])},null,2)]),e("button",{onClick:S[1]||(S[1]=v=>G(j.value)),class:"p-0 border-none bg-transparent cursor-pointer"},[e("i",{class:ce(["pi pi-thumbs-down text-xl",_.dislikedItemsRef.includes(j.value)?"text-red-500":"text-gray-400"])},null,2)])])])]),_:1},8,["visible"])],64))}},as=ge(ls,[["__scopeId","data-v-51ff8788"]]),ns={key:0,class:"text-3xl font-bold"},os={class:"flex flex-column gap-3 p-1"},is={key:0,class:"flex flex-column gap-1"},rs={key:0,class:"m-0"},us={key:0,class:"m-0"},cs={class:"flex justify-content-between gap-4 mt-1"},ds={class:"flex align-items-center gap-2"},ms=["src","alt"],fs={class:"flex-grow-1 min-width-0 max-w-18rem"},vs={class:"flex flex-column gap-1"},hs={class:"flex align-items-center gap-2"},ps={class:"text-xl font-bold line1 whitespace-nowrap overflow-hidden text-overflow-ellipsis",style:{"max-width":"20rem"}},ys={class:"flex align-items-end gap-1"},gs={key:0,class:"text-xl font-bold text-primary"},bs={key:1,class:"text-xl font-bold text-primary"},_s={key:2,class:"text-sm text-color-secondary"},xs={key:0,class:"text-xs text-primary"},ks={class:"flex-shrink-0 flex flex-wrap justify-content-between align-items-center gap-1"},ws={class:"flex flex-wrap justify-content-between align-content-center"},$s={class:"flex align-items-center gap-1"},Ds={class:"w-2rem text-center"},Is={key:1,class:"flex flex-column gap-2 mt-2"},Cs={for:"in_label"},Ts={for:"in_label"},Ns={class:"bottom-0 left-0 mt-2"},qs={class:"text-2xl font-bold"},Ss={class:"text-2xl font-bold text-primary pl-2"},As={class:"flex justify-content-between"},Ms={__name:"Cart",props:{checkout:{type:Function,required:!0},isTakeaway:Boolean},setup(q,{expose:H}){const{locale:$}=ue(),L=Be(),{t:_}=ue(),C=ne.cartDishs,i=w([]),R=w(),y=w(),V=w(!1),E=w(!1),O=w(!0),I=w(""),A=w("");function W(r,h,x){let z="";const T=$.value,U=k.customDishAPI.getCustomDishByName(r);for(const J of x){const de=U.types[h].dishes.find(me=>me.dishid===J.id)[`name_${T}`];z=z+de+"/"}return z}function G(r,h){const x=$.value;return k.customDishAPI.getCustomDishByName(r).types[h][`typeName_${x}`]}const K=(r,h)=>{const x=i.value[r].quantity+h;x>=0&&(i.value[r].quantity=x)};function j(r){r&&R.value&&(R.value.dishNote=y.value?y.value:void 0),E.value=!1}function se(){y.value&&(y.value=void 0),R.value&&(R.value=void 0)}function Z(r){R.value=r,y.value=R.value.dishNote?R.value.dishNote:void 0,E.value=!0}const ee=q;H({showDishList:r=>{V.value=!0,i.value.length=0;for(let h=0;h<r.length;h++)i.value.push(r[h]);O.value=i.value.length==0&&C.length==0}});function te(r){ne.removeItem(r)}function u(){ee.isTakeaway?S():v()}function S(){const r=[];C.value.forEach(h=>{r.push(h)}),i.value.forEach(h=>{h.quantity>0&&r.push(h)}),r.length<=0?Y.show_warn(_("notification.select_at_least_one")):(V.value=!1,L.push({path:"/paymentPage"}))}function v(){ee.checkout({name:I.value,note:A.value},r=>{r.success&&(C.value.forEach(h=>{h.dishNote=void 0}),i.value.forEach(h=>{h.dishNote=void 0}),A.value="",B.cleanDishDataQty(),$e.deleteCookie("cartDish_normal"),ne.cleanAll(),$e.deleteCookie("cartDish_custom"),V.value=!1)})}function c(r){return r.subname!=""&&r.subname!="Default Title"?r.name+" "+r.subname:r.name}function g(){let r=0;return C.value.forEach(h=>{r+=h.discount?(h.dis_price?h.dis_price:0)*h.count:(h.price?h.price:0)*h.count}),i.value.forEach(h=>{r+=h.discount?(h.dis_price?h.dis_price:0)*h.quantity:(h.price?h.price:0)*h.quantity}),"â‚¬"+r.toFixed(2)}const l=r=>{r.target.src="/images/default.png"},d=r=>{const h=r.quantity;let x=3;return r.price>0&&(x=9),h>=x};return(r,h)=>(n(),f(F,null,[b(t(fe),{class:"bg-primary-reverse text-sm md:text-lg lg:text-xl",visible:V.value,"onUpdate:visible":h[2]||(h[2]=x=>V.value=x),modal:"",header:r.$t("common.cart"),style:we([{backgroundColor:"rgba(250, 250, 250, 1)",height:"100%",minWidth:"24rem"},{width:"80vw","max-width":"700px"}]),dismissableMask:!0},{footer:N(()=>[e("div",Ns,[e("span",qs,o(r.$t("common.total"))+": ",1),e("span",Ss,o(g()),1),b(t(P),{icon:q.isTakeaway?"pi pi-wallet":"pi pi-plus",class:"p-button-success p-button-rounded ml-3",onClick:u,label:q.isTakeaway?t(_)("common.pay"):t(_)("common.send")},null,8,["icon","label"])])]),default:N(()=>[O.value?(n(),f("h2",ns,"Cart is empty.")):D("",!0),e("div",os,[(n(!0),f(F,null,X(t(C),(x,z)=>(n(),Q(t(nt),{style:{overflow:"hidden"},key:z},{title:N(()=>[he(o(r.$t(`common.${x.name}`)),1)]),subtitle:N(()=>[he(o(r.$t("common.price"))+" : "+o(x.price)+"â‚¬",1)]),content:N(()=>[t(k).customDishAPI.customDishes.value.find(T=>T.name==x.name)?(n(),f("div",is,[(n(!0),f(F,null,X(x.notesAndId,(T,U)=>(n(),f("div",null,[x.notesAndId[U].length!==0?(n(),f("span",rs,o(G(x.name,U))+": "+o(W(x.name,U,T)),1)):D("",!0)]))),256)),e("div",null,[x.dishNote?(n(),f("span",us,o(r.$t("common.note"))+": "+o(x.dishNote),1)):D("",!0)])])):D("",!0)]),footer:N(()=>[e("div",cs,[q.isTakeaway?D("",!0):(n(),Q(t(P),{key:0,label:t(_)("common.edit")+" "+t(_)("common.note"),severity:"contrast",onClick:T=>Z(x)},null,8,["label","onClick"])),b(t(P),{label:t(_)("common.remove"),severity:"danger",onClick:T=>te(x)},null,8,["label","onClick"])])]),_:2},1024))),128)),(n(!0),f(F,null,X(i.value,(x,z)=>(n(),f("div",{key:z,class:"p-2 border-round shadow-1 transition-all transition-duration-200 hover:shadow-3 flex flex-column gap-1"},[e("div",ds,[e("img",{src:x.image,alt:x.name,class:"w-4rem h-4rem border-round flex-shrink-0",onError:l,style:{"object-fit":"cover","min-width":"4rem"}},null,40,ms),e("div",fs,[e("div",vs,[e("div",hs,[e("span",ps,o(c(x)),1)])]),e("div",ys,[x.discount?(n(),f("span",gs,"â‚¬"+o(Number(x.dis_price?x.dis_price:0).toFixed(2)),1)):D("",!0),x.discount?D("",!0):(n(),f("span",bs,"â‚¬"+o(Number(x.price?x.price:0).toFixed(2)),1)),x.price>0?(n(),f("span",_s,"/uni.")):D("",!0)])])]),e("div",null,[x.dishNote?(n(),f("span",xs,o(t(_)("common.note")+": "+x.dishNote),1)):D("",!0)]),e("div",ks,[e("div",ws,[q.isTakeaway?D("",!0):(n(),Q(t(P),{key:0,label:t(_)("common.edit")+" "+t(_)("common.note"),severity:"contrast",class:"w-3.5rem h-2rem",onClick:T=>Z(x)},null,8,["label","onClick"]))]),e("div",$s,[b(t(P),{icon:"pi pi-minus",rounded:"",disabled:x.quantity<=0,onClick:T=>K(z,-1),class:"w-2rem h-2rem"},null,8,["disabled","onClick"]),e("span",Ds,o(x.quantity),1),b(t(P),{icon:"pi pi-plus",rounded:"",disabled:d(x),onClick:T=>K(z,1),class:"w-2rem h-2rem"},null,8,["disabled","onClick"])])])]))),128))]),q.isTakeaway?D("",!0):(n(),f("div",Is,[b(t(We),{variant:"in"},{default:N(()=>[b(t(Pe),{id:"in_label",modelValue:I.value,"onUpdate:modelValue":h[0]||(h[0]=x=>I.value=x),variant:"filled",maxlength:"20"},null,8,["modelValue"]),e("label",Cs,o(t(_)("common.name")),1)]),_:1}),b(t(We),{variant:"in"},{default:N(()=>[b(t(Ue),{id:"in_label",class:"min-w-full",rows:"5",modelValue:A.value,"onUpdate:modelValue":h[1]||(h[1]=x=>A.value=x),variant:"filled",maxlength:"200"},null,8,["modelValue"]),e("label",Ts,o(t(_)("common.observation")),1)]),_:1})]))]),_:1},8,["visible","header"]),b(t(fe),{visible:E.value,"onUpdate:visible":h[6]||(h[6]=x=>E.value=x),header:t(_)("common.note"),onHide:h[7]||(h[7]=x=>se()),modal:"",dismissableMask:!0},{default:N(()=>[b(t(Ue),{modelValue:y.value,"onUpdate:modelValue":h[3]||(h[3]=x=>y.value=x),rows:"5",cols:"30",placeholder:t(_)("common.edit")+" "+t(_)("common.note")+"...",maxlength:"100"},null,8,["modelValue","placeholder"]),e("div",As,[b(t(P),{label:t(_)("common.cancel"),severity:"danger",onClick:h[4]||(h[4]=x=>j(!1))},null,8,["label"]),b(t(P),{label:t(_)("common.save"),severity:"primary",size:"sm",onClick:h[5]||(h[5]=x=>j(!0))},null,8,["label"])])]),_:1},8,["visible","header"])],64))}},Ls=ge(Ms,[["__scopeId","data-v-c63f1df5"]]);w([]);w("iniImages()");const Rs={class:"m-3"},Vs={class:"flex flex-column gap-2"},Ps={class:"w-full flex justify-content-center"},Es={key:0,class:"max-w-19rem"},js=["src"],Fs={style:{width:"300px",height:"300px",background:"url(/boxImage/box.png)"}},Os={key:0,class:"flex align-items-center justify-content-center text-4xl font-bold text-white w-full h-full"},Ws={key:1,class:"grid m-0 p-2"},Us=["onClick"],Hs={class:"flex align-items-center justify-content-center font-bold m-0 p-0",style:{width:"94px",height:"94px"}},Bs=["src"],zs={class:"flex flex-wrap justify-content-between align-items-center m-1"},Qs={class:"flex gap-1 align-items-center"},Gs={key:0},Ks={class:"font-bold mb-2"},Js={key:1,class:"flex justify-content-between gap-2 mt-3"},Xs={class:"font-bold mb-2"},Ys={class:"flex mr-2"},Zs={class:"w-3rem text-xl text-center"},el={class:"font-bold block mb-2"},tl={class:"flex flex-wrap"},sl={key:2,class:"flex flex-wrap gap-2 mt-3"},ll={class:"font-bold block mb-2"},al={class:"font-bold block mb-2 text-center"},nl={class:"flex flex-wrap gap-2 mt-3"},ol={__name:"CustomDish",props:{currentCustomDish:Object,tabindex:Number},emits:["typeClick"],setup(q,{emit:H}){const{locale:$}=ue(),L=q,_=ot(),{t:C}=ue(),i=w(null);ve(()=>L.currentCustomDish,c=>{c&&(i.value=c)},{immediate:!0,deep:!0});const R=oe(()=>i.boxImages),y=w(0),V=oe(()=>{var g;if(i.value==null)return 0;let c=(g=i.value)==null?void 0:g.initialPrice;for(const l of i.value.types??[])for(const d of l.dishes??[])d.selected&&(c+=d.price);return Number(c).toFixed(2)}),E=H,O=w(null),I=oe(()=>{const c=$.value,g=`title_${c}`,l=`description_${c}`;return i.value==null?{}:i.value.descriptions.map(d=>({title:d[g],descriptions:d.descriptions.map(r=>r[l]),image:d==null?void 0:d.image}))}),A=oe(()=>{var l,d;const c=Number(((l=i.value)==null?void 0:l.like)??0),g=Number(((d=i.value)==null?void 0:d.rate)??0);return g?c/g*5:0});function W(c,g){const l=$.value;return c[`${g}_${l}`]}function G(c,g,l){const d=c[g];if(d.selected){d.selected=!1;return}else{const h=c.filter(x=>x.selected).length;if(l===1){u(c),d.selected=!0;return}h<l&&(d.selected=!0)}}function K(c,g,l){const d=c.dishes;E("typeClick",c,g,d[g].selected),G(d,g,l)}function j(c){return c.selected}function se(){if(!S(i.value.types))return;const c=ee(i.value.types),g=ie(i.value.types);ne.addItem({dishid:-1,name:i.value.name,category:L.currentCustomDish.category,count:y.value!==0?y.value:1,price:V.value,notes:c,notesAndId:g}),console.log("CART: ",ne.cartDishs),te(i.value.types),Y.show({severity:"info",summary:"info",detail:C("customDishBibimbapVue.addToCartSuccessBibimbap")})}function Z(c){return!c||!c.dishes?"":c.dishes.filter(l=>l.selected).map(l=>l.name).join(",")}function ee(c){return c?c.map(g=>Z(g)):[]}function ie(c){return c?c.map(g=>g.dishes?g.dishes.filter(l=>l.selected).map(l=>({id:l.dishid,name:l.name})):[]):[]}function te(c){c&&c.forEach(g=>{g.dishes&&g.dishes.forEach(l=>{l.selected=!1})})}function u(c){c.forEach(g=>g.selected=!1)}function S(c){if(i.value.options.quantity&&y.value<=0)return Y.show({severity:"warn",detail:C("notification.quantity_must_be_positive")}),!1;for(const g of c)if(g.dishes.filter(d=>d.selected).length<g.minQuantity){const d=g.typeName;return Y.show({severity:"warn",detail:C("notification.select_type_of",{name:d})}),!1}return!0}function v(c){c?k.customDishAPI.like(i.value.id)&&(O.value="like",_.add({severity:"success",summary:C("common.success"),detail:C("common.rate")+" "+C("common.success"),life:750})):k.customDishAPI.unLike(i.value.id)&&(O.value="unlike",_.add({severity:"success",summary:C("common.success"),detail:C("common.rate")+" "+C("common.success"),life:750}))}return(c,g)=>{var l,d,r,h,x,z;return n(),f("div",Rs,[e("div",Vs,[b(t(Re),{class:"w-full max-w-xl mx-auto"},{default:N(()=>[(n(!0),f(F,null,X(I.value,(T,U)=>(n(),Q(t(Ae),{key:U,value:U},{default:N(()=>[b(t(Me),null,{default:N(()=>[he(o(T.title),1)]),_:2},1024),b(t(Le),null,{default:N(()=>{var J;return[(n(!0),f(F,null,X(T.descriptions,(de,me)=>(n(),f("p",{key:me},o(de),1))),128)),e("div",Ps,[(J=T.image)!=null&&J.src?(n(),f("div",Es,[e("img",{src:T.image.src,class:"w-full"},null,8,js)])):D("",!0)])]}),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1}),((d=(l=i.value)==null?void 0:l.value)==null?void 0:d.name)==="MY BOX"?(n(),Q(t(Re),{key:0,class:"w-full max-w-xl mx-auto"},{default:N(()=>[b(t(Ae),{value:"0"},{default:N(()=>[b(t(Me),null,{default:N(()=>[he(" ðŸ¥© "+o(c.$t("common.showMybox")),1)]),_:1}),b(t(Le),null,{default:N(()=>[e("div",Fs,[c.isEmptyArray(R.value)?(n(),f("div",Os,o(c.$t("common.myboxAlarm")),1)):D("",!0),c.isEmptyArray(R.value)?D("",!0):(n(),f("div",Ws,[(n(!0),f(F,null,X(R.value,T=>(n(),f("div",{class:"col-4 p-0",onClick:U=>c.imageSelectAction(T)},[e("div",Hs,[T?(n(),f("img",{key:0,class:"m-0 p-0",src:c.imagePath(T),style:{width:"82px",height:"82px"}},null,8,Bs)):D("",!0)])],8,Us))),256))]))])]),_:1})]),_:1})]),_:1})):D("",!0)]),e("div",zs,[e("div",Qs,[(n(),f(F,null,X(5,T=>e("i",{key:T,class:ce(["pi invert-star",T<=Math.floor(A.value)?"pi-star-fill":T-.5<=A.value?"pi-star-half":"pi-star"]),style:{color:"black"}},null,2)),64)),e("p",null,"("+o((r=i.value)!=null&&r.rate?i.value.rate:0)+")",1)]),e("div",null,[b(t(P),{text:"",icon:"pi pi-thumbs-up",severity:O.value==="like"?"success":"",onClick:g[0]||(g[0]=T=>v(!0))},null,8,["severity"]),b(t(P),{text:"",icon:"pi pi-thumbs-down",severity:O.value==="unlike"?"danger":"",onClick:g[1]||(g[1]=T=>v(!1))},null,8,["severity"])])]),(h=i.value)!=null&&h.options.extraInfo?(n(),f("div",Gs,[e("label",Ks,o(i.value.options.extraInfo),1)])):D("",!0),(x=i.value)!=null&&x.options.quantity?(n(),f("div",Js,[e("div",null,[e("label",Xs,o(c.$t("common.quantity"))+" / "+o(c.$t("common.pieces")),1)]),e("div",Ys,[b(t(P),{icon:"pi pi-minus",disabled:y.value<=0,onClick:g[2]||(g[2]=T=>{var U;return y.value-=(U=i.value)==null?void 0:U.options.quantitySetp}),class:"w-2rem h-2rem"},null,8,["disabled"]),e("span",Zs,o(y.value),1),b(t(P),{icon:"pi pi-plus",disabled:y.value>=i.value.options.maxQuantity,onClick:g[3]||(g[3]=T=>{var U;return y.value+=(U=i.value)==null?void 0:U.options.quantitySetp}),class:"w-2rem h-2rem"},null,8,["disabled"])])])):D("",!0),(n(!0),f(F,null,X((z=i.value)==null?void 0:z.types,(T,U)=>(n(),f("div",{key:T.id},[et(e("div",null,[e("label",el,o(U+1)+". "+o(W(T,"typeName")),1),e("div",tl,[(n(!0),f(F,null,X(T.dishes,(J,de)=>(n(),Q(t(P),{key:de,onClick:me=>K(T,de,y.value==0?T.maxQuantity:T.maxQuantity*y.value),class:ce([{"p-button-primary":j(J),"p-button-outlined":!j(J)},"m-1"])},{default:N(()=>[e("p",{class:ce({"text-gray-700":!j(J)})},o(W(J,"name")),3)]),_:2},1032,["onClick","class"]))),128))])],512),[[tt,T.enable]])]))),128)),q.currentCustomDish.initialPrice!==0?(n(),f("div",sl,[e("label",ll,o(c.$t("common.price"))+":",1),e("label",al,o(V.value+"â‚¬"),1)])):D("",!0),e("div",nl,[b(t(P),{icon:"pi pi-shopping-cart",onClick:g[4]||(g[4]=T=>se()),label:c.$t("common.addToCart"),class:"m-3",severity:"primary",raised:""},null,8,["label"])])])}}},il=ge(ol,[["__scopeId","data-v-e97559ab"]]),rl={class:"flex flex-column gap-3"},ul={class:"flex flex-column gap-2"},cl={for:"email"},dl={class:"flex flex-column gap-2"},ml={for:"password"},fl={key:0,class:"text-red-500 text-sm"},vl={class:"flex justify-content-end gap-2"},hl={__name:"LoginDialog",props:{visible:{type:Boolean,default:!1}},emits:["update:visible","login-success"],setup(q,{emit:H}){const{t:$}=ue(),L=q,_=H,C=w(""),i=w(""),R=w(!1),y=w("");ve(()=>L.visible,I=>{I&&V()});function V(){C.value="",i.value="",y.value="",R.value=!1}function E(){_("update:visible",!1),V()}async function O(){if(!C.value||!i.value){y.value=$("common.auth.emailPasswordRequired");return}R.value=!0,y.value="";try{const I=await k.login(C.value,i.value);I.success?(_("login-success"),_("update:visible",!1)):y.value=I.error||$("common.auth.loginFailed")}catch(I){y.value=$("common.auth.loginFailed"),console.error("Login error:",I)}finally{R.value=!1}}return(I,A)=>(n(),Q(t(fe),{visible:q.visible,"onUpdate:visible":A[2]||(A[2]=W=>I.$emit("update:visible",W)),header:I.$t("common.auth.login"),modal:!0,dismissableMask:!0,style:{width:"90vw",maxWidth:"25rem"},onHide:V},{footer:N(()=>[e("div",vl,[b(t(P),{label:I.$t("common.cancel"),severity:"secondary",onClick:E,disabled:R.value},null,8,["label","disabled"]),b(t(P),{label:I.$t("common.auth.login"),onClick:O,loading:R.value},null,8,["label","loading"])])]),default:N(()=>[e("div",rl,[e("div",ul,[e("label",cl,o(I.$t("common.auth.email")),1),b(t(Pe),{id:"email",modelValue:C.value,"onUpdate:modelValue":A[0]||(A[0]=W=>C.value=W),type:"email",placeholder:I.$t("common.auth.emailPlaceholder"),class:"w-full",disabled:R.value},null,8,["modelValue","placeholder","disabled"])]),e("div",dl,[e("label",ml,o(I.$t("common.auth.password")),1),b(t(it),{id:"password",modelValue:i.value,"onUpdate:modelValue":A[1]||(A[1]=W=>i.value=W),placeholder:I.$t("common.auth.passwordPlaceholder"),feedback:!1,toggleMask:"",class:"w-full",disabled:R.value,onKeyup:st(O,["enter"]),fluid:""},null,8,["modelValue","placeholder","disabled"])]),y.value?(n(),f("div",fl,o(y.value),1)):D("",!0)])]),_:1},8,["visible","header"]))}},pl={key:0,class:"flex flex-column gap-4"},yl={class:"flex justify-content-center"},gl={class:"flex flex-column gap-3"},bl={class:"flex flex-column gap-1"},_l={class:"text-sm text-color-secondary"},xl={class:"text-lg font-semibold"},kl={class:"flex flex-column gap-1"},wl={class:"text-sm text-color-secondary"},$l={class:"text-lg"},Dl={class:"flex flex-column gap-1"},Il={class:"text-sm text-color-secondary"},Cl={class:"text-lg"},Tl={key:0,class:"flex flex-column gap-1"},Nl={class:"text-sm text-color-secondary"},ql={class:"text-sm text-color-secondary"},Sl={__name:"UserInfoDialog",props:{visible:{type:Boolean,default:!1},user:{type:Object,default:null}},emits:["update:visible"],setup(q,{emit:H}){const{t:$}=ue(),L=q,_=H,C=w(!1),i=oe(()=>{var V;if(!((V=L.user)!=null&&V.avatar_url))return null;const y=L.user.avatar_url;return y&&(y.startsWith("http://")||y.startsWith("https://")||y.startsWith("/"))?y:null});ve(()=>L.user,y=>{if(C.value=!1,y!=null&&y.avatar_url&&i.value){const V=new Image;V.onload=()=>{C.value=!1},V.onerror=()=>{C.value=!0,console.warn("Avatar image failed to load:",y.avatar_url)},V.src=i.value}},{immediate:!0});function R(){_("update:visible",!1)}return(y,V)=>(n(),Q(t(fe),{visible:q.visible,"onUpdate:visible":V[0]||(V[0]=E=>y.$emit("update:visible",E)),header:y.$t("common.auth.userInfo"),modal:!0,dismissableMask:!0,style:{width:"90vw",maxWidth:"30rem"}},{footer:N(()=>[b(t(P),{label:y.$t("common.cancel"),severity:"secondary",onClick:R},null,8,["label"])]),default:N(()=>[q.user?(n(),f("div",pl,[e("div",yl,[b(t(Ve),{image:i.value&&!C.value?i.value:void 0,shape:"circle",size:"xlarge",class:"mb-3"},null,8,["image"])]),e("div",gl,[e("div",bl,[e("label",_l,o(y.$t("common.auth.displayName")),1),e("div",xl,o(q.user.display_name||"-"),1)]),e("div",kl,[e("label",wl,o(y.$t("common.auth.email")),1),e("div",$l,o(q.user.email||"-"),1)]),e("div",Dl,[e("label",Il,o(y.$t("common.auth.role")),1),e("div",Cl,o(q.user.role||"-"),1)]),q.user.id?(n(),f("div",Tl,[e("label",Nl,o(y.$t("common.auth.userId")),1),e("div",ql,o(q.user.id),1)])):D("",!0)])])):D("",!0)]),_:1},8,["visible","header"]))}},Al={class:"fixed top-0 left-0 w-full bg-primary-reverse",style:{"z-index":"10"}},Ml={class:"grid mt-1 ml-1"},Ll={class:"h-3rem w-3rem flex align-items-center"},Rl=["src"],Vl={class:"flex align-items-center"},Pl={key:0,class:"text-color font-bold p-1"},El={key:1,class:"text-color font-bold p-1"},jl={class:"card flex mr-3 flex align-items-center gap-2",style:{"margin-left":"auto"}},Fl={key:0},Ol={key:1},Wl={style:{display:"flex","align-items":"center"}},Ul={style:{"flex-grow":"1",width:"0",overflow:"hidden"}},Hl={class:"mt-2"},Bl={class:"flex justify-content-end mt-2"},zl={class:"flex inline-flex items-center justify-center gap-2"},Ql={class:"flex align-items-center"},Gl={class:"flex flex-column"},Kl={class:"text-sm p-2"},Jl={class:"text-sm p-2"},Xl={class:"flex items-center gap-4 mb-4 p-2"},Yl={class:"flex flex-column gap-3"},Zl={__name:"HeaderTabs",props:{types:Array,typeIndex:Number,tableId:String,tabItems:Array},emits:["clickType","switchToWelcome"],setup(q,{emit:H}){const{t:$}=ue(),L=w(!1),_=w(!1),C=w(!1),i=w(""),R=w(),y=w(!1),V=oe(()=>k.isAuthenticated()),E=oe(()=>k.authUser.value),O=oe(()=>{var d;if(!((d=E.value)!=null&&d.avatar_url))return null;const l=E.value.avatar_url;return l&&(l.startsWith("http://")||l.startsWith("https://")||l.startsWith("/"))?l:null});ve(E,l=>{if(y.value=!1,l!=null&&l.avatar_url&&O.value){const d=new Image;d.onload=()=>{y.value=!1},d.onerror=()=>{y.value=!0,console.warn("Avatar image failed to load:",l.avatar_url)},d.src=O.value}},{immediate:!0});function I(){return k.getTable()}ye(async()=>{i.value=await vt()});const A=w(),W=oe(()=>[{label:$("common.options"),items:[{label:$("common.pay"),icon:"pi pi-wallet",command:()=>{ie()}},{label:$("common.call"),icon:"pi pi-user-plus",command:()=>{k.send_cmd(I(),{cmd:"call"},l=>{l.success?Y.show_info($("notification.call_msg")):Y.show_warn(l.data)})}}]}]),G=l=>{A.value.toggle(l)},K=l=>{j.value.toggle(l)},j=w(),se=w(!1),Z=w(),ee=w();function ie(){se.value=!0}function te(){l(Z.value)?k.send_cmd(I(),{cmd:"pay",nif:Z.value,note:ee.value},d=>{d.success?(Y.show_info($("notification.pay_msg")),se.value=!1):Y.show_error($("common.failed"))}):Y.show_warn($("notification.cancel_msg"));function l(d){return!d||d.toString().length===9||d.toString().length===0}}function u(){ee.value&&(ee.value=void 0)}function S(){L.value=!0}const v=oe(()=>[{label:$("common.auth.userInfo"),icon:"pi pi-user",command:()=>{C.value=!0}},{separator:!0},{label:$("common.auth.logout"),icon:"pi pi-sign-out",command:()=>{k.logout(),Y.show_info($("common.auth.logoutSuccess"))}}]);function c(l){R.value.toggle(l)}function g(){var l;_.value=!1,Y.show_info($("common.auth.loginSuccess")),console.log("Login success, user:",k.authUser.value),console.log("Avatar URL:",(l=k.authUser.value)==null?void 0:l.avatar_url)}return(l,d)=>(n(),f(F,null,[e("div",Al,[e("div",Ml,[e("div",Ll,[e("img",{src:i.value,class:"h-full w-full",onClick:d[0]||(d[0]=()=>l.$emit("switchToWelcome"))},null,8,Rl)]),e("div",Vl,[q.tableId?(n(),f("p",Pl,o(l.$t("common.table"))+": "+o(q.tableId),1)):D("",!0),q.tableId?D("",!0):(n(),f("p",El,o(l.$t("common.takeAway")),1))]),e("div",jl,[V.value?E.value?(n(),f("div",Ol,[b(t(Ve),{image:O.value,shape:"circle",size:"large",onClick:c,style:{cursor:"pointer"}},null,8,["image"]),b(t(qe),{ref_key:"userMenu",ref:R,id:"user_menu",model:v.value,popup:!0},null,8,["model"])])):D("",!0):(n(),f("div",Fl,[b(t(P),{label:t($)("common.auth.login"),icon:"pi pi-sign-in",onClick:d[1]||(d[1]=r=>_.value=!0)},null,8,["label"])])),q.tableId?(n(),Q(t(P),{key:2,icon:"pi pi-bell",rounded:"","aria-label":"Filter",onClick:G,"aria-haspopup":"true","aria-controls":"overlay_menu"})):(n(),Q(t(P),{key:3,icon:"pi pi-question",rounded:"",onClick:S})),b(t(qe),{ref_key:"menu",ref:A,id:"overlay_menu",model:W.value,popup:!0},null,8,["model"])])]),e("div",Wl,[e("div",null,[b(t(P),{icon:"pi pi-bars",variant:"text",rounded:"","aria-label":"Filter",onClick:K,"aria-haspopup":"true","aria-controls":"tab_menu"}),b(t(qe),{ref_key:"tabMenu",ref:j,id:"tab_menu",model:q.tabItems,popup:!0},null,8,["model"])]),e("div",Ul,[b(t(ct),{value:q.typeIndex,scrollable:"",showNavigators:!1},{default:N(()=>[b(t(rt),null,{default:N(()=>[(n(!0),f(F,null,X(q.types,(r,h)=>(n(),Q(t(ut),{value:h,onClick:()=>l.$emit("clickType",h),class:"text-sm md:text-lg lg:text-xl"},{default:N(()=>[he(o(r),1)]),_:2},1032,["value","onClick"]))),256))]),_:1})]),_:1},8,["value"])])])]),b(t(fe),{visible:se.value,"onUpdate:visible":d[5]||(d[5]=r=>se.value=r),header:"ç»“è´¦",class:"flex flex-column",modal:!0,dismissableMask:!0,onHide:u},{default:N(()=>[e("div",null,[d[9]||(d[9]=e("label",null,"NIF:",-1)),b(t(dt),{modelValue:Z.value,"onUpdate:modelValue":d[2]||(d[2]=r=>Z.value=r),inputId:"withoutgrouping",useGrouping:!1,fluid:"",class:"w-full m-1"},null,8,["modelValue"])]),e("div",Hl,[e("label",null,o(l.$t("common.note"))+":",1),b(t(Pe),{type:"text",modelValue:ee.value,"onUpdate:modelValue":d[3]||(d[3]=r=>ee.value=r),class:"w-full m-1"},null,8,["modelValue"])]),e("div",Bl,[b(t(P),{label:t($)("common.send"),onClick:d[4]||(d[4]=r=>te())},null,8,["label"])])]),_:1},8,["visible"]),b(t(fe),{visible:L.value,"onUpdate:visible":d[6]||(d[6]=r=>L.value=r),modal:"",dismissableMask:"",class:"h-full",style:{width:"90vw",maxWidth:"40rem",minWidth:"20rem"},draggable:!1},{header:N(()=>[e("div",zl,[b(t(Ve),{icon:"pi pi-question",shape:"circle"}),e("span",Ql,o(t($)("takeawayHelper.dialogTitle")),1)])]),default:N(()=>[e("div",Gl,[e("span",Kl,o(t($)("takeawayHelper.introduction")),1),e("span",Jl,o(t($)("takeawayHelper.note_t"))+" "+o(t($)("takeawayHelper.note_1")),1),e("div",Xl,[b(t(Re),{class:"w-full max-w-xl mx-auto"},{default:N(()=>[b(t(Ae),{value:"0"},{default:N(()=>[b(t(Me),{class:"text-sm"},{default:N(()=>[he(o(t($)("takeawayHelper.question_1")),1)]),_:1}),b(t(Le),{class:"p-1"},{default:N(()=>[e("div",Yl,[e("span",null,o(t($)("takeawayHelper.q_1_request_1")),1),e("span",null,o(t($)("takeawayHelper.q_1_request_2")),1),e("span",null,o(t($)("takeawayHelper.q_1_request_3")),1),e("span",null,o(t($)("takeawayHelper.q_1_request_4")),1),e("span",null,o(t($)("takeawayHelper.q_1_request_5")),1)])]),_:1})]),_:1})]),_:1})])])]),_:1},8,["visible"]),b(hl,{visible:_.value,"onUpdate:visible":d[7]||(d[7]=r=>_.value=r),onLoginSuccess:g},null,8,["visible"]),b(Sl,{visible:C.value,"onUpdate:visible":d[8]||(d[8]=r=>C.value=r),user:E.value},null,8,["visible","user"])],64))}},ea={__name:"SwipeHint",props:{size:{type:String,default:"8rem"},duration:{type:Number,default:6e3},position:{type:String,default:"bottom"}},setup(q){const H=q,$=w(!0);ye(()=>{H.duration>0&&setTimeout(()=>{$.value=!1},H.duration);const _=()=>{$.value=!1,window.removeEventListener("touchstart",_)};window.addEventListener("touchstart",_)});const L=oe(()=>{let _={left:"50%",transform:"translateX(-50%)",zIndex:99999,opacity:.5,pointerEvents:"none",textAlign:"center",position:"fixed"};return H.position==="top"?_.top="15%":H.position==="center"?(_.top="50%",_.transform="translate(-50%, -50%)"):_.bottom="15%",_});return(_,C)=>$.value?(n(),f("div",{key:0,class:"swipe-hint",style:we(L.value)},[e("div",{class:"hand",style:we({width:q.size,height:q.size,backgroundImages:"url(/images/hand_finger.png)"})},null,4)],4)):D("",!0)}},ta=ge(ea,[["__scopeId","data-v-30a48de8"]]),sa={class:"w-full h-full flex flex-column p-1"},la={class:"swiper-container-wrapper"},aa={class:"fixed bottom-0 left-0 w-full h-3rem bg-primary-reverse p-3 z-[9999]"},na={class:"h-full flex align-items-center justify-content-between w-full"},oa={class:"m-2"},ia={class:"m-2"},ra={class:"m-2"},ua={style:{"max-height":"60vh","overflow-y":"auto","padding-bottom":"60px"}},ca={class:"flex flex-column border-bottom-1"},da={key:0,class:"flex justify-content-between"},ma={class:"flex flex-column"},fa={class:"font-bold"},va={class:"text-right"},ha={key:1,class:"flex justify-content-between"},pa={class:"flex flex-column"},ya={class:"font-bold"},ga={class:"text-right"},ba={key:0},_a={key:1,class:"flex flex-column"},xa={class:"flex flex-column"},ka={class:"font-bold"},wa={class:"text-right"},$a={class:"total-footer bg-primary-reverse"},Da={__name:"HomePage",setup(q){const H=Be(),$=at(),{t:L}=ue(),{locale:_}=ue(),C=w(0),i=w(!1),R=w([""]),y=w(0),V=ne.cartItemCount,E=w(!1),O=w([]),I=w(0),A=w({}),W=w(!1),G=B.dishDatas,K=w(k.getOrderMenuTab()),j=w(null),se=w(null),Z=w([]),ee=w([]),ie=w([]),te=w(!1);let u=null;const S=s=>{y.value=s.activeIndex,De()},v=s=>{u=s};ve(y,s=>{u&&u.activeIndex!==s&&u.slideTo(s);let a=k.getOrderMenuTab()[s];k.customDishAPI.customDishes.value.map(p=>p.name).includes(a)?(W.value=!0,A.value=k.customDishAPI.customDishes.value.find(p=>p.name==a)):W.value=!1});const c=(s,a,m,p)=>{k.rateDish(s,a,m),p&&Y.show_success(L("notification.rating_submitted"))},g=(s,a,m)=>{if(A.value.name=="XIAOXIONGÂ® RAMEN"&&s.id===1){const p=s.dishes[a];let M;p.dishid==47?m?M=l(3,!0,1):M=l(3,!1,1):M=l(3,!0,1),M!==void 0&&d(M)}if(A.value.name=="Menu AlmoÃ§o"&&s.id===3){const p=s.dishes[a];let M;[1427,41].includes(p.dishid)?m?M=l(4,!0,0):M=l(4,!1,0):M=l(4,!0,0),M!==void 0&&d(M)}};function l(s,a,m){if(A.value={...A.value,types:A.value.types.map(p=>p.id===s?{...p,enable:a,minQuantity:a?m:0}:p)},a===!1)return s}function d(s){!A.value||!Array.isArray(A.value.types)||(A.value={...A.value,types:A.value.types.map(a=>a.id===s?{...a,dishes:a.dishes.map(m=>({...m,selected:!1}))}:a)})}function r(s){let a=k.getOrderMenuTab()[s];if(k.customDishAPI.customDishes.value.map(re=>re.name).includes(a)?(W.value=!0,A.value=k.customDishAPI.customDishes.value.find(re=>re.name==a)):W.value=!1,k.getMenu().length==0){console.log("exit");return}let M=G.value[s].mainDishes;B.showDishList(M)}const h=()=>{k.refreshTableFromServer(),k.getTableTotalAmount(I),E.value=!0},x=s=>{let a=s.id;s.org_id&&(a=s.org_id);for(let m=0;m<G.value.length;m++)if(G.value[m].id==a)for(const p in s){let M=p;p.startsWith("note")&&(M=M.replace("note","description")),G.value[m][M]=s[p]}};function z(){return new Promise(s=>{let a=()=>{const m=k.formatedMenu.value;m.length>0?s(m):setTimeout(a,200)};a()})}function T(){return new Promise(s=>{let a=()=>{const m=k.getOrderMenuTab();m.length>0?s(m):setTimeout(a,200)};a()})}const U=oe(()=>s=>{const a=k.dictinaryAPI.dictinary.value.find(m=>m.refName===s);return a?a[`text_${_.value.toLowerCase()}`]:s});ve([()=>k.formatedMenu.value,()=>_.value],([s,a])=>{if(!s||s.length===0){ie.value=[];return}const m={};k.orderMenuTab.value;const p=s.map(ae=>({...ae,mainDishes:ae.dishes.map(pe=>{const le=pe.dish;if(m[le.id])return m[le.id];const Te={...le,defaultName:le.name,defaultSubname:le.subname,name:J(le,"name",a),note:J(le,"note",a),subname:J(le,"subname",a),quantity:0},Xe=pe.subItems.map(Fe=>{const xe=Fe;return{...Fe,defaultName:le.name,defaultSubname:xe.subname,name:J(xe,"name",a),note:J(xe,"note",a),subname:J(xe,"subname",a),quantity:0}}),Ne={...pe,dish:Te,subItems:Xe};return m[Ne.id]=Ne,Ne})}));G.value.length;const M=B.getAllIncrementedDish();B.getIdsAndQuantity(M);const re=ne.cartDishs.value;Se.compressToEncodedURIComponent(JSON.stringify(re)),ie.value=p,G.value=ie.value,R.value=k.orderMenuTab.value,(M.length>0||re.length>0)&&(B.cleanDishDataQty(),B.updateDishDataQty(M)),k.filterMenuTabs(te.value),console.log("languagedMenu updated via watch:",ie.value),Oe(()=>{C.value++,u&&typeof u.updateDictionaryWord=="function"&&(u.updateDictionaryWord(),u.slideTo(y.value))})},{immediate:!0,deep:!0}),ve(()=>k.orderMenuTab.value,s=>{K.value=s.map(a=>{const m=k.dictinaryAPI.dictinary.value.find(p=>p.refName===a);return m?m[`text_${_.value.toLowerCase()}`]:a}),O.value=me(s),y.value=0}),ye(()=>{const s=k.orderMenuTab.value;K.value=s.map(a=>{const m=k.dictinaryAPI.dictinary.value.find(p=>p.refName===a);return m?m[`text_${_.value.toLowerCase()}`]:a}),O.value=me(s),y.value=0});function J(s,a,m){return s?m==="en"?s[`${a}_en`]||s[a]:m==="zh"&&s[`${a}_cn`]||s[a]:""}async function de(){await z();const s=await T();k.onMenuItemChanged=x,Je(),O.value=me(s)}function me(s){const a=[];for(let m=0;m<s.length;m++){const p=m;a.push({label:U.value(s[m]),command:()=>{Ee(p),De()}})}return a}const De=()=>{Oe(()=>{const s=document.querySelector(".p-tablist-viewport"),a=document.querySelector(".p-tab.p-tab-active");if(s&&a){const m=a.offsetLeft-s.offsetWidth/2+a.offsetWidth/2;s.scrollTo({left:m,behavior:"smooth"})}window.scrollTo({top:0,behavior:"smooth"})})},Ee=s=>{r(s),y.value=s,De()},ze=()=>{var s=B.getAllIncrementedDish();se.value.showDishList(s)};function Ie(){return k.getTable()}k.params.port,j.value=k.table.value.order;const Qe=(s,a)=>{const m=[];for(let ae=0;ae<ne.cartDishs.value.length;ae++){var p=ne.cartDishs.value[ae];const pe=k.formateCustomDishNotes(p),le=p.dis_count?p.dis_price:p.price;m.push({dishid:p.dishid,name:p.name,quantity:p.count,notes:pe,limit:p.limit,price:le,dishNote:p.dishNote,category:p.category})}const M=B.getAllIncrementedDish();for(let ae=0;ae<M.length;ae++){var p=M[ae];if(p.quantity>0){const le=p.dis_count?p.dis_price:p.price,Te=k.getDishNameDefaultName(p);m.push({dishid:p.id,name:Te,quantity:p.quantity,limit:p.limit,price:le,dishNote:p.dishNote})}}if(m.length===0)return Y.show_warn(L("notification.select_at_least_one")),!1;console.log("cart item:",m);const re=Date.now().toString(36)+Math.random().toString(36).substring(2,5);return i.value=!0,k.submit_order({uniCode:re,name:s.name,note:s.note,table:Ie(),items:m},ae=>{a(ae)}),!0};function Ge(){const s=$e.getCookie("language");s&&(_.value=s)}function je(){for(let s=0;s<G.value.length;s++){const a=G.value[s];a.quantity=0}i.value=!1,ne.cleanAll()}ye(async()=>{Ge(),await de(),r(y.value),k.clear_order_data=()=>{je()},k.setOnOrderConfirmed(s=>{je();const a=s;Y.show_success(L("notification.order_submitted",{id:a}))}),k.setOnShowError(s=>{i.value=!1;let a=s;if(typeof s=="string"&&s.startsWith("COOLING_LIMIT:")){const m=s.split(":");m.length===3&&(a=L("notification.order_cooling_wait",{coolingTime:m[1],remaining:m[2]}))}Y.show_error(L("notification.order_failed")+": "+a)})});function Ke(){$e.deleteCookie("login_time");const s=$.query.table;s?H.push({path:"/",query:{table:s}}):H.push({path:"/takeReserve"})}async function be(s,a=!0){const m=a?ne.cartDishs.value:B.getIdsAndQuantity(B.getAllIncrementedDish()),p=Se.compressToEncodedURIComponent(JSON.stringify(m));try{await He.setItem(s,p)}catch(M){console.error("ä¿å­˜åˆ° localForage å¤±è´¥:",M)}}function Ce(){k.isTakeaway()?(be("take_cartDish_normal",!1),be("take_cartDish_custom",!0)):(be("cartDish_normal",!1),be("cartDish_custom",!0))}async function _e(s,a=!0){try{const m=await He.getItem(s);if(!m)return;const p=JSON.parse(Se.decompressFromEncodedURIComponent(m));p&&p!=="undefined"&&(a?ne.cartDishs.value=p:B.updateDishDataQty(p))}catch(m){console.error("ä»Ž localForage è¯»å–å¤±è´¥æˆ–è§£æžå¤±è´¥:",m)}}function Je(){k.isTakeaway()?(_e("take_cartDish_normal",!1),_e("take_cartDish_custom")):(_e("cartDish_normal",!1),_e("cartDish_custom"))}return lt(()=>{Ce()}),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&Ce()}),window.addEventListener("beforeunload",s=>{Ce(),k.cleanup()}),(s,a)=>(n(),f(F,null,[e("div",sa,[(n(),Q(Zl,{key:C.value,types:K.value,typeIndex:y.value,tabItems:O.value,tableId:Ie(),onClickType:Ee,onSwitchToWelcome:Ke},null,8,["types","typeIndex","tabItems","tableId"])),a[4]||(a[4]=e("div",{class:"pb-8"},null,-1)),a[5]||(a[5]=e("div",{class:"pb-4 sm:pb-5 md:pb-5 lg:pb-5"},null,-1)),b(ta,{duration:3e3,position:"center",size:"3rem"}),e("div",la,[(n(),Q(t(ht),{key:`swiper-${K.value.length}-${C.value}`,"space-between":20,"centered-slides":"","grab-cursor":!0,class:"w-full",autoHeight:!0,onSlideChange:S,onSwiper:v,"initial-slide":y.value},{default:N(()=>[(n(!0),f(F,null,X(K.value,(m,p)=>(n(),Q(t(pt),{key:p},{default:N(()=>[Math.abs(y.value-p)<=1&&(!W.value||y.value!==p)?(n(),Q(as,{key:0,rateDish:c,likedItemsRef:Z.value,dislikedItemsRef:ee.value,tabIndex:p,onlyVeg:te.value},null,8,["likedItemsRef","dislikedItemsRef","tabIndex","onlyVeg"])):Math.abs(y.value-p)<=1&&W.value&&y.value===p?(n(),Q(il,{key:1,currentCustomDish:A.value,onTypeClick:g,tabindex:p},null,8,["currentCustomDish","tabindex"])):D("",!0)]),_:2},1024))),128))]),_:1},8,["initial-slide"]))]),a[6]||(a[6]=e("div",{style:{height:"60px"}},null,-1)),e("div",aa,[e("div",na,[e("div",oa,[t(k).isTakeaway()?D("",!0):(n(),Q(t(P),{key:0,label:s.$t("common.orders"),icon:"pi pi-list",class:"p-button-secondary",onClick:h},null,8,["label"]))]),e("div",ia,[b(t(mt),{class:"text-sm",modelValue:te.value,"onUpdate:modelValue":a[0]||(a[0]=m=>te.value=m),onLabel:t(L)("common.showAll"),offLabel:t(L)("common.showOnlyVegetables"),onClick:a[1]||(a[1]=m=>t(k).filterMenuTabs(te.value))},null,8,["modelValue","onLabel","offLabel"])]),e("div",ra,[b(t(ft),{value:t(V),severity:"danger",onClick:ze},{default:N(()=>a[3]||(a[3]=[e("i",{class:"pi pi-shopping-cart",style:{"font-size":"2rem"}},null,-1)])),_:1,__:[3]},8,["value"])])])])]),b(Ls,{ref_key:"cartRef",ref:se,checkout:Qe,isTakeaway:!Ie()},null,8,["isTakeaway"]),b(t(fe),{visible:E.value,"onUpdate:visible":a[2]||(a[2]=m=>E.value=m),header:s.$t("common.completedOrders"),modal:"",style:{width:"80vw","max-width":"700px"}},{default:N(()=>{var m,p;return[e("div",ua,[e("div",ca,[(m=I.value.adultPrice)!=null&&m.quantity&&I.value.adultPrice.quantity!=0?(n(),f("div",da,[e("div",ma,[e("span",fa,o(s.$t("common.adult")),1),e("small",null,o(s.$t("common.quantity"))+": "+o(I.value.adultPrice.quantity),1)]),e("div",va,[e("span",null,"â‚¬"+o((Number(I.value.adultPrice.price)*I.value.adultPrice.quantity).toFixed(2)),1)])])):D("",!0),(p=I.value.childrenPrice)!=null&&p.quantity&&I.value.childrenPrice.quantity!=0?(n(),f("div",ha,[e("div",pa,[e("span",ya,o(s.$t("common.children")),1),e("small",null,o(s.$t("common.quantity"))+": "+o(I.value.childrenPrice.quantity),1)]),e("div",ga,[e("span",null,"â‚¬"+o((Number(I.value.childrenPrice.price)*I.value.childrenPrice.quantity).toFixed(2)),1)])])):D("",!0)]),t(k).table.value.order.length===0?(n(),f("div",ba,o(s.$t("common.noOrders")),1)):(n(),f("div",_a,[(n(!0),f(F,null,X(t(k).table.value.order,(M,re)=>(n(),f("div",{key:re,class:"flex justify-content-between border-bottom-1 pb-2"},[e("div",xa,[e("span",ka,o(t(k).getDishName(M)),1),e("small",null,o(s.$t("common.quantity"))+": "+o(M.quantity),1)]),e("div",wa,[e("span",null,"â‚¬"+o((M.price*M.quantity).toFixed(2)),1)])]))),128))]))]),e("div",$a,o(s.$t("common.total"))+": â‚¬"+o(I.value.total),1)]}),_:1},8,["visible","header"])],64))}},Ma=ge(Da,[["__scopeId","data-v-3d81f539"]]);export{Ma as default};
