import{s as se}from"./index-C19lq8BG.js";import{s as le}from"./index-B7t8Y0jl.js";import{s as oe,a as re}from"./index-BPyAhZbY.js";import{b as ne}from"./index-aRuk0YC6.js";import{q as ie,h as m,n as b,s as de,c as f,a,d as r,w as n,l as e,F as M,o as h,A as z,z as B,t as o,a2 as p,e as ue,E as L,G as c}from"./index-03kj4q_y.js";import{s as H,a as u}from"./index-iqcPE5v2.js";import{s as pe}from"./index-DCYHO3kY.js";import{s as j}from"./index-0YIcUau5.js";import"./index-CPlFvjf0.js";import"./index-k5eP9wVx.js";import"./index-DUeqImVQ.js";import"./index-CB7OQKgK.js";import"./index-CXM95uo_.js";import"./index-6HtNcxhN.js";import"./index-CwbnHJVg.js";import"./index-DMewZFeB.js";import"./index-CzOiUYHx.js";import"./index-BitoHgH8.js";const ce={class:"h-full"},ve={class:"flex flex-column gap-2"},me={class:"flex justify-content-between"},ye={class:"flex gap-2 align-items-center"},fe={class:"m-0 font-bold text-2xl text-left flex-grow-1"},he={class:"font-bold"},_e={class:"font-bold"},ge=["onClick"],be={class:"text-center py-5"},we={class:"mt-3 text-gray-500"},ke={class:"mb-3"},Pe={class:"text-lg font-bold"},xe={class:"mb-3"},Se={key:0,class:"mb-3"},Ce={style:{color:"#5F0F0F"}},Me={style:{"white-space":"normal","word-break":"break-word",color:"#5F0F0F"}},Te={class:"font-semibold"},Ne={class:"flex justify-between text-gray-600 text-sm gap-4"},Fe={class:"flex justify-content-end"},Ae={class:"h-full"},$e=["onClick"],Ve={class:"text-center py-5"},Oe={class:"mt-3 text-gray-500"},et={__name:"TakeawaysPage",setup(Ue){const{t:s}=ie(),w=m({global:{value:null,matchMode:c.CONTAINS},id:{value:null,matchMode:c.STARTS_WITH},date:{value:null,matchMode:c.STARTS_WITH},time:{value:null,matchMode:c.IN},customer:{value:null,matchMode:c.EQUALS},total_price:{value:null,matchMode:c.EQUALS},pay_state:{value:null,matchMode:c.EQUALS},pay_ttpe:{value:null,matchMode:c.EQUALS}}),_=b.shopify_orders,g=m(!1),d=m(null),k=m(!1),v=m(null),Q=de(()=>[{label:s("orderPage.completed"),value:"completed"},{label:s("orderPage.read"),value:"read"},{label:s("orderPage.new"),value:"new"},{label:s("orderPage.voided"),value:"voided"}]);function T(i){if(i.pay_state=="voided"){i.status="voided";return}d.value=i,g.value=!1,v.value=i.status,k.value=!0}function q(){v.value!==null&&(d.value.status!==v.value&&((d.value.status==="new"||!d.value.status)&&b.updateNewOrderCount("takeaway",-1),v.value==="new"&&b.updateNewOrderCount("takeaway",1),d.value.status=v.value),k.value=!1)}function N(i){d.value=i.data,g.value=!0,(d.value.status==="new"||!d.value.status)&&(d.value.isNew=void 0,b.updateNewOrderCount("takeaway",-1),d.value.status="read")}const F=i=>({completed:"status-completed",read:"status-read",new:"status-new",voided:"status-voided"})[i]||"",A=i=>({completed:s("orderPage.completed"),read:s("orderPage.read"),new:s("orderPage.new"),voided:s("orderPage.voided")})[i]||i;function K(i){b.print_takeaway_order(i),g.value=!1}const x=m(!1);function W(){let i=0;return _.value.forEach(l=>{l.status!="voided"&&l.pay_state!="voided"&&i++}),i}function G(){let i=0;return _.value.forEach(l=>{i+=Number(l.total_price?l.total_price:0)}),i}const S=m(!1);function J(){S.value=!0}return(i,l)=>{const C=ne,X=re,Y=oe,Z=le,$=se;return h(),f(M,null,[a("div",ce,[r(e(H),{value:e(_),tableStyle:"min-width: 50rem",dataKey:"id",paginator:"",rows:10,rowsPerPageOptions:[5,10,20,50],stripedRows:"",filters:w.value,scrollable:"",scrollHeight:"flex",onRowClick:N,selectionMode:"single"},{header:n(()=>[a("div",ve,[a("div",me,[a("div",ye,[a("h4",fe,o(e(s)("takeawaysPage.orders")),1),r(C,{text:"",icon:"pi pi-window-maximize",severity:"contrast",disabled:!e(_).length,onClick:J},null,8,["disabled"])]),r(Y,null,{default:n(()=>[r(X,null,{default:n(()=>l[8]||(l[8]=[a("i",{class:"pi pi-search"},null,-1)])),_:1,__:[8]}),r(e(pe),{modelValue:w.value.global.value,"onUpdate:modelValue":l[0]||(l[0]=t=>w.value.global.value=t),placeholder:e(s)("orderPage.find")},null,8,["modelValue","placeholder"])]),_:1})]),a("div",null,[r(C,{class:"flex flex-wrap justify-content-start p-2",severity:"contrast",outlined:"",onClick:l[1]||(l[1]=t=>x.value=!0)},{default:n(()=>[a("label",he,"成功下单数："+o(W()),1),l[9]||(l[9]=a("label",{class:"font-bold"},"丨",-1)),a("label",_e,"总成交额：€"+o(G().toFixed(2)),1),l[10]||(l[10]=a("i",{class:"pi pi-window-maximize"},null,-1))]),_:1,__:[9,10]})])])]),empty:n(()=>[a("div",be,[l[11]||(l[11]=a("i",{class:"pi pi-search",style:{"font-size":"3rem",color:"#ccc"}},null,-1)),a("p",we,o(e(s)("orderPage.notFound")),1)])]),default:n(()=>[r(e(u),{header:e(s)("orderPage.status")},{body:n(({data:t})=>[a("span",{class:B(["status-badge",F(t.status||"new")]),onClick:z(P=>T(t),["stop"])},o(A(t.status||"new")),11,ge)]),_:1},8,["header"]),r(e(u),{field:"name",header:e(s)("takeawaysPage.orderNumber"),sortable:""},{body:n(({data:t})=>[a("span",{style:p({"text-decoration":t.status=="voided"?"line-through":"none"})},o(t.name),5)]),_:1},8,["header"]),r(e(u),{field:"pickupDate",header:e(s)("takeawaysPage.date"),sortable:""},null,8,["header"]),r(e(u),{field:"pickupTime",header:e(s)("takeawaysPage.time"),sortable:""},null,8,["header"]),r(e(u),{field:"customer.name",header:e(s)("takeawaysPage.customer"),sortable:""},null,8,["header"]),r(e(u),{field:"total_price",header:e(s)("takeawaysPage.totalPrice"),sortable:""},{body:n(({data:t})=>[a("span",{style:p({"text-decoration":t.status=="voided"?"line-through":"none"})}," €"+o(t.total_price?t.total_price:0),5)]),_:1},8,["header"]),r(e(u),{field:"pay_state",header:e(s)("takeawaysPage.payState"),sortable:""},{body:n(({data:t})=>[a("span",{style:p({"text-decoration":t.status=="voided"?"line-through":"none"})},o(e(s)("takeawaysPage.statePayment."+t.pay_state)),5)]),_:1},8,["header"]),r(e(u),{field:"pay_type",header:e(s)("takeawaysPage.payType"),sortable:""},{body:n(({data:t})=>[a("span",{style:p({"text-decoration":t.status=="voided"?"line-through":"none"})},o(e(s)("takeawaysPage.statePaymentType."+t.pay_type.replaceAll(" ","_"))),5)]),_:1},8,["header"])]),_:1},8,["value","filters"])]),r(e(j),{visible:g.value,"onUpdate:visible":l[3]||(l[3]=t=>g.value=t),header:e(s)("takeawaysPage.orderDetails"),modal:"",style:{width:"450px"}},{default:n(()=>{var t,P,V,O,U,D,E,I,R;return[a("div",ke,[a("h3",Pe,o(e(s)("takeawaysPage.orderNumber"))+" : "+o((t=d.value)==null?void 0:t.name),1)]),a("div",xe,[a("div",null,o(e(s)("takeawaysPage.name"))+": "+o((V=(P=d.value)==null?void 0:P.customer)==null?void 0:V.name),1),a("div",null,o(e(s)("takeawaysPage.phone"))+": "+o((U=(O=d.value)==null?void 0:O.customer)==null?void 0:U.phone),1),a("div",null,o(e(s)("takeawaysPage.email"))+": "+o((E=(D=d.value)==null?void 0:D.customer)==null?void 0:E.email),1)]),(I=d.value)!=null&&I.note&&d.value.note!==""?(h(),f("div",Se,[a("div",Ce,o(e(s)("orderPage.notes"))+":",1),a("div",Me,o(d.value.note),1)])):ue("",!0),(h(!0),f(M,null,L((R=d.value)==null?void 0:R.line_items,(y,ee)=>(h(),f("div",{key:ee,class:"border-b py-2"},[a("div",Te,o(y.name),1),a("div",Ne,[a("span",null,o(y.sku),1),a("span",null,o(y.price)+" x "+o(y.quantity),1)]),(h(!0),f(M,null,L(y.properties,(te,ae)=>(h(),f("div",{key:ae,class:"text-sm text-gray-500"},o(te),1))),128))]))),128)),a("div",Fe,[r(C,{label:e(s)("takeawaysPage.printOrder"),onClick:l[2]||(l[2]=y=>K(d.value))},null,8,["label"])])]}),_:1},8,["visible","header"]),a("div",null,[r(e(j),{visible:k.value,"onUpdate:visible":l[5]||(l[5]=t=>k.value=t),header:e(s)("orderPage.orderStatus"),modal:!0,dismissableMask:!0},{default:n(()=>[r(Z,{modelValue:v.value,"onUpdate:modelValue":l[4]||(l[4]=t=>v.value=t),options:Q.value,optionLabel:"label",optionValue:"value",onClick:q},null,8,["modelValue","options"])]),_:1},8,["visible","header"])]),r($,{visible:x.value,"onUpdate:visible":l[6]||(l[6]=t=>x.value=t),header:e(s)("takeawaysPage.analysisHeader"),position:"full"},{default:n(()=>l[12]||(l[12]=[a("p",null,"数据..",-1)])),_:1,__:[12]},8,["visible","header"]),r($,{visible:S.value,"onUpdate:visible":l[7]||(l[7]=t=>S.value=t),position:"full",header:e(s)("takeawaysPage.orders")},{default:n(()=>[a("div",Ae,[r(e(H),{value:e(_),tableStyle:"min-width: 50rem",dataKey:"id",paginator:"",rows:10,rowsPerPageOptions:[5,10,20,50],stripedRows:"",filters:w.value,scrollable:"",scrollHeight:"flex",onRowClick:N,selectionMode:"single"},{empty:n(()=>[a("div",Ve,[l[13]||(l[13]=a("i",{class:"pi pi-search",style:{"font-size":"3rem",color:"#ccc"}},null,-1)),a("p",Oe,o(e(s)("orderPage.notFound")),1)])]),default:n(()=>[r(e(u),{header:e(s)("orderPage.status")},{body:n(({data:t})=>[a("span",{class:B(["status-badge",F(t.status||"new")]),onClick:z(P=>T(t),["stop"])},o(A(t.status||"new")),11,$e)]),_:1},8,["header"]),r(e(u),{field:"name",header:e(s)("takeawaysPage.orderNumber"),sortable:""},{body:n(({data:t})=>[a("span",{style:p({"text-decoration":t.status=="voided"?"line-through":"none"})},o(t.name),5)]),_:1},8,["header"]),r(e(u),{field:"pickupDate",header:e(s)("takeawaysPage.date"),sortable:""},null,8,["header"]),r(e(u),{field:"pickupTime",header:e(s)("takeawaysPage.time"),sortable:""},null,8,["header"]),r(e(u),{field:"customer.name",header:e(s)("takeawaysPage.customer"),sortable:""},null,8,["header"]),r(e(u),{field:"total_price",header:e(s)("takeawaysPage.totalPrice"),sortable:""},{body:n(({data:t})=>[a("span",{style:p({"text-decoration":t.status=="voided"?"line-through":"none"})}," €"+o(t.total_price?t.total_price:0),5)]),_:1},8,["header"]),r(e(u),{field:"pay_state",header:e(s)("takeawaysPage.payState"),sortable:""},{body:n(({data:t})=>[a("span",{style:p({"text-decoration":t.status=="voided"?"line-through":"none"})},o(e(s)("takeawaysPage.statePayment."+t.pay_state)),5)]),_:1},8,["header"]),r(e(u),{field:"pay_type",header:e(s)("takeawaysPage.payType"),sortable:""},{body:n(({data:t})=>[a("span",{style:p({"text-decoration":t.status=="voided"?"line-through":"none"})},o(e(s)("takeawaysPage.statePaymentType."+t.pay_type.replaceAll(" ","_"))),5)]),_:1},8,["header"])]),_:1},8,["value","filters"])])]),_:1},8,["visible","header"])],64)}}};export{et as default};
