import{s as z}from"./index-D6Tk2Gzn.js";import{s as U}from"./index-DeQhilv7.js";import{s as L}from"./index-BD_V1jqp.js";import{s as q,a as A}from"./index-BFnt7Pfi.js";import{s as E,a as j}from"./index-CfU8x9jY.js";import{s as G}from"./index-BIZYGEVw.js";import{q as H,n as o,h as c,s as K,c as h,a as l,d as s,w as r,l as J,F as _,o as g,A as Q,z as W,t as n,C as X,E as Y,e as Z,G as ee}from"./index-BULDcCGn.js";import"./index-oge4_c7I.js";import"./index-CrZnt2vz.js";import"./index-MPeAesa8.js";import"./index-kA6imsrS.js";import"./index-q9kZl5Ge.js";import"./index-6tqVHg-v.js";import"./index-BQhRBBUL.js";import"./index-R0uzDHrX.js";import"./index-CW2B1p7O.js";const te={class:"card h-full",style:{display:"flex","flex-direction":"column"}},ae={class:"flex flex-wrap gap-2 items-center justify-between"},le={class:"m-0 font-bold text-2xl text-left flex-grow-1"},se=["onClick"],oe={class:"text-center py-5"},re={class:"mt-3 text-gray-500"},ne={style:{"list-style-type":"none","padding-left":"0"}},ie={class:"flex flex-wrap p-2 items-center gap-4"},de={style:{"max-width":"200px"}},ue={key:0,style:{"max-width":"200px"}},De={__name:"OrderPage",setup(pe){const{t:u}=H(),y=o.orders,m=c(!1),i=c(null),f=c(!1),d=c(null),P=K(()=>[{label:u("orderPage.completed"),value:"completed"},{label:u("orderPage.read"),value:"readed"},{label:u("orderPage.new"),value:"new"}]),v=c({global:{value:null,matchMode:ee.CONTAINS}}),C=e=>({completed:u("orderPage.completed"),readed:u("orderPage.read"),new:u("orderPage.new")})[e]||e,$=e=>({completed:"status-completed",readed:"status-readed",new:"status-new"})[e]||"";function N(e){i.value=e,m.value=!1,d.value=e.status,f.value=!0}function S(){d.value!==null&&(i.value.status!==d.value&&(i.value.status==="new"&&o.newOrderCount.value>0&&(o.newOrderCount.value-=1),d.value==="new"&&(o.newOrderCount.value+=1),i.value.status=d.value,o.updateOrderStatus(i.value)),f.value=!1)}const x=e=>new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});function D(e){e.data?(i.value=e.data,console.log("selRow.value",i.value),m.value=!0,e.data.isNew=!1,e.data.status=="new"&&(e.data.status="readed",o.updateOrderStatus(e.data),o.decrementOrderCount())):console.error("Row data is missing in the event",e)}function k(e){return o.getDishNameById(e.dishid)}function M(e){return e.dishid?e.dishid:e.name}function V(e){return o.getDishNote(e)}return(e,a)=>{const O=j,I=G,R=E,p=A,B=q,F=L,w=U,T=z;return g(),h(_,null,[l("div",te,[s(B,{value:J(y),tableStyle:"min-width: 50rem",dataKey:"id",paginator:"",rows:5,rowsPerPageOptions:[5,10,20,50],stripedRows:"",filters:v.value,scrollable:"",scrollHeight:"flex",onRowClick:D,selectionMode:"single"},{header:r(()=>[l("div",ae,[l("h4",le,n(e.$t("orderPage.orders")),1),s(R,null,{default:r(()=>[s(O,null,{default:r(()=>a[4]||(a[4]=[l("i",{class:"pi pi-search"},null,-1)])),_:1,__:[4]}),s(I,{modelValue:v.value.global.value,"onUpdate:modelValue":a[0]||(a[0]=t=>v.value.global.value=t),placeholder:e.$t("orderPage.find")},null,8,["modelValue","placeholder"])]),_:1})])]),empty:r(()=>[l("div",oe,[a[5]||(a[5]=l("i",{class:"pi pi-search",style:{"font-size":"3rem",color:"#ccc"}},null,-1)),l("p",re,n(e.$t("orderPage.notFound")),1)])]),default:r(()=>[s(p,{field:"status",header:e.$t("orderPage.status"),sortable:"",style:{width:"10%"}},{body:r(({data:t})=>[l("span",{class:W(["status-badge",$(t.status)]),onClick:Q(b=>N(t),["stop"])},n(C(t.status)),11,se)]),_:1},8,["header"]),s(p,{field:"id",header:e.$t("orderPage.orderNumber"),sortable:"",style:{width:"10%"}},null,8,["header"]),s(p,{field:"table",header:e.$t("orderPage.tableNumber"),sortable:"",style:{width:"10%"}},null,8,["header"]),s(p,{field:"time",header:e.$t("orderPage.time"),sortable:"",style:{width:"20%"}},{body:r(({data:t})=>[X(n(x(t.timestamp)),1)]),_:1},8,["header"]),s(p,{field:"name",header:e.$t("orderPage.name"),style:{width:"15%"}},null,8,["header"]),s(p,{field:"note",header:e.$t("orderPage.notes"),style:{width:"35%"},class:"multiline-cell"},null,8,["header"])]),_:1},8,["value","filters"])]),l("div",null,[s(w,{visible:m.value,"onUpdate:visible":a[1]||(a[1]=t=>m.value=t),header:e.$t("orderPage.details"),modal:!0,dismissableMask:!0},{default:r(()=>[l("ul",ne,[(g(!0),h(_,null,Y(i.value.items,(t,b)=>(g(),h("li",{key:b},[l("div",ie,[l("label",null,n(M(t)),1),l("label",null,n(k(t)),1),l("label",null,"x "+n(t.quantity),1),l("label",de,n(V(t.notes)),1),t.dishNote?(g(),h("label",ue,n(t.dishNote),1)):Z("",!0)]),s(F)]))),128))])]),_:1},8,["visible","header"])]),l("div",null,[s(w,{visible:f.value,"onUpdate:visible":a[3]||(a[3]=t=>f.value=t),header:e.$t("orderPage.orderStatus"),modal:!0,dismissableMask:!0},{default:r(()=>[s(T,{modelValue:d.value,"onUpdate:modelValue":a[2]||(a[2]=t=>d.value=t),options:P.value,optionLabel:"label",optionValue:"value",onClick:S},null,8,["modelValue","options"])]),_:1},8,["visible","header"])])],64)}}};export{De as default};
