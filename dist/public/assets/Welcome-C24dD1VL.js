import{a as be,b as we,c as ye,d as ke,e as Ce,f as $e,g as Ie,h as Pe,i as Le,j as Ne}from"./primevue-DRc8vkgT.js";import{_ as Se,P as Te}from"./pagination-BO-ad-kk.js";import{S as Be,a as Fe}from"./pagination-ByGpG7Fh.js";import{Q as se,b as _,C as P,w as Me,e as le,n as Ue,R as Ve,S as Oe,U as Ae,f as n,v as r,h as s,a as L,s as c,B as j,t as m,M as u,F as w,y as N,o,c as D,A as R}from"./vue-BLaX11bV.js";import{c as l,C as De,a as U,m as y}from"./index-B6hkIraI.js";import{_ as Re}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-DYQJwaLu.js";const je=["src"],ze=["onClick"],Ee=["src"],He={class:"absolute top-0 border-0 right-0 p-2 flex flex-column flex align-items-center"},qe={key:0},Ge={class:"m-3 max-w-screen"},We={class:j(["w-full","p-4"])},Qe=["src"],Xe={key:0,class:"text-center p-1"},Je={key:1,class:"text-center p-1"},Ke={class:"flex flex-column justify-center"},Ye={key:0,class:"text-center"},Ze={key:1,class:"text-center"},et={class:"flex w-full"},tt={class:"flex flex-column"},st={class:"w-full text-sm break-words px-2",style:{"white-space":"pre-wrap"}},lt=["src"],at={key:0,class:"flex justify-content-end"},ot={class:"flex flex-row"},nt={class:"underline text-blue-600 text-sm"},it={class:"pt-3 pb-3"},rt={class:"flex flex-row gap-2"},ut={class:"border-400 border-round border-1 p-3"},ct={class:"text-center font-bold"},dt={key:0,class:"w-full overflow-hidden"},mt=["src"],pt={class:"w-full overflow-hidden",style:{"aspect-ratio":"2 / 1.5"}},ft=["src"],vt={class:"font-bold"},_t={class:"flex flex-column"},gt={class:"flex flex-row justify-content-between w-full"},ht=["innerHTML"],xt=["innerHTML"],bt={key:0,class:"fixed right-0 bottom-0 p-4",style:{"z-index":"2"}},wt={class:"mt-2"},yt={class:"flex justify-content-end mt-2"},kt={__name:"Welcome",setup(Ct){const k=[{label:"pt",imagePath:"flags/pt.png"},{label:"en",imagePath:"flags/en.png"},{label:"zh",imagePath:"flags/zh.png"}],z=Ae(),ae=Oe(),{locale:h}=se(),{t:p}=se(),g=_(null),S=_(!0),E=_(),H=_(""),oe=P(()=>l.getShopInfo("restaurantName")),d=_(void 0),V=P(()=>l.shopInfo.value.instagramUrl);function ne(){const e=U.getCookie("language");e&&(h.value=e)}let x=null;Me(()=>[l.currentPage.value,l.addr.value],([e,t])=>{var i,b,v;d.value=e,(b=(i=d.value)==null?void 0:i.data)!=null&&b.logoPath&&((v=d.value)!=null&&v.imagesPath)&&(H.value=l.pathFormated(d.value.data.logoPath.src,d.value.imagesPath))},{immediate:!0}),le(async()=>{var e;await Ue(),x=new IntersectionObserver(t=>{t.forEach(i=>{S.value=i.isIntersecting})},{threshold:.1}),(e=g.value)!=null&&e.$el&&x.observe(g.value.$el)}),le(async()=>{var e;l.params=l.getQueryParams(),l.params.table?l.params.table=De.SimpleDecode(l.params.table):l.params.table=void 0,ne(),l.initMenu(!0),x=new IntersectionObserver(t=>{t.forEach(i=>{i.isIntersecting?S.value=!0:S.value=!1})},{threshold:.1}),(e=g.value)!=null&&e.$el&&x.observe(g.value.$el)}),Ve(()=>{var e;x&&((e=g.value)!=null&&e.$el)&&x.unobserve(g.value.$el)});const ie=P(()=>{const e="/";switch(h.value.toLowerCase()){case"pt":return e+k[0].imagePath;case"en":return e+k[1].imagePath;case"zh":return e+k[2].imagePath;default:return e+k[1].imagePath}});function T(e){return e[`text_${h.value.toLowerCase()}`]}function q(e){const t=e[`text_${h.value.toLowerCase()}`];return t?t.replace(/\[\[(.*?)\|(.*?)\]\]/g,(i,b,v)=>`<a href="${v.startsWith("http")?v:`https://${v}`}" target="_blank" rel="noopener noreferrer" class="text-blue-500 underline cursor-pointer">${b}</a>`):""}const re=Date.now(),G=U.getCookie("login_time");let O;G&&(O=JSON.parse(G));const ue=P(()=>k.filter(e=>e.label!==h.value.toLowerCase()).map(e=>({...e,command:()=>{h.value=e.label,ce(e.label)}})));function ce(e){U.setCookie("language",e)}function B(e){typeof e=="string"&&/^(https?:\/\/)/i.test(e)?window.open(e,"_blank"):console.warn("无效的 URL:",e)}function de(){B(V.value)}const me=e=>{E.value.toggle(e)};O&&(re-O>60*5*1e3?U.clearAllCookies():A());function A(){const e=ae.query.table;if(!l.permissionsControl.value.order||!l.settings.value.order){y.show_warn(p("notification.orderClosed"));return}z.push({path:"/table",query:{table:e}})}function pe(){l.currentTableId.value=void 0,l.params.table=void 0,z.push("/takeReserve")}const fe=P(()=>[{label:p("common.options"),items:[{label:p("common.pay"),icon:"pi pi-wallet",command:()=>{ve()}},{label:p("common.call"),icon:"pi pi-user-plus",command:()=>{l.send_cmd(l.getTable(),{cmd:"call"},e=>{e.success?y.show_info(p("notification.call_msg")):y.show_info(e.data)})}}]}]);function W(e){return d.value.data.options[e]?"font-bold":""}const F=_(!1),M=_(),C=_();function ve(){F.value=!0}function _e(){e(M.value)?l.send_cmd(l.getTable(),{cmd:"pay",nif:M.value,note:C.value},t=>{t.success?(y.show_info(p("notification.pay_msg")),F.value=!1):y.show_error(p("common.failed"))}):y.show_warn(p("notification.cancel_msg"));function e(t){return!t||t.toString().length===9||t.toString().length===0}}function ge(){C.value&&(C.value=void 0)}return(e,t)=>{var X,J,K,Y,Z,ee;const i=we,b=be,v=ye,Q=Le,he=Ne,xe=Ce;return o(),n(w,null,[r(b,{model:ue.value,direction:"down",transitionDelay:80,class:"absolute top-0 left-0 border-0"},{button:c(({toggleCallback:a})=>[r(i,{outlined:"",onClick:a,class:"custom-clean-button"},{default:c(()=>[s("img",{src:ie.value,style:{width:"38px",height:"38px"}},null,8,je)]),_:2},1032,["onClick"])]),item:c(({item:a,toggleCallback:$})=>[s("div",{class:"flex flex-col items-center justify-between",onClick:$},[s("img",{src:a.imagePath,alt:"lang",style:{width:"38px",height:"38px"}},null,8,Ee)],8,ze)]),_:1},8,["model"]),s("div",He,[s("div",null,[r(i,{icon:"pi pi-bell",rounded:"","aria-label":"Filter",onClick:me,"aria-haspopup":"true","aria-controls":"overlay_menu",size:"small",style:{width:"42px",height:"42px"}}),r(v,{ref_key:"menu",ref:E,id:"overlay_menu",model:fe.value,popup:!0},null,8,["model"])]),V.value&&V.value.trim()!==""?(o(),n("div",qe,[r(i,{icon:"pi pi-instagram",class:"custom-clean-button",onClick:de})])):L("",!0)]),s("div",Ge,[s("div",We,[s("img",{src:H.value,alt:"Logo",class:"max-w-6rem h-auto w-full mx-auto block"},null,8,Qe),(J=(X=d.value)==null?void 0:X.data)!=null&&J.restaurantName?(o(),n("h3",Xe,m((Y=(K=d.value)==null?void 0:K.data)==null?void 0:Y.restaurantName),1)):(o(),n("h3",Je,m(oe.value),1)),s("div",Ke,[u(l).testEnvironment.value?(o(),n("h2",Ye,m("DEMO"))):L("",!0),u(l).testEnvironment.value?(o(),n("span",Ze,m(u(p)("home.demoDescription")),1)):L("",!0)])]),s("div",et,[r(u(ke),{class:"w-full max-w-xl mx-auto"},{default:c(()=>{var a,$;return[(o(!0),n(w,null,N(($=(a=d.value)==null?void 0:a.data)==null?void 0:$.titles,(f,te)=>(o(),D(u($e),{value:te},{default:c(()=>[r(u(Ie),null,{default:c(()=>[R(m(T(f.title)),1)]),_:2},1024),r(u(Pe),{class:"p-1"},{default:c(()=>[s("div",tt,[s("div",st,m(T(f.description)),1),s("img",{src:u(l).pathFormated(f.image.src,d.value.imagesPath),class:"max-w-5rem h-auto block mr-auto p-1 invert-image"},null,8,lt),f.title.text_zh.includes("怎么获得学生优惠")?(o(),n("div",at,[r(i,{onClick:t[0]||(t[0]=I=>B("https://xiaoxiongmarket.com/activity/29ca8401-6cd5-4bac-94f8-d5511c463e26")),text:""},{default:c(()=>[s("div",ot,[s("span",nt,m(u(p)("home.eventPage")),1),t[10]||(t[10]=s("i",{class:"pi pi-external-link text-blue-600 text-sm p-1"},null,-1))])]),_:1})])):L("",!0)])]),_:2},1024)]),_:2},1032,["value"]))),256))]}),_:1})]),s("div",it,[s("div",rt,[r(i,{onClick:t[1]||(t[1]=a=>A()),class:"w-full font-bold",style:{"border-radius":"20px"},ref_key:"orderButtonRef",ref:g},{default:c(()=>[R(m(e.$t("common.eatHere")),1)]),_:1},512),r(i,{onClick:t[2]||(t[2]=a=>pe()),class:"w-full font-bold",style:{"border-radius":"20px"}},{default:c(()=>[R(m(e.$t("common.takeOrReserve")),1)]),_:1})])]),(o(!0),n(w,null,N((ee=(Z=d.value)==null?void 0:Z.data)==null?void 0:ee.frames,(a,$)=>(o(),n("div",null,[s("div",ut,[(o(!0),n(w,null,N(a,(f,te)=>(o(),n("div",null,[s("h1",ct,m(T(f.title)),1),f.images.length<=1?(o(),n("div",dt,[s("img",{src:u(l).pathFormated(f.images[0].src,d.value.imagesPath),class:"w-full"},null,8,mt)])):(o(),D(u(Fe),{key:1,"slides-per-view":1,loop:!0,class:"w-full",modules:[u(Te)],pagination:{clickable:!0}},{default:c(()=>[(o(!0),n(w,null,N(f.images,(I,$t)=>(o(),D(u(Be),null,{default:c(()=>[s("div",pt,[s("img",{src:u(l).pathFormated(I.src,d.value.imagesPath),class:"w-full h-full",style:{"object-fit":"cover"}},null,8,ft)])]),_:2},1024))),256))]),_:2},1032,["modules"])),s("h4",vt,m(T(f.subtitle)),1),(o(!0),n(w,null,N(f.descriptions,I=>(o(),n("div",null,[s("div",_t,[s("div",gt,[s("span",{class:j([W(0),"break-words text-left"]),innerHTML:q(I.left),style:{"white-space":"pre-wrap"}},null,10,ht),s("span",{class:j([W(1),"break-words text-right"]),innerHTML:q(I.right),style:{"white-space":"pre-wrap"}},null,10,xt)])])]))),256))]))),256))]),t[11]||(t[11]=s("div",{class:"p-4"},null,-1))]))),256))]),s("div",{class:"absoluto top-0 text-center text-xs p-2 underline cursor-pointer",onClick:t[3]||(t[3]=a=>B("https://5am3eq-wc.myshopify.com/"))}," ©2025 XIAOXIONG® v1.1.114 "),s("div",{class:"absoluto top-0 text-center text-xs p-2",onClick:t[4]||(t[4]=a=>B("https://5am3eq-wc.myshopify.com/"))},t[12]||(t[12]=[s("img",{src:Se,style:{width:"7rem"}},null,-1)])),S.value?L("",!0):(o(),n("div",bt,[r(i,{rounded:"","aria-label":"Star",onClick:t[5]||(t[5]=a=>A()),class:"w-full font-bold p-button-lg shadow-6"},{default:c(()=>t[13]||(t[13]=[s("span",{class:"material-icons text-5xl"},"restaurant",-1)])),_:1,__:[13]})])),r(xe,{visible:F.value,"onUpdate:visible":t[9]||(t[9]=a=>F.value=a),header:"结账",class:"flex flex-column",modal:!0,dismissableMask:!0,onHide:ge},{default:c(()=>[s("div",null,[t[14]||(t[14]=s("label",null,"NIF:",-1)),r(Q,{modelValue:M.value,"onUpdate:modelValue":t[6]||(t[6]=a=>M.value=a),inputId:"withoutgrouping",useGrouping:!1,fluid:"",class:"w-full m-1"},null,8,["modelValue"])]),s("div",wt,[s("label",null,m(e.$t("common.note"))+":",1),r(he,{type:"text",modelValue:C.value,"onUpdate:modelValue":t[7]||(t[7]=a=>C.value=a),class:"w-full m-1"},null,8,["modelValue"])]),s("div",yt,[r(i,{label:u(p)("common.send"),onClick:t[8]||(t[8]=a=>_e())},null,8,["label"])])]),_:1},8,["visible"])],64)}}},Ft=Re(kt,[["__scopeId","data-v-4e27f010"]]);export{Ft as default};
