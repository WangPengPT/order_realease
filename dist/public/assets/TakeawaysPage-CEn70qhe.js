import{s as se}from"./index-xJZr0GsB.js";import{s as le}from"./index-YBf3aQC3.js";import{s as oe,a as re}from"./index-D1l17qSA.js";import{b as ne}from"./index-DFRE_58V.js";import{q as ie,h as m,n as w,s as de,c as f,a as s,d as r,w as n,l as e,F as S,o as h,A as L,z,t as o,L as p,e as ue,E as B,G as c}from"./index-COjh2_nl.js";import{s as H,a as u}from"./index-2fIdQWIJ.js";import{s as pe}from"./index-Cy05Lfl4.js";import{s as Q}from"./index-BWYGgLIH.js";import"./index-Bh0a_kRD.js";import"./index-BLhRM1HA.js";import"./index-smnRTjg1.js";import"./index-goSerjr-.js";import"./index-BGHIHGDx.js";import"./index-UPliuns3.js";import"./index-BuTCPzRp.js";import"./index-ep-NvoEy.js";const ce={class:"h-full"},ve={class:"flex flex-column gap-2"},me={class:"flex justify-content-between"},ye={class:"flex flex-column"},fe={class:"flex flex-row"},he={class:"m-0 font-bold text-2xl text-left flex-grow-1"},_e={class:"font-bold"},ge={class:"font-bold"},we=["onClick"],be={class:"text-center py-5"},ke={class:"mt-3 text-gray-500"},Pe={class:"mb-3"},xe={class:"text-lg font-bold"},Se={class:"mb-3"},Ce={key:0,class:"mb-3"},Me={style:{color:"#5F0F0F"}},Te={style:{"white-space":"normal","word-break":"break-word",color:"#5F0F0F"}},Ne={class:"font-semibold"},Ae={class:"flex justify-between text-gray-600 text-sm gap-4"},Fe={class:"flex justify-content-end"},Oe={class:"h-full"},Ve=["onClick"],$e={class:"text-center py-5"},Ue={class:"mt-3 text-gray-500"},Ze={__name:"TakeawaysPage",setup(De){const{t}=ie(),b=m({global:{value:null,matchMode:c.CONTAINS},id:{value:null,matchMode:c.STARTS_WITH},date:{value:null,matchMode:c.STARTS_WITH},time:{value:null,matchMode:c.IN},customer:{value:null,matchMode:c.EQUALS},total_price:{value:null,matchMode:c.EQUALS},pay_state:{value:null,matchMode:c.EQUALS},pay_ttpe:{value:null,matchMode:c.EQUALS}}),_=w.shopify_orders,g=m(!1),d=m(null),k=m(!1),v=m(null),j=de(()=>[{label:t("orderPage.completed"),value:"completed"},{label:t("orderPage.read"),value:"read"},{label:t("orderPage.new"),value:"new"},{label:t("orderPage.voided"),value:"voided"}]);function C(i){if(i.pay_state=="voided"){i.status="voided";return}d.value=i,g.value=!1,v.value=i.status,k.value=!0}function q(){v.value!==null&&(d.value.status!==v.value&&((d.value.status==="new"||!d.value.status)&&w.updateNewOrderCount("takeaway",-1),v.value==="new"&&w.updateNewOrderCount("takeaway",1),d.value.status=v.value),k.value=!1)}function M(i){d.value=i.data,g.value=!0,(d.value.status==="new"||!d.value.status)&&(d.value.isNew=void 0,w.updateNewOrderCount("takeaway",-1),d.value.status="read")}const T=i=>({completed:"status-completed",read:"status-read",new:"status-new",voided:"status-voided"})[i]||"",N=i=>({completed:t("orderPage.completed"),read:t("orderPage.read"),new:t("orderPage.new"),voided:t("orderPage.voided")})[i]||i;function K(i){w.print_takeaway_order(i),g.value=!1}const A=m(!1);function W(){let i=0;return _.value.forEach(l=>{l.status!="voided"&&l.pay_state!="voided"&&i++}),i}function G(){let i=0;return _.value.forEach(l=>{i+=Number(l.total_price?l.total_price:0)}),i}const x=m(!1);function J(){x.value=!0}return(i,l)=>{const F=ne,X=re,Y=oe,Z=le,O=se;return h(),f(S,null,[s("div",ce,[r(e(H),{value:e(_),tableStyle:"min-width: 50rem",dataKey:"id",paginator:"",rows:10,rowsPerPageOptions:[5,10,20,50],stripedRows:"",scrollable:"",scrollHeight:"flex",filters:b.value,onRowClick:M,selectionMode:"single"},{header:n(()=>[s("div",ve,[s("div",me,[s("div",ye,[s("div",fe,[s("h4",he,o(e(t)("takeawaysPage.orders")),1),r(F,{text:"",icon:"pi pi-window-maximize",severity:"contrast",disabled:!e(_).length,onClick:J},null,8,["disabled"])]),s("div",null,[s("small",_e,o(e(t)("takeawaysPage.numberSuccessfulOrders"))+"："+o(W()),1),l[7]||(l[7]=s("small",{class:"font-bold"},"丨",-1)),s("small",ge,o(e(t)("takeawaysPage.totalAmount"))+"：€"+o(G().toFixed(2)),1)])]),r(Y,null,{default:n(()=>[r(X,null,{default:n(()=>l[8]||(l[8]=[s("i",{class:"pi pi-search"},null,-1)])),_:1,__:[8]}),r(e(pe),{modelValue:b.value.global.value,"onUpdate:modelValue":l[0]||(l[0]=a=>b.value.global.value=a),placeholder:e(t)("orderPage.find")},null,8,["modelValue","placeholder"])]),_:1})]),l[9]||(l[9]=s("div",null,null,-1))])]),empty:n(()=>[s("div",be,[l[10]||(l[10]=s("i",{class:"pi pi-search",style:{"font-size":"3rem",color:"#ccc"}},null,-1)),s("p",ke,o(e(t)("orderPage.notFound")),1)])]),default:n(()=>[r(e(u),{header:e(t)("orderPage.status")},{body:n(({data:a})=>[s("span",{class:z(["status-badge",T(a.status||"new")]),onClick:L(P=>C(a),["stop"])},o(N(a.status||"new")),11,we)]),_:1},8,["header"]),r(e(u),{field:"name",header:e(t)("takeawaysPage.orderNumber"),sortable:""},{body:n(({data:a})=>[s("span",{style:p({"text-decoration":a.status=="voided"?"line-through":"none"})},o(a.name),5)]),_:1},8,["header"]),r(e(u),{field:"pickupDate",header:e(t)("takeawaysPage.date"),sortable:""},null,8,["header"]),r(e(u),{field:"pickupTime",header:e(t)("takeawaysPage.time"),sortable:""},null,8,["header"]),r(e(u),{field:"customer.name",header:e(t)("takeawaysPage.customer"),sortable:""},null,8,["header"]),r(e(u),{field:"total_price",header:e(t)("takeawaysPage.totalPrice"),sortable:""},{body:n(({data:a})=>[s("span",{style:p({"text-decoration":a.status=="voided"?"line-through":"none"})}," €"+o(a.total_price?a.total_price:0),5)]),_:1},8,["header"]),r(e(u),{field:"pay_state",header:e(t)("takeawaysPage.payState"),sortable:""},{body:n(({data:a})=>[s("span",{style:p({"text-decoration":a.status=="voided"?"line-through":"none"})},o(e(t)("takeawaysPage.statePayment."+a.pay_state)),5)]),_:1},8,["header"]),r(e(u),{field:"pay_type",header:e(t)("takeawaysPage.payType"),sortable:""},{body:n(({data:a})=>[s("span",{style:p({"text-decoration":a.status=="voided"?"line-through":"none"})},o(e(t)("takeawaysPage.statePaymentType."+a.pay_type.replaceAll(" ","_"))),5)]),_:1},8,["header"])]),_:1},8,["value","filters"])]),r(e(Q),{visible:g.value,"onUpdate:visible":l[2]||(l[2]=a=>g.value=a),header:e(t)("takeawaysPage.orderDetails"),modal:"",style:{width:"450px"}},{default:n(()=>{var a,P,V,$,U,D,E,I,R;return[s("div",Pe,[s("h3",xe,o(e(t)("takeawaysPage.orderNumber"))+" : "+o((a=d.value)==null?void 0:a.name),1)]),s("div",Se,[s("div",null,o(e(t)("takeawaysPage.name"))+": "+o((V=(P=d.value)==null?void 0:P.customer)==null?void 0:V.name),1),s("div",null,o(e(t)("takeawaysPage.phone"))+": "+o((U=($=d.value)==null?void 0:$.customer)==null?void 0:U.phone),1),s("div",null,o(e(t)("takeawaysPage.email"))+": "+o((E=(D=d.value)==null?void 0:D.customer)==null?void 0:E.email),1)]),(I=d.value)!=null&&I.note&&d.value.note!==""?(h(),f("div",Ce,[s("div",Me,o(e(t)("orderPage.notes"))+":",1),s("div",Te,o(d.value.note),1)])):ue("",!0),(h(!0),f(S,null,B((R=d.value)==null?void 0:R.line_items,(y,ee)=>(h(),f("div",{key:ee,class:"border-b py-2"},[s("div",Ne,o(y.name),1),s("div",Ae,[s("span",null,o(y.sku),1),s("span",null,o(y.price)+" x "+o(y.quantity),1)]),(h(!0),f(S,null,B(y.properties,(ae,te)=>(h(),f("div",{key:te,class:"text-sm text-gray-500"},o(ae),1))),128))]))),128)),s("div",Fe,[r(F,{label:e(t)("takeawaysPage.printOrder"),onClick:l[1]||(l[1]=y=>K(d.value))},null,8,["label"])])]}),_:1},8,["visible","header"]),s("div",null,[r(e(Q),{visible:k.value,"onUpdate:visible":l[4]||(l[4]=a=>k.value=a),header:e(t)("orderPage.orderStatus"),modal:!0,dismissableMask:!0},{default:n(()=>[r(Z,{modelValue:v.value,"onUpdate:modelValue":l[3]||(l[3]=a=>v.value=a),options:j.value,optionLabel:"label",optionValue:"value",onClick:q},null,8,["modelValue","options"])]),_:1},8,["visible","header"])]),r(O,{visible:A.value,"onUpdate:visible":l[5]||(l[5]=a=>A.value=a),header:e(t)("takeawaysPage.analysisHeader"),position:"full"},{default:n(()=>l[11]||(l[11]=[s("p",null,"数据..",-1)])),_:1,__:[11]},8,["visible","header"]),r(O,{visible:x.value,"onUpdate:visible":l[6]||(l[6]=a=>x.value=a),position:"full",header:e(t)("takeawaysPage.orders")},{default:n(()=>[s("div",Oe,[r(e(H),{value:e(_),tableStyle:"min-width: 50rem",dataKey:"id",paginator:"",rows:10,rowsPerPageOptions:[5,10,20,50],stripedRows:"",filters:b.value,scrollable:"",scrollHeight:"flex",onRowClick:M,selectionMode:"single"},{empty:n(()=>[s("div",$e,[l[12]||(l[12]=s("i",{class:"pi pi-search",style:{"font-size":"3rem",color:"#ccc"}},null,-1)),s("p",Ue,o(e(t)("orderPage.notFound")),1)])]),default:n(()=>[r(e(u),{header:e(t)("orderPage.status")},{body:n(({data:a})=>[s("span",{class:z(["status-badge",T(a.status||"new")]),onClick:L(P=>C(a),["stop"])},o(N(a.status||"new")),11,Ve)]),_:1},8,["header"]),r(e(u),{field:"name",header:e(t)("takeawaysPage.orderNumber"),sortable:""},{body:n(({data:a})=>[s("span",{style:p({"text-decoration":a.status=="voided"?"line-through":"none"})},o(a.name),5)]),_:1},8,["header"]),r(e(u),{field:"pickupDate",header:e(t)("takeawaysPage.date"),sortable:""},null,8,["header"]),r(e(u),{field:"pickupTime",header:e(t)("takeawaysPage.time"),sortable:""},null,8,["header"]),r(e(u),{field:"customer.name",header:e(t)("takeawaysPage.customer"),sortable:""},null,8,["header"]),r(e(u),{field:"total_price",header:e(t)("takeawaysPage.totalPrice"),sortable:""},{body:n(({data:a})=>[s("span",{style:p({"text-decoration":a.status=="voided"?"line-through":"none"})}," €"+o(a.total_price?a.total_price:0),5)]),_:1},8,["header"]),r(e(u),{field:"pay_state",header:e(t)("takeawaysPage.payState"),sortable:""},{body:n(({data:a})=>[s("span",{style:p({"text-decoration":a.status=="voided"?"line-through":"none"})},o(e(t)("takeawaysPage.statePayment."+a.pay_state)),5)]),_:1},8,["header"]),r(e(u),{field:"pay_type",header:e(t)("takeawaysPage.payType"),sortable:""},{body:n(({data:a})=>[s("span",{style:p({"text-decoration":a.status=="voided"?"line-through":"none"})},o(e(t)("takeawaysPage.statePaymentType."+a.pay_type.replaceAll(" ","_"))),5)]),_:1},8,["header"])]),_:1},8,["value","filters"])])]),_:1},8,["visible","header"])],64)}}};export{Ze as default};
