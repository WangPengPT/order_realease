import{s as C}from"./index-UuqCgbwU.js";import{s as U}from"./index-CeLZXEuR.js";import{b as w}from"./index-UWjVb1or.js";import{s as y}from"./index-CAWJWCqz.js";import{u as F,a3 as M,h as p,c as V,a as s,d as t,w as B,l as f,F as T,n as j,j as E,o as N}from"./index-C6PSjnPN.js";import"./index-BYBm0dCp.js";import"./index-kao1m_HO.js";import"./index-Zj468pqp.js";import"./index-nHcMNJSJ.js";import"./index-BF-X1nVO.js";const D={class:"flex flex-column justify-between items-center flex-1 gap-4"},I={class:"flex gap-3 align-items-center"},P={class:"m-2"},X={__name:"UpdateMenu",setup(R){E();const v=F(),g=M(),_=p(0),u=p([]),a=p(!1);let m;m="/upload";const k=()=>{let e="";for(const o of u.value)e+='"'+o.name+'",';j.refreshMenuSignal(),console.log("update_all:",a.value),v.add({severity:"info",summary:"成功",detail:"上传文件"+e.substring(0,e.length-1),life:5e3})},x=e=>{console.log("执行callback()函数，触发实际的文件上传"),e()},$=e=>{u.value=e.files,u.value.forEach(o=>{_.value+=parseInt(S(o.size))})},S=e=>{const i=g.config.locale.fileSizeTypes;if(e===0)return`0 ${i[0]}`;const r=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/Math.pow(1024,r)).toFixed(3))} ${i[r]}`},h=e=>{console.log("上传前的文件",e.files),e.formData.append("update_all",a.value)};return(e,o)=>{const n=w,i=U,r=C;return N(),V(T,null,[s("div",null,[t(f(y),{url:f(m),onUpload:o[1]||(o[1]=l=>k()),multiple:!0,accept:".xlsx,.xls,.csv,.json",maxFileSize:1e6,onSelect:$,onBeforeUpload:o[2]||(o[2]=l=>h(l))},{header:B(({chooseCallback:l,uploadCallback:b,clearCallback:z,files:d})=>[s("div",D,[s("div",I,[t(n,{onClick:c=>l(),icon:"pi pi-file-arrow-up",rounded:"",outlined:"",severity:"secondary"},null,8,["onClick"]),t(n,{onClick:c=>x(b),icon:"pi pi-cloud-upload",rounded:"",outlined:"",severity:"success",disabled:!d||d.length===0},null,8,["onClick","disabled"]),t(n,{onClick:c=>z(),icon:"pi pi-times",rounded:"",outlined:"",severity:"danger",disabled:!d||d.length===0},null,8,["onClick","disabled"])])]),s("div",P,[o[3]||(o[3]=s("label",{class:"mr-2"},"替换菜单",-1)),t(i,{modelValue:a.value,"onUpdate:modelValue":o[0]||(o[0]=c=>a.value=c)},null,8,["modelValue"])])]),_:1},8,["url"])]),t(r)],64)}}};export{X as default};
