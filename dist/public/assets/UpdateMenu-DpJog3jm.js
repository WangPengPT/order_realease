import{s as U}from"./index-7tW-XI_-.js";import{s as F}from"./index-B16wqwHJ.js";import{s as M}from"./index-Bvpyb8qv.js";import{b as T}from"./index-Ctv_mknv.js";import{s as V}from"./index-CJTfQQ0S.js";import{u as B,ao as E,h as d,c as N,a as l,d as t,w as g,l as m,F as j,n as D,j as I,o as P}from"./index-CHGYqN5f.js";import"./index-D8h7lcG7.js";import"./index-CV_9XbFm.js";import"./index-BPEwGqYY.js";import"./index-TL2JjN_q.js";import"./index-DWDvRMWN.js";const R={class:"flex flex-column w-full",style:{position:"fixed",top:"0",left:"0"}},q={class:"flex flex-column justify-between items-center flex-1 gap-4"},A={class:"flex gap-3 align-items-center"},G={class:"m-2"},te={__name:"UpdateMenu",setup(H){const _=I(),x=B(),k=E(),$=d(0),u=d([]),a=d(!1);let f;f="/upload";const b=()=>{let e="";for(const o of u.value)e+='"'+o.name+'",';D.refreshMenuSignal(),console.log("update_all:",a.value),x.add({severity:"info",summary:"成功",detail:"上传文件"+e.substring(0,e.length-1),life:5e3})},h=e=>{console.log("执行callback()函数，触发实际的文件上传"),e()},w=e=>{u.value=e.files,u.value.forEach(o=>{$.value+=parseInt(S(o.size))})},S=e=>{const i=k.config.locale.fileSizeTypes;if(e===0)return`0 ${i[0]}`;const r=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/Math.pow(1024,r)).toFixed(3))} ${i[r]}`},y=e=>{console.log("上传前的文件",e.files),e.formData.append("update_all",a.value)};return(e,o)=>{const s=T,i=M,r=F,v=U;return P(),N(j,null,[l("div",R,[t(i,{class:"bg-primary text-white p-2"},{start:g(()=>[t(s,{icon:"pi pi-arrow-left",class:"p-button-text text-white",label:"主页",onClick:o[0]||(o[0]=n=>m(_).push("/"))})]),_:1}),l("div",null,[t(m(V),{url:m(f),onUpload:o[2]||(o[2]=n=>b()),multiple:!0,accept:".xlsx,.xls,.csv",maxFileSize:1e6,onSelect:w,onBeforeUpload:o[3]||(o[3]=n=>y(n))},{header:g(({chooseCallback:n,uploadCallback:z,clearCallback:C,files:c})=>[l("div",q,[l("div",A,[t(s,{onClick:p=>n(),icon:"pi pi-file-arrow-up",rounded:"",outlined:"",severity:"secondary"},null,8,["onClick"]),t(s,{onClick:p=>h(z),icon:"pi pi-cloud-upload",rounded:"",outlined:"",severity:"success",disabled:!c||c.length===0},null,8,["onClick","disabled"]),t(s,{onClick:p=>C(),icon:"pi pi-times",rounded:"",outlined:"",severity:"danger",disabled:!c||c.length===0},null,8,["onClick","disabled"])])]),l("div",G,[o[4]||(o[4]=l("label",{class:"mr-2"},"替换菜单",-1)),t(r,{modelValue:a.value,"onUpdate:modelValue":o[1]||(o[1]=p=>a.value=p)},null,8,["modelValue"])])]),_:1},8,["url"])])]),t(v)],64)}}};export{te as default};
