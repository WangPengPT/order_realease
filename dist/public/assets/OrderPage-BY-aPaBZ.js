import{s as F,a as U}from"./index-BM2bAIb7.js";import{s as L}from"./index-Bw7hyTyp.js";import{s as P,a as A}from"./index-CxnzbnEW.js";import{s as j,a as q}from"./index-CCbwSnEu.js";import{s as E}from"./index-B2NFfM60.js";import{n,h as r,s as H,c as v,a as l,d as a,w as o,l as K,F as w,o as h,x as G,y as J,t as d,z as Q,A as W}from"./index-BE-aujn6.js";import"./index-CTzv-46u.js";import"./index-B2_HMXbk.js";import"./index-B_mkyFsU.js";import"./index-fMZjR7Sn.js";import"./index-BB8ejdNj.js";import"./index-DoQR-XDg.js";const X={class:"card",style:{display:"flex","flex-direction":"column",height:"75%"}},Y={class:"flex flex-wrap gap-2 items-center justify-between"},Z=["onClick"],ee={style:{"list-style-type":"none","padding-left":"0"}},te={class:"flex flex-wrap p-2 items-center gap-4"},se={style:{"max-width":"200px"}},he={__name:"OrderPage",setup(le){const _=n.orders,c=r(!1),u=r(null),p=r(!1),m=r(null),y=r([{label:"已完成",value:"completed"},{label:"已浏览",value:"readed"},{label:"新订单",value:"new"}]),f=r({global:{value:null,matchMode:H.CONTAINS}}),x=e=>({completed:"已完成",readed:"已浏览",new:"新订单"})[e]||e,C=e=>({completed:"status-completed",readed:"status-readed",new:"status-new"})[e]||"";function S(e){u.value=e,c.value=!1,m.value=e.status,p.value=!0}function D(){u.value.status=m.value,n.updateOrderStatus(u.value),p.value=!1}const M=e=>new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});function N(e){e.data?(u.value=e.data,c.value=!0,e.data.isNew=!1,e.data.status=="new"&&(e.data.status="readed",n.updateOrderStatus(e.data)),n.decrementOrderCount()):console.error("Row data is missing in the event",e)}function k(e){return n.getDishNameById(e.dishid)}function V(e){return e.dishid?e.dishid:e.name}function $(e){return n.getDishNote(e)}return(e,s)=>{const I=q,O=E,B=j,i=A,R=P,T=F,g=L,z=U;return h(),v(w,null,[l("div",X,[a(R,{value:K(_),tableStyle:"min-width: 50rem",dataKey:"id",paginator:"",rows:5,rowsPerPageOptions:[5,10,20,50],stripedRows:"",filters:f.value,scrollable:"",scrollHeight:"flex",onRowClick:N,selectionMode:"single"},{header:o(()=>[l("div",Y,[s[5]||(s[5]=l("h4",{class:"m-0 font-bold text-2xl text-left flex-grow-1"},"所有订单",-1)),a(B,null,{default:o(()=>[a(I,null,{default:o(()=>s[4]||(s[4]=[l("i",{class:"pi pi-search"},null,-1)])),_:1,__:[4]}),a(O,{modelValue:f.value.global.value,"onUpdate:modelValue":s[0]||(s[0]=t=>f.value.global.value=t),placeholder:"查找.."},null,8,["modelValue"])]),_:1})])]),empty:o(()=>s[6]||(s[6]=[l("div",{class:"text-center py-5"},[l("i",{class:"pi pi-search",style:{"font-size":"3rem",color:"#ccc"}}),l("p",{class:"mt-3 text-gray-500"},"未找到匹配的订单")],-1)])),default:o(()=>[a(i,{field:"status",header:"状态",sortable:"",style:{width:"10%"}},{body:o(({data:t})=>[l("span",{class:J(["status-badge",C(t.status)]),onClick:G(b=>S(t),["stop"])},d(x(t.status)),11,Z)]),_:1}),a(i,{field:"id",header:"订单号",sortable:"",style:{width:"10%"}}),a(i,{field:"table",header:"桌号",sortable:"",style:{width:"10%"}}),a(i,{field:"time",header:"时间",sortable:"",style:{width:"20%"}},{body:o(({data:t})=>[Q(d(M(t.timestamp)),1)]),_:1}),a(i,{field:"name",header:"名字",style:{width:"15%"}}),a(i,{field:"note",header:"备注",style:{width:"35%"},class:"multiline-cell"})]),_:1},8,["value","filters"])]),l("div",null,[a(g,{visible:c.value,"onUpdate:visible":s[1]||(s[1]=t=>c.value=t),header:"详细信息",modal:!0,dismissableMask:!0},{default:o(()=>[l("ul",ee,[(h(!0),v(w,null,W(u.value.items,(t,b)=>(h(),v("li",{key:b},[l("div",te,[l("label",null,d(V(t)),1),l("label",null,d(k(t)),1),l("label",null,"x "+d(t.quantity),1),l("label",se,d($(t.notes)),1)]),a(T)]))),128))])]),_:1},8,["visible"])]),l("div",null,[a(g,{visible:p.value,"onUpdate:visible":s[3]||(s[3]=t=>p.value=t),header:"订单状态",modal:!0,dismissableMask:!0},{default:o(()=>[a(z,{modelValue:m.value,"onUpdate:modelValue":s[2]||(s[2]=t=>m.value=t),options:y.value,optionLabel:"label",optionValue:"value",onClick:D},null,8,["modelValue","options"])]),_:1},8,["visible"])])],64)}}};export{he as default};
