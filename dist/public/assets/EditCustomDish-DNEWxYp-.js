var me=Object.defineProperty;var fe=(o,s,y)=>s in o?me(o,s,{enumerable:!0,configurable:!0,writable:!0,value:y}):o[s]=y;var Y=(o,s,y)=>fe(o,typeof s!="symbol"?s+"":s,y);import{e as he,a as ge}from"./index-Dkx6Dqe3.js";import{s as ve}from"./index-BMjSXOjj.js";import{R as ye,a as G,c as we,f as be}from"./index-IO7XCKEu.js";import{B as Ve,r as _e,c as h,o as f,a as u,b as t,d as C,e as T,m as v,t as b,z as Pe,w as d,f as H,g as $e,y as De,aw as ke,T as z,u as Ue,x as Ce,q as Se,aJ as Te,h as $,s as I,i as Ee,aT as Be,F as q,E as Ne,n as L,j as Ae,l as Re,C as Q,p as Ie}from"./index-DUqYp7lY.js";import{s as Le}from"./index-Dm3o50UF.js";import{s as ze,a as Oe}from"./index-JHNLuJPi.js";import{s as Je}from"./index-SG0pzpR-.js";import{s as Me}from"./index-CYFg-3Hi.js";import{s as Ke}from"./index-lgcJfd3C.js";import{s as je}from"./index-C3jMJh9v.js";import{s as Fe}from"./index-CU1FltuV.js";import{s as We}from"./index-CbDKtwTj.js";import{_ as Ye}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-1auV9J53.js";import"./index-DWJiXn1y.js";import"./index-uq9xBe67.js";import"./index-aWLE-PUb.js";import"./index-B7NP7Q6b.js";import"./index-DERn7--M.js";import"./index-w4NqEexk.js";import"./index-BXlhR3Pt.js";import"./index-DntnN66o.js";import"./index-CoFc1Q2f.js";var qe=`
    .p-panel {
        display: block;
        border: 1px solid dt('panel.border.color');
        border-radius: dt('panel.border.radius');
        background: dt('panel.background');
        color: dt('panel.color');
    }

    .p-panel-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: dt('panel.header.padding');
        background: dt('panel.header.background');
        color: dt('panel.header.color');
        border-style: solid;
        border-width: dt('panel.header.border.width');
        border-color: dt('panel.header.border.color');
        border-radius: dt('panel.header.border.radius');
    }

    .p-panel-toggleable .p-panel-header {
        padding: dt('panel.toggleable.header.padding');
    }

    .p-panel-title {
        line-height: 1;
        font-weight: dt('panel.title.font.weight');
    }

    .p-panel-content {
        padding: dt('panel.content.padding');
    }

    .p-panel-footer {
        padding: dt('panel.footer.padding');
    }
`,Qe={root:function(s){var y=s.props;return["p-panel p-component",{"p-panel-toggleable":y.toggleable}]},header:"p-panel-header",title:"p-panel-title",headerActions:"p-panel-header-actions",pcToggleButton:"p-panel-toggle-button",contentContainer:"p-panel-content-container",content:"p-panel-content",footer:"p-panel-footer"},Ge=Ve.extend({name:"panel",style:qe,classes:Qe}),He={name:"BasePanel",extends:we,props:{header:String,toggleable:Boolean,collapsed:Boolean,toggleButtonProps:{type:Object,default:function(){return{severity:"secondary",text:!0,rounded:!0}}}},style:Ge,provide:function(){return{$pcPanel:this,$parentInstance:this}}},X={name:"Panel",extends:He,inheritAttrs:!1,emits:["update:collapsed","toggle"],data:function(){return{d_collapsed:this.collapsed}},watch:{collapsed:function(s){this.d_collapsed=s}},methods:{toggle:function(s){this.d_collapsed=!this.d_collapsed,this.$emit("update:collapsed",this.d_collapsed),this.$emit("toggle",{originalEvent:s,value:this.d_collapsed})},onKeyDown:function(s){(s.code==="Enter"||s.code==="NumpadEnter"||s.code==="Space")&&(this.toggle(s),s.preventDefault())}},computed:{buttonAriaLabel:function(){return this.toggleButtonProps&&this.toggleButtonProps.ariaLabel?this.toggleButtonProps.ariaLabel:this.header},dataP:function(){return be({toggleable:this.toggleable})}},components:{PlusIcon:ve,MinusIcon:he,Button:G},directives:{ripple:ye}},Xe=["data-p"],Ze=["data-p"],xe=["id"],eo=["id","aria-labelledby"];function oo(o,s,y,O,p,w){var A=_e("Button");return f(),h("div",v({class:o.cx("root"),"data-p":w.dataP},o.ptmi("root")),[u("div",v({class:o.cx("header"),"data-p":w.dataP},o.ptm("header")),[C(o.$slots,"header",{id:o.$id+"_header",class:Pe(o.cx("title"))},function(){return[o.header?(f(),h("span",v({key:0,id:o.$id+"_header",class:o.cx("title")},o.ptm("title")),b(o.header),17,xe)):T("",!0)]}),u("div",v({class:o.cx("headerActions")},o.ptm("headerActions")),[C(o.$slots,"icons"),o.toggleable?C(o.$slots,"togglebutton",{key:0,collapsed:p.d_collapsed,toggleCallback:function(V){return w.toggle(V)},keydownCallback:function(V){return w.onKeyDown(V)}},function(){return[t(A,v({id:o.$id+"_header",class:o.cx("pcToggleButton"),"aria-label":w.buttonAriaLabel,"aria-controls":o.$id+"_content","aria-expanded":!p.d_collapsed,unstyled:o.unstyled,onClick:s[0]||(s[0]=function(i){return w.toggle(i)}),onKeydown:s[1]||(s[1]=function(i){return w.onKeyDown(i)})},o.toggleButtonProps,{pt:o.ptm("pcToggleButton")}),{icon:d(function(i){return[C(o.$slots,o.$slots.toggleicon?"toggleicon":"togglericon",{collapsed:p.d_collapsed},function(){return[(f(),H($e(p.d_collapsed?"PlusIcon":"MinusIcon"),v({class:i.class},o.ptm("pcToggleButton").icon),null,16,["class"]))]})]}),_:3},16,["id","class","aria-label","aria-controls","aria-expanded","unstyled","pt"])]}):T("",!0)],16)],16,Ze),t(z,v({name:"p-toggleable-content"},o.ptm("transition")),{default:d(function(){return[De(u("div",v({id:o.$id+"_content",class:o.cx("contentContainer"),role:"region","aria-labelledby":o.$id+"_header"},o.ptm("contentContainer")),[u("div",v({class:o.cx("content")},o.ptm("content")),[C(o.$slots,"default")],16),o.$slots.footer?(f(),h("div",v({key:0,class:o.cx("footer")},o.ptm("footer")),[C(o.$slots,"footer")],16)):T("",!0)],16,eo),[[ke,!p.d_collapsed]])]}),_:3},16)],16,Xe)}X.render=oo;class lo{constructor(){Y(this,"toast")}show(s){s.summary=s.summary,s.detail=s.detail,s.life=3e3,this.toast.add(s)}show_success(s){this.show({severity:"success",summary:"success",detail:s})}show_info(s){this.show({severity:"info",summary:"info",detail:s})}show_warn(s){this.show({severity:"warn",summary:"warn",detail:s})}show_error(s){this.show({severity:"error",summary:"error",detail:s})}}const S=new lo,to={class:"flex flex-column w-full h-full"},no={class:"fixed top-0 left-0 right-0 z-1"},ao={class:"w-full h-full p-4"},so={class:"flex flex-row w-full h-full"},io={class:"w-full"},ro={key:0,class:"flex flex-row gap-4 mb-4"},uo={class:"flex-1 flex flex-column gap-2"},po={class:"font-bold"},co={class:"flex-1 flex flex-column gap-2"},mo={class:"font-bold"},fo={class:"relative w-full h-full"},ho={class:"flex flex-column w-full"},go={class:"flex items-center gap-2 w-full"},vo={key:0,class:"w-full"},yo={key:0},wo={key:1},bo={key:1},Vo={class:"font-bold p-3"},_o={key:0},Po={key:1},$o={class:"w-full flex justify-content-end m-2"},Do={__name:"EditCustomDish",setup(o){const s=Ue(),y=Ce(),O=Ae(),{t:p}=Se(),w=Te();S.toast=s;const A=w.params.dishId,i=$(void 0),V=$([]),Z=I(()=>{var n;return((n=i.value)==null?void 0:n.name)||""}),N=$(void 0),R=I(()=>!i.value||!N.value?!1:JSON.stringify(i.value)!==JSON.stringify(N.value)),J=$([{label:p("common.delete"),icon:"pi pi-times"}]);function x(){O.push(Ie.mainPath.editableCustomeDish.path)}function ee(){if(!R.value){S.show_info(p("notification.noChanges"));return}console.log("current dish",i.value),L.customDishApi.updateCustomDish(i.value,n=>{n.success?(S.show_success(p("notification.updateSuccess")),N.value=JSON.parse(JSON.stringify(i.value))):S.show_warn(p("notification.updateFailed"))})}function oe(n=5e3,a=100){return new Promise((m,P)=>{const E=Date.now(),D=()=>{const B=L.customDishApi.customDishes.value;B&&B.length>0?m(B):Date.now()-E>n?P(new Error("customDishes 超时未加载")):setTimeout(D,a)};D()})}Ee(async()=>{try{const a=(await oe()).find(m=>String(m.id)===A);a&&(i.value=JSON.parse(JSON.stringify(a)),N.value=JSON.parse(JSON.stringify(a)),console.log("customDish.value dish:",i.value)),V.value=a.types.map(()=>!0)}catch(n){console.error(n)}});const M=$([]),K=$([]),le=(n,a)=>{const{newData:m,index:P}=n;i.value&&(i.value.types[a].dishes[P]=m)},te=(n,a)=>{const{newData:m,index:P}=n;i.value&&(i.value.types[a]=m)};function j(n){return`${n}€`}const F=$([{name:p("menuPage.open"),value:!0},{name:p("menuPage.close"),value:!1}]),ne=(n,a)=>{V.value[a]=n.value};Be((n,a,m)=>{if(R.value&&!confirm(p("notification.unsavedWarning")||"You have unsaved changes. Leave anyway?"))return m(!1);m()}),window.addEventListener("beforeunload",n=>{R.value&&(n.preventDefault(),n.returnValue="")});const ae=I(()=>[{name:p("menuPage.dineIn")+" & "+p("menuPage.takeAway"),code:"DINEIN&TAKEAWAY"},{name:p("menuPage.takeAway"),code:"TAKEAWAY"},{name:p("menuPage.dineIn"),code:"DINEIN"}]);function se(n,a){L.customDishApi.updateCustomDishSellType(a.id,n,m=>{m.success?S.show_success(p("notification.updateSuccess")):S.show_warn(p("notification.updateFailed"))})}function ie(n){if(!i.value)return;const a=i.value.types[n];a&&(Array.isArray(a.dishes)||(a.dishes=[]),a.dishes.push(de()),V.value[n]=!0)}function de(){return{dishid:Date.now(),name:"",name_zh:"",name_en:"",name_pt:"",price:0,deliveryPrice:0,orderType:null,discount:0,deliveryDiscount:0,enable:!0}}function re(n,a){y.require({message:"确定要删除这个菜品吗？",header:"确认删除",icon:"pi pi-exclamation-triangle",accept:()=>{const m=i.value.types[n];!m||!m.dishes||m.dishes.splice(a,1)}})}return(n,a)=>{const m=We,P=Fe,E=G,D=je,B=Ke,ue=Me,k=ge,c=Oe,_=Je,W=ze,pe=Le,ce=X;return f(),h(q,null,[t(m),t(P),u("div",to,[u("div",no,[t(ue,null,{start:d(()=>[t(E,{icon:"pi pi-arrow-left",onClick:x})]),center:d(()=>[u("span",null,b(Z.value),1)]),end:d(()=>[i.value?(f(),H(D,{key:0,modelValue:i.value.sellType,"onUpdate:modelValue":[a[0]||(a[0]=g=>i.value.sellType=g),a[1]||(a[1]=g=>se(g,i.value))],options:ae.value,optionLabel:"name",optionValue:"code",class:"pr-2"},null,8,["modelValue","options"])):T("",!0),t(B,{label:Re(p)("topBar.save"),model:J.value,onClick:ee},null,8,["label","model"])]),_:1})]),a[11]||(a[11]=u("div",{style:{"padding-top":"60px"}},null,-1)),u("div",ao,[u("div",so,[u("div",io,[i.value?(f(),h("div",ro,[u("div",uo,[u("label",po,b(n.$t("menuPage.price"))+" ("+b(n.$t("menuPage.dineIn"))+")",1),t(k,{modelValue:i.value.initialPrice,"onUpdate:modelValue":a[2]||(a[2]=g=>i.value.initialPrice=g),mode:"currency",currency:"EUR",locale:"de-DE",fluid:""},null,8,["modelValue"])]),u("div",co,[u("label",mo,b(n.$t("menuPage.deliveryPrice"))+" ("+b(n.$t("menuPage.takeAway"))+")",1),t(k,{modelValue:i.value.initialDeliveryPrice,"onUpdate:modelValue":a[3]||(a[3]=g=>i.value.initialDeliveryPrice=g),mode:"currency",currency:"EUR",locale:"de-DE",fluid:""},null,8,["modelValue"])])])):T("",!0),u("div",fo,[i.value?(f(!0),h(q,{key:0},Ne(i.value.types,(g,U)=>(f(),h("div",null,[u("div",ho,[t(z,{name:"smooth-expand",mode:"out-in"},{default:d(()=>[t(ce,{toggleable:"",class:"w-full",onToggle:e=>ne(e,U),collapsed:!0},{header:d(()=>[u("div",go,[t(z,{name:"slide-fade",mode:"out-in"},{default:d(()=>[V.value[U]?(f(),h("div",vo,[t(W,{value:[g],tableStyle:"min-width: 50rem",editMode:"row",class:"w-full",editingRows:K.value,"onUpdate:editingRows":a[4]||(a[4]=e=>K.value=e),onRowEditSave:e=>te(e,U)},{default:d(()=>[t(c,{field:"id",header:"Id"}),t(c,{field:"typeName",header:n.$t("menuPage.name")},null,8,["header"]),t(c,{field:"enable",header:n.$t("menuPage.enableDisable")},{body:d(({data:e,field:l})=>[e[l]===!0?(f(),h("div",yo,a[6]||(a[6]=[u("i",{class:"pi pi-circle-fill",style:{color:"green","font-size":"1.5rem"}},null,-1)]))):(f(),h("div",wo,a[7]||(a[7]=[u("i",{class:"pi pi-circle-fill",style:{color:"red","font-size":"1.5rem"}},null,-1)])))]),editor:d(({data:e,field:l})=>[t(D,{modelValue:e[l],"onUpdate:modelValue":r=>e[l]=r,options:F.value,optionLabel:"name",optionValue:"value"},null,8,["modelValue","onUpdate:modelValue","options"])]),_:1},8,["header"]),t(c,{field:"typeName_zh",header:n.$t("menuPage.nameCN")},{editor:d(({data:e,field:l})=>[t(_,{modelValue:e[l],"onUpdate:modelValue":r=>e[l]=r,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),t(c,{field:"typeName_pt",header:n.$t("menuPage.namePT")},{editor:d(({data:e,field:l})=>[t(_,{modelValue:e[l],"onUpdate:modelValue":r=>e[l]=r,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),t(c,{field:"typeName_en",header:n.$t("menuPage.nameEN")},{editor:d(({data:e,field:l})=>[t(_,{modelValue:e[l],"onUpdate:modelValue":r=>e[l]=r,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),t(c,{field:"minQuantity",header:n.$t("menuPage.min")},{editor:d(({data:e,field:l})=>[t(k,{modelValue:e[l],"onUpdate:modelValue":r=>e[l]=r,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),t(c,{field:"maxQuantity",header:n.$t("menuPage.max")},{editor:d(({data:e,field:l})=>[t(k,{modelValue:e[l],"onUpdate:modelValue":r=>e[l]=r,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),t(c,{rowEditor:!0,style:{width:"10%","min-width":"8rem"},bodyStyle:"text-align:center"})]),_:2},1032,["value","editingRows","onRowEditSave"])])):(f(),h("div",bo,[u("span",Vo,b(g.typeName),1)]))]),_:2},1024)])]),footer:d(()=>a[8]||(a[8]=[u("div",{class:"flex flex-wrap items-center justify-between gap-4"},null,-1)])),icons:d(()=>[t(pe,{ref_for:!0,ref:"menu",id:"config_menu",model:J.value,popup:""},null,8,["model"])]),default:d(()=>[u("div",null,[t(W,{value:g.dishes,editingRows:M.value,"onUpdate:editingRows":a[5]||(a[5]=e=>M.value=e),tableStyle:"min-width: 50rem",editMode:"row",onRowEditSave:e=>le(e,U)},{default:d(()=>[t(c,null,{editor:d(({index:e})=>[t(E,{icon:"pi pi-trash",severity:"danger",text:"",onClick:l=>re(U,e)},null,8,["onClick"])]),_:2},1024),t(c,{field:"dishid",header:"Id"},{editor:d(({data:e,field:l})=>[t(_,{modelValue:e[l],"onUpdate:modelValue":r=>e[l]=r,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(c,{field:"name",header:n.$t("menuPage.name")},{editor:d(({data:e,field:l})=>[t(_,{modelValue:e[l],"onUpdate:modelValue":r=>e[l]=r,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),t(c,{field:"name_zh",header:n.$t("menuPage.nameCN")},{editor:d(({data:e,field:l})=>[t(_,{modelValue:e[l],"onUpdate:modelValue":r=>e[l]=r,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),t(c,{field:"name_en",header:n.$t("menuPage.nameEN")},{editor:d(({data:e,field:l})=>[t(_,{modelValue:e[l],"onUpdate:modelValue":r=>e[l]=r,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),t(c,{field:"name_pt",header:n.$t("menuPage.namePT")},{editor:d(({data:e,field:l})=>[t(_,{modelValue:e[l],"onUpdate:modelValue":r=>e[l]=r,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),t(c,{field:"enable",header:n.$t("menuPage.enableDisable")},{body:d(({data:e,field:l})=>[e[l]===!0?(f(),h("div",_o,a[9]||(a[9]=[u("i",{class:"pi pi-circle-fill",style:{color:"green","font-size":"1.5rem"}},null,-1)]))):(f(),h("div",Po,a[10]||(a[10]=[u("i",{class:"pi pi-circle-fill",style:{color:"red","font-size":"1.5rem"}},null,-1)])))]),editor:d(({data:e,field:l})=>[t(D,{modelValue:e[l],"onUpdate:modelValue":r=>e[l]=r,options:F.value,optionLabel:"name",optionValue:"value"},null,8,["modelValue","onUpdate:modelValue","options"])]),_:1},8,["header"]),t(c,{field:"price",header:n.$t("menuPage.price")},{body:d(({data:e,field:l})=>[Q(b(j(e[l])),1)]),editor:d(({data:e,field:l})=>[t(k,{modelValue:e[l],"onUpdate:modelValue":r=>e[l]=r,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),t(c,{field:"deliveryPrice",header:n.$t("menuPage.deliveryPrice")},{body:d(({data:e,field:l})=>[Q(b(j(e[l])),1)]),editor:d(({data:e,field:l})=>[t(k,{modelValue:e[l],"onUpdate:modelValue":r=>e[l]=r,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),t(c,{rowEditor:!0,bodyStyle:"text-align:center"})]),_:2},1032,["value","editingRows","onRowEditSave"]),u("div",$o,[t(E,{icon:"pi pi-plus",onClick:e=>ie(U)},null,8,["onClick"])])])]),_:2},1032,["onToggle"])]),_:2},1024)])]))),256)):T("",!0)])])])])])],64)}}},Ho=Ye(Do,[["__scopeId","data-v-bfd61b2e"]]);export{Ho as default};
