import{s as F,a as U}from"./index-D_WBTfhe.js";import{s as L}from"./index-xWrz0MLd.js";import{s as P,a as A}from"./index-DTBbdX28.js";import{s as j,a as q}from"./index-CNo1KoG3.js";import{s as E}from"./index-CXmik7hu.js";import{n as o,h as d,y as H,c as v,a as s,d as a,w as i,l as K,F as b,o as h,z as G,x as J,t as c,A as Q,C as W}from"./index-D74LF0Gk.js";import"./index-DL8ZziFC.js";import"./index-DWAAFXTC.js";import"./index-Dwr1cLMP.js";import"./index-RVvJdQzC.js";import"./index-CTt5FH7u.js";import"./index-DN9KWGYM.js";const X={class:"card",style:{display:"flex","flex-direction":"column",height:"75%"}},Y={class:"flex flex-wrap gap-2 items-center justify-between"},Z=["onClick"],ee={style:{"list-style-type":"none","padding-left":"0"}},te={class:"flex flex-wrap p-2 items-center gap-4"},le={style:{"max-width":"200px"}},he={__name:"OrderPage",setup(se){const _=o.orders,p=d(!1),n=d(null),m=d(!1),r=d(null),y=d([{label:"已完成",value:"completed"},{label:"已浏览",value:"readed"},{label:"新订单",value:"new"}]),f=d({global:{value:null,matchMode:H.CONTAINS}}),x=e=>({completed:"已完成",readed:"已浏览",new:"新订单"})[e]||e,C=e=>({completed:"status-completed",readed:"status-readed",new:"status-new"})[e]||"";function S(e){n.value=e,p.value=!1,r.value=e.status,m.value=!0}function D(){r.value!==null&&(n.value.status!==r.value&&(n.value.status==="new"&&o.newOrderCount.value>0&&(o.newOrderCount.value-=1),r.value==="new"&&(o.newOrderCount.value+=1),n.value.status=r.value,o.updateOrderStatus(n.value)),m.value=!1)}const M=e=>new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});function N(e){e.data?(n.value=e.data,p.value=!0,e.data.isNew=!1,e.data.status=="new"&&(e.data.status="readed",o.updateOrderStatus(e.data)),o.decrementOrderCount()):console.error("Row data is missing in the event",e)}function k(e){return o.getDishNameById(e.dishid)}function O(e){return e.dishid?e.dishid:e.name}function V(e){return o.getDishNote(e)}return(e,l)=>{const $=q,I=E,B=j,u=A,R=P,T=F,w=L,z=U;return h(),v(b,null,[s("div",X,[a(R,{value:K(_),tableStyle:"min-width: 50rem",dataKey:"id",paginator:"",rows:5,rowsPerPageOptions:[5,10,20,50],stripedRows:"",filters:f.value,scrollable:"",scrollHeight:"flex",onRowClick:N,selectionMode:"single"},{header:i(()=>[s("div",Y,[l[5]||(l[5]=s("h4",{class:"m-0 font-bold text-2xl text-left flex-grow-1"},"所有订单",-1)),a(B,null,{default:i(()=>[a($,null,{default:i(()=>l[4]||(l[4]=[s("i",{class:"pi pi-search"},null,-1)])),_:1,__:[4]}),a(I,{modelValue:f.value.global.value,"onUpdate:modelValue":l[0]||(l[0]=t=>f.value.global.value=t),placeholder:"查找.."},null,8,["modelValue"])]),_:1})])]),empty:i(()=>l[6]||(l[6]=[s("div",{class:"text-center py-5"},[s("i",{class:"pi pi-search",style:{"font-size":"3rem",color:"#ccc"}}),s("p",{class:"mt-3 text-gray-500"},"未找到匹配的订单")],-1)])),default:i(()=>[a(u,{field:"status",header:"状态",sortable:"",style:{width:"10%"}},{body:i(({data:t})=>[s("span",{class:J(["status-badge",C(t.status)]),onClick:G(g=>S(t),["stop"])},c(x(t.status)),11,Z)]),_:1}),a(u,{field:"id",header:"订单号",sortable:"",style:{width:"10%"}}),a(u,{field:"table",header:"桌号",sortable:"",style:{width:"10%"}}),a(u,{field:"time",header:"时间",sortable:"",style:{width:"20%"}},{body:i(({data:t})=>[Q(c(M(t.timestamp)),1)]),_:1}),a(u,{field:"name",header:"名字",style:{width:"15%"}}),a(u,{field:"note",header:"备注",style:{width:"35%"},class:"multiline-cell"})]),_:1},8,["value","filters"])]),s("div",null,[a(w,{visible:p.value,"onUpdate:visible":l[1]||(l[1]=t=>p.value=t),header:"详细信息",modal:!0,dismissableMask:!0},{default:i(()=>[s("ul",ee,[(h(!0),v(b,null,W(n.value.items,(t,g)=>(h(),v("li",{key:g},[s("div",te,[s("label",null,c(O(t)),1),s("label",null,c(k(t)),1),s("label",null,"x "+c(t.quantity),1),s("label",le,c(V(t.notes)),1)]),a(T)]))),128))])]),_:1},8,["visible"])]),s("div",null,[a(w,{visible:m.value,"onUpdate:visible":l[3]||(l[3]=t=>m.value=t),header:"订单状态",modal:!0,dismissableMask:!0},{default:i(()=>[a(z,{modelValue:r.value,"onUpdate:modelValue":l[2]||(l[2]=t=>r.value=t),options:y.value,optionLabel:"label",optionValue:"value",onClick:D},null,8,["modelValue","options"])]),_:1},8,["visible"])])],64)}}};export{he as default};
