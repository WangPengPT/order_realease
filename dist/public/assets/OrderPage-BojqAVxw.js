import{s as z}from"./index-CcbygsGK.js";import{s as U}from"./index-ph7f-Bih.js";import{s as L}from"./index-D7o03dXP.js";import{s as q,a as A}from"./index-CFt--O9r.js";import{s as E,a as j}from"./index-Br-UpKLP.js";import{s as G}from"./index-Dfd85u33.js";import{q as H,n as o,h as p,s as K,c as h,a as l,d as s,w as r,l as J,F as _,o as g,A as Q,z as W,t as n,C as X,E as Y,e as Z,G as ee}from"./index-BShNAIhh.js";import"./index-CaW9szM_.js";import"./index-BK0Kbx9n.js";import"./index-QIG-zb-E.js";import"./index-BaW51Udu.js";import"./index-aw8HYO3P.js";import"./index-DPWVLdbS.js";import"./index-BjYwmhV5.js";const te={class:"card h-full",style:{display:"flex","flex-direction":"column"}},ae={class:"flex flex-wrap gap-2 items-center justify-between"},le={class:"m-0 font-bold text-2xl text-left flex-grow-1"},se=["onClick"],oe={class:"text-center py-5"},re={class:"mt-3 text-gray-500"},ne={style:{"list-style-type":"none","padding-left":"0"}},de={class:"flex flex-wrap p-2 items-center gap-4"},ie={style:{"max-width":"200px"}},ue={key:0,style:{"max-width":"200px"}},Se={__name:"OrderPage",setup(ce){const{t:u}=H(),y=o.orders,m=p(!1),d=p(null),f=p(!1),i=p(null),P=K(()=>[{label:u("orderPage.completed"),value:"completed"},{label:u("orderPage.read"),value:"readed"},{label:u("orderPage.new"),value:"new"}]),v=p({global:{value:null,matchMode:ee.CONTAINS}}),C=e=>({completed:u("orderPage.completed"),readed:u("orderPage.read"),new:u("orderPage.new")})[e]||e,$=e=>({completed:"status-completed",readed:"status-readed",new:"status-new"})[e]||"";function N(e){d.value=e,m.value=!1,i.value=e.status,f.value=!0}function S(){i.value!==null&&(d.value.status!==i.value&&(d.value.status==="new"&&o.newOrderCount.value>0&&(o.newOrderCount.value-=1),i.value==="new"&&(o.newOrderCount.value+=1),d.value.status=i.value,o.updateOrderStatus(d.value)),f.value=!1)}const x=e=>new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});function D(e){e.data?(d.value=e.data,console.log("selRow.value",d.value),m.value=!0,e.data.isNew=!1,e.data.status=="new"&&(e.data.status="readed",o.updateOrderStatus(e.data),o.decrementOrderCount())):console.error("Row data is missing in the event",e)}function k(e){return o.getDishNameById(e.dishid)}function M(e){return e.dishid?e.dishid:e.name}function V(e){return o.getDishNote(e)}return(e,a)=>{const O=j,I=G,R=E,c=A,B=q,F=L,w=U,T=z;return g(),h(_,null,[l("div",te,[s(B,{value:J(y),tableStyle:"min-width: 50rem",dataKey:"id",paginator:"",rows:5,rowsPerPageOptions:[5,10,20,50],stripedRows:"",filters:v.value,scrollable:"",scrollHeight:"flex",onRowClick:D,selectionMode:"single"},{header:r(()=>[l("div",ae,[l("h4",le,n(e.$t("orderPage.orders")),1),s(R,null,{default:r(()=>[s(O,null,{default:r(()=>a[4]||(a[4]=[l("i",{class:"pi pi-search"},null,-1)])),_:1,__:[4]}),s(I,{modelValue:v.value.global.value,"onUpdate:modelValue":a[0]||(a[0]=t=>v.value.global.value=t),placeholder:e.$t("orderPage.find")},null,8,["modelValue","placeholder"])]),_:1})])]),empty:r(()=>[l("div",oe,[a[5]||(a[5]=l("i",{class:"pi pi-search",style:{"font-size":"3rem",color:"#ccc"}},null,-1)),l("p",re,n(e.$t("orderPage.notFound")),1)])]),default:r(()=>[s(c,{field:"status",header:e.$t("orderPage.status"),sortable:"",style:{width:"10%"}},{body:r(({data:t})=>[l("span",{class:W(["status-badge",$(t.status)]),onClick:Q(b=>N(t),["stop"])},n(C(t.status)),11,se)]),_:1},8,["header"]),s(c,{field:"id",header:e.$t("orderPage.orderNumber"),sortable:"",style:{width:"10%"}},null,8,["header"]),s(c,{field:"table",header:e.$t("orderPage.tableNumber"),sortable:"",style:{width:"10%"}},null,8,["header"]),s(c,{field:"time",header:e.$t("orderPage.time"),sortable:"",style:{width:"20%"}},{body:r(({data:t})=>[X(n(x(t.timestamp)),1)]),_:1},8,["header"]),s(c,{field:"name",header:e.$t("orderPage.name"),style:{width:"15%"}},null,8,["header"]),s(c,{field:"note",header:e.$t("orderPage.notes"),style:{width:"35%"},class:"multiline-cell"},null,8,["header"])]),_:1},8,["value","filters"])]),l("div",null,[s(w,{visible:m.value,"onUpdate:visible":a[1]||(a[1]=t=>m.value=t),header:e.$t("orderPage.details"),modal:!0,dismissableMask:!0},{default:r(()=>[l("ul",ne,[(g(!0),h(_,null,Y(d.value.items,(t,b)=>(g(),h("li",{key:b},[l("div",de,[l("label",null,n(M(t)),1),l("label",null,n(k(t)),1),l("label",null,"x "+n(t.quantity),1),l("label",ie,n(V(t.notes)),1),t.dishNote?(g(),h("label",ue,n(t.dishNote),1)):Z("",!0)]),s(F)]))),128))])]),_:1},8,["visible","header"])]),l("div",null,[s(w,{visible:f.value,"onUpdate:visible":a[3]||(a[3]=t=>f.value=t),header:e.$t("orderPage.orderStatus"),modal:!0,dismissableMask:!0},{default:r(()=>[s(T,{modelValue:i.value,"onUpdate:modelValue":a[2]||(a[2]=t=>i.value=t),options:P.value,optionLabel:"label",optionValue:"value",onClick:S},null,8,["modelValue","options"])]),_:1},8,["visible","header"])])],64)}}};export{Se as default};
