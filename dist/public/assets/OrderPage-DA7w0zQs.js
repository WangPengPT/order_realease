import{s as E}from"./index-BU0uwfvW.js";import{s as L}from"./index-BuIHiXtI.js";import{s as q}from"./index-DwRpaJnS.js";import{s as j,a as G}from"./index-D3CPCLMh.js";import{s as H,a as K}from"./index-BbUAqvfz.js";import{s as J}from"./index-DAeZaIFd.js";import{b as Q}from"./index-COC8oFcs.js";import{q as W,n,h as m,s as X,c as g,a as l,d as o,w as d,l as r,F as x,o as v,A as Y,z as Z,t as i,C as ee,E as te,e as ae,G as se}from"./index-DRbmMKyn.js";import"./index-DDmhQuc-.js";import"./index-BiufwZEc.js";import"./index-BnevbMgH.js";import"./index-DclgPgu7.js";import"./index-CUEIcsH_.js";import"./index-C6LnZFpG.js";import"./index-C_FxmzrS.js";import"./index-DUxpMbcZ.js";import"./index-thKUFPsa.js";import"./index-U1YLbeOS.js";const le={class:"card h-full",style:{display:"flex","flex-direction":"column"}},oe={class:"flex flex-column"},re={class:"flex flex-wrap gap-2 items-center justify-between"},ne={class:"m-0 font-bold text-2xl text-left flex-grow-1"},de=["onClick"],ie={class:"text-center py-5"},ue={class:"mt-3 text-gray-500"},ce={style:{"list-style-type":"none","padding-left":"0"}},pe={class:"flex flex-wrap p-2 items-center gap-4"},me={style:{"max-width":"200px"}},fe={key:0,style:{"max-width":"200px"}},Re={__name:"OrderPage",setup(he){const{t:s}=W(),_=n.orders,f=m(!1),u=m(null),h=m(!1),c=m(null),N=X(()=>[{label:s("orderPage.completed"),value:"completed"},{label:s("orderPage.read"),value:"read"},{label:s("orderPage.new"),value:"new"}]),w=m({global:{value:null,matchMode:se.CONTAINS}}),C=e=>({completed:s("orderPage.completed"),read:s("orderPage.read"),new:s("orderPage.new")})[e]||e,P=e=>({completed:"status-completed",read:"status-read",new:"status-new"})[e]||"";function S(e){u.value=e,f.value=!1,c.value=e.status,h.value=!0}function k(){c.value!==null&&(u.value.status!==c.value&&(u.value.status==="new"&&n.updateNewOrderCount("order",-1),c.value==="new"&&n.updateNewOrderCount("order",1),u.value.status=c.value,n.updateOrderStatus(u.value)),h.value=!1)}function D(){_.value.forEach(e=>{e.status=="new"&&(e.status="read",n.updateOrderStatus(e),n.updateNewOrderCount("order",-1))})}const M=e=>new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});function O(e){e.data?(u.value=e.data,console.log("selRow.value",u.value),f.value=!0,e.data.isNew=!1,e.data.status=="new"&&(e.data.status="read",n.updateOrderStatus(e.data),n.updateNewOrderCount("order",-1))):console.error("Row data is missing in the event",e)}function V(e){const a=n.menuApi.getDishNameById(e.dishid);return a||e.name}function $(e){return e.dishid?e.dishid:e.name}function I(e){return n.getDishNote(e)}return(e,a)=>{const R=Q,B=K,T=J,F=H,p=G,z=j,U=q,b=L,A=E;return v(),g(x,null,[l("div",le,[o(z,{value:r(_),tableStyle:"min-width: 50rem",dataKey:"id",paginator:"",rows:5,rowsPerPageOptions:[5,10,20,50],stripedRows:"",filters:w.value,scrollable:"",scrollHeight:"flex",onRowClick:O,selectionMode:"single"},{header:d(()=>[l("div",oe,[l("div",re,[l("h4",ne,i(r(s)("orderPage.orders")),1),o(R,{label:"将新订单标为已浏览",onClick:a[0]||(a[0]=t=>D())}),o(F,null,{default:d(()=>[o(B,null,{default:d(()=>a[5]||(a[5]=[l("i",{class:"pi pi-search"},null,-1)])),_:1,__:[5]}),o(T,{modelValue:w.value.global.value,"onUpdate:modelValue":a[1]||(a[1]=t=>w.value.global.value=t),placeholder:r(s)("orderPage.find")},null,8,["modelValue","placeholder"])]),_:1})])])]),empty:d(()=>[l("div",ie,[a[6]||(a[6]=l("i",{class:"pi pi-search",style:{"font-size":"3rem",color:"#ccc"}},null,-1)),l("p",ue,i(r(s)("orderPage.notFound")),1)])]),default:d(()=>[o(p,{field:"status",header:r(s)("orderPage.status"),sortable:"",style:{width:"10%"}},{body:d(({data:t})=>[l("span",{class:Z(["status-badge",P(t.status)]),onClick:Y(y=>S(t),["stop"])},i(C(t.status)),11,de)]),_:1},8,["header"]),o(p,{field:"id",header:r(s)("orderPage.orderNumber"),sortable:"",style:{width:"10%"}},null,8,["header"]),o(p,{field:"table",header:r(s)("orderPage.tableNumber"),sortable:"",style:{width:"10%"}},null,8,["header"]),o(p,{field:"time",header:r(s)("orderPage.time"),sortable:"",style:{width:"20%"}},{body:d(({data:t})=>[ee(i(M(t.timestamp)),1)]),_:1},8,["header"]),o(p,{field:"name",header:r(s)("orderPage.name"),style:{width:"15%"}},null,8,["header"]),o(p,{field:"note",header:r(s)("orderPage.notes"),style:{width:"35%"},class:"multiline-cell"},null,8,["header"])]),_:1},8,["value","filters"])]),l("div",null,[o(b,{visible:f.value,"onUpdate:visible":a[2]||(a[2]=t=>f.value=t),header:r(s)("orderPage.details"),modal:!0,dismissableMask:!0},{default:d(()=>[l("ul",ce,[(v(!0),g(x,null,te(u.value.items,(t,y)=>(v(),g("li",{key:y},[l("div",pe,[l("label",null,i($(t)),1),l("label",null,i(V(t)),1),l("label",null,"x "+i(t.quantity),1),l("label",me,i(I(t.notes)),1),t.dishNote?(v(),g("label",fe,i(t.dishNote),1)):ae("",!0)]),o(U)]))),128))])]),_:1},8,["visible","header"])]),l("div",null,[o(b,{visible:h.value,"onUpdate:visible":a[4]||(a[4]=t=>h.value=t),header:r(s)("orderPage.orderStatus"),modal:!0,dismissableMask:!0},{default:d(()=>[o(A,{modelValue:c.value,"onUpdate:modelValue":a[3]||(a[3]=t=>c.value=t),options:N.value,optionLabel:"label",optionValue:"value",onClick:k},null,8,["modelValue","options"])]),_:1},8,["visible","header"])])],64)}}};export{Re as default};
