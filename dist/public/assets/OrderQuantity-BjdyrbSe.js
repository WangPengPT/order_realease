import{s as J}from"./index-DldnobFv.js";import{c as K,s as X,a as q}from"./index-D5U07cox.js";import{s as ee,a as le,b as te,c as ae}from"./index-D6yt7JAx.js";import{s as oe}from"./index-B27FgJRU.js";import{s as re}from"./index-e-6zFyMN.js";import{b as se}from"./index-C3qub9hx.js";import{h as d,n as T,c as x,d as s,a as g,w as i,e as j,j as ne,o as n,l as ie,F as V,A as N,f as k,z as M,t as P}from"./index-B_cus9xz.js";import"./index-Domxww66.js";import"./index-DmWp-WWa.js";import"./index-CB4BZEtY.js";import"./index-BeYd0kyb.js";import"./index-r3Be9ssu.js";import"./index-DhTAwgAX.js";import"./index-DD0tW9vx.js";const ue={class:"flex flex-column w-full",style:{position:"fixed",top:"0",left:"0"}},de={class:"flex flex-wrap justify-content-center align-items-center gap-1 ml-2"},ce={class:"card flex flex-column",style:{height:"calc(100vh - 200px)"}},ve={key:0,style:{padding:"0.5rem 1rem"}},pe=2025,Ne={__name:"OrderQuantity",setup(fe){const S=ne(),c=d(T.menuData.value.filter(l=>l.category));R();const z=d([{id:0,label:"隐藏销售量为0的菜品"},{id:1,label:"展示销售量为0的菜品"}]),w=d(),A=new Date,b=A.getFullYear(),O=A.getMonth()+1,Y=A.getDate(),B=d([{id:0,value:0,label:"总评分"}]);F();function F(){for(let l=pe;l<=b;l++)B.value.push({id:l,value:l,label:l})}const D=d([]);U();function U(){const l=["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"];D.value.push({id:0,value:"yearTotal",label:"当年总销售量"});for(let e=0;e<l.length;e++)D.value.push({id:e+1,value:l[e],label:e+1+" - "+l[e].toUpperCase()})}const I=[[{id:0,label:"当月总销售量"},...Array.from({length:28},(l,e)=>({id:e+1,label:e+1}))],[{id:0,label:"当月总销售量"},...Array.from({length:29},(l,e)=>({id:e+1,label:e+1}))],[{id:0,label:"当月总销售量"},...Array.from({length:30},(l,e)=>({id:e+1,label:e+1}))],[{id:0,label:"当月总销售量"},...Array.from({length:31},(l,e)=>({id:e+1,label:e+1}))]],L=d([]);Q(b,O);function Q(l,e){if(e<1||e>12)return 0;const o=[3,l&&(l%4===0&&l%100!==0||l%400===0)?1:0,3,2,3,2,3,3,2,3,2,3];L.value=I[o[e-1]]}async function R(){try{await T.refreshMenu(),$(b,O,Y)}catch(l){console.error("获取销售量失败:",l),toast.add({severity:"error",summary:"错误",detail:"获取销售量失败",life:3e3})}}function $(l,e,t){u.value!==e&&Q(l,e),v.value=l,u.value=e,t=t|0,c.value=[],E(c,l,e,t,()=>{H()})}function E(l,e,t,o,_){e==0||e==b&&t==0||e==b&&t==O&&o==0||e==b&&t==O&&o==Y?l.value=T.menuData.value:(t===0&&(o=0),T.getOrderQuantityWithDate(l,e,t,o,()=>{_()})),_(),c.value=c.value.filter(y=>y.category)}function H(){var _,y;const l=v.value,e=u.value,t=p.value.id,o=[];for(let h=0;h<c.value.length;h++){const r=c.value[h];let f=0;l||(f=r.orders|0),l&&!e&&(f=r.yearlyOrders|0),l&&e&&!t&&(f=r.monthlyOrders|0),l&&e&&t&&(f=r.dailyOrders|0),r.filteredOrders=f,w.value?(!((_=w.value)!=null&&_.id)&&r.filteredOrders||(y=w.value)!=null&&y.id&&!r.filteredOrders)&&o.push(r):o.push(r)}c.value=o}const v=d(b),u=d(O),p=d(L.value.find(l=>l.id===Y));return(l,e)=>{const t=se,o=re,_=oe,y=te,h=le,r=ae,f=ee,W=K,C=q,Z=X,G=J;return n(),x("div",ue,[s(_,{class:"bg-primary text-white p-2"},{start:i(()=>[s(t,{icon:"pi pi-arrow-left",class:"p-button-text text-white",label:"主页",onClick:e[0]||(e[0]=a=>ie(S).push("/"))}),g("div",de,[s(o,{modelValue:w.value,"onUpdate:modelValue":e[1]||(e[1]=a=>w.value=a),options:z.value,optionLabel:"label",unselectable:!1,onChange:e[2]||(e[2]=a=>$(v.value,u.value,p.value.id))},null,8,["modelValue","options"])])]),_:1}),g("div",null,[s(f,{value:v.value},{default:i(()=>[s(h,null,{default:i(()=>[(n(!0),x(V,null,N(B.value,a=>(n(),k(y,{key:a.id,value:a.id,onClick:m=>$(a.id,u.value,p.value.id)},{default:i(()=>[M(P(a.label),1)]),_:2},1032,["value","onClick"]))),128))]),_:1}),(n(!0),x(V,null,N(B.value,a=>(n(),k(r,{key:a.id,value:a.id},{default:i(()=>[v.value!==0?(n(),k(f,{key:0,value:u.value,scrollable:""},{default:i(()=>[s(h,null,{default:i(()=>[(n(!0),x(V,null,N(D.value,m=>(n(),k(y,{key:m.id,value:m.id,onClick:me=>$(a.id,m.id,p.value.id)},{default:i(()=>[M(P(m.label),1)]),_:2},1032,["value","onClick"]))),128))]),_:2},1024),(n(!0),x(V,null,N(D.value,m=>(n(),k(r,{key:m.id,value:m.id},null,8,["value"]))),128))]),_:2},1032,["value"])):j("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),g("div",ce,[v.value&&u.value?(n(),x("div",ve,[s(W,{modelValue:p.value,"onUpdate:modelValue":e[3]||(e[3]=a=>p.value=a),options:L.value,optionLabel:"label",placeholder:"选择日期",onChange:e[4]||(e[4]=a=>$(v.value,u.value,p.value.id))},null,8,["modelValue","options"]),e[5]||(e[5]=g("label",null," 日",-1))])):j("",!0),s(Z,{value:c.value,stripedRows:"",scrollable:"",scrollHeight:"flex",paginator:"",rows:10,rowsPerPageOptions:[5,10,20,50],tableStyle:"min-width: 50rem"},{empty:i(()=>e[6]||(e[6]=[g("div",{class:"text-center py-5"},[g("i",{class:"pi pi-search",style:{"font-size":"3rem",color:"#ccc"}}),g("p",{class:"mt-3 text-gray-500"},"未找到销售量")],-1)])),default:i(()=>[s(C,{field:"id",header:"ID",sortable:""}),s(C,{field:"category",header:"类型",sortable:""}),s(C,{field:"name",header:"菜名"}),s(C,{field:"filteredOrders",header:(v.value===0?"":u.value===0?"当年":p.value.id===0?"当月":"当日")+"销售量",sortable:""},null,8,["header"])]),_:1},8,["value"])])]),s(G)])}}};export{Ne as default};
