import{g as tt,r as st}from"./vendor-DYQJwaLu.js";import{O as ue,r as w,o as ge,c as m,d as a,e,z as g,F as j,E as Z,s as D,v as ce,t as o,S as t,q as N,B as Ie,p as J,h as ye,R as Je,w as he,y as ie,l as lt,D as at,H as nt,n as He,P as ot,Q as it}from"./vue-CYwjs0iE.js";import{g as $e,a as P,d as ve,h as rt,i as Ue,f as Oe,j as ze,u as ut,k as Le,l as Re,m as Ee,c as Pe,n as ct,o as Ve,b as Ae,p as dt,q as mt,r as ft,e as vt,v as ht,w as pt}from"./primevue-_QN95vq9.js";import{c as k,m as Y,a as fe,g as yt}from"./index-Qjw8J1Y8.js";import{D as z,c as oe,l as Be}from"./localforage-cPbLbd56.js";import{_ as _e}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as bt,S as gt}from"./pagination-BQSAUmfl.js";var _t=st();const Me=tt(_t),xt={class:"grid"},kt={key:0,class:"col-12 sm:col-12 md:col-6 lg:col-4 border-round surface-section shadow-1 p-2"},wt={class:"flex flex-column"},$t=["onClick"],Dt={class:"p-1 flex-shrink-0 w-7rem h-7rem flex align-items-center justify-content-center overflow-hidden"},It=["src","alt"],Ct={class:"flex flex-column justify-content-center"},Tt={class:"font-bold"},Nt={class:"flex flex-wrap gap-2"},qt={class:"flex gap-1 align-items-center"},St={class:"text-color-secondary line2"},At={key:0,class:"text-xl font-bold text-primary"},Mt={key:1,class:"flex align-items-center gap-1"},Lt={class:"text-l font-bold text-color-secondary"},Rt={class:"text-sm line-through text-500"},Et={key:2,class:"flex gap-2 mr-2",id:"card-quantity"},Pt={class:"w-2rem text-xl text-center"},Vt={key:3,class:"flex gap-2 mr-2"},Ot={key:0,class:"m-2 mt-0"},jt={class:"flex flex-row justify-content-between align-content-center"},Ft={class:"flex flex-column"},Wt={class:"text-l font-bold"},Ht={key:0,class:"text-l font-bold text-color-secondary"},Ut={key:1,class:"flex align-items-center gap-1"},zt={class:"text-l font-bold text-color-secondary"},Bt={class:"text-sm line-through text-500"},Qt={key:0,class:"flex ml-2 mr-2"},Jt={class:"w-2rem text-xl text-center"},Kt={key:1,class:"flex gap-2 mr-3 pt-2 pb-2"},Gt={class:"mb-2 flex justify-content-center"},Xt={class:"font-bold text-center"},Yt={class:"mb-2"},Zt={class:"text-color-secondary m-0 line-height-3 line2 text-center"},es={class:"mb-2"},ts={class:"flex justify-content-center"},ss=["src","alt"],ls={class:"flex align-items-center gap-2"},as=["src","alt"],ns={class:"flex align-items-center gap-3 ml-auto"},os={__name:"DishList",props:{rateDish:{type:Function,required:!0},likedItemsRef:Array,dislikedItemsRef:Array,tabIndex:Number,onlyVeg:Boolean},setup(q){const{t:U}=ue(),$=z.dishDatas,E=w(null),_=q,C=(u,S=!0)=>{if(!_.onlyVeg)return!0;if(S)return u.vegetable;if(u.subItems.length>0){for(const f of u.subItems)if(f.vegetable)return!0}else return u.dish.vegetable;return!1};ge(()=>{let u=k.getOrderMenuTab()[_.tabIndex];if(k.customDishAPI.customDishes.value.map(c=>c.name),k.getMenu().length==0){console.log("exit");return}E.value=$.value[f($.value,u)].mainDishes,z.showDishList(E.value);function f(c,b){for(const s in c)if(c[s].name==b)return s;console.error("Can not find tab index in menu")}});let i={rated:!1,id:null,like:0,rate:0};const L=u=>z.dishDatas.value[u]?z.dishDatas.value[u].quantity:0,y=u=>{if(!V())return!1;const S=u.quantity;let f=3;if(u.price>0&&(f=9),u.limit){const c=u.id,b=V(),s=(b.peopleType.adults+b.peopleType.children)*u.limit,d=b.order.find(v=>v.dishid==c);let r=0;if(u.subitem)for(const v of u.subitem){r+=L(v);const x=b.order.find(B=>B.dishid==R(v));x&&(r+=x.quantity)}else r+=u.quantity,d&&(r+=d.quantity);return S>=f||s&&r>=s}return S>=f},R=u=>z.dishDatas.value[u]?z.dishDatas.value[u].id:0,V=()=>k.getTableValue(),F=u=>{let S="absolute origin-top-left mt-1 ml-1 border-round-lg pl-1 pr-1 text-xs text-white font-bold ";switch(u){case"new":S+="bg-red-600";break;case"recommended":case"special":S+="bg-orange-600";break;default:S+="bg-blue-600"}return S};function I(u){_.rateDish(i.id,i.like,i.rate,i.rated),W(u,i.rate,i.like),i.id=null,i.like=0,i.rate=0,i.rated=!1}const A=u=>{const S=_.likedItemsRef.indexOf(u);if(i.id=u.id,S!==-1)_.likedItemsRef.splice(S,1),i.like+=-1,i.rate+=-1,i.rated=!1;else{i.rated=!0,_.likedItemsRef.push(u);const f=_.dislikedItemsRef.indexOf(u);f!==-1?(_.dislikedItemsRef.splice(f,1),i.like+=1):(i.like+=1,i.rate+=1)}I(u)};function W(u,S=0,f=0){u.rates=(u.rates||0)+S,u.likes=(u.likes||0)+f}const K=u=>{const S=_.dislikedItemsRef.indexOf(u);if(i.id=u.id,S!==-1)_.dislikedItemsRef.splice(S,1),i.rate+=-1,i.rated=!1;else{i.rated=!0,_.dislikedItemsRef.push(u);const f=_.likedItemsRef.indexOf(u);f!==-1?(_.likedItemsRef.splice(f,1),i.like+=-1):i.rate+=1}I(u)},G=w(!1),O=w({}),ne=u=>{G.value=!0,O.value=u},te=u=>{u.target.src="/images/default.png"};function se(u){le(u.target,300)}function re(u){le(u.target,110)}function le(u,S){const f=u.naturalWidth,c=u.naturalHeight,b=Math.min(f,S),s=b/f,d=c*s;u.style.width=`${b}px`,u.style.height=`${d}px`}return(u,S)=>(a(),m(j,null,[e("div",xt,[(a(!0),m(j,null,Z(E.value,(f,c)=>{var b;return a(),m(j,{key:c},[C(f,!1)?(a(),m("div",kt,[e("div",wt,[e("div",{class:ce(["flex flex-row",f.subItems.length!==0?"flex-grow-1":""]),onClick:s=>ne(f.dish)},[((b=f.dish.etiquette)==null?void 0:b.length)>0?(a(),m("div",{key:0,class:ce(F(f.dish.etiquette))},o(t(U)("common.etiquette."+f.dish.etiquette)),3)):D("",!0),e("div",Dt,[e("img",{src:f.dish.image||"/images/default.png",alt:f.dish.name,class:"w-full h-full",style:{"object-fit":"cover"},onError:te,onLoad:re},null,40,It)]),e("div",Ct,[e("div",Tt,o(f.dish.name),1),e("div",null,[e("div",Nt,[e("div",qt,[(a(),m(j,null,Z(5,s=>e("i",{key:s,class:ce(["pi invert-star",s<=Math.floor(f.dish.likes/f.dish.rates*5)?"pi-star-fill":s-.5<=f.dish.likes/f.dish.rates*5?"pi-star-half-fill":"pi-star"]),style:{color:"black"}},null,2)),64)),e("p",null,"("+o(f.dish.rates?f.dish.rates:0)+")",1)])])]),e("div",null,[e("p",St,o(f.dish.note),1)])])],10,$t),f.subItems.length==0?(a(),m("div",{key:0,class:ce(["flex ml-2 mr-2 mb-2",Number(f.dish.price)>0?"justify-content-between":"justify-content-end"])},[!f.dish.discount&&Number(f.dish.price)>0?(a(),m("span",At,"â‚¬"+o(f.dish.price),1)):D("",!0),f.dish.discount?(a(),m("div",Mt,[e("span",Lt,"â‚¬"+o(f.dish.dis_price),1),e("span",Rt,"â‚¬"+o(f.dish.price),1),g(t($e),{severity:"danger",value:"-"+f.dish.discount+"%"},null,8,["value"])])):D("",!0),f.dish.soldout?D("",!0):(a(),m("div",Et,[g(t(P),{icon:"pi pi-minus",rounded:"",disabled:f.dish.quantity<=0,onClick:s=>f.dish.quantity--,class:"w-2rem h-2rem"},null,8,["disabled","onClick"]),e("span",Pt,o(f.dish.quantity),1),g(t(P),{icon:"pi pi-plus",rounded:"",disabled:y(f.dish),onClick:s=>f.dish.quantity++,class:"w-2rem h-2rem"},null,8,["disabled","onClick"])])),f.dish.soldout?(a(),m("div",Vt,[g(t($e),{severity:"danger",value:u.$t("common.soldout")},null,8,["value"])])):D("",!0)],2)):D("",!0),f.subItems.length!==0?(a(!0),m(j,{key:1},Z(f.subItems,(s,d)=>(a(),m(j,{key:"index"},[!s.disable&&C(s)?(a(),m("div",Ot,[e("div",jt,[e("div",Ft,[e("span",Wt,o(s.subname),1),!s.discount&&s.price!=="0.00"&&s.price!=="0"?(a(),m("span",Ht,"â‚¬"+o(s.price),1)):D("",!0),s.discount?(a(),m("div",Ut,[e("span",zt,"â‚¬"+o(s.dis_price),1),e("span",Bt,"â‚¬"+o(s.price),1),g(t($e),{severity:"danger",value:"-"+s.discount+"%"},null,8,["value"])])):D("",!0)]),s.soldout?D("",!0):(a(),m("div",Qt,[g(t(P),{icon:"pi pi-minus",rounded:"",disabled:s.quantity<=0,onClick:r=>s.quantity--,class:"w-2rem h-2rem"},null,8,["disabled","onClick"]),e("span",Jt,o(s.quantity),1),g(t(P),{icon:"pi pi-plus",rounded:"",onClick:r=>s.quantity++,class:"w-2rem h-2rem",disabled:y(s)},null,8,["onClick","disabled"])])),s.soldout?(a(),m("div",Kt,[g(t($e),{severity:"danger",value:u.$t("common.soldout")},null,8,["value"])])):D("",!0)])])):D("",!0)],64))),128)):D("",!0)])])):D("",!0)],64)}),128))]),g(t(ve),{visible:G.value,"onUpdate:visible":S[2]||(S[2]=f=>G.value=f),modal:"",header:" ",style:Ie([{width:"23rem"},{width:"80vw","max-width":"700px"}]),pt:{header:{class:"p-1"}}},{default:N(()=>[e("div",Gt,[e("span",Xt,o(O.value.name),1)]),e("div",Yt,[e("span",Zt,o(O.value.note),1)]),e("div",es,[e("div",ts,[e("img",{class:"w-full h-auto object-contain",src:O.value.image,alt:O.value.name,onError:te,onLoad:se},null,40,ss)])]),e("div",ls,[(a(!0),m(j,null,Z(O.value.allergies,(f,c)=>(a(),m("img",{src:"images/"+f+".png",alt:f,class:"w-2rem h-2rem border-round flex-shrink-0",style:{"object-fit":"cover","min-width":"2rem"}},null,8,as))),256)),e("div",ns,[e("button",{onClick:S[0]||(S[0]=f=>A(O.value)),class:"p-0 border-none bg-transparent cursor-pointer"},[e("i",{class:ce(["pi pi-thumbs-up text-xl",_.likedItemsRef.includes(O.value)?"text-green-500":"text-gray-400"])},null,2)]),e("button",{onClick:S[1]||(S[1]=f=>K(O.value)),class:"p-0 border-none bg-transparent cursor-pointer"},[e("i",{class:ce(["pi pi-thumbs-down text-xl",_.dislikedItemsRef.includes(O.value)?"text-red-500":"text-gray-400"])},null,2)])])])]),_:1},8,["visible"])],64))}},is=_e(os,[["__scopeId","data-v-51ff8788"]]),rs={key:0,class:"text-3xl font-bold"},us={class:"flex flex-column gap-3 p-1"},cs={key:0,class:"flex flex-column gap-1"},ds={key:0,class:"m-0"},ms={key:0,class:"m-0"},fs={class:"flex justify-content-between gap-4 mt-1"},vs={class:"flex align-items-center gap-2"},hs=["src","alt"],ps={class:"flex-grow-1 min-width-0 max-w-18rem"},ys={class:"flex flex-column gap-1"},bs={class:"flex align-items-center gap-2"},gs={class:"text-xl font-bold line1 whitespace-nowrap overflow-hidden text-overflow-ellipsis",style:{"max-width":"20rem"}},_s={class:"flex align-items-end gap-1"},xs={key:0,class:"text-xl font-bold text-primary"},ks={key:1,class:"text-xl font-bold text-primary"},ws={key:2,class:"text-sm text-color-secondary"},$s={key:0,class:"text-xs text-primary"},Ds={class:"flex-shrink-0 flex flex-wrap justify-content-between align-items-center gap-1"},Is={class:"flex flex-wrap justify-content-between align-content-center"},Cs={class:"flex align-items-center gap-1"},Ts={class:"w-2rem text-center"},Ns={key:1,class:"flex flex-column gap-2 mt-2"},qs={for:"in_label"},Ss={for:"in_label"},As={class:"bottom-0 left-0 mt-2"},Ms={class:"text-2xl font-bold"},Ls={class:"text-2xl font-bold text-primary pl-2"},Rs={class:"flex justify-content-between"},Es={__name:"Cart",props:{checkout:{type:Function,required:!0},isTakeaway:Boolean},setup(q,{expose:U}){const{locale:$}=ue(),E=Je(),{t:_}=ue(),C=oe.cartDishs,i=w([]),L=w(),y=w(),R=w(!1),V=w(!1),F=w(!0),I=w(""),A=w("");function W(r,v,x){let B="";const T=$.value,H=k.customDishAPI.getCustomDishByName(r);for(const X of x){const de=H.types[v].dishes.find(me=>me.dishid===X.id)[`name_${T}`];B=B+de+"/"}return B}function K(r,v){const x=$.value;return k.customDishAPI.getCustomDishByName(r).types[v][`typeName_${x}`]}const G=(r,v)=>{const x=i.value[r].quantity+v;x>=0&&(i.value[r].quantity=x)};function O(r){r&&L.value&&(L.value.dishNote=y.value?y.value:void 0),V.value=!1}function ne(){y.value&&(y.value=void 0),L.value&&(L.value=void 0)}function te(r){L.value=r,y.value=L.value.dishNote?L.value.dishNote:void 0,V.value=!0}const se=q;U({showDishList:r=>{R.value=!0,i.value.length=0;for(let v=0;v<r.length;v++)i.value.push(r[v]);F.value=i.value.length==0&&C.length==0}});function le(r){oe.removeItem(r)}function u(){se.isTakeaway?S():f()}function S(){const r=[];C.value.forEach(v=>{r.push(v)}),i.value.forEach(v=>{v.quantity>0&&r.push(v)}),r.length<=0?Y.show_warn(_("notification.select_at_least_one")):(R.value=!1,E.push({path:"/paymentPage"}))}function f(){se.checkout({name:I.value,note:A.value},r=>{r.success&&(C.value.forEach(v=>{v.dishNote=void 0}),i.value.forEach(v=>{v.dishNote=void 0}),A.value="",z.cleanDishDataQty(),fe.deleteCookie("cartDish_normal"),oe.cleanAll(),fe.deleteCookie("cartDish_custom"))})&&(R.value=!1)}function c(r){return r.subname!=""&&r.subname!="Default Title"?r.name+" "+r.subname:r.name}function b(){let r=0;return C.value.forEach(v=>{r+=v.discount?(v.dis_price?v.dis_price:0)*v.count:(v.price?v.price:0)*v.count}),i.value.forEach(v=>{r+=v.discount?(v.dis_price?v.dis_price:0)*v.quantity:(v.price?v.price:0)*v.quantity}),"â‚¬"+r.toFixed(2)}const s=r=>{r.target.src="/images/default.png"},d=r=>{const v=r.quantity;let x=3;return r.price>0&&(x=9),v>=x};return(r,v)=>(a(),m(j,null,[g(t(ve),{class:"bg-primary-reverse text-sm md:text-lg lg:text-xl",visible:R.value,"onUpdate:visible":v[2]||(v[2]=x=>R.value=x),modal:"",header:r.$t("common.cart"),style:Ie([{backgroundColor:"rgba(250, 250, 250, 1)",height:"100%",minWidth:"24rem"},{width:"80vw","max-width":"700px"}]),dismissableMask:!0},{footer:N(()=>[e("div",As,[e("span",Ms,o(r.$t("common.total"))+": ",1),e("span",Ls,o(b()),1),g(t(P),{icon:q.isTakeaway?"pi pi-wallet":"pi pi-plus",class:"p-button-success p-button-rounded ml-3",onClick:u,label:q.isTakeaway?t(_)("common.pay"):t(_)("common.send")},null,8,["icon","label"])])]),default:N(()=>[F.value?(a(),m("h2",rs,"Cart is empty.")):D("",!0),e("div",us,[(a(!0),m(j,null,Z(t(C),(x,B)=>(a(),J(t(rt),{style:{overflow:"hidden"},key:B},{title:N(()=>[ye(o(r.$t(`common.${x.name}`)),1)]),subtitle:N(()=>[ye(o(r.$t("common.price"))+" : "+o(x.price)+"â‚¬",1)]),content:N(()=>[t(k).customDishAPI.customDishes.value.find(T=>T.name==x.name)?(a(),m("div",cs,[(a(!0),m(j,null,Z(x.notesAndId,(T,H)=>(a(),m("div",null,[x.notesAndId[H].length!==0?(a(),m("span",ds,o(K(x.name,H))+": "+o(W(x.name,H,T)),1)):D("",!0)]))),256)),e("div",null,[x.dishNote?(a(),m("span",ms,o(r.$t("common.note"))+": "+o(x.dishNote),1)):D("",!0)])])):D("",!0)]),footer:N(()=>[e("div",fs,[q.isTakeaway?D("",!0):(a(),J(t(P),{key:0,label:t(_)("common.edit")+" "+t(_)("common.note"),severity:"contrast",onClick:T=>te(x)},null,8,["label","onClick"])),g(t(P),{label:t(_)("common.remove"),severity:"danger",onClick:T=>le(x)},null,8,["label","onClick"])])]),_:2},1024))),128)),(a(!0),m(j,null,Z(i.value,(x,B)=>(a(),m("div",{key:B,class:"p-2 border-round shadow-1 transition-all transition-duration-200 hover:shadow-3 flex flex-column gap-1"},[e("div",vs,[e("img",{src:x.image,alt:x.name,class:"w-4rem h-4rem border-round flex-shrink-0",onError:s,style:{"object-fit":"cover","min-width":"4rem"}},null,40,hs),e("div",ps,[e("div",ys,[e("div",bs,[e("span",gs,o(c(x)),1)])]),e("div",_s,[x.discount?(a(),m("span",xs,"â‚¬"+o(Number(x.dis_price?x.dis_price:0).toFixed(2)),1)):D("",!0),x.discount?D("",!0):(a(),m("span",ks,"â‚¬"+o(Number(x.price?x.price:0).toFixed(2)),1)),x.price>0?(a(),m("span",ws,"/uni.")):D("",!0)])])]),e("div",null,[x.dishNote?(a(),m("span",$s,o(t(_)("common.note")+": "+x.dishNote),1)):D("",!0)]),e("div",Ds,[e("div",Is,[q.isTakeaway?D("",!0):(a(),J(t(P),{key:0,label:t(_)("common.edit")+" "+t(_)("common.note"),severity:"contrast",class:"w-3.5rem h-2rem",onClick:T=>te(x)},null,8,["label","onClick"]))]),e("div",Cs,[g(t(P),{icon:"pi pi-minus",rounded:"",disabled:x.quantity<=0,onClick:T=>G(B,-1),class:"w-2rem h-2rem"},null,8,["disabled","onClick"]),e("span",Ts,o(x.quantity),1),g(t(P),{icon:"pi pi-plus",rounded:"",disabled:d(x),onClick:T=>G(B,1),class:"w-2rem h-2rem"},null,8,["disabled","onClick"])])])]))),128))]),q.isTakeaway?D("",!0):(a(),m("div",Ns,[g(t(Ue),{variant:"in"},{default:N(()=>[g(t(Oe),{id:"in_label",modelValue:I.value,"onUpdate:modelValue":v[0]||(v[0]=x=>I.value=x),variant:"filled",maxlength:"20"},null,8,["modelValue"]),e("label",qs,o(t(_)("common.name")),1)]),_:1}),g(t(Ue),{variant:"in"},{default:N(()=>[g(t(ze),{id:"in_label",class:"min-w-full",rows:"5",modelValue:A.value,"onUpdate:modelValue":v[1]||(v[1]=x=>A.value=x),variant:"filled",maxlength:"200"},null,8,["modelValue"]),e("label",Ss,o(t(_)("common.observation")),1)]),_:1})]))]),_:1},8,["visible","header"]),g(t(ve),{visible:V.value,"onUpdate:visible":v[6]||(v[6]=x=>V.value=x),header:t(_)("common.note"),onHide:v[7]||(v[7]=x=>ne()),modal:"",dismissableMask:!0},{default:N(()=>[g(t(ze),{modelValue:y.value,"onUpdate:modelValue":v[3]||(v[3]=x=>y.value=x),rows:"5",cols:"30",placeholder:t(_)("common.edit")+" "+t(_)("common.note")+"...",maxlength:"100"},null,8,["modelValue","placeholder"]),e("div",Rs,[g(t(P),{label:t(_)("common.cancel"),severity:"danger",onClick:v[4]||(v[4]=x=>O(!1))},null,8,["label"]),g(t(P),{label:t(_)("common.save"),severity:"primary",size:"sm",onClick:v[5]||(v[5]=x=>O(!0))},null,8,["label"])])]),_:1},8,["visible","header"])],64))}},Ps=_e(Es,[["__scopeId","data-v-d07e0759"]]);w([]);w("iniImages()");const Vs={class:"m-3"},Os={class:"flex flex-column gap-2"},js={class:"w-full flex justify-content-center"},Fs={key:0,class:"max-w-19rem"},Ws=["src"],Hs={style:{width:"300px",height:"300px",background:"url(/boxImage/box.png)"}},Us={key:0,class:"flex align-items-center justify-content-center text-4xl font-bold text-white w-full h-full"},zs={key:1,class:"grid m-0 p-2"},Bs=["onClick"],Qs={class:"flex align-items-center justify-content-center font-bold m-0 p-0",style:{width:"94px",height:"94px"}},Js=["src"],Ks={class:"flex flex-wrap justify-content-between align-items-center m-1"},Gs={class:"flex gap-1 align-items-center"},Xs={key:0},Ys={class:"font-bold mb-2"},Zs={key:1,class:"flex justify-content-between gap-2 mt-3"},el={class:"font-bold mb-2"},tl={class:"flex mr-2"},sl={class:"w-3rem text-xl text-center"},ll={class:"font-bold block mb-2"},al={class:"flex flex-wrap"},nl={key:2,class:"flex flex-wrap gap-2 mt-3"},ol={class:"font-bold block mb-2"},il={class:"font-bold block mb-2 text-center"},rl={class:"flex flex-wrap gap-2 mt-3"},ul={__name:"CustomDish",props:{currentCustomDish:Object,tabindex:Number},emits:["typeClick"],setup(q,{emit:U}){const{locale:$}=ue(),E=q,_=ut(),{t:C}=ue(),i=w(null);he(()=>E.currentCustomDish,c=>{c&&(i.value=c)},{immediate:!0,deep:!0});const L=ie(()=>i.boxImages),y=w(0),R=ie(()=>{var b;if(i.value==null)return 0;let c=(b=i.value)==null?void 0:b.initialPrice;for(const s of i.value.types??[])for(const d of s.dishes??[])d.selected&&(c+=d.price);return Number(c).toFixed(2)}),V=U,F=w(null),I=ie(()=>{const c=$.value,b=`title_${c}`,s=`description_${c}`;return i.value==null?{}:i.value.descriptions.map(d=>({title:d[b],descriptions:d.descriptions.map(r=>r[s]),image:d==null?void 0:d.image}))}),A=ie(()=>{var s,d;const c=Number(((s=i.value)==null?void 0:s.like)??0),b=Number(((d=i.value)==null?void 0:d.rate)??0);return b?c/b*5:0});function W(c,b){const s=$.value;return c[`${b}_${s}`]}function K(c,b,s){const d=c[b];if(d.selected){d.selected=!1;return}else{const v=c.filter(x=>x.selected).length;if(s===1){u(c),d.selected=!0;return}v<s&&(d.selected=!0)}}function G(c,b,s){const d=c.dishes;V("typeClick",c,b,d[b].selected),K(d,b,s)}function O(c){return c.selected}function ne(){if(!S(i.value.types))return;const c=se(i.value.types),b=re(i.value.types);oe.addItem({dishid:-1,name:i.value.name,category:E.currentCustomDish.category,count:y.value!==0?y.value:1,price:R.value,notes:c,notesAndId:b}),console.log("CART: ",oe.cartDishs),le(i.value.types),Y.show({severity:"info",summary:"info",detail:C("customDishBibimbapVue.addToCartSuccessBibimbap")})}function te(c){return!c||!c.dishes?"":c.dishes.filter(s=>s.selected).map(s=>s.name).join(",")}function se(c){return c?c.map(b=>te(b)):[]}function re(c){return c?c.map(b=>b.dishes?b.dishes.filter(s=>s.selected).map(s=>({id:s.dishid,name:s.name})):[]):[]}function le(c){c&&c.forEach(b=>{b.dishes&&b.dishes.forEach(s=>{s.selected=!1})})}function u(c){c.forEach(b=>b.selected=!1)}function S(c){if(i.value.options.quantity&&y.value<=0)return Y.show({severity:"warn",detail:C("notification.quantity_must_be_positive")}),!1;for(const b of c)if(b.dishes.filter(d=>d.selected).length<b.minQuantity){const d=b.typeName;return Y.show({severity:"warn",detail:C("notification.select_type_of",{name:d})}),!1}return!0}function f(c){c?k.customDishAPI.like(i.value.id)&&(F.value="like",_.add({severity:"success",summary:C("common.success"),detail:C("common.rate")+" "+C("common.success"),life:750})):k.customDishAPI.unLike(i.value.id)&&(F.value="unlike",_.add({severity:"success",summary:C("common.success"),detail:C("common.rate")+" "+C("common.success"),life:750}))}return(c,b)=>{var s,d,r,v,x,B;return a(),m("div",Vs,[e("div",Os,[g(t(Pe),{class:"w-full max-w-xl mx-auto"},{default:N(()=>[(a(!0),m(j,null,Z(I.value,(T,H)=>(a(),J(t(Le),{key:H,value:H},{default:N(()=>[g(t(Re),null,{default:N(()=>[ye(o(T.title),1)]),_:2},1024),g(t(Ee),null,{default:N(()=>{var X;return[(a(!0),m(j,null,Z(T.descriptions,(de,me)=>(a(),m("p",{key:me},o(de),1))),128)),e("div",js,[(X=T.image)!=null&&X.src?(a(),m("div",Fs,[e("img",{src:T.image.src,class:"w-full"},null,8,Ws)])):D("",!0)])]}),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1}),((d=(s=i.value)==null?void 0:s.value)==null?void 0:d.name)==="MY BOX"?(a(),J(t(Pe),{key:0,class:"w-full max-w-xl mx-auto"},{default:N(()=>[g(t(Le),{value:"0"},{default:N(()=>[g(t(Re),null,{default:N(()=>[ye(" ðŸ¥© "+o(c.$t("common.showMybox")),1)]),_:1}),g(t(Ee),null,{default:N(()=>[e("div",Hs,[c.isEmptyArray(L.value)?(a(),m("div",Us,o(c.$t("common.myboxAlarm")),1)):D("",!0),c.isEmptyArray(L.value)?D("",!0):(a(),m("div",zs,[(a(!0),m(j,null,Z(L.value,T=>(a(),m("div",{class:"col-4 p-0",onClick:H=>c.imageSelectAction(T)},[e("div",Qs,[T?(a(),m("img",{key:0,class:"m-0 p-0",src:c.imagePath(T),style:{width:"82px",height:"82px"}},null,8,Js)):D("",!0)])],8,Bs))),256))]))])]),_:1})]),_:1})]),_:1})):D("",!0)]),e("div",Ks,[e("div",Gs,[(a(),m(j,null,Z(5,T=>e("i",{key:T,class:ce(["pi invert-star",T<=Math.floor(A.value)?"pi-star-fill":T-.5<=A.value?"pi-star-half":"pi-star"]),style:{color:"black"}},null,2)),64)),e("p",null,"("+o((r=i.value)!=null&&r.rate?i.value.rate:0)+")",1)]),e("div",null,[g(t(P),{text:"",icon:"pi pi-thumbs-up",severity:F.value==="like"?"success":"",onClick:b[0]||(b[0]=T=>f(!0))},null,8,["severity"]),g(t(P),{text:"",icon:"pi pi-thumbs-down",severity:F.value==="unlike"?"danger":"",onClick:b[1]||(b[1]=T=>f(!1))},null,8,["severity"])])]),(v=i.value)!=null&&v.options.extraInfo?(a(),m("div",Xs,[e("label",Ys,o(i.value.options.extraInfo),1)])):D("",!0),(x=i.value)!=null&&x.options.quantity?(a(),m("div",Zs,[e("div",null,[e("label",el,o(c.$t("common.quantity"))+" / "+o(c.$t("common.pieces")),1)]),e("div",tl,[g(t(P),{icon:"pi pi-minus",disabled:y.value<=0,onClick:b[2]||(b[2]=T=>{var H;return y.value-=(H=i.value)==null?void 0:H.options.quantitySetp}),class:"w-2rem h-2rem"},null,8,["disabled"]),e("span",sl,o(y.value),1),g(t(P),{icon:"pi pi-plus",disabled:y.value>=i.value.options.maxQuantity,onClick:b[3]||(b[3]=T=>{var H;return y.value+=(H=i.value)==null?void 0:H.options.quantitySetp}),class:"w-2rem h-2rem"},null,8,["disabled"])])])):D("",!0),(a(!0),m(j,null,Z((B=i.value)==null?void 0:B.types,(T,H)=>(a(),m("div",{key:T.id},[lt(e("div",null,[e("label",ll,o(H+1)+". "+o(W(T,"typeName")),1),e("div",al,[(a(!0),m(j,null,Z(T.dishes,(X,de)=>(a(),J(t(P),{key:de,onClick:me=>G(T,de,y.value==0?T.maxQuantity:T.maxQuantity*y.value),class:ce([{"p-button-primary":O(X),"p-button-outlined":!O(X)},"m-1"])},{default:N(()=>[e("p",{class:ce({"text-gray-700":!O(X)})},o(W(X,"name")),3)]),_:2},1032,["onClick","class"]))),128))])],512),[[at,T.enable]])]))),128)),q.currentCustomDish.initialPrice!==0?(a(),m("div",nl,[e("label",ol,o(c.$t("common.price"))+":",1),e("label",il,o(R.value+"â‚¬"),1)])):D("",!0),e("div",rl,[g(t(P),{icon:"pi pi-shopping-cart",onClick:b[4]||(b[4]=T=>ne()),label:c.$t("common.addToCart"),class:"m-3",severity:"primary",raised:""},null,8,["label"])])])}}},cl=_e(ul,[["__scopeId","data-v-e97559ab"]]),dl={class:"flex flex-column gap-3"},ml={class:"flex flex-column gap-2"},fl={for:"email"},vl={class:"flex flex-column gap-2"},hl={for:"password"},pl={key:0,class:"text-red-500 text-sm"},yl={class:"flex justify-content-end gap-2"},bl={__name:"LoginDialog",props:{visible:{type:Boolean,default:!1}},emits:["update:visible","login-success"],setup(q,{emit:U}){const{t:$}=ue(),E=q,_=U,C=w(""),i=w(""),L=w(!1),y=w("");he(()=>E.visible,I=>{I&&R()});function R(){C.value="",i.value="",y.value="",L.value=!1}function V(){_("update:visible",!1),R()}async function F(){if(!C.value||!i.value){y.value=$("common.auth.emailPasswordRequired");return}L.value=!0,y.value="";try{const I=await k.login(C.value,i.value);I.success?(_("login-success"),_("update:visible",!1)):y.value=I.error||$("common.auth.loginFailed")}catch(I){y.value=$("common.auth.loginFailed"),console.error("Login error:",I)}finally{L.value=!1}}return(I,A)=>(a(),J(t(ve),{visible:q.visible,"onUpdate:visible":A[2]||(A[2]=W=>I.$emit("update:visible",W)),header:I.$t("common.auth.login"),modal:!0,dismissableMask:!0,style:{width:"90vw",maxWidth:"25rem"},onHide:R},{footer:N(()=>[e("div",yl,[g(t(P),{label:I.$t("common.cancel"),severity:"secondary",onClick:V,disabled:L.value},null,8,["label","disabled"]),g(t(P),{label:I.$t("common.auth.login"),onClick:F,loading:L.value},null,8,["label","loading"])])]),default:N(()=>[e("div",dl,[e("div",ml,[e("label",fl,o(I.$t("common.auth.email")),1),g(t(Oe),{id:"email",modelValue:C.value,"onUpdate:modelValue":A[0]||(A[0]=W=>C.value=W),type:"email",placeholder:I.$t("common.auth.emailPlaceholder"),class:"w-full",disabled:L.value},null,8,["modelValue","placeholder","disabled"])]),e("div",vl,[e("label",hl,o(I.$t("common.auth.password")),1),g(t(ct),{id:"password",modelValue:i.value,"onUpdate:modelValue":A[1]||(A[1]=W=>i.value=W),placeholder:I.$t("common.auth.passwordPlaceholder"),feedback:!1,toggleMask:"",class:"w-full",disabled:L.value,onKeyup:nt(F,["enter"]),fluid:""},null,8,["modelValue","placeholder","disabled"])]),y.value?(a(),m("div",pl,o(y.value),1)):D("",!0)])]),_:1},8,["visible","header"]))}},gl={key:0,class:"flex flex-column gap-4"},_l={class:"flex justify-content-center"},xl={class:"flex flex-column gap-3"},kl={class:"flex flex-column gap-1"},wl={class:"text-sm text-color-secondary"},$l={class:"text-lg font-semibold"},Dl={class:"flex flex-column gap-1"},Il={class:"text-sm text-color-secondary"},Cl={class:"text-lg"},Tl={class:"flex flex-column gap-1"},Nl={class:"text-sm text-color-secondary"},ql={class:"text-lg"},Sl={key:0,class:"flex flex-column gap-1"},Al={class:"text-sm text-color-secondary"},Ml={class:"text-sm text-color-secondary"},Ll={__name:"UserInfoDialog",props:{visible:{type:Boolean,default:!1},user:{type:Object,default:null}},emits:["update:visible"],setup(q,{emit:U}){const{t:$}=ue(),E=q,_=U,C=w(!1),i=ie(()=>{var R;if(!((R=E.user)!=null&&R.avatar_url))return null;const y=E.user.avatar_url;return y&&(y.startsWith("http://")||y.startsWith("https://")||y.startsWith("/"))?y:null});he(()=>E.user,y=>{if(C.value=!1,y!=null&&y.avatar_url&&i.value){const R=new Image;R.onload=()=>{C.value=!1},R.onerror=()=>{C.value=!0,console.warn("Avatar image failed to load:",y.avatar_url)},R.src=i.value}},{immediate:!0});function L(){_("update:visible",!1)}return(y,R)=>(a(),J(t(ve),{visible:q.visible,"onUpdate:visible":R[0]||(R[0]=V=>y.$emit("update:visible",V)),header:y.$t("common.auth.userInfo"),modal:!0,dismissableMask:!0,style:{width:"90vw",maxWidth:"30rem"}},{footer:N(()=>[g(t(P),{label:y.$t("common.cancel"),severity:"secondary",onClick:L},null,8,["label"])]),default:N(()=>[q.user?(a(),m("div",gl,[e("div",_l,[g(t(Ve),{image:i.value&&!C.value?i.value:void 0,shape:"circle",size:"xlarge",class:"mb-3"},null,8,["image"])]),e("div",xl,[e("div",kl,[e("label",wl,o(y.$t("common.auth.displayName")),1),e("div",$l,o(q.user.display_name||"-"),1)]),e("div",Dl,[e("label",Il,o(y.$t("common.auth.email")),1),e("div",Cl,o(q.user.email||"-"),1)]),e("div",Tl,[e("label",Nl,o(y.$t("common.auth.role")),1),e("div",ql,o(q.user.role||"-"),1)]),q.user.id?(a(),m("div",Sl,[e("label",Al,o(y.$t("common.auth.userId")),1),e("div",Ml,o(q.user.id),1)])):D("",!0)])])):D("",!0)]),_:1},8,["visible","header"]))}},Rl={class:"fixed top-0 left-0 w-full bg-primary-reverse",style:{"z-index":"10"}},El={class:"grid mt-1 ml-1"},Pl={class:"h-3rem w-3rem flex align-items-center"},Vl=["src"],Ol={class:"flex align-items-center"},jl={key:0,class:"text-color font-bold p-1"},Fl={key:1,class:"text-color font-bold p-1"},Wl={class:"card flex mr-3 flex align-items-center gap-2",style:{"margin-left":"auto"}},Hl={key:0},Ul={key:1},zl={style:{display:"flex","align-items":"center"}},Bl={style:{"flex-grow":"1",width:"0",overflow:"hidden"}},Ql={class:"mt-2"},Jl={class:"flex justify-content-end mt-2"},Kl={class:"flex inline-flex items-center justify-center gap-2"},Gl={class:"flex align-items-center"},Xl={class:"flex flex-column"},Yl={class:"text-sm p-2"},Zl={class:"text-sm p-2"},ea={class:"flex items-center gap-4 mb-4 p-2"},ta={class:"flex flex-column gap-3"},sa={__name:"HeaderTabs",props:{types:Array,typeIndex:Number,tableId:String,tabItems:Array},emits:["clickType","switchToWelcome"],setup(q,{emit:U}){const{t:$}=ue(),E=w(!1),_=w(!1),C=w(!1),i=w(""),L=w(),y=w(!1),R=ie(()=>k.isAuthenticated()),V=ie(()=>k.authUser.value),F=ie(()=>{var d;if(!((d=V.value)!=null&&d.avatar_url))return null;const s=V.value.avatar_url;return s&&(s.startsWith("http://")||s.startsWith("https://")||s.startsWith("/"))?s:null});he(V,s=>{if(y.value=!1,s!=null&&s.avatar_url&&F.value){const d=new Image;d.onload=()=>{y.value=!1},d.onerror=()=>{y.value=!0,console.warn("Avatar image failed to load:",s.avatar_url)},d.src=F.value}},{immediate:!0});function I(){return k.getTable()}ge(async()=>{i.value=await yt()});const A=w(),W=ie(()=>[{label:$("common.options"),items:[{label:$("common.pay"),icon:"pi pi-wallet",command:()=>{re()}},{label:$("common.call"),icon:"pi pi-user-plus",command:()=>{k.send_cmd(I(),{cmd:"call"},s=>{s.success?Y.show_info($("notification.call_msg")):Y.show_warn(s.data)})}}]}]),K=s=>{A.value.toggle(s)},G=s=>{O.value.toggle(s)},O=w(),ne=w(!1),te=w(),se=w();function re(){ne.value=!0}function le(){s(te.value)?k.send_cmd(I(),{cmd:"pay",nif:te.value,note:se.value},d=>{d.success?(Y.show_info($("notification.pay_msg")),ne.value=!1):Y.show_error($("common.failed"))}):Y.show_warn($("notification.cancel_msg"));function s(d){return!d||d.toString().length===9||d.toString().length===0}}function u(){se.value&&(se.value=void 0)}function S(){E.value=!0}const f=ie(()=>[{label:$("common.auth.userInfo"),icon:"pi pi-user",command:()=>{C.value=!0}},{separator:!0},{label:$("common.auth.logout"),icon:"pi pi-sign-out",command:()=>{k.logout(),Y.show_info($("common.auth.logoutSuccess"))}}]);function c(s){L.value.toggle(s)}function b(){var s;_.value=!1,Y.show_info($("common.auth.loginSuccess")),console.log("Login success, user:",k.authUser.value),console.log("Avatar URL:",(s=k.authUser.value)==null?void 0:s.avatar_url)}return(s,d)=>(a(),m(j,null,[e("div",Rl,[e("div",El,[e("div",Pl,[e("img",{src:i.value,class:"h-full w-full",onClick:d[0]||(d[0]=()=>s.$emit("switchToWelcome"))},null,8,Vl)]),e("div",Ol,[q.tableId?(a(),m("p",jl,o(s.$t("common.table"))+": "+o(q.tableId),1)):D("",!0),q.tableId?D("",!0):(a(),m("p",Fl,o(s.$t("common.takeAway")),1))]),e("div",Wl,[R.value?V.value?(a(),m("div",Ul,[g(t(Ve),{image:F.value,shape:"circle",size:"large",onClick:c,style:{cursor:"pointer"}},null,8,["image"]),g(t(Ae),{ref_key:"userMenu",ref:L,id:"user_menu",model:f.value,popup:!0},null,8,["model"])])):D("",!0):(a(),m("div",Hl,[g(t(P),{label:t($)("common.auth.login"),icon:"pi pi-sign-in",onClick:d[1]||(d[1]=r=>_.value=!0)},null,8,["label"])])),q.tableId?(a(),J(t(P),{key:2,icon:"pi pi-bell",rounded:"","aria-label":"Filter",onClick:K,"aria-haspopup":"true","aria-controls":"overlay_menu"})):(a(),J(t(P),{key:3,icon:"pi pi-question",rounded:"",onClick:S})),g(t(Ae),{ref_key:"menu",ref:A,id:"overlay_menu",model:W.value,popup:!0},null,8,["model"])])]),e("div",zl,[e("div",null,[g(t(P),{icon:"pi pi-bars",variant:"text",rounded:"","aria-label":"Filter",onClick:G,"aria-haspopup":"true","aria-controls":"tab_menu"}),g(t(Ae),{ref_key:"tabMenu",ref:O,id:"tab_menu",model:q.tabItems,popup:!0},null,8,["model"])]),e("div",Bl,[g(t(ft),{value:q.typeIndex,scrollable:"",showNavigators:!1},{default:N(()=>[g(t(dt),null,{default:N(()=>[(a(!0),m(j,null,Z(q.types,(r,v)=>(a(),J(t(mt),{value:v,onClick:()=>s.$emit("clickType",v),class:"text-sm md:text-lg lg:text-xl"},{default:N(()=>[ye(o(r),1)]),_:2},1032,["value","onClick"]))),256))]),_:1})]),_:1},8,["value"])])])]),g(t(ve),{visible:ne.value,"onUpdate:visible":d[5]||(d[5]=r=>ne.value=r),header:"ç»“è´¦",class:"flex flex-column",modal:!0,dismissableMask:!0,onHide:u},{default:N(()=>[e("div",null,[d[9]||(d[9]=e("label",null,"NIF:",-1)),g(t(vt),{modelValue:te.value,"onUpdate:modelValue":d[2]||(d[2]=r=>te.value=r),inputId:"withoutgrouping",useGrouping:!1,fluid:"",class:"w-full m-1"},null,8,["modelValue"])]),e("div",Ql,[e("label",null,o(s.$t("common.note"))+":",1),g(t(Oe),{type:"text",modelValue:se.value,"onUpdate:modelValue":d[3]||(d[3]=r=>se.value=r),class:"w-full m-1"},null,8,["modelValue"])]),e("div",Jl,[g(t(P),{label:t($)("common.send"),onClick:d[4]||(d[4]=r=>le())},null,8,["label"])])]),_:1},8,["visible"]),g(t(ve),{visible:E.value,"onUpdate:visible":d[6]||(d[6]=r=>E.value=r),modal:"",dismissableMask:"",class:"h-full",style:{width:"90vw",maxWidth:"40rem",minWidth:"20rem"},draggable:!1},{header:N(()=>[e("div",Kl,[g(t(Ve),{icon:"pi pi-question",shape:"circle"}),e("span",Gl,o(t($)("takeawayHelper.dialogTitle")),1)])]),default:N(()=>[e("div",Xl,[e("span",Yl,o(t($)("takeawayHelper.introduction")),1),e("span",Zl,o(t($)("takeawayHelper.note_t"))+" "+o(t($)("takeawayHelper.note_1")),1),e("div",ea,[g(t(Pe),{class:"w-full max-w-xl mx-auto"},{default:N(()=>[g(t(Le),{value:"0"},{default:N(()=>[g(t(Re),{class:"text-sm"},{default:N(()=>[ye(o(t($)("takeawayHelper.question_1")),1)]),_:1}),g(t(Ee),{class:"p-1"},{default:N(()=>[e("div",ta,[e("span",null,o(t($)("takeawayHelper.q_1_request_1")),1),e("span",null,o(t($)("takeawayHelper.q_1_request_2")),1),e("span",null,o(t($)("takeawayHelper.q_1_request_3")),1),e("span",null,o(t($)("takeawayHelper.q_1_request_4")),1),e("span",null,o(t($)("takeawayHelper.q_1_request_5")),1)])]),_:1})]),_:1})]),_:1})])])]),_:1},8,["visible"]),g(bl,{visible:_.value,"onUpdate:visible":d[7]||(d[7]=r=>_.value=r),onLoginSuccess:b},null,8,["visible"]),g(Ll,{visible:C.value,"onUpdate:visible":d[8]||(d[8]=r=>C.value=r),user:V.value},null,8,["visible","user"])],64))}},la={__name:"SwipeHint",props:{size:{type:String,default:"8rem"},duration:{type:Number,default:6e3},position:{type:String,default:"bottom"}},setup(q){const U=q,$=w(!0);ge(()=>{U.duration>0&&setTimeout(()=>{$.value=!1},U.duration);const _=()=>{$.value=!1,window.removeEventListener("touchstart",_)};window.addEventListener("touchstart",_)});const E=ie(()=>{let _={left:"50%",transform:"translateX(-50%)",zIndex:99999,opacity:.5,pointerEvents:"none",textAlign:"center",position:"fixed"};return U.position==="top"?_.top="15%":U.position==="center"?(_.top="50%",_.transform="translate(-50%, -50%)"):_.bottom="15%",_});return(_,C)=>$.value?(a(),m("div",{key:0,class:"swipe-hint",style:Ie(E.value)},[e("div",{class:"hand",style:Ie({width:q.size,height:q.size,backgroundImages:"url(/images/hand_finger.png)"})},null,4)],4)):D("",!0)}},aa=_e(la,[["__scopeId","data-v-30a48de8"]]),na={class:"w-full h-full flex flex-column p-1"},oa={class:"swiper-container-wrapper"},ia={class:"fixed bottom-0 left-0 w-full h-3rem bg-primary-reverse p-3 z-[9999]"},ra={class:"h-full flex align-items-center justify-content-between w-full"},ua={class:"m-2"},ca={class:"m-2"},da={class:"m-2"},ma={style:{"max-height":"60vh","overflow-y":"auto","padding-bottom":"60px"}},fa={class:"flex flex-column border-bottom-1"},va={key:0,class:"flex justify-content-between"},ha={class:"flex flex-column"},pa={class:"font-bold"},ya={class:"text-right"},ba={key:1,class:"flex justify-content-between"},ga={class:"flex flex-column"},_a={class:"font-bold"},xa={class:"text-right"},ka={key:0},wa={key:1,class:"flex flex-column"},$a={class:"flex flex-column"},Da={class:"font-bold"},Ia={class:"text-right"},Ca={class:"total-footer bg-primary-reverse"},Qe=5,De="order_time_key",Ta={__name:"HomePage",setup(q){const U=Je(),$=it(),{t:E}=ue(),{locale:_}=ue(),C=w(0),i=w(!1),L=w([""]),y=w(0),R=oe.cartItemCount,V=w(!1),F=w([]),I=w(0),A=w({}),W=w(!1),K=z.dishDatas,G=w(k.getOrderMenuTab()),O=w(null),ne=w(null),te=w([]),se=w([]),re=w([]),le=w(!1);let u=null;const S=l=>{y.value=l.activeIndex,Ce()},f=l=>{u=l};he(y,l=>{u&&u.activeIndex!==l&&u.slideTo(l);let n=k.getOrderMenuTab()[l];k.customDishAPI.customDishes.value.map(p=>p.name).includes(n)?(W.value=!0,A.value=k.customDishAPI.customDishes.value.find(p=>p.name==n)):W.value=!1});const c=(l,n,h,p)=>{k.rateDish(l,n,h),p&&Y.show_success(E("notification.rating_submitted"))},b=(l,n,h)=>{if(A.value.name=="XIAOXIONGÂ® RAMEN"&&l.id===1){const p=l.dishes[n];let M;p.dishid==47?h?M=s(3,!0,1):M=s(3,!1,1):M=s(3,!0,1),M!==void 0&&d(M)}if(A.value.name=="Menu AlmoÃ§o"&&l.id===3){const p=l.dishes[n];let M;[1427,41].includes(p.dishid)?h?M=s(4,!0,0):M=s(4,!1,0):M=s(4,!0,0),M!==void 0&&d(M)}};function s(l,n,h){if(A.value={...A.value,types:A.value.types.map(p=>p.id===l?{...p,enable:n,minQuantity:n?h:0}:p)},n===!1)return l}function d(l){!A.value||!Array.isArray(A.value.types)||(A.value={...A.value,types:A.value.types.map(n=>n.id===l?{...n,dishes:n.dishes.map(h=>({...h,selected:!1}))}:n)})}function r(l){let n=k.getOrderMenuTab()[l];if(k.customDishAPI.customDishes.value.map(Q=>Q.name).includes(n)?(W.value=!0,A.value=k.customDishAPI.customDishes.value.find(Q=>Q.name==n)):W.value=!1,k.getMenu().length==0){console.log("exit");return}let M=K.value[l].mainDishes;z.showDishList(M)}const v=()=>{k.refreshTableFromServer(),k.getTableTotalAmount(I),V.value=!0},x=l=>{let n=l.id;l.org_id&&(n=l.org_id);for(let h=0;h<K.value.length;h++)if(K.value[h].id==n)for(const p in l){let M=p;p.startsWith("note")&&(M=M.replace("note","description")),K.value[h][M]=l[p]}};function B(){return new Promise(l=>{let n=()=>{const h=k.formatedMenu.value;h.length>0?l(h):setTimeout(n,200)};n()})}function T(){return new Promise(l=>{let n=()=>{const h=k.getOrderMenuTab();h.length>0?l(h):setTimeout(n,200)};n()})}const H=ie(()=>l=>{const n=k.dictinaryAPI.dictinary.value.find(h=>h.refName===l);return n?n[`text_${_.value.toLowerCase()}`]:l});he([()=>k.formatedMenu.value,()=>_.value],([l,n])=>{if(!l||l.length===0){re.value=[];return}const h={};k.orderMenuTab.value;const p=l.map(pe=>({...pe,mainDishes:pe.dishes.map(ee=>{const ae=ee.dish;if(h[ae.id])return h[ae.id];const be={...ae,defaultName:ae.name,defaultSubname:ae.subname,name:X(ae,"name",n),note:X(ae,"note",n),subname:X(ae,"subname",n),quantity:0},qe=ee.subItems.map(We=>{const we=We;return{...We,defaultName:ae.name,defaultSubname:we.subname,name:X(we,"name",n),note:X(we,"note",n),subname:X(we,"subname",n),quantity:0}}),Se={...ee,dish:be,subItems:qe};return h[Se.id]=Se,Se})}));K.value.length;const M=z.getAllIncrementedDish();z.getIdsAndQuantity(M);const Q=oe.cartDishs.value;Me.compressToEncodedURIComponent(JSON.stringify(Q)),re.value=p,K.value=re.value,L.value=k.orderMenuTab.value,(M.length>0||Q.length>0)&&(z.cleanDishDataQty(),z.updateDishDataQty(M)),k.filterMenuTabs(le.value),console.log("languagedMenu updated via watch:",re.value),He(()=>{C.value++,u&&typeof u.updateDictionaryWord=="function"&&(u.updateDictionaryWord(),u.slideTo(y.value))})},{immediate:!0,deep:!0}),he(()=>k.orderMenuTab.value,l=>{G.value=l.map(n=>{const h=k.dictinaryAPI.dictinary.value.find(p=>p.refName===n);return h?h[`text_${_.value.toLowerCase()}`]:n}),F.value=me(l),y.value=0}),ge(()=>{const l=k.orderMenuTab.value;G.value=l.map(n=>{const h=k.dictinaryAPI.dictinary.value.find(p=>p.refName===n);return h?h[`text_${_.value.toLowerCase()}`]:n}),F.value=me(l),y.value=0});function X(l,n,h){return l?h==="en"?l[`${n}_en`]||l[n]:h==="zh"&&l[`${n}_cn`]||l[n]:""}async function de(){await B();const l=await T();k.onMenuItemChanged=x,et(),F.value=me(l)}function me(l){const n=[];for(let h=0;h<l.length;h++){const p=h;n.push({label:H.value(l[h]),command:()=>{je(p),Ce()}})}return n}const Ce=()=>{He(()=>{const l=document.querySelector(".p-tablist-viewport"),n=document.querySelector(".p-tab.p-tab-active");if(l&&n){const h=n.offsetLeft-l.offsetWidth/2+n.offsetWidth/2;l.scrollTo({left:h,behavior:"smooth"})}window.scrollTo({top:0,behavior:"smooth"})})},je=l=>{r(l),y.value=l,Ce()},Ke=()=>{var l=z.getAllIncrementedDish();ne.value.showDishList(l)};function Te(){return k.getTable()}k.params.port,O.value=k.table.value.order;function Ge(l){var n=E("notification.too_fast",{remainTime:l});Y.show_warn(n)}const Xe=(l,n)=>{const h=[];for(let ee=0;ee<oe.cartDishs.value.length;ee++){var p=oe.cartDishs.value[ee];const ae=k.formateCustomDishNotes(p),be=p.dis_count?p.dis_price:p.price;h.push({dishid:p.dishid,name:p.name,quantity:p.count,notes:ae,limit:p.limit,price:be,dishNote:p.dishNote,category:p.category})}const M=z.getAllIncrementedDish();for(let ee=0;ee<M.length;ee++){var p=M[ee];if(p.quantity>0){const be=p.dis_count?p.dis_price:p.price,qe=k.getDishNameDefaultName(p);h.push({dishid:p.id,name:qe,quantity:p.quantity,limit:p.limit,price:be,dishNote:p.dishNote})}}if(h.length===0)return Y.show_warn(E("notification.select_at_least_one")),!1;console.log("cart item:",h);const Q=JSON.parse(fe.getCookie(De)||"{}"),pe=Date.now();if(!Q.startTime||pe-Q.startTime>Qe*1e3)Q.startTime=pe,Q.uniCode||(Q.uniCode=Date.now().toString(36)+Math.random().toString(36).substring(2,5));else{const ee=Qe-parseInt((pe-Q.startTime)/1e3);Ge(ee);return}return fe.setCookie(De,JSON.stringify(Q)),i.value=!0,k.submit_order({uniCode:Q.uniCode,name:l.name,note:l.note,table:Te(),items:h},ee=>{const ae=JSON.parse(fe.getCookie(De)||"{}");ae.uniCode=void 0,fe.setCookie(De,JSON.stringify(ae)),n(ee)}),!0};function Ye(){const l=fe.getCookie("language");l&&(_.value=l)}function Fe(){for(let l=0;l<K.value.length;l++){const n=K.value[l];n.quantity=0}i.value=!1,oe.cleanAll()}ge(async()=>{Ye(),await de(),r(y.value),k.clear_order_data=()=>{Fe()},k.setOnOrderConfirmed(l=>{Fe();const n=l;Y.show_success(E("notification.order_submitted",{id:n}))}),k.setOnShowError(l=>{i.value=!1,Y.show_error(l)})});function Ze(){fe.deleteCookie("login_time");const l=$.query.table;l?U.push({path:"/",query:{table:l}}):U.push({path:"/takeReserve"})}async function xe(l,n=!0){const h=n?oe.cartDishs.value:z.getIdsAndQuantity(z.getAllIncrementedDish()),p=Me.compressToEncodedURIComponent(JSON.stringify(h));try{await Be.setItem(l,p)}catch(M){console.error("ä¿å­˜åˆ° localForage å¤±è´¥:",M)}}function Ne(){k.isTakeaway()?(xe("take_cartDish_normal",!1),xe("take_cartDish_custom",!0)):(xe("cartDish_normal",!1),xe("cartDish_custom",!0))}async function ke(l,n=!0){try{const h=await Be.getItem(l);if(!h)return;const p=JSON.parse(Me.decompressFromEncodedURIComponent(h));p&&p!=="undefined"&&(n?oe.cartDishs.value=p:z.updateDishDataQty(p))}catch(h){console.error("ä»Ž localForage è¯»å–å¤±è´¥æˆ–è§£æžå¤±è´¥:",h)}}function et(){k.isTakeaway()?(ke("take_cartDish_normal",!1),ke("take_cartDish_custom")):(ke("cartDish_normal",!1),ke("cartDish_custom"))}return ot(()=>{Ne()}),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&Ne()}),window.addEventListener("beforeunload",l=>{Ne(),k.cleanup()}),(l,n)=>(a(),m(j,null,[e("div",na,[(a(),J(sa,{key:C.value,types:G.value,typeIndex:y.value,tabItems:F.value,tableId:Te(),onClickType:je,onSwitchToWelcome:Ze},null,8,["types","typeIndex","tabItems","tableId"])),n[4]||(n[4]=e("div",{class:"pb-8"},null,-1)),n[5]||(n[5]=e("div",{class:"pb-4 sm:pb-5 md:pb-5 lg:pb-5"},null,-1)),g(aa,{duration:3e3,position:"center",size:"3rem"}),e("div",oa,[(a(),J(t(bt),{key:`swiper-${G.value.length}-${C.value}`,"space-between":20,"centered-slides":"","grab-cursor":!0,class:"w-full",autoHeight:!0,onSlideChange:S,onSwiper:f,"initial-slide":y.value},{default:N(()=>[(a(!0),m(j,null,Z(G.value,(h,p)=>(a(),J(t(gt),{key:p},{default:N(()=>[Math.abs(y.value-p)<=1&&(!W.value||y.value!==p)?(a(),J(is,{key:0,rateDish:c,likedItemsRef:te.value,dislikedItemsRef:se.value,tabIndex:p,onlyVeg:le.value},null,8,["likedItemsRef","dislikedItemsRef","tabIndex","onlyVeg"])):Math.abs(y.value-p)<=1&&W.value&&y.value===p?(a(),J(cl,{key:1,currentCustomDish:A.value,onTypeClick:b,tabindex:p},null,8,["currentCustomDish","tabindex"])):D("",!0)]),_:2},1024))),128))]),_:1},8,["initial-slide"]))]),n[6]||(n[6]=e("div",{style:{height:"60px"}},null,-1)),e("div",ia,[e("div",ra,[e("div",ua,[t(k).isTakeaway()?D("",!0):(a(),J(t(P),{key:0,label:l.$t("common.orders"),icon:"pi pi-list",class:"p-button-secondary",onClick:v},null,8,["label"]))]),e("div",ca,[g(t(ht),{class:"text-sm",modelValue:le.value,"onUpdate:modelValue":n[0]||(n[0]=h=>le.value=h),onLabel:t(E)("common.showAll"),offLabel:t(E)("common.showOnlyVegetables"),onClick:n[1]||(n[1]=h=>t(k).filterMenuTabs(le.value))},null,8,["modelValue","onLabel","offLabel"])]),e("div",da,[g(t(pt),{value:t(R),severity:"danger",onClick:Ke},{default:N(()=>n[3]||(n[3]=[e("i",{class:"pi pi-shopping-cart",style:{"font-size":"2rem"}},null,-1)])),_:1,__:[3]},8,["value"])])])])]),g(Ps,{ref_key:"cartRef",ref:ne,checkout:Xe,isTakeaway:!Te()},null,8,["isTakeaway"]),g(t(ve),{visible:V.value,"onUpdate:visible":n[2]||(n[2]=h=>V.value=h),header:l.$t("common.completedOrders"),modal:"",style:{width:"80vw","max-width":"700px"}},{default:N(()=>{var h,p;return[e("div",ma,[e("div",fa,[(h=I.value.adultPrice)!=null&&h.quantity&&I.value.adultPrice.quantity!=0?(a(),m("div",va,[e("div",ha,[e("span",pa,o(l.$t("common.adult")),1),e("small",null,o(l.$t("common.quantity"))+": "+o(I.value.adultPrice.quantity),1)]),e("div",ya,[e("span",null,"â‚¬"+o((Number(I.value.adultPrice.price)*I.value.adultPrice.quantity).toFixed(2)),1)])])):D("",!0),(p=I.value.childrenPrice)!=null&&p.quantity&&I.value.childrenPrice.quantity!=0?(a(),m("div",ba,[e("div",ga,[e("span",_a,o(l.$t("common.children")),1),e("small",null,o(l.$t("common.quantity"))+": "+o(I.value.childrenPrice.quantity),1)]),e("div",xa,[e("span",null,"â‚¬"+o((Number(I.value.childrenPrice.price)*I.value.childrenPrice.quantity).toFixed(2)),1)])])):D("",!0)]),t(k).table.value.order.length===0?(a(),m("div",ka,o(l.$t("common.noOrders")),1)):(a(),m("div",wa,[(a(!0),m(j,null,Z(t(k).table.value.order,(M,Q)=>(a(),m("div",{key:Q,class:"flex justify-content-between border-bottom-1 pb-2"},[e("div",$a,[e("span",Da,o(t(k).getDishName(M)),1),e("small",null,o(l.$t("common.quantity"))+": "+o(M.quantity),1)]),e("div",Ia,[e("span",null,"â‚¬"+o((M.price*M.quantity).toFixed(2)),1)])]))),128))]))]),e("div",Ca,o(l.$t("common.total"))+": â‚¬"+o(I.value.total),1)]}),_:1},8,["visible","header"])],64))}},Ea=_e(Ta,[["__scopeId","data-v-3764dc04"]]);export{Ea as default};
