import{s as O}from"./index-ph7f-Bih.js";import{s as W,a as G}from"./index-CFt--O9r.js";import{s as J,a as K,b as Q,c as X}from"./index-CSm5vaqA.js";import{s as ee}from"./index-DTyyAbml.js";import{s as te}from"./index-B-hHolUA.js";import{b as oe}from"./index-CaW9szM_.js";import{q as ae,h as p,H as le,n as T,c as h,d as a,a as d,w as s,j as se,o as n,l as Y,t as k,F as P,E as y,f as g,C as E,e as ne}from"./index-BShNAIhh.js";import"./index-QIG-zb-E.js";import"./index-BaW51Udu.js";import"./index-aw8HYO3P.js";import"./index-Br-UpKLP.js";import"./index-Dfd85u33.js";import"./index-BK0Kbx9n.js";import"./index-DPWVLdbS.js";import"./index-BjYwmhV5.js";const re={class:"flex flex-column w-full",style:{position:"fixed",top:"0",left:"0"}},ie={class:"flex flex-wrap justify-content-center align-items-center gap-1 ml-2"},ue={class:"card flex flex-column",style:{height:"calc(100vh - 200px)"}},ce={class:"text-center py-5"},pe={class:"mt-3 text-gray-500"},H=2025,de=1,Ne={__name:"MonthRates",setup(me){const{t:f}=ae(),S=se(),r=p();L();const b=p(!0),x=new Date,v=x.getFullYear(),_=x.getMonth()+1;le(b,()=>{$(i.value,w.value)});const R=p([{id:0,value:0,label:f("optionPages.overallRate")}]);Z();function Z(){for(let e=H;e<=v;e++)R.value.push({id:e,value:e,label:e})}function z(e){return!e.rates||!e.likes?0:(e.likes/e.rates*5).toFixed(2)}function $(e,t){i.value=e,w.value=t,r.value=[],i.value===0?I(()=>{V()}):N(r,e,t,()=>{V()}),r.value=r.value.filter(o=>o.category)}function N(e,t,o,c){t==v&&o==_?T.getCurrentMonthRates(e):T.getMonthRatesWithDate(e,t,o,()=>{c()}),c()}function I(e){for(let t=H;t<=v;t++)for(let o=de;o<=_;o++){const c=p([]);N(c,t,o,()=>{c.value.forEach(C=>r.value.push(C))})}e()}function V(){const e=[];for(let t=0;t<r.value.length;t++){const o=r.value[t];o.likes=o.likes|0,o.rates=o.rates|0,o.rating=z(o),b.value?o.rates!==0&&e.push(o):e.push(o)}r.value=e}async function L(){try{await T.refreshMenu(),$(v,_)}catch(e){console.error("获取评分失败:",e),toast.add({severity:"error",summary:f("common.error"),detail:f("optionPages.rateFailMsg"),life:3e3})}}const M=p([]);U();function U(){const e=["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"];for(let t=0;t<e.length;t++)M.value.push({id:t+1,value:e[t],label:t+1+" - "+f(`optionPages.months[${t}]`).toUpperCase()})}const i=p(v),w=p(_);return(e,t)=>{const o=oe,c=te,C=ee,j=Q,D=K,B=X,F=J,m=G,q=W,A=O;return n(),h("div",re,[a(C,{class:"bg-primary text-white p-2"},{start:s(()=>[a(o,{icon:"pi pi-arrow-left",class:"p-button-text text-white",label:e.$t("optionPages.home"),onClick:t[0]||(t[0]=l=>Y(S).push("/"))},null,8,["label"]),d("div",ie,[a(c,{modelValue:b.value,"onUpdate:modelValue":t[1]||(t[1]=l=>b.value=l),class:"green-toggle"},null,8,["modelValue"]),d("label",null,k(Y(f)("optionPages.hideZero")),1)])]),_:1}),d("div",null,[a(F,{value:i.value},{default:s(()=>[a(D,null,{default:s(()=>[(n(!0),h(P,null,y(R.value,l=>(n(),g(j,{key:l.id,value:l.id,onClick:u=>$(l.id,w.value)},{default:s(()=>[E(k(l.label),1)]),_:2},1032,["value","onClick"]))),128))]),_:1}),(n(!0),h(P,null,y(R.value,l=>(n(),g(B,{key:l.id,value:l.id},{default:s(()=>[i.value!==0?(n(),g(F,{key:0,value:w.value,scrollable:""},{default:s(()=>[a(D,null,{default:s(()=>[(n(!0),h(P,null,y(M.value,u=>(n(),g(j,{key:u.id,value:u.id,onClick:fe=>$(l.id,u.id)},{default:s(()=>[E(k(u.label),1)]),_:2},1032,["value","onClick"]))),128))]),_:2},1024),(n(!0),h(P,null,y(M.value,u=>(n(),g(B,{key:u.id,value:u.id},null,8,["value"]))),128))]),_:2},1032,["value"])):ne("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),d("div",ue,[a(q,{value:r.value,stripedRows:"",scrollable:"",scrollHeight:"flex",paginator:"",rows:10,rowsPerPageOptions:[5,10,20,50],tableStyle:"min-width: 50rem"},{empty:s(()=>[d("div",ce,[t[2]||(t[2]=d("i",{class:"pi pi-search",style:{"font-size":"3rem",color:"#ccc"}},null,-1)),d("p",pe,k(e.$t("optionPages.noRate")),1)])]),default:s(()=>[a(m,{field:"id",header:"ID",sortable:""}),a(m,{field:"category",header:e.$t("optionPages.category"),sortable:""},null,8,["header"]),a(m,{field:"name",header:e.$t("optionPages.name")},null,8,["header"]),a(m,{field:"rating",header:(i.value===0?"":e.$t("optionPages.month"))+e.$t("optionPages.overallRate"),sortable:""},null,8,["header"]),a(m,{field:"likes",header:(i.value===0?"":e.$t("optionPages.month"))+e.$t("optionPages.likes"),sortable:""},null,8,["header"]),a(m,{field:"rates",header:(i.value===0?"":e.$t("optionPages.month"))+e.$t("optionPages.rates"),sortable:""},null,8,["header"])]),_:1},8,["value"])])]),a(A)])}}};export{Ne as default};
