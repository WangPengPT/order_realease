import{a as we,b as ye,c as ke,d as Ce,e as $e,f as Ie,g as Le,h as Pe,i as Ne,j as Se}from"./primevue-CBPQtTnk.js";import{_ as Te,P as Ue}from"./pagination-BMK1f9ll.js";import{c as M,S as Be,a as Fe}from"./cookie-B5yvvDQV.js";import{Q as le,b as v,C as L,w as Ae,e as ae,n as Me,R as Ve,S as De,U as Oe,f as n,v as i,h as s,a as P,s as c,B as z,t as m,M as u,F as w,y as N,o,c as R,A as j}from"./vue-Dca0Sd-v.js";import{c as l,C as Re,m as y}from"./index-CqHK_XIN.js";import{_ as je}from"./LoginDialog-DUFgvgRU.js";import{_ as ze}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vendor-BwD4SF-p.js";const Ee=["src"],He=["onClick"],qe=["src"],Ge={class:"absolute top-0 border-0 right-0 p-2 flex flex-column flex align-items-center"},We={key:0},Qe={class:"m-3 max-w-screen"},Xe={class:z(["w-full","p-4"])},Je=["src"],Ke={key:0,class:"text-center p-1"},Ye={key:1,class:"text-center p-1"},Ze={class:"flex flex-column justify-center"},et={key:0,class:"text-center"},tt={key:1,class:"text-center"},st={class:"flex w-full"},lt={class:"flex flex-column"},at={class:"w-full text-sm break-words px-2",style:{"white-space":"pre-wrap"}},ot=["src"],nt={key:0,class:"flex justify-content-end"},it={class:"flex flex-row"},rt={class:"underline text-blue-600 text-sm"},ut={class:"pt-3 pb-3"},ct={class:"flex flex-row gap-2"},dt={class:"border-400 border-round border-1 p-3"},mt={class:"text-center font-bold"},pt={key:0,class:"w-full overflow-hidden"},ft=["src"],vt={class:"w-full overflow-hidden",style:{"aspect-ratio":"2 / 1.5"}},gt=["src"],_t={class:"font-bold"},ht={class:"flex flex-column"},bt={class:"flex flex-row justify-content-between w-full"},xt=["innerHTML"],wt=["innerHTML"],yt={key:0,class:"fixed right-0 bottom-0 p-4",style:{"z-index":"2"}},kt={class:"mt-2"},Ct={class:"flex justify-content-end mt-2"},$t={__name:"Welcome",setup(It){const k=[{label:"pt",imagePath:"flags/pt.png"},{label:"en",imagePath:"flags/en.png"},{label:"zh",imagePath:"flags/zh.png"}],E=Oe(),oe=De(),{locale:h}=le(),{t:p}=le(),_=v(null),S=v(!0),H=v(),q=v(""),ne=L(()=>l.getShopInfo("restaurantName")),d=v(void 0),V=L(()=>l.shopInfo.value.instagramUrl);function ie(){const e=M.getCookie("language");e&&(h.value=e)}let b=null;Ae(()=>[l.currentPage.value,l.addr.value],([e,t])=>{var r,x,g;d.value=e,(x=(r=d.value)==null?void 0:r.data)!=null&&x.logoPath&&((g=d.value)!=null&&g.imagesPath)&&(q.value=l.pathFormated(d.value.data.logoPath.src,d.value.imagesPath))},{immediate:!0}),ae(async()=>{var e;await Me(),b=new IntersectionObserver(t=>{t.forEach(r=>{S.value=r.isIntersecting})},{threshold:.1}),(e=_.value)!=null&&e.$el&&b.observe(_.value.$el)}),ae(async()=>{var e;l.params=l.getQueryParams(),l.params.table?l.params.table=Re.SimpleDecode(l.params.table):l.params.table=void 0,ie(),l.initMenu(!0),b=new IntersectionObserver(t=>{t.forEach(r=>{r.isIntersecting?S.value=!0:S.value=!1})},{threshold:.1}),(e=_.value)!=null&&e.$el&&b.observe(_.value.$el)}),Ve(()=>{var e;b&&((e=_.value)!=null&&e.$el)&&b.unobserve(_.value.$el)});const re=L(()=>{const e="/";switch(h.value.toLowerCase()){case"pt":return e+k[0].imagePath;case"en":return e+k[1].imagePath;case"zh":return e+k[2].imagePath;default:return e+k[1].imagePath}});function T(e){return e[`text_${h.value.toLowerCase()}`]}function G(e){const t=e[`text_${h.value.toLowerCase()}`];return t?t.replace(/\[\[(.*?)\|(.*?)\]\]/g,(r,x,g)=>`<a href="${g.startsWith("http")?g:`https://${g}`}" target="_blank" rel="noopener noreferrer" class="text-blue-500 underline cursor-pointer">${x}</a>`):""}const ue=Date.now(),W=M.getCookie("login_time");let D;W&&(D=JSON.parse(W));const ce=L(()=>k.filter(e=>e.label!==h.value.toLowerCase()).map(e=>({...e,command:()=>{h.value=e.label,de(e.label)}})));function de(e){M.setCookie("language",e)}function U(e){typeof e=="string"&&/^(https?:\/\/)/i.test(e)?window.open(e,"_blank"):console.warn("无效的 URL:",e)}function me(){U(V.value)}const pe=e=>{H.value.toggle(e)};D&&(ue-D>60*5*1e3?M.clearAllCookies():B());function B(){const e=oe.query.table;if(!l.permissionsControl.value.order||!l.settings.value.order){y.show_warn(p("notification.orderClosed"));return}if(l.settings.value.useAuth&&l.params.table&&!l.getActiveUser()){O.value=!0;return}E.push({path:"/table",query:{table:e}})}function fe(){l.currentTableId.value=void 0,l.params.table=void 0,E.push("/takeReserve")}const ve=L(()=>[{label:p("common.options"),items:[{label:p("common.pay"),icon:"pi pi-wallet",command:()=>{ge()}},{label:p("common.call"),icon:"pi pi-user-plus",command:()=>{l.send_cmd(l.getTable(),{cmd:"call"},e=>{e.success?y.show_info(p("notification.call_msg")):y.show_info(e.data)})}}]}]);function Q(e){return d.value.data.options[e]?"font-bold":""}const F=v(!1),A=v(),C=v(),O=v(!1);function ge(){F.value=!0}function _e(){e(A.value)?l.send_cmd(l.getTable(),{cmd:"pay",nif:A.value,note:C.value},t=>{t.success?(y.show_info(p("notification.pay_msg")),F.value=!1):y.show_error(p("common.failed"))}):y.show_warn(p("notification.cancel_msg"));function e(t){return!t||t.toString().length===9||t.toString().length===0}}function he(){C.value&&(C.value=void 0)}return(e,t)=>{var J,K,Y,Z,ee,te;const r=ye,x=we,g=ke,X=Ne,be=Se,xe=$e;return o(),n(w,null,[i(x,{model:ce.value,direction:"down",transitionDelay:80,class:"absolute top-0 left-0 border-0"},{button:c(({toggleCallback:a})=>[i(r,{outlined:"",onClick:a,class:"custom-clean-button"},{default:c(()=>[s("img",{src:re.value,style:{width:"38px",height:"38px"}},null,8,Ee)]),_:2},1032,["onClick"])]),item:c(({item:a,toggleCallback:$})=>[s("div",{class:"flex flex-col items-center justify-between",onClick:$},[s("img",{src:a.imagePath,alt:"lang",style:{width:"38px",height:"38px"}},null,8,qe)],8,He)]),_:1},8,["model"]),s("div",Ge,[s("div",null,[i(r,{icon:"pi pi-bell",rounded:"","aria-label":"Filter",onClick:pe,"aria-haspopup":"true","aria-controls":"overlay_menu",size:"small",style:{width:"42px",height:"42px"}}),i(g,{ref_key:"menu",ref:H,id:"overlay_menu",model:ve.value,popup:!0},null,8,["model"])]),V.value&&V.value.trim()!==""?(o(),n("div",We,[i(r,{icon:"pi pi-instagram",class:"custom-clean-button",onClick:me})])):P("",!0)]),s("div",Qe,[s("div",Xe,[s("img",{src:q.value,alt:"Logo",class:"max-w-6rem h-auto w-full mx-auto block"},null,8,Je),(K=(J=d.value)==null?void 0:J.data)!=null&&K.restaurantName?(o(),n("h3",Ke,m((Z=(Y=d.value)==null?void 0:Y.data)==null?void 0:Z.restaurantName),1)):(o(),n("h3",Ye,m(ne.value),1)),s("div",Ze,[u(l).testEnvironment.value?(o(),n("h2",et,m("DEMO"))):P("",!0),u(l).testEnvironment.value?(o(),n("span",tt,m(u(p)("home.demoDescription")),1)):P("",!0)])]),i(je,{visible:O.value,"onUpdate:visible":t[0]||(t[0]=a=>O.value=a),onLoginSuccess:B},null,8,["visible"]),s("div",st,[i(u(Ce),{class:"w-full max-w-xl mx-auto"},{default:c(()=>{var a,$;return[(o(!0),n(w,null,N(($=(a=d.value)==null?void 0:a.data)==null?void 0:$.titles,(f,se)=>(o(),R(u(Ie),{value:se},{default:c(()=>[i(u(Le),null,{default:c(()=>[j(m(T(f.title)),1)]),_:2},1024),i(u(Pe),{class:"p-1"},{default:c(()=>[s("div",lt,[s("div",at,m(T(f.description)),1),s("img",{src:u(l).pathFormated(f.image.src,d.value.imagesPath),class:"max-w-5rem h-auto block mr-auto p-1 invert-image"},null,8,ot),f.title.text_zh.includes("怎么获得学生优惠")?(o(),n("div",nt,[i(r,{onClick:t[1]||(t[1]=I=>U("https://xiaoxiongmarket.com/activity/29ca8401-6cd5-4bac-94f8-d5511c463e26")),text:""},{default:c(()=>[s("div",it,[s("span",rt,m(u(p)("home.eventPage")),1),t[11]||(t[11]=s("i",{class:"pi pi-external-link text-blue-600 text-sm p-1"},null,-1))])]),_:1})])):P("",!0)])]),_:2},1024)]),_:2},1032,["value"]))),256))]}),_:1})]),s("div",ut,[s("div",ct,[i(r,{onClick:t[2]||(t[2]=a=>B()),class:"w-full font-bold",style:{"border-radius":"20px"},ref_key:"orderButtonRef",ref:_},{default:c(()=>[j(m(e.$t("common.eatHere")),1)]),_:1},512),i(r,{onClick:t[3]||(t[3]=a=>fe()),class:"w-full font-bold",style:{"border-radius":"20px"}},{default:c(()=>[j(m(e.$t("common.takeOrReserve")),1)]),_:1})])]),(o(!0),n(w,null,N((te=(ee=d.value)==null?void 0:ee.data)==null?void 0:te.frames,(a,$)=>(o(),n("div",null,[s("div",dt,[(o(!0),n(w,null,N(a,(f,se)=>(o(),n("div",null,[s("h1",mt,m(T(f.title)),1),f.images.length<=1?(o(),n("div",pt,[s("img",{src:u(l).pathFormated(f.images[0].src,d.value.imagesPath),class:"w-full"},null,8,ft)])):(o(),R(u(Fe),{key:1,"slides-per-view":1,loop:!0,class:"w-full",modules:[u(Ue)],pagination:{clickable:!0}},{default:c(()=>[(o(!0),n(w,null,N(f.images,(I,Lt)=>(o(),R(u(Be),null,{default:c(()=>[s("div",vt,[s("img",{src:u(l).pathFormated(I.src,d.value.imagesPath),class:"w-full h-full",style:{"object-fit":"cover"}},null,8,gt)])]),_:2},1024))),256))]),_:2},1032,["modules"])),s("h4",_t,m(T(f.subtitle)),1),(o(!0),n(w,null,N(f.descriptions,I=>(o(),n("div",null,[s("div",ht,[s("div",bt,[s("span",{class:z([Q(0),"break-words text-left"]),innerHTML:G(I.left),style:{"white-space":"pre-wrap"}},null,10,xt),s("span",{class:z([Q(1),"break-words text-right"]),innerHTML:G(I.right),style:{"white-space":"pre-wrap"}},null,10,wt)])])]))),256))]))),256))]),t[12]||(t[12]=s("div",{class:"p-4"},null,-1))]))),256))]),s("div",{class:"absoluto top-0 text-center text-xs p-2 underline cursor-pointer",onClick:t[4]||(t[4]=a=>U("https://5am3eq-wc.myshopify.com/"))}," ©2025 XIAOXIONG® v1.1.114 "),s("div",{class:"absoluto top-0 text-center text-xs p-2",onClick:t[5]||(t[5]=a=>U("https://5am3eq-wc.myshopify.com/"))},t[13]||(t[13]=[s("img",{src:Te,style:{width:"7rem"}},null,-1)])),S.value?P("",!0):(o(),n("div",yt,[i(r,{rounded:"","aria-label":"Star",onClick:t[6]||(t[6]=a=>B()),class:"w-full font-bold p-button-lg shadow-6"},{default:c(()=>t[14]||(t[14]=[s("span",{class:"material-icons text-5xl"},"restaurant",-1)])),_:1,__:[14]})])),i(xe,{visible:F.value,"onUpdate:visible":t[10]||(t[10]=a=>F.value=a),header:"结账",class:"flex flex-column",modal:!0,dismissableMask:!0,onHide:he},{default:c(()=>[s("div",null,[t[15]||(t[15]=s("label",null,"NIF:",-1)),i(X,{modelValue:A.value,"onUpdate:modelValue":t[7]||(t[7]=a=>A.value=a),inputId:"withoutgrouping",useGrouping:!1,fluid:"",class:"w-full m-1"},null,8,["modelValue"])]),s("div",kt,[s("label",null,m(e.$t("common.note"))+":",1),i(be,{type:"text",modelValue:C.value,"onUpdate:modelValue":t[8]||(t[8]=a=>C.value=a),class:"w-full m-1"},null,8,["modelValue"])]),s("div",Ct,[i(r,{label:u(p)("common.send"),onClick:t[9]||(t[9]=a=>_e())},null,8,["label"])])]),_:1},8,["visible"])],64)}}},Mt=ze($t,[["__scopeId","data-v-750a0457"]]);export{Mt as default};
