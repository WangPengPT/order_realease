import{s as U}from"./index-ChEAZfII.js";import{s as A}from"./index-BuKhgiCU.js";import{s as L}from"./index-xjOFinAs.js";import{s as q,a as E}from"./index-BEk3syF_.js";import{s as j,a as G}from"./index-B7wsA5Lo.js";import{s as H}from"./index-Sb8o0RiY.js";import{q as K,n as u,h as m,s as J,c as g,a as l,d as o,w as n,l as r,F as y,o as v,A as Q,z as W,t as i,C as X,E as Y,e as Z,G as ee}from"./index-IaMIkG_c.js";import"./index-R0eUruuE.js";import"./index-BdgN26ma.js";import"./index-BqdszUjY.js";import"./index-DXWtzxcJ.js";import"./index-uuCjZP-2.js";import"./index-BAbo8VIj.js";import"./index-CZiqnx9t.js";import"./index-Yybf5lZv.js";import"./index-BPJt-l9y.js";import"./index-B8buMSQ3.js";import"./index-CZnoWNBg.js";const te={class:"card h-full",style:{display:"flex","flex-direction":"column"}},ae={class:"flex flex-column"},se={class:"flex flex-wrap gap-2 items-center justify-between"},le={class:"m-0 font-bold text-2xl text-left flex-grow-1"},oe=["onClick"],re={class:"text-center py-5"},ne={class:"mt-3 text-gray-500"},ie={style:{"list-style-type":"none","padding-left":"0"}},de={class:"flex flex-wrap p-2 items-center gap-4"},ue={style:{"max-width":"200px"}},ce={key:0,style:{"max-width":"200px"}},Oe={__name:"OrderPage",setup(pe){const{t:s}=K(),x=u.orders,f=m(!1),d=m(null),h=m(!1),c=m(null),N=J(()=>[{label:s("orderPage.completed"),value:"completed"},{label:s("orderPage.read"),value:"read"},{label:s("orderPage.new"),value:"new"}]),_=m({global:{value:null,matchMode:ee.CONTAINS}}),P=e=>({completed:s("orderPage.completed"),read:s("orderPage.read"),new:s("orderPage.new")})[e]||e,C=e=>({completed:"status-completed",read:"status-read",new:"status-new"})[e]||"";function S(e){d.value=e,f.value=!1,c.value=e.status,h.value=!0}function D(){c.value!==null&&(d.value.status!==c.value&&(d.value.status==="new"&&u.updateNewOrderCount("order",-1),c.value==="new"&&u.updateNewOrderCount("order",1),d.value.status=c.value,u.updateOrderStatus(d.value)),h.value=!1)}const k=e=>new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});function M(e){e.data?(d.value=e.data,console.log("selRow.value",d.value),f.value=!0,e.data.isNew=!1,e.data.status=="new"&&(e.data.status="read",u.updateOrderStatus(e.data),u.updateNewOrderCount("order",-1))):console.error("Row data is missing in the event",e)}function V(e){const a=u.menuApi.getDishNameById(e.dishid);return a||e.name}function O(e){return e.dishid?e.dishid:e.name}function I(e){return u.getDishNote(e)}return(e,a)=>{const $=G,R=H,B=j,p=E,F=q,T=L,w=A,z=U;return v(),g(y,null,[l("div",te,[o(F,{value:r(x),tableStyle:"min-width: 50rem",dataKey:"id",paginator:"",rows:5,rowsPerPageOptions:[5,10,20,50],stripedRows:"",filters:_.value,scrollable:"",scrollHeight:"flex",onRowClick:M,selectionMode:"single"},{header:n(()=>[l("div",ae,[l("div",se,[l("h4",le,i(r(s)("orderPage.orders")),1),o(B,null,{default:n(()=>[o($,null,{default:n(()=>a[4]||(a[4]=[l("i",{class:"pi pi-search"},null,-1)])),_:1,__:[4]}),o(R,{modelValue:_.value.global.value,"onUpdate:modelValue":a[0]||(a[0]=t=>_.value.global.value=t),placeholder:r(s)("orderPage.find")},null,8,["modelValue","placeholder"])]),_:1})])])]),empty:n(()=>[l("div",re,[a[5]||(a[5]=l("i",{class:"pi pi-search",style:{"font-size":"3rem",color:"#ccc"}},null,-1)),l("p",ne,i(r(s)("orderPage.notFound")),1)])]),default:n(()=>[o(p,{field:"status",header:r(s)("orderPage.status"),sortable:"",style:{width:"10%"}},{body:n(({data:t})=>[l("span",{class:W(["status-badge",C(t.status)]),onClick:Q(b=>S(t),["stop"])},i(P(t.status)),11,oe)]),_:1},8,["header"]),o(p,{field:"id",header:r(s)("orderPage.orderNumber"),sortable:"",style:{width:"10%"}},null,8,["header"]),o(p,{field:"table",header:r(s)("orderPage.tableNumber"),sortable:"",style:{width:"10%"}},null,8,["header"]),o(p,{field:"time",header:r(s)("orderPage.time"),sortable:"",style:{width:"20%"}},{body:n(({data:t})=>[X(i(k(t.timestamp)),1)]),_:1},8,["header"]),o(p,{field:"name",header:r(s)("orderPage.name"),style:{width:"15%"}},null,8,["header"]),o(p,{field:"note",header:r(s)("orderPage.notes"),style:{width:"35%"},class:"multiline-cell"},null,8,["header"])]),_:1},8,["value","filters"])]),l("div",null,[o(w,{visible:f.value,"onUpdate:visible":a[1]||(a[1]=t=>f.value=t),header:r(s)("orderPage.details"),modal:!0,dismissableMask:!0},{default:n(()=>[l("ul",ie,[(v(!0),g(y,null,Y(d.value.items,(t,b)=>(v(),g("li",{key:b},[l("div",de,[l("label",null,i(O(t)),1),l("label",null,i(V(t)),1),l("label",null,"x "+i(t.quantity),1),l("label",ue,i(I(t.notes)),1),t.dishNote?(v(),g("label",ce,i(t.dishNote),1)):Z("",!0)]),o(T)]))),128))])]),_:1},8,["visible","header"])]),l("div",null,[o(w,{visible:h.value,"onUpdate:visible":a[3]||(a[3]=t=>h.value=t),header:r(s)("orderPage.orderStatus"),modal:!0,dismissableMask:!0},{default:n(()=>[o(z,{modelValue:c.value,"onUpdate:modelValue":a[2]||(a[2]=t=>c.value=t),options:N.value,optionLabel:"label",optionValue:"value",onClick:D},null,8,["modelValue","options"])]),_:1},8,["visible","header"])])],64)}}};export{Oe as default};
