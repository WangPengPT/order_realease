var he=Object.defineProperty;var ge=(o,i,w)=>i in o?he(o,i,{enumerable:!0,configurable:!0,writable:!0,value:w}):o[i]=w;var Q=(o,i,w)=>ge(o,typeof i!="symbol"?i+"":i,w);import{e as ve,a as ye}from"./index-CEmFYd-G.js";import{s as we}from"./index-CTWxDVLN.js";import{R as be,a as H,c as _e,f as Ve}from"./index-BNnB8zR1.js";import{B as Pe,r as $e,c as h,o as f,a as u,b as t,d as S,e as B,m as y,t as v,z as De,w as r,f as X,g as ke,y as Ue,aw as Ce,T as O,u as Se,x as Te,q as Be,aJ as Ne,h as D,s as z,i as Ee,aT as Ae,l as P,n as R,F as G,E as Re,j as Ie,C as M,p as Le}from"./index-BaOLiNlJ.js";import{s as ze}from"./index-C9C-ODsb.js";import{s as Me,a as Oe}from"./index-Chnes_lj.js";import{s as Je}from"./index-DvrhARgE.js";import{s as Ke}from"./index-ZWZMLxOI.js";import{s as je}from"./index-DZCONgTY.js";import{s as Fe}from"./index-BE0AFoJK.js";import{s as We}from"./index-C3IDyQvW.js";import{s as Ye}from"./index-a-k0PATy.js";import{s as qe}from"./index-BFWrS02Y.js";import{_ as Qe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-CHqtfDyr.js";import"./index-DXI-5WHD.js";import"./index-K0TuGyWR.js";import"./index-DNRZQHoa.js";import"./index-CrB6UqKx.js";import"./index-2YY9ZNb5.js";import"./index-Bm_tV6Y7.js";import"./index-BOJmkNZc.js";import"./index-DwBlPRBA.js";import"./index-Bt4N5gJi.js";var Ge=`
    .p-panel {
        display: block;
        border: 1px solid dt('panel.border.color');
        border-radius: dt('panel.border.radius');
        background: dt('panel.background');
        color: dt('panel.color');
    }

    .p-panel-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: dt('panel.header.padding');
        background: dt('panel.header.background');
        color: dt('panel.header.color');
        border-style: solid;
        border-width: dt('panel.header.border.width');
        border-color: dt('panel.header.border.color');
        border-radius: dt('panel.header.border.radius');
    }

    .p-panel-toggleable .p-panel-header {
        padding: dt('panel.toggleable.header.padding');
    }

    .p-panel-title {
        line-height: 1;
        font-weight: dt('panel.title.font.weight');
    }

    .p-panel-content {
        padding: dt('panel.content.padding');
    }

    .p-panel-footer {
        padding: dt('panel.footer.padding');
    }
`,He={root:function(i){var w=i.props;return["p-panel p-component",{"p-panel-toggleable":w.toggleable}]},header:"p-panel-header",title:"p-panel-title",headerActions:"p-panel-header-actions",pcToggleButton:"p-panel-toggle-button",contentContainer:"p-panel-content-container",content:"p-panel-content",footer:"p-panel-footer"},Xe=Pe.extend({name:"panel",style:Ge,classes:He}),Ze={name:"BasePanel",extends:_e,props:{header:String,toggleable:Boolean,collapsed:Boolean,toggleButtonProps:{type:Object,default:function(){return{severity:"secondary",text:!0,rounded:!0}}}},style:Xe,provide:function(){return{$pcPanel:this,$parentInstance:this}}},Z={name:"Panel",extends:Ze,inheritAttrs:!1,emits:["update:collapsed","toggle"],data:function(){return{d_collapsed:this.collapsed}},watch:{collapsed:function(i){this.d_collapsed=i}},methods:{toggle:function(i){this.d_collapsed=!this.d_collapsed,this.$emit("update:collapsed",this.d_collapsed),this.$emit("toggle",{originalEvent:i,value:this.d_collapsed})},onKeyDown:function(i){(i.code==="Enter"||i.code==="NumpadEnter"||i.code==="Space")&&(this.toggle(i),i.preventDefault())}},computed:{buttonAriaLabel:function(){return this.toggleButtonProps&&this.toggleButtonProps.ariaLabel?this.toggleButtonProps.ariaLabel:this.header},dataP:function(){return Ve({toggleable:this.toggleable})}},components:{PlusIcon:we,MinusIcon:ve,Button:H},directives:{ripple:be}},xe=["data-p"],eo=["data-p"],oo=["id"],to=["id","aria-labelledby"];function lo(o,i,w,J,p,b){var I=$e("Button");return f(),h("div",y({class:o.cx("root"),"data-p":b.dataP},o.ptmi("root")),[u("div",y({class:o.cx("header"),"data-p":b.dataP},o.ptm("header")),[S(o.$slots,"header",{id:o.$id+"_header",class:De(o.cx("title"))},function(){return[o.header?(f(),h("span",y({key:0,id:o.$id+"_header",class:o.cx("title")},o.ptm("title")),v(o.header),17,oo)):B("",!0)]}),u("div",y({class:o.cx("headerActions")},o.ptm("headerActions")),[S(o.$slots,"icons"),o.toggleable?S(o.$slots,"togglebutton",{key:0,collapsed:p.d_collapsed,toggleCallback:function(_){return b.toggle(_)},keydownCallback:function(_){return b.onKeyDown(_)}},function(){return[t(I,y({id:o.$id+"_header",class:o.cx("pcToggleButton"),"aria-label":b.buttonAriaLabel,"aria-controls":o.$id+"_content","aria-expanded":!p.d_collapsed,unstyled:o.unstyled,onClick:i[0]||(i[0]=function(s){return b.toggle(s)}),onKeydown:i[1]||(i[1]=function(s){return b.onKeyDown(s)})},o.toggleButtonProps,{pt:o.ptm("pcToggleButton")}),{icon:r(function(s){return[S(o.$slots,o.$slots.toggleicon?"toggleicon":"togglericon",{collapsed:p.d_collapsed},function(){return[(f(),X(ke(p.d_collapsed?"PlusIcon":"MinusIcon"),y({class:s.class},o.ptm("pcToggleButton").icon),null,16,["class"]))]})]}),_:3},16,["id","class","aria-label","aria-controls","aria-expanded","unstyled","pt"])]}):B("",!0)],16)],16,eo),t(O,y({name:"p-toggleable-content"},o.ptm("transition")),{default:r(function(){return[Ue(u("div",y({id:o.$id+"_content",class:o.cx("contentContainer"),role:"region","aria-labelledby":o.$id+"_header"},o.ptm("contentContainer")),[u("div",y({class:o.cx("content")},o.ptm("content")),[S(o.$slots,"default")],16),o.$slots.footer?(f(),h("div",y({key:0,class:o.cx("footer")},o.ptm("footer")),[S(o.$slots,"footer")],16)):B("",!0)],16,to),[[Ce,!p.d_collapsed]])]}),_:3},16)],16,xe)}Z.render=lo;class no{constructor(){Q(this,"toast")}show(i){i.summary=i.summary,i.detail=i.detail,i.life=3e3,this.toast.add(i)}show_success(i){this.show({severity:"success",summary:"success",detail:i})}show_info(i){this.show({severity:"info",summary:"info",detail:i})}show_warn(i){this.show({severity:"warn",summary:"warn",detail:i})}show_error(i){this.show({severity:"error",summary:"error",detail:i})}}const T=new no,ao={class:"flex flex-column w-full h-full"},io={class:"fixed top-0 left-0 right-0 z-1"},so={key:0,class:"w-full p-4"},ro={class:"flex flex-row gap-4"},uo={class:"flex flex-column gap-2"},po={for:"initialPrice"},co={class:"flex flex-column gap-2"},mo={for:"initialDeliveryPrice"},fo={class:"w-full h-full p-4"},ho={class:"flex flex-row w-full h-full"},go={class:"w-full"},vo={class:"relative w-full h-full"},yo={class:"flex flex-column w-full"},wo={class:"flex items-center gap-2 w-full"},bo={key:0,class:"w-full"},_o={key:0},Vo={key:1},Po={key:1},$o={class:"font-bold p-3"},Do={key:0},ko={key:1},Uo={class:"w-full flex justify-content-end m-2"},Co={__name:"EditCustomDish",setup(o){const i=Se(),w=Te(),J=Ie(),{t:p}=Be(),b=Ne();T.toast=i;const I=b.params.dishId,s=D(void 0),_=D([]),x=z(()=>{var a;return((a=s.value)==null?void 0:a.name)||""}),A=D(void 0),L=z(()=>!s.value||!A.value?!1:JSON.stringify(s.value)!==JSON.stringify(A.value)),K=D([{label:p("common.delete"),icon:"pi pi-times"}]);function ee(){J.push(Le.mainPath.editableCustomeDish.path)}function oe(){if(!L.value){T.show_info(p("notification.noChanges"));return}console.log("current dish",s.value),R.customDishApi.updateCustomDish(s.value,a=>{a.success?(T.show_success(p("notification.updateSuccess")),A.value=JSON.parse(JSON.stringify(s.value))):T.show_warn(p("notification.updateFailed"))})}function te(a=5e3,n=100){return new Promise((m,$)=>{const N=Date.now(),k=()=>{const E=R.customDishApi.customDishes.value;E&&E.length>0?m(E):Date.now()-N>a?$(new Error("customDishes 超时未加载")):setTimeout(k,n)};k()})}Ee(async()=>{try{const n=(await te()).find(m=>String(m.id)===I);n&&(s.value=JSON.parse(JSON.stringify(n)),A.value=JSON.parse(JSON.stringify(n)),console.log("customDish.value dish:",s.value)),_.value=n.types.map(()=>!0)}catch(a){console.error(a)}});const j=D([]),F=D([]),le=(a,n)=>{const{newData:m,index:$}=a;s.value&&(s.value.types[n].dishes[$]=m)},ne=(a,n)=>{const{newData:m,index:$}=a;s.value&&(s.value.types[n]=m)};function W(a){return`${a}€`}const Y=D([{name:p("menuPage.open"),value:!0},{name:p("menuPage.close"),value:!1}]),ae=(a,n)=>{_.value[n]=a.value};Ae((a,n,m)=>{if(L.value&&!confirm(p("notification.unsavedWarning")||"You have unsaved changes. Leave anyway?"))return m(!1);m()}),window.addEventListener("beforeunload",a=>{L.value&&(a.preventDefault(),a.returnValue="")});const ie=z(()=>[{name:p("menuPage.dineIn")+" & "+p("menuPage.takeAway"),code:"DINEIN&TAKEAWAY"},{name:p("menuPage.takeAway"),code:"TAKEAWAY"},{name:p("menuPage.dineIn"),code:"DINEIN"}]);function se(a,n){R.customDishApi.updateCustomDishSellType(n.id,a,m=>{m.success?T.show_success(p("notification.updateSuccess")):T.show_warn(p("notification.updateFailed"))})}function re(a){if(!s.value)return;const n=s.value.types[a];n&&(Array.isArray(n.dishes)||(n.dishes=[]),n.dishes.push(de()),_.value[a]=!0)}function de(){return{dishid:Date.now(),name:"",name_zh:"",name_en:"",name_pt:"",price:0,deliveryPrice:0,orderType:null,discount:0,deliveryDiscount:0,enable:!0}}function ue(a,n){w.require({message:"确定要删除这个菜品吗？",header:"确认删除",icon:"pi pi-exclamation-triangle",accept:()=>{const m=s.value.types[a];!m||!m.dishes||m.dishes.splice(n,1)}})}return(a,n)=>{const m=qe,$=Ye,N=H,k=We,E=Fe,pe=je,U=ye,ce=Ke,c=Oe,V=Je,q=Me,me=ze,fe=Z;return f(),h(G,null,[t(m),t($),u("div",ao,[u("div",io,[t(pe,null,{start:r(()=>[t(N,{icon:"pi pi-arrow-left",onClick:ee})]),center:r(()=>[u("span",null,v(x.value),1)]),end:r(()=>[s.value?(f(),X(k,{key:0,modelValue:s.value.sellType,"onUpdate:modelValue":[n[0]||(n[0]=g=>s.value.sellType=g),n[1]||(n[1]=g=>se(g,s.value))],options:ie.value,optionLabel:"name",optionValue:"code",class:"pr-2"},null,8,["modelValue","options"])):B("",!0),t(E,{label:P(p)("topBar.save"),model:K.value,onClick:oe},null,8,["label","model"])]),_:1})]),n[11]||(n[11]=u("div",{style:{"padding-top":"60px"}},null,-1)),P(R).developerMode.value&&s.value?(f(),h("div",so,[t(ce,null,{title:r(()=>[M(v(P(p)("menuPage.developerMode"))+" - "+v(P(p)("menuPage.initialPriceSettings")),1)]),content:r(()=>[u("div",ro,[u("div",uo,[u("label",po,v(P(p)("menuPage.initialPrice"))+" ("+v(P(p)("menuPage.dineIn"))+")",1),t(U,{id:"initialPrice",modelValue:s.value.initialPrice,"onUpdate:modelValue":n[2]||(n[2]=g=>s.value.initialPrice=g),mode:"currency",currency:"EUR",locale:"pt-PT"},null,8,["modelValue"])]),u("div",co,[u("label",mo,v(P(p)("menuPage.initialPrice"))+" ("+v(P(p)("menuPage.takeAway"))+")",1),t(U,{id:"initialDeliveryPrice",modelValue:s.value.initialDeliveryPrice,"onUpdate:modelValue":n[3]||(n[3]=g=>s.value.initialDeliveryPrice=g),mode:"currency",currency:"EUR",locale:"pt-PT"},null,8,["modelValue"])])])]),_:1})])):B("",!0),u("div",fo,[u("div",ho,[u("div",go,[u("div",vo,[s.value?(f(!0),h(G,{key:0},Re(s.value.types,(g,C)=>(f(),h("div",null,[u("div",yo,[t(O,{name:"smooth-expand",mode:"out-in"},{default:r(()=>[t(fe,{toggleable:"",class:"w-full",onToggle:e=>ae(e,C),collapsed:!0},{header:r(()=>[u("div",wo,[t(O,{name:"slide-fade",mode:"out-in"},{default:r(()=>[_.value[C]?(f(),h("div",bo,[t(q,{value:[g],tableStyle:"min-width: 50rem",editMode:"row",class:"w-full",editingRows:F.value,"onUpdate:editingRows":n[4]||(n[4]=e=>F.value=e),onRowEditSave:e=>ne(e,C)},{default:r(()=>[t(c,{field:"id",header:"Id"}),t(c,{field:"typeName",header:a.$t("menuPage.name")},null,8,["header"]),t(c,{field:"enable",header:a.$t("menuPage.enableDisable")},{body:r(({data:e,field:l})=>[e[l]===!0?(f(),h("div",_o,n[6]||(n[6]=[u("i",{class:"pi pi-circle-fill",style:{color:"green","font-size":"1.5rem"}},null,-1)]))):(f(),h("div",Vo,n[7]||(n[7]=[u("i",{class:"pi pi-circle-fill",style:{color:"red","font-size":"1.5rem"}},null,-1)])))]),editor:r(({data:e,field:l})=>[t(k,{modelValue:e[l],"onUpdate:modelValue":d=>e[l]=d,options:Y.value,optionLabel:"name",optionValue:"value"},null,8,["modelValue","onUpdate:modelValue","options"])]),_:1},8,["header"]),t(c,{field:"typeName_zh",header:a.$t("menuPage.nameCN")},{editor:r(({data:e,field:l})=>[t(V,{modelValue:e[l],"onUpdate:modelValue":d=>e[l]=d,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),t(c,{field:"typeName_pt",header:a.$t("menuPage.namePT")},{editor:r(({data:e,field:l})=>[t(V,{modelValue:e[l],"onUpdate:modelValue":d=>e[l]=d,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),t(c,{field:"typeName_en",header:a.$t("menuPage.nameEN")},{editor:r(({data:e,field:l})=>[t(V,{modelValue:e[l],"onUpdate:modelValue":d=>e[l]=d,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),t(c,{field:"minQuantity",header:a.$t("menuPage.min")},{editor:r(({data:e,field:l})=>[t(U,{modelValue:e[l],"onUpdate:modelValue":d=>e[l]=d,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),t(c,{field:"maxQuantity",header:a.$t("menuPage.max")},{editor:r(({data:e,field:l})=>[t(U,{modelValue:e[l],"onUpdate:modelValue":d=>e[l]=d,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),t(c,{rowEditor:!0,style:{width:"10%","min-width":"8rem"},bodyStyle:"text-align:center"})]),_:2},1032,["value","editingRows","onRowEditSave"])])):(f(),h("div",Po,[u("span",$o,v(g.typeName),1)]))]),_:2},1024)])]),footer:r(()=>n[8]||(n[8]=[u("div",{class:"flex flex-wrap items-center justify-between gap-4"},null,-1)])),icons:r(()=>[t(me,{ref_for:!0,ref:"menu",id:"config_menu",model:K.value,popup:""},null,8,["model"])]),default:r(()=>[u("div",null,[t(q,{value:g.dishes,editingRows:j.value,"onUpdate:editingRows":n[5]||(n[5]=e=>j.value=e),tableStyle:"min-width: 50rem",editMode:"row",onRowEditSave:e=>le(e,C)},{default:r(()=>[t(c,null,{editor:r(({index:e})=>[t(N,{icon:"pi pi-trash",severity:"danger",text:"",onClick:l=>ue(C,e)},null,8,["onClick"])]),_:2},1024),t(c,{field:"dishid",header:"Id"},{editor:r(({data:e,field:l})=>[t(V,{modelValue:e[l],"onUpdate:modelValue":d=>e[l]=d,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(c,{field:"name",header:a.$t("menuPage.name")},{editor:r(({data:e,field:l})=>[t(V,{modelValue:e[l],"onUpdate:modelValue":d=>e[l]=d,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),t(c,{field:"name_zh",header:a.$t("menuPage.nameCN")},{editor:r(({data:e,field:l})=>[t(V,{modelValue:e[l],"onUpdate:modelValue":d=>e[l]=d,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),t(c,{field:"name_en",header:a.$t("menuPage.nameEN")},{editor:r(({data:e,field:l})=>[t(V,{modelValue:e[l],"onUpdate:modelValue":d=>e[l]=d,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),t(c,{field:"name_pt",header:a.$t("menuPage.namePT")},{editor:r(({data:e,field:l})=>[t(V,{modelValue:e[l],"onUpdate:modelValue":d=>e[l]=d,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),t(c,{field:"enable",header:a.$t("menuPage.enableDisable")},{body:r(({data:e,field:l})=>[e[l]===!0?(f(),h("div",Do,n[9]||(n[9]=[u("i",{class:"pi pi-circle-fill",style:{color:"green","font-size":"1.5rem"}},null,-1)]))):(f(),h("div",ko,n[10]||(n[10]=[u("i",{class:"pi pi-circle-fill",style:{color:"red","font-size":"1.5rem"}},null,-1)])))]),editor:r(({data:e,field:l})=>[t(k,{modelValue:e[l],"onUpdate:modelValue":d=>e[l]=d,options:Y.value,optionLabel:"name",optionValue:"value"},null,8,["modelValue","onUpdate:modelValue","options"])]),_:1},8,["header"]),t(c,{field:"price",header:a.$t("menuPage.price")},{body:r(({data:e,field:l})=>[M(v(W(e[l])),1)]),editor:r(({data:e,field:l})=>[t(U,{modelValue:e[l],"onUpdate:modelValue":d=>e[l]=d,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),t(c,{field:"deliveryPrice",header:a.$t("menuPage.deliveryPrice")},{body:r(({data:e,field:l})=>[M(v(W(e[l])),1)]),editor:r(({data:e,field:l})=>[t(U,{modelValue:e[l],"onUpdate:modelValue":d=>e[l]=d,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),t(c,{rowEditor:!0,bodyStyle:"text-align:center"})]),_:2},1032,["value","editingRows","onRowEditSave"]),u("div",Uo,[t(N,{icon:"pi pi-plus",onClick:e=>re(C)},null,8,["onClick"])])])]),_:2},1032,["onToggle"])]),_:2},1024)])]))),256)):B("",!0)])])])])])],64)}}},et=Qe(Co,[["__scopeId","data-v-7fb76286"]]);export{et as default};
