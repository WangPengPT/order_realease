var me=Object.defineProperty;var fe=(o,s,v)=>s in o?me(o,s,{enumerable:!0,configurable:!0,writable:!0,value:v}):o[s]=v;var Y=(o,s,v)=>fe(o,typeof s!="symbol"?s+"":s,v);import{e as he,a as ge}from"./index-_uKmlvWK.js";import{s as ve}from"./index-BMHawzqM.js";import{R as ye,a as G,c as we,f as be}from"./index-BWa0-TPv.js";import{B as Ve,r as _e,c as h,o as f,a as u,b as n,d as k,e as B,m as g,t as U,z as $e,w as i,f as H,g as Pe,y as De,aw as ke,T as z,u as Ce,x as Se,q as Te,aJ as Ue,h as $,s as I,i as Be,aT as Ne,F as q,E as Ee,n as L,j as Ae,l as Re,C as Q,p as Ie}from"./index-Bxf78v2S.js";import{s as Le}from"./index-DwNmU0Ei.js";import{s as ze,a as Oe}from"./index-DAAY8irn.js";import{s as Je}from"./index-CULdYZBu.js";import{s as Me}from"./index-BsJcbVq3.js";import{s as Ke}from"./index-Ca4iX_AV.js";import{s as je}from"./index-CqHMo6-D.js";import{s as Fe}from"./index-BiF_HcI3.js";import{s as We}from"./index-DQAtXbvv.js";import{_ as Ye}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-CvhDf1Ar.js";import"./index-CS_EJTJF.js";import"./index-DUp_YIiu.js";import"./index-qLECj6LO.js";import"./index-14NAMr2s.js";import"./index-Czocopw6.js";import"./index-BCqmycmg.js";import"./index-DFDZnx-s.js";import"./index-CC4hqRwV.js";import"./index-r4zklyLZ.js";var qe=`
    .p-panel {
        display: block;
        border: 1px solid dt('panel.border.color');
        border-radius: dt('panel.border.radius');
        background: dt('panel.background');
        color: dt('panel.color');
    }

    .p-panel-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: dt('panel.header.padding');
        background: dt('panel.header.background');
        color: dt('panel.header.color');
        border-style: solid;
        border-width: dt('panel.header.border.width');
        border-color: dt('panel.header.border.color');
        border-radius: dt('panel.header.border.radius');
    }

    .p-panel-toggleable .p-panel-header {
        padding: dt('panel.toggleable.header.padding');
    }

    .p-panel-title {
        line-height: 1;
        font-weight: dt('panel.title.font.weight');
    }

    .p-panel-content {
        padding: dt('panel.content.padding');
    }

    .p-panel-footer {
        padding: dt('panel.footer.padding');
    }
`,Qe={root:function(s){var v=s.props;return["p-panel p-component",{"p-panel-toggleable":v.toggleable}]},header:"p-panel-header",title:"p-panel-title",headerActions:"p-panel-header-actions",pcToggleButton:"p-panel-toggle-button",contentContainer:"p-panel-content-container",content:"p-panel-content",footer:"p-panel-footer"},Ge=Ve.extend({name:"panel",style:qe,classes:Qe}),He={name:"BasePanel",extends:we,props:{header:String,toggleable:Boolean,collapsed:Boolean,toggleButtonProps:{type:Object,default:function(){return{severity:"secondary",text:!0,rounded:!0}}}},style:Ge,provide:function(){return{$pcPanel:this,$parentInstance:this}}},X={name:"Panel",extends:He,inheritAttrs:!1,emits:["update:collapsed","toggle"],data:function(){return{d_collapsed:this.collapsed}},watch:{collapsed:function(s){this.d_collapsed=s}},methods:{toggle:function(s){this.d_collapsed=!this.d_collapsed,this.$emit("update:collapsed",this.d_collapsed),this.$emit("toggle",{originalEvent:s,value:this.d_collapsed})},onKeyDown:function(s){(s.code==="Enter"||s.code==="NumpadEnter"||s.code==="Space")&&(this.toggle(s),s.preventDefault())}},computed:{buttonAriaLabel:function(){return this.toggleButtonProps&&this.toggleButtonProps.ariaLabel?this.toggleButtonProps.ariaLabel:this.header},dataP:function(){return be({toggleable:this.toggleable})}},components:{PlusIcon:ve,MinusIcon:he,Button:G},directives:{ripple:ye}},Xe=["data-p"],Ze=["data-p"],xe=["id"],eo=["id","aria-labelledby"];function oo(o,s,v,O,p,y){var A=_e("Button");return f(),h("div",g({class:o.cx("root"),"data-p":y.dataP},o.ptmi("root")),[u("div",g({class:o.cx("header"),"data-p":y.dataP},o.ptm("header")),[k(o.$slots,"header",{id:o.$id+"_header",class:$e(o.cx("title"))},function(){return[o.header?(f(),h("span",g({key:0,id:o.$id+"_header",class:o.cx("title")},o.ptm("title")),U(o.header),17,xe)):B("",!0)]}),u("div",g({class:o.cx("headerActions")},o.ptm("headerActions")),[k(o.$slots,"icons"),o.toggleable?k(o.$slots,"togglebutton",{key:0,collapsed:p.d_collapsed,toggleCallback:function(w){return y.toggle(w)},keydownCallback:function(w){return y.onKeyDown(w)}},function(){return[n(A,g({id:o.$id+"_header",class:o.cx("pcToggleButton"),"aria-label":y.buttonAriaLabel,"aria-controls":o.$id+"_content","aria-expanded":!p.d_collapsed,unstyled:o.unstyled,onClick:s[0]||(s[0]=function(d){return y.toggle(d)}),onKeydown:s[1]||(s[1]=function(d){return y.onKeyDown(d)})},o.toggleButtonProps,{pt:o.ptm("pcToggleButton")}),{icon:i(function(d){return[k(o.$slots,o.$slots.toggleicon?"toggleicon":"togglericon",{collapsed:p.d_collapsed},function(){return[(f(),H(Pe(p.d_collapsed?"PlusIcon":"MinusIcon"),g({class:d.class},o.ptm("pcToggleButton").icon),null,16,["class"]))]})]}),_:3},16,["id","class","aria-label","aria-controls","aria-expanded","unstyled","pt"])]}):B("",!0)],16)],16,Ze),n(z,g({name:"p-toggleable-content"},o.ptm("transition")),{default:i(function(){return[De(u("div",g({id:o.$id+"_content",class:o.cx("contentContainer"),role:"region","aria-labelledby":o.$id+"_header"},o.ptm("contentContainer")),[u("div",g({class:o.cx("content")},o.ptm("content")),[k(o.$slots,"default")],16),o.$slots.footer?(f(),h("div",g({key:0,class:o.cx("footer")},o.ptm("footer")),[k(o.$slots,"footer")],16)):B("",!0)],16,eo),[[ke,!p.d_collapsed]])]}),_:3},16)],16,Xe)}X.render=oo;class to{constructor(){Y(this,"toast")}show(s){s.summary=s.summary,s.detail=s.detail,s.life=3e3,this.toast.add(s)}show_success(s){this.show({severity:"success",summary:"success",detail:s})}show_info(s){this.show({severity:"info",summary:"info",detail:s})}show_warn(s){this.show({severity:"warn",summary:"warn",detail:s})}show_error(s){this.show({severity:"error",summary:"error",detail:s})}}const C=new to,no={class:"flex flex-column w-full h-full"},lo={class:"fixed top-0 left-0 right-0 z-1"},ao={class:"w-full h-full p-4"},so={class:"flex flex-row w-full h-full"},io={class:"w-full"},ro={class:"relative w-full h-full"},uo={class:"flex flex-column w-full"},po={class:"flex items-center gap-2 w-full"},co={key:0,class:"w-full"},mo={key:0},fo={key:1},ho={key:1},go={class:"font-bold p-3"},vo={key:0},yo={key:1},wo={class:"w-full flex justify-content-end m-2"},bo={__name:"EditCustomDish",setup(o){const s=Ce(),v=Se(),O=Ae(),{t:p}=Te(),y=Ue();C.toast=s;const A=y.params.dishId,d=$(void 0),w=$([]),Z=I(()=>{var l;return((l=d.value)==null?void 0:l.name)||""}),N=$(void 0),R=I(()=>!d.value||!N.value?!1:JSON.stringify(d.value)!==JSON.stringify(N.value)),J=$([{label:p("common.delete"),icon:"pi pi-times"}]);function x(){O.push(Ie.mainPath.editableCustomeDish.path)}function ee(){if(!R.value){C.show_info(p("notification.noChanges"));return}console.log("current dish",d.value),L.customDishApi.updateCustomDish(d.value,l=>{l.success?(C.show_success(p("notification.updateSuccess")),N.value=JSON.parse(JSON.stringify(d.value))):C.show_warn(p("notification.updateFailed"))})}function oe(l=5e3,a=100){return new Promise((m,V)=>{const S=Date.now(),P=()=>{const T=L.customDishApi.customDishes.value;T&&T.length>0?m(T):Date.now()-S>l?V(new Error("customDishes 超时未加载")):setTimeout(P,a)};P()})}Be(async()=>{try{const a=(await oe()).find(m=>String(m.id)===A);a&&(d.value=JSON.parse(JSON.stringify(a)),N.value=JSON.parse(JSON.stringify(a)),console.log("customDish.value dish:",d.value)),w.value=a.types.map(()=>!0)}catch(l){console.error(l)}});const M=$([]),K=$([]),te=(l,a)=>{const{newData:m,index:V}=l;d.value&&(d.value.types[a].dishes[V]=m)},ne=(l,a)=>{const{newData:m,index:V}=l;d.value&&(d.value.types[a]=m)};function j(l){return`${l}€`}const F=$([{name:p("menuPage.open"),value:!0},{name:p("menuPage.close"),value:!1}]),le=(l,a)=>{w.value[a]=l.value};Ne((l,a,m)=>{if(R.value&&!confirm(p("notification.unsavedWarning")||"You have unsaved changes. Leave anyway?"))return m(!1);m()}),window.addEventListener("beforeunload",l=>{R.value&&(l.preventDefault(),l.returnValue="")});const ae=I(()=>[{name:p("menuPage.dineIn")+" & "+p("menuPage.takeAway"),code:"DINEIN&TAKEAWAY"},{name:p("menuPage.takeAway"),code:"TAKEAWAY"},{name:p("menuPage.dineIn"),code:"DINEIN"}]);function se(l,a){L.customDishApi.updateCustomDishSellType(a.id,l,m=>{m.success?C.show_success(p("notification.updateSuccess")):C.show_warn(p("notification.updateFailed"))})}function ie(l){if(!d.value)return;const a=d.value.types[l];a&&(Array.isArray(a.dishes)||(a.dishes=[]),a.dishes.push(de()),w.value[l]=!0)}function de(){return{dishid:Date.now(),name:"",name_zh:"",name_en:"",name_pt:"",price:0,deliveryPrice:0,orderType:null,discount:0,deliveryDiscount:0,enable:!0}}function re(l,a){v.require({message:"确定要删除这个菜品吗？",header:"确认删除",icon:"pi pi-exclamation-triangle",accept:()=>{const m=d.value.types[l];!m||!m.dishes||m.dishes.splice(a,1)}})}return(l,a)=>{const m=We,V=Fe,S=G,P=je,T=Ke,ue=Me,c=Oe,b=Je,E=ge,W=ze,pe=Le,ce=X;return f(),h(q,null,[n(m),n(V),u("div",no,[u("div",lo,[n(ue,null,{start:i(()=>[n(S,{icon:"pi pi-arrow-left",onClick:x})]),center:i(()=>[u("span",null,U(Z.value),1)]),end:i(()=>[d.value?(f(),H(P,{key:0,modelValue:d.value.sellType,"onUpdate:modelValue":[a[0]||(a[0]=_=>d.value.sellType=_),a[1]||(a[1]=_=>se(_,d.value))],options:ae.value,optionLabel:"name",optionValue:"code",class:"pr-2"},null,8,["modelValue","options"])):B("",!0),n(T,{label:Re(p)("topBar.save"),model:J.value,onClick:ee},null,8,["label","model"])]),_:1})]),a[9]||(a[9]=u("div",{style:{"padding-top":"60px"}},null,-1)),u("div",ao,[u("div",so,[u("div",io,[u("div",ro,[d.value?(f(!0),h(q,{key:0},Ee(d.value.types,(_,D)=>(f(),h("div",null,[u("div",uo,[n(z,{name:"smooth-expand",mode:"out-in"},{default:i(()=>[n(ce,{toggleable:"",class:"w-full",onToggle:e=>le(e,D),collapsed:!0},{header:i(()=>[u("div",po,[n(z,{name:"slide-fade",mode:"out-in"},{default:i(()=>[w.value[D]?(f(),h("div",co,[n(W,{value:[_],tableStyle:"min-width: 50rem",editMode:"row",class:"w-full",editingRows:K.value,"onUpdate:editingRows":a[2]||(a[2]=e=>K.value=e),onRowEditSave:e=>ne(e,D)},{default:i(()=>[n(c,{field:"id",header:"Id"}),n(c,{field:"typeName",header:l.$t("menuPage.name")},null,8,["header"]),n(c,{field:"enable",header:l.$t("menuPage.enableDisable")},{body:i(({data:e,field:t})=>[e[t]===!0?(f(),h("div",mo,a[4]||(a[4]=[u("i",{class:"pi pi-circle-fill",style:{color:"green","font-size":"1.5rem"}},null,-1)]))):(f(),h("div",fo,a[5]||(a[5]=[u("i",{class:"pi pi-circle-fill",style:{color:"red","font-size":"1.5rem"}},null,-1)])))]),editor:i(({data:e,field:t})=>[n(P,{modelValue:e[t],"onUpdate:modelValue":r=>e[t]=r,options:F.value,optionLabel:"name",optionValue:"value"},null,8,["modelValue","onUpdate:modelValue","options"])]),_:1},8,["header"]),n(c,{field:"typeName_zh",header:l.$t("menuPage.nameCN")},{editor:i(({data:e,field:t})=>[n(b,{modelValue:e[t],"onUpdate:modelValue":r=>e[t]=r,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(c,{field:"typeName_pt",header:l.$t("menuPage.namePT")},{editor:i(({data:e,field:t})=>[n(b,{modelValue:e[t],"onUpdate:modelValue":r=>e[t]=r,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(c,{field:"typeName_en",header:l.$t("menuPage.nameEN")},{editor:i(({data:e,field:t})=>[n(b,{modelValue:e[t],"onUpdate:modelValue":r=>e[t]=r,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(c,{field:"minQuantity",header:l.$t("menuPage.min")},{editor:i(({data:e,field:t})=>[n(E,{modelValue:e[t],"onUpdate:modelValue":r=>e[t]=r,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(c,{field:"maxQuantity",header:l.$t("menuPage.max")},{editor:i(({data:e,field:t})=>[n(E,{modelValue:e[t],"onUpdate:modelValue":r=>e[t]=r,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(c,{rowEditor:!0,style:{width:"10%","min-width":"8rem"},bodyStyle:"text-align:center"})]),_:2},1032,["value","editingRows","onRowEditSave"])])):(f(),h("div",ho,[u("span",go,U(_.typeName),1)]))]),_:2},1024)])]),footer:i(()=>a[6]||(a[6]=[u("div",{class:"flex flex-wrap items-center justify-between gap-4"},null,-1)])),icons:i(()=>[n(pe,{ref_for:!0,ref:"menu",id:"config_menu",model:J.value,popup:""},null,8,["model"])]),default:i(()=>[u("div",null,[n(W,{value:_.dishes,editingRows:M.value,"onUpdate:editingRows":a[3]||(a[3]=e=>M.value=e),tableStyle:"min-width: 50rem",editMode:"row",onRowEditSave:e=>te(e,D)},{default:i(()=>[n(c,null,{editor:i(({index:e})=>[n(S,{icon:"pi pi-trash",severity:"danger",text:"",onClick:t=>re(D,e)},null,8,["onClick"])]),_:2},1024),n(c,{field:"dishid",header:"Id"},{editor:i(({data:e,field:t})=>[n(b,{modelValue:e[t],"onUpdate:modelValue":r=>e[t]=r,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),n(c,{field:"name",header:l.$t("menuPage.name")},{editor:i(({data:e,field:t})=>[n(b,{modelValue:e[t],"onUpdate:modelValue":r=>e[t]=r,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(c,{field:"name_zh",header:l.$t("menuPage.nameCN")},{editor:i(({data:e,field:t})=>[n(b,{modelValue:e[t],"onUpdate:modelValue":r=>e[t]=r,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(c,{field:"name_en",header:l.$t("menuPage.nameEN")},{editor:i(({data:e,field:t})=>[n(b,{modelValue:e[t],"onUpdate:modelValue":r=>e[t]=r,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(c,{field:"name_pt",header:l.$t("menuPage.namePT")},{editor:i(({data:e,field:t})=>[n(b,{modelValue:e[t],"onUpdate:modelValue":r=>e[t]=r,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(c,{field:"enable",header:l.$t("menuPage.enableDisable")},{body:i(({data:e,field:t})=>[e[t]===!0?(f(),h("div",vo,a[7]||(a[7]=[u("i",{class:"pi pi-circle-fill",style:{color:"green","font-size":"1.5rem"}},null,-1)]))):(f(),h("div",yo,a[8]||(a[8]=[u("i",{class:"pi pi-circle-fill",style:{color:"red","font-size":"1.5rem"}},null,-1)])))]),editor:i(({data:e,field:t})=>[n(P,{modelValue:e[t],"onUpdate:modelValue":r=>e[t]=r,options:F.value,optionLabel:"name",optionValue:"value"},null,8,["modelValue","onUpdate:modelValue","options"])]),_:1},8,["header"]),n(c,{field:"price",header:l.$t("menuPage.price")},{body:i(({data:e,field:t})=>[Q(U(j(e[t])),1)]),editor:i(({data:e,field:t})=>[n(E,{modelValue:e[t],"onUpdate:modelValue":r=>e[t]=r,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(c,{field:"deliveryPrice",header:l.$t("menuPage.deliveryPrice")},{body:i(({data:e,field:t})=>[Q(U(j(e[t])),1)]),editor:i(({data:e,field:t})=>[n(E,{modelValue:e[t],"onUpdate:modelValue":r=>e[t]=r,fluid:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),n(c,{rowEditor:!0,bodyStyle:"text-align:center"})]),_:2},1032,["value","editingRows","onRowEditSave"]),u("div",wo,[n(S,{icon:"pi pi-plus",onClick:e=>ie(D)},null,8,["onClick"])])])]),_:2},1032,["onToggle"])]),_:2},1024)])]))),256)):B("",!0)])])])])])],64)}}},Wo=Ye(bo,[["__scopeId","data-v-552d8214"]]);export{Wo as default};
