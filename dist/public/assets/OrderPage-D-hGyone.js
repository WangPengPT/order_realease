import{s as X}from"./index-C3jMJh9v.js";import{s as Y}from"./index-DntnN66o.js";import{s as Z}from"./index-Bo5ntoVo.js";import{s as ee,a as te}from"./index-JHNLuJPi.js";import{s as se,a as ae}from"./index-aWLE-PUb.js";import{s as re}from"./index-SG0pzpR-.js";import{a as le}from"./index-IO7XCKEu.js";import{q as oe,n,h as g,s as de,c,a as t,b as i,w as u,l as o,F as M,o as p,A as ie,z as y,t as l,C as ne,e as b,E as ue,G as ce}from"./index-DUqYp7lY.js";import"./index-BXlhR3Pt.js";import"./index-DERn7--M.js";import"./index-DWJiXn1y.js";import"./index-uq9xBe67.js";import"./index-Dkx6Dqe3.js";import"./index-1auV9J53.js";import"./index-B7NP7Q6b.js";import"./index-BMjSXOjj.js";const pe={class:"card h-full",style:{display:"flex","flex-direction":"column"}},me={class:"flex flex-column"},_e={class:"flex flex-wrap gap-2 items-center justify-between"},he={class:"m-0 font-bold text-2xl text-left flex-grow-1"},ge=["onClick"],fe={key:1,class:"text-gray-400"},ve={class:"text-center py-5"},be={class:"mt-3 text-gray-500"},we={key:0,class:"rider-info-section mb-4 p-3 border-1 surface-border border-round"},ye={class:"mb-3 text-primary"},Pe={class:"grid"},xe={class:"col-6"},De={class:"font-semibold"},Ne={class:"mt-1"},ke={class:"col-6"},Ce={class:"font-semibold"},Se={class:"mt-1"},Re={class:"col-6"},Me={class:"font-semibold"},Ie={class:"mt-1"},Oe={key:0,class:"col-6"},Ve={class:"font-semibold"},Ae={class:"mt-1"},Te={key:0,class:"mt-3"},$e={class:"font-semibold"},Be={class:"mt-1 text-gray-600"},Fe={class:"order-items-section"},Ue={class:"mb-3"},ze={style:{"list-style-type":"none","padding-left":"0"}},Ee={class:"flex flex-wrap p-2 items-center gap-4"},Le={style:{"max-width":"200px"}},qe={key:0,style:{"max-width":"200px"}},dt={__name:"OrderPage",setup(je){const{t:s}=oe(),P=n.orders,f=g(!1),d=g(null),v=g(!1),m=g(null),I=de(()=>[{label:s("orderPage.completed"),value:"completed"},{label:s("orderPage.read"),value:"read"},{label:s("orderPage.new"),value:"new"}]),w=g({global:{value:null,matchMode:ce.CONTAINS}}),O=e=>({completed:s("orderPage.completed"),read:s("orderPage.read"),new:s("orderPage.new")})[e]||e,V=e=>({completed:"status-completed",read:"status-read",new:"status-new"})[e]||"",x=e=>({accepted:s("orderPage.riderAccepted"),picking_up:s("orderPage.riderPickingUp"),delivering:s("orderPage.riderDelivering"),delivered:s("orderPage.riderDelivered"),abandoned:s("orderPage.riderAbandoned"),cancelled:s("orderPage.riderCancelled")})[e]||e,D=e=>({accepted:"rider-status-accepted",picking_up:"rider-status-picking-up",delivering:"rider-status-delivering",delivered:"rider-status-delivered",abandoned:"rider-status-abandoned",cancelled:"rider-status-cancelled"})[e]||"",A=e=>e&&e.riderData&&(e.riderData.riderName||e.riderData.riderPhone||e.riderData.state),T=e=>e&&e.riderData?e.riderData.riderName:null,$=e=>e&&e.riderData?e.riderData.riderPhone:null,h=e=>e&&e.riderData?e.riderData.state:null,N=e=>e&&e.riderData?e.riderData.riderActionTime:null,k=e=>e&&e.riderData?e.riderData.reason:null;function B(e){d.value=e,f.value=!1,m.value=e.status,v.value=!0}function F(){m.value!==null&&(d.value.status!==m.value&&(d.value.status==="new"&&n.updateNewOrderCount("order",-1),m.value==="new"&&n.updateNewOrderCount("order",1),d.value.status=m.value,n.updateOrderStatus(d.value)),v.value=!1)}function U(){P.value.forEach(e=>{e.status=="new"&&(e.status="read",n.updateOrderStatus(e),n.updateNewOrderCount("order",-1))})}const C=e=>new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});function z(e){e.data?(d.value=e.data,console.log("selRow.value",d.value),f.value=!0,e.data.isNew=!1,e.data.status=="new"&&(e.data.status="read",n.updateOrderStatus(e.data),n.updateNewOrderCount("order",-1))):console.error("Row data is missing in the event",e)}function E(e){const r=n.menuApi.getDishNameById(e.dishid);return r||e.name}function L(e){return e.dishid?e.dishid:e.name}function q(e){return n.getDishNote(e)}return(e,r)=>{const j=le,G=ae,H=re,K=se,_=te,J=ee,Q=Z,S=Y,W=X;return p(),c(M,null,[t("div",pe,[i(J,{value:o(P),tableStyle:"min-width: 50rem",dataKey:"id",paginator:"",rows:5,rowsPerPageOptions:[5,10,20,50],stripedRows:"",scrollable:"",scrollHeight:"flex",selectionMode:"single",filters:w.value,onRowClick:z},{header:u(()=>[t("div",me,[t("div",_e,[t("h4",he,l(o(s)("orderPage.orders")),1),i(j,{label:o(s)("orderPage.markAllAsRead"),onClick:r[0]||(r[0]=a=>U())},null,8,["label"]),i(K,null,{default:u(()=>[i(G,null,{default:u(()=>r[5]||(r[5]=[t("i",{class:"pi pi-search"},null,-1)])),_:1,__:[5]}),i(H,{modelValue:w.value.global.value,"onUpdate:modelValue":r[1]||(r[1]=a=>w.value.global.value=a),placeholder:o(s)("orderPage.find")},null,8,["modelValue","placeholder"])]),_:1})])])]),empty:u(()=>[t("div",ve,[r[6]||(r[6]=t("i",{class:"pi pi-search",style:{"font-size":"3rem",color:"#ccc"}},null,-1)),t("p",be,l(o(s)("orderPage.notFound")),1)])]),default:u(()=>[i(_,{field:"status",header:o(s)("orderPage.status"),sortable:"",style:{width:"10%"}},{body:u(({data:a})=>[t("span",{class:y(["status-badge",V(a.status)]),onClick:ie(R=>B(a),["stop"])},l(O(a.status)),11,ge)]),_:1},8,["header"]),i(_,{field:"id",header:o(s)("orderPage.orderNumber"),sortable:"",style:{width:"10%"}},null,8,["header"]),i(_,{field:"table",header:o(s)("orderPage.tableNumber"),sortable:"",style:{width:"10%"}},null,8,["header"]),i(_,{field:"time",header:o(s)("orderPage.time"),sortable:"",style:{width:"15%"}},{body:u(({data:a})=>[ne(l(C(a.timestamp)),1)]),_:1},8,["header"]),i(_,{field:"name",header:o(s)("orderPage.name"),style:{width:"10%"}},null,8,["header"]),i(_,{field:"rider_status",header:o(s)("orderPage.riderStatus"),sortable:"",style:{width:"10%"}},{body:u(({data:a})=>[h(a)?(p(),c("span",{key:0,class:y(["rider-status-badge",D(h(a))])},l(x(h(a))),3)):(p(),c("span",fe,"-"))]),_:1},8,["header"]),i(_,{field:"note",header:o(s)("orderPage.notes"),style:{width:"25%"},class:"multiline-cell"},null,8,["header"])]),_:1},8,["value","filters"])]),t("div",null,[i(S,{visible:f.value,"onUpdate:visible":r[2]||(r[2]=a=>f.value=a),header:o(s)("orderPage.details"),modal:!0,dismissableMask:!0,style:{width:"600px"}},{default:u(()=>[d.value&&A(d.value)?(p(),c("div",we,[t("h5",ye,l(o(s)("orderPage.riderInfo")),1),t("div",Pe,[t("div",xe,[t("label",De,l(o(s)("orderPage.riderName"))+":",1),t("p",Ne,l(T(d.value)||"-"),1)]),t("div",ke,[t("label",Ce,l(o(s)("orderPage.riderPhone"))+":",1),t("p",Se,l($(d.value)||"-"),1)]),t("div",Re,[t("label",Me,l(o(s)("orderPage.riderStatus"))+":",1),t("p",Ie,[t("span",{class:y(["rider-status-badge",D(h(d.value))])},l(x(h(d.value))),3)])]),N(d.value)?(p(),c("div",Oe,[t("label",Ve,l(o(s)("orderPage.lastActionTime"))+":",1),t("p",Ae,l(C(N(d.value))),1)])):b("",!0)]),k(d.value)?(p(),c("div",Te,[t("label",$e,l(o(s)("orderPage.reason"))+":",1),t("p",Be,l(k(d.value)),1)])):b("",!0)])):b("",!0),t("div",Fe,[t("h5",Ue,l(o(s)("orderPage.orderItems")),1),t("ul",ze,[(p(!0),c(M,null,ue(d.value.items,(a,R)=>(p(),c("li",{key:R},[t("div",Ee,[t("label",null,l(L(a)),1),t("label",null,l(E(a)),1),t("label",null,"x "+l(a.quantity),1),t("label",Le,l(q(a.notes)),1),a.dishNote?(p(),c("label",qe,l(a.dishNote),1)):b("",!0)]),i(Q)]))),128))])])]),_:1},8,["visible","header"])]),t("div",null,[i(S,{visible:v.value,"onUpdate:visible":r[4]||(r[4]=a=>v.value=a),header:o(s)("orderPage.orderStatus"),modal:!0,dismissableMask:!0},{default:u(()=>[i(W,{modelValue:m.value,"onUpdate:modelValue":r[3]||(r[3]=a=>m.value=a),options:I.value,optionLabel:"label",optionValue:"value",onClick:F},null,8,["modelValue","options"])]),_:1},8,["visible","header"])])],64)}}};export{dt as default};
