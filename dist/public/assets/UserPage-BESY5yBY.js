import{r as k,o as K,b as h,c,e,z as l,S as a,q as p,R as Q,d as f,s as v,v as g,t as P}from"./vue-BhQbBSxl.js";import{u as W,a as w,k as A,d as $,i as y,n as _}from"./primevue-DzNNCCVj.js";import{c as E}from"./index-CtB4Cq0I.js";import"./vendor-DYQJwaLu.js";const X={class:"user-profile-container p-4 surface-ground min-h-screen"},Y={class:"mb-4"},Z={class:"grid formgrid p-fluid"},ss={class:"col-12 md:col-6 field"},es={class:"col-12 md:col-6 field"},os={class:"col-12 md:col-6 field"},ls={class:"col-12 md:col-6 field"},as={class:"flex flex-column gap-3"},rs={class:"flex flex-column gap-3"},is={class:"field"},ts={key:0,class:"p-error"},ds={class:"field"},ns={key:0,class:"p-error"},us={class:"flex flex-column gap-1"},ms={class:"field"},cs={key:0,class:"p-error"},ps={class:"field"},fs={key:0,class:"p-error"},ws={class:"field"},bs={key:0,class:"p-error"},vs={class:"field"},gs={key:0,class:"p-error"},Ps={class:"flex flex-column gap-3"},ys={class:"field"},ks={key:0,class:"p-error"},xs={class:"field"},Vs={key:0,class:"p-error"},hs={class:"field"},Cs={key:0,class:"p-error"},Ls={__name:"UserPage",setup(Us){const C=W(),S=Q(),u=k({id:"",email:"",registrationDate:"",phone:"",points:0});K(async()=>{u.value.id==""&&(x.value=!0)});const x=k(!1),M=k(!1),b=h({id:"",password:""}),m=h({id:"",password:""});function T(){x.value=!1,U.value=!0}function F(){u.value.id==""&&S.go(-1)}function I(){U.value=!1,u.value.id==""&&(x.value=!0)}async function B(){if(!N())return;const r=b.id,s=b.password;M.value=!0;const o={key:r,password:s};await E.centerAPI("vip_login",o,V=>{V.result?(x.value=!1,u.value=V.user):C.add({severity:"error",summary:"error",detail:V.error,life:3e3}),M.value=!1})}function N(){let r=!0;return m.oldPassword="",m.newPassword="",m.confirmPassword="",b.id||(m.id="please enter id",r=!1),b.password?b.password.length<6&&(m.password="Password length must be at least 6 characters",r=!1):(m.password="please enter password",r=!1),r}const U=k(!1),R=k(!1),n=h({id:"",password:"",email:"",phone:""}),t=h({id:"",password:"",email:"",phone:""});async function z(){if(!O())return;const r={id:n.id,password:n.password,email:n.email,phone:n.phone};R.value=!0,await E.centerAPI("vip_register",r,s=>{s.result?(U.value=!1,u.value=s.user):C.add({severity:"error",summary:"error",detail:s.error,life:3e3}),R.value=!1})}function O(){let r=!0;return t.oldPassword="",t.newPassword="",t.confirmPassword="",n.id||(t.id="please enter id",r=!1),n.password?n.password.length<6&&(t.password="Password length must be at least 6 characters",r=!1):(t.password="please enter password",r=!1),r}const D=k(!1),L=k(!1),d=h({oldPassword:"",newPassword:"",confirmPassword:""}),i=h({oldPassword:"",newPassword:"",confirmPassword:""}),q=r=>{const s={year:"numeric",month:"long",day:"numeric"};return new Date(r).toLocaleDateString("pt-PT",s)},j=async()=>{C.add({severity:"info",summary:"information refreshed",life:3e3})},G=()=>{let r=!0;return i.oldPassword="",i.newPassword="",i.confirmPassword="",d.oldPassword||(i.oldPassword="please enter old password",r=!1),d.newPassword?d.newPassword.length<6?(i.newPassword="Password length must be at least 6 characters",r=!1):d.newPassword===d.oldPassword&&(i.newPassword="The new password cannot be the same as the original password",r=!1):(i.newPassword="please enter new password",r=!1),d.confirmPassword!==d.newPassword&&(i.confirmPassword="The passwords entered twice do not match",r=!1),r},H=async()=>{if(!G())return;L.value=!0;const r=d.oldPassword,s=d.newPassword,o={oldPassword:r,newPassword:s,token:u.token};await E.centerAPI("vip_change_password",o,V=>{V.result?(D.value=!1,C.add({severity:"info",summary:"info",detail:"password changed.",life:3e3})):C.add({severity:"error",summary:"error",detail:V.error,life:3e3}),L.value=!1})},J=()=>{D.value=!1,d.oldPassword="",d.newPassword="",d.confirmPassword="",i.oldPassword="",i.newPassword="",i.confirmPassword=""};return(r,s)=>(f(),c("div",X,[e("div",Y,[l(a(w),{label:"back",icon:"pi pi-arrow-left",class:"p-button-text p-button-secondary",onClick:s[0]||(s[0]=o=>r.$router.go(-1))})]),l(a(A),{class:"user-card mb-4"},{title:p(()=>s[16]||(s[16]=[e("div",{class:"flex align-items-center gap-2"},[e("i",{class:"pi pi-user text-color-secondary"}),e("span",{class:"text-primary font-semibold"},"user information")],-1)])),content:p(()=>[e("div",Z,[e("div",ss,[s[17]||(s[17]=e("label",{for:"id",class:"text-color-secondary font-medium block mb-2"},"id",-1)),l(a(y),{id:"id",modelValue:u.value.id,"onUpdate:modelValue":s[1]||(s[1]=o=>u.value.id=o),readonly:"",class:"w-full"},null,8,["modelValue"])]),e("div",es,[s[18]||(s[18]=e("label",{for:"email",class:"text-color-secondary font-medium block mb-2"},"email",-1)),l(a(y),{id:"email",modelValue:u.value.email,"onUpdate:modelValue":s[2]||(s[2]=o=>u.value.email=o),readonly:"",class:"w-full"},null,8,["modelValue"])]),e("div",os,[s[19]||(s[19]=e("label",{for:"registrationDate",class:"text-color-secondary font-medium block mb-2"},"register time",-1)),l(a(y),{id:"registrationDate",value:q(u.value.registrationDate),readonly:"",class:"w-full"},null,8,["value"])]),e("div",ls,[s[20]||(s[20]=e("label",{for:"points",class:"text-color-secondary font-medium block mb-2"},"points",-1)),l(a(y),{id:"points",value:u.value.points.toLocaleString(),readonly:"",class:"w-full"},null,8,["value"])])])]),_:1}),l(a(A),{class:"actions-card mb-4"},{title:p(()=>s[21]||(s[21]=[e("div",{class:"flex align-items-center gap-2"},[e("i",{class:"pi pi-cog text-color-secondary"}),e("span",{class:"text-primary font-semibold"},"operation")],-1)])),content:p(()=>[e("div",as,[l(a(w),{label:"modify password",icon:"pi pi-key",class:"p-button-outlined",onClick:s[3]||(s[3]=o=>D.value=!0)}),l(a(w),{label:"refresh info",icon:"pi pi-refresh",class:"p-button-outlined p-button-secondary",onClick:j})])]),_:1}),l(a($),{visible:x.value,"onUpdate:visible":[s[6]||(s[6]=o=>x.value=o),F],modal:"",header:"login",style:{width:"450px"},closeOnEscape:!1},{footer:p(()=>[l(a(w),{label:"register",icon:"pi pi-user",class:"p-button-text p-button-text",onClick:T}),l(a(w),{label:"cancel",icon:"pi pi-times",class:"p-button-text p-button-danger",onClick:F}),l(a(w),{label:"login",icon:"pi pi-check",class:"p-button-text",onClick:B,loading:M.value},null,8,["loading"])]),default:p(()=>[e("div",rs,[e("div",is,[s[22]||(s[22]=e("label",{for:"id",class:"text-color-secondary font-medium block mb-2"},"id",-1)),l(a(y),{id:"id",modelValue:b.id,"onUpdate:modelValue":s[4]||(s[4]=o=>b.id=o),feedback:!1,toggleMask:"",class:g(["w-full",{"p-invalid":m.id}])},null,8,["modelValue","class"]),m.id?(f(),c("small",ts,P(m.id),1)):v("",!0)]),e("div",ds,[s[23]||(s[23]=e("label",{for:"password",class:"text-color-secondary font-medium block mb-2"},"password",-1)),l(a(_),{id:"password",modelValue:b.password,"onUpdate:modelValue":s[5]||(s[5]=o=>b.password=o),toggleMask:"",class:g(["w-full",{"p-invalid":m.password}])},null,8,["modelValue","class"]),m.password?(f(),c("small",ns,P(m.password),1)):v("",!0)])])]),_:1},8,["visible"]),l(a($),{visible:U.value,"onUpdate:visible":[s[11]||(s[11]=o=>U.value=o),I],modal:"",header:"register",style:{width:"450px"},closeOnEscape:!1},{footer:p(()=>[l(a(w),{label:"cancel",icon:"pi pi-times",class:"p-button-text p-button-danger",onClick:I}),l(a(w),{label:"register",icon:"pi pi-check",class:"p-button-text",onClick:z,loading:R.value},null,8,["loading"])]),default:p(()=>[e("div",us,[e("div",ms,[s[24]||(s[24]=e("label",{for:"id",class:"text-color-secondary font-medium block mb-1"},"id",-1)),l(a(y),{id:"id",modelValue:n.id,"onUpdate:modelValue":s[7]||(s[7]=o=>n.id=o),feedback:!1,toggleMask:"",class:g(["w-full",{"p-invalid":t.id}])},null,8,["modelValue","class"]),t.id?(f(),c("small",cs,P(t.id),1)):v("",!0)]),e("div",ps,[s[25]||(s[25]=e("label",{for:"password",class:"text-color-secondary font-medium block mb-1"},"password",-1)),l(a(_),{id:"password",modelValue:n.password,"onUpdate:modelValue":s[8]||(s[8]=o=>n.password=o),toggleMask:"",class:g(["w-full",{"p-invalid":t.password}])},null,8,["modelValue","class"]),t.password?(f(),c("small",fs,P(t.password),1)):v("",!0)]),e("div",ws,[s[26]||(s[26]=e("label",{for:"email",class:"text-color-secondary font-medium block mb-1"},"email",-1)),l(a(y),{id:"email",modelValue:n.email,"onUpdate:modelValue":s[9]||(s[9]=o=>n.email=o),toggleMask:"",class:g(["w-full",{"p-invalid":t.email}])},null,8,["modelValue","class"]),t.email?(f(),c("small",bs,P(t.email),1)):v("",!0)]),e("div",vs,[s[27]||(s[27]=e("label",{for:"phone",class:"text-color-secondary font-medium block mb-1"},"phone",-1)),l(a(y),{id:"phone",modelValue:n.phone,"onUpdate:modelValue":s[10]||(s[10]=o=>n.phone=o),toggleMask:"",class:g(["w-full",{"p-invalid":t.phone}])},null,8,["modelValue","class"]),t.phone?(f(),c("small",gs,P(t.phone),1)):v("",!0)])])]),_:1},8,["visible"]),l(a($),{visible:D.value,"onUpdate:visible":s[15]||(s[15]=o=>D.value=o),modal:"",header:"modify password",style:{width:"450px"}},{footer:p(()=>[l(a(w),{label:"cancel",icon:"pi pi-times",class:"p-button-text p-button-danger",onClick:J}),l(a(w),{label:"submit",icon:"pi pi-check",class:"p-button-text",onClick:H,loading:L.value},null,8,["loading"])]),default:p(()=>[e("div",Ps,[e("div",ys,[s[28]||(s[28]=e("label",{for:"oldPassword",class:"text-color-secondary font-medium block mb-2"},"old password",-1)),l(a(_),{id:"oldPassword",modelValue:d.oldPassword,"onUpdate:modelValue":s[12]||(s[12]=o=>d.oldPassword=o),feedback:!1,toggleMask:"",class:g(["w-full",{"p-invalid":i.oldPassword}])},null,8,["modelValue","class"]),i.oldPassword?(f(),c("small",ks,P(i.oldPassword),1)):v("",!0)]),e("div",xs,[s[29]||(s[29]=e("label",{for:"newPassword",class:"text-color-secondary font-medium block mb-2"},"new password",-1)),l(a(_),{id:"newPassword",modelValue:d.newPassword,"onUpdate:modelValue":s[13]||(s[13]=o=>d.newPassword=o),toggleMask:"",class:g(["w-full",{"p-invalid":i.newPassword}])},null,8,["modelValue","class"]),i.newPassword?(f(),c("small",Vs,P(i.newPassword),1)):v("",!0)]),e("div",hs,[s[30]||(s[30]=e("label",{for:"confirmPassword",class:"text-color-secondary font-medium block mb-2"},"confirm password",-1)),l(a(_),{id:"confirmPassword",modelValue:d.confirmPassword,"onUpdate:modelValue":s[14]||(s[14]=o=>d.confirmPassword=o),toggleMask:"",class:g(["w-full",{"p-invalid":i.confirmPassword}])},null,8,["modelValue","class"]),i.confirmPassword?(f(),c("small",Cs,P(i.confirmPassword),1)):v("",!0)])])]),_:1},8,["visible"])]))}};export{Ls as default};
