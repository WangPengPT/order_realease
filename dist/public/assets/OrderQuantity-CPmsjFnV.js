import{s as J}from"./index-zuixQpAF.js";import{c as K,s as X,a as q}from"./index-3qmRMy-X.js";import{s as ee,a as le,b as te,c as ae}from"./index-CyxEeD_l.js";import{s as re}from"./index-RVcTUFwK.js";import{s as oe}from"./index-DfA1rhkO.js";import{b as ne}from"./index-BApRYYkm.js";import{h as c,n as y,c as b,d as n,a as p,w as i,e as P,j as ie,o as s,l as se,F as D,A as C,f as _,z as A,t as Q}from"./index-B7ldv59F.js";import"./index-AQ3C9tYn.js";import"./index-CEujosyQ.js";import"./index-D1RHvCj8.js";import"./index-Cw15LwKQ.js";import"./index-SlBXek8c.js";import"./index-BXiU1ugA.js";import"./index-WJc8gqs_.js";const ue={class:"flex flex-column w-full",style:{position:"fixed",top:"0",left:"0"}},de={class:"flex flex-wrap justify-content-center align-items-center gap-1 ml-2"},ve={class:"card flex flex-column",style:{height:"calc(100vh - 200px)"}},ce={key:0,style:{padding:"0.5rem 1rem"}},fe=2025,Ne={__name:"OrderQuantity",setup(pe){const S=ie(),a=c(y.menuData.value.filter(l=>l.category));R();const z=c([{id:0,label:"隐藏销售量为0的菜品"},{id:1,label:"展示销售量为0的菜品"}]),g=c(),T=new Date,m=T.getFullYear(),h=T.getMonth()+1,Y=T.getDate(),V=c([{id:0,value:0,label:"总评分"}]);F();function F(){for(let l=fe;l<=m;l++)V.value.push({id:l,value:l,label:l})}const x=c([]);U();function U(){const l=["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"];x.value.push({id:0,value:"yearTotal",label:"当年总销售量"});for(let e=0;e<l.length;e++)x.value.push({id:e+1,value:l[e],label:e+1+" - "+l[e].toUpperCase()})}const I=[[{id:0,label:"当月总销售量"},...Array.from({length:28},(l,e)=>({id:e+1,label:e+1}))],[{id:0,label:"当月总销售量"},...Array.from({length:29},(l,e)=>({id:e+1,label:e+1}))],[{id:0,label:"当月总销售量"},...Array.from({length:30},(l,e)=>({id:e+1,label:e+1}))],[{id:0,label:"当月总销售量"},...Array.from({length:31},(l,e)=>({id:e+1,label:e+1}))]],N=c([]);B(m,h);function B(l,e){if(e<1||e>12)return 0;const t=[3,l&&(l%4===0&&l%100!==0||l%400===0)?1:0,3,2,3,2,3,3,2,3,2,3];N.value=I[t[e-1]]}async function R(){try{await y.refreshMenu(),a.value=y.menuData.value.filter(l=>l.category)}catch(l){console.error("获取销售量失败:",l),toast.add({severity:"error",summary:"错误",detail:"获取销售量失败",life:3e3})}}function w(l,e,o){u.value!==e&&B(l,e),d.value=l,u.value=e,o=o|0,a.value=[],E(a,l,e,o,()=>{H()})}function E(l,e,o,t,O){e==0||e==m&&o==0||e==m&&o==h&&t==0||e==m&&o==h&&t==Y?l.value=y.menuData.value:(o===0&&(t=0),y.getOrderQuantityWithDate(l,e,o,t,()=>{O()})),O(),a.value=a.value.filter($=>$.category)}function H(){const l=d.value,e=u.value,o=v.value.id;if(g.value)if(g.value.id){if(!l){a.value=a.value.filter(t=>!t.orders);return}if(!e){a.value=a.value.filter(t=>!t.yearlyOrders);return}if(!o){a.value=a.value.filter(t=>!t.monthlyOrders);return}a.value=a.value.filter(t=>!t.dailyOrders)}else{if(!l){a.value=a.value.filter(t=>t.orders);return}if(!e){a.value=a.value.filter(t=>t.yearlyOrders);return}if(!o){a.value=a.value.filter(t=>t.monthlyOrders);return}a.value=a.value.filter(t=>t.dailyOrders)}}const d=c(m),u=c(h),v=c(N.value.find(l=>l.id===Y));return(l,e)=>{const o=ne,t=oe,O=re,$=te,L=le,j=ae,M=ee,W=K,k=q,Z=X,G=J;return s(),b("div",ue,[n(O,{class:"bg-primary text-white p-2"},{start:i(()=>[n(o,{icon:"pi pi-arrow-left",class:"p-button-text text-white",label:"主页",onClick:e[0]||(e[0]=r=>se(S).push("/"))}),p("div",de,[n(t,{modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=r=>g.value=r),options:z.value,optionLabel:"label",unselectable:!1,onChange:e[2]||(e[2]=r=>w(d.value,u.value,v.value.id))},null,8,["modelValue","options"])])]),_:1}),p("div",null,[n(M,{value:d.value},{default:i(()=>[n(L,null,{default:i(()=>[(s(!0),b(D,null,C(V.value,r=>(s(),_($,{key:r.id,value:r.id,onClick:f=>w(r.id,u.value,v.value.id)},{default:i(()=>[A(Q(r.label),1)]),_:2},1032,["value","onClick"]))),128))]),_:1}),(s(!0),b(D,null,C(V.value,r=>(s(),_(j,{key:r.id,value:r.id},{default:i(()=>[d.value!==0?(s(),_(M,{key:0,value:u.value,scrollable:""},{default:i(()=>[n(L,null,{default:i(()=>[(s(!0),b(D,null,C(x.value,f=>(s(),_($,{key:f.id,value:f.id,onClick:me=>w(r.id,f.id,v.value.id)},{default:i(()=>[A(Q(f.label),1)]),_:2},1032,["value","onClick"]))),128))]),_:2},1024),(s(!0),b(D,null,C(x.value,f=>(s(),_(j,{key:f.id,value:f.id},null,8,["value"]))),128))]),_:2},1032,["value"])):P("",!0)]),_:2},1032,["value"]))),128))]),_:1},8,["value"]),p("div",ve,[d.value&&u.value?(s(),b("div",ce,[n(W,{modelValue:v.value,"onUpdate:modelValue":e[3]||(e[3]=r=>v.value=r),options:N.value,optionLabel:"label",placeholder:"选择日期",onChange:e[4]||(e[4]=r=>w(d.value,u.value,v.value.id))},null,8,["modelValue","options"]),e[5]||(e[5]=p("label",null," 日",-1))])):P("",!0),n(Z,{value:a.value,stripedRows:"",scrollable:"",scrollHeight:"flex",paginator:"",rows:10,rowsPerPageOptions:[5,10,20,50],tableStyle:"min-width: 50rem"},{empty:i(()=>e[6]||(e[6]=[p("div",{class:"text-center py-5"},[p("i",{class:"pi pi-search",style:{"font-size":"3rem",color:"#ccc"}}),p("p",{class:"mt-3 text-gray-500"},"未找到销售量")],-1)])),default:i(()=>[n(k,{field:"id",header:"ID",sortable:""}),n(k,{field:"category",header:"类型",sortable:""}),n(k,{field:"name",header:"菜名"}),n(k,{field:"orderQuantity",header:(d.value===0?"":u.value===0?"当年":v.value.id===0?"当月":"当日")+"销售量"},{body:i(({data:r})=>[A(Q((d.value===0?r.orders:u.value===0?r.yearlyOrders:v.value.id===0?r.monthlyOrders:r.dailyOrders)|0),1)]),_:1},8,["header"])]),_:1},8,["value"])])]),n(G)])}}};export{Ne as default};
